{"meta":{"title":"HuShengBinâ€™s blog","subtitle":"ç æ¸£çš„ä¸ªäººåšå®¢","description":"è®°å½•ç æ¸£çš„å¥‹æ–—å²","author":"HuShengBin","url":"https://hsb786.github.io"},"pages":[{"title":"å…³äºæˆ‘","date":"2018-04-09T10:17:26.000Z","updated":"2018-04-15T05:30:22.117Z","comments":true,"path":"about/index.html","permalink":"https://hsb786.github.io/about/index.html","excerpt":"","text":"1995 å¤©æ°åº§ï¼Œèº«é«˜ä¸é«˜ ç æ¸£ä¸€æšï¼Œå–œæ¬¢æ•²ä»£ç ï¼Œå¯æƒœå¤ªç¬¨ å¸¸å¹´æ··è¿¹åœ¨çŸ¥ä¹ã€è±†ç“£ã€ç½‘æ˜“äº‘ï¼Œæƒ³åšä¸ªæ–‡è‰ºé’å¹´ï¼Œå¯æƒœæ²¡é‚£ä¸ªæ°”è´¨ å¯¹ç§‘æŠ€éå¸¸æ„Ÿå…´è¶£ï¼Œå¯æƒœç©· è”ç³»æ–¹å¼ï¼š786398798@qq.com"},{"title":"categories","date":"2018-04-09T10:17:26.000Z","updated":"2018-04-09T10:17:26.909Z","comments":true,"path":"categories/index.html","permalink":"https://hsb786.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-04-09T10:16:56.000Z","updated":"2018-04-10T09:27:51.546Z","comments":true,"path":"tags/index.html","permalink":"https://hsb786.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"javap","slug":"javap","date":"2018-04-15T11:11:13.000Z","updated":"2018-04-15T11:48:20.538Z","comments":true,"path":"2018/04/15/javap/","link":"","permalink":"https://hsb786.github.io/2018/04/15/javap/","excerpt":"javapæ˜¯jdkè‡ªå¸¦çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥å¯¹ä»£ç åç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹javaç¼–è¯‘å™¨ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶","text":"javapæ˜¯jdkè‡ªå¸¦çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥å¯¹ä»£ç åç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹javaç¼–è¯‘å™¨ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ 1234567891011public class T01 &#123; private volatile int n; public void add() &#123; n++; &#125; private void sub() &#123; n--; &#125;&#125; javap T01 è¾“å‡ºT01çš„publicåŸŸåŠæ–¹æ³• javap -c T01 åˆ—å‡ºæ¯ä¸ªæ–¹æ³•æ‰€æ‰§è¡Œçš„JVMæŒ‡ä»¤ï¼Œå¹¶æ˜¾ç¤ºæ¯ä¸ªæ–¹æ³•çš„å­—èŠ‚ç çš„å®é™…ä½œç”¨ javap -p T01 è¾“å‡ºæ‰€æœ‰ç±»å’Œæˆå‘˜ javap -v T01 è¾“å‡ºæ ˆå¤§å°ï¼Œæ–¹æ³•å‚æ•°çš„ä¸ªæ•° è¯­æ³•12345678910-help å¸®åŠ©-l è¾“å‡ºè¡Œå’Œå˜é‡çš„è¡¨-public åªè¾“å‡ºpublicæ–¹æ³•å’ŒåŸŸ-protected åªè¾“å‡ºpublicå’Œprotectedç±»å’Œæˆå‘˜-package åªè¾“å‡ºåŒ…ï¼Œpublicå’Œprotectedç±»å’Œæˆå‘˜ï¼Œè¿™æ˜¯é»˜è®¤çš„-p -private è¾“å‡ºæ‰€æœ‰ç±»å’Œæˆå‘˜-s è¾“å‡ºå†…éƒ¨ç±»å‹ç­¾å-c è¾“å‡ºåˆ†è§£åçš„ä»£ç ï¼Œä¾‹å¦‚ï¼Œç±»ä¸­æ¯ä¸€ä¸ªæ–¹æ³•å†…ï¼ŒåŒ…å«javaå­—èŠ‚ç çš„æŒ‡ä»¤ï¼Œ-verbose è¾“å‡ºæ ˆå¤§å°ï¼Œæ–¹æ³•å‚æ•°çš„ä¸ªæ•°-constants è¾“å‡ºé™æ€finalå¸¸é‡ ç¼–è¯‘ç‰ˆæœ¬ major version javaç‰ˆæœ¬ 46 2 47 3 48 4 49 5 50 6 51 7 52 8","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Proxy","slug":"Proxy","date":"2018-04-14T08:14:06.000Z","updated":"2018-04-14T11:25:27.473Z","comments":true,"path":"2018/04/14/Proxy/","link":"","permalink":"https://hsb786.github.io/2018/04/14/Proxy/","excerpt":"JDKåŠ¨æ€ä»£ç†é€šè¿‡java.lang.reflect.Proxyç±»ä»¥åŠjava.lang.reflect.InvocationHandleræ¥å£æ¥å®ç°åŠ¨æ€ä»£ç† InvocationHandlerInvocationHandleræ¥å£çš„å”¯ä¸€æ–¹æ³•ï¼š public Object invoke(Object proxy, Method method, Object[] args) throws Throwable; proxy: ä»£ç†ç±»å®ä¾‹ method: æ–¹æ³• args: æ–¹æ³•å…¥å‚","text":"JDKåŠ¨æ€ä»£ç†é€šè¿‡java.lang.reflect.Proxyç±»ä»¥åŠjava.lang.reflect.InvocationHandleræ¥å£æ¥å®ç°åŠ¨æ€ä»£ç† InvocationHandlerInvocationHandleræ¥å£çš„å”¯ä¸€æ–¹æ³•ï¼š public Object invoke(Object proxy, Method method, Object[] args) throws Throwable; proxy: ä»£ç†ç±»å®ä¾‹ method: æ–¹æ³• args: æ–¹æ³•å…¥å‚ Proxypublic static Object newProxyInstance Proxy.newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces,InvocationHandler h) loaderï¼š ClassLoaderï¼Œå®šä¹‰ç”±å“ªä¸ªClassLoaderå¯¹è±¡ç±»å¯¹ç”Ÿæˆçš„ä»£ç†å¯¹è±¡è¿›è¡ŒåŠ è½½ interfacesï¼šè¯¥å®ç°ç±»çš„æ‰€æœ‰æ¥å£ hï¼šè°ƒç”¨å¤„ç†ç¨‹åºï¼Œè¡¨ç¤ºå½“è¿™ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡åœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šå…³è”åˆ°å“ªä¸€ä¸ªInvocationHandlerå¯¹è±¡ä¸Š 123public interface Hello &#123; void say(String name);&#125; å®šä¹‰è¢«ä»£ç†çš„æ¥å£ 12345678public class HelloImpl implements Hello &#123; @Override public void say(String name) &#123; System.out.println(&quot;Hello &quot; + name); &#125;&#125; æ¥å£çš„å®ç°ç±» 123456789101112131415161718192021222324252627282930313233343536373839404142/** * åœ¨æœ€ç»ˆç”Ÿæˆçš„ä»£ç†ç±»ä¸­åŒ…å«ä¸€ä¸ªInvocationHandlerå®ç°ç±»çš„æˆå‘˜å˜é‡(è¯¥æˆå‘˜å˜é‡ç»§æ‰¿è‡ªProxyç±»)ã€‚ * åœ¨ä»£ç†ç±»å®ä¾‹è°ƒç”¨ä»£ç†çš„æ–¹æ³•æ—¶ï¼Œå°†å¯¹æ–¹æ³•è°ƒç”¨è¿›è¡Œç¼–ç (Methodå˜é‡)å¹¶å°†å…¶æŒ‡æ´¾åˆ°å®ƒçš„è°ƒç”¨å¤„ç†ç¨‹åºçš„invokeæ–¹æ³•ã€‚ * æ‰€ä»¥å¯¹è¢«ä»£ç†æ–¹æ³•çš„è°ƒç”¨éƒ½æ˜¯é€šè¿‡InvocationHadlerçš„invokeæ¥å®ç°çš„ã€‚ */public class DynamicProxy implements InvocationHandler &#123; //ç›®æ ‡å¯¹è±¡ï¼Œè¢«ä»£ç†æ¥å£çš„å®ç°ç±» private Object target; public DynamicProxy(Object target) &#123; this.target = target; &#125; /** * @param proxy ä»£ç†ç±»å®ä¾‹ * @param method æ–¹æ³• * @param args æ–¹æ³•å…¥å‚ */ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; before(); Object result = method.invoke(target, args); after(); return result; &#125; /** * @Description: è·å–ä»£ç†å¯¹è±¡ */ @SuppressWarnings(&quot;unchecked&quot;) public &lt;T&gt; T getProxy() &#123; return (T) Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), this); &#125; private void before() &#123; System.out.println(&quot;Before&quot;); &#125; private void after() &#123; System.out.println(&quot;After&quot;); &#125;&#125; æ‰§è¡Œç¨‹åº12345678910111213public class ClientProxy &#123; public static void main(String[] args) &#123; Hello hello = new HelloImpl(); DynamicProxy dynamicProxy = new DynamicProxy(hello); Hello helloProxy = dynamicProxy.getProxy(); helloProxy.say(&quot;hh&quot;); &#125;&#125;//output: Before Hello hh After ç”¨DynamicProxyç±»å»åŒ…è£…HelloImplå®ä¾‹ï¼Œç„¶åå†è°ƒç”¨Proxyç±»çš„å·¥å‚æ–¹æ³•newProxyInstance()å»åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªHelloæ¥å£çš„ä»£ç†ç±»ï¼Œè°ƒç”¨è¿™ä¸ªä»£ç†ç±»çš„say()æ–¹æ³•ã€‚ è¢«ä»£ç†æ–¹æ³•çš„è°ƒç”¨éƒ½æ˜¯é€šè¿‡InvocationHadlerçš„invokeæ¥å®ç°çš„ã€‚ Proxy.newProxyInstanceè¿™ä¸ªæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªä»£ç†å¯¹è±¡æä¾›äº†ä¸€ç»„ä»€ä¹ˆæ¥å£ï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ç†å¯¹è±¡å°±ä¼šå®ç°äº†è¿™ç»„æ¥å£ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä»£ç†å¯¹è±¡å¼ºåˆ¶è½¬åŒ–ä¸ºè¿™ç»„æ¥å£ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚ Proxy.newProxyInstance åˆ›å»ºçš„ä»£ç†å¯¹è±¡æ˜¯åœ¨jvmè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆçš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”å‘½åæ–¹å¼éƒ½æ˜¯è¿™æ ·çš„å½¢å¼ï¼Œä»¥$å¼€å¤´ï¼Œproxyä¸ºä¸­ï¼Œæœ€åä¸€ä¸ªæ•°å­—è¡¨ç¤ºå¯¹è±¡çš„æ ‡å·ã€‚ åŠ¨æ€ä»£ç†ï¼Œæ¥å£å˜äº†ï¼Œè¿™ä¸ªåŠ¨æ€ä»£ç†ç±»ä¸ç”¨åŠ¨ã€‚è€Œé™æ€ä»£ç†å°±ä¸ä¸€æ ·äº†ï¼Œæ¥å£å˜äº†ï¼Œä»£ç†ç±»ä¹Ÿè¦å˜ã€‚ä½†æˆ‘ä¹Ÿå‘ç°åŠ¨æ€ä»£ç†å¹¶ä¸æ˜¯â€œä¸‡çµä¸¹â€ï¼Œå®ƒä¹Ÿæœ‰æä¸å®šçš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘è¦ä»£ç†ä¸€ä¸ªæ²¡æœ‰ä»»ä½•æ¥å£çš„ç±»ï¼Œå®ƒå°±æ²¡æœ‰ç”¨æ­¦ä¹‹åœ°äº†ï¼ æ€»ç»“ é€šè¿‡å®ç°InvocationHandleræ¥å£æ¥è‡ªå®šä¹‰è‡ªå·±çš„InvocationHandlerï¼›åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ä¼ å…¥ç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰æ¥è¾…åŠ©å®Œæˆinvoke()æ–¹æ³•ï¼ŒåŒæ—¶å¯ä»¥åœ¨invokeæ–¹æ³•ä¸­ç»‡å…¥å¢å¼ºé€»è¾‘ã€‚ é€šè¿‡Proxy.newProxyInstanceæ¥åŠ¨æ€åˆ›å»ºä»£ç†ç±» é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡InvocationHandlerå®ç°ç±»çš„invoke()æ–¹æ³•è°ƒç”¨ èƒ½å¦ä»£ç†æ²¡æœ‰æ¥å£çš„ç±»? CGLib è¿™ä¸ªç±»åº“ã€‚è™½ç„¶å®ƒçœ‹èµ·æ¥ä¸å¤ªèµ·çœ¼ï¼Œä½† Springã€Hibernate è¿™æ ·ç‰›é€¼çš„å¼€æºæ¡†æ¶éƒ½ç”¨åˆ°äº†å®ƒã€‚å®ƒå°±æ˜¯ä¸€ä¸ªåœ¨è¿è¡ŒæœŸé—´åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç çš„å·¥å…·ï¼Œä¹Ÿå°±æ˜¯åŠ¨æ€ç”Ÿæˆä»£ç†ç±»äº†ã€‚ CGLIBåŠ¨æ€ä»£ç†CglibåŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå°è€Œå¿«çš„å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMæ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»ã€‚å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œæ‰€ä»¥è¯¥ç±»æˆ–æ–¹æ³•ä¸èƒ½å£°æ˜ç§°finalçš„ã€‚ 1234567891011121314151617181920212223public class CGLibProxy implements MethodInterceptor &#123; @SuppressWarnings(&quot;unchecked&quot;) public &lt;T&gt; T getProxy(Class&lt;T&gt; cls) &#123; return (T) Enhancer.create(cls, this); &#125; @Override public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable &#123; before(); Object result = proxy.invokeSuper(obj, args); after(); return result; &#125; private void before() &#123; System.out.println(&quot;Before&quot;); &#125; private void after() &#123; System.out.println(&quot;After&quot;); &#125;&#125; éœ€è¦å®ç° CGLib ç»™æˆ‘ä»¬æä¾›çš„ MethodInterceptor å®ç°ç±»ï¼Œå¹¶å¡«å…… intercept() æ–¹æ³•ã€‚æ–¹æ³•ä¸­æœ€åä¸€ä¸ª MethodProxy ç±»å‹çš„å‚æ•° proxyï¼Œå€¼å¾—æ³¨æ„ï¼CGLib ç»™æˆ‘ä»¬æä¾›çš„æ˜¯æ–¹æ³•çº§åˆ«çš„ä»£ç†ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå¯¹æ–¹æ³•çš„æ‹¦æˆªï¼ˆè¿™ä¸å°±æ˜¯ä¼ è¯´ä¸­çš„â€œæ–¹æ³•æ‹¦æˆªå™¨â€å—ï¼Ÿï¼‰ã€‚ ä¸ DynamicProxy ç±»ä¼¼ï¼Œæˆ‘åœ¨ CGlibProxy ä¸­ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªæ³›å‹çš„ getProxy() æ–¹æ³•ï¼Œä¾¿äºæˆ‘ä»¬å¯ä»¥å¿«é€Ÿåœ°è·å–è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ã€‚è¿˜æ˜¯ç”¨ä¸€ä¸ª main() æ–¹æ³•æ¥æè¿°å§ï¼š 123CGLibProxy cgLibProxy = new CGLibProxy();HelloImpl helloProxy2 = cgLibProxy.getProxy(HelloImpl.class);helloProxy2.say(&quot;cg&quot;); ä¸ JDK åŠ¨æ€ä»£ç†ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œä¸éœ€è¦ä»»ä½•çš„æ¥å£ä¿¡æ¯ï¼Œå¯¹è°éƒ½å¯ä»¥ç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†ç”Ÿæˆçš„åŒºåˆ« JDKåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨åå°„æœºåˆ¶ç”Ÿæˆä¸€ä¸ªå®ç°ä»£ç†æ¥å£çš„åŒ¿åç±»ï¼Œåœ¨è°ƒç”¨å…·ä½“æ–¹æ³•å‰è°ƒç”¨InvokeHandleræ¥å¤„ç†ã€‚JDKåŠ¨æ€ä»£ç†åªèƒ½å¯¹å®ç°äº†æ¥å£çš„ç±»ç”Ÿæˆä»£ç†ï¼Œè€Œä¸èƒ½é’ˆå¯¹ç±»ã€‚ CGLIBåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨ASMå¼€æºåŒ…ï¼Œå°†ç›®æ ‡å¯¹è±¡ç±»çš„classæ–‡ä»¶åŠ è½½è¿›æ¥ï¼Œé€šè¿‡ä¿®æ”¹å…¶å­—èŠ‚ç ç”Ÿæˆå­ç±»æ¥å¤„ç†ã€‚CGLIBæ˜¯é’ˆå¯¹ç±»å®ç°ä»£ç†ï¼Œä¸»è¦æ˜¯å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ–¹æ³•ã€‚ JDKåŠ¨æ€ä»£ç†æ˜¯é¢å‘æ¥å£çš„ï¼Œåœ¨åˆ›å»ºä»£ç†å®ç°ç±»æ—¶æ¯”CGLIBè¦å¿«ï¼Œåˆ›å»ºä»£ç†é€Ÿåº¦å¿«ã€‚CGLIBåŠ¨æ€ä»£ç†æ˜¯é€šè¿‡å­—èŠ‚ç åº•å±‚ç»§æ‰¿è¦ä»£ç†ç±»çš„ç›®æ ‡ç±»æ¥å®ç°ï¼Œåˆ›å»ºé€Ÿåº¦æ²¡æœ‰JDKåŠ¨æ€ä»£ç†å¿«ï¼Œä½†æ˜¯è¿è¡Œé€Ÿåº¦æ¯”JDKåŠ¨æ€ä»£ç†å¿«ã€‚ åœ¨Spring AOPä¸­ï¼Œä¸¤ç§ä»£ç†æŠ€æœ¯éƒ½æœ‰ä½¿ç”¨ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡æ˜¯æ¥å£å®ç°ç±»ï¼Œé‚£ä¹ˆSpringé‡‡ç”¨JDKåŠ¨æ€ä»£ç†æ¥å®Œæˆï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸æ˜¯æ¥å£å®ç°ç±»ï¼ŒSpringä¼šä½¿ç”¨CGLIBæ¥å®ç°åŠ¨æ€ä»£ç†ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å¼ºåˆ¶ä½¿ç”¨CGLIBåŠ¨æ€ä»£ç†ã€‚å› ä¸ºåœ¨Springå®¹å™¨ä¸­ï¼Œå¤§å¤šæ•°beanæ˜¯å•ä¾‹çš„ï¼Œæ‰€ä»¥åªåˆ›å»ºä¸€æ¬¡ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨CGLIBæ¥ä»£ç†ã€‚ å‚è€ƒ Proxy é‚£ç‚¹äº‹å„¿ åŠ¨æ€ä»£ç† javaçš„åŠ¨æ€ä»£ç†æœºåˆ¶è¯¦è§£","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ThreadLocal","slug":"ThreadLocal","date":"2018-04-14T07:06:57.000Z","updated":"2018-04-14T07:55:17.544Z","comments":true,"path":"2018/04/14/ThreadLocal/","link":"","permalink":"https://hsb786.github.io/2018/04/14/ThreadLocal/","excerpt":"æ—©åœ¨ JDK 1.2 çš„æ—¶ä»£ï¼Œjava.lang.ThreadLocal å°±è¯ç”Ÿäº†ï¼Œå®ƒæ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜è€Œè®¾è®¡çš„ã€‚ç›¸å½“äºä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºå­˜æ”¾çº¿ç¨‹çš„å±€éƒ¨å˜é‡ï¼Œä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„å‰¯æœ¬ã€‚","text":"æ—©åœ¨ JDK 1.2 çš„æ—¶ä»£ï¼Œjava.lang.ThreadLocal å°±è¯ç”Ÿäº†ï¼Œå®ƒæ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜è€Œè®¾è®¡çš„ã€‚ç›¸å½“äºä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºå­˜æ”¾çº¿ç¨‹çš„å±€éƒ¨å˜é‡ï¼Œä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„å‰¯æœ¬ã€‚ ThreadLocalå¸¸ç”¨æ–¹æ³•ï¼š public void set(T value)ï¼šå°†å€¼æ”¾å…¥çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­ public T get()ï¼šä»çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­è·å–å€¼ public void remove()ï¼šä»çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­ç§»é™¤å€¼ï¼ˆæœ‰åŠ©äº JVM åƒåœ¾å›æ”¶ï¼‰ protected T initialValue()ï¼šè¿”å›çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­çš„åˆå§‹å€¼ï¼ˆé»˜è®¤ä¸º nullï¼‰ ä¸ºä»€ä¹ˆ initialValue() æ–¹æ³•æ˜¯ protected çš„å‘¢ï¼Ÿå°±æ˜¯ä¸ºäº†æé†’ç¨‹åºå‘˜ä»¬ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯è¦ä½ ä»¬æ¥å®ç°çš„ï¼Œè¯·ç»™è¿™ä¸ªçº¿ç¨‹å±€éƒ¨å˜é‡ä¸€ä¸ªåˆå§‹å€¼å§ã€‚ ThreadLocalç®€å•å®ç°1234567891011121314151617181920212223242526public class MyThreadLocal&lt;T&gt; &#123; private Map&lt;Thread, T&gt; container = Collections.synchronizedMap(new HashMap&lt;Thread, T&gt;()); public void set(T value) &#123; container.put(Thread.currentThread(), value); &#125; public T get() &#123; Thread thread = Thread.currentThread(); T value = container.get(thread); if (value == null &amp;&amp; !container.containsKey(thread)) &#123; value = initialValue(); container.put(thread, value); &#125; return value; &#125; public void remove() &#123; container.remove(Thread.currentThread()); &#125; protected T initialValue() &#123; return null; &#125;&#125; ThreadLocal å…·ä½“æœ‰å“ªäº›ä½¿ç”¨æ¡ˆä¾‹å‘¢ï¼Ÿé€šè¿‡ ThreadLocal å­˜æ”¾ JDBC Connectionï¼Œä»¥è¾¾åˆ°äº‹åŠ¡æ§åˆ¶çš„èƒ½åŠ›ã€‚(æ¯ä¸ªçº¿ç¨‹åº”è¯¥æ‹¥æœ‰è‡ªå·±çš„è¿æ¥ï¼Œè€Œä¸æ˜¯å…±äº«åŒä¸€ä¸ªè¿æ¥ï¼Œå¦åˆ™çº¿ç¨‹1æœ‰å¯èƒ½ä¼šå…³é—­çº¿ç¨‹2çš„è¿æ¥) æ³¨æ„ï¼šå½“æ‚¨åœ¨ä¸€ä¸ªç±»ä¸­ä½¿ç”¨äº† static æˆå‘˜å˜é‡çš„æ—¶å€™ï¼Œä¸€å®šè¦å¤šé—®é—®è‡ªå·±ï¼Œè¿™ä¸ª static æˆå‘˜å˜é‡éœ€è¦è€ƒè™‘â€œçº¿ç¨‹å®‰å…¨â€å—ï¼Ÿï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šä¸ªçº¿ç¨‹éœ€è¦ç‹¬äº«è‡ªå·±çš„ static æˆå‘˜å˜é‡å—ï¼Ÿï¼‰å¦‚æœéœ€è¦è€ƒè™‘ï¼Œé‚£å°±è¯·ç”¨ ThreadLocal å§ï¼ å‚è€ƒ ThreadLocal é‚£ç‚¹äº‹å„¿","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰","slug":"IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰","date":"2018-04-14T05:22:40.000Z","updated":"2018-04-14T07:54:10.280Z","comments":true,"path":"2018/04/14/IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰/","link":"","permalink":"https://hsb786.github.io/2018/04/14/IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰/","excerpt":"æœ¬æ¥æƒ³ç ”ç©¶ä¸€ä¸‹Springæºç çš„ï¼Œå¥ˆä½•è‡ªå·±å¤ªæ¸£ï¼Œçœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå‘ç°å±‚æ¬¡å¤ªå¤šï¼Œæ„Ÿè§‰æ— ä»ä¸‹æ‰‹ï¼Œä¹‹åå‘ç°äº†è¿™ç¯‡åšå®¢ï¼Œå¯¥å¯¥å‡ è¡Œä»£ç å°±æŠŠIOCå®ç°äº†ã€‚é“¾æ¥æ”¾åœ¨åº•éƒ¨ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹ é»„äº¿ååˆ†æçš„ï¼ŒåŒæ ·åœ¨åº•éƒ¨ IOC ä¹Ÿå°±æ˜¯â€œæ§åˆ¶åè½¬â€äº†ï¼Œä¸è¿‡æ›´æµè¡Œçš„å«æ³•æ˜¯â€œä¾èµ–æ³¨å…¥â€ï¼ˆDI - Dependency Injectionï¼‰ã€‚å¬èµ·æ¥æŒºé«˜æ·±ï¼Œå…¶å®å®ç°èµ·æ¥å¹¶ä¸å¤æ‚ã€‚ä¸‹é¢å°±çœ‹çœ‹å¦‚ä½•æ¥å®ç°è¿™ä¸ªè½»é‡çº§ IOC æ¡†æ¶ã€‚","text":"æœ¬æ¥æƒ³ç ”ç©¶ä¸€ä¸‹Springæºç çš„ï¼Œå¥ˆä½•è‡ªå·±å¤ªæ¸£ï¼Œçœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå‘ç°å±‚æ¬¡å¤ªå¤šï¼Œæ„Ÿè§‰æ— ä»ä¸‹æ‰‹ï¼Œä¹‹åå‘ç°äº†è¿™ç¯‡åšå®¢ï¼Œå¯¥å¯¥å‡ è¡Œä»£ç å°±æŠŠIOCå®ç°äº†ã€‚é“¾æ¥æ”¾åœ¨åº•éƒ¨ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹ é»„äº¿ååˆ†æçš„ï¼ŒåŒæ ·åœ¨åº•éƒ¨ IOC ä¹Ÿå°±æ˜¯â€œæ§åˆ¶åè½¬â€äº†ï¼Œä¸è¿‡æ›´æµè¡Œçš„å«æ³•æ˜¯â€œä¾èµ–æ³¨å…¥â€ï¼ˆDI - Dependency Injectionï¼‰ã€‚å¬èµ·æ¥æŒºé«˜æ·±ï¼Œå…¶å®å®ç°èµ·æ¥å¹¶ä¸å¤æ‚ã€‚ä¸‹é¢å°±çœ‹çœ‹å¦‚ä½•æ¥å®ç°è¿™ä¸ªè½»é‡çº§ IOC æ¡†æ¶ã€‚ä»å®ä¾‹å‡ºå‘ï¼Œå…ˆçœ‹çœ‹ä»¥ä¸‹ Action ä»£ç ã€‚ 123456789101112131415161718@Beanpublic class ProductAction extends BaseAction &#123; @Inject private ProductService productService; @Request(&quot;GET:/product/&#123;id&#125;&quot;) public Result getProductById(long productId) &#123; if (productId == 0) &#123; return new Result(ERROR_PARAM); &#125; Product product = productService.getProduct(productId); if (product != null) &#123; return new Result(OK, product); &#125; else &#123; return new Result(ERROR_DATA); &#125; &#125;&#125; ä»¥ä¸Šä½¿ç”¨äº†ä¸¤ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼š@Bean ä¸ @Injectã€‚åœ¨ ProductAction ç±»ä¸Šæ ‡æ³¨äº† @Bean æ³¨è§£ï¼Œè¡¨ç¤ºè¯¥ç±»ä¼šäº¤ç»™â€œå®¹å™¨â€å¤„ç†ï¼Œä»¥ä¾¿åŠ å…¥ä¾èµ–æ³¨å…¥æ¡†æ¶ã€‚ åœ¨ produceService å­—æ®µä¸Šæ ‡æ³¨äº† @Inject æ³¨è§£ï¼Œè¡¨ç¤ºè¯¥å­—æ®µå°†ä¼šè¢«æ³¨å…¥è¿›æ¥ï¼Œè€Œæ— éœ€ new ProductServiceImpl()ï¼Œå®é™…ä¸Š new è¿™ä»¶äº‹æƒ…ä¸æ˜¯æˆ‘ä»¬åšçš„ï¼Œè€Œæ˜¯æ¡†æ¶åšçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ§åˆ¶æƒæ­£å¥½åè¿‡æ¥äº†ï¼Œæ‰€ä»¥â€œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰â€ä¹Ÿç§°ä½œâ€œæ§åˆ¶åè½¬ï¼ˆIoCï¼‰â€ã€‚ é‚£ä¹ˆï¼Œåº”è¯¥å¦‚ä½•å®ç°ä¾èµ–æ³¨å…¥æ¡†æ¶å‘¢ï¼Ÿé¦–å…ˆè¿˜æ˜¯çœ‹çœ‹ä¸‹é¢çš„ BeanHelper ç±»å§ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class BeanHelper &#123; private static final Map&lt;Class&lt;?&gt;, Object&gt; beanMap = new HashMap&lt;Class&lt;?&gt;, Object&gt;(); static &#123; try &#123; // è·å–å¹¶éå†æ‰€æœ‰çš„ Beanï¼ˆå¸¦æœ‰ @Bean æ³¨è§£çš„ç±»ï¼‰ List&lt;Class&lt;?&gt;&gt; beanClassList = ClassHelper.getClassListByAnnotation(Bean.class); for (Class&lt;?&gt; beanClass : beanClassList) &#123; // åˆ›å»º Bean å®ä¾‹ Object beanInstance = beanClass.newInstance(); // å°† Bean å®ä¾‹æ”¾å…¥ Bean Map ä¸­ï¼ˆé”®ä¸º Bean ç±»ï¼Œå€¼ä¸º Bean å®ä¾‹ï¼‰ beanMap.put(beanClass, beanInstance); &#125; // éå† Bean Map for (Map.Entry&lt;Class&lt;?&gt;, Object&gt; beanEntry : beanMap.entrySet()) &#123; // è·å– Bean ç±»ä¸ Bean å®ä¾‹ Class&lt;?&gt; beanClass = beanEntry.getKey(); Object beanInstance = beanEntry.getValue(); // è·å– Bean ç±»ä¸­æ‰€æœ‰çš„å­—æ®µï¼ˆä¸åŒ…æ‹¬çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼‰ Field[] beanFields = beanClass.getDeclaredFields(); if (ArrayUtil.isNotEmpty(beanFields)) &#123; // éå†æ‰€æœ‰çš„ Bean å­—æ®µ for (Field beanField : beanFields) &#123; // åˆ¤æ–­å½“å‰ Bean å­—æ®µæ˜¯å¦å¸¦æœ‰ @Inject æ³¨è§£ if (beanField.isAnnotationPresent(Inject.class)) &#123; // è·å– Bean å­—æ®µå¯¹åº”çš„æ¥å£ Class&lt;?&gt; interfaceClass = beanField.getType(); // è·å–è¯¥æ¥å£æ‰€æœ‰çš„å®ç°ç±» List&lt;Class&lt;?&gt;&gt; implementClassList = ClassHelper.getClassListByInterface(interfaceClass); if (CollectionUtil.isNotEmpty(implementClassList)) &#123; // è·å–ç¬¬ä¸€ä¸ªå®ç°ç±» Class&lt;?&gt; implementClass = implementClassList.get(0); // ä» Bean Map ä¸­è·å–è¯¥å®ç°ç±»å¯¹åº”çš„å®ç°ç±»å®ä¾‹ Object implementInstance = beanMap.get(implementClass); // è®¾ç½®è¯¥ Bean å­—æ®µçš„å€¼ beanField.setAccessible(true); // å¿…é¡»ä½¿è¯¥å­—æ®µå¯è®¿é—® beanField.set(beanInstance, implementInstance); &#125; &#125; &#125; &#125; &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static Map&lt;Class&lt;?&gt;, Object&gt; getBeanMap() &#123; return beanMap; &#125; @SuppressWarnings(&quot;unchecked&quot;) public static &lt;T&gt; T getBean(Class&lt;T&gt; cls) &#123; return (T) beanMap.get(cls); &#125;&#125; å…¶å®å¾ˆç®€å•ï¼Œä¾èµ–æ³¨å…¥å…¶å®åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š1. é€šè¿‡åå°„åˆ›å»ºå®ä¾‹ï¼›2. è·å–éœ€è¦æ³¨å…¥çš„æ¥å£å®ç°ç±»å¹¶å°†å…¶èµ‹å€¼ç»™è¯¥æ¥å£ã€‚ä»¥ä¸Šä»£ç ä¸­çš„ä¸¤ä¸ª for å¾ªç¯å°±æ˜¯å¹²è¿™ä¸¤ä»¶äº‹æƒ…çš„ã€‚ ä¾èµ–æ³¨å…¥æ¡†æ¶å®ç°å®Œæ¯•ï¼ å¤§å®¶ä¸Šé¢çœ‹åˆ°çš„ BeanHelper ç±»ï¼Œå…¶å®å…¼ä»»äº†ä¸¤ç§èŒè´£ï¼š1.åˆå§‹åŒ–æ‰€æœ‰çš„ Bean ç±»ï¼›2.å®ç°ä¾èµ–æ³¨å…¥ã€‚ è¿™è¿æ³•äº†è®¾è®¡æ¨¡å¼ä¸­çš„â€œå•ä¸€è´£ä»»åŸåˆ™â€ï¼Œæ‰€æœ‰æœ‰å¿…è¦å°†å…¶é‡æ„ä¸€ä¸‹ï¼Œç°åœ¨çš„ BeanHelper ç±»æ›´åŠ è‹—æ¡äº†ï¼Œåªæ˜¯è´Ÿè´£åˆå§‹åŒ– Bean ç±»è€Œå·²ã€‚ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829public class BeanHelper &#123; // Bean ç±» =&gt; Bean å®ä¾‹ private static final Map&lt;Class&lt;?&gt;, Object&gt; beanMap = new HashMap&lt;Class&lt;?&gt;, Object&gt;(); static &#123; try &#123; // è·å–å¹¶éå†æ‰€æœ‰çš„ Beanï¼ˆå¸¦æœ‰ @Bean æ³¨è§£çš„ç±»ï¼‰ List&lt;Class&lt;?&gt;&gt; beanClassList = ClassHelper.getClassListByAnnotation(Bean.class); for (Class&lt;?&gt; beanClass : beanClassList) &#123; // åˆ›å»º Bean å®ä¾‹ Object beanInstance = beanClass.newInstance(); // å°† Bean å®ä¾‹æ”¾å…¥ Bean Map ä¸­ï¼ˆé”®ä¸º Bean ç±»ï¼Œå€¼ä¸º Bean å®ä¾‹ï¼‰ beanMap.put(beanClass, beanInstance); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static Map&lt;Class&lt;?&gt;, Object&gt; getBeanMap() &#123; return beanMap; &#125; @SuppressWarnings(&quot;unchecked&quot;) public static &lt;T&gt; T getBean(Class&lt;T&gt; cls) &#123; return (T) beanMap.get(cls); &#125;&#125; é‚£ä¹ˆï¼Œä¾èµ–æ³¨å…¥åŠŸèƒ½æ”¾å“ªé‡Œå‘¢ï¼Ÿæˆ‘æäº†ä¸€ä¸ª IOCHelperï¼Œç”¨è¿™ä¸ªç±»æ¥å®ç° IOC åŠŸèƒ½ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public class IOCHelper &#123; static &#123; try &#123; // è·å–å¹¶éå†æ‰€æœ‰çš„ Bean ç±» Map&lt;Class&lt;?&gt;, Object&gt; beanMap = BeanHelper.getBeanMap(); for (Map.Entry&lt;Class&lt;?&gt;, Object&gt; beanEntry : beanMap.entrySet()) &#123; // è·å– Bean ç±»ä¸ Bean å®ä¾‹ Class&lt;?&gt; beanClass = beanEntry.getKey(); Object beanInstance = beanEntry.getValue(); // è·å– Bean ç±»ä¸­æ‰€æœ‰çš„å­—æ®µï¼ˆä¸åŒ…æ‹¬çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼‰ Field[] beanFields = beanClass.getDeclaredFields(); if (ArrayUtil.isNotEmpty(beanFields)) &#123; // éå†æ‰€æœ‰çš„ Bean å­—æ®µ for (Field beanField : beanFields) &#123; // åˆ¤æ–­å½“å‰ Bean å­—æ®µæ˜¯å¦å¸¦æœ‰ @Inject æ³¨è§£ if (beanField.isAnnotationPresent(Inject.class)) &#123; // è·å– Bean å­—æ®µå¯¹åº”çš„æ¥å£ Class&lt;?&gt; interfaceClass = beanField.getType(); // åˆ¤æ–­æ¥å£ä¸Šæ˜¯å¦æ ‡æ³¨äº† @Impl æ³¨è§£ Class&lt;?&gt; implementClass = null; if (interfaceClass.isAnnotationPresent(Impl.class)) &#123; // è·å–å¼ºåˆ¶æŒ‡å®šçš„å®ç°ç±» implementClass = interfaceClass.getAnnotation(Impl.class).value(); &#125; else &#123; // è·å–è¯¥æ¥å£æ‰€æœ‰çš„å®ç°ç±» List&lt;Class&lt;?&gt;&gt; implementClassList = ClassHelper.getClassListByInterface(interfaceClass); if (CollectionUtil.isNotEmpty(implementClassList)) &#123; // è·å–ç¬¬ä¸€ä¸ªå®ç°ç±» implementClass = implementClassList.get(0); &#125; &#125; // è‹¥å­˜åœ¨å®ç°ç±»ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹ä»£ç  if (implementClass != null) &#123; // ä» Bean Map ä¸­è·å–è¯¥å®ç°ç±»å¯¹åº”çš„å®ç°ç±»å®ä¾‹ Object implementInstance = beanMap.get(implementClass); // è®¾ç½®è¯¥ Bean å­—æ®µçš„å€¼ if (implementInstance != null) &#123; beanField.setAccessible(true); // å–æ¶ˆç±»å‹å®‰å…¨æ£€æµ‹ï¼ˆå¯æé«˜åå°„æ€§èƒ½ï¼‰ beanField.set(beanInstance, implementInstance); // beanInstance æ˜¯æ™®é€šå®ä¾‹ï¼Œæˆ– CGLib åŠ¨æ€ä»£ç†å®ä¾‹ï¼ˆä¸èƒ½ä½¿ JDK åŠ¨æ€ä»£ç†å®ä¾‹ï¼‰ &#125; &#125; &#125; &#125; &#125; &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; å¯è§ï¼ŒIOCHelper æ˜¯ä¾èµ–äº BeanHelper çš„ã€‚è¿™æ ·åˆ†ç¦»ï¼Œè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯æ–¹ä¾¿å®ç° ServiceHelper ä¸ AOPHelperã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé¦–å…ˆé€šè¿‡ BeanHelper åˆå§‹åŒ–æ‰€æœ‰çš„ Bean ç±»ï¼Œç„¶åä¾æ¬¡åˆå§‹åŒ– ServiceHelperã€IOCHelperã€AOPHelperï¼Œè¿™ä¸ªé¡ºåºä¸èƒ½æé”™ã€‚å› ä¸ºåœ¨ ServcieHelper ä¸­ï¼Œå¯¹ Servcie å®ç°ç±»è¿›è¡Œäº†åŠ¨æ€ä»£ç†ï¼Œæ‰€æœ‰ä¿è¯äº† IOC æ³¨å…¥è¿›æ¥çš„æ˜¯ä»£ç†ç±»ï¼Œè€Œå¹¶éç›®æ ‡ç±»ã€‚ å‚è€ƒ IOC å®ç°åŸç† 1000è¡Œä»£ç è¯»æ‡‚Springï¼ˆä¸€ï¼‰- å®ç°ä¸€ä¸ªåŸºæœ¬çš„IoCå®¹å™¨","categories":[],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"}]},{"title":"Servletï¼ˆè½¬è½½ï¼‰","slug":"Servletï¼ˆè½¬è½½ï¼‰","date":"2018-04-14T04:35:27.000Z","updated":"2018-04-14T05:14:16.072Z","comments":true,"path":"2018/04/14/Servletï¼ˆè½¬è½½ï¼‰/","link":"","permalink":"https://hsb786.github.io/2018/04/14/Servletï¼ˆè½¬è½½ï¼‰/","excerpt":"Servletæ¦‚è¿°Servletæ˜¯åœ¨Javaä¸­åˆ›å»ºwebåº”ç”¨ç¨‹åºçš„J2ee æœåŠ¡ç«¯æŠ€æœ¯ã€‚javax.servlet å’Œ javax.servlet.httpåŒ…ä¸­æä¾›äº†ç¼–å†™servletçš„æ¥å£å’Œç±»ã€‚ æ‰€æœ‰çš„servletéƒ½è¦å®ç°javax.servlet.Servletæ¥å£ã€‚è¯¥æ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªServletç”Ÿå‘½å‘¨æœŸä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚å¦‚æœè¦å®ç°ä¸€ä¸ªé€šç”¨çš„Servletï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿Java Servlet APIä¸­æä¾›çš„GenericServletç±»ã€‚HttpServletç±»ä¸­æä¾›äº†ç”¨äºå¤„ç†httpè¯·æ±‚çš„doGet()å’Œ doPost()ç­‰æ–¹æ³•ã€‚","text":"Servletæ¦‚è¿°Servletæ˜¯åœ¨Javaä¸­åˆ›å»ºwebåº”ç”¨ç¨‹åºçš„J2ee æœåŠ¡ç«¯æŠ€æœ¯ã€‚javax.servlet å’Œ javax.servlet.httpåŒ…ä¸­æä¾›äº†ç¼–å†™servletçš„æ¥å£å’Œç±»ã€‚ æ‰€æœ‰çš„servletéƒ½è¦å®ç°javax.servlet.Servletæ¥å£ã€‚è¯¥æ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªServletç”Ÿå‘½å‘¨æœŸä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚å¦‚æœè¦å®ç°ä¸€ä¸ªé€šç”¨çš„Servletï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿Java Servlet APIä¸­æä¾›çš„GenericServletç±»ã€‚HttpServletç±»ä¸­æä¾›äº†ç”¨äºå¤„ç†httpè¯·æ±‚çš„doGet()å’Œ doPost()ç­‰æ–¹æ³•ã€‚å¤šæ•°æƒ…å†µä¸‹ï¼Œwebåº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨httpåè®®ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¤šæ•°æ—¶å€™éƒ½é€šè¿‡ç»§æ‰¿HttpServletç±»æ¥å®ç°è‡ªå·±çš„Servletã€‚ Servlet APIçš„å±‚æ¬¡ç»“æ„javax.servlet.Servletæ˜¯Servlet Apiçš„æœ€ä¸Šå±‚æ¥å£ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ¥å£å’Œç±»æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨servletçš„æ—¶å€™éœ€è¦å…³æ³¨çš„ã€‚åœ¨Servlet 3.0è§„èŒƒä¸­ï¼Œå»ºè®®ä½¿ç”¨çš„æ³¨è§£æˆ‘ä»¬ä¹Ÿéœ€è¦äº†è§£ã€‚ Servlet æ¥å£javax.servlet.Servlet æ˜¯Servlet Apiçš„æœ€ä¸Šå±‚æ¥å£ï¼ŒServletæ¥å£å®šä¹‰äº†ä¸€ç³»åˆ—servletçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆinitã€serviceã€destoryç­‰ï¼‰ã€‚æ‰€æœ‰çš„Servletç±»éƒ½éœ€è¦ç»§æ‰¿è¿™ä¸ªæ¥å£ã€‚è¯¥æ¥å£ä¸­å®šä¹‰äº†ä»¥ä¸‹æ–¹æ³•ï¼š public abstract void init(ServletConfig paramServletConfig) throws ServletException â€“ è¯¥æ–¹æ³•ç”±servletå®¹å™¨è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–servletä»¥åŠservleté…ç½®å‚æ•°ã€‚åœ¨init()æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œservletæ˜¯æ— æ³•å¤„ç†ç”¨æˆ·è¯·æ±‚çš„ã€‚åœ¨servletç”Ÿå‘½å‘¨æœŸä¸­è¯¥æ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œä»–ä¼šä½¿servletç±»ä¸åŒåŒºåˆ«äºæ™®é€šçš„javaå¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥æ‰©å±•è¯¥æ–¹æ³•æ¥åˆå§‹åŒ–èµ„æºï¼Œå¦‚æ•°æ®åº“è¿æ¥ã€socketè¿æ¥ç­‰ã€‚ public abstract ServletConfig getServletConfig() â€“ è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªservleté…ç½®å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«servletä¸­æ‰€æœ‰åˆå§‹åŒ–å‚æ•°å’Œå¯åŠ¨é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥è·å–servletçš„åˆå§‹åŒ–å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¸€èˆ¬è¢«å®šä¹‰åœ¨web.xmlæˆ–servlet 3çš„æ³¨è§£ä¸­ã€‚åé¢ä¼šä»‹ç»ServletConfigæ¥å£ã€‚ public abstract void service(ServletRequest req, ServletResponse res) throws ServletException, IOException â€“ è¯¥æ–¹æ³•è´Ÿè´£å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚å½“servletå®¹å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶æ‰§è¡Œservice()æ–¹æ³•ï¼Œå¹¶æŠŠrequest å’Œ responseä½œä¸ºå‚æ•°ä¼ é€’ç»™è¯¥æ–¹æ³•ã€‚servleté€šå¸¸è¿è¡Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œæ‰€ä»¥å¼€å‘äººå‘˜åº”è¯¥ä½¿ç”¨åŒæ­¥æ¥ä¿è¯è®¿é—®å…±äº«èµ„æºçš„çº¿ç¨‹å®‰å…¨æ€§é—®é¢˜ã€‚ public abstract String getServletInfo() â€“ è¿™ä¸ªæ–¹æ³•è¿”å›åŒ…å«servletä¿¡æ¯çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚å®ƒçš„ä½œè€…ã€ç‰ˆæœ¬å’Œç‰ˆæƒã€‚è¿”å›çš„å­—ç¬¦ä¸²åº”è¯¥æ˜¯çº¯æ–‡æœ¬ï¼Œä¸èƒ½æœ‰æ ‡è®°ç¬¦å·ã€‚ public abstract void destroy() â€“ è¿™ä¸ªæ–¹æ³•åœ¨æ•´ä¸ªservletç”Ÿå‘½å‘¨æœŸä¸­åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡æ¥å…³é—­æ‰€æœ‰èµ„æºã€‚æœ‰ç‚¹åƒJavaä¸­çš„finalizeæ–¹æ³•ã€‚ ServletConfig æ¥å£javax.servlet.ServletConfigç”¨äºç»™servletä¼ é€’é…ç½®ä¿¡æ¯ï¼ˆè¯‘è€…æ³¨ï¼šæè¿°Servletæœ¬èº«çš„ç›¸å…³é…ç½®ä¿¡æ¯ï¼‰ã€‚æ¯ä¸ªservletéƒ½æœ‰å±äºå®ƒè‡ªå·±çš„ServletConfigå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”±servletå®¹å™¨è´Ÿè´£å®ä¾‹åŒ–ã€‚å¯ä»¥åœ¨web.xmlä¸­æä¾›åˆå§‹åŒ–å‚æ•°ï¼Œå½“ç„¶åœ¨servlet3.0ä¸­å¯ä»¥ä½¿ç”¨æ³¨è§£ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨getServletConfig()æ–¹æ³•æ¥è·å–ServletConfigçš„å¯¹è±¡ã€‚ ServletConfigæ¥å£ä¸­ä¸»è¦æ–¹æ³•ï¼š public abstract ServletContext getServletContext() â€“ è¯¥æ–¹æ³•è¿”å›servletçš„ServletContextå¯¹è±¡ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­æˆ‘ä»¬å°†ä»‹ç»ServletContextæ¥å£ã€‚ public abstract Enumeration getInitParameterNames() â€“ è¯¥æ–¹æ³•è¿”å›servletä¸­æ‰€æœ‰åˆå§‹åŒ–å‚æ•°çš„åå­—çš„æšä¸¾ã€‚å¦‚æœæ²¡æœ‰åˆå§‹åŒ–å‚æ•°å®šä¹‰ï¼Œè¯¥æ–¹æ³•å°†è¿”å›ç©ºæšä¸¾ã€‚ public abstract String getInitParameter(String paramString) â€“ è¿™ç§æ–¹æ³•å¯ä»¥é€šè¿‡åå­—æ¥è·å–ç‰¹å®šçš„åˆå§‹åŒ–å‚æ•°å€¼ã€‚å¦‚æœå‚æ•°çš„åç§°ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›nullã€‚ ServletContext æ¥å£javax.servlet.ServletContextæ¥å£ç”¨äºæè¿°åº”ç”¨ç¨‹åºçš„ç›¸å…³ä¿¡æ¯ã€‚ServletContextæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œå¯ç”¨äºwebåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰çš„servletã€‚å½“æˆ‘ä»¬æƒ³è¦ä¸€äº›åˆå§‹åŒ–çš„å‚æ•°å¯ç”¨äºwebåº”ç”¨ç¨‹åºä¸­å¤šä¸ªæˆ–å…¨éƒ¨servletæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ServletContextå¯¹è±¡å¹¶ä¸”åœ¨web.xmlä¸­ä½¿ç”¨&lt; context-param&gt;æ ‡ç­¾å®šä¹‰å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ServletConfig ä¸­çš„ getServletContext()æ–¹æ³•å¾—åˆ°ServletContextå¯¹è±¡ã€‚ ServletContextæ¥å£ä¸­çš„ä¸»è¦æ–¹æ³•ï¼š public abstract ServletContext getContext(String uripath) â€“ è¿™ä¸ªæ–¹æ³•è¿”å›æŒ‡å®šçš„uripathçš„ServletContextå¯¹è±¡ï¼Œå¦‚æœuripathä¸å¯ç”¨æˆ–ä¸å¯è§åˆ™è¿”å›nullã€‚ public abstract URL getResource(String path) throws MalformedURLException â€“ è¿”å›çš„ä¸€ä¸ªä»£è¡¨æŸä¸ªèµ„æºçš„URLå¯¹è±¡ã€‚èµ„æºå¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ï¼Œç”šè‡³æ˜¯ä¸çŸ¥é“å¦‚ä½•è·å–èµ„æºçš„å…·ä½“ç»†èŠ‚çš„è¿œç¨‹ç½‘ç»œç«™ç‚¹ã€‚ public abstract InputStream getResourceAsStream(String path) â€“ è¿™ä¸ªæ–¹æ³•è¿”å›ç»™å®šçš„èµ„æºè·¯å¾„çš„ä¸€ä¸ªè¾“å…¥æµå¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿”å›nullã€‚ public abstract RequestDispatcher getRequestDispatcher(String urlpath) â€“ è¿™ä¸ªæ–¹æ³•ä¸€èˆ¬è¢«ç”¨äºè·å¾—å¯¹äºå¦å¤–ä¸€ä¸ªservletçš„å¼•ç”¨ã€‚è·å–åˆ°RequestDispatcherå¯¹è±¡ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡ä»–æŠŠä¸€ä¸ªè¯·æ±‚è½¬å‘å‡ºå»(forwardæˆ–è€…include)ã€‚ public abstract void log(String msg) â€“ è¯¥æ–¹æ³•ç”¨äºæŠŠæŒ‡å®šçš„æ¶ˆæ¯å­—ç¬¦ä¸²å†™å…¥servletæ—¥å¿—æ–‡ä»¶ä¸­ã€‚ public abstract Object getAttribute(String name) â€“ æŒ‰ç…§æŒ‡å®šçš„nameè¿”å›å¯¹è±¡å±æ€§ã€‚å¯ä»¥ä½¿ç”¨public abstract Enumeration getAttributeNames()æ´»çš„æ‰€æœ‰å¯¹è±¡å±æ€§çš„æšä¸¾ã€‚ public abstract void setAttribute(String paramString, Object paramObject) â€“ è¯¥æ–¹æ³•ç”¨äºåœ¨åº”ç”¨çš„èŒƒå›´å†…è®¾ç½®å±æ€§ã€‚è¯¥å±æ€§å¯ä»¥è¢«å¯ä»¥è®¿é—®å½“å‰ServletContextçš„æ‰€æœ‰servleè·å–åˆ°ã€‚å¯ä»¥ä½¿ç”¨public abstract void removeAttribute(String paramString)åˆ é™¤ä¸€ä¸ªå±æ€§ã€‚ String getInitParameter(String name) â€“ è¯¥æ–¹æ³•ç”¨äºè¿”å›åœ¨web.xmlä¸­å®šä¹‰çš„åˆå§‹åŒ–å‚æ•°çš„å€¼ã€‚å¦‚æœæŒ‡å®šçš„nameåœ¨web.xmlä¸­å¹¶æ²¡æœ‰åŒ¹é…åˆ°ï¼Œåˆ™è¿”å›nullã€‚å¯ä»¥ä½¿ç”¨Enumeration getInitParameterNames()å¾—åˆ°æ‰€æœ‰åˆå§‹åŒ–å‚æ•°çš„åç§°çš„æšä¸¾ã€‚ boolean setInitParameter(String paramString1, String paramString2) â€“ å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•è®¾ç½®åº”ç”¨ä¸­çš„åˆå§‹åŒ–å‚æ•°ã€‚ ServletRequest æ¥å£ServletRequestæ¥å£æ˜¯ç”¨æ¥å‘servletæä¾›å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾Servletå®¹å™¨çš„æ—¶å€™ï¼Œä»–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªServletRequestå¯¹è±¡ï¼Œå¹¶å°†å…¶ä¼ é€’å¯¹åº”çš„servletçš„service()æ–¹æ³•ã€‚ ServletRequestæ¥å£ä¸­çš„ä¸»è¦æ–¹æ³•ï¼š Object getAttribute(String name) â€“ è¿”å›æŒ‡å®šçš„å‚æ•°åå¯¹åº”çš„å±æ€§å€¼ã€‚å¦‚æœå¯¹åº”çš„å‚æ•°ä¸å­˜åœ¨åˆ™è¿”å›nullã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨getAttributeNames()æ–¹æ³•æ¥è·å–è¯·æ±‚ä¸­çš„æ‰€æœ‰å±æ€§åç§°çš„æšä¸¾ã€‚æ¥å£ä¸­åŒæ ·æä¾›äº†è®¾ç½®å€¼å’Œåˆ é™¤å€¼çš„æ–¹æ³•ã€‚ String getParameter(String name) â€“ ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›è¯·æ±‚å‚æ•°å€¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨getParameterNames()æ–¹æ³•æ¥è·å–è¯·æ±‚å‚æ•°åç§°çš„æšä¸¾ã€‚ String getServerName() â€“ è¿”å›æœåŠ¡å™¨çš„ä¸»æœºå int getServerPort() â€“ è¿”å›æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£å·ã€‚ ServletRequestçš„å­æ¥å£HttpServletRequestä¸­è¿˜åŒ…å«äº†ä¸€äº›å’Œsessionã€cookiesç­‰ç›¸å…³çš„æ–¹æ³•ã€‚ è¯‘è€…æ³¨ï¼šè¯¥æ¥å£ä¸­æä¾›äº†getAttributeå’ŒgetParameterä¸¤ä¸ªæ–¹æ³•ï¼Œéƒ½æ˜¯ç”¨äºè·å–å‚æ•°ï¼ˆå±æ€§ï¼‰å€¼çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæˆ–è€…è¯´Attributeå’ŒParameterçš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ ç­”ï¼š æ¥æºä¸åŒ å‚æ•°ï¼ˆparameterï¼‰æ˜¯ä»å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¸­ç”±ç”¨æˆ·æä¾›çš„ï¼Œè‹¥æ˜¯GETæ–¹æ³•æ˜¯ä»URLä¸­ æä¾›çš„ï¼Œè‹¥æ˜¯POSTæ–¹æ³•æ˜¯ä»è¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰ä¸­æä¾›çš„ï¼› å±æ€§ï¼ˆattributeï¼‰æ˜¯æœåŠ¡å™¨ç«¯çš„ç»„ä»¶ï¼ˆJSPæˆ–è€…Servletï¼‰åˆ©ç”¨requst.setAttributeï¼ˆï¼‰è®¾ç½®çš„. æ“ä½œä¸åŒ å‚æ•°ï¼ˆparameterï¼‰çš„å€¼åªèƒ½è¯»å–ä¸èƒ½ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.getParameter()è¯»å–ï¼› å±æ€§ï¼ˆattributeï¼‰çš„å€¼æ—¢å¯ä»¥è¯»å–äº¦å¯ä»¥ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.setAttribute(),è®¾ç½®å¯ä½¿ç”¨request.getAttribute() æ•°æ®ç±»å‹ä¸åŒ å‚æ•°ï¼ˆparameterï¼‰ä¸ç®¡å‰å°ä¼ æ¥çš„å€¼è¯­ä¹‰æ˜¯ä»€ä¹ˆï¼Œåœ¨æœåŠ¡å™¨è·å–æ—¶éƒ½ä»¥Stringç±»å‹çœ‹å¾…ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯çš„å‚æ•°å€¼åªèƒ½æ˜¯ç®€å•ç±»å‹çš„å€¼ï¼Œä¸èƒ½æ˜¯å¤æ‚ç±»å‹ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯¹è±¡ã€‚ å±æ€§ï¼ˆattributeï¼‰çš„å€¼å¯ä»¥æ˜¯ä»»æ„ä¸€ä¸ªObjectç±»å‹ã€‚ ServletResponse æ¥å£servletä½¿ç”¨ServletResponseå‘å®¢æˆ·ç«¯å‘é€å“åº”ã€‚å’Œæ¯ServletRequestç±»ä¼¼ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾Servletå®¹å™¨çš„æ—¶å€™ï¼Œä»–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªServletResponseå¯¹è±¡ï¼Œå¹¶å°†å…¶ä¼ é€’å¯¹åº”çš„servletçš„service()æ–¹æ³•ã€‚æœ€ç»ˆï¼Œè¯¥responseå¯¹è±¡ç”¨äºç»™å®¢æˆ·ç«¯ç”Ÿæˆhtmlå“åº”ã€‚ ServletResponseæ¥å£ä¸­çš„ä¸»è¦æ–¹æ³•ï¼š void addCookie(Cookie cookie) â€“ å‘å“åº”ä¸­æ·»åŠ cookie void addHeader(String name, String value)â€“ è®¾ç½®å“åº”å¤´ String encodeURL(java.lang.String url) â€“ é€šè¿‡é‡å†™Urlçš„æ–¹å¼æ”¯æŒsessionï¼Œåœ¨Urlä¸­å¢åŠ sessionIdï¼Œå¦‚æœä¸éœ€è¦é‡å†™ï¼Œç›´æ¥è¿”å›è¯¥url String getHeader(String name) â€“ è¿”å›æŒ‡å®šçš„å¤´ä¿¡æ¯ã€‚ void sendRedirect(String location)â€“é‡å®šå‘åˆ°æŒ‡å®šçš„åœ°å€ void setStatus(int sc) â€“ è®¾ç½®å“åº”çš„çŠ¶æ€ç  RequestDispatcher æ¥å£RequestDispatcher æ¥å£ç”¨äºæŠŠä¸€ä¸ªè¯·æ±‚è½¬å‘ç»™åŒä¸€ä¸ªservletä¸Šä¸‹æ–‡ä¸­çš„å…¶ä»–çš„èµ„æºï¼ˆHtmlã€jspã€servletï¼‰æ¥å¤„ç†ã€‚ä¹Ÿå¯ä»¥ç”¨å®ƒæ¥æŠŠå¦ä¸€ä¸ªèµ„æºçš„å†…å®¹åŒ…å«åˆ°å“åº”ä¸­ã€‚æ­¤æ¥å£ç”¨äºåŒä¸€ä¸ªservletä¸Šä¸‹æ–‡ä¸­çš„servletç›¸äº’æ²Ÿé€šã€‚ RequestDispatcher æ¥å£çš„ä¸»è¦æ–¹æ³•ï¼š void forward(ServletRequest request, ServletResponse response) â€“ æŠŠä¸€ä¸ªservletçš„è¯·æ±‚è½¬å‘åˆ°æœåŠ¡å™¨ä¸Šçš„å…¶ä»–èµ„æºä¸­ï¼ˆHtmlã€jspã€servletï¼‰ã€‚ void include(ServletRequest request, ServletResponse response) â€“ æŠŠå¦ä¸€ä¸ªèµ„æºçš„å†…å®¹åŒ…å«åˆ°å½“å‰å“åº”ä¸­ã€‚ è¯‘è€…æ³¨ï¼šforwardå’Œincludeçš„åŒºåˆ«ï¼š å¦‚æœä½¿ç”¨forwardè·³è½¬ï¼Œforwardè¯­å¥åé¢çš„responseè¾“å‡ºåˆ™ä¸ä¼šæ‰§è¡Œï¼Œä¼šè·³è½¬åˆ°forwardæŒ‡å®šçš„servletä¸­å»æ‰§è¡Œã€‚ ç”¨includeæ¥è·³è½¬ï¼Œåˆ™includeçš„servletæ‰§è¡Œå®Œåï¼Œå†è¿”å›åˆ°åŸæ¥çš„servletæ‰§è¡Œforwardè¯­å¥åé¢çš„responseçš„è¾“å‡ºã€‚ åœ¨servletä¸­å¯ä»¥ä½¿ç”¨getRequestDispatcher(String path)æ¥è·å–ä¸€ä¸ªRequestDispatcherã€‚è·¯å¾„å¿…é¡»ä»¥/å¼€å¤´ï¼Œå¹¶ä¸”æ˜¯é’ˆå¯¹äºå½“å‰contextçš„æ ¹è·¯å¾„çš„ç›¸å¯¹åœ°å€ã€‚ GenericServlet ç±»GenericServletæ˜¯ä¸€ä¸ªå®ç°ç±»Servlet, ServletConfig å’Œ Serializable çš„æŠ½è±¡ç±»ã€‚ä»–æä¾›äº†Servletç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸»è¦æ–¹æ³•ä»¥åŠServletConfigä¸­çš„æ–¹æ³•çš„é»˜è®¤å®ç°ã€‚å½“æˆ‘ä»¬å®šä¹‰è‡ªå·±çš„servletçš„æ—¶å€™ï¼Œåªè¦ç»§æ‰¿äº†è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦é‡å†™æˆ‘ä»¬å…³æ³¨çš„æ–¹æ³•å°±å¯ä»¥äº†ï¼Œå…¶ä»–çš„ä¸å…³æ³¨çš„æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨å…¶é»˜è®¤å®ç°ã€‚è¯¥ç±»ä¸­å®šä¹‰çš„å¤§éƒ¨åˆ†æ–¹æ³•éƒ½æ˜¯è®©ç”¨æˆ·æ›´æ”¾æ–¹ä¾¿çš„ä½¿ç”¨Servletå’ŒServletConfigæ¥å£ä¸­å®šä¹‰çš„å¸¸ç”¨æ–¹æ³•ã€‚ GenericServlet ç±»ä¸­æœ‰ä¸€ä¸ªé‡è¦çš„æ–¹æ³•â€”â€”æ— å‚æ•°çš„initæ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬å¿…é¡»åœ¨å¤„ç†è¯·æ±‚ä¹‹å‰åˆå§‹åŒ–ä¸€äº›èµ„æºï¼Œé‚£ä¹ˆå¯ä»¥é‡å†™è¯¥æ–¹æ³•ã€‚ HTTPServlet ç±»HTTPServlet ç±»æ˜¯GenericServletç±»çš„å­ç±»ï¼Œä¸»è¦ä¸ºåŸºäºHTTPåˆ›å»ºçš„webåº”ç”¨ç¨‹åºæä¾›äº†ä¸€äº›æ”¯æŒã€‚å…¶ä¸­å®šä¹‰äº†ä¸€äº›å¯é‡å†™HTTPæ–¹æ³•ã€‚ doGet(), ç”¨äºå¤„ç†getè¯·æ±‚ doPost(), ç”¨äºå¤„ç†postè¯·æ±‚ doPut(), ç”¨äºå¤„ç†putè¯·æ±‚ doDelete(), ç”¨äºå¤„ç†deleteè¯·æ±‚ Servletså±æ€§ï¼ˆAttributesï¼‰Servletå±æ€§ç”¨äºservletä¹‹é—´çš„æ²Ÿé€šï¼Œå¯ä»¥åœ¨webåº”ç”¨ç¨‹åºä¸­è®¾ç½®ã€è·å–ç”šè‡³åˆ é™¤å±æ€§å€¼ã€‚servletå±æ€§æœ‰ä¸‰ç§èŒƒå›´ï¼šrequestã€sessionã€application ServletRequestï¼Œ HttpSession å’Œ ServletContextæ¥å£ä¸ºrequestã€sessionå’ŒapplicationèŒƒå›´æä¾›äº†get/set/removeçš„æ–¹æ³•ã€‚ Servlet 3ä¸­çš„æ³¨è§£åœ¨servlet 3ä¹‹å‰ï¼Œæ‰€ä»¥çš„servletæ˜ å°„å’Œåˆå§‹åŒ–å‚æ•°éƒ½æ˜¯å®šä¹‰åœ¨web.xmlæ–‡ä»¶ä¸­çš„ï¼Œéšç€åº”ç”¨ä¸­çš„servletæ•°é‡å¢å¤šï¼Œè¿™ç§æ–¹å¼å°±å¾ˆéš¾ç»´æŠ¤ã€‚ servlet 3ä¸­ä½¿ç”¨æ”¯æŒä½¿ç”¨javaæ³¨è§£æ¥å®šä¹‰servletã€filterã€listenerä»¥åŠåˆå§‹åŒ–å‚æ•°ã€‚ servlet 3 ä¸­ä¸»è¦çš„æ³¨è§£ï¼š WebServlet â€“ å¯ä»¥åœ¨servletç±»ä¸­ä½¿ç”¨è¯¥æ³¨è§£æ¥å®šä¹‰åˆå§‹åŒ–å‚æ•°ã€loadOnStartupçš„å€¼ã€descriptionä¿¡æ¯å’ŒurlåŒ¹é…æ¨¡å¼(pattern)ç­‰ã€‚è¯¥æ³¨è§£çš„å±æ€§ä¸­ vlaue æˆ–è€… urlPatterns é€šå¸¸æ˜¯å¿…éœ€çš„ï¼Œä¸”äºŒè€…ä¸èƒ½å…±å­˜ã€‚è¯¥æ³¨é‡Šå£°æ˜çš„ç±»å¿…é¡»ç»§æ‰¿HttpServletã€‚ WebInitParam â€“ è¯¥æ³¨è§£ç”¨äºç»™servlet æˆ–è€… filterå®šä¹‰åˆå§‹åŒ–å‚æ•°ï¼ˆåŒ…æ‹¬name,valueå’Œdescriptionï¼‰ã€‚å¯ä»¥åœ¨ WebFilter æˆ–è€… WebServletä¸­ä½¿ç”¨è¯¥æ³¨è§£ã€‚ WebFilter â€“ è¯¥æ³¨è§£ç”¨äºå£°æ˜ä¸€ä¸ªservletè¿‡æ»¤å™¨ã€‚ä½¿ç”¨è¯¥æ³¨è§£å£°æ˜çš„ç±»å¿…é¡»å®ç°javax.servlet.Filteræ¥å£ã€‚ WebListener â€“ è¯¥æ³¨è§£ç”¨äºå£°æ˜ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚ å‚è€ƒ [è¯‘]Java Servletåˆçº§çŸ¥è¯†","categories":[],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/tags/HTTP/"}]},{"title":"ã€è¯‘ã€‘å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList--clear vs removeAll ï¼ˆè½¬è½½ï¼‰","slug":"è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll","date":"2018-04-13T07:55:17.000Z","updated":"2018-04-13T08:01:13.361Z","comments":true,"path":"2018/04/13/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/","link":"","permalink":"https://hsb786.github.io/2018/04/13/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/","excerpt":"å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®clearæˆ–removeAllã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°java.lang.OutOfMemoryError: Java Heap Spaceã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚","text":"å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®clearæˆ–removeAllã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°java.lang.OutOfMemoryError: Java Heap Spaceã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚ Clear() vs RemoveAll(Collection c)ä¸ºäº†æ›´å¥½çš„æ¯”è¾ƒè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œé˜…è¯»ä»–ä»¬æºç æ˜¯å¾ˆé‡è¦çš„ã€‚å¯ä»¥åœ¨java.utils.ArrayListç±»ä¸­æ‰¾åˆ°clear()æ–¹æ³•ï¼Œä¸è¿‡ä¸ºäº†æ–¹ä¾¿æˆ‘å°†å®ƒå¼•å…¥åˆ°äº†è¿™é‡Œã€‚ä¸‹é¢çš„ä»£ç æ¥è‡ªJDK 1.7.0_40ç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³è¦å­¦ä¹ æ›´å¤šçš„æœ‰å…³æ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜çš„çŸ¥è¯†ï¼Œæˆ‘å¼ºçƒˆå»ºè®®é˜…è¯»Scott Oakså†™çš„Java Performance the Definitive Guide,å®ƒåŒ…å«äº†java 7å’Œä¸€ç‚¹java 8ã€‚ä¸‹é¢æ˜¯clear()çš„ä»£ç ç‰‡æ®µ: 12345678910/** * Removes all of the elements from this list.The list will * be empty after this call returns. */ public void clear() &#123; modCount++; // clear to let GC do its work for (int i = 0; i &lt; size; i++) elementData[i] = null; size = 0; &#125; å¤§å®¶å¯ä»¥çœ‹å‡ºï¼Œclear()åœ¨å¾ªç¯éå†ArrayListï¼Œå¹¶ä¸”å°†æ¯ä¸€ä¸ªå…ƒç´ éƒ½ç½®ä¸ºnullï¼Œä½¿å®ƒä»¬åœ¨æ²¡æœ‰è¢«å¤–éƒ¨å¼•ç”¨çš„æƒ…å†µä¸‹å¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚ç›¸ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨java.util.AbstractCollectionç±»ä¸­æŸ¥çœ‹removeAll(Collention c)çš„ä»£ç ï¼Œä¸‹é¢æ˜¯ä»£ç ç‰‡æ®µ: 12345678910111213public boolean removeAll(Collection&lt;?&gt; c) &#123; //åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºnull Objects.requireNonNull(c); boolean modified = false; Iterator&lt;?&gt; it = iterator(); while (it.hasNext()) &#123; if (c.contains(it.next())) &#123; it.remove(); modified = true; &#125; &#125; return modified; &#125; è¿™ä¸ªæ–¹æ³•ä¼šæ£€æŸ¥è¿­ä»£å™¨é¡ºåºè¿”å›çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦åŒ…å«åœ¨ç‰¹å®šçš„é›†åˆä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œè°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•å°†å®ƒä»é›†åˆä¸­ç§»é™¤ã€‚å› ä¸ºä¼šç”¨åˆ°containsæ–¹æ³•ï¼ŒremoveAllçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚æ‰€ä»¥åœ¨æƒ³è¦é‡ç½®ä¸€ä¸ªå¤§çš„ArrayListæ—¶ï¼Œè¿™ç§æ–¹æ³•æ˜¯ç»å¯¹ä¸å¯å–çš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…åœ¨é‡ç½®ä¸€ä¸ªåŒ…å«100Kä¸ªå…ƒç´ æ—¶çš„æ€§èƒ½å·®å¼‚ã€‚ åˆ é™¤ä¸€ä¸ªåŒ…å«100kä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´  æˆ‘æœ¬æ¥æƒ³åœ¨ä¾‹å­ä¸­å°è¯•é‡ç½®ä¸€ä¸ªåŒ…å«10Mä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼Œä¸è¿‡åœ¨è¶…è¿‡åŠä¸ªå°æ—¶ç­‰å¾…removeAll()ç»“æŸåï¼Œæˆ‘å†³å®šå°†å…ƒç´ çš„æ•°é‡é™ä¸º100Kã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªæ–¹æ³•çš„å·®è·ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„ã€‚removeAll()æ¯”clear()å¤šèŠ±è´¹äº†10000å€çš„æ—¶é—´ã€‚äº‹å®ä¸Šï¼Œåœ¨APIä¸­clear()å’ŒremoveAll(Collection c)è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç›®çš„æ˜¯ä¸åŒçš„ã€‚clear()æ–¹æ³•æ˜¯ä¸ºäº†é€šè¿‡åˆ é™¤æ‰€æœ‰å…ƒç´ è€Œé‡ç½®åˆ—è¡¨ï¼Œè€ŒremoveAll(Collection c)æ˜¯ä¸ºäº†ä»é›†åˆä¸­åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€ä¸ªæä¾›çš„é›†åˆä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸æ˜¯ä¸ºäº†ä»é›†åˆä¸­ç§»é™¤æ‰€æœ‰å…ƒç´ ã€‚æ‰€ä»¥å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æ‰€æœ‰å…ƒç´ ï¼Œç”¨clear(),å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€é›†åˆçš„å…ƒç´ ï¼Œé‚£ä¹ˆé€‰æ‹©removeAll(Collection c)æ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435import java.util.ArrayList; /** * Java Program to remove all elements from list in Java and comparing * performance of clearn() and removeAll() method. * * @author Javin Paul */ public class ArrayListResetTest &#123; private static final int SIZE = 100_000; public static void main(String args[]) &#123; // Two ArrayList for clear and removeAll ArrayList numbers = new ArrayList(SIZE); ArrayList integers = new ArrayList(SIZE); // Initialize ArrayList with 10M integers for (int i = 0; i &amp;lt; SIZE; i++) &#123; numbers.add(new Integer(i)); integers.add(new Integer(i)); &#125; // Empty ArrayList using clear method long startTime = System.nanoTime(); numbers.clear(); long elapsed = System.nanoTime() - startTime; System.out.println(&quot;Time taken by clear to empty ArrayList of 1M elements (ns): &quot; + elapsed); // Reset ArrayList using removeAll method startTime = System.nanoTime(); integers.removeAll(integers); long time = System.nanoTime() - startTime; System.out.println(&quot;Time taken by removeAll to reset ArrayList of 1M elements (ns): &quot; + time); &#125; &#125; Output: Time taken by clear to empty ArrayList of 100000 elements (ns): 889619 Time taken by removeAll to reset ArrayList of 100000 elements (ns): 36633112126 ç”±äºç¨‹åºä½¿ç”¨äº†ä¸¤ä¸ªarrayListå­˜å‚¨Integersï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶è¦ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå°¤å…¶æ˜¯ä½ æƒ³æ¯”è¾ƒåœ¨åˆ—è¡¨å­˜æœ‰1Mä¸ªå…ƒç´ æ—¶ï¼Œä¸¤ç§æ–¹æ³•çš„æ€§èƒ½å·®å¼‚ã€‚å¦å¤–ï¼Œç”±äºä½¿ç”¨äº†åœ¨æ•°å­—ä¸­åŠ å…¥ä¸‹åˆ’çº¿çš„ç‰¹æ€§ï¼Œæ‰€ä»¥éœ€è¦java7æ¥è¿è¡Œã€‚å¦‚æœæ²¡æœ‰JDK7ï¼Œä¹Ÿå¯ä»¥ç§»é™¤SIZEå¸¸é‡ä¸­çš„ä¸‹åˆ’çº¿ã€‚ å‚è€ƒ ã€è¯‘ã€‘å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayListâ€“clear vs removeAll","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ã€è¯‘ã€‘ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll ï¼ˆè½¬è½½ï¼‰","slug":"è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll","date":"2018-04-13T07:34:36.000Z","updated":"2018-04-13T07:49:23.236Z","comments":true,"path":"2018/04/13/è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll/","link":"","permalink":"https://hsb786.github.io/2018/04/13/è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll/","excerpt":"åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:Producer(ç”Ÿäº§è€…)å’ŒConsumer(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚","text":"åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:Producer(ç”Ÿäº§è€…)å’ŒConsumer(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚ åœ¨ä»£ç ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨waitå’Œnotifyå°½ç®¡waitå’Œnotifyæ˜¯ç›¸å½“åŸºç¡€çš„æ¦‚å¿µï¼Œå¹¶ä¸”ä»–ä»¬å®šä¹‰åœ¨Objectç±»ä¸­ï¼Œä½†è¦æƒ³åœ¨ä»£ç ä¸­ä½¿ç”¨ä»–ä»¬å¹¶éæ˜“äº‹ã€‚ä½ å¯ä»¥åœ¨é¢è¯•ä¸­è®©é¢è¯•è€…é€šè¿‡æ‰‹å†™ä»£ç è§£å†³Producerè€…å’ŒConsumerè€…é—®é¢˜æ¥éªŒè¯ï¼Œæˆ‘ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ä¼šçŠ¯åœ¨é”™è¯¯çš„åœ°æ–¹åŒæ­¥ï¼Œæ²¡æœ‰åœ¨æ­£ç¡®çš„å¯¹è±¡ä¸Šè°ƒç”¨waitä¹‹ç±»çš„é”™ã€‚è®²çœŸï¼Œè¿™äº›å¸¸å¸¸ä¼šå›°æƒ‘è®¸å¤šç¨‹åºå‘˜ã€‚ç¬¬ä¸€ä¸ªå›°æƒ‘ç‚¹æ¥è‡ªæ€æ ·è°ƒç”¨waitæ–¹æ³•ï¼Œå› ä¸ºwaitæ–¹æ³•å¹¶ä¸æ˜¯å®šä¹‰åœ¨Threadç±»ä¸­ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•çš„Thread.wait()ã€‚è€Œè®¸å¤šJavaå¼€å‘è€…ä¹ æƒ¯äºThread.sleep(),æ‰€ä»¥å¸¸å¸¸é”™è¯¯çš„æƒ³ç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨waitã€‚å®é™…ä¸Šï¼Œwait()æ–¹æ³•éœ€è¦åœ¨ä¸€ä¸ªè¢«ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨ï¼Œä¾‹å¦‚åœ¨Producerè€…å’Œæ¶ˆè´¹Consumerçš„é—®é¢˜ä¸­ï¼Œä¸¤ä¸ªçº¿ç¨‹å…±äº«å¯¹è±¡æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ã€‚ç¬¬äºŒä¸ªå›°æƒ‘ç‚¹æ¥è‡ªwaitæ–¹æ³•åº”è¯¥åœ¨åŒæ­¥å—è¿˜æ˜¯åŒæ­¥æ–¹æ³•ä¸­è°ƒç”¨ï¼Ÿå¦‚æœä½¿ç”¨åŒæ­¥å—ï¼Œé‚£ä¹ˆå“ªä¸ªå¯¹è±¡åº”è¯¥æ”¾åˆ°åŒæ­¥å—ä¸­ï¼Ÿè¿™ä¸ªå¯¹è±¡å’Œä½ æƒ³è¦è·å¾—é”çš„å¯¹è±¡åº”è¯¥æ˜¯åŒä¸€ä¸ªã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„é˜Ÿåˆ—ã€‚ åœ¨å¾ªç¯ä¸­ä½¿ç”¨waitå’Œnotifyï¼Œè€Œä¸æ˜¯Ifä»£ç å—ä¸­åœ¨ä½ å·²ç»äº†è§£éœ€è¦åœ¨ä¸€ä¸ªå…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨waitæ–¹æ³•åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å­¦ä¼šé¿å…è®¸å¤šjavaå¼€å‘è€…çŠ¯çš„é”™â€”åœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitè€Œä¸æ˜¯whileå¾ªç¯ä¸­ã€‚å› ä¸ºéœ€è¦åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹è°ƒç”¨waitï¼Œæ¯”å¦‚Producerçº¿ç¨‹è¦åœ¨é˜Ÿåˆ—æ»¡äº†çš„æƒ…å†µä¸‹è°ƒç”¨waitï¼Œæ‰€ä»¥ç¬¬ä¸€ååº”éƒ½æ˜¯ä½¿ç”¨Ifè¯­å¥ã€‚ä½†æ˜¯ï¼Œåœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitä¼šäº§ç”Ÿbugï¼Œå› ä¸ºçº¿ç¨‹å­˜åœ¨ä¸€å®šçš„å¯èƒ½åœ¨ç­‰å¾…æ¡ä»¶æ²¡æœ‰æ”¹å˜çš„æƒ…å†µä¸‹å‡å”¤é†’(spurious wake up)ã€‚æ‰€ä»¥å¦‚æœæ²¡æœ‰ä½¿ç”¨å¾ªç¯åœ¨çº¿ç¨‹å”¤é†’åæ£€æŸ¥ç­‰å¾…æ¡ä»¶ï¼Œå¯èƒ½ä¼šé€ æˆå°è¯•åœ¨å·²ç»æ»¡äº†çš„é˜Ÿåˆ—ä¸­æ’å…¥å…ƒç´ æˆ–è€…åœ¨ç©ºäº†çš„é˜Ÿåˆ—ä¸­å–å…ƒç´ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åœ¨whileå¾ªç¯ä¸­è°ƒç”¨waitè€Œä¸æ˜¯ifã€‚ Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­ä¸‹é¢æ˜¯åœ¨Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹(PRODUCTORå’ŒCONSUMER)ï¼Œç”¨ç»§æ‰¿äº†Threadç±»çš„Producerå’ŒConsumerç±»å®ç°ã€‚Prodcuerå’ŒConsumerçš„ä¸šåŠ¡é€»è¾‘å†™åœ¨ä»–ä»¬å„è‡ªçš„run()æ–¹æ³•ä¸­ã€‚å¹¶ä¸”å®ç°ä¸€ä¸ªLinkedListï¼Œå½“åšå…±äº«é˜Ÿåˆ—ã€‚Produceråœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ä¸æ–­åœ¨é˜Ÿåˆ—ä¸­æ’å…¥éšæœºæ•°ï¼Œç›´åˆ°é˜Ÿåˆ—æ»¡äº†ã€‚æˆ‘ä»¬ä¼šæ£€æŸ¥while(queue.size == maxSize),éœ€è¦æ³¨æ„çš„æ˜¯åœ¨æ£€æŸ¥ä¹‹å‰éœ€è¦ç»™é˜Ÿåˆ—åŠ ä¸ŠåŒæ­¥é”ä»¥ä¿è¯åœ¨æ£€æŸ¥æ—¶æ²¡æœ‰å¦ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹é˜Ÿåˆ—ã€‚å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼ŒPRODUCERçº¿ç¨‹å°±ä¼šä¼‘çœ ï¼Œç›´åˆ°CONSUMERæ¶ˆè´¹äº†é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¹¶ä¸”è°ƒç”¨notify()æ–¹æ³•é€šçŸ¥PRODUCERçº¿ç¨‹ã€‚waitå’Œnotifyéƒ½æ˜¯åœ¨å…±äº«çš„å¯¹è±¡(æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯é˜Ÿåˆ—)ä¸Šè°ƒç”¨çš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112import java.util.LinkedList;import java.util.Queue;import java.util.Random;/** * Simple Java program to demonstrate How to use wait, notify and notifyAll() * method in Java by solving producer consumer problem. * * @author Javin Paul */public class MultipleThread &#123; public static void main(String args[]) &#123; System.out.println(&quot;How to use wait and notify method in Java&quot;); System.out.println(&quot;Solving Producer Consumper Problem&quot;); Queue&lt;Integer&gt; buffer = new LinkedList&lt;&gt;(); int maxSize = 10; Thread producer = new Producer(buffer, maxSize, &quot;PRODUCER&quot;); Thread consumer = new Consumer(buffer, maxSize, &quot;CONSUMER&quot;); producer.start(); consumer.start(); &#125;&#125;/** * Producer Thread will keep producing values for Consumer * to consumer. It will use wait() method when Queue is full * and use notify() method to send notification to Consumer * Thread. * @author WINDOWS 8 * */class Producer extends Thread &#123; private Queue&lt;Integer&gt; queue; private int maxSize; public Producer(Queue&lt;Integer&gt; queue, int maxSize, String name) &#123; super(name); this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run() &#123; while (true) &#123; synchronized (queue) &#123; while (queue.size() == maxSize) &#123; try &#123; System.out .println(&quot;Queue is full, &quot; + &quot;Producer thread waiting for &quot; + &quot;consumer to take something from queue&quot;); queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; Random random = new Random(); int i = random.nextInt(); System.out.println(&quot;Producing value : &quot; + i); queue.add(i); queue.notifyAll(); &#125; &#125; &#125;&#125;/** * Consumer Thread will consumer values form shared queue. * It will also use wait() method to wait if queue is * empty. It will also use notify method to send * notification to producer thread after consuming values * from queue. * @author WINDOWS 8 **/class Consumer extends Thread &#123; private Queue&lt;Integer&gt; queue; private int maxSize; public Consumer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123; super(name); this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run() &#123; while (true) &#123; synchronized (queue) &#123; while (queue.isEmpty()) &#123; System.out.println(&quot;Queue is empty,&quot; + &quot;Consumer thread is waiting&quot; + &quot; for producer thread to put something in queue&quot;); try &#123; queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; System.out.println(&quot;Consuming value : &quot; + queue.remove()); queue.notifyAll(); &#125; &#125; &#125;&#125;Output How to use wait and notify method in Java Solving Producer Consumper Problem Queue is empty,Consumer thread is waiting for producer thread to put something in queue Producing value : -1692411980 Producing value : 285310787 Producing value : -1045894970 Producing value : 2140997307 Producing value : 1379699468 Producing value : 912077154 Producing value : -1635438928 Producing value : -500696499 Producing value : -1985700664 Producing value : 961945684 Queue is full, Producer thread waiting for consumer to take something from queue Consuming value : -1692411980 Consuming value : 285310787 Consuming value : -1045894970 Consuming value : 2140997307 Consuming value : 1379699468 Consuming value : 912077154 Consuming value : -1635438928 Consuming value : -500696499 Consuming value : -1985700664 Consuming value : 961945684 Queue is empty,Consumer thread is waiting for producer thread to put something in queue ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAlléœ€è¦æ³¨æ„çš„ åœ¨Javaä¸­å¯ä»¥ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllå®Œæˆå¤šçº¿ç¨‹(ä¸ä»…ä»…æ˜¯ä¸¤ä¸ªçº¿ç¨‹)çš„å†…éƒ¨é€šä¿¡ã€‚ åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllï¼Œå¦åˆ™JVMä¼šæŠ›å‡ºIllegalMonitorStateException åœ¨å¾ªç¯ä¸­è°ƒç”¨waitï¼Œnotifyã€‚ åœ¨çº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨wait åå‘é€‰æ‹©notifyAllï¼Œè€Œä¸æ˜¯notify","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"ã€è¯‘ã€‘Java8ä¸­çš„æ‰©å±•(default/extension)æ–¹æ³• ï¼ˆè½¬è½½ï¼‰","slug":"Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•","date":"2018-04-13T07:14:18.000Z","updated":"2018-04-13T07:24:37.104Z","comments":true,"path":"2018/04/13/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/","link":"","permalink":"https://hsb786.github.io/2018/04/13/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/","excerpt":"Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨defaultå’Œstaticä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚","text":"Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨defaultå’Œstaticä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚ Defaultæ–¹æ³•çš„ä¾‹å­Java 8è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡defaultå…³é”®å­—ä¸ºæ¥å£æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•ã€‚è¿™ä¸€ç‰¹æ€§ä¹Ÿè¢«ç§°ä½œExtension(æ‰©å±•)æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ç¬¬ä¸€ä¸ªä¾‹å­ï¼š 12345678interface Multiplication&#123; int multiply(int a, int b); default int square(int a)&#123; return multiply(a, a); &#125; &#125; é™¤äº†æŠ½è±¡æ–¹æ³•multiply()ä¹‹å¤–ï¼Œæ¥å£Multiplicationè¿˜åŒ…å«ä¸€ä¸ªdefaultæ–¹æ³•square()ã€‚ä»»ä½•å®ç°Multiplicationæ¥å£çš„ç±»åªéœ€å®ç°æŠ½è±¡æ–¹æ³•multiplyï¼Œdefaultæ–¹æ³•square()å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ 12345678Multiplication product = new Multiplication()&#123; @Override public int multiply(int x, int y)&#123; return x*y; &#125;&#125;; int square = product.square(2); int multiplication = product.multiply(2, 3); productæ˜¯ä¸ªåŒ¿åç±»ã€‚è¿™æ®µä»£ç æœ‰ç‚¹å•°å—¦äº†ï¼Œç”¨äº†6è¡Œå®ç°ä¸€ä¸ªç®€å•åœ°ä¹˜æ³•çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨lambdaè¡¨è¾¾å¼æ¥ç®€åŒ–ä¸€ä¸‹ä»£ç ï¼Œlambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯Java 8ä¸­æ–°å¼•å…¥çš„ã€‚å› ä¸ºæˆ‘ä»¬çš„æ¥å£åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œè€Œä¸”lambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯SAM(Single Abstract methodå•ä¸€æŠ½è±¡æ–¹æ³•)ç±»å‹çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨lambdaè¡¨è¾¾å¼æ¥æ›¿ä»£åŒ¿åç±»å°†ä»£ç ç®€åŒ–æˆä¸‹é¢çš„æ ·å­ã€‚123Multiplication lambda = (x, y) -&gt; x*y; int product = lambda.multiply(3, 4); int square = lambda.square(4); ä»¥ä¸Šå°±æ˜¯åœ¨æ¥å£ä¸­ä½¿ç”¨defaultæ–¹æ³•çš„ä¾‹å­ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ¯«æ— é¡¾è™‘çš„åœ¨æ—§çš„æ¥å£ä¸­æ‰©å±•æ–°çš„æ–¹æ³•ï¼Œåªè¦è¿™äº›æ–¹æ³•æ˜¯defaultæˆ–staticçš„å°±ä¸ç”¨æ‹…å¿ƒä¼šç ´åæ¥å£çš„å®ç°ç±»ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142/**Java Program to demonstrate use of default method in Java 8. * You can define non-abstract method by using default keyword, and more * than one default method is permitted, which allows you to ship default skeletal * implementation on interface itself. * @author Javin Paul */ public class Java8DefaultMethodDemo&#123; public static void main(String args[]) &#123; // Implementing interface using Anonymous class Multiplication product = new Multiplication()&#123; @Override public int multiply(int x, int y)&#123; return x*y; &#125; &#125;; int squareOfTwo = product.square(2); int cubeOfTwo = product.cube(2); System.out.println(&quot;Square of Two : &quot; + squareOfTwo); System.out.println(&quot;Cube of Two : &quot; + cubeOfTwo); // Since Multiplication has only one abstract method, it can // also be implemented using lambda expression in Java 8 Multiplication lambda = (x, y) -&gt; x*y; int squareOfThree = lambda.square(3); int cubeOfThree = lambda.cube(3); System.out.println(&quot;Square of Three : &quot; + squareOfThree); System.out.println(&quot;Cube of Three : &quot; + cubeOfThree); &#125; &#125; interface Multiplication&#123; int multiply(int a, int b); default int square(int a)&#123; return multiply(a, a); &#125; default int cube(int a)&#123; return multiply(multiply(a, a), a); &#125; &#125; Output : Square of Two : 4 Cube of Two : 8 Square of Three : 9 Cube of Three : 27 è¿™æ˜¯ä¸ªå¾ˆå¥½çš„å…³äºå¦‚ä½•ä½¿ç”¨defaultæ–¹æ³•åœ¨æ¥å£ä¸­æ–¹ä¾¿çš„æ·»åŠ æ–¹æ³•çš„ä¾‹å­ã€‚ä¹Ÿå±•ç¤ºäº†å¦‚ä½•é¿å…ä¸€ä¸ªé¢å¤–çš„å¸®åŠ©ç±»ï¼Œæ¯”å¦‚Collectionsç±»ã€‚å®ƒä»…ä»…æä¾›äº†ä¸€äº›ç”¨äºCollectionçš„å·¥å…·æ–¹æ³•ï¼Œè€Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨Collectionä¸­å®šä¹‰è¿™äº›æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•multiply(a,b)çš„æ¥å£Multiplicationï¼Œæ¥å£è¿˜åŒ…æ‹¬ä¸¤ä¸ªä¾èµ–äºmultiply(a,b)æ–¹æ³•çš„éæŠ½è±¡æ–¹æ³•square(a)å’Œcube(b)ã€‚æ¥å£çš„å®ç°ç±»åªéœ€è¦å®ç°multiply(a,b)æ–¹æ³•ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨square(a)å’Œcube(b)æ–¹æ³•äº†ã€‚ defaultæ–¹æ³•çš„å…³é”®ç‚¹ åœ¨Java8ä¸­ä½ å¯ä»¥åœ¨æ¥å£ä¸­æ·»åŠ defaultæ–¹æ³• defaultæ–¹æ³•çš„å‡ºç°ä½¿å¾—æ¥å£å’ŒæŠ½è±¡ç±»çš„ä¸åŒå˜å¾—æ¨¡ç³Šã€‚æ‰€ä»¥ï¼Œå½“åœ¨é¢è¯•ä¸­è¢«é—®åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåˆ«å¿˜äº†æä¸€ä¸‹ï¼Œä»¥å‰åªèƒ½é€šè¿‡æŠ½è±¡ç±»å®ç°çš„äº‹æƒ…ï¼Œç°åœ¨ä¹Ÿå¯ä»¥é€šè¿‡defaultæ–¹æ³•å®ç°äº†ã€‚ defaultå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å…³é”®å­—ï¼Œåœ¨JDK1.1ä¸­å°±æ˜¯ä¿ç•™å…³é”®å­— æ¥å£ä¸­defaultæ–¹æ³•çš„æ•°é‡æ²¡æœ‰é™åˆ¶ å¦‚æœæ¥å£Cç»§æ‰¿äº†æ¥å£Aå’ŒBï¼Œå¦‚æœAå’ŒBä¸­æ‹¥æœ‰ä¸€æ ·çš„defaultæ–¹æ³•ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ã€‚ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œè¿™åœ¨Java 8ä¸­æ˜¯ä¸å…è®¸çš„ã€‚æ‰€ä»¥å½“defaultæ–¹æ³•æœ‰å†²çªæ—¶ï¼Œæ˜¯ä¸å¯ä»¥å¤šç»§æ‰¿çš„ åœ¨JDK1.8ä¸­æœ‰è®¸å¤šå…³äºdefaultæ–¹æ³•çš„ä¾‹å­ï¼Œæ¯”å¦‚forEachæ–¹æ³•ã€‚ä¹Ÿå¯ä»¥æŸ¥çœ‹java.util.Mapä¸­æ–°æ·»çš„putIfAbsentæ–¹æ³•ï¼Œåœ¨JDK1.8ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½ConcurrentMapæ¥ä½¿ç”¨å®ƒã€‚ ä»¥ä¸Šå°±æ˜¯defaultæ–¹æ³•ã€‚ä¸å¾—ä¸è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„çªç ´ï¼Œä½¿æˆ‘ä»¬å¯ä»¥æ›´å¥½æ›´æ–¹ä¾¿çš„ä½¿ç”¨æ¥å£ã€‚äº†è§£CurrentMapçš„putIfAbsentæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„è®°ä½defaultæ–¹æ³•ã€‚åœ¨JDK1.7ä¸­ï¼ŒputIfAbsentæ–¹æ³•å¹¶ä¸å­˜åœ¨äºMapæ¥å£ä¸­ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿ç”¨putIfAbsentæ–¹æ³•ï¼Œå¿…é¡»å°†Mapæ¥å£æŒ‡å‘çš„ConcurrentMapå¯¹è±¡å¼ºåˆ¶è½¬æ¢æˆConcurrentMapã€‚ä½†Java 8å¼•å…¥æ‰©å±•æ–¹æ³•ä¹‹åï¼ŒMapæ¥å£ä¸­ä¹Ÿæœ‰äº†putIfAbsentæ–¹æ³•ã€‚ å‚è€ƒ ã€è¯‘ã€‘Java8ä¸­çš„æ‰©å±•(default/extension)æ–¹æ³•","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMapï¼ˆè½¬è½½ï¼‰","slug":"ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap","date":"2018-04-13T06:41:41.000Z","updated":"2018-04-13T07:26:36.082Z","comments":true,"path":"2018/04/13/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/","link":"","permalink":"https://hsb786.github.io/2018/04/13/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/","excerpt":"ConcurrentHashMap(ç®€ç§°CHM)æ˜¯åœ¨Java 1.5ä½œä¸ºHashtableçš„æ›¿ä»£é€‰æ‹©æ–°å¼•å…¥çš„ï¼Œæ˜¯concurrentåŒ…çš„é‡è¦æˆå‘˜ã€‚åœ¨Java 1.5ä¹‹å‰ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¯ä»¥åœ¨å¤šçº¿ç¨‹å’Œå¹¶å‘çš„ç¨‹åºä¸­å®‰å…¨ä½¿ç”¨çš„Map,åªèƒ½åœ¨HashTableå’Œsynchronized Mapä¸­é€‰æ‹©ï¼Œå› ä¸ºHashMapå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†å†å¼•å…¥äº†CHMä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¥½çš„é€‰æ‹©ã€‚CHMä¸ä½†æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”æ¯”HashTableå’ŒsynchronizedMapçš„æ€§èƒ½è¦å¥½ã€‚ç›¸å¯¹äºHashTableå’ŒsynchronizedMapé”ä½äº†æ•´ä¸ªMapï¼ŒCHMåªé”ä½éƒ¨åˆ†Mapã€‚CHMå…è®¸å¹¶å‘çš„è¯»æ“ä½œï¼ŒåŒæ—¶é€šè¿‡åŒæ­¥é”åœ¨å†™æ“ä½œæ—¶ä¿æŒæ•°æ®å®Œæ•´æ€§ã€‚","text":"ConcurrentHashMap(ç®€ç§°CHM)æ˜¯åœ¨Java 1.5ä½œä¸ºHashtableçš„æ›¿ä»£é€‰æ‹©æ–°å¼•å…¥çš„ï¼Œæ˜¯concurrentåŒ…çš„é‡è¦æˆå‘˜ã€‚åœ¨Java 1.5ä¹‹å‰ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¯ä»¥åœ¨å¤šçº¿ç¨‹å’Œå¹¶å‘çš„ç¨‹åºä¸­å®‰å…¨ä½¿ç”¨çš„Map,åªèƒ½åœ¨HashTableå’Œsynchronized Mapä¸­é€‰æ‹©ï¼Œå› ä¸ºHashMapå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†å†å¼•å…¥äº†CHMä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¥½çš„é€‰æ‹©ã€‚CHMä¸ä½†æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”æ¯”HashTableå’ŒsynchronizedMapçš„æ€§èƒ½è¦å¥½ã€‚ç›¸å¯¹äºHashTableå’ŒsynchronizedMapé”ä½äº†æ•´ä¸ªMapï¼ŒCHMåªé”ä½éƒ¨åˆ†Mapã€‚CHMå…è®¸å¹¶å‘çš„è¯»æ“ä½œï¼ŒåŒæ—¶é€šè¿‡åŒæ­¥é”åœ¨å†™æ“ä½œæ—¶ä¿æŒæ•°æ®å®Œæ•´æ€§ã€‚ Javaä¸­ConcurrentHashMapçš„å®ç°CHMå¼•å…¥äº†åˆ†å‰²ï¼Œå¹¶æä¾›äº†HashTableæ”¯æŒçš„æ‰€æœ‰çš„åŠŸèƒ½ã€‚åœ¨CHMä¸­ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¯¹Mapåšè¯»æ“ä½œï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•çš„blockingã€‚è¿™å¾—ç›ŠäºCHMå°†Mapåˆ†å‰²æˆäº†ä¸åŒçš„éƒ¨åˆ†ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶åªé”ä½ä¸€éƒ¨åˆ†ã€‚æ ¹æ®é»˜è®¤çš„å¹¶å‘çº§åˆ«(concurrency level)ï¼ŒMapè¢«åˆ†å‰²æˆ16ä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”ç”±ä¸åŒçš„é”æ§åˆ¶ã€‚è¿™æ„å‘³ç€ï¼ŒåŒæ—¶æœ€å¤šå¯ä»¥æœ‰16ä¸ªå†™çº¿ç¨‹æ“ä½œMapã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œç”±åªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥å˜æˆåŒæ—¶å¯ç”±16ä¸ªå†™çº¿ç¨‹åŒæ—¶è¿›å…¥(è¯»çº¿ç¨‹å‡ ä¹ä¸å—é™åˆ¶)ï¼Œæ€§èƒ½çš„æå‡æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†ç”±äºä¸€äº›æ›´æ–°æ“ä½œï¼Œå¦‚put(),remove(),putAll(),clear()åªé”ä½æ“ä½œçš„éƒ¨åˆ†ï¼Œæ‰€ä»¥åœ¨æ£€ç´¢æ“ä½œä¸èƒ½ä¿è¯è¿”å›çš„æ˜¯æœ€æ–°çš„ç»“æœã€‚ å¦ä¸€ä¸ªé‡è¦ç‚¹æ˜¯åœ¨è¿­ä»£éå†CHMæ—¶ï¼ŒkeySetè¿”å›çš„iteratoræ˜¯å¼±ä¸€è‡´å’Œfail-safeçš„ï¼Œå¯èƒ½ä¸ä¼šè¿”å›æŸäº›æœ€è¿‘çš„æ”¹å˜ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå·²ç»éå†çš„æ•°ç»„ä¸Šçš„å†…å®¹å˜åŒ–äº†ï¼Œä¸ä¼šæŠ›å‡ºConcurrentModificationExceptoinçš„å¼‚å¸¸ã€‚ CHMé»˜è®¤çš„å¹¶å‘çº§åˆ«æ˜¯16ï¼Œä½†å¯ä»¥åœ¨åˆ›å»ºCHMæ—¶é€šè¿‡æ„é€ å‡½æ•°æ”¹å˜ã€‚æ¯«æ— ç–‘é—®ï¼Œå¹¶å‘çº§åˆ«ä»£è¡¨ç€å¹¶å‘æ‰§è¡Œæ›´æ–°æ“ä½œçš„æ•°ç›®ï¼Œæ‰€ä»¥å¦‚æœåªæœ‰å¾ˆå°‘çš„çº¿ç¨‹ä¼šæ›´æ–°Mapï¼Œé‚£ä¹ˆå»ºè®®è®¾ç½®ä¸€ä¸ªä½çš„å¹¶å‘çº§åˆ«ã€‚å¦å¤–ï¼ŒCHMè¿˜ä½¿ç”¨äº†ReentrantLockæ¥å¯¹segmentsåŠ é”ã€‚ Javaä¸­ConcurrentHashMap putifAbsentæ–¹æ³•çš„ä¾‹å­å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨å…ƒç´ ä¸å­˜åœ¨æ—¶æ’å…¥å…ƒç´ ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåƒä¸‹é¢é‚£æ ·å†™ä»£ç  1234567synchronized(map)&#123; if (map.get(key) == null)&#123; return map.put(key, value); &#125; else&#123; return map.get(key); &#125;&#125; ä¸Šé¢è¿™æ®µä»£ç åœ¨HashMapå’ŒHashTableä¸­æ˜¯å¥½ç”¨çš„ï¼Œä½†åœ¨CHMä¸­æ˜¯æœ‰å‡ºé”™çš„é£é™©çš„ã€‚è¿™æ˜¯å› ä¸ºCHMåœ¨putæ“ä½œæ—¶å¹¶æ²¡æœ‰å¯¹æ•´ä¸ªMapåŠ é”ï¼Œæ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨put(k,v)çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨get(k)ä¼šå¾—åˆ°nullï¼Œè¿™å°±ä¼šé€ æˆä¸€ä¸ªçº¿ç¨‹putçš„å€¼ä¼šè¢«å¦ä¸€ä¸ªçº¿ç¨‹putçš„å€¼æ‰€è¦†ç›–ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥å°†ä»£ç å°è£…åˆ°synchronizedä»£ç å—ä¸­ï¼Œè¿™æ ·è™½ç„¶çº¿ç¨‹å®‰å…¨äº†ï¼Œä½†ä¼šä½¿ä½ çš„ä»£ç å˜æˆäº†å•çº¿ç¨‹ã€‚CHMæä¾›çš„putIfAbsent(key,value)æ–¹æ³•åŸå­æ€§çš„å®ç°äº†åŒæ ·çš„åŠŸèƒ½ï¼ŒåŒæ—¶é¿å…äº†ä¸Šé¢çš„çº¿ç¨‹ç«äº‰çš„é£é™©ã€‚ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMapCHMé€‚ç”¨äºè¯»è€…æ•°é‡è¶…è¿‡å†™è€…æ—¶ï¼Œå½“å†™è€…æ•°é‡å¤§äºç­‰äºè¯»è€…æ—¶ï¼ŒCHMçš„æ€§èƒ½æ˜¯ä½äºHashtableå’Œsynchronized Mapçš„ã€‚è¿™æ˜¯å› ä¸ºå½“é”ä½äº†æ•´ä¸ªMapæ—¶ï¼Œè¯»æ“ä½œè¦ç­‰å¾…å¯¹åŒä¸€éƒ¨åˆ†æ‰§è¡Œå†™æ“ä½œçš„çº¿ç¨‹ç»“æŸã€‚CHMé€‚ç”¨äºåšcache,åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œä¹‹åå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚çº¿ç¨‹è®¿é—®ã€‚æ­£å¦‚Javadocè¯´æ˜çš„é‚£æ ·ï¼ŒCHMæ˜¯HashTableä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£ï¼Œä½†è¦è®°ä½ï¼ŒCHMçš„æ¯”HashTableçš„åŒæ­¥æ€§ç¨å¼±ã€‚ æ€»ç»“ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯ConcurrentHashMapå’Œä»€ä¹ˆæ—¶å€™è¯¥ç”¨ConcurrentHashMapï¼Œä¸‹é¢æˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹CHMçš„ä¸€äº›å…³é”®ç‚¹ã€‚ CHMå…è®¸å¹¶å‘çš„è¯»å’Œçº¿ç¨‹å®‰å…¨çš„æ›´æ–°æ“ä½œ åœ¨æ‰§è¡Œå†™æ“ä½œæ—¶ï¼ŒCHMåªé”ä½éƒ¨åˆ†çš„Map å¹¶å‘çš„æ›´æ–°æ˜¯é€šè¿‡å†…éƒ¨æ ¹æ®å¹¶å‘çº§åˆ«å°†Mapåˆ†å‰²æˆå°éƒ¨åˆ†å®ç°çš„ é«˜çš„å¹¶å‘çº§åˆ«ä¼šé€ æˆæ—¶é—´å’Œç©ºé—´çš„æµªè´¹ï¼Œä½çš„å¹¶å‘çº§åˆ«åœ¨å†™çº¿ç¨‹å¤šæ—¶ä¼šå¼•èµ·çº¿ç¨‹é—´çš„ç«äº‰ CHMçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨ CHMè¿”å›çš„è¿­ä»£å™¨æ˜¯å¼±ä¸€è‡´æ€§ï¼Œfail-safeå¹¶ä¸”ä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ CHMä¸å…è®¸nullçš„é”®å€¼ å¯ä»¥ä½¿ç”¨CHMä»£æ›¿HashTableï¼Œä½†è¦è®°ä½CHMä¸ä¼šé”ä½æ•´ä¸ªMap å‚è€ƒ ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"jvm-GCï¼ˆè½¬è½½ï¼‰","slug":"jvm-GC","date":"2018-04-13T06:10:31.000Z","updated":"2018-04-13T12:08:44.969Z","comments":true,"path":"2018/04/13/jvm-GC/","link":"","permalink":"https://hsb786.github.io/2018/04/13/jvm-GC/","excerpt":"å…³é”®å­—çº¦å®š Young generation â€“&gt;æ–°ç”Ÿä»£ Tenured / Old Generation â€“&gt;è€å¹´ä»£ Perm Area â€“&gt;æ°¸ä¹…ä»£ é‡è¦çš„ä¸œä¸œ åœ¨Javaä¸­ï¼Œå¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸€äº›ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ç­‰å­˜å‚¨åœ¨æ–¹æ³•åŒºã€‚å †å’Œæ–¹æ³•åŒºéƒ½æ˜¯çº¿ç¨‹å…±äº«çš„ã€‚ GCæœºåˆ¶æ˜¯ç”±JVMæä¾›ï¼Œç”¨æ¥æ¸…ç†éœ€è¦æ¸…é™¤çš„å¯¹è±¡ï¼Œå›æ”¶å †å†…å­˜ã€‚ GCæœºåˆ¶å°†Javaç¨‹åºå‘˜ä»å†…å­˜ç®¡ç†ä¸­è§£æ”¾äº†å‡ºæ¥ï¼Œå¯ä»¥æ›´å…³æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚ åœ¨Javaä¸­ï¼ŒGCæ˜¯ç”±ä¸€ä¸ªè¢«ç§°ä¸ºåƒåœ¾å›æ”¶å™¨çš„å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œçš„ã€‚ åœ¨ä»å†…å­˜å›æ”¶ä¸€ä¸ªå¯¹è±¡ä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„finalize()æ–¹æ³•ã€‚ ä½œä¸ºä¸€ä¸ªJavaå¼€å‘è€…ä¸èƒ½å¼ºåˆ¶JVMæ‰§è¡ŒGCï¼›GCçš„è§¦å‘ç”±JVMä¾æ®å †å†…å­˜çš„å¤§å°æ¥å†³å®šã€‚ System.gc()å’ŒRuntime.gc()ä¼šå‘JVMå‘é€æ‰§è¡ŒGCçš„è¯·æ±‚ï¼Œä½†æ˜¯JVMä¸ä¿è¯ä¸€å®šä¼šæ‰§è¡ŒGCã€‚ å¦‚æœå †æ²¡æœ‰å†…å­˜åˆ›å»ºæ–°çš„å¯¹è±¡äº†ï¼Œä¼šæŠ›å‡ºOutOfMemoryErrorã€‚","text":"å…³é”®å­—çº¦å®š Young generation â€“&gt;æ–°ç”Ÿä»£ Tenured / Old Generation â€“&gt;è€å¹´ä»£ Perm Area â€“&gt;æ°¸ä¹…ä»£ é‡è¦çš„ä¸œä¸œ åœ¨Javaä¸­ï¼Œå¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸€äº›ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ç­‰å­˜å‚¨åœ¨æ–¹æ³•åŒºã€‚å †å’Œæ–¹æ³•åŒºéƒ½æ˜¯çº¿ç¨‹å…±äº«çš„ã€‚ GCæœºåˆ¶æ˜¯ç”±JVMæä¾›ï¼Œç”¨æ¥æ¸…ç†éœ€è¦æ¸…é™¤çš„å¯¹è±¡ï¼Œå›æ”¶å †å†…å­˜ã€‚ GCæœºåˆ¶å°†Javaç¨‹åºå‘˜ä»å†…å­˜ç®¡ç†ä¸­è§£æ”¾äº†å‡ºæ¥ï¼Œå¯ä»¥æ›´å…³æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚ åœ¨Javaä¸­ï¼ŒGCæ˜¯ç”±ä¸€ä¸ªè¢«ç§°ä¸ºåƒåœ¾å›æ”¶å™¨çš„å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œçš„ã€‚ åœ¨ä»å†…å­˜å›æ”¶ä¸€ä¸ªå¯¹è±¡ä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„finalize()æ–¹æ³•ã€‚ ä½œä¸ºä¸€ä¸ªJavaå¼€å‘è€…ä¸èƒ½å¼ºåˆ¶JVMæ‰§è¡ŒGCï¼›GCçš„è§¦å‘ç”±JVMä¾æ®å †å†…å­˜çš„å¤§å°æ¥å†³å®šã€‚ System.gc()å’ŒRuntime.gc()ä¼šå‘JVMå‘é€æ‰§è¡ŒGCçš„è¯·æ±‚ï¼Œä½†æ˜¯JVMä¸ä¿è¯ä¸€å®šä¼šæ‰§è¡ŒGCã€‚ å¦‚æœå †æ²¡æœ‰å†…å­˜åˆ›å»ºæ–°çš„å¯¹è±¡äº†ï¼Œä¼šæŠ›å‡ºOutOfMemoryErrorã€‚ GCé’ˆå¯¹ä»€ä¹ˆå¯¹è±¡ï¼Ÿ äº†è§£GCæœºåˆ¶çš„ç¬¬ä¸€æ­¥å°±æ˜¯ç†è§£ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«å›æ”¶ã€‚å½“ä¸€ä¸ªå¯¹è±¡é€šè¿‡ä¸€ç³»åˆ—æ ¹å¯¹è±¡(æ¯”å¦‚ï¼šé™æ€å±æ€§å¼•ç”¨çš„å¸¸é‡)éƒ½ä¸å¯è¾¾æ—¶å°±ä¼šè¢«å›æ”¶ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½ä¸ºnullã€‚å¾ªç¯ä¾èµ–ä¸ç®—åšå¼•ç”¨ï¼Œå¦‚æœå¯¹è±¡Aæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Bçš„å¼•ç”¨ï¼Œå¯¹è±¡Bä¹Ÿæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Açš„å¼•ç”¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä»¬æ²¡æœ‰å…¶ä»–å¼•ç”¨ï¼Œé‚£ä¹ˆå¯¹è±¡Aå’Œå¯¹è±¡Béƒ½ã€éœ€è¦è¢«å›æ”¶(å¦‚ä¸‹å›¾,ObjAå’ŒObjBéœ€è¦è¢«å›æ”¶)ã€‚ å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼ŸJavaä¸­å¯¹è±¡éƒ½åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸ºäº†GCï¼Œå †å†…å­˜åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥è¯´ä¸‰ä»£ï¼Œåˆ†åˆ«ç§°ä¸ºæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£ã€‚å…¶ä¸­æ–°ç”Ÿä»£åˆè¿›ä¸€æ­¥åˆ†ä¸ºEdenåŒºï¼ŒSurvivor 1åŒºå’ŒSurvivor 2åŒº(å¦‚ä¸‹å›¾)ã€‚æ–°åˆ›å»ºçš„å¯¹è±¡ä¼šåˆ†é…åœ¨EdenåŒº,åœ¨ç»å†ä¸€æ¬¡Minor GCåä¼šè¢«ç§»åˆ°Survivor 1åŒºï¼Œå†ç»å†ä¸€æ¬¡Minor GCåä¼šè¢«ç§»åˆ°Survivor 2åŒºï¼Œç›´åˆ°å‡è‡³è€å¹´ä»£,éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€äº›å¤§å¯¹è±¡(é•¿å­—ç¬¦ä¸²æˆ–æ•°ç»„)å¯èƒ½ä¼šç›´æ¥å­˜æ”¾åˆ°è€å¹´ä»£ã€‚ æ°¸ä¹…ä»£æœ‰ä¸€äº›ç‰¹æ®Šï¼Œå®ƒç”¨æ¥å­˜å‚¨ç±»çš„å…ƒä¿¡æ¯ã€‚å¯¹äºGCæ˜¯å¦å‘ç”Ÿåœ¨æ°¸ä¹…ä»£æœ‰è®¸å¤šä¸åŒçš„çœ‹æ³•ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™å–å†³äºé‡‡ç”¨çš„JVMã€‚å¤§å®¶å¯ä»¥é€šè¿‡åˆ›å»ºå¤§é‡çš„å­—ç¬¦ä¸²æ¥è§‚å¯Ÿæ˜¯å‘ç”Ÿäº†GCè¿˜æ˜¯æŠ›å‡ºäº†OutOfMemoryErrorã€‚ GCç®—æ³• æ ‡è®°æ¸…é™¤ç®—æ³• åˆ†ä¸ºæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚è¯¥ç®—æ³•çš„ç¼ºç‚¹æ˜¯æ•ˆç‡ä¸é«˜å¹¶ä¸”ä¼šäº§ç”Ÿä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚ å¤åˆ¶ç®—æ³• æŠŠå†…å­˜ç©ºé—´åˆ’ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåŒºåŸŸã€‚åƒåœ¾å›æ”¶æ—¶ï¼Œéå†å½“å‰ä½¿ç”¨åŒºåŸŸï¼ŒæŠŠæ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªåŒºåŸŸä¸­ã€‚æ­¤ç®—æ³•æ¯æ¬¡åªå¤„ç†æ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡ï¼Œå› æ­¤å¤åˆ¶æˆæœ¬æ¯”è¾ƒå°ï¼ŒåŒæ—¶å¤åˆ¶è¿‡å»ä»¥åè¿˜èƒ½è¿›è¡Œç›¸åº”çš„å†…å­˜æ•´ç†ï¼Œä¸ä¼šå‡ºç°â€œç¢ç‰‡â€é—®é¢˜ã€‚ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚ç¼ºç‚¹ï¼šä¼šæµªè´¹ä¸€å®šçš„å†…å­˜ã€‚ä¸€èˆ¬æ–°ç”Ÿä»£é‡‡ç”¨è¿™ç§ç®—æ³•ã€‚ æ ‡è®°æ•´ç†ç®—æ³• æ ‡è®°é˜¶æ®µä¸æ ‡è®°æ¸…é™¤ç®—æ³•ä¸€æ ·ã€‚ä½†åç»­å¹¶ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶çš„å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åæ¸…ç†ã€‚ä¼˜ç‚¹æ˜¯ä¸ä¼šé€ æˆå†…å­˜ç¢ç‰‡ã€‚ Javaä¸­åƒåœ¾å›æ”¶å™¨çš„ç±»å‹Javaæä¾›å¤šç§ç±»å‹çš„åƒåœ¾å›æ”¶å™¨ã€‚JVMä¸­çš„åƒåœ¾æ”¶é›†ä¸€èˆ¬éƒ½é‡‡ç”¨â€œåˆ†ä»£æ”¶é›†â€ï¼Œä¸åŒçš„å †å†…å­˜åŒºåŸŸé‡‡ç”¨ä¸åŒçš„æ”¶é›†ç®—æ³•ï¼Œä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å¢åŠ ååé‡æˆ–é™ä½åœé¡¿æ—¶é—´ã€‚ Serialæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œä¸²è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ ParNewæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼ŒSerialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆï¼Œç”¨å¤šä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œå¹¶è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ä½¿ç”¨-XX:+UseParNewGCå¼€å…³æ¥æ§åˆ¶ä½¿ç”¨ParNew+Serial Oldæ”¶é›†å™¨ç»„åˆæ”¶é›†å†…å­˜ï¼›ä½¿ç”¨-XX:ParallelGCThreadsæ¥è®¾ç½®æ‰§è¡Œå†…å­˜å›æ”¶çš„çº¿ç¨‹æ•°ã€‚ Parallel Scavenge æ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨æ–°ç”Ÿä»£ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œå…³æ³¨CPUååé‡ï¼Œå³è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´/æ€»æ—¶é—´ã€‚ä½¿ç”¨-XX:+UseParallelGCå¼€å…³æ§åˆ¶ä½¿ç”¨Parallel Scavenge+Serial Oldæ”¶é›†å™¨ç»„åˆå›æ”¶åƒåœ¾ã€‚ Serial Oldæ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä¸²è¡Œï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œä½¿ç”¨å•çº¿ç¨‹è¿›è¡ŒGCï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ Parallel Oldæ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨è€å¹´ä»£ï¼Œå¤šçº¿ç¨‹ï¼Œå¹¶è¡Œï¼Œå¤šçº¿ç¨‹æœºåˆ¶ä¸Parallel Scavengeå·®ä¸é”™ï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œåœ¨Parallel Oldæ‰§è¡Œæ—¶ï¼Œä»ç„¶éœ€è¦æš‚åœå…¶å®ƒçº¿ç¨‹ã€‚ CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œè‡´åŠ›äºè·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ï¼ˆå³ç¼©çŸ­åƒåœ¾å›æ”¶çš„æ—¶é—´ï¼‰ï¼Œä½¿ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå¤šçº¿ç¨‹ï¼Œä¼˜ç‚¹æ˜¯å¹¶å‘æ”¶é›†ï¼ˆç”¨æˆ·çº¿ç¨‹å¯ä»¥å’ŒGCçº¿ç¨‹åŒæ—¶å·¥ä½œï¼‰ï¼Œåœé¡¿å°ã€‚ä½¿ç”¨-XX:+UseConcMarkSweepGCè¿›è¡ŒParNew+CMS+Serial Oldè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¼˜å…ˆä½¿ç”¨ParNew+CMSï¼ˆåŸå› è§Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶ä¸€èŠ‚ï¼‰ï¼Œå½“ç”¨æˆ·çº¿ç¨‹å†…å­˜ä¸è¶³æ—¶ï¼Œé‡‡ç”¨å¤‡ç”¨æ–¹æ¡ˆSerial Oldæ”¶é›†ã€‚ ä¸GCæœ‰å…³çš„JVMå‚æ•°åœ¨å¼€å‘ä¸­æˆ‘ä»¬éœ€è¦é€šè¿‡åˆ†æé€ æˆFull GCçš„åŸå› æ¥æé«˜ç³»ç»Ÿæ€§èƒ½ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘å‘ç°åšGCçš„è°ƒä¼˜å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºå¯¹ç³»ç»Ÿçš„åˆ†æï¼Œç³»ç»Ÿæ‹¥æœ‰æ€æ ·çš„å¯¹è±¡ä»¥åŠä»–ä»¬çš„å¹³å‡ç”Ÿå‘½å‘¨æœŸã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨å¤§å¤šæ˜¯çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåº”è¯¥ç¡®ä¿EdenåŒºè¶³å¤Ÿå¤§ï¼Œè¿™æ ·å¯ä»¥å‡å°‘Minor GCçš„æ¬¡æ•°ã€‚å¯ä»¥é€šè¿‡-XX:NewRatioæ¥æ§åˆ¶æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹ï¼Œæ¯”å¦‚-XX:NewRatio=3ä»£è¡¨æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹ä¸º1ï¼š3ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰©å¤§æ–°ç”Ÿä»£çš„å¤§å°ä¼šå‡å°‘è€å¹´ä»£çš„å¤§å°ï¼Œè¿™ä¼šå¯¼è‡´Major GCæ‰§è¡Œçš„æ›´é¢‘ç¹ï¼Œè€ŒMajor GCå¯èƒ½ä¼šé€ æˆç”¨æˆ·çº¿ç¨‹çš„åœé¡¿ä»è€Œé™ä½ç³»ç»Ÿååé‡ã€‚JVMä¸­å¯ä»¥ç”¨NewSizeå’ŒMaxNewSizeå‚æ•°æ¥æŒ‡å®šæ–°ç”Ÿä»£å†…å­˜æœ€å°å’Œæœ€å¤§å€¼ï¼Œå¦‚æœä¸¤ä¸ªå‚æ•°å€¼ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºå›ºå®šäº†æ–°ç”Ÿä»£çš„å¤§å° Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶å¹¶å‘åƒåœ¾å›æ”¶å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¹¶å‘åƒåœ¾å›æ”¶å™¨å¯ä»¥åœ¨ç”¨æˆ·çº¿ç¨‹è¿è¡Œçš„æƒ…å†µä¸‹å®Œæˆå¤§éƒ¨åˆ†çš„å›æ”¶å·¥ä½œï¼Œæ‰€ä»¥åº”ç”¨åœé¡¿æ—¶é—´å¾ˆçŸ­ã€‚ ä½†ç”±äºå¹¶å‘åƒåœ¾å›æ”¶æ—¶ç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œï¼Œæ‰€ä»¥ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿã€‚ä½œä¸ºæ‹…ä¿ï¼Œå¦‚æœåœ¨è€å¹´ä»£å†…å­˜éƒ½è¢«å ç”¨ä¹‹å‰ï¼Œå¦‚æœå¹¶å‘åƒåœ¾å›æ”¶å™¨è¿˜æ²¡ç»“æŸå·¥ä½œï¼Œé‚£ä¹ˆåº”ç”¨ä¼šæš‚åœï¼Œåœ¨æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹åœæ­¢çš„æƒ…å†µä¸‹å®Œæˆå›æ”¶ã€‚è¿™ç§æƒ…å†µç§°ä½œFull GCï¼Œè¿™æ„å‘³ç€éœ€è¦è°ƒæ•´æœ‰å…³å¹¶å‘å›æ”¶çš„å‚æ•°äº†ã€‚ ç”±äºFull GCå¾ˆå½±å“åº”ç”¨çš„æ€§èƒ½ï¼Œè¦å°½é‡é¿å…æˆ–å‡å°‘ã€‚ç‰¹åˆ«æ˜¯å¦‚æœå¯¹äºé«˜å®¹é‡ä½å»¶è¿Ÿçš„ç”µå•†ç³»ç»Ÿï¼Œè¦å°½é‡é¿å…åœ¨äº¤æ˜“æ—¶é—´æ®µå‘ç”ŸFull GCã€‚ æ€»ç»“ ä¸ºäº†åˆ†ä»£åƒåœ¾å›æ”¶ï¼ŒJavaå †å†…å­˜åˆ†ä¸º3ä»£ï¼šæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£ã€‚ æ–°çš„å¯¹è±¡å®ä¾‹ä¼šä¼˜å…ˆåˆ†é…åœ¨æ–°ç”Ÿä»£ï¼Œåœ¨ç»å†å‡ æ¬¡Minor GCå(é»˜è®¤15æ¬¡)ï¼Œè¿˜å­˜æ´»çš„ä¼šè¢«ç§»è‡³è€å¹´ä»£(æŸäº›å¤§å¯¹è±¡ä¼šç›´æ¥åœ¨è€å¹´ä»£åˆ†é…)ã€‚ æ°¸ä¹…ä»£æ˜¯å¦æ‰§è¡ŒGCï¼Œå–å†³äºé‡‡ç”¨çš„JVMã€‚ Minor GCå‘ç”Ÿåœ¨æ–°ç”Ÿä»£ï¼Œå½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶ï¼Œä¼šå‘èµ·ä¸€æ¬¡Minor GCï¼Œå°†EdenåŒºä¸­çš„å­˜æ´»å¯¹è±¡ç§»è‡³SurvivoråŒºã€‚Major GCå‘ç”Ÿåœ¨è€å¹´ä»£ï¼Œå½“å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¤§äºè€å¹´ä»£å‰©ä½™ç©ºé—´æ—¶ä¼šå‘ç”ŸMajor GCã€‚ å‘ç”ŸMajor GCæ—¶ç”¨æˆ·çº¿ç¨‹ä¼šæš‚åœï¼Œä¼šé™ä½ç³»ç»Ÿæ€§èƒ½å’Œååé‡ã€‚ JVMçš„å‚æ•°-Xmxå’Œ-Xmsç”¨æ¥è®¾ç½®Javaå †å†…å­˜çš„åˆå§‹å¤§å°å’Œæœ€å¤§å€¼ã€‚ä¾æ®ä¸ªäººç»éªŒè¿™ä¸ªå€¼çš„æ¯”ä¾‹æœ€å¥½æ˜¯1:1æˆ–è€…1:1.5ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥å°†-Xmxå’Œ-Xmséƒ½è®¾ä¸º1GBï¼Œæˆ–è€…-Xmxå’Œ-Xmsè®¾ä¸º1.2GBå’Œ1.8GBã€‚ Javaä¸­ä¸èƒ½æ‰‹åŠ¨è§¦å‘GCï¼Œä½†å¯ä»¥ç”¨ä¸åŒçš„å¼•ç”¨ç±»æ¥è¾…åŠ©åƒåœ¾å›æ”¶å™¨å·¥ä½œ(æ¯”å¦‚ï¼šå¼±å¼•ç”¨æˆ–è½¯å¼•ç”¨)ã€‚ ä»¥ä¸Šå°±æ˜¯å…³äºJavaä¸­GCçš„ä¸€äº›å†…å®¹ã€‚é€šè¿‡è¿™ç¯‡åšå®¢ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼›ä¸€ä¸ªå¯¹è±¡åœ¨æ²¡æœ‰ä»»ä½•å¼ºå¼•ç”¨æŒ‡å‘ä»–æˆ–è¯¥å¯¹è±¡é€šè¿‡æ ¹èŠ‚ç‚¹ä¸å¯è¾¾æ—¶éœ€è¦è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼›å½“åƒåœ¾æ”¶é›†å™¨æ„è¯†åˆ°éœ€è¦è¿›è¡ŒGCæ—¶ä¼šè§¦å‘Minor GCæˆ–Major GCï¼Œæ˜¯è‡ªåŠ¨çš„ï¼Œæ— æ³•å¼ºåˆ¶æ‰§è¡Œã€‚ å‚è€ƒ ã€è¯‘ã€‘Javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/tags/JVM/"}]},{"title":"ã€è¯‘ã€‘Executor, ExecutorService å’Œ Executors é—´çš„ä¸åŒ ï¼ˆè½¬è½½ï¼‰","slug":"difference-between-executor-executorService","date":"2018-04-13T05:21:41.000Z","updated":"2018-04-13T12:02:30.723Z","comments":true,"path":"2018/04/13/difference-between-executor-executorService/","link":"","permalink":"https://hsb786.github.io/2018/04/13/difference-between-executor-executorService/","excerpt":"java.util.concurrent.Executor, java.util.concurrent.ExecutorService, java.util.concurrent. Executors è¿™ä¸‰è€…å‡æ˜¯ Java Executor æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ± çš„åŠŸèƒ½ã€‚å› ä¸ºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹éå¸¸å¿ƒç´¯ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿé€šå¸¸å¯¹çº¿ç¨‹æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨çº¿ç¨‹æ± ä¸ä»…å¯ä»¥æé«˜åº”ç”¨çš„å“åº”æ—¶é—´ï¼Œè¿˜å¯ä»¥é¿å…â€java.lang.OutOfMemoryError: unable to create new native threadâ€ ä¹‹ç±»çš„é”™è¯¯ã€‚","text":"java.util.concurrent.Executor, java.util.concurrent.ExecutorService, java.util.concurrent. Executors è¿™ä¸‰è€…å‡æ˜¯ Java Executor æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ± çš„åŠŸèƒ½ã€‚å› ä¸ºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹éå¸¸å¿ƒç´¯ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿé€šå¸¸å¯¹çº¿ç¨‹æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨çº¿ç¨‹æ± ä¸ä»…å¯ä»¥æé«˜åº”ç”¨çš„å“åº”æ—¶é—´ï¼Œè¿˜å¯ä»¥é¿å…â€java.lang.OutOfMemoryError: unable to create new native threadâ€ ä¹‹ç±»çš„é”™è¯¯ã€‚åœ¨ Java 1.5 æ—¶ï¼Œå¼€å‘è€…éœ€è¦å…³å¿ƒçº¿ç¨‹æ± çš„åˆ›å»ºå’Œç®¡ç†ï¼Œä½†åœ¨ Java 1.5 ä¹‹å Executor æ¡†æ¶æä¾›äº†å¤šç§å†…ç½®çš„çº¿ç¨‹æ± ,ä¾‹å¦‚ï¼šFixedThreadPool(åŒ…å«å›ºå®šæ•°ç›®çš„çº¿ç¨‹)ï¼ŒCachedThreadPool(å¯æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹)ç­‰ç­‰ã€‚ ExecutorExecutor, ExecutorService, å’Œ Executors æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯ Executor æ˜¯ä¸€ä¸ªæŠ½è±¡å±‚é¢çš„æ ¸å¿ƒæ¥å£(å¤§è‡´ä»£ç å¦‚ä¸‹)ã€‚ 123public interface Executor &#123; void execute(Runnable command);&#125; ä¸åŒäº java.lang.Thread ç±»å°†ä»»åŠ¡å’Œæ‰§è¡Œè€¦åˆåœ¨ä¸€èµ·ï¼Œ Executor å°†ä»»åŠ¡æœ¬èº«å’Œæ‰§è¡Œä»»åŠ¡åˆ†ç¦»ï¼Œå¯ä»¥é˜…è¯» difference between Thread and Executor æ¥äº†è§£ Thread å’Œ Executor é—´æ›´å¤šçš„ä¸åŒã€‚ ExecutorServiceExecutorService æ¥å£ å¯¹ Executor æ¥å£è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†è¿”å› Future å¯¹è±¡ï¼Œç»ˆæ­¢ï¼Œå…³é—­çº¿ç¨‹æ± ç­‰æ–¹æ³•ã€‚å½“è°ƒç”¨ shutDown æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåœæ­¢æ¥å—æ–°çš„ä»»åŠ¡ï¼Œä½†ä¼šå®Œæˆæ­£åœ¨ pending ä¸­çš„ä»»åŠ¡ã€‚ Future å¯¹è±¡æä¾›äº†å¼‚æ­¥æ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ— éœ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œçš„å®Œæˆï¼Œåªè¦æäº¤éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶ååœ¨éœ€è¦æ—¶æ£€æŸ¥ Future æ˜¯å¦å·²ç»æœ‰äº†ç»“æœï¼Œå¦‚æœä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡ Future.get() æ–¹æ³•è·å¾—æ‰§è¡Œç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒFuture.get() æ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡å¼çš„æ–¹æ³•ï¼Œå¦‚æœè°ƒç”¨æ—¶ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œä¼šç­‰å¾…ç›´åˆ°ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚ é€šè¿‡ ExecutorService.submit() æ–¹æ³•è¿”å›çš„ Future å¯¹è±¡ï¼Œè¿˜å¯ä»¥å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œã€‚Future æä¾›äº† cancel() æ–¹æ³•ç”¨æ¥å–æ¶ˆæ‰§è¡Œ pending ä¸­çš„ä»»åŠ¡ã€‚ ExecutorService éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š 123456public interface ExecutorService extends Executor &#123; void shutdown(); &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task); &lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result); &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException;&#125; ExecutorsExecutors æ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œç±»ä¼¼äº Collectionsã€‚æä¾›å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ï¼Œæ¯”å¦‚ FixedThreadPool æˆ– CachedThreadPoolã€‚ Executors éƒ¨åˆ†ä»£ç ï¼š 123456789public class Executors &#123; public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS,new LinkedBlockingQueue&lt;Runnable&gt;()); &#125; public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;()); &#125;&#125; ä¸‹é¢è¯¦ç»†çœ‹ä¸€ä¸‹ä¸‰è€…çš„åŒºåˆ«ï¼š Executor vs ExecutorService vs Executorsæ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œè¿™ä¸‰è€…å‡æ˜¯ Executor æ¡†æ¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚Java å¼€å‘è€…å¾ˆæœ‰å¿…è¦å­¦ä¹ å’Œç†è§£ä»–ä»¬ï¼Œä»¥ä¾¿æ›´é«˜æ•ˆçš„ä½¿ç”¨ Java æä¾›çš„ä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ€»ç»“ä¸€ä¸‹è¿™ä¸‰è€…é—´çš„åŒºåˆ«ï¼Œä»¥ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£ï¼š Executor å’Œ ExecutorService è¿™ä¸¤ä¸ªæ¥å£ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼šExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£ï¼Œæ˜¯ Executor çš„å­æ¥å£ Executor å’Œ ExecutorService ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ï¼šExecutor æ¥å£å®šä¹‰äº† execute()æ–¹æ³•ç”¨æ¥æ¥æ”¶ä¸€ä¸ªRunnableæ¥å£çš„å¯¹è±¡ï¼Œè€Œ ExecutorService æ¥å£ä¸­çš„ submit()æ–¹æ³•å¯ä»¥æ¥å—Runnableå’ŒCallableæ¥å£çš„å¯¹è±¡ã€‚ Executor å’Œ ExecutorService æ¥å£ç¬¬ä¸‰ä¸ªåŒºåˆ«æ˜¯ Executor ä¸­çš„ execute() æ–¹æ³•ä¸è¿”å›ä»»ä½•ç»“æœï¼Œè€Œ ExecutorService ä¸­çš„ submit()æ–¹æ³•å¯ä»¥é€šè¿‡ä¸€ä¸ª Future å¯¹è±¡è¿”å›è¿ç®—ç»“æœã€‚ Executor å’Œ ExecutorService æ¥å£ç¬¬å››ä¸ªåŒºåˆ«æ˜¯é™¤äº†å…è®¸å®¢æˆ·ç«¯æäº¤ä¸€ä¸ªä»»åŠ¡ï¼ŒExecutorService è¿˜æä¾›ç”¨æ¥æ§åˆ¶çº¿ç¨‹æ± çš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼šè°ƒç”¨ shutDown() æ–¹æ³•ç»ˆæ­¢çº¿ç¨‹æ± ã€‚å¯ä»¥é€šè¿‡ ã€ŠJava Concurrency in Practiceã€‹ ä¸€ä¹¦äº†è§£æ›´å¤šå…³äºå…³é—­çº¿ç¨‹æ± å’Œå¦‚ä½•å¤„ç† pending çš„ä»»åŠ¡çš„çŸ¥è¯†ã€‚ Executors ç±»æä¾›å·¥å‚æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ¯”å¦‚: newSingleThreadExecutor() åˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼ŒnewFixedThreadPool(int numOfThreads)æ¥åˆ›å»ºå›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼ŒnewCachedThreadPool()å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œä½†å¦‚æœå·²æœ‰çº¿ç¨‹æ˜¯ç©ºé—²çš„ä¼šé‡ç”¨å·²æœ‰çº¿ç¨‹ã€‚ æ€»ç»“ä¸‹è¡¨åˆ—å‡ºäº† Executor å’Œ ExecutorService çš„åŒºåˆ«ï¼š Executor ExecutorService Executor æ˜¯ Java çº¿ç¨‹æ± çš„æ ¸å¿ƒæ¥å£ï¼Œç”¨æ¥å¹¶å‘æ‰§è¡Œæäº¤çš„ä»»åŠ¡ ExecutorService æ˜¯ Executor æ¥å£çš„æ‰©å±•ï¼Œæä¾›äº†å¼‚æ­¥æ‰§è¡Œå’Œå…³é—­çº¿ç¨‹æ± çš„æ–¹æ³• æä¾›execute()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡ æä¾›submit()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡ execute()æ–¹æ³•æ— è¿”å›å€¼ submit()æ–¹æ³•è¿”å›Futureå¯¹è±¡ï¼Œå¯ç”¨æ¥è·å–ä»»åŠ¡æ‰§è¡Œç»“æœ ä¸èƒ½å–æ¶ˆä»»åŠ¡ å¯ä»¥é€šè¿‡Future.cancel()å–æ¶ˆpendingä¸­çš„ä»»åŠ¡ æ²¡æœ‰æä¾›å’Œå…³é—­çº¿ç¨‹æ± æœ‰å…³çš„æ–¹æ³• æä¾›äº†å…³é—­çº¿ç¨‹æ± çš„æ–¹æ³• å‚è€ƒ ã€è¯‘ã€‘Executor, ExecutorService å’Œ Executors é—´çš„ä¸åŒ","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"vscode-database","slug":"vscode-database","date":"2018-04-13T03:55:59.000Z","updated":"2018-04-13T04:23:59.089Z","comments":true,"path":"2018/04/13/vscode-database/","link":"","permalink":"https://hsb786.github.io/2018/04/13/vscode-database/","excerpt":"æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„vscodeæ’ä»¶, vscode-database è¿·ä¸Šäº†vscode","text":"æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„vscodeæ’ä»¶, vscode-database è¿·ä¸Šäº†vscode å¿«æ·é”® å‘½ä»¤ è¯­ä¹‰ ctrl q querySQL ctrl shift e Run selected text as SQL query","categories":[],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"è§¦å‘å™¨","slug":"è§¦å‘å™¨","date":"2018-04-13T03:43:11.000Z","updated":"2018-04-13T04:38:27.314Z","comments":true,"path":"2018/04/13/è§¦å‘å™¨/","link":"","permalink":"https://hsb786.github.io/2018/04/13/è§¦å‘å™¨/","excerpt":"å¯¹æŸä¸€ä¸ªè¡¨çš„æŸç§æ“ä½œï¼Œè§¦å‘æŸç§æ¡ä»¶ï¼Œä»è€Œæ‰§è¡Œçš„ä¸€æ®µç¨‹åº new: æ–°æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæ²¡æœ‰ï¼Œå°†è¦æœ‰çš„æ•°æ®ã€‚ä¾‹å¦‚å°†è¦æ›´æ–°çš„æ•°æ®æˆ–è€…æ˜¯æ–°å¢çš„æ•°æ®ã€‚ oldï¼šæ—§æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæœ‰çš„æ•°æ®","text":"å¯¹æŸä¸€ä¸ªè¡¨çš„æŸç§æ“ä½œï¼Œè§¦å‘æŸç§æ¡ä»¶ï¼Œä»è€Œæ‰§è¡Œçš„ä¸€æ®µç¨‹åº new: æ–°æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæ²¡æœ‰ï¼Œå°†è¦æœ‰çš„æ•°æ®ã€‚ä¾‹å¦‚å°†è¦æ›´æ–°çš„æ•°æ®æˆ–è€…æ˜¯æ–°å¢çš„æ•°æ®ã€‚ oldï¼šæ—§æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæœ‰çš„æ•°æ® è¯´æ˜ï¼šåœ¨æŠŠuserjob(ç”¨æˆ·å²—ä½å…³è”è¡¨)ä¸­çš„success(å®¡æ‰¹çŠ¶æ€)æ›´æ–°ä¸ºtrueæ—¶ï¼Œè‡ªåŠ¨åœ¨æˆç»©è¡¨ä¸­å‡ºå…¥æ•°æ®ï¼›å¦åˆ™è¯´æ˜æ²¡æœ‰å®¡æ‰¹æ²¡æœ‰é€šè¿‡ï¼ŒæŠŠæˆç»©è¡¨ä¸­å¯¹åº”çš„æ•°æ®åˆ é™¤1234CREATE TRIGGER `insertScore` AFTER UPDATE ON `userjob` FOR EACH ROW if new.success=true theninsert into score(id) values(new.id);else delete from score where id=new.id;end if è¯´æ˜ï¼šåœ¨åˆ é™¤userjob(ç”¨æˆ·å²—ä½å…³è”è¡¨)çš„æ•°æ®æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æˆç»©è¡¨å¯¹åº”ä¸­çš„æ•°æ®123CREATE TRIGGER `deleteScore` BEFORE DELETE ON `userjob` FOR EACH ROW if old.success=true thendelete from score where id=old.id;end if","categories":[],"tags":[{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/tags/sql/"}]},{"title":"sql","slug":"sql","date":"2018-04-12T12:56:19.000Z","updated":"2018-04-12T13:27:14.338Z","comments":true,"path":"2018/04/12/sql/","link":"","permalink":"https://hsb786.github.io/2018/04/12/sql/","excerpt":"ç´¢å¼•ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„ åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå¿«é€Ÿå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚","text":"ç´¢å¼•ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„ åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå¿«é€Ÿå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚ ä¼˜åŠ¿ æé«˜æ•°æ®æ£€ç´¢æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬ é€šè¿‡ç´¢å¼•å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½äº†æ¶ˆè€— åŠ£åŠ¿ å®é™…ä¸Šç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“è¡¨çš„è®°å½•ï¼Œç´¢å¼•åˆ—ä¹Ÿæ˜¯è¦å ç©ºé—´çš„ è™½ç„¶ç´¢å¼•åˆ—å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ã€‚å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶æ¯æ¬¡æ›´æ–°æ·»åŠ äº†ç´¢å¼•åˆ—çš„å­—æ®µ å“ªäº›æƒ…å†µéœ€è¦åˆ›å»ºç´¢å¼• ä¸»é”®è‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼• ï¼ˆä¸éœ€è¦è‡ªå·±å»ºï¼‰ é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œå¤–é”®å…³ç³»å»ºç«‹ç´¢å¼• ï¼ˆè‡ªåŠ¨å»ºç«‹ï¼‰ æŸ¥è¯¢ä¸­æ’åºçš„å­—æ®µï¼Œæ’åºçš„å­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦ æŸ¥è¯¢ä¸­ç»Ÿè®¡æˆ–è€…åˆ†ç»„çš„å­—æ®µ å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼• è¡¨è®°å½•å¤ªå° ç»å¸¸å¢åˆ æ”¹çš„è¡¨ æŸä¸ªæ•°æ®åˆ—åŒ…å«è®¸å¤šé‡å¤çš„å†…å®¹ï¼Œä¸ºå®ƒå»ºç«‹ç´¢å¼•å°±æ²¡æœ‰å¤ªå¤§çš„å®é™…æ•ˆæœ","categories":[],"tags":[{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/tags/sql/"}]},{"title":"Javaè™šæ‹Ÿæœº","slug":"Javaè™šæ‹Ÿæœº","date":"2018-04-12T12:01:50.000Z","updated":"2018-04-14T12:37:13.002Z","comments":true,"path":"2018/04/12/Javaè™šæ‹Ÿæœº/","link":"","permalink":"https://hsb786.github.io/2018/04/12/Javaè™šæ‹Ÿæœº/","excerpt":"å†…å­˜åŒºåŸŸJavaè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠä»–æ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚Javaè™šæ‹Ÿæœºè§„èŒƒå°†JVMæ‰€ç®¡ç†çš„å†…å­˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿è¡Œæ—¶æ•°æ®åŒºï¼šç¨‹åºè®¡æ•°å™¨ã€Javaè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€Javaå †ã€æ–¹æ³•åŒºã€‚ä¸‹é¢è¯¦ç»†é˜è¿°å„æ•°æ®åŒºæ‰€å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚","text":"å†…å­˜åŒºåŸŸJavaè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠä»–æ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚Javaè™šæ‹Ÿæœºè§„èŒƒå°†JVMæ‰€ç®¡ç†çš„å†…å­˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿è¡Œæ—¶æ•°æ®åŒºï¼šç¨‹åºè®¡æ•°å™¨ã€Javaè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€Javaå †ã€æ–¹æ³•åŒºã€‚ä¸‹é¢è¯¦ç»†é˜è¿°å„æ•°æ®åŒºæ‰€å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚ JVM(Java Virtual Machine)JVMå¹¶ä¸æ˜¯ä¸“ä¸ºJavaæ‰€å®ç°çš„ã€‚å®é™…ä¸Šåªè¦æœ‰å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘å™¨èƒ½ç”Ÿæˆæ­£ç¡®Java bytecodeæ–‡ä»¶ï¼Œåˆ™è¿™ä¸ªè¯­è¨€ä¹Ÿèƒ½å®ç°åœ¨JVMä¸Šè¿è¡Œã€‚ JVMé€šè¿‡æ‰§è¡ŒJava bytecodeå¯ä»¥ä½¿javaä»£ç åœ¨ä¸æ”¹å˜çš„æƒ…å†µä¸‹è¿è¡Œåœ¨å„ç§ç¡¬ä»¶ä¹‹ä¸Šï¼Œå› æ­¤å®ç°Javaå¹³å°æ— å…³æ€§ JVM = ç±»åŠ è½½å™¨ Class Loader + æ‰§è¡Œå¼•æ“ Execution Engine + è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ Runtime Data Area é¦–å…ˆJavaæºä»£ç æ–‡ä»¶è¢«Javaç¼–è¯‘å™¨ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶ï¼Œç„¶åJVMä¸­çš„ç±»åŠ è½½å™¨åŠ è½½å®Œæ¯•ä¹‹åï¼Œäº¤ç”±JVMæ‰§è¡Œå¼•æ“æ‰§è¡Œã€‚åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒJVMä¸­çš„è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆå†…å­˜ï¼‰ä¼šç”¨æ¥å­˜å‚¨ç¨‹åºæ‰§è¡ŒæœŸé—´éœ€è¦ç”¨åˆ°çš„æ•°æ®å’Œç›¸å…³ä¿¡æ¯ã€‚ Class LoaderClassLoaderæŠŠç¡¬ç›˜ä¸Šçš„classæ–‡ä»¶åŠ è½½åˆ°JVMä¸­çš„è¿è¡Œæ—¶æ•°æ®åŒºåŸŸï¼Œä½†æ˜¯å®ƒå¹¶ä¸è´Ÿè´£è¿™ä¸ªç±»æ–‡ä»¶èƒ½å¦æ‰§è¡Œï¼Œè€Œè¿™ä¸ªæ˜¯æ‰§è¡Œå¼•æ“è´Ÿè´£çš„ã€‚ Execution Engineæ‰§è¡Œå­—èŠ‚ç ï¼Œæˆ–è€…æ‰§è¡Œæœ¬åœ°æ–¹æ³• Runtime DataAreaæŒ‡JVMåœ¨è¿è¡ŒæœŸé—´ï¼Œå…¶å¯¹JVMå†…å­˜ç©ºé—´çš„åˆ’åˆ†å’Œåˆ†é…ã€‚ ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶é€šè¿‡æ”¹å˜è¯¥è®¡æ•°å™¨çš„å€¼æ¥é€‰æ‹©ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€è·³è½¬ã€å¾ªç¯ç­‰åŸºç¡€åŠŸèƒ½éƒ½è¦ä¾èµ–å®ƒæ¥å®ç°ã€‚æ¯æ¡çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„çº¿ç¨‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œå› æ­¤è¯¥åŒºåŸŸæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚ å½“çº¿ç¨‹åœ¨æ‰§è¡Œä¸€ä¸ªJavaæ–¹æ³•æ—¶ï¼Œè¯¥è®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œå½“çº¿ç¨‹åœ¨æ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•ï¼ˆè°ƒç”¨æœ¬åœ°æ“ä½œç³»ç»Ÿæ–¹æ³•ï¼‰æ—¶ï¼Œè¯¥è®¡æ•°å™¨çš„å€¼ä¸ºç©ºã€‚å¦å¤–ï¼Œè¯¥å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OOMï¼ˆå†…å­˜æº¢å‡ºï¼šOutOfMemoryErrorï¼‰æƒ…å†µçš„åŒºåŸŸã€‚ Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰è¯¥åŒºåŸŸä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸çº¿ç¨‹ç›¸åŒã€‚è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œæ ˆå®ƒæ˜¯ç”¨äºæ”¯æŒç»­è™šæ‹Ÿæœºè¿›è¡Œæ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œçš„æ•°æ®ç»“æ„ã€‚å¯¹äºæ‰§è¡Œå¼•æ“æ¥è®²ï¼Œæ´»åŠ¨çº¿ç¨‹ä¸­ï¼Œåªæœ‰æ ˆé¡¶çš„æ ˆå¸§æ˜¯æœ‰æ•ˆçš„ï¼Œç§°ä¸ºå½“å‰æ ˆå¸§ï¼Œè¿™ä¸ªæ ˆå¸§æ‰€å…³è”çš„æ–¹æ³•ç§°ä¸ºå½“å‰æ–¹æ³•ï¼Œæ‰§è¡Œå¼•æ“æ‰€è¿è¡Œçš„æ‰€æœ‰å­—èŠ‚ç æŒ‡ä»¤éƒ½åªé’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œã€‚æ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•è¿”å›åœ°å€å’Œä¸€äº›é¢å¤–çš„é™„åŠ ä¿¡æ¯ã€‚åœ¨ç¼–è¯‘ç¨‹åºä»£ç æ—¶ï¼Œæ ˆå¸§ä¸­éœ€è¦å¤šå¤§çš„å±€éƒ¨å˜é‡è¡¨ã€å¤šæ·±çš„æ“ä½œæ•°æ ˆéƒ½å·²ç»å®Œå…¨ç¡®å®šäº†ï¼Œå¹¶ä¸”å†™å…¥äº†æ–¹æ³•è¡¨çš„Codeå±æ€§ä¹‹ä¸­ã€‚å› æ­¤ï¼Œä¸€ä¸ªæ ˆå¸§éœ€è¦åˆ†é…å¤šå°‘å†…å­˜ï¼Œä¸ä¼šå—åˆ°ç¨‹åºè¿è¡ŒæœŸå˜é‡æ•°æ®çš„å½±å“ï¼Œè€Œä»…ä»…å–å†³äºå…·ä½“çš„è™šæ‹Ÿæœºå®ç°ã€‚ åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­ï¼Œå¯¹è¿™ä¸ªåŒºåŸŸè§„å®šäº†ä¸¤ç§å¼‚å¸¸æƒ…å†µï¼š å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚ å¦‚æœè™šæ‹Ÿæœºåœ¨åŠ¨æ€æ‰©å±•æ ˆæ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ï¼Œåˆ™æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰è¯¥åŒºåŸŸä¸è™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡ŒJavaæ–¹æ³•æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºä½¿ç”¨åˆ°çš„æœ¬åœ°æ“ä½œç³»ç»Ÿï¼ˆNativeï¼‰æ–¹æ³•æœåŠ¡ã€‚ å’ŒJVMæ ˆä¸€æ ·ï¼Œä¹Ÿä¼šæŠ›å‡ºStackOverflowErrorå’ŒOutOfMemoryErrorå¼‚å¸¸ Javaå †ï¼ˆJava Heapï¼‰Java Heapæ˜¯Javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œå®ƒæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½åœ¨è¿™ç±»åˆ†é…å†…å­˜ã€‚Java Heapæ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™ä¹Ÿè¢«ç§°ä¸ºâ€œGCå †â€ã€‚ æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼ŒJavaå †å¯ä»¥å¤„åœ¨ç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ã€‚å¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜å¯åˆ†é…æ—¶ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•æ‰©å±•æ—¶ï¼Œå°†ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰æ–¹æ³•åŒºä¹Ÿæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚æ–¹æ³•åŒºåŸŸåˆè¢«ç§°ä¸ºâ€œæ°¸ä¹…ä»£â€ã€‚ ç”±äºä½¿ç”¨åå°„æœºåˆ¶çš„åŸå› ï¼Œè™šæ‹Ÿæœºå¾ˆéš¾æ¨æµ‹å“ªä¸ªç±»ä¿¡æ¯ä¸å†ä½¿ç”¨ï¼Œå› æ­¤è¿™å—åŒºåŸŸçš„å›æ”¶å¾ˆéš¾ã€‚å¦å¤–ï¼Œå¯¹è¿™å—åŒºåŸŸä¸»è¦æ˜¯é’ˆå¯¹å¸¸é‡æ± å›æ”¶ï¼Œä½†java7å·²ç»æŠŠå¸¸é‡æ± è½¬ç§»åˆ°å †é‡Œé¢äº†ã€‚ æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼Œå½“æ–¹æ³•åŒºæ— æ³•æ»¡è¶³å†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œå°†æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ å‚è€ƒ ã€æ·±å…¥Javaè™šæ‹Ÿæœºã€‘ä¹‹ä¸€ï¼šJavaå†…å­˜åŒºåŸŸä¸å†…å­˜æº¢å‡º è¯»ä¹¦ç¬”è®°-æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰","slug":"java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰","date":"2018-04-12T07:56:55.000Z","updated":"2018-04-13T04:39:49.093Z","comments":true,"path":"2018/04/12/java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰/","link":"","permalink":"https://hsb786.github.io/2018/04/12/java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰/","excerpt":"Java 8å¸¦æ¥äº†å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬Lambda è¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ã€æµ(Stream API)ã€é»˜è®¤æ–¹æ³•ã€Optionalã€ç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹ã€æ–°çš„æ—¶é—´ APIï¼Œç­‰ç­‰å„ä¸ªæ–¹é¢ã€‚","text":"Java 8å¸¦æ¥äº†å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬Lambda è¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ã€æµ(Stream API)ã€é»˜è®¤æ–¹æ³•ã€Optionalã€ç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹ã€æ–°çš„æ—¶é—´ APIï¼Œç­‰ç­‰å„ä¸ªæ–¹é¢ã€‚ Default Methods for InterfacesJava 8 å…è®¸æˆ‘ä»¬ä½¿ç”¨defaultå…³é”®å­—ï¼Œä¸ºæ¥å£å£°æ˜æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•å®ç°ã€‚è¿™ä¸ªç‰¹æ€§åˆè¢«ç§°ä¸ºæ‰©å±•æ–¹æ³•ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼š 1234567interface Formula &#123; double calculate(int a); default double sqrt(int a) &#123; return Math.sqrt(a); &#125;&#125; åœ¨æ¥å£Formulaä¸­ï¼Œé™¤äº†æŠ½è±¡æ–¹æ³•caculateä»¥å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•sqrt.Formulaçš„å®ç°ç±»åªéœ€è¦å®ç°æŠ½è±¡æ–¹æ³•caculateå°±å¯ä»¥äº†ã€‚é»˜è®¤æ–¹æ³•sqrtå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ 123456789Formula formula = new Formula() &#123; @Override public double calculate(int a) &#123; return sqrt(a * 100); &#125;&#125;;formula.calculate(100); // 100.0formula.sqrt(16); // 4.0 é‚£ä¹ˆè¿™ä¸ªæ–°ç‰¹å¾æœ‰å•¥ç”¨å‘¢ï¼Ÿ æˆ‘ä»¬å¾€å¾€ä¼šç¢°åˆ°è¿™æ ·ä¸€ä¸ªæƒ…å†µæˆ‘ä»¬å®šä¹‰çš„æ¥å£æ ¹æ®ä¸åŒçš„åœºæ™¯å®šä¹‰äº†å‡ ä¸ªä¸åŒçš„å®ç°ç±»ï¼Œé‚£ä¹ˆå¦‚æœéœ€è¦è¿™å‡ ä¸ªå®ç°ç±»è°ƒç”¨çš„æ–¹æ³•éƒ½å¾—åˆ°åŒä¸€ä¸ªç»“æœæˆ–è€…åªæœ‰ä¸€ä¸ªå®ç°ç±»éœ€è¦è¿™ä¸ªæ¥å£æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å»é‡å†™æ¯ä¸ªå®ç°äº†è¿™ä¸ªæ¥å£çš„ç±»ï¼Œè€Œè¿™å¤§å¤§å¢åŠ äº†æˆ‘ä»¬çš„å®ç°éœ€æ±‚çš„è´Ÿæ‹…ã€‚ æ­£æ˜¯ä¸ºäº†è§£å†³Javaæ¥å£ä¸­åªèƒ½å®šä¹‰æŠ½è±¡æ–¹æ³•çš„é—®é¢˜ã€‚Java8æ–°å¢åŠ äº†é»˜è®¤æ–¹æ³•çš„ç‰¹æ€§ã€‚é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿æ¥å£é‡å†™æˆæŠ½è±¡æ–¹æ³•æˆ–è€…é‡æ–°å®šä¹‰æˆé»˜è®¤æ–¹æ³•ã€‚é™¤äº†é»˜è®¤æ–¹æ³•ï¼Œæ¥å£é‡Œè¿˜å¯ä»¥å£°æ˜é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥å®ç°ã€‚ä¾‹å­å¦‚ä¸‹ï¼š123456private interface DefaulableFactory &#123; // Interfaces now allow static methods static Defaulable create( Supplier&lt; Defaulable &gt; supplier ) &#123; return supplier.get(); &#125;&#125; Conflictå› ä¸ºä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªç±»å®ç°äº†å¤šä¸ªæ¥å£ï¼Œè€Œè¿™äº›æ¥å£ä¸­å­˜åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šæ–¹æ³•ç­¾åç›¸åŒçš„é»˜è®¤æ–¹æ³•æ—¶å°±ä¼šäº§ç”Ÿå†²çªï¼Œjava8å®šä¹‰å¦‚ä¸‹ä¸‰æ¡åŸåˆ™æ¥è§£å†³å†²çªï¼š ç±»æˆ–çˆ¶ç±»ä¸­æ˜¾å¼å£°æ˜çš„æ–¹æ³•ï¼Œå…¶ä¼˜å…ˆçº§é«˜äºæ‰€æœ‰çš„é»˜è®¤æ–¹æ³•ï¼› å¦‚æœ1è§„åˆ™å¤±æ•ˆï¼Œåˆ™é€‰æ‹©ä¸å½“å‰ç±»è·ç¦»æœ€è¿‘çš„å…·æœ‰å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•ï¼› å¦‚æœ2è§„åˆ™ä¹Ÿå¤±æ•ˆï¼Œåˆ™éœ€è¦æ˜¾å¼æŒ‡å®šæ¥å£ã€‚ Lambda ExpressionsLambdaè¡¨è¾¾å¼ï¼ˆåˆè¢«æˆä¸ºâ€œé—­åŒ…â€æˆ–â€œåŒ¿åæ–¹æ³•â€ï¼‰æ˜¯ç®€æ´åœ°è¡¨ç¤ºå¯ä¼ é€’çš„åŒ¿åå‡½æ•°çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒæä¾›äº†è½»é‡çº§çš„è¯­æ³• é‡ç‚¹ç•™æ„è¿™å››ä¸ªå…³é”®è¯ï¼šåŒ¿åã€å‡½æ•°ã€ä¼ é€’ã€ç®€æ´ Lambdaçš„ä¸‰ä¸ªéƒ¨åˆ†ï¼š å‚æ•°åˆ—è¡¨ ç®­å¤´ Lambda ä¸»ä½“ Lambdaçš„åŸºæœ¬è¯­æ³•å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™æ ·å­çš„äº†ï¼š (parameters) -&gt; expression (parameters) -&gt; { statements; } 1234567Collections.sort(names, (String a, String b) -&gt; &#123; return b.compareTo(a);&#125;);æˆ–è€…æ˜¯Collections.sort(names, (String a, String b) -&gt; b.compareTo(a));äº¦æˆ–æ˜¯Collections.sort(names, (a, b) -&gt; b.compareTo(a)); Lexiacal Scopeè®¿é—®å±€éƒ¨å˜é‡å¯ä»¥ç›´æ¥åœ¨Lambdaè¡¨è¾¾å¼ä¸­è®¿é—®å¤–å±‚çš„å±€éƒ¨å˜é‡ï¼Œä½†æ˜¯å’ŒåŒ¿åå¯¹è±¡ä¸åŒçš„æ˜¯ï¼ŒLambdaè¡¨è¾¾å¼çš„å±€éƒ¨å˜é‡å¯ä»¥ä¸ç”¨å£°æ˜ä¸ºfinalï¼Œä¸è¿‡å±€éƒ¨å˜é‡å¿…é¡»ä¸å¯è¢«åé¢çš„ä»£ç ä¿®æ”¹ï¼ˆå³éšæ€§çš„å…·æœ‰finalçš„è¯­ä¹‰ï¼‰ã€‚ egï¼šä¸‹é¢ä»£ç æ— æ³•ç¼–è¯‘1234int num = 1; Converter&lt;Integer, String&gt; s = (param) -&gt; String.valueOf(param + num); num = 5; åœ¨Lambdaè¡¨è¾¾å¼ä¸­è¯•å›¾ä¿®æ”¹å±€éƒ¨å˜é‡æ˜¯ä¸å…è®¸çš„ï¼ åœ¨ Lambda è¡¨è¾¾å¼å½“ä¸­è¢«å¼•ç”¨çš„å˜é‡çš„å€¼ä¸å¯ä»¥è¢«æ›´æ”¹ã€‚ åœ¨ Lambda è¡¨è¾¾å¼å½“ä¸­ä¸å…è®¸å£°æ˜ä¸€ä¸ªä¸å±€éƒ¨å˜é‡åŒåçš„å‚æ•°æˆ–è€…å±€éƒ¨å˜é‡ã€‚ å’Œå±€éƒ¨å˜é‡ä¸åŒçš„æ˜¯ï¼ŒLambdaå†…éƒ¨å¯¹äºå®ä¾‹çš„å­—æ®µï¼ˆå³ï¼šæˆå‘˜å˜é‡ï¼‰ä»¥åŠé™æ€å˜é‡æ˜¯å³å¯è¯»åˆå¯å†™ã€‚ ä¸èƒ½è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•Lambdaè¡¨è¾¾å¼ä¸­æ˜¯æ— æ³•è®¿é—®åˆ°é»˜è®¤æ–¹æ³•çš„ã€‚ è¡¥å……ï¼šLambdaè¡¨è¾¾å¼å¯¹å€¼å°é—­ï¼Œå¯¹å˜é‡å¼€æ”¾çš„åŸæ–‡æ˜¯ï¼šlambda expressions close over values, not variablesï¼Œåœ¨è¿™é‡Œå¢åŠ ä¸€ä¸ªä¾‹å­ä»¥è¯´æ˜è¿™ä¸ªç‰¹æ€§ï¼š 12345int sum = 0;list.forEach(e -&gt; &#123; sum += e.size(); &#125;); // Illegal, close over valuesList&lt;Integer&gt; aList = new List&lt;&gt;();list.forEach(e -&gt; &#123; aList.add(e); &#125;); // Legal, open over variables åŒ¿åå†…éƒ¨ç±»çš„ç®€å†™ï¼ŸLambdaè¡¨è¾¾å¼é€šè¿‡invokedynamicæŒ‡ä»¤å®ç°ï¼Œä¹¦å†™Lambdaè¡¨è¾¾å¼ä¸ä¼šäº§ç”Ÿæ–°çš„ç±»ã€‚å¦‚æœæœ‰å¦‚ä¸‹ä»£ç ï¼Œç¼–è¯‘ä¹‹ååªæœ‰ä¸€ä¸ªclassæ–‡ä»¶ Lambdaè¡¨è¾¾å¼ä¸­çš„thisæ—¢ç„¶Lambdaè¡¨è¾¾å¼ä¸æ˜¯å†…éƒ¨ç±»çš„ç®€å†™ï¼Œé‚£ä¹ˆLambdaå†…éƒ¨çš„thiså¼•ç”¨ä¹Ÿå°±è·Ÿå†…éƒ¨ç±»å¯¹è±¡æ²¡ä»€ä¹ˆå…³ç³»äº†ã€‚åœ¨Lambdaè¡¨è¾¾å¼ä¸­thisçš„æ„ä¹‰è·Ÿåœ¨è¡¨è¾¾å¼å¤–éƒ¨å®Œå…¨ä¸€æ ·ã€‚ Functional Interfacesä»»æ„åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨æ¥åšæˆLambdaè¡¨è¾¾å¼ã€‚ä¸ºäº†è®©ä½ å®šä¹‰çš„æ¥å£æ»¡è¶³è¦æ±‚ï¼Œä½ åº”å½“åœ¨æ¥å£å‰åŠ ä¸Š@FunctionalInterface æ ‡æ³¨ã€‚ç¼–è¯‘å™¨ä¼šæ³¨æ„åˆ°è¿™ä¸ªæ ‡æ³¨ï¼Œå¦‚æœä½ çš„æ¥å£ä¸­å®šä¹‰äº†ç¬¬äºŒä¸ªæŠ½è±¡æ–¹æ³•çš„è¯ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ 12345678@FunctionalInterfaceinterface Converter&lt;F, T&gt; &#123; T convert(F from);&#125; Converter&lt;String, Integer&gt; converter = (from) -&gt; Integer.valueOf(from);Integer converted = converter.convert(&quot;123&quot;);System.out.println(converted); // 123 æ³¨æ„ï¼Œå¦‚æœä½ ä¸å†™@FunctionalInterface æ ‡æ³¨ï¼Œç¨‹åºä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ ä¸‹é¢æ˜¯Java SE 7ä¸­å·²ç»å­˜åœ¨çš„å‡½æ•°å¼æ¥å£ï¼š java.lang.Runnable java.util.concurrent.Callable java.security.PrivilegedAction java.util.Comparator java.io.FileFilter java.beans.PropertyChangeListener é™¤æ­¤ä¹‹å¤–ï¼ŒJava SE 8ä¸­å¢åŠ äº†ä¸€ä¸ªæ–°çš„åŒ…ï¼šjava.util.functionï¼Œå®ƒé‡Œé¢åŒ…å«äº†å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚ï¼š Predicateâ€”â€”æ¥æ”¶Tå¯¹è±¡å¹¶è¿”å›boolean Consumerâ€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œä¸è¿”å›å€¼ Function&lt;T, R&gt;â€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œè¿”å›Rå¯¹è±¡ Supplierâ€”â€”æä¾›Tå¯¹è±¡ï¼ˆä¾‹å¦‚å·¥å‚ï¼‰ï¼Œä¸æ¥æ”¶å€¼ UnaryOperatorâ€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œè¿”å›Tå¯¹è±¡ BinaryOperatorâ€”â€”æ¥æ”¶ä¸¤ä¸ªTå¯¹è±¡ï¼Œè¿”å›Tå¯¹è±¡ é™¤äº†ä¸Šé¢çš„è¿™äº›åŸºæœ¬çš„å‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€äº›é’ˆå¯¹åŸå§‹ç±»å‹ï¼ˆPrimitive typeï¼‰çš„ç‰¹åŒ–ï¼ˆSpecializationï¼‰å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚IntSupplierå’ŒLongBinaryOperatorã€‚ï¼ˆæˆ‘ä»¬åªä¸ºintã€longå’Œdoubleæä¾›äº†ç‰¹åŒ–å‡½æ•°å¼æ¥å£ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å…¶å®ƒåŸå§‹ç±»å‹åˆ™éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢ï¼‰åŒæ ·çš„æˆ‘ä»¬ä¹Ÿæä¾›äº†ä¸€äº›é’ˆå¯¹å¤šä¸ªå‚æ•°çš„å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚BiFunction&lt;T, U, R&gt;ï¼Œå®ƒæ¥æ”¶Tå¯¹è±¡å’ŒUå¯¹è±¡ï¼Œè¿”å›Rå¯¹è±¡ã€‚ Method and Constructor ReferencesLambdaè¡¨è¾¾å¼å…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œå¹¶å…è®¸æˆ‘ä»¬ä»¥å‡½æ•°å¼æ¥å£çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿåœ¨å·²æœ‰çš„æ–¹æ³•ä¸Šå®ç°åŒæ ·çš„ç‰¹æ€§ã€‚ æ–¹æ³•å¼•ç”¨å’ŒLambdaè¡¨è¾¾å¼æ‹¥æœ‰ç›¸åŒçš„ç‰¹æ€§ï¼ˆä¾‹å¦‚ï¼Œå®ƒä»¬éƒ½éœ€è¦ä¸€ä¸ªç›®æ ‡ç±»å‹ï¼Œå¹¶éœ€è¦è¢«è½¬åŒ–ä¸ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹ï¼‰ï¼Œä¸è¿‡æˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸ºæ–¹æ³•å¼•ç”¨æä¾›æ–¹æ³•ä½“ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ–¹æ³•åç§°å¼•ç”¨å·²æœ‰æ–¹æ³•ã€‚ æ–¹æ³•å¼•ç”¨å°±æ˜¯æ›¿ä»£é‚£äº›è½¬å‘å‚æ•°çš„ Lambda è¡¨è¾¾å¼çš„è¯­æ³•ç³–ã€‚æ–¹æ³•å¼•ç”¨æœ‰å¾ˆå¤šç§ï¼Œå®ƒä»¬çš„è¯­æ³•å¦‚ä¸‹ï¼š é™æ€æ–¹æ³•å¼•ç”¨ï¼šClassName::methodName å®é™…ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šinstanceReference::methodName è¶…ç±»ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šsuper::methodName ç±»å‹ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šClassName::methodName æ„é€ æ–¹æ³•å¼•ç”¨ï¼šClass::new æ•°ç»„æ„é€ æ–¹æ³•å¼•ç”¨ï¼šTypeName[]::new å¯¹äºé™æ€æ–¹æ³•å¼•ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç±»åå’Œæ–¹æ³•åä¹‹é—´åŠ å…¥::åˆ†éš”ç¬¦ï¼Œä¾‹å¦‚Integer::sumã€‚ ç»“åˆLambdaå¯ä»¥ä½¿æˆ‘ä»¬çš„ä»£ç æ›´åŠ ç®€æ´ï¼š 1234List&lt;String&gt; strings = Arrays.asList(&quot;a&quot;, &quot;b&quot;);strings.stream().map(String::toUpperCase).forEach(System.out::println);List&lt;Character&gt; chars = Arrays.asList(&apos;a&apos;, &apos;b&apos;); System.out.println(chars.stream().map(String::valueOf).collect(Collectors.joining(&quot;,&quot;))); OptionalNullPointExceptionå¯ä»¥è¯´æ˜¯æ‰€æœ‰Javaç¨‹åºå‘˜éƒ½é‡åˆ°è¿‡çš„ä¸€ä¸ªå¼‚å¸¸ï¼Œè™½ç„¶Javaä»è®¾è®¡ä¹‹åˆå°±åŠ›å›¾è®©ç¨‹åºå‘˜è„±ç¦»æŒ‡é’ˆçš„è‹¦æµ·ï¼Œä½†æ˜¯æŒ‡é’ˆç¡®å®æ˜¯å®é™…å­˜åœ¨çš„ï¼Œè€Œjavaè®¾è®¡è€…ä¹Ÿåªèƒ½æ˜¯è®©æŒ‡é’ˆåœ¨Javaè¯­è¨€ä¸­å˜å¾—æ›´åŠ ç®€å•ã€æ˜“ç”¨ï¼Œè€Œä¸èƒ½å®Œå…¨çš„å°†å…¶å‰”é™¤ï¼Œæ‰€ä»¥æ‰æœ‰äº†æˆ‘ä»¬æ—¥å¸¸æ‰€è§åˆ°çš„å…³é”®å­—nullã€‚ ç©ºæŒ‡é’ˆå¼‚å¸¸æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯¹äºè¿™ä¸€ç±»å¼‚å¸¸ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„å¤„ç†ç­–ç•¥ï¼Œé‚£ä¹ˆæœ€ä½³å®è·µåœ¨äºè®©ç¨‹åºæ—©ç‚¹æŒ‚æ‰ï¼Œä½†æ˜¯å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œä¸æ˜¯å¼€å‘äººå‘˜æ²¡æœ‰å…·ä½“çš„å¤„ç†ç­–ç•¥ï¼Œè€Œæ˜¯æ ¹æœ¬æ²¡æœ‰æ„è¯†åˆ°ç©ºæŒ‡é’ˆå¼‚å¸¸çš„å­˜åœ¨ã€‚å½“å¼‚å¸¸çœŸçš„å‘ç”Ÿçš„æ—¶å€™ï¼Œå¤„ç†ç­–ç•¥ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨å­˜åœ¨å¼‚å¸¸çš„åœ°æ–¹æ·»åŠ ä¸€ä¸ªifè¯­å¥åˆ¤å®šå³å¯ï¼Œä½†æ˜¯è¿™æ ·çš„åº”å¯¹ç­–ç•¥ä¼šè®©æˆ‘ä»¬çš„ç¨‹åºå‡ºç°è¶Šæ¥è¶Šå¤šçš„nullåˆ¤å®šï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªè‰¯å¥½çš„ç¨‹åºè®¾è®¡ï¼Œåº”è¯¥è®©ä»£ç ä¸­å°½é‡å°‘å‡ºç°nullå…³é”®å­—ï¼Œè€ŒJava8æ‰€æä¾›çš„Optionalç±»åˆ™åœ¨å‡å°‘NullPointExceptionçš„åŒæ—¶ï¼Œä¹Ÿæå‡äº†ä»£ç çš„ç¾è§‚åº¦ã€‚ä½†é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œå®ƒå¹¶ ä¸æ˜¯å¯¹nullå…³é”®å­—çš„ä¸€ç§æ›¿ä»£ï¼Œè€Œæ˜¯å¯¹äºnullåˆ¤å®šæä¾›äº†ä¸€ç§æ›´åŠ ä¼˜é›…çš„å®ç°ï¼Œä»è€Œé¿å…NullPointExceptionã€‚ java.util.Optional å¯¹å¯èƒ½ç¼ºå¤±çš„å€¼å»ºæ¨¡,å¼•å…¥çš„ç›®çš„å¹¶éæ˜¯è¦æ¶ˆé™¤æ¯ä¸€ä¸ª null å¼•ç”¨ï¼Œè€Œæ˜¯å¸®åŠ©ä½ æ›´å¥½åœ°è®¾è®¡å‡ºæ™®é€‚çš„ APIã€‚ åˆ›å»º Optional å¯¹è±¡,ä¸‰ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼š Optional.emptyï¼šåˆ›å»ºç©ºçš„ Optional å¯¹è±¡ Optional.ofï¼šä¾æ®éç©ºå€¼åˆ›å»º Optional å¯¹è±¡ï¼Œè‹¥ä¼ ç©ºå€¼ä¼šæŠ› NPE Optianal.ofNullableï¼šåˆ›å»º Optional å¯¹è±¡ï¼Œå…è®¸ä¼ ç©ºå€¼ Optional APIï¼š isPresent(): å˜é‡å­˜åœ¨è¿”å›true get(): è¿”å›å°è£…çš„å˜é‡å€¼ï¼Œæˆ–è€…æŠ›å‡º NoSuchElementException orElse(T other): æä¾›é»˜è®¤å€¼ orElseGet(Supplier&lt;? extends T&gt; other): orElse æ–¹æ³•çš„å»¶è¿Ÿè°ƒç”¨ç‰ˆ orElseThrow(Supplier&lt;&gt; extends X&gt; exceptionSupplier): ç±»ä¼¼ getï¼Œä½†å¯ä»¥å®šåˆ¶å¸Œæœ›æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ ifPresent(Consumer&lt;? super T&gt;): å˜é‡å­˜åœ¨æ—¶å¯ä»¥æ‰§è¡Œä¸€ä¸ªæ–¹æ³• filter(Predicate&lt;? super T&gt; predicate): è¿‡æ»¤ map(Function&lt;? super T, ? extends U&gt; mapper): è½¬æ¢ flatMap(Function&lt;? super T, Optional&lt;U>>mapper): è½¬æ¢æˆOptional å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šOptionalæ˜¯ä¸€ä¸ªfinalç±»ï¼Œæœªå®ç°ä»»ä½•æ¥å£ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨åˆ©ç”¨è¯¥ç±»åŒ…è£…å®šä¹‰ç±»çš„å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰çš„ç±»æœ‰åºåˆ—åŒ–çš„éœ€æ±‚ï¼Œé‚£ä¹ˆå› ä¸ºOptionalæ²¡æœ‰å®ç°Serializableæ¥å£ï¼Œè¿™ä¸ªæ—¶å€™æ‰§è¡Œåºåˆ—åŒ–æ“ä½œå°±ä¼šæœ‰é—®é¢˜ Optional ç±»è®¾è®¡çš„åˆè¡·ä»…ä»…æ˜¯è¦æ”¯æŒèƒ½è¿”å› Optional å¯¹è±¡çš„æ–¹æ³•ï¼Œæ²¡æœ‰è€ƒè™‘å°†å®ƒä½œä¸ºç±»çš„å­—æ®µä½¿ç”¨â€¦ å¦å¤–ï¼Œåœ¨Java9ä¸­å¯¹Optionalæ·»åŠ äº†ä¸‰ä¸ªæ–°çš„æ–¹æ³•ï¼š public Optional or(Supplier&lt;? extends Optional&lt;? extends T&gt;&gt; supplier)or æ–¹æ³•çš„ä½œç”¨æ˜¯ï¼Œå¦‚æœä¸€ä¸ª Optional åŒ…å«å€¼ï¼Œåˆ™è¿”å›è‡ªå·±ï¼›å¦åˆ™è¿”å›ç”±å‚æ•° supplier è·å¾—çš„ Optional public void ifPresentOrElse(Consumer&lt;? super T&gt; action, Runnable emptyAction)ifPresentOrElse æ–¹æ³•çš„ç”¨é€”æ˜¯ï¼Œå¦‚æœä¸€ä¸ª Optional åŒ…å«å€¼ï¼Œåˆ™å¯¹å…¶åŒ…å«çš„å€¼è°ƒç”¨å‡½æ•° actionï¼Œå³ action.accept(value)ï¼Œè¿™ä¸ ifPresent ä¸€è‡´ï¼›ä¸ ifPresent æ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼ŒifPresentOrElse è¿˜æœ‰ç¬¬äºŒä¸ªå‚æ•° emptyAction â€”â€” å¦‚æœ Optional ä¸åŒ…å«å€¼ï¼Œé‚£ä¹ˆ ifPresentOrElse ä¾¿ä¼šè°ƒç”¨ emptyActionï¼Œå³ emptyAction.run() public Stream stream()stream æ–¹æ³•çš„ä½œç”¨å°±æ˜¯å°† Optional è½¬ä¸ºä¸€ä¸ª Streamï¼Œå¦‚æœè¯¥ Optional ä¸­åŒ…å«å€¼ï¼Œé‚£ä¹ˆå°±è¿”å›åŒ…å«è¿™ä¸ªå€¼çš„ Streamï¼›å¦åˆ™è¿”å›ä¸€ä¸ªç©ºçš„ Streamï¼ˆStream.empty()ï¼‰ ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ Java8ï¼Œæˆ‘ä»¬ä¼šå†™ä¸‹é¢çš„ä»£ç ï¼š 12345678// æ­¤å¤„ getUserById è¿”å›çš„æ˜¯ Optional&lt;User&gt;public List&lt;User&gt; getUsers(Collection&lt;Integer&gt; userIds) &#123; return userIds.stream() .map(this::getUserById) // è·å¾— Stream&lt;Optional&lt;User&gt;&gt; .filter(Optional::isPresent)// å»æ‰ä¸åŒ…å«å€¼çš„ Optional .map(Optional::get) .collect(Collectors.toList());&#125; è€Œæœ‰äº† Optional.stream()ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶ç®€åŒ–ä¸ºï¼š 123456public List&lt;User&gt; getUsers(Collection&lt;Integer&gt; userIds) &#123; return userIds.stream() .map(this::getUserById) // è·å¾— Stream&lt;Optional&lt;User&gt;&gt; .flatMap(Optional::stream) // Stream çš„ flatMap æ–¹æ³•å°†å¤šä¸ªæµåˆæˆä¸€ä¸ªæµ .collect(Collectors.toList());&#125; Streams æµæ˜¯ä»€ä¹ˆ12345Arrays.asList(&quot;a1&quot;, &quot;a2&quot;, &quot;b1&quot;, &quot;c2&quot;, &quot;c1&quot;).stream() .filter(s -&gt; s.startsWith(&quot;c&quot;)) .map(String::toUpperCase) .sorted() .forEach(System.out::println); æµæ˜¯Java SE 8ç±»åº“ä¸­æ–°å¢çš„å…³é”®æŠ½è±¡ï¼Œå®ƒè¢«å®šä¹‰äºjava.util.streamï¼ˆè¿™ä¸ªåŒ…é‡Œæœ‰è‹¥å¹²æµç±»å‹ï¼šStreamä»£è¡¨å¯¹è±¡å¼•ç”¨æµï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ç³»åˆ—ç‰¹åŒ–ï¼ˆspecializationï¼‰æµï¼Œæ¯”å¦‚IntStreamä»£è¡¨æ•´å½¢æ•°å­—æµï¼‰ã€‚æ¯ä¸ªæµä»£è¡¨ä¸€ä¸ªå€¼åºåˆ—ï¼Œæµæä¾›ä¸€ç³»åˆ—å¸¸ç”¨çš„èšé›†æ“ä½œï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä¾¿æ·çš„åœ¨å®ƒä¸Šé¢è¿›è¡Œå„ç§è¿ç®—ã€‚é›†åˆç±»åº“ä¹Ÿæä¾›äº†ä¾¿æ·çš„æ–¹å¼ä½¿æˆ‘ä»¬å¯ä»¥ä»¥æ“ä½œæµçš„æ–¹å¼ä½¿ç”¨é›†åˆã€æ•°ç»„ä»¥åŠå…¶å®ƒæ•°æ®ç»“æ„ã€‚æµçš„æ“ä½œå¯ä»¥è¢«ç»„åˆæˆæµæ°´çº¿ï¼ˆPipelineï¼‰ã€‚ å¼•å…¥çš„åŸå› ï¼š å£°æ˜æ€§æ–¹å¼å¤„ç†æ•°æ®é›†åˆ é€æ˜åœ°å¹¶è¡Œå¤„ç†ï¼Œæé«˜æ€§èƒ½ æµ çš„å®šä¹‰ï¼šä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„å…ƒç´ åºåˆ— ä¸¤ä¸ªé‡è¦ç‰¹ç‚¹ æµæ°´çº¿ å†…éƒ¨è¿­ä»£ æµä¸é›†åˆï¼š é›†åˆä¸æµçš„å·®å¼‚å°±åœ¨äºä»€ä¹ˆæ—¶å€™è¿›è¡Œè®¡ç®— é›†åˆæ˜¯å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼ŒåŒ…å«æ•°æ®ç»“æ„ä¸­ç›®å‰æ‰€æœ‰çš„å€¼ æµçš„å…ƒç´ åˆ™æ˜¯æŒ‰éœ€è®¡ç®—/ç”Ÿæˆ å¦ä¸€ä¸ªå…³é”®åŒºåˆ«åœ¨äºéå†æ•°æ®çš„æ–¹å¼ é›†åˆä½¿ç”¨ Collection æ¥å£ï¼Œéœ€è¦ç”¨æˆ·å»åšè¿­ä»£ï¼Œç§°ä¸ºå¤–éƒ¨è¿­ä»£ æµçš„ Streams åº“ä½¿ç”¨å†…éƒ¨è¿­ä»£ æµçš„ä½¿ç”¨ ä¸€ä¸ªæ•°æ®æºï¼ˆå¦‚é›†åˆï¼‰æ¥æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼› ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼Œå½¢æˆä¸€æ¡æµçš„æµæ°´çº¿ï¼› ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰§è¡Œæµæ°´çº¿ï¼Œå¹¶èƒ½ç”Ÿæˆç»“æœã€‚ æµçš„æµæ°´çº¿èƒŒåçš„ç†å¿µç±»ä¼¼äºæ„å»ºå™¨æ¨¡å¼ã€‚å¸¸è§çš„ä¸­é—´æ“ä½œæœ‰filter,map,limit,sorted,distinctï¼›å¸¸è§çš„ç»ˆç«¯æ“ä½œæœ‰ forEach,count,collectã€‚ æµçš„æ“ä½œç±»å‹åˆ†ä¸ºä¸¤ç§ï¼š Intermediateï¼šä¸€ä¸ªæµå¯ä»¥åé¢è·Ÿéšé›¶ä¸ªæˆ–å¤šä¸ª intermediate æ“ä½œã€‚å…¶ç›®çš„ä¸»è¦æ˜¯æ‰“å¼€æµï¼Œåšå‡ºæŸç§ç¨‹åº¦çš„æ•°æ®æ˜ å°„/è¿‡æ»¤ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„æµï¼Œäº¤ç»™ä¸‹ä¸€ä¸ªæ“ä½œä½¿ç”¨ã€‚è¿™ç±»æ“ä½œéƒ½æ˜¯æƒ°æ€§åŒ–çš„ï¼ˆlazyï¼‰ï¼Œå°±æ˜¯è¯´ï¼Œä»…ä»…è°ƒç”¨åˆ°è¿™ç±»æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰çœŸæ­£å¼€å§‹æµçš„éå†ã€‚ Terminalï¼šä¸€ä¸ªæµåªèƒ½æœ‰ä¸€ä¸ª terminal æ“ä½œï¼Œå½“è¿™ä¸ªæ“ä½œæ‰§è¡Œåï¼Œæµå°±è¢«ä½¿ç”¨â€œå…‰â€äº†ï¼Œæ— æ³•å†è¢«æ“ä½œã€‚æ‰€ä»¥è¿™å¿…å®šæ˜¯æµçš„æœ€åä¸€ä¸ªæ“ä½œã€‚Terminal æ“ä½œçš„æ‰§è¡Œï¼Œæ‰ä¼šçœŸæ­£å¼€å§‹æµçš„éå†ï¼Œå¹¶ä¸”ä¼šç”Ÿæˆä¸€ä¸ªç»“æœï¼Œæˆ–è€…ä¸€ä¸ª side effectã€‚ æµçš„ä½¿ç”¨æ„å»ºæµ ç”±å€¼åˆ›å»ºæµï¼šStream.ofã€Stream.emptyã€IntStream.range ç”±é›†åˆåˆ›å»ºæµï¼šCollection.streamã€Collection.parallelStream ç”±æ•°ç»„åˆ›å»ºæµï¼šArrays.stream(æ•°ç»„å˜é‡) ç”±æ–‡ä»¶ç”Ÿæˆæµï¼šFiles.linesã€Files.walk ç”±BufferedReaderåˆ›å»ºæµï¼šjava.io.BufferedReader.lines ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµï¼Œ è¿­ä»£ï¼š Stream.iterateï¼ˆæ¥å—ä¸€ä¸ªç§å­å€¼ï¼Œå’Œä¸€ä¸ªUnaryOperatorï¼‰ ç”Ÿæˆï¼šStream.generateï¼ˆæ¥æ”¶ä¸€ä¸ªSupplieræ¥å£ï¼‰ ä½¿ç”¨æµIntermediateï¼ˆä¸­é—´æ“ä½œï¼‰ï¼š ç­›é€‰ è°“è¯ç­›é€‰ï¼šfilter ç­›é€‰äº’å¼‚çš„å…ƒç´ ï¼šdistinct å¿½ç•¥å¤´å‡ ä¸ªå…ƒç´ ï¼šskip æˆªçŸ­è‡³æŒ‡å®šé•¿åº¦ï¼šlimit æ’åºï¼šsorted å·ç„ï¼ˆè¾“å‡ºï¼‰ï¼špeek å¹³è¡ŒåŒ–ï¼šparallel ä¸²è¡ŒåŒ–ï¼šsequential æ˜ å°„ å¯¹æµä¸­æ¯ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°ï¼šmap æµçš„æ‰å¹³åŒ–ï¼šflatMap è½¬ä¸ºåŸå§‹æµï¼šmapToIntã€mapToIntã€mapToInt ä»åŸå§‹æµè½¬ä¸ºæ™®é€šæµï¼šboxed æ•°å€¼èŒƒå›´ range:[èµ·å§‹å€¼ï¼Œç»“æŸå€¼) rangeClosed:[èµ·å§‹å€¼ï¼Œç»“æŸå€¼] Terminalï¼ˆç»ˆç»“æ“ä½œï¼‰ æŸ¥æ‰¾å’ŒåŒ¹é… æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ ï¼šanyMatch æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ ï¼šallMatch/noneMatch æŸ¥æ‰¾å…ƒç´ ï¼šfindAny æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼šfindFirst å½’çº¦ï¼ˆæŠ˜å ï¼‰ï¼šreduce(åˆå€¼ï¼Œç»“åˆæ“ä½œ) å…ƒç´ æ±‚å’Œï¼šcountã€sum æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šminã€ max éå† forEachã€ forEachOrdered anyMatch,allMatch,noneMatch éƒ½ç”¨åˆ°äº†çŸ­è·¯ï¼›distinct,sortedæ˜¯æœ‰çŠ¶æ€ä¸”æ— ç•Œçš„ï¼Œskip,limit,reduceæ˜¯æœ‰çŠ¶æ€ä¸”æœ‰ç•Œçš„ã€‚åŸå§‹ç±»å‹æµç‰¹åŒ–ï¼šIntStream,DoubleStream,LongStreamï¼Œé¿å…æš—å«çš„è£…ç®±æˆæœ¬ã€‚ æ˜ å°„åˆ°æ•°å€¼æµï¼šmapToInt,mapToDouble,mapToLong è½¬æ¢å›æµå¯¹è±¡ï¼šboxed é»˜è®¤å€¼ï¼šOptionalInt,OptionalDouble,OptionalLong ç”¨æµæ”¶é›†æ•°æ®å¯¹æµè°ƒç”¨ collect æ–¹æ³•å°†å¯¹æµä¸­çš„å…ƒç´ è§¦å‘å½’çº¦æ“ä½œï¼ˆç”± Collector æ¥å‚æ•°åŒ–ï¼‰ã€‚ Collectors å®ç”¨ç±»æä¾›äº†è®¸å¤šé™æ€å·¥å‚æ–¹æ³•ï¼Œç”¨æ¥åˆ›å»ºå¸¸è§æ”¶é›†å™¨çš„å®ä¾‹ï¼Œä¸»è¦æä¾›ä¸‰å¤§åŠŸèƒ½ï¼š å°†æµå…ƒç´ å½’çº¦å’Œæ±‡æ€»ä¸ºä¸€ä¸ªå€¼ å…ƒç´ åˆ†ç»„ å…ƒç´ åˆ†åŒº å½’çº¦å’Œæ±‡æ€»(Collectors ç±»ä¸­çš„å·¥å‚æ–¹æ³•)ï¼š ç»Ÿè®¡ä¸ªæ•°ï¼šCollectors.counting æŸ¥æ‰¾æµä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šCollectors.maxBy,Collectors.minBy æ±‡æ€»ï¼šCollectors.summingInt,Collectors.averagingInt,summarizingInt/IntSummaryStatisticsã€‚è¿˜æœ‰å¯¹åº”çš„ long å’Œ double ç±»å‹çš„å‡½æ•° è¿æ¥å­—ç¬¦ä¸²ï¼šjoining å¹¿ä¹‰çš„å½’çº¦æ±‡æ€»ï¼šCollectors.reducing(èµ·å§‹å€¼ï¼Œæ˜ å°„æ–¹æ³•ï¼ŒäºŒå…ƒç»“åˆ)/Collectors.reducing(äºŒå…ƒç»“åˆ)ã€‚Collectors.reducing å·¥å‚æ–¹æ³•æ˜¯æ‰€æœ‰ä¸Šè¿°ç‰¹æ®Šæƒ…å†µçš„ä¸€èˆ¬åŒ–ã€‚ collect vs. reduceï¼Œä¸¤è€…éƒ½æ˜¯ Stream æ¥å£çš„æ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äºï¼š è¯­æ„é—®é¢˜ reduce æ–¹æ³•æ—¨åœ¨æŠŠä¸¤ä¸ªå€¼ç»“åˆèµ·æ¥ç”Ÿæˆä¸€ä¸ªæ–°å€¼ï¼Œæ˜¯ä¸å¯å˜çš„å½’çº¦ï¼› collect æ–¹æ³•è®¾è®¡å°±æ˜¯è¦æ”¹å˜å®¹å™¨ï¼Œä»è€Œç´¯ç§¯è¦è¾“å‡ºçš„ç»“æœ å®é™…é—®é¢˜ ä»¥é”™è¯¯çš„è¯­ä¹‰ä½¿ç”¨ reduce ä¼šå¯¼è‡´å½’çº¦è¿‡ç¨‹ä¸èƒ½å¹¶è¡Œå·¥ä½œ åˆ†ç»„å’Œåˆ†åŒº åˆ†ç»„ï¼šCollectors.groupingBy å¤šçº§åˆ†ç»„ æŒ‰å­æ•°ç»„æ”¶é›†æ•°æ®: maxBy æŠŠæ”¶é›†å™¨çš„ç»“æœè½¬æ¢ä¸ºå¦ä¸€ç§ç»“æœ collectingAndThen ä¸ groupingBy è”åˆä½¿ç”¨çš„å…¶ä»–æ”¶é›†å™¨ä¾‹å­ï¼šsummingInt,mapping åˆ†åŒºï¼šCollectors.partitioningByæ˜¯åˆ†ç»„çš„ç‰¹æ®Šæƒ…å†µï¼Œç”±ä¸€ä¸ªè°“è¯ä½œä¸ºåˆ†ç±»å‡½æ•°(åˆ†åŒºå‡½æ•°)ï¼Œè¿”å›ä¸€ä¸ªMapï¼Œåªæœ‰ä¸¤ä¸ªBooleanç±»å‹çš„keyã€‚ Ex1:ä½¿ç”¨collect()ç”ŸæˆCollectionå‰é¢å·²ç»æåˆ°é€šè¿‡collect()æ–¹æ³•å°†Streamè½¬æ¢æˆå®¹å™¨çš„æ–¹æ³•ï¼Œè¿™é‡Œå†æ±‡æ€»ä¸€ä¸‹ã€‚å°†Streamè½¬æ¢æˆListæˆ–Setæ˜¯æ¯”è¾ƒå¸¸è§çš„æ“ä½œï¼Œæ‰€ä»¥Collectorså·¥å…·å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹åº”çš„æ”¶é›†å™¨ï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç å³å¯å®Œæˆï¼š 123456// å°†Streamè½¬æ¢æˆListæˆ–SetStream&lt;String&gt; stream = Stream.of(&quot;I&quot;, &quot;love&quot;, &quot;you&quot;, &quot;too&quot;);List&lt;String&gt; list = stream.collect(Collectors.toList()); // (1)Set&lt;String&gt; set = stream.collect(Collectors.toSet()); // (2)ä¸Šè¿°ä»£ç èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œä½†ç”±äºè¿”å›ç»“æœæ˜¯æ¥å£ç±»å‹ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ç±»åº“å®é™…é€‰æ‹©çš„å®¹å™¨ç±»å‹æ˜¯ä»€ä¹ˆï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½ä¼šæƒ³è¦äººä¸ºæŒ‡å®šå®¹å™¨çš„å®é™…ç±»å‹ï¼Œè¿™ä¸ªéœ€æ±‚å¯é€šè¿‡Collectors.toCollection(Supplier&lt;C&gt; collectionFactory)æ–¹æ³•å®Œæˆã€‚ 123// ä½¿ç”¨toCollection()æŒ‡å®šè§„çº¦å®¹å™¨çš„ç±»å‹ArrayList&lt;String&gt; arrayList = stream.collect(Collectors.toCollection(ArrayList::new));// (3)HashSet&lt;String&gt; hashSet = stream.collect(Collectors.toCollection(HashSet::new));// (4) ä¸Šè¿°ä»£ç (3)å¤„æŒ‡å®šè§„çº¦ç»“æœæ˜¯ArrayListï¼Œè€Œ(4)å¤„æŒ‡å®šè§„çº¦ç»“æœä¸ºHashSetã€‚ä¸€åˆ‡å¦‚ä½ æ‰€æ„¿ã€‚ Ex2:ä½¿ç”¨collect()ç”ŸæˆMapå‰é¢å·²ç»è¯´è¿‡StreamèƒŒåä¾èµ–äºæŸç§æ•°æ®æºï¼Œæ•°æ®æºå¯ä»¥æ˜¯æ•°ç»„ã€å®¹å™¨ç­‰ï¼Œä½†ä¸èƒ½æ˜¯Mapã€‚åè¿‡æ¥ä»Streamç”ŸæˆMapæ˜¯å¯ä»¥çš„ï¼Œä½†æˆ‘ä»¬è¦æƒ³æ¸…æ¥šMapçš„keyå’Œvalueåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼Œæ ¹æœ¬åŸå› æ˜¯æˆ‘ä»¬è¦æƒ³æ¸…æ¥šè¦å¹²ä»€ä¹ˆã€‚é€šå¸¸åœ¨ä¸‰ç§æƒ…å†µä¸‹collect()çš„ç»“æœä¼šæ˜¯Mapï¼š ä½¿ç”¨Collectors.toMap()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šå¦‚ä½•ç”ŸæˆMapçš„keyå’Œvalueã€‚ ä½¿ç”¨Collectors.partitioningBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œå¯¹å…ƒç´ è¿›è¡ŒäºŒåˆ†åŒºæ“ä½œæ—¶ç”¨åˆ°ã€‚ ä½¿ç”¨Collectors.groupingBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œå¯¹å…ƒç´ åšgroupæ“ä½œæ—¶ç”¨åˆ°ã€‚ æƒ…å†µ1ï¼šä½¿ç”¨toMap()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€ç›´æ¥çš„ï¼Œå‰é¢ä¾‹å­ä¸­å·²æåˆ°ï¼Œè¿™æ˜¯å’ŒCollectors.toCollection()å¹¶åˆ—çš„æ–¹æ³•ã€‚å¦‚ä¸‹ä»£ç å±•ç¤ºå°†å­¦ç”Ÿåˆ—è¡¨è½¬æ¢æˆç”±&lt;å­¦ç”Ÿï¼ŒGPA&gt;ç»„æˆçš„Mapã€‚éå¸¸ç›´è§‚ï¼Œæ— éœ€å¤šè¨€ã€‚ 1234// ä½¿ç”¨toMap()ç»Ÿè®¡å­¦ç”ŸGPAMap&lt;Student, Double&gt; studentToGPA = students.stream().collect(Collectors.toMap(Functions.identity(),// å¦‚ä½•ç”Ÿæˆkey student -&gt; computeGPA(student)));// å¦‚ä½•ç”Ÿæˆvalue æƒ…å†µ2ï¼šä½¿ç”¨partitioningBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™ç§æƒ…å†µé€‚ç”¨äºå°†Streamä¸­çš„å…ƒç´ ä¾æ®æŸä¸ªäºŒå€¼é€»è¾‘ï¼ˆæ»¡è¶³æ¡ä»¶ï¼Œæˆ–ä¸æ»¡è¶³ï¼‰åˆ†æˆäº’è¡¥ç›¸äº¤çš„ä¸¤éƒ¨åˆ†ï¼Œæ¯”å¦‚ç”·å¥³æ€§åˆ«ã€æˆç»©åŠæ ¼ä¸å¦ç­‰ã€‚ä¸‹åˆ—ä»£ç å±•ç¤ºå°†å­¦ç”Ÿåˆ†æˆæˆç»©åŠæ ¼æˆ–ä¸åŠæ ¼çš„ä¸¤éƒ¨åˆ†ã€‚ 123// Partition students into passing and failingMap&lt;Boolean, List&lt;Student&gt;&gt; passingFailing = students.stream() .collect(Collectors.partitioningBy(s -&gt; s.getGrade() &gt;= PASS_THRESHOLD)); æƒ…å†µ3ï¼šä½¿ç”¨groupingBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™æ˜¯æ¯”è¾ƒçµæ´»çš„ä¸€ç§æƒ…å†µã€‚è·ŸSQLä¸­çš„group byè¯­å¥ç±»ä¼¼ï¼Œè¿™é‡Œçš„groupingBy()ä¹Ÿæ˜¯æŒ‰ç…§æŸä¸ªå±æ€§å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå±æ€§ç›¸åŒçš„å…ƒç´ ä¼šè¢«å¯¹åº”åˆ°Mapçš„åŒä¸€ä¸ªkeyä¸Šã€‚ä¸‹åˆ—ä»£ç å±•ç¤ºå°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨è¿›è¡Œåˆ†ç»„ï¼š 123// Group employees by departmentMap&lt;Department, List&lt;Employee&gt;&gt; byDept = employees.stream() .collect(Collectors.groupingBy(Employee::getDepartment)); ä»¥ä¸Šåªæ˜¯åˆ†ç»„çš„æœ€åŸºæœ¬ç”¨æ³•ï¼Œæœ‰äº›æ—¶å€™ä»…ä»…åˆ†ç»„æ˜¯ä¸å¤Ÿçš„ã€‚åœ¨SQLä¸­ä½¿ç”¨group byæ˜¯ä¸ºäº†ååŠ©å…¶ä»–æŸ¥è¯¢ï¼Œæ¯”å¦‚1. å…ˆå°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨åˆ†ç»„ï¼Œ2. ç„¶åç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨å‘˜å·¥çš„äººæ•°ã€‚Javaç±»åº“è®¾è®¡è€…ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ç§æƒ…å†µï¼Œå¢å¼ºç‰ˆçš„groupingBy()èƒ½å¤Ÿæ»¡è¶³è¿™ç§éœ€æ±‚ã€‚å¢å¼ºç‰ˆçš„groupingBy()å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ åˆ†ç»„ä¹‹åå†æ‰§è¡ŒæŸç§è¿ç®—ï¼Œæ¯”å¦‚æ±‚å’Œã€è®¡æ•°ã€å¹³å‡å€¼ã€ç±»å‹è½¬æ¢ç­‰ã€‚è¿™ç§å…ˆå°†å…ƒç´ åˆ†ç»„çš„æ”¶é›†å™¨å«åšä¸Šæ¸¸æ”¶é›†å™¨ï¼Œä¹‹åæ‰§è¡Œå…¶ä»–è¿ç®—çš„æ”¶é›†å™¨å«åšä¸‹æ¸¸æ”¶é›†å™¨(downstream Collector)ã€‚ 1234// ä½¿ç”¨ä¸‹æ¸¸æ”¶é›†å™¨ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨çš„äººæ•°Map&lt;Department, Integer&gt; totalByDept = employees.stream() .collect(Collectors.groupingBy(Employee::getDepartment, Collectors.counting()));// ä¸‹æ¸¸æ”¶é›†å™¨ ä¸Šé¢ä»£ç çš„é€»è¾‘æ˜¯ä¸æ˜¯è¶Šçœ‹è¶ŠåƒSQLï¼Ÿé«˜åº¦éç»“æ„åŒ–ã€‚è¿˜æœ‰æ›´ç‹ çš„ï¼Œä¸‹æ¸¸æ”¶é›†å™¨è¿˜å¯ä»¥åŒ…å«æ›´ä¸‹æ¸¸çš„æ”¶é›†å™¨ï¼Œè¿™ç»ä¸æ˜¯ä¸ºäº†ç‚«æŠ€è€Œå¢åŠ çš„æŠŠæˆï¼Œè€Œæ˜¯å®é™…åœºæ™¯éœ€è¦ã€‚è€ƒè™‘å°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨åˆ†ç»„çš„åœºæ™¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¾—åˆ°æ¯ä¸ªå‘˜å·¥çš„åå­—ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸ªEmployeeå¯¹è±¡ï¼Œå¯é€šè¿‡å¦‚ä¸‹æ–¹å¼åšåˆ°ï¼š 12345// æŒ‰ç…§éƒ¨é—¨å¯¹å‘˜å·¥åˆ†å¸ƒç»„ï¼Œå¹¶åªä¿ç•™å‘˜å·¥çš„åå­—Map&lt;Department, List&lt;String&gt;&gt; byDept = employees.stream() .collect(Collectors.groupingBy(Employee::getDepartment, Collectors.mapping(Employee::getName,// ä¸‹æ¸¸æ”¶é›†å™¨ Collectors.toList())));// æ›´ä¸‹æ¸¸çš„æ”¶é›†å™¨ Notice And Optimization æµä¸å¯è¢«å¤ç”¨ ä¸€èˆ¬å…ˆfilterã€limitã€skipæ“ä½œåå†è¿›è¡Œsortedã€peekã€mapç­‰æ“ä½œä»¥è¾¾åˆ°short-circuiting ç›®çš„ Streamæ“ä½œåˆ†ç±» æ–¹æ³• ä¸­é—´æ“ä½œ(Intermediate operations) æ— çŠ¶æ€(Stateless) unordered() filter() map() mapToInt() mapToLong() mapToDouble() flatMap() flatMapToInt() flatMapToLong() flatMapToDouble() peek() æœ‰çŠ¶æ€(Stateful) distinct() sorted() sorted() limit() skip() ç»“æŸæ“ä½œ(Terminal operations) éçŸ­è·¯æ“ä½œ forEach() forEachOrdered() toArray() reduce() collect() max() min() count() çŸ­è·¯æ“ä½œ(short-circuiting) anyMatch() allMatch() noneMatch() findFirst() findAny() Streamä¸Šçš„æ‰€æœ‰æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»“æŸæ“ä½œï¼Œä¸­é—´æ“ä½œåªæ˜¯ä¸€ç§æ ‡è®°ï¼Œåªæœ‰ç»“æŸæ“ä½œæ‰ä¼šè§¦å‘å®é™…è®¡ç®—ã€‚ä¸­é—´æ“ä½œåˆå¯ä»¥åˆ†ä¸ºæ— çŠ¶æ€çš„(Stateless)å’Œæœ‰çŠ¶æ€çš„(Stateful)ï¼Œæ— çŠ¶æ€ä¸­é—´æ“ä½œæ˜¯æŒ‡å…ƒç´ çš„å¤„ç†ä¸å—å‰é¢å…ƒç´ çš„å½±å“ï¼Œè€Œæœ‰çŠ¶æ€çš„ä¸­é—´æ“ä½œå¿…é¡»ç­‰åˆ°æ‰€æœ‰å…ƒç´ å¤„ç†ä¹‹åæ‰çŸ¥é“æœ€ç»ˆç»“æœï¼Œæ¯”å¦‚æ’åºæ˜¯æœ‰çŠ¶æ€æ“ä½œï¼Œåœ¨è¯»å–æ‰€æœ‰å…ƒç´ ä¹‹å‰å¹¶ä¸èƒ½ç¡®å®šæ’åºç»“æœï¼›ç»“æŸæ“ä½œåˆå¯ä»¥åˆ†ä¸ºçŸ­è·¯æ“ä½œå’ŒéçŸ­è·¯æ“ä½œï¼ŒçŸ­è·¯æ“ä½œæ˜¯æŒ‡ä¸ç”¨å¤„ç†å…¨éƒ¨å…ƒç´ å°±å¯ä»¥è¿”å›ç»“æœï¼Œæ¯”å¦‚æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚ä¹‹æ‰€ä»¥è¦è¿›è¡Œå¦‚æ­¤ç²¾ç»†çš„åˆ’åˆ†ï¼Œæ˜¯å› ä¸ºåº•å±‚å¯¹æ¯ä¸€ç§æƒ…å†µçš„å¤„ç†æ–¹å¼ä¸åŒã€‚ Java8 å¯¹å­—ç¬¦ä¸²è¿æ¥çš„æ”¹è¿›æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸€ç§éœ€æ±‚å°±æ˜¯å°†è‹¥å¹²ä¸ªå­—ç¬¦ä¸²ç”¨æŸä¸ªé“¾æ¥ç¬¦è¡”æ¥èµ·æ¥ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ª Listï¼Œå°†å…¶æ ¼å¼åŒ–ä¸º å…ƒç´ 1, å…ƒç´ 2, å…ƒç´ 3, â€¦ å…ƒç´ N çš„å­—ç¬¦ä¸²å½¢å¼ã€‚ ä»¥å‰æˆ‘ä»¬çš„ä¸€èˆ¬åšæ³•å°±æ˜¯ä½¿ç”¨StringBuilderï¼š 1234567891011121314151617181920212223public static String formatList(List&lt;String&gt; list, String delimiter) &#123; StringBuilder result = new StringBuilder(); for (String str : list) &#123; result.append(str).append(delimiter); &#125; // åˆ é™¤æœ«å°¾å¤šä½™çš„ delimiter result.delete(result.length() - delimiter.length(), result.length()); return result.toString();&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ StringBuilderï¼š&quot;); String format = formatList(list, &quot;,&quot;); System.out.println(format);&#125;//è¿è¡Œç»“æœä½¿ç”¨ StringBuilderï¼ša,b,c,d,e,f,g JDK1.8 æ—¶ï¼Œæ·»åŠ äº†ä¸€ä¸ªæ–°çš„ç”¨äºå­—ç¬¦ä¸²è¿æ¥çš„ç±»ï¼Œä¸“é—¨ç”¨äºè¿™ç§éœ€è¦ åˆ†éš”ç¬¦ çš„åœºåˆï¼Œå®ƒå°±æ˜¯ StringJoinerã€‚StringJoiner åœ¨æ„é€ æ—¶å¯ä»¥æŒ‡å®šä¸€ä¸ªåˆ†éš”ç¬¦ï¼ˆdelimiterï¼‰ï¼Œç„¶åæ¯è¿æ¥ä¸€ä¸ªå…ƒç´ å®ƒä¾¿ä¼šåŠ ä¸Šä¸€ä¸ª delimiterï¼Œä½¿ç”¨ StringJoiner æ”¹å†™ formatListï¼š 123456789101112131415public static String formatList(List&lt;String&gt; list, String delimiter) &#123; StringJoiner result = new StringJoiner(delimiter); for (String str : list) &#123; result.add(str); &#125; return result.toString();&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ StringJoinerï¼š&quot;); String format = formatList(list, &quot;,&quot;); System.out.println(format);&#125; æˆ–è€…ä½¿ç”¨String.join: 123public static String formatList(List&lt;String&gt; list, String delimiter) &#123; return String.join(delimiter, list);&#125; String.join æ–¹æ³•çš„ä¸è¶³ â€”â€” å®ƒä¸èƒ½æŒ‡å®šå‰ç¼€å’Œåç¼€ â€”â€” æ¯”å¦‚æˆ‘ä»¬å¦‚æœæƒ³è¦ç›´æ¥å°† List æ ¼å¼åŒ–ä¸º { å…ƒç´ 1, å…ƒç´ 2, å…ƒç´ 3, â€¦ å…ƒç´ N } å‘¢ï¼Ÿï¼ˆæ­¤æ—¶å‰ç¼€ä¸º â€œ{ â€œï¼Œåç¼€ä¸º â€œ }â€ï¼‰ 1234567891011121314151617public static String formatList( List&lt;String&gt; list, String delimiter, String prefix, String suffix) &#123; StringJoiner result = new StringJoiner(delimiter, prefix, suffix); for (String str : list) &#123; result.add(str); &#125; return result.toString();&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ StringJoinerï¼Œå¸¦å‰ç¼€å’Œåç¼€ï¼š&quot;); String format = formatList(list, &quot;, &quot;, &quot;&#123; &quot;, &quot; &#125;&quot;); System.out.println(format);&#125; äº‹å®ä¸Šï¼ŒJava8 å¯¹äºå­—ç¬¦ä¸²é›†åˆçš„è¿æ¥æ“ä½œæä¾›äº†ä¸€ä¸ªä¸“é—¨çš„æµå¼ APIï¼Œå³ Collectors.joining å‡½æ•° æ— å‚çš„ joining() æ–¹æ³•ï¼Œå³ä¸å­˜åœ¨è¿æ¥ç¬¦ï¼ˆåº•å±‚å®ç°ä¸º StringBuilderï¼‰ï¼› joining(CharSequence delimiter) æ–¹æ³•ï¼Œå³åˆ†éš”ç¬¦ä¸º delimiterï¼ˆåº•å±‚å®ç°ä¸º StringJoinerï¼‰ï¼› joining(CharSequence delimiter, CharSequence prefix, CharSequence suffix)æ–¹æ³•ï¼Œå³åˆ†éš”ç¬¦ä¸º delimiterï¼Œå‰ç¼€ä¸º prefixï¼Œåç¼€ä¸º suffixï¼ˆåº•å±‚å®ç°ä¸º StringJoinerï¼‰ã€‚ é‚£æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸‰ä¸ªå‚æ•°çš„ Collectors.joining æ–¹æ³•æ”¹å†™ formatListï¼š 12345678910111213public static String formatList( List&lt;String&gt; list, String delimiter, String prefix, String suffix) &#123; return list.stream().collect(Collectors.joining(delimiter, prefix, suffix));&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ Collectors.joiningï¼š&quot;); String format = formatList(list, &quot;, &quot;, &quot;&#123; &quot;, &quot; &#125;&quot;); System.out.println(format);&#125; Java8 ä¸­ Map æ¥å£çš„æ–°æ–¹æ³•å‡å¦‚ç°åœ¨æˆ‘ä»¬å­˜åœ¨è¿™æ ·çš„éœ€æ±‚ï¼šç»™å®šä¸€ä¸ª Listï¼Œç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ‰€æœ‰ä½ç½®ã€‚ æ¯”å¦‚ï¼Œç»™å®š listï¼š[â€œaâ€, â€œbâ€, â€œbâ€, â€œcâ€, â€œcâ€, â€œcâ€, â€œdâ€, â€œdâ€, â€œdâ€, â€œfâ€, â€œfâ€, â€œgâ€] ï¼Œé‚£ä¹ˆåº”è¯¥è¿”å›ï¼š123456a : [0]b : [1, 2]c : [3, 4, 5]d : [6, 7, 8]f : [9, 10]g : [11] å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬å¾ˆé€‚åˆä½¿ç”¨ Map æ¥å®Œæˆè¿™ä»¶äº‹æƒ…ï¼š 12345678910111213141516171819202122232425public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; list.size(); i++) &#123; String str = list.get(i); List&lt;Integer&gt; positions = positionsMap.get(str); if (positions == null) &#123; // å¦‚æœ positionsMap è¿˜ä¸å­˜åœ¨ str è¿™ä¸ªé”®åŠå…¶å¯¹åº”çš„ List&lt;Integer&gt; positions = new ArrayList&lt;&gt;(1); positionsMap.put(str, positions); // å°† str åŠå…¶å¯¹åº”çš„ positions æ”¾å…¥ positionsMap &#125; positions.add(i); // å°†ç´¢å¼•åŠ å…¥ str ç›¸å…³è”çš„ List&lt;Integer&gt; ä¸­ &#125; return positionsMap;&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;f&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ Java8 ä¹‹å‰çš„ APIï¼š&quot;); Map&lt;String, List&lt;Integer&gt;&gt; elementPositions = getElementPositions(list); System.out.println(elementPositions);&#125; è¿è¡Œç»“æœ 12ä½¿ç”¨ Java8 ä¹‹å‰çš„ APIï¼š&#123;a=[0], b=[1, 2], c=[3, 4, 5], d=[6, 7, 8], f=[9, 10], g=[11]&#125; computeIfAbsent1234567891011121314151617public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; list.size(); i++) &#123; positionsMap.computeIfAbsent(list.get(i), k -&gt; new ArrayList&lt;&gt;(1)).add(i); &#125; return positionsMap;&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;f&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ computeIfAbsentï¼š&quot;); Map&lt;String, List&lt;Integer&gt;&gt; elementPositions = getElementPositions(list); System.out.println(elementPositions);&#125; å½“ forEach éœ€è¦ç´¢å¼•1234567public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; list.size(); i++) &#123; positionsMap.computeIfAbsent(list.get(i), k -&gt; new ArrayList&lt;&gt;(1)).add(i); &#125; return positionsMap;&#125; ä½†æ˜¯æ–¹æ³•é‡Œé¢çš„forå¾ªç¯ä¼¼ä¹è®©è¿™ä¸ªæ–¹æ³•ä¸å¤ªä¼˜é›…äº†ï¼ŒJava8ä¸­Iterableæä¾›çš„foreachå¹¶ä¸å¸¦ç´¢å¼•çš„ï¼š æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªï¼š 1234567891011public static &lt;E&gt; void forEach( Iterable&lt;? extends E&gt; elements, BiConsumer&lt;Integer, ? super E&gt; action) &#123; Objects.requireNonNull(elements); Objects.requireNonNull(action); int index = 0; for (E element : elements) &#123; action.accept(index++, element); &#125; &#125;&#125; ç„¶åæ”¹é€ getElementPositionsæ–¹æ³•ï¼š 123456789public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); Iterables.forEach(list, (index, str) -&gt; &#123; positionsMap.computeIfAbsent(str, k -&gt; new ArrayList&lt;&gt;(1)).add(index); &#125;); return positionsMap;&#125; å‚è€ƒ Java8 Noob Tutorial","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨","slug":"åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨","date":"2018-04-12T07:29:59.000Z","updated":"2018-04-12T07:53:55.820Z","comments":true,"path":"2018/04/12/åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨/","link":"","permalink":"https://hsb786.github.io/2018/04/12/åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨/","excerpt":"è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹äººæ˜¯æŒ‰ç…§é€’å¢æ’åºçš„ã€‚","text":"è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹äººæ˜¯æŒ‰ç…§é€’å¢æ’åºçš„ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public static ListNode merge(ListNode list1, ListNode list2) &#123; if (list1 == null) &#123; return list2; &#125; if (list2 == null) &#123; return list1; &#125; if (list1.data &lt; list2.data) &#123; list1.next = merge(list1.next, list2); return list1; &#125; else &#123; list2.next = merge(list1, list2.next); return list2; &#125;&#125;public static ListNode mergeSortedList(ListNode list1, ListNode list2) &#123; if (list1 == null) &#123; return list2; &#125; if (list2 == null) &#123; return list1; &#125; ListNode mergeHead = null; ListNode current = null; if (list1.data &lt;= list2.data) &#123; mergeHead = current = list1; list1 = list1.next; &#125; else &#123; mergeHead = current = list2; list2 = list2.next; &#125; while (list1 != null &amp;&amp; list2 != null) &#123; if (list1.data &lt;= list2.data) &#123; current.next = list1; current = current.next; list1 = list1.next; &#125; else &#123; current.next = list2; current = current.next; list2 = list2.next; &#125; &#125; if (list1 == null) &#123; current.next = list2; &#125; else &#123; current.next = list1; &#125; return mergeHead;&#125;","categories":[],"tags":[{"name":"å‰‘æŒ‡Offer","slug":"å‰‘æŒ‡Offer","permalink":"https://hsb786.github.io/tags/å‰‘æŒ‡Offer/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/tags/ç®—æ³•/"}]},{"title":"MyBatis","slug":"MyBatis","date":"2018-04-12T05:39:35.000Z","updated":"2018-04-14T05:13:08.342Z","comments":true,"path":"2018/04/12/MyBatis/","link":"","permalink":"https://hsb786.github.io/2018/04/12/MyBatis/","excerpt":"MyBatisç®€ä»‹ MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚ Mybatisä¸Hibernateéƒ½æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œè¿™ç±»æ¡†æ¶çš„ä½œç”¨å°±æ˜¯å°†æ•°æ®åº“ä¸­çš„è¡¨å’ŒPOJOæ˜ å°„èµ·æ¥ï¼Œå®ƒä»¬çš„æœ¬è´¨å°±æ˜¯Javaå¯¹æ•°æ®åº“çš„æ“ä½œçš„æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†è¿™ç§æ¡†æ¶ç§°ä¸ºå¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶(ORM,Object Relational Mapping)ã€‚å®ƒä»¬çš„åŒºåˆ«ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒHibernateåŸºæœ¬ä¸éœ€è¦ç¼–å†™SQLï¼Œå®ƒå¯ä»¥æ ¹æ®æ˜ å°„è§„åˆ™è‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼Œæ˜¯ä¸€ç§å…¨è¡¨æ˜ å°„ã€‚è€ŒMyBatisä¸å±è”½SQLï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šåˆ¶SQLï¼Œè¿™æ ·å°±æä¾›ç»™äº†æˆ‘ä»¬è¶³å¤Ÿçš„çµæ´»æ€§ä¸ä¼˜åŒ–çš„å¯èƒ½ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒMyBatisç›¸å¯¹äºHibernateæ¥è¯´å…·æœ‰æ€§èƒ½é«˜ï¼Œå“åº”å¿«ï¼Œå¼€å‘çµæ´»çš„ç‰¹ç‚¹ã€‚","text":"MyBatisç®€ä»‹ MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚ Mybatisä¸Hibernateéƒ½æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œè¿™ç±»æ¡†æ¶çš„ä½œç”¨å°±æ˜¯å°†æ•°æ®åº“ä¸­çš„è¡¨å’ŒPOJOæ˜ å°„èµ·æ¥ï¼Œå®ƒä»¬çš„æœ¬è´¨å°±æ˜¯Javaå¯¹æ•°æ®åº“çš„æ“ä½œçš„æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†è¿™ç§æ¡†æ¶ç§°ä¸ºå¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶(ORM,Object Relational Mapping)ã€‚å®ƒä»¬çš„åŒºåˆ«ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒHibernateåŸºæœ¬ä¸éœ€è¦ç¼–å†™SQLï¼Œå®ƒå¯ä»¥æ ¹æ®æ˜ å°„è§„åˆ™è‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼Œæ˜¯ä¸€ç§å…¨è¡¨æ˜ å°„ã€‚è€ŒMyBatisä¸å±è”½SQLï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šåˆ¶SQLï¼Œè¿™æ ·å°±æä¾›ç»™äº†æˆ‘ä»¬è¶³å¤Ÿçš„çµæ´»æ€§ä¸ä¼˜åŒ–çš„å¯èƒ½ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒMyBatisç›¸å¯¹äºHibernateæ¥è¯´å…·æœ‰æ€§èƒ½é«˜ï¼Œå“åº”å¿«ï¼Œå¼€å‘çµæ´»çš„ç‰¹ç‚¹ã€‚ MyBatisç»„ä»¶MyBatisçš„æ ¸å¿ƒç»„ä»¶åˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼š SqlSessionFactoryBuilder(æ„é€ å™¨)ï¼šå®ƒä¼šæ ¹æ®mybatisçš„é…ç½®æ–‡ä»¶(Configurationé…ç½®ç±»)æ¥ç”ŸæˆSqlSessionFactoryï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯åˆ†æ­¥æ„å»ºçš„Builderæ¨¡å¼ SqlSessionFactory(å·¥å‚)ï¼šç”¨äºç”ŸæˆSqlSessionï¼Œå¯ä»¥è¢«è®¤ä¸ºæ˜¯æ•°æ®åº“è¿æ¥æ±  SqlSession(ä¼šè¯)ï¼šæ—¢å¯ä»¥ç›´æ¥å‘é€SQLæ‰§è¡Œå¹¶è¿”å›ç»“æœï¼Œä¹Ÿå¯ä»¥è·å–æ˜ å°„å™¨Mapperæ¥å£(åŠ¨æ€ä»£ç†çš„ç±»)æ‰§è¡ŒSQLå¾—åˆ°è¿”å›ç»“æœï¼Œç›¸å½“äºæ•°æ®åº“è¿æ¥(Connectionå¯¹è±¡) Mapper(æ˜ å°„å™¨)ï¼šç”±ä¸€ä¸ªJavaæ¥å£å’ŒXMLæ–‡ä»¶æ„æˆï¼šæ¥å£ç”¨äºç»™å‡ºæ–¹æ³•çš„å…¥å‚ä»¥åŠè¿”å›å€¼ï¼ŒXMLç»™å‡ºSQLè¯­å¥å’Œæ˜ å°„è§„åˆ™ã€‚æ˜ å°„å™¨çš„ä¸»è¦ä½œç”¨å°±æ˜¯å°†SQLæŸ¥è¯¢åˆ°çš„ç»“æœæ˜ å°„ä¸ºä¸€ä¸ªPOJOï¼Œæˆ–è€…å°†POJOçš„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“ä¸­ æ³¨æ„ï¼Œæ— è®ºæ˜¯æ˜ å°„å™¨è¿˜æ˜¯SqlSessionéƒ½å¯ä»¥å‘é€SQLåˆ°æ•°æ®åº“æ‰§è¡Œï¼Œä½†æ˜¯ä¸ºäº†ä¿è¯ä»£ç çš„å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ï¼Œæ¨èä½¿ç”¨Mapperæ¥å£ç¼–ç¨‹æ¥å®Œæˆè¯¥æ“ä½œã€‚ ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸSqlSessionFactoryBuilderè¿™ä¸ªç±»å¯ä»¥è¢«å®ä¾‹åŒ–ã€ä½¿ç”¨å’Œä¸¢å¼ƒï¼Œä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚å› æ­¤ SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯å±€éƒ¨æ–¹æ³•å˜é‡ï¼‰ã€‚ä½ å¯ä»¥é‡ç”¨ SqlSessionFactoryBuilder æ¥åˆ›å»ºå¤šä¸ª SqlSessionFactory å®ä¾‹ï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯ä¸è¦è®©å…¶ä¸€ç›´å­˜åœ¨ä»¥ä¿è¯æ‰€æœ‰çš„ XML è§£æèµ„æºå¼€æ”¾ç»™æ›´é‡è¦çš„äº‹æƒ…ã€‚ SqlSessionFactorySqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±å¯¹å®ƒè¿›è¡Œæ¸…é™¤æˆ–é‡å»ºã€‚ä½¿ç”¨ SqlSessionFactory çš„æœ€ä½³å®è·µæ˜¯åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸è¦é‡å¤åˆ›å»ºå¤šæ¬¡ï¼Œå¤šæ¬¡é‡å»º SqlSessionFactory è¢«è§†ä¸ºä¸€ç§ä»£ç â€œåå‘³é“ï¼ˆbad smellï¼‰â€ã€‚å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚ SqlSessionæ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚ç»å¯¹ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä¸€ä¸ªç±»çš„é™æ€åŸŸï¼Œç”šè‡³ä¸€ä¸ªç±»çš„å®ä¾‹å˜é‡ä¹Ÿä¸è¡Œã€‚ä¹Ÿç»ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä»»ä½•ç±»å‹çš„ç®¡ç†ä½œç”¨åŸŸä¸­ï¼Œæ¯”å¦‚ Servlet æ¶æ„ä¸­çš„ HttpSessionã€‚å¦‚æœä½ ç°åœ¨æ­£åœ¨ä½¿ç”¨ä¸€ç§ Web æ¡†æ¶ï¼Œè¦è€ƒè™‘ SqlSession æ”¾åœ¨ä¸€ä¸ªå’Œ HTTP è¯·æ±‚å¯¹è±¡ç›¸ä¼¼çš„ä½œç”¨åŸŸä¸­ã€‚æ¢å¥è¯è¯´ï¼Œæ¯æ¬¡æ”¶åˆ°çš„ HTTP è¯·æ±‚ï¼Œå°±å¯ä»¥æ‰“å¼€ä¸€ä¸ª SqlSessionï¼Œè¿”å›ä¸€ä¸ªå“åº”ï¼Œå°±å…³é—­å®ƒã€‚è¿™ä¸ªå…³é—­æ“ä½œæ˜¯å¾ˆé‡è¦çš„ï¼Œä½ åº”è¯¥æŠŠè¿™ä¸ªå…³é—­æ“ä½œæ”¾åˆ° finally å—ä¸­ä»¥ç¡®ä¿æ¯æ¬¡éƒ½èƒ½æ‰§è¡Œå…³é—­ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°±æ˜¯ä¸€ä¸ªç¡®ä¿ SqlSession å…³é—­çš„æ ‡å‡†æ¨¡å¼ï¼š 123456SqlSession session = sqlSessionFactory.openSession();try &#123; // do work&#125; finally &#123; session.close();&#125; æ˜ å°„å™¨å®ä¾‹ï¼ˆMapper Instancesï¼‰æ˜ å°„å™¨æ˜¯ä¸€ä¸ªä½ åˆ›å»ºæ¥ç»‘å®šä½ æ˜ å°„çš„è¯­å¥çš„æ¥å£ã€‚æ˜ å°„å™¨æ¥å£çš„å®ä¾‹æ˜¯ä» SqlSession ä¸­è·å¾—çš„ã€‚å› æ­¤ä»æŠ€æœ¯å±‚é¢è®²ï¼Œä»»ä½•æ˜ å°„å™¨å®ä¾‹çš„æœ€å¤§ä½œç”¨åŸŸæ˜¯å’Œè¯·æ±‚å®ƒä»¬çš„ SqlSession ç›¸åŒçš„ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæ˜ å°„å™¨å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜ å°„å™¨å®ä¾‹åº”è¯¥åœ¨è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•ä¸­è¢«è¯·æ±‚ï¼Œç”¨è¿‡ä¹‹åå³å¯åºŸå¼ƒã€‚å¹¶ä¸éœ€è¦æ˜¾å¼åœ°å…³é—­æ˜ å°„å™¨å®ä¾‹ï¼Œå°½ç®¡åœ¨æ•´ä¸ªè¯·æ±‚ä½œç”¨åŸŸï¼ˆrequest scopeï¼‰ä¿æŒæ˜ å°„å™¨å®ä¾‹ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¾ˆå¿«ä½ ä¼šå‘ç°ï¼Œåƒ SqlSession ä¸€æ ·ï¼Œåœ¨è¿™ä¸ªä½œç”¨åŸŸä¸Šç®¡ç†å¤ªå¤šçš„èµ„æºçš„è¯ä¼šéš¾äºæ§åˆ¶ã€‚æ‰€ä»¥è¦ä¿æŒç®€å•ï¼Œæœ€å¥½æŠŠæ˜ å°„å™¨æ”¾åœ¨æ–¹æ³•ä½œç”¨åŸŸï¼ˆmethod scopeï¼‰å†…ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°±å±•ç¤ºäº†è¿™ä¸ªå®è·µï¼š1234567SqlSession session = sqlSessionFactory.openSession();try &#123; BlogMapper mapper = session.getMapper(BlogMapper.class); // do work&#125; finally &#123; session.close();&#125; å¦‚ä½•ä½¿ç”¨MyBatisé¦–å…ˆï¼Œåœ¨MyBatisä¸­æœ‰ä¸¤ç§XMLé…ç½®æ–‡ä»¶ï¼Œä¸€ç§æ˜¯åŸºç¡€é…ç½®æ–‡ä»¶ï¼Œå®ƒåªæœ‰ä¸€ä¸ªï¼Œç”¨äºé…ç½®ä¸€äº›MyBatisçš„ä¸Šä¸‹æ–‡å‚æ•°å’Œè¿è¡Œç¯å¢ƒï¼›å¦ä¸€ç§æ˜¯æ˜ å°„å™¨çš„XMLæ˜ å°„æ–‡ä»¶ï¼Œå®ƒå¯ä»¥é…ç½®æ˜ å°„å…³ç³»ï¼ŒSQLç­‰ç­‰ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨ä½¿ç”¨MyBatisçš„æ—¶å€™ï¼Œå…ˆç»™å‡ºMyBatisçš„é…ç½®æ–‡ä»¶ç”¨äºç”ŸæˆSqlSessionï¼Œç„¶åå†ç»™å‡ºæ˜ å°„å™¨Mapperçš„æ¥å£ä¸ç›¸åº”çš„æ˜ å°„XMLæ–‡ä»¶ï¼Œæœ€åå°±å¯ä»¥ç”ŸæˆMapperæ¥å£çš„åŠ¨æ€ä»£ç†ç±»æ¥å‘é€SQLè·å–ç»“æœäº†ã€‚ æ˜ å°„å™¨æ˜ å°„å™¨æ˜¯mybatisæœ€æ ¸å¿ƒçš„ç»„ä»¶ï¼Œå®ƒç”±ä¸€ä¸ªæ¥å£åŠ ä¸Šxmlæ–‡ä»¶ç»„æˆã€‚åœ¨æ˜ å°„å™¨ä¸­å¯ä»¥é…ç½®å‚æ•°ï¼Œå„ç±»çš„SQLè¯­å¥ï¼Œç¼“å­˜ï¼Œçº§è”ç­‰å†…å®¹ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡æ˜ å°„è§„åˆ™æ˜ å°„åˆ°æŒ‡å®šçš„POJOä¸Šã€‚æ˜ å°„å™¨çš„æ¥å£ä¸æ˜ å°„xmlæ–‡ä»¶é…ç½®ä½¿ç”¨ï¼Œå¯ä»¥æœ‰æ•ˆçš„æ¶ˆé™¤jdbcåº•å±‚ä»£ç ã€‚ æ˜ å°„å™¨çš„æ˜ å°„xmlæ–‡ä»¶æœ‰ä»¥ä¸‹å‡ ä¸ªå…ƒç´ ï¼š cache â€“ ç»™å®šå‘½åç©ºé—´çš„ç¼“å­˜é…ç½® cache-ref â€“ å…¶ä»–å‘½åç©ºé—´ç¼“å­˜é…ç½®çš„å¼•ç”¨ resultMap â€“ æè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­æ¥åŠ è½½å¯¹è±¡ï¼Œå®ƒå°†æä¾›æ˜ å°„è§„åˆ™ sql â€“ å¯è¢«å…¶ä»–è¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯­å¥å—ï¼Œå¯ä»¥å®šä¹‰ä¸€éƒ¨åˆ†SQLï¼Œç„¶ååœ¨å…¶ä»–åœ°æ–¹å¼•ç”¨ insert â€“ æ˜ å°„æ’å…¥è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ’å…¥çš„æ¡æ•° update â€“ æ˜ å°„æ›´æ–°è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ›´æ–°çš„æ¡æ•° delete â€“ æ˜ å°„åˆ é™¤è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨åˆ é™¤çš„æ¡æ•° select â€“ æ˜ å°„æŸ¥è¯¢è¯­å¥ï¼Œè¿”å›æŸ¥è¯¢ç»“æœ selectå…ƒç´ æ˜ å°„å™¨ä¸­çš„selectå…ƒç´ ä»£è¡¨SQLçš„selectè¯­å¥ï¼Œç”¨äºæŸ¥è¯¢ã€‚selectå…ƒç´ ä¸­æœ‰ä»¥ä¸‹å¸¸ç”¨çš„å±æ€§ï¼š id:åœ¨Mapperçš„å‘½åç©ºé—´ä¸­å”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚Mapperçš„å‘½åç©ºé—´ä¸selectå…ƒç´ çš„idå°†å”¯ä¸€å®šä½å¯¹åº”çš„æ˜ å°„å™¨æ¥å£çš„æŸä¸ªæ–¹æ³•ã€‚ parameterTypeï¼šå°†ä¼šä¼ å…¥è¿™æ¡è¯­å¥çš„å‚æ•°ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åï¼Œå¯ä»¥é€‰æ‹©Java Beanï¼ŒMapç­‰å‚æ•°ç±»å‹ä¼ é€’ç»™SQLã€‚è¿™ä¸ªå±æ€§æ˜¯å¯é€‰çš„ï¼Œmybatiså¯ä»¥é€šè¿‡TypeHandleræ¨æ–­å‡ºå…·ä½“ä¼ å…¥è¯­å¥çš„å‚æ•°ã€‚ resultTypeï¼šä»è¿™æ¡è¯­å¥ä¸­è¿”å›çš„æœŸæœ›ç±»å‹çš„ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åã€‚æ³¨æ„å¦‚æœæ˜¯é›†åˆæƒ…å½¢ï¼Œé‚£åº”è¯¥æ˜¯é›†åˆå¯ä»¥åŒ…å«çš„ç±»å‹ï¼Œè€Œä¸èƒ½æ˜¯é›†åˆæœ¬èº«ã€‚ resultMapï¼šæ˜ å°„é›†çš„å¼•ç”¨ï¼Œç”¨äºç»“æœé›†çš„æ˜ å°„ï¼Œå®Œæˆç»“æœçš„æ˜ å°„åŠŸèƒ½ã€‚æ³¨æ„resultTypeå’ŒresultMapä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ flushCacheï¼šå°†å…¶è®¾ç½®ä¸ºtrueï¼Œä»»ä½•æ—¶å€™åªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºï¼Œé»˜è®¤å€¼ï¼šfalseã€‚ useCacheï¼šå°†å…¶è®¾ç½®ä¸ºtrueï¼Œå°†ä¼šå¯¼è‡´æœ¬æ¡è¯­å¥çš„ç»“æœè¢«äºŒçº§ç¼“å­˜ï¼Œé»˜è®¤å€¼ï¼šå¯¹selectå…ƒç´ ä¸ºtrueã€‚ 123&lt;select id=&quot;getPerson&quot; parameterType=&quot;int&quot; resultType=&quot;mybatis.spring.test.pojo.Person&quot;&gt; SELECT name,age,tel,id from t_person WHERE id = #&#123;id&#125;&lt;/select&gt; 1public Person getPerson(@Param(&quot;id&quot;) int id); mybatisæä¾›çš„è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼Œåªè¦SQLçš„åˆ—åä¸POJOçš„å±æ€§åä¿æŒä¸€è‡´ï¼ŒåŒæ—¶åœ¨mybatisçš„é…ç½®æ–‡ä»¶ä¸­settingså…ƒç´ çš„autoMappingBehavioræ˜¯å¼€å¯çš„(é»˜è®¤æ˜¯å¼€å¯)å³å¯å®Œæˆè‡ªåŠ¨æ˜ å°„ã€‚å¦‚æœåˆ—åä¸å±æ€§åä¸ä¸€è‡´çš„è¯ï¼Œè¿˜å¯ä»¥é€šè¿‡SQLçš„åˆ«åæœºåˆ¶æ¥å¤„ç†ã€‚æ¯”å¦‚è¯´ï¼Œå‡å¦‚åŸæ¥åˆ—åä¸ºperson_nameï¼Œå±æ€§åä¸ºpersonNameï¼Œé‚£ä¹ˆåœ¨SQLä¸­å°±å¯ä»¥è¿™ä¹ˆå†™ï¼šselect person_name as personName â€¦ è¿™æ ·åŒæ ·å¯ä»¥å®Œæˆè‡ªåŠ¨æ˜ å°„ã€‚ è¿™é‡Œç‰¹åˆ«è¯´æ˜å…³äºselectå…ƒç´ è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–è€…å¯¹è±¡é›†åˆçš„é—®é¢˜ï¼š è¿”å›æ•°æ®ç±»å‹ç”±DAOä¸­çš„æ¥å£å’Œæ˜ å°„xmlæ–‡ä»¶å…±åŒå†³å®šã€‚å¦å¤–ï¼Œä¸è®ºæ˜¯è¿”å›å•ä¸€å¯¹è±¡è¿˜æ˜¯å¯¹è±¡åˆ—è¡¨ï¼Œæ˜ å°„xmlä¸­çš„é…ç½®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯resultType=â€œ . .â€ç±»å‹æˆ–resultMap=â€resultMap-refâ€*ã€‚ æ¯ä¸€æ¬¡mybatisä»æ•°æ®åº“ä¸­selectæ•°æ®ä¹‹åï¼Œéƒ½ä¼šæ£€æŸ¥æ•°æ®æ¡æ•°å’ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯å¦åŒ¹é…ã€‚ è‹¥è¿”å›ä¸€æ¡æ•°æ®ï¼ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å¯¹è±¡çš„Liståˆ—è¡¨ï¼Œåˆ™å¯ä»¥æ­£å¸¸åŒ¹é…ï¼Œå°†æŸ¥è¯¢çš„æ•°æ®æŒ‰ç…§DAOä¸­å®šä¹‰çš„è¿”å›å€¼å­˜æ”¾ã€‚ è‹¥è¿”å›å¤šæ¡æ•°æ®ï¼ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™æ— æ³•å°†å¤šæ¡æ•°æ®æ˜ å°„ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶mybatisæŠ¥é”™ã€‚ resultMapå…ƒç´ é€šè¿‡resultTypeåŠ ä¸Šmybatisçš„è‡ªåŠ¨æ˜ å°„å¯ä»¥åº”å¯¹å¤§å¤šæ•°çš„ç»“æœé›†çš„æ˜ å°„éœ€æ±‚ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æ— æ³•å®šä¹‰æ›´å¤šçš„å±æ€§ï¼Œæ¯”å¦‚typeHandlerï¼Œçº§è”ç­‰ã€‚ä¸ºäº†æ”¯æŒæ›´åŠ å¤æ‚çš„æ˜ å°„ï¼Œmybatisæä¾›äº†resultMapå±æ€§æ¥å®ŒæˆSQLåˆ°Java Beançš„æ˜ å°„å…³ç³»å®šä¹‰ã€‚æ¥ä¸‹æ¥ï¼Œç”¨resulyMapæ”¹å†™ä¹‹å‰ä½¿ç”¨è‡ªåŠ¨æ˜ å°„çš„selectå…ƒç´ ã€‚ 123456789&lt;resultMap id = &quot;Map&quot; type = &quot;mybatis.spring.test.pojo.Person&quot;&gt; &lt;id property=&quot;id&quot; column=&quot;id&quot;&gt; &lt;result property=&quot;name&quot; column=&quot;name&quot;&gt; &lt;result property=&quot;age&quot; column=&quot;age&quot;&gt; &lt;result property=&quot;tel&quot; column=&quot;tel&quot;&gt;&lt;/resultMap&gt; &lt;select id=&quot;getPerson&quot; parameterType=&quot;int&quot; resultMap=&quot;Map&quot;&gt; SELECT name,age,tel,id from t_person WHERE id = #&#123;id&#125; &lt;/select&gt; å­å…ƒç´ idä»£è¡¨ä¸»é”®ï¼Œresultä»£è¡¨å±æ€§ï¼Œidå’Œresultå…ƒç´ çš„propertyå±æ€§ä»£è¡¨POJOçš„å±æ€§åç§°ï¼Œcolumnä»£è¡¨SQLçš„åˆ—åï¼Œè¿™æ ·å°±å°†POJOçš„å±æ€§å’ŒSQLçš„åˆ—åè¿›è¡Œä¸€ä¸€å¯¹åº”äº†ã€‚ ä¸€ä¸ªå®Œæ•´çš„resultMapå…ƒç´ çš„æ„æˆæœ‰å“ªäº›ï¼Ÿ constructorï¼šç±»åœ¨å®ä¾‹åŒ–æ—¶,ç”¨æ¥æ³¨å…¥ç»“æœåˆ°æ„é€ æ–¹æ³•ä¸­ idï¼šè¡¨ç¤ºå“ªä¸ªåˆ—æ˜¯ä¸»é”® resultï¼šæ³¨å…¥åˆ°JavaBeanå±æ€§çš„æ™®é€šç»“æœï¼Œé…ç½®POJOåˆ°SQLåˆ—åçš„æ˜ å°„å…³ç³» associationï¼šä¸€ä¸ªå¤æ‚çš„ç±»å‹å…³è”;è®¸å¤šç»“æœå°†åŒ…æˆè¿™ç§ç±»å‹ collectionï¼šå¤æ‚ç±»å‹çš„é›† discriminatorï¼šä½¿ç”¨ç»“æœå€¼æ¥å†³å®šä½¿ç”¨å“ªä¸ªç»“æœæ˜ å°„ constructorå…ƒç´ ç”¨äºé…ç½®æ„é€ æ–¹æ³•ï¼Œä¸€ä¸ªPOJOå¯èƒ½ä¸å­˜åœ¨æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œå°±è¦ä½¿ç”¨construtorå…ƒç´ æ¥é…ç½®äº†ã€‚ idå…ƒç´ ï¼Œresultå…ƒç´ ä¸»è¦æ¥å®šä¹‰POJOä¸SQLåˆ—åçš„æ˜ å°„è§„åˆ™ï¼Œå®ƒä»¬æœ‰å¦‚ä¸‹å±æ€§ï¼š property:æ˜ å°„è§„åˆ™ä¸­çš„POJOçš„å±æ€§åï¼Œå¯ä»¥ç”¨å¯¼èˆªå¼å­—æ®µï¼Œä¾‹å¦‚éœ€è¦è®¿é—®Personç±»çš„Addresså±æ€§çš„idï¼Œå°±å¯ä»¥å†™æˆAddress . id columnï¼šå¯¹åº”çš„SQLçš„åˆ—å javaTypeï¼šJavaç±»å‹ jdbcTypeï¼šæ•°æ®åº“ç±»å‹ typeHandlerï¼šç±»å‹å¤„ç†å™¨ï¼Œå…è®¸ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨ å…¶ä¸­associationï¼Œcollectionå’Œdiscriminatorè¿™äº›å…ƒç´ æ˜¯ä¸ç»“æœæ˜ å°„çš„çº§è”ç›¸å…³çš„ã€‚Mybatisæ”¯æŒçº§è”æ˜ å°„ï¼Œç®€å•æ¥è¯´ï¼Œå‡å¦‚æˆ‘ä»¬selectä¸€ä¸ªpersonç±»ï¼Œpersonç±»æœ‰ä¸€ä¸ªå±æ€§ä¸ºaddressï¼Œaddressä¹Ÿæ˜¯ä¸€ä¸ªPOJOï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦å†è¿›è¡Œä¸€æ¬¡selectæ‰èƒ½æŸ¥è¯¢åˆ°addressç±»çš„ä¿¡æ¯ã€‚è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œçº§è”ä¸æ˜¯å¿…é¡»çš„ï¼Œçº§è”å¯ä»¥ä¾¿æ·çš„è·å–å…³è”æ•°æ®ï¼Œä½†æ˜¯å¦‚æœçº§è”å¤ªå¤šçš„è¯ä¼šå½±å“æ‰§è¡Œæ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯è‘—åçš„N+1é—®é¢˜(å¦‚æœæœ‰Nä¸ªå…³è”å…³ç³»å®Œæˆäº†çº§è”ï¼Œé‚£ä¹ˆåªè¦å†åŠ å…¥ä¸€ä¸ªå…³è”å…³ç³»ï¼Œå°±å˜æˆäº†N+1ä¸ªï¼Œæ‰€æœ‰çš„çº§è”SQLéƒ½ä¼šè¢«æ‰§è¡Œï¼Œæ˜¾ç„¶ä¸æ˜¯æ‰€æœ‰æ•°æ®æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„ï¼Œé€ æˆäº†èµ„æºçš„æµªè´¹ä¸æ€§èƒ½çš„æµªè´¹)ã€‚ä¸ºäº†åº”å¯¹çº§è”ä¸­çš„N+1é—®é¢˜ï¼Œmybatisæ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œåœ¨selectçš„æ—¶å€™å¹¶ä¸æ˜¯ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰çš„SQLç»“æœæ¥æ˜ å°„ï¼Œå¯¹äºé‚£äº›ä¸å¸¸ç”¨çš„çº§è”æ•°æ®ç­‰åˆ°éœ€è¦çš„æ—¶å€™å†å–å‡ºã€‚åœ¨mybatisçš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¯ä»¥è®¾å®šå»¶è¿ŸåŠ è½½å±æ€§ï¼ŒåŒæ—¶åœ¨çº§è”å…ƒç´ associationå’Œcollectionä¸­çš„fetchTypeå±æ€§ä¹Ÿå¯ä»¥å®šä¹‰å»¶è¿ŸåŠ è½½ã€‚ insert,update,deleteç›¸æ¯”äºselectæ¥è¯´ï¼Œinsert,update,deleteå°±å¾ˆç®€å•äº†ï¼Œå®ƒä»¬æ‰§è¡Œçš„ç»“æœè¿”å›çš„æ˜¯æ•´æ•°ï¼Œç”¨ä»¥æ ‡è¯†è¯¥SQLè¯­å¥å½±å“äº†æ•°æ®åº“çš„è®°å½•è¡Œæ•°ï¼Œä¸éœ€è¦è¿›è¡Œç»“æœé›†çš„æ˜ å°„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œinsertå…ƒç´ æ˜¯æ”¯æŒä¸»é”®å›å¡«çš„ï¼Œåœ¨inserè¯­å¥ä¸­æœ‰ä¸€ä¸ªå±æ€§useGeneratedKeysï¼Œç”¨æ¥æ§åˆ¶æ˜¯å¦ä½¿ç”¨æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®æ¥å›å¡«åˆ°POJOï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚å½“æ‰“å¼€äº†ä¸»é”®å›å¡«ä¹‹åï¼Œè¿˜è¦é…ç½®keyPropertyæˆ–è€…keyColumnï¼Œå‘Šè¯‰mybatisæŠŠç”Ÿæˆçš„ä¸»é”®æ”¾å…¥å“ªä¸ªå±æ€§ä¸­ã€‚è‡³äºåœ¨å®é™…ä¸­ç”¨ä¸ç”¨å¾—åˆ°æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®ï¼Œæˆ‘ä¹Ÿä¸èƒ½å®Œå…¨è‚¯å®šï¼Œè¿™é‡Œåªè¦çŸ¥é“mybatisæ˜¯æ”¯æŒä¸»é”®å›å¡«çš„å³å¯ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆå®¹æ˜“ã€‚ sqlå…ƒç´ è¿™ä¸ªå…ƒç´ å¯ä»¥è¢«ç”¨æ¥å®šä¹‰å¯é‡ç”¨çš„SQLä»£ç æ®µï¼Œå¯ä»¥åŒ…å«åœ¨å…¶ä»–è¯­å¥ä¸­ 12345678&lt;sql id=&quot;userColumns&quot;&gt; $&#123;alias&#125;.id,$&#123;alias&#125;.username,$&#123;alias&#125;.password &lt;/sql&gt;&lt;select id=&quot;selectUsers&quot; resultType=&quot;map&quot;&gt; select &lt;include refid=&quot;userColumns&quot;&gt;&lt;property name=&quot;alias&quot; value=&quot;t1&quot;/&gt;&lt;/include&gt;, &lt;include refid=&quot;userColumns&quot;&gt;&lt;property name=&quot;alias&quot; value=&quot;t2&quot;/&gt;&lt;/include&gt; from some_table t1 cross join some_table t2&lt;/select&gt; åŠ¨æ€SQLmybatisæä¾›äº†å¯¹SQLè¯­å¥åŠ¨æ€çš„ç»„è£…èƒ½åŠ›ï¼Œå¤§é‡çš„åˆ¤æ–­éƒ½å¯ä»¥åœ¨mybatisçš„æ˜ å°„xmlé‡Œé¢é…ç½®ï¼Œå¤§å¤§å‡å°‘äº†ä»£ç é‡ï¼Œæä¾›äº†çµæ´»æ€§ã€‚ ififå…ƒç´ ä½¿ç”¨çš„åœºæ™¯é€‚ç”¨äºåœ¨SQLè¯­å¥çš„whereå­å¥ä¸­åŠ¨æ€åœ°é€‰æ‹©æŸå‡ ä¸ªåˆ¤æ–­æ¡ä»¶ä½œä¸ºSQLè¯­å¥çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‹¼æ¥ã€‚ 12345678&lt;select id=&quot;findActiveBlogWithTitleLike&quot; resultType=&quot;Blog&quot;&gt; SELECT * FROM BLOG WHERE state = â€˜ACTIVEâ€™ &lt;if test=&quot;title != null&quot;&gt; AND title like #&#123;title&#125; &lt;/if&gt;&lt;/select&gt; å¦‚æœä¼ å…¥çš„å‚æ•°titleä¸æ˜¯nullï¼Œé‚£ä¹ˆå°±å°† AND title like #{title} è¿™å­å¥æ‹¼æ¥åœ¨whereä¹‹åï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ¡ä»¶åœ°åŒ…å«whereå­å¥çš„ä¸€éƒ¨åˆ†ã€‚ choose(when,otherwise)ifå…ƒç´ æ˜¯å•æ¡ä»¶çš„ï¼Œchooseå…ƒç´ å°±æ˜¯å¤šæ¡ä»¶çš„é€‰æ‹©ç±»ä¼¼javaé‡Œçš„switchè¯­å¥ï¼ŒåŸç†ä¸€æ ·ï¼Œè¿˜æ˜¯æ¥ç€ä¸Šé¢çš„ä¾‹å­æ¥ä¸¾ä¾‹ï¼š 123456789101112131415&lt;select id=&quot;findActiveBlogLike&quot; resultType=&quot;Blog&quot;&gt; SELECT * FROM BLOG WHERE state = â€˜ACTIVEâ€™ &lt;choose&gt; &lt;when test=&quot;title != null&quot;&gt; AND title like #&#123;title&#125; &lt;/when&gt; &lt;when test=&quot;author != null and author.name != null&quot;&gt; AND author_name like #&#123;author.name&#125; &lt;/when&gt; &lt;otherwise&gt; AND featured = 1 &lt;/otherwise&gt; &lt;/choose&gt;&lt;/select&gt; ä¸Šè¿°å‚è€ƒæ–‡æ¡£ä¸­çš„ä¾‹å­otherwiseå…ƒç´ å†™çš„æ˜¯ AND featured = 1 æ˜¯ä¸ºäº†è§£å†³å‰é¢çš„æ‰€æœ‰caseéƒ½ä¸æ»¡è¶³çš„æƒ…å†µï¼Œæˆ‘å»ºè®®å†™æˆ AND 1 = 1 æ›´å¥½ç†è§£ã€‚è¯¥åŠ¨æ€SQLè¯­å¥çš„åŠŸèƒ½ï¼šå¦‚æœå‚æ•°æä¾›äº†â€œtitleâ€å°±æŒ‰â€œtitleâ€æŸ¥æ‰¾ï¼Œæä¾›äº†â€œauthorâ€å°±æŒ‰â€œauthorâ€æŸ¥æ‰¾ï¼Œè‹¥ä¸¤è€…éƒ½æ²¡æœ‰æä¾›ï¼Œå°±è¿”å›æ‰€æœ‰ç¬¦åˆé»˜è®¤æ¡ä»¶çš„æŸ¥è¯¢ç»“æœé›†ã€‚ trim(where,set)å‰é¢çš„ä¾‹å­ä¸­çš„whereå­å¥æ€»ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æŸ¥è¯¢æ¡ä»¶ä¹Ÿå°±æ˜¯ä¾‹å­ä¸­çš„ state = â€˜ACTIVEâ€™ ï¼Œå¦‚æœstateä¹Ÿè®¾ç½®æˆåŠ¨æ€çš„å‘¢ï¼Ÿå¯ä»¥é€šè¿‡where,setå…ƒç´ æ¥è¾¾åˆ°è¿™ä¸ªéœ€æ±‚ã€‚ 123456789101112131415&lt;select id=&quot;findActiveBlogLike&quot; resultType=&quot;Blog&quot;&gt; SELECT * FROM BLOG &lt;where&gt; &lt;if test=&quot;state != null&quot;&gt; state = #&#123;state&#125; &lt;/if&gt; &lt;if test=&quot;title != null&quot;&gt; AND title like #&#123;title&#125; &lt;/if&gt; &lt;if test=&quot;author != null and author.name != null&quot;&gt; AND author_name like #&#123;author.name&#125; &lt;/if&gt; &lt;/where&gt;&lt;/select&gt; åŒæ ·å¦‚æœæ˜¯updateå­å¥ï¼Œé‚£ä¹ˆä¹Ÿå°±ç›¸åº”çš„setå…ƒç´ ï¼Œå¦‚ä¸‹ï¼š 12345678910&lt;update id=&quot;updateAuthorIfNecessary&quot;&gt; update Author &lt;set&gt; &lt;if test=&quot;username != null&quot;&gt;username=#&#123;username&#125;,&lt;/if&gt; &lt;if test=&quot;password != null&quot;&gt;password=#&#123;password&#125;,&lt;/if&gt; &lt;if test=&quot;email != null&quot;&gt;email=#&#123;email&#125;,&lt;/if&gt; &lt;if test=&quot;bio != null&quot;&gt;bio=#&#123;bio&#125;&lt;/if&gt; &lt;/set&gt; where id=#&#123;id&#125;&lt;/update&gt; å¦‚æœwhere,setéƒ½æ— æ³•æ»¡è¶³åŠ¨æ€æ‹¼æ¥SQLçš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨trimæ¥è‡ªå®šä¹‰å¦‚ä½•æ‹¼æ¥SQLå­å¥ï¼Œwhereå’Œsetåªæ˜¯mybatiså®šä¹‰å¥½çš„æ‹¼æ¥SQLçš„æ–¹æ³•è€Œå·²ï¼Œä½†è¿™ä¹Ÿå·²ç»å¯ä»¥æ»¡è¶³å¤§å¤šæ•°éœ€æ±‚äº†ã€‚ foreachåŠ¨æ€ SQL çš„å¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„å¿…è¦æ“ä½œæ˜¯éœ€è¦å¯¹ä¸€ä¸ªé›†åˆè¿›è¡Œéå†ï¼Œé€šå¸¸æ˜¯åœ¨æ„å»º IN æ¡ä»¶è¯­å¥çš„æ—¶å€™ã€‚è¿˜æ˜¯å‚è€ƒæ–‡æ¡£é‡Œä¹°çš„ä¾‹å­ï¼š 123456789&lt;select id=&quot;selectPostIn&quot; resultType=&quot;domain.blog.Post&quot;&gt; SELECT * FROM POST P WHERE ID in &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;list&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt; #&#123;item&#125; &lt;/foreach&gt;&lt;/select&gt; foreachå…ƒç´ å…è®¸æŒ‡å®šä¸€ä¸ªé›†åˆï¼Œå£°æ˜å¯ä»¥ç”¨åœ¨å…ƒç´ ä½“å†…çš„é›†åˆé¡¹å’Œç´¢å¼•å˜é‡ï¼Œä¹Ÿå…è®¸ä½ æŒ‡å®šå¼€é—­åŒ¹é…çš„å­—ç¬¦ä¸²ä»¥åŠåœ¨è¿­ä»£ä¸­é—´æ”¾ç½®åˆ†éš”ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€é›†åˆç­‰ï¼‰å’Œä»»ä½•çš„å­—å…¸æˆ–è€…æ•°ç»„å¯¹è±¡ä¼ é€’ç»™foreachä½œä¸ºé›†åˆå‚æ•°ã€‚å½“ä½¿ç”¨å¯è¿­ä»£å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œindexæ˜¯å½“å‰è¿­ä»£çš„æ¬¡æ•°ï¼Œitemçš„å€¼æ˜¯æœ¬æ¬¡è¿­ä»£è·å–çš„å…ƒç´ ã€‚å½“ä½¿ç”¨å­—å…¸ï¼ˆæˆ–è€…Map.Entryå¯¹è±¡çš„é›†åˆï¼‰æ—¶ï¼Œindexæ˜¯é”®ï¼Œitemæ˜¯å€¼ã€‚ #{}å’Œ${}#{}è¡¨ç¤ºä¸€ä¸ªå ä½ç¬¦å·ï¼Œç”¨æ¥ä¼ å…¥å‚æ•°ï¼Œsqlåœ¨è§£æçš„æ—¶å€™ä¼šåŠ ä¸Šâ€ â€œ,å½“æˆå­—ç¬¦ä¸²æ¥è§£æï¼Œå¯ä»¥é˜²æ­¢sqlæ³¨å…¥ ${}è¡¨ç¤ºä¸€ä¸ªæ‹¼æ¥ç¬¦å·, ä¼ å…¥æ•°æ®ç›´æ¥æ˜¾ç¤ºåœ¨ç”Ÿæˆçš„sqlä¸­ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´sqlæ³¨å…¥ MyBatisç¼“å­˜MyBatisæä¾›ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ å¦‚æœç¼“å­˜ä¸­æœ‰æ•°æ®å°±ä¸ç”¨ä»æ•°æ®åº“ä¸­è·å–ï¼Œå‡å°‘äº†å’Œæ•°æ®ä¹‹é—´çš„äº¤äº’æ¬¡æ•°ï¼Œå¤§å¤§æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚ ä¸€çº§ç¼“å­˜æ˜¯sqlSessionçº§åˆ«çš„ç¼“å­˜ã€‚åœ¨æ“ä½œæ•°æ®åº“æ—¶éœ€è¦æ„é€ sqlSessionå¯¹è±¡ï¼Œåœ¨å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ•°æ®ç»“æ„(HashMap)ï¼Œç”¨äºå­˜å‚¨ç¼“å­˜æ•°æ®ã€‚ä¸åŒçš„sqlSessionä¹‹é—´çš„ç¼“å­˜åŒºåŸŸ(HashMap)æ˜¯äº’ä¸å½±å“çš„ã€‚ äºŒçº§ç¼“å­˜æ˜¯mapperçº§åˆ«çš„ç¼“å­˜ï¼Œå¤šä¸ªsqlSessionå»æ“ä½œåŒä¸€ä¸ªMapperçš„sqlè¯­å¥ï¼Œå¤šä¸ªSqlSessionå¯ä»¥å…¬ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨sqlSessionçš„ã€‚ ä¸€çº§ç¼“å­˜çš„å·¥ä½œåŸç† äºŒçº§ç¼“å­˜çš„å·¥ä½œåŸç† å‚è€ƒ MyBatiså®˜æ–¹æ–‡æ¡£ MyBatiså…¥é—¨ MyBatisè¿›é˜¶ Mybatiså­¦ä¹ æ€»ç»“ï¼ˆä¹ï¼‰â€”â€”æŸ¥è¯¢ç¼“å­˜","categories":[],"tags":[{"name":"MyBatis","slug":"MyBatis","permalink":"https://hsb786.github.io/tags/MyBatis/"}]},{"title":"HashMap","slug":"HashMap","date":"2018-04-12T03:29:30.000Z","updated":"2018-04-13T12:43:52.141Z","comments":true,"path":"2018/04/12/HashMap/","link":"","permalink":"https://hsb786.github.io/2018/04/12/HashMap/","excerpt":"HashMapå†…éƒ¨å­˜å‚¨ç»“æ„ HashMapå†…éƒ¨å­˜å‚¨ä½¿ç”¨äº†ä¸€ä¸ªNodeæ•°ç»„ï¼ˆé»˜è®¤å¤§å°æ˜¯16ï¼‰ï¼Œè€ŒNodeç±»åŒ…å«ä¸€ä¸ªç±»å‹ä¸ºNodeçš„nextå˜é‡ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·çš„keyä¼šå­˜å‚¨åˆ°åŒä¸€ä¸ªé“¾è¡¨é‡Œï¼ˆå³äº§ç”Ÿäº†å†²çªï¼‰ã€‚","text":"HashMapå†…éƒ¨å­˜å‚¨ç»“æ„ HashMapå†…éƒ¨å­˜å‚¨ä½¿ç”¨äº†ä¸€ä¸ªNodeæ•°ç»„ï¼ˆé»˜è®¤å¤§å°æ˜¯16ï¼‰ï¼Œè€ŒNodeç±»åŒ…å«ä¸€ä¸ªç±»å‹ä¸ºNodeçš„nextå˜é‡ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·çš„keyä¼šå­˜å‚¨åˆ°åŒä¸€ä¸ªé“¾è¡¨é‡Œï¼ˆå³äº§ç”Ÿäº†å†²çªï¼‰ã€‚ 123456789101112131415161718192021222324252627public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable &#123; transient Node&lt;K,V&gt;[] table; transient int size; transient int modCount; static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16 static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30; static final float DEFAULT_LOAD_FACTOR = 0.75f; static final int TREEIFY_THRESHOLD = 8; static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123; final int hash; final K key; V value; Node&lt;K,V&gt; next; ..... &#125; .....&#125; tableï¼Œä¸€ä¸ªå­˜æ”¾èŠ‚ç‚¹(Node[])çš„æ•°ç»„ï¼Œæ˜¯Hashmapçš„åŸºç¡€è®¾æ–½ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å­˜æ”¾äºæ­¤ã€‚ sizeï¼ŒHashmapå­˜æ”¾çš„é”®å€¼å¯¹çš„æ•°ç›®ï¼Œå¹¶ä¸ç­‰äºtableæ•°ç»„çš„é•¿åº¦ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨é“¾è¡¨å’Œçº¢é»‘æ ‘ç»“æ„ã€‚ modCountï¼ŒHashmapçš„ä¿®æ”¹æ¬¡æ•°ï¼Œæ˜¯å®ç°fail-fastæœºåˆ¶çš„å…³é”® DEFAULT_INITIAL_CAPACITYï¼Œè¡¨ç¤ºé»˜è®¤HashMapæ•°ç»„åˆå§‹å¤§å°ä¸º16ï¼Œå¹¶ä¸”ä¸ºäº†åç»­çš„rehashæ“ä½œçš„æ–¹ä¾¿ï¼ŒHashmapçš„æ•°ç»„å¤§å°å§‹ç»ˆä¸º2çš„æ•´æ•°æ¬¡å¹‚ï¼Œå³ä½¿ä½ è¾“å…¥ä¸€ä¸ªä¸æ˜¯2çš„æ•´æ•°æ¬¡å¹‚çš„å€¼ï¼Œä¹Ÿä¼šå˜æˆæœ€å°çš„å¤§äºè¯¥å€¼çš„2çš„æ•´æ•°æ¬¡å¹‚ã€‚ MAXIMUM_CAPACITYï¼Œè¡¨ç¤ºHashmapæ•°ç»„çš„æœ€å¤§å®¹é‡ï¼Œåˆå§‹å€¼ä¸º2^30ã€‚ DEFAULT_LOAD_FACTORï¼Œè¡¨ç¤ºè´Ÿè½½å› å­ï¼Œå½“Hashmapçš„å®é™…å®¹é‡è¶…è¿‡äº†(è®¾å®šå®¹é‡ä¹˜è´Ÿè½½å› å­)ï¼Œå°±è§¦å‘rehashæ“ä½œï¼Œé»˜è®¤å€¼ä¸º0.75ã€‚ TREEIFY_THRESHOLDï¼Œjkd1.8æ–°å¢çš„ï¼Œå¦‚æœHashmapæ•°ç»„å…ƒç´ çš„é“¾è¡¨é•¿åº¦è¶…è¿‡è¿™ä¸ªå€¼ï¼Œå°±ä½¿ç”¨çº¢é»‘æ ‘ç»“æ„ä»£æ›¿é“¾è¡¨æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œé»˜è®¤å€¼ä¸º8ã€‚ æ•°ç»„å†…çš„å…ƒç´ çš„æ•°æ®ç»“æ„ç»§æ‰¿äº†Map.Entryï¼Œç”¨äºå­˜æ”¾é”®å€¼å¯¹ï¼Œå¦å¤–è¿˜åŒ…å«äº†hashå€¼å’ŒnextèŠ‚ç‚¹ï¼Œå…¶ä¸­hashå€¼å¯ç”¨äºå­˜å–èŠ‚ç‚¹æ—¶æ¥å¯»å€çš„ä½œç”¨ï¼ŒnextèŠ‚ç‚¹æ˜¯å®ç°Hashmapçš„æ•°ç»„+é“¾è¡¨(çº¢é»‘æ ‘)ç»“æ„çš„å…³é”®ã€‚ åœ¨ç»§ç»­çœ‹Hashmapçš„å†…éƒ¨æ–¹æ³•ä¹‹å‰ï¼Œåšä¸ªå¤§è‡´çš„æ€»ç»“ï¼š Hashmapæ˜¯ç”¨äºå­˜æ”¾é”®å€¼å¯¹çš„å®¹å™¨ï¼Œå†…éƒ¨å®ç°æ˜¯åŸºäºæ•°ç»„çš„ï¼Œæ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯é”®å€¼å¯¹NodeèŠ‚ç‚¹ï¼Œä¸€ä¸ªNodeèŠ‚ç‚¹ä¿å­˜äº†ä¸€ä¸ªé”®å€¼å¯¹ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜ä¿å­˜äº†nextèŠ‚ç‚¹ï¼Œå¯ä»¥å½¢æˆé“¾è¡¨ç»“æ„(åœ¨å‘ç”Ÿhashå†²çªçš„æ—¶å€™)ã€‚å¦‚æœé“¾è¡¨é•¿åº¦å¤ªé•¿ï¼Œè¶…è¿‡äº†é˜€å€¼(é»˜è®¤ä¸º8)ï¼Œé‚£ä¹ˆå°±è‡ªåŠ¨å‡çº§ä¸ºçº¢é»‘æ ‘ç»“æ„(é«˜æ•ˆçš„å¹³è¡¡æŸ¥æ‰¾æ ‘)ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ•°ç»„å…ƒç´ çš„èŠ‚ç‚¹å°±æˆä¸ºäº†çº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹äº†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨java8ä¸­å¦‚æœhashå€¼ç›¸åŒçš„keyæ•°é‡å¤§äºæŒ‡å®šå€¼ï¼ˆé»˜è®¤æ˜¯8ï¼‰æ—¶ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚ HashMapçš„è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ HashMapå†…éƒ¨çš„Nodeæ•°ç»„é»˜è®¤çš„å¤§å°æ˜¯16ï¼Œå‡è®¾æœ‰100ä¸‡ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆæœ€å¥½çš„æƒ…å†µä¸‹æ¯ä¸ªhashæ¡¶éƒ½æœ‰62500ä¸ªå…ƒç´ ï¼Œè¿™æ—¶get()ï¼Œput()ï¼Œremove()ç­‰æ–¹æ³•æ•ˆç‡éƒ½ä¼šé™ä½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHashMapæä¾›äº†è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Œå½“å…ƒç´ ä¸ªæ•°è¾¾åˆ°æ•°ç»„å¤§å°*loadFactor(åŠ è½½å› å­)åä¼šæ‰©å¤§æ•°ç»„çš„å¤§å°ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º16ï¼ŒloadFactorä¸º0.75ï¼Œä¹Ÿå°±æ˜¯è¯´å½“HashMapä¸­çš„å…ƒç´ è¶…è¿‡16*0.75=12æ—¶ï¼Œä¼šæŠŠæ•°ç»„å¤§å°æ‰©å±•ä¸º2*16=32ï¼Œå¹¶ä¸”é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ã€‚ æ²¡æ‰©å®¹å‰ï¼Œè·å–EntryEéœ€è¦éå†5ä¸ªå…ƒç´ ï¼Œæ‰©å®¹ä¹‹ååªéœ€è¦2æ¬¡ã€‚ put() å¯¹keyçš„hashCode()åšhashï¼Œç„¶åè®¡ç®—index; å¦‚æœæ²¡ç¢°æ’ç›´æ¥æ”¾åˆ°bucketé‡Œï¼› å¦‚æœç¢°æ’äº†ï¼Œä»¥é“¾è¡¨çš„å½¢å¼å­˜åœ¨bucketsåï¼› å¦‚æœç¢°æ’å¯¼è‡´é“¾è¡¨è¿‡é•¿ï¼ˆå¤§äºç­‰äºTREEIFY_THRESHOLDï¼‰ï¼Œå°±æŠŠé“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ï¼› å¦‚æœèŠ‚ç‚¹å·²ç»å­˜åœ¨å°±æ›¿æ¢old value(ä¿è¯keyçš„å”¯ä¸€æ€§)ï¼› å¦‚æœbucketæ»¡äº†(è¶…è¿‡load factor*current capacity)ï¼Œå°±è¦resizeã€‚ 123public V put(K key, V value) &#123; return putVal(hash(key), key, value, false, true);&#125; å¦‚æœput()æ–¹æ³•æ·»åŠ çš„é”®å€¼å¯¹çš„é”®å·²ç»å­˜åœ¨äºHashmapä¸­ï¼Œé‚£ä¹ˆå°±ç”¨æ–°çš„é”®å€¼çš„å€¼æ›¿ä»£æ—§å€¼ã€‚å†çœ‹æºç put()è°ƒç”¨äº†hash()æ–¹æ³•ä»¥åŠputVal()æ–¹æ³• 1234static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);&#125; å½“è¾“å…¥çš„keyä¸ºnullæ—¶ï¼Œhashå€¼ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´Hashmapçš„keyæ˜¯å¯ä»¥ä¸ºnullçš„ã€‚å¯¹æ¯”HashTableï¼ŒHashTableçš„keyç›´æ¥è¿›è¡Œäº†hashCodeï¼Œå¦‚æœkeyä¸ºnullæ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥HashTableçš„keyä¸å¯ä»¥æ˜¯nullã€‚å…·ä½“å¦‚ä½•å¾—åˆ°keyçš„hashå€¼å‘¢ï¼Ÿé¦–å…ˆè°ƒç”¨keyè‡ªèº«çš„hashcode()å¾—åˆ°ä¸€ä¸ªhashå€¼h(32ä½intç±»å‹)ï¼Œç„¶åå°†hä¸hå³ç§»16ä½ä¹‹åçš„æ•°è¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°æœ€ç»ˆçš„hashå€¼ã€‚è‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œè¿™æ˜¯å‰äººæ€»ç»“å‡ºæ¥çš„ç®—æ³•å¯ä»¥ä½¿å¾—hashå€¼åˆ†å¸ƒæ›´åŠ å‡åŒ€,å°½é‡å‡å°‘å†²çª 123456789101112131415161718192021222324252627282930313233343536373839404142final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); else &#123; Node&lt;K,V&gt; e; K k; if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123; for (int binCount = 0; ; ++binCount) &#123; if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; &#125; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; &#125; &#125; ++modCount; if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null;&#125; é€šè¿‡æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å…¥å‚éƒ½ä»£è¡¨äº†ä»€ä¹ˆï¼š hashï¼šè¡¨ç¤ºkeyçš„hashå€¼ keyï¼šå¾…å­˜å‚¨çš„keyå€¼ valueï¼šå¾…å­˜å‚¨çš„valueå€¼ onlyIfAbsentï¼šæ˜¯å¦éœ€è¦æ›¿æ¢ç›¸åŒçš„valueå€¼ã€‚å¦‚æœä¸ºtrueï¼Œè¡¨ç¤ºä¸æ›¿æ¢å·²ç»å­˜åœ¨çš„value evictï¼šå¦‚æœä¸ºfalseï¼Œè¡¨ç¤ºæ•°ç»„æ˜¯æ–°å¢æ¨¡å¼(æš‚æ—¶ä¸çŸ¥é“å•¥æ„æ€,åªåœ¨æ–¹æ³•çš„æœ€åå‡ºç°,ä½†ä¸å½±å“å…¶ä»–é€»è¾‘) é¦–å…ˆåˆ¤æ–­å½“å‰HashMapçš„æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œå°±è°ƒç”¨resize()æ–¹æ³•åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º16çš„æ•°ç»„ï¼Œå¹¶ä¸”è·å–åˆ°æ•°ç»„çš„é•¿åº¦nï¼Œä»£ç å¦‚ä¸‹ï¼š 12if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; ç„¶åï¼Œæ ¹æ®æ•°ç»„çš„é•¿åº¦n-1çš„å€¼ä¸å…¥å‚keyçš„hashå€¼æŒ‰ä½ä¸è¿ç®—ï¼Œç®—å‡ºhashå€¼å¯¹åº”äºæ•°ç»„ä¸­çš„ä½ç½®ï¼Œä»tabä¸­å°†è¿™ä¸ªä½ç½®ä¸Šé¢çš„å†…å®¹å–å‡ºï¼Œåˆ¤æ–­ä¸ºnullæ—¶ï¼Œåœ¨è¿™ä¸ªä½ç½®æ–°å¢ä¸€ä¸ªNodeã€‚ä½†æ˜¯ï¼Œå¦‚æœå–åˆ°äº†æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªhashå€¼å¯¹åº”æ•°ç»„çš„ä½ç½®ä¸Šé¢å·²ç»æœ‰äº†é”®å€¼å¯¹å­˜åœ¨ã€‚é‚£ä¹ˆï¼Œå°±åˆ¤æ–­è¿™ä¸ªNode,ä¹Ÿå°±æ˜¯pçš„hashå€¼æ˜¯å¦ä¸ä¼ å…¥çš„hashç›¸ç­‰ï¼Œç„¶åæ¥ç€åˆ¤æ–­keyæ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœåˆ¤æ–­é€šè¿‡ï¼Œè¡¨ç¤ºè¦ä¼ å…¥çš„key-valé”®å€¼å¯¹å°±æ˜¯tab[i]ä½ç½®ä¸Šé¢çš„é”®å€¼å¯¹ï¼Œç›´æ¥æ›¿æ¢å³å¯ï¼Œä¸ç”¨ç®¡åé¢æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ã€‚å¦‚æœä¸æ˜¯çš„è¯ï¼Œå°±å°†è¿™ä¸ªæ–°çš„é”®å€¼å¯¹æ’å…¥é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ç§å³å¯ã€‚æ’å…¥é”®å€¼å¯¹åˆ†ä¸¤ç§æƒ…å†µï¼šå¦‚æœæ•°ç»„å…ƒç´ æ˜¯é“¾è¡¨æ—¶ï¼Œå°±å°†èŠ‚ç‚¹æ–°å¢åˆ°åˆ—è¡¨å°¾éƒ¨ã€‚å¦‚æœé“¾è¡¨çš„é•¿åº¦å¤§äºç­‰äºçº¢é»‘æ ‘åŒ–çš„é˜€å€¼-1ï¼Œå°±å°†é“¾è¡¨è½¬æˆçº¢é»‘æ ‘ã€‚å¦‚æœæ•°ç»„å…ƒç´ æ˜¯çº¢é»‘æ ‘çš„è¯ï¼Œå°±æ’å…¥é”®å€¼åˆ°å¯¹åº”çš„Nodeã€‚ æ³¨æ„ï¼Œjava8å¼€å§‹ç”¨çš„æ˜¯å°¾æ’æ³•12345678910111213141516171819202122232425262728293031if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null);else &#123; Node&lt;K,V&gt; e; K k; if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123; for (int binCount = 0; ; ++binCount) &#123; if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; &#125; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; &#125;&#125; æœ€åï¼Œå°†ä¿®æ”¹æ¬¡æ•°åŠ ä¸€ï¼ŒåŒæ—¶åˆ¤æ–­å½“å‰çš„é”®å€¼å¯¹æ•°é‡æ˜¯å¦å³å°†è¶…è¿‡é˜€å€¼ï¼Œå¦‚æœå³å°†è¶…è¿‡ï¼Œéœ€è¦è¿›è¡Œresizeæ“ä½œã€‚12345++modCount; if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null; get() bucketé‡Œçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥å‘½ä¸­ï¼› å¦‚æœæœ‰å†²çªï¼Œåˆ™é€šè¿‡key.equals(k)å»æŸ¥æ‰¾å¯¹åº”çš„entry; è‹¥ä¸ºæ ‘ï¼Œåˆ™åœ¨æ•°ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(logn); è‹¥ä¸ºé“¾è¡¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(n)ã€‚ 1234public V get(Object key) &#123; Node&lt;K,V&gt; e; return (e = getNode(hash(key), key)) == null ? null : e.value;&#125; æ ¹æ®å…¥å‚çš„keyå¯¹è±¡è®¡ç®—å‡ºkeyçš„hashå€¼ï¼Œè°ƒç”¨getNode()æ–¹æ³•ï¼Œå†æ¥çœ‹çœ‹getNode()æ–¹æ³•ã€‚12345678910111213141516171819final Node&lt;K,V&gt; getNode(int hash, Object key) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k; if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) &#123; if (first.hash == hash &amp;&amp; // always check first node ((k = first.key) == key || (key != null &amp;&amp; key.equals(k)))) return first; if ((e = first.next) != null) &#123; if (first instanceof TreeNode) return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key); do &#123; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) return e; &#125; while ((e = e.next) != null); &#125; &#125; return null;&#125; é€šè¿‡keyçš„hashå€¼ä¸keyå¯¹è±¡ï¼Œæ¥æŸ¥æ‰¾keyå¯¹åº”çš„é”®å€¼å¯¹çš„å€¼ï¼Œå¦‚æœæŸ¥æ‰¾å¤±è´¥åˆ™è¿”å›nullã€‚å¦‚ä½•æŸ¥æ‰¾çš„å‘¢ï¼Ÿé¦–å…ˆï¼Œé€šè¿‡keyçš„hashå€¼è®¡ç®—å‡ºå¯¹åº”æ•°ç»„çš„ç´¢å¼•ï¼Œå¦‚æœç´¢å¼•åˆ°çš„ç¬¬ä¸€ä¸ªNodeèŠ‚ç‚¹çš„keyå’Œhashå€¼ä¸å…¥å‚ç›¸ç­‰ï¼Œç›´æ¥è¿”å›è¯¥Nodeã€‚å¦åˆ™ï¼Œå¾ªç¯éå†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(å¯èƒ½æ˜¯é“¾è¡¨ä¹Ÿæœ‰å¯èƒ½æ˜¯çº¢é»‘æ ‘)ã€‚ resize() åœ¨resizeçš„æ—¶å€™ï¼Œæ•°ç»„å®¹é‡è¿˜æ˜¯è¦ä¿æŒä¸º2çš„æ•´æ•°æ¬¡å¹‚ï¼Œæ‰€ä»¥æ‰©å®¹çš„æ—¶å€™å®¹é‡ä¼šç¿»å€(åŸå®¹é‡ä¹˜ä»¥2)ï¼Œé‚£ä¹ˆåœ¨resizeçš„æ—¶å€™åŸæ¥çš„å…ƒç´ åœ¨æ–°æ•°ç»„ä¸­è¦ä¸å°±ç»´æŒåŸç´¢å¼•ï¼Œè¦ä¸å°±ä»åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚ï¼Œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677final Node&lt;K,V&gt;[] resize() &#123; Node&lt;K,V&gt;[] oldTab = table; //è®°å½•åŸæ•°ç»„çš„å®¹é‡ int oldCap = (oldTab == null) ? 0 : oldTab.length; int oldThr = threshold; int newCap, newThr = 0; if (oldCap &gt; 0) &#123; //å¦‚æœè€çš„æ•°ç»„å®¹é‡å¤§äº0ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦å¤§äºç­‰äºHashMapçš„æœ€å¤§å®¹é‡ã€‚å¦‚æœtrueï¼Œå°†é˜ˆå€¼è®¾ç½®ä¸ºIntegerçš„æœ€å¤§å€¼ï¼ŒåŒæ—¶æ•°ç»„å®¹é‡ä¸å˜ if (oldCap &gt;= MAXIMUM_CAPACITY) &#123; threshold = Integer.MAX_VALUE; return oldTab; &#125; //å¯¹æ•°ç»„è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åçš„æ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ä¸¤å€ï¼›åŒæ—¶é˜ˆå€¼ä¹Ÿæ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) newThr = oldThr &lt;&lt; 1; // double threshold &#125; else if (oldThr &gt; 0) // initial capacity was placed in threshold newCap = oldThr; else &#123; // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); &#125; if (newThr == 0) &#123; float ft = (float)newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); &#125; threshold = newThr; @SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;) //å®šä¹‰ä¸€ä¸ªæ–°çš„å®¹é‡çš„æ•°ç»„ï¼ŒåŒæ—¶å®Œæˆå¯¹æ–°æ•°ç»„çš„èµ‹å€¼ Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; table = newTab; if (oldTab != null) &#123; for (int j = 0; j &lt; oldCap; ++j) &#123; Node&lt;K,V&gt; e; if ((e = oldTab[j]) != null) &#123; oldTab[j] = null; if (e.next == null) newTab[e.hash &amp; (newCap - 1)] = e; else if (e instanceof TreeNode) ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); else &#123; // preserve order Node&lt;K,V&gt; loHead = null, loTail = null; Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; do &#123; next = e.next; if ((e.hash &amp; oldCap) == 0) &#123; if (loTail == null) loHead = e; else loTail.next = e; loTail = e; &#125; else &#123; if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; &#125; &#125; while ((e = next) != null); if (loTail != null) &#123; loTail.next = null; newTab[j] = loHead; &#125; if (hiTail != null) &#123; hiTail.next = null; newTab[j + oldCap] = hiHead; &#125; &#125; &#125; &#125; &#125; return newTab;&#125; ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨putæ–¹æ³•æ·»åŠ å…ƒç´ ï¼Œè€Œä¸”å‡è®¾æ­£å¥½å­˜åœ¨ä¸¤ä¸ªputçš„keyå‘ç”Ÿäº†ç¢°æ’(æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·)ï¼Œé‚£ä¹ˆæ ¹æ®HashMapçš„å®ç°ï¼Œè¿™ä¸¤ä¸ªkeyä¼šæ·»åŠ åˆ°æ•°ç»„çš„åŒä¸€ä¸ªä½ç½®ï¼Œè¿™æ ·æœ€ç»ˆå°±ä¼šå‘ç”Ÿå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹çš„putçš„æ•°æ®è¢«è¦†ç›–ã€‚ å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ£€æµ‹åˆ°å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å°*loadFactorï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹Nodeæ•°ç»„è¿›è¡Œæ‰©å®¹ï¼Œéƒ½åœ¨é‡æ–°è®¡ç®—å…ƒç´ ä½ç½®ä»¥åŠå¤åˆ¶æ•°æ®ï¼Œä½†æ˜¯æœ€ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰©å®¹åçš„æ•°ç»„ä¼šèµ‹ç»™tableï¼Œä¹Ÿå°±æ˜¯è¯´å…¶ä»–çº¿ç¨‹çš„éƒ½ä¼šä¸¢å¤±ï¼Œå¹¶ä¸”å„è‡ªçº¿ç¨‹putçš„æ•°æ®ä¹Ÿä¸¢å¤±ã€‚ æ‰©å®¹æ—¶éœ€è¦rehashï¼Œå¯èƒ½ä¼šé€ æˆæ­»å¾ªç¯(java8å·²ä¿®å¤) å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨HashMap Hashtable123456public synchronized V get(Object key) &#123; .....&#125;public synchronized V put(K key, V value) &#123; ......&#125; æ•ˆç‡ä½ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨putæ–¹æ³•æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸ä½†ä¸å¯ä»¥ä½¿ç”¨putæ–¹æ³•ï¼Œè¿getæ–¹æ³•éƒ½ä¸å¯ä»¥ã€‚ ConcurrentHashMap ï¼ˆæ•ˆç‡é«˜ï¼‰JUCåŒ…ä¸­çš„ä¸€ä¸ªç±»ã€‚ConcurrentHashMap ä¸ä»…çº¿ç¨‹å®‰å…¨è€Œä¸”æ•ˆç‡é«˜ï¼Œå› ä¸ºå®ƒåŒ…å«ä¸€ä¸ª segment æ•°ç»„ï¼Œå°†æ•°æ®åˆ†æ®µå­˜å‚¨ï¼Œç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„é”åˆ†æ®µæŠ€æœ¯ã€‚ SynchronizedMapè°ƒç”¨synchronizedMap()æ–¹æ³•åè¿”å›ä¸€ä¸ªSynchronizedMapç±»çš„å¯¹è±¡ï¼Œè€Œåœ¨SynchronizedMapç±»ä¸­ä½¿ç”¨äº†synchronizedåŒæ­¥å…³é”®å­—æ¥ä¿è¯å¯¹Mapçš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ 1234567891011121314151617181920212223242526272829303132333435363738394041// synchronizedMapæ–¹æ³•public static &lt;K,V&gt; Map&lt;K,V&gt; synchronizedMap(Map&lt;K,V&gt; m) &#123; return new SynchronizedMap&lt;&gt;(m); &#125;// SynchronizedMapç±»private static class SynchronizedMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Serializable &#123; private static final long serialVersionUID = 1978198479659022715L; private final Map&lt;K,V&gt; m; // Backing Map final Object mutex; // Object on which to synchronize SynchronizedMap(Map&lt;K,V&gt; m) &#123; this.m = Objects.requireNonNull(m); mutex = this; &#125; SynchronizedMap(Map&lt;K,V&gt; m, Object mutex) &#123; this.m = m; this.mutex = mutex; &#125; public int size() &#123; synchronized (mutex) &#123;return m.size();&#125; &#125; public boolean isEmpty() &#123; synchronized (mutex) &#123;return m.isEmpty();&#125; &#125; public boolean containsKey(Object key) &#123; synchronized (mutex) &#123;return m.containsKey(key);&#125; &#125; public boolean containsValue(Object value) &#123; synchronized (mutex) &#123;return m.containsValue(value);&#125; &#125; public V get(Object key) &#123; synchronized (mutex) &#123;return m.get(key);&#125; &#125; public V put(K key, V value) &#123; synchronized (mutex) &#123;return m.put(key, value);&#125; &#125; public V remove(Object key) &#123; synchronized (mutex) &#123;return m.remove(key);&#125; &#125; // çœç•¥å…¶ä»–æ–¹æ³• &#125; ä»æºç ä¸­å¯ä»¥çœ‹å‡ºè°ƒç”¨ synchronizedMap() æ–¹æ³•åä¼šè¿”å›ä¸€ä¸ª SynchronizedMap ç±»çš„å¯¹è±¡ï¼Œè€Œåœ¨ SynchronizedMap ç±»ä¸­ä½¿ç”¨äº† synchronized åŒæ­¥å…³é”®å­—æ¥ä¿è¯å¯¹ Map çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ æ€»ç»“ HashMapåœ¨å¤„ç†å†²çªæ—¶ä½¿ç”¨é“¾è¡¨å­˜å‚¨ç›¸åŒç´¢å¼•çš„å…ƒç´ ã€‚ ä»Java 8å¼€å§‹ï¼ŒHashMapï¼ŒConcurrentHashMapå’ŒLinkedHashMapåœ¨å¤„ç†é¢‘ç¹å†²çªæ—¶å°†ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œå½“åŒä¸€hashæ¡¶ä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡ç‰¹å®šçš„å€¼ä¾¿ä¼šç”±é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚ å½“ä»é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘æ—¶ï¼ŒHashMapè¿­ä»£çš„é¡ºåºå°†ä¼šæ”¹å˜ã€‚ä¸è¿‡è¿™å¹¶ä¸ä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºHashMapå¹¶æ²¡æœ‰å¯¹è¿­ä»£çš„é¡ºåºæä¾›ä»»ä½•ä¿è¯ã€‚ ä»Java 1ä¸­å°±å­˜åœ¨çš„Hashtableç±»ä¸ºäº†ä¿è¯è¿­ä»£é¡ºåºä¸å˜ï¼Œå³ä¾¿åœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä½¿ç”¨å¹³è¡¡æ ‘ã€‚è¿™ä¸€å†³å®šæ˜¯ä¸ºäº†ä¸ç ´åæŸäº›è¾ƒè€çš„éœ€è¦ä¾èµ–äºHashtableè¿­ä»£é¡ºåºçš„Javaåº”ç”¨ã€‚ é™¤äº†Hashtableä¹‹å¤–ï¼ŒWeakHashMapå’ŒIdentityHashMapä¹Ÿä¸ä¼šåœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä½¿ç”¨å¹³è¡¡æ ‘ã€‚ ä½¿ç”¨HashMapä¹‹æ‰€ä»¥ä¼šäº§ç”Ÿå†²çªæ˜¯å› ä¸ºä½¿ç”¨äº†é”®å¯¹è±¡çš„hashCode()æ–¹æ³•ï¼Œè€Œequals()å’ŒhashCode()æ–¹æ³•ä¸ä¿è¯ä¸åŒå¯¹è±¡çš„hashCodeæ˜¯ä¸åŒçš„ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œç›¸åŒå¯¹è±¡çš„hashCodeä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œä½†ç›¸åŒçš„hashCodeä¸ä¸€å®šæ˜¯ç›¸åŒçš„å¯¹è±¡ã€‚ åœ¨HashTableå’ŒHashMapä¸­ï¼Œå†²çªçš„äº§ç”Ÿæ˜¯ç”±äºä¸åŒå¯¹è±¡çš„hashCode()æ–¹æ³•è¿”å›äº†ä¸€æ ·çš„å€¼ã€‚ å‚è€ƒ Java 8ä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨ HashMap çœ‹çœ‹HashMapæºç ","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Stringä¸StringBuffer","slug":"Stringä¸StringBuffer","date":"2018-04-11T06:17:41.000Z","updated":"2018-04-13T12:13:33.151Z","comments":true,"path":"2018/04/11/Stringä¸StringBuffer/","link":"","permalink":"https://hsb786.github.io/2018/04/11/Stringä¸StringBuffer/","excerpt":"Stringä¸å¯å˜ï¼ŒStringBufferå¯å˜ï¼Œwhy ?","text":"Stringä¸å¯å˜ï¼ŒStringBufferå¯å˜ï¼Œwhy ? çœ‹æºç  String1234public final class String implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence &#123; /** The value is used for character storage. */ private final char value[]; å¯ä»¥çœ‹å‡ºStringåº•å±‚æ˜¯ç”¨charæ•°ç»„å®ç°çš„ï¼Œç”±äºè¢«finalä¿®é¥°æ‰€ä»¥å¼•ç”¨ä¸èƒ½æ”¹å˜ã€‚ ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ åªæœ‰å½“å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œå­—ç¬¦ä¸²æ± æ‰æœ‰å¯èƒ½å®ç°ã€‚å­—ç¬¦ä¸²æ± çš„å®ç°å¯ä»¥åœ¨è¿è¡Œæ—¶èŠ‚çº¦å¾ˆå¤šheapç©ºé—´ï¼Œå› ä¸ºä¸åŒçš„å­—ç¬¦ä¸²å˜é‡éƒ½æŒ‡å‘æ± ä¸­çš„åŒä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä½†å¦‚æœå­—ç¬¦ä¸²æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆString interningå°†ä¸èƒ½å®ç°(String interningæ˜¯æŒ‡å¯¹ä¸åŒçš„å­—ç¬¦ä¸²ä»…ä»…åªä¿å­˜ä¸€ä¸ªï¼Œå³ä¸ä¼šä¿å­˜å¤šä¸ªç›¸åŒçš„å­—ç¬¦ä¸²)ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œå¦‚æœå˜é‡æ”¹å˜äº†å®ƒçš„å€¼ï¼Œé‚£ä¹ˆå…¶å®ƒæŒ‡å‘è¿™ä¸ªå€¼çš„å˜é‡çš„å€¼ä¹Ÿä¼šä¸€èµ·æ”¹å˜ã€‚ å¦‚æœå­—ç¬¦ä¸²æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆä¼šå¼•èµ·å¾ˆä¸¥é‡çš„å®‰å…¨é—®é¢˜ã€‚è­¬å¦‚ï¼Œæ•°æ®åº“çš„ç”¨æˆ·åã€å¯†ç éƒ½æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¼ å…¥æ¥è·å¾—æ•°æ®åº“çš„è¿æ¥ï¼Œæˆ–è€…åœ¨socketç¼–ç¨‹ä¸­ï¼Œä¸»æœºåå’Œç«¯å£éƒ½æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¼ å…¥ã€‚ å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥å®ƒçš„å€¼æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œå¦åˆ™é»‘å®¢ä»¬å¯ä»¥é’»åˆ°ç©ºå­ï¼Œæ”¹å˜å­—ç¬¦ä¸²æŒ‡å‘çš„å¯¹è±¡çš„å€¼ï¼Œé€ æˆå®‰å…¨æ¼æ´ã€‚å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥æ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„ï¼ŒåŒä¸€ä¸ªå­—ç¬¦ä¸²å®ä¾‹å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ã€‚è¿™æ ·ä¾¿ä¸ç”¨å› ä¸ºçº¿ç¨‹å®‰å…¨é—®é¢˜è€Œä½¿ç”¨åŒæ­¥ã€‚å­—ç¬¦ä¸²è‡ªå·±ä¾¿æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ ç±»åŠ è½½å™¨è¦ç”¨åˆ°å­—ç¬¦ä¸²ï¼Œä¸å¯å˜æ€§æä¾›äº†å®‰å…¨æ€§ï¼Œä»¥ä¾¿æ­£ç¡®çš„ç±»è¢«åŠ è½½ã€‚è­¬å¦‚ä½ æƒ³åŠ è½½java.sql.Connectionç±»ï¼Œè€Œè¿™ä¸ªå€¼è¢«æ”¹æˆäº†myhacked.Connectionï¼Œé‚£ä¹ˆä¼šå¯¹ä½ çš„æ•°æ®åº“é€ æˆä¸å¯çŸ¥çš„ç ´åã€‚ å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥åœ¨å®ƒåˆ›å»ºçš„æ—¶å€™hashcodeå°±è¢«ç¼“å­˜äº†ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—ã€‚è¿™å°±ä½¿å¾—å­—ç¬¦ä¸²å¾ˆé€‚åˆä½œä¸ºMapä¸­çš„é”®ï¼Œå­—ç¬¦ä¸²çš„å¤„ç†é€Ÿåº¦è¦å¿«è¿‡å…¶å®ƒçš„é”®å¯¹è±¡ã€‚è¿™å°±æ˜¯HashMapä¸­çš„é”®å¾€å¾€éƒ½ä½¿ç”¨å­—ç¬¦ä¸²ã€‚ StringBuffer 12345678910111213141516171819202122232425262728293031323334353637383940414243 public final class StringBuffer extends AbstractStringBuilder implements java.io.Serializable, CharSequence&#123; /** * A cache of the last value returned by toString. Cleared * whenever the StringBuffer is modified. */ private transient char[] toStringCache; @Override public synchronized StringBuffer append(String str) &#123; toStringCache = null; super.append(str); return this; &#125; //AbstractStringBuilderä¸­çš„æ–¹æ³• public AbstractStringBuilder append(String str) &#123; if (str == null) return appendNull(); int len = str.length(); ensureCapacityInternal(count + len); str.getChars(0, len, value, count); count += len; return this; &#125; //Stringä¸­çš„æ–¹æ³• public void getChars(int srcBegin, int srcEnd, char dst[], int dstBegin) &#123; if (srcBegin &lt; 0) &#123; throw new StringIndexOutOfBoundsException(srcBegin); &#125; if (srcEnd &gt; value.length) &#123; throw new StringIndexOutOfBoundsException(srcEnd); &#125; if (srcBegin &gt; srcEnd) &#123; throw new StringIndexOutOfBoundsException(srcEnd - srcBegin); &#125; System.arraycopy(value, srcBegin, dst, dstBegin, srcEnd - srcBegin); &#125; StringBufferä¸­appendä¸­çš„å®ç° è°ƒç”¨super.append(str)ï¼Œ superç±»ä¸ºAbstractStringBuilder AbstractStringBuilder.append(str)ä¸­é€šè¿‡è°ƒç”¨Stringç±»çš„getChars()æ–¹æ³• String.getChars()ï¼Œè°ƒç”¨System.arraycopy()å®Œæˆæ•°ç»„çš„å¤åˆ¶ 12345678 * @param src the source array. * @param srcPos starting position in the source array. * @param dest the destination array. * @param destPos starting position in the destination data. * @param length the number of array elements to be copied.public static native void arraycopy(Object src, int srcPos, Object dest, int destPos, int length); æœ¬åœ°æ–¹æ³•çš„å®ç°ã€‚ srcåŸæ•°ç»„ï¼ŒsrcPocåŸæ•°ç»„èµ·å§‹ä½ï¼›destç›®æ ‡æ•°ç»„ï¼ŒdestPosç›®æ ‡æ•°ç»„èµ·å§‹ä½,lengthå¤åˆ¶ä¸ªæ•° 1234int[] int1= &#123;1,2,3,4&#125;;int[] int2= &#123;10,11,12,13,14,15,16,17&#125;;System.arraycopy(int1, 0, int2, 0, 3);System.out.println(Arrays.toString(int2)); //out [1, 2, 3, 13, 14, 15, 16, 17] å‚è€ƒ å¦‚ä½•ç†è§£ String ç±»å‹å€¼çš„ä¸å¯å˜ï¼Ÿ","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"å·¥å…·ç½‘ç«™","slug":"å·¥å…·ç½‘ç«™","date":"2018-04-11T04:22:11.000Z","updated":"2018-04-13T05:39:01.256Z","comments":true,"path":"2018/04/11/å·¥å…·ç½‘ç«™/","link":"","permalink":"https://hsb786.github.io/2018/04/11/å·¥å…·ç½‘ç«™/","excerpt":"","text":"å›¾æ ‡ ç”»å›¾ åœ¨çº¿ç¼–ç è½¬æ¢ HTTPçŠ¶æ€ç  Sqlè½¬Class","categories":[],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"EasyUI","slug":"EasyUI","date":"2018-04-11T03:28:06.000Z","updated":"2018-04-13T03:36:44.401Z","comments":true,"path":"2018/04/11/EasyUI/","link":"","permalink":"https://hsb786.github.io/2018/04/11/EasyUI/","excerpt":"","text":"å½“è¯·æ±‚è¿œç¨‹æ•°æ®æ—¶ï¼Œå‘é€çš„é¢å¤–å‚æ•°ã€‚ åœ¨datagridæ„é€ ä¸­åŠ å…¥queryParamså‚æ•°12345678dataGrid = $(&apos;#dg&apos;).datagrid(&#123; url : &apos;$&#123;pageContext.request.contextPath&#125;/companys/datagrid&apos;, method : &apos;GET&apos;, ......................... queryParams : &#123; //ä¼ å…¥å½“å‰æ—¥æœŸæŸ¥è¯¢ startTime : getNowFormatDate() &#125;, é‡æ–°åŠ è½½è¡Œï¼Œä¿æŒåœ¨å½“å‰é¡µ1$(&apos;#dg&apos;).datagrid(&apos;reload&apos;); åŠ è½½å¹¶æ˜¾ç¤ºç¬¬ä¸€é¡µçš„è¡Œ,é€šè¿‡ä¼ é€’ä¸€äº›ä»å‚æ•°è¿›è¡ŒæŸ¥è¯¢ï¼Œè¯¥æ–¹æ³•è¢«è°ƒç”¨æ¥ä»æœåŠ¡å™¨åŠ è½½æ–°æ•°æ®ã€‚ 1234$(&quot;#dg&quot;).datagrid(&apos;load&apos;, &#123; &quot;job.name&quot; : $(&quot;#jobname&quot;).val(), &quot;user.realname&quot; : $(&quot;#realname&quot;).val() &#125;);","categories":[],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/tags/å‰ç«¯/"}]},{"title":"KingEditor","slug":"KingEditor","date":"2018-04-11T03:22:23.000Z","updated":"2018-04-13T03:27:29.695Z","comments":true,"path":"2018/04/11/KingEditor/","link":"","permalink":"https://hsb786.github.io/2018/04/11/KingEditor/","excerpt":"","text":"å®˜æ–¹æ–‡æ¡£ç¤ºä¾‹ åˆå§‹åŒ–ï¼›å±äºå¼‚æ­¥åŠ è½½123KindEditor.ready(function(K) &#123; window.editor = K.create(&apos;#editor_id&apos;); &#125;); åŒæ­¥åŠ è½½ï¼›ç›´æ¥è°ƒç”¨KindEditoråˆ›å»ºï¼Œè€Œä¸æ˜¯ç­‰KindEditor.readyåå†åˆ›å»º1234567891011about = KindEditor.create(&apos;textarea[id=&quot;about&quot;]&apos;, &#123; items : [ &apos;cut&apos;, &apos;copy&apos;, &apos;paste&apos;, &apos;justifyleft&apos;, &apos;justifycenter&apos;, &apos;justifyright&apos;, &apos;justifyfull&apos;, &apos;insertorderedlist&apos;, &apos;insertunorderedlist&apos;, &apos;indent&apos;, &apos;outdent&apos;, &apos;subscript&apos;, &apos;superscript&apos;, &apos;clearhtml&apos;, &apos;quickformat&apos;, &apos;selectall&apos;, &apos;|&apos;, &apos;fullscreen&apos;, &apos;/&apos;, &apos;formatblock&apos;, &apos;fontname&apos;, &apos;fontsize&apos;, &apos;|&apos;, &apos;forecolor&apos;, &apos;hilitecolor&apos;, &apos;bold&apos;, &apos;italic&apos;, &apos;underline&apos;, &apos;strikethrough&apos;, &apos;lineheight&apos;, &apos;removeformat&apos;, &apos;|&apos;, &apos;table&apos;, &apos;hr&apos;, &apos;emoticons&apos;, &apos;pagebreak&apos; ] &#125;);","categories":[],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/tags/å‰ç«¯/"}]},{"title":"HTTPçŠ¶æ€ç ","slug":"HTTPçŠ¶æ€ç ","date":"2018-04-10T12:27:44.000Z","updated":"2018-04-11T04:16:31.866Z","comments":true,"path":"2018/04/10/HTTPçŠ¶æ€ç /","link":"","permalink":"https://hsb786.github.io/2018/04/10/HTTPçŠ¶æ€ç /","excerpt":"HTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚å®ƒç”± RFC 2616 è§„èŒƒå®šä¹‰çš„ï¼Œå¹¶å¾—åˆ°RFC 2518ã€RFC 2817ã€RFC 2295ã€RFC 2774ã€RFC 4918ç­‰è§„èŒƒæ‰©å±•ã€‚","text":"HTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚å®ƒç”± RFC 2616 è§„èŒƒå®šä¹‰çš„ï¼Œå¹¶å¾—åˆ°RFC 2518ã€RFC 2817ã€RFC 2295ã€RFC 2774ã€RFC 4918ç­‰è§„èŒƒæ‰©å±•ã€‚ status å«ä¹‰ 100 å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚ã€‚è¿™ä¸ªä¸´æ—¶å“åº”æ˜¯ç”¨æ¥é€šçŸ¥å®¢æˆ·ç«¯å®ƒçš„éƒ¨åˆ†è¯·æ±‚å·²ç»è¢«æœåŠ¡å™¨æ¥æ”¶ï¼Œä¸”ä»æœªè¢«æ‹’ç»ã€‚å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ–è€…å¦‚æœè¯·æ±‚å·²ç»å®Œæˆï¼Œå¿½ç•¥è¿™ä¸ªå“åº”ã€‚æœåŠ¡å™¨å¿…é¡»åœ¨è¯·æ±‚å®Œæˆåå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæœ€ç»ˆå“åº”ã€‚ 101 æœåŠ¡å™¨å·²ç»ç†è§£äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†é€šè¿‡Upgrade æ¶ˆæ¯å¤´é€šçŸ¥å®¢æˆ·ç«¯é‡‡ç”¨ä¸åŒçš„åè®®æ¥å®Œæˆè¿™ä¸ªè¯·æ±‚ã€‚åœ¨å‘é€å®Œè¿™ä¸ªå“åº”æœ€åçš„ç©ºè¡Œåï¼ŒæœåŠ¡å™¨å°†ä¼šåˆ‡æ¢åˆ°åœ¨Upgrade æ¶ˆæ¯å¤´ä¸­å®šä¹‰çš„é‚£äº›åè®®ã€‚ åªæœ‰åœ¨åˆ‡æ¢æ–°çš„åè®®æ›´æœ‰å¥½å¤„çš„æ—¶å€™æ‰åº”è¯¥é‡‡å–ç±»ä¼¼æªæ–½ã€‚ä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°æ–°çš„HTTP ç‰ˆæœ¬æ¯”æ—§ç‰ˆæœ¬æ›´æœ‰ä¼˜åŠ¿ï¼Œæˆ–è€…åˆ‡æ¢åˆ°ä¸€ä¸ªå®æ—¶ä¸”åŒæ­¥çš„åè®®ä»¥ä¼ é€åˆ©ç”¨æ­¤ç±»ç‰¹æ€§çš„èµ„æºã€‚ 102 ç”±WebDAVï¼ˆRFC 2518ï¼‰æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨å¤„ç†å°†è¢«ç»§ç»­æ‰§è¡Œã€‚ 200 è¯·æ±‚å·²æˆåŠŸï¼Œè¯·æ±‚æ‰€å¸Œæœ›çš„å“åº”å¤´æˆ–æ•°æ®ä½“å°†éšæ­¤å“åº”è¿”å›ã€‚ 201 è¯·æ±‚å·²ç»è¢«å®ç°ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªæ–°çš„èµ„æºå·²ç»ä¾æ®è¯·æ±‚çš„éœ€è¦è€Œå»ºç«‹ï¼Œä¸”å…¶ URI å·²ç»éšLocation å¤´ä¿¡æ¯è¿”å›ã€‚å‡å¦‚éœ€è¦çš„èµ„æºæ— æ³•åŠæ—¶å»ºç«‹çš„è¯ï¼Œåº”å½“è¿”å› â€˜202 Acceptedâ€™ã€‚ 202 æœåŠ¡å™¨å·²æ¥å—è¯·æ±‚ï¼Œä½†å°šæœªå¤„ç†ã€‚æ­£å¦‚å®ƒå¯èƒ½è¢«æ‹’ç»ä¸€æ ·ï¼Œæœ€ç»ˆè¯¥è¯·æ±‚å¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚åœ¨å¼‚æ­¥æ“ä½œçš„åœºåˆä¸‹ï¼Œæ²¡æœ‰æ¯”å‘é€è¿™ä¸ªçŠ¶æ€ç æ›´æ–¹ä¾¿çš„åšæ³•äº†ã€‚ è¿”å›202çŠ¶æ€ç çš„å“åº”çš„ç›®çš„æ˜¯å…è®¸æœåŠ¡å™¨æ¥å—å…¶ä»–è¿‡ç¨‹çš„è¯·æ±‚ï¼ˆä¾‹å¦‚æŸä¸ªæ¯å¤©åªæ‰§è¡Œä¸€æ¬¡çš„åŸºäºæ‰¹å¤„ç†çš„æ“ä½œï¼‰ï¼Œè€Œä¸å¿…è®©å®¢æˆ·ç«¯ä¸€ç›´ä¿æŒä¸æœåŠ¡å™¨çš„è¿æ¥ç›´åˆ°æ‰¹å¤„ç†æ“ä½œå…¨éƒ¨å®Œæˆã€‚åœ¨æ¥å—è¯·æ±‚å¤„ç†å¹¶è¿”å›202çŠ¶æ€ç çš„å“åº”åº”å½“åœ¨è¿”å›çš„å®ä½“ä¸­åŒ…å«ä¸€äº›æŒ‡ç¤ºå¤„ç†å½“å‰çŠ¶æ€çš„ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘å¤„ç†çŠ¶æ€ç›‘è§†å™¨æˆ–çŠ¶æ€é¢„æµ‹çš„æŒ‡é’ˆï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿä¼°è®¡æ“ä½œæ˜¯å¦å·²ç»å®Œæˆã€‚ 203 æœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†è¿”å›çš„å®ä½“å¤´éƒ¨å…ƒä¿¡æ¯ä¸æ˜¯åœ¨åŸå§‹æœåŠ¡å™¨ä¸Šæœ‰æ•ˆçš„ç¡®å®šé›†åˆï¼Œè€Œæ˜¯æ¥è‡ªæœ¬åœ°æˆ–è€…ç¬¬ä¸‰æ–¹çš„æ‹·è´ã€‚å½“å‰çš„ä¿¡æ¯å¯èƒ½æ˜¯åŸå§‹ç‰ˆæœ¬çš„å­é›†æˆ–è€…è¶…é›†ã€‚ä¾‹å¦‚ï¼ŒåŒ…å«èµ„æºçš„å…ƒæ•°æ®å¯èƒ½å¯¼è‡´åŸå§‹æœåŠ¡å™¨çŸ¥é“å…ƒä¿¡æ¯çš„è¶…çº§ã€‚ä½¿ç”¨æ­¤çŠ¶æ€ç ä¸æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”åªæœ‰åœ¨å“åº”ä¸ä½¿ç”¨æ­¤çŠ¶æ€ç ä¾¿ä¼šè¿”å›200 OKçš„æƒ…å†µä¸‹æ‰æ˜¯åˆé€‚çš„ã€‚ 204 æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†ä¸éœ€è¦è¿”å›ä»»ä½•å®ä½“å†…å®¹ï¼Œå¹¶ä¸”å¸Œæœ›è¿”å›æ›´æ–°äº†çš„å…ƒä¿¡æ¯ã€‚å“åº”å¯èƒ½é€šè¿‡å®ä½“å¤´éƒ¨çš„å½¢å¼ï¼Œè¿”å›æ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯ã€‚å¦‚æœå­˜åœ¨è¿™äº›å¤´éƒ¨ä¿¡æ¯ï¼Œåˆ™åº”å½“ä¸æ‰€è¯·æ±‚çš„å˜é‡ç›¸å‘¼åº”ã€‚ å¦‚æœå®¢æˆ·ç«¯æ˜¯æµè§ˆå™¨çš„è¯ï¼Œé‚£ä¹ˆç”¨æˆ·æµè§ˆå™¨åº”ä¿ç•™å‘é€äº†è¯¥è¯·æ±‚çš„é¡µé¢ï¼Œè€Œä¸äº§ç”Ÿä»»ä½•æ–‡æ¡£è§†å›¾ä¸Šçš„å˜åŒ–ï¼Œå³ä½¿æŒ‰ç…§è§„èŒƒæ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯åº”å½“è¢«åº”ç”¨åˆ°ç”¨æˆ·æµè§ˆå™¨æ´»åŠ¨è§†å›¾ä¸­çš„æ–‡æ¡£ã€‚ ç”±äº204å“åº”è¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œå› æ­¤å®ƒå§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚ 205 æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä¸”æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ä½†æ˜¯ä¸204å“åº”ä¸åŒï¼Œè¿”å›æ­¤çŠ¶æ€ç çš„å“åº”è¦æ±‚è¯·æ±‚è€…é‡ç½®æ–‡æ¡£è§†å›¾ã€‚è¯¥å“åº”ä¸»è¦æ˜¯è¢«ç”¨äºæ¥å—ç”¨æˆ·è¾“å…¥åï¼Œç«‹å³é‡ç½®è¡¨å•ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°å¼€å§‹å¦ä¸€æ¬¡è¾“å…¥ã€‚ ä¸204å“åº”ä¸€æ ·ï¼Œè¯¥å“åº”ä¹Ÿè¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œä¸”ä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“æŸã€‚ 206 æœåŠ¡å™¨å·²ç»æˆåŠŸå¤„ç†äº†éƒ¨åˆ† GET è¯·æ±‚ã€‚ç±»ä¼¼äº FlashGet æˆ–è€…è¿…é›·è¿™ç±»çš„ HTTP ä¸‹è½½å·¥å…·éƒ½æ˜¯ä½¿ç”¨æ­¤ç±»å“åº”å®ç°æ–­ç‚¹ç»­ä¼ æˆ–è€…å°†ä¸€ä¸ªå¤§æ–‡æ¡£åˆ†è§£ä¸ºå¤šä¸ªä¸‹è½½æ®µåŒæ—¶ä¸‹è½½ã€‚ è¯¥è¯·æ±‚å¿…é¡»åŒ…å« Range å¤´ä¿¡æ¯æ¥æŒ‡ç¤ºå®¢æˆ·ç«¯å¸Œæœ›å¾—åˆ°çš„å†…å®¹èŒƒå›´ï¼Œå¹¶ä¸”å¯èƒ½åŒ…å« If-Range æ¥ä½œä¸ºè¯·æ±‚æ¡ä»¶ã€‚ å“åº”å¿…é¡»åŒ…å«å¦‚ä¸‹çš„å¤´éƒ¨åŸŸï¼š Content-Range ç”¨ä»¥æŒ‡ç¤ºæœ¬æ¬¡å“åº”ä¸­è¿”å›çš„å†…å®¹çš„èŒƒå›´ï¼›å¦‚æœæ˜¯ Content-Type ä¸º multipart/byteranges çš„å¤šæ®µä¸‹è½½ï¼Œåˆ™æ¯ä¸€ multipart æ®µä¸­éƒ½åº”åŒ…å« Content-Range åŸŸç”¨ä»¥æŒ‡ç¤ºæœ¬æ®µçš„å†…å®¹èŒƒå›´ã€‚å‡å¦‚å“åº”ä¸­åŒ…å« Content-Lengthï¼Œé‚£ä¹ˆå®ƒçš„æ•°å€¼å¿…é¡»åŒ¹é…å®ƒè¿”å›çš„å†…å®¹èŒƒå›´çš„çœŸå®å­—èŠ‚æ•°ã€‚ Date ETag å’Œ/æˆ– Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¯¥è¿”å›200å“åº”ã€‚ Expires, Cache-Controlï¼Œå’Œ/æˆ– Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚ å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº† If-Range å¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å‡å¦‚æœ¬å“åº”çš„è¯·æ±‚ä½¿ç”¨äº† If-Range å¼±ç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚å¦åˆ™ï¼Œæœ¬å“åº”å°±åº”å½“åŒ…å«æ‰€æœ‰æœ¬åº”è¯¥è¿”å›200å“åº”ä¸­åº”å½“è¿”å›çš„æ‰€æœ‰å®ä½“å¤´éƒ¨åŸŸã€‚ å‡å¦‚ ETag æˆ– Last-Modified å¤´éƒ¨ä¸èƒ½ç²¾ç¡®åŒ¹é…çš„è¯ï¼Œåˆ™å®¢æˆ·ç«¯ç¼“å­˜åº”ç¦æ­¢å°†206å“åº”è¿”å›çš„å†…å®¹ä¸ä¹‹å‰ä»»ä½•ç¼“å­˜è¿‡çš„å†…å®¹ç»„åˆåœ¨ä¸€èµ·ã€‚ ä»»ä½•ä¸æ”¯æŒ Range ä»¥åŠ Content-Range å¤´çš„ç¼“å­˜éƒ½ç¦æ­¢ç¼“å­˜206å“åº”è¿”å›çš„å†…å®¹ã€‚ 207 ç”±WebDAV(RFC 2518)æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨ä¹‹åçš„æ¶ˆæ¯ä½“å°†æ˜¯ä¸€ä¸ªXMLæ¶ˆæ¯ï¼Œå¹¶ä¸”å¯èƒ½ä¾ç…§ä¹‹å‰å­è¯·æ±‚æ•°é‡çš„ä¸åŒï¼ŒåŒ…å«ä¸€ç³»åˆ—ç‹¬ç«‹çš„å“åº”ä»£ç ã€‚ 300 è¢«è¯·æ±‚çš„èµ„æºæœ‰ä¸€ç³»åˆ—å¯ä¾›é€‰æ‹©çš„å›é¦ˆä¿¡æ¯ï¼Œæ¯ä¸ªéƒ½æœ‰è‡ªå·±ç‰¹å®šçš„åœ°å€å’Œæµè§ˆå™¨é©±åŠ¨çš„å•†è®®ä¿¡æ¯ã€‚ç”¨æˆ·æˆ–æµè§ˆå™¨èƒ½å¤Ÿè‡ªè¡Œé€‰æ‹©ä¸€ä¸ªé¦–é€‰çš„åœ°å€è¿›è¡Œé‡å®šå‘ã€‚ é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”åº”å½“åŒ…æ‹¬ä¸€ä¸ªèµ„æºç‰¹æ€§åŠåœ°å€çš„åˆ—è¡¨çš„å®ä½“ï¼Œä»¥ä¾¿ç”¨æˆ·æˆ–æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„é‡å®šå‘åœ°å€ã€‚è¿™ä¸ªå®ä½“çš„æ ¼å¼ç”± Content-Type å®šä¹‰çš„æ ¼å¼æ‰€å†³å®šã€‚æµè§ˆå™¨å¯èƒ½æ ¹æ®å“åº”çš„æ ¼å¼ä»¥åŠæµè§ˆå™¨è‡ªèº«èƒ½åŠ›ï¼Œè‡ªåŠ¨ä½œå‡ºæœ€åˆé€‚çš„é€‰æ‹©ã€‚å½“ç„¶ï¼ŒRFC 2616è§„èŒƒå¹¶æ²¡æœ‰è§„å®šè¿™æ ·çš„è‡ªåŠ¨é€‰æ‹©è¯¥å¦‚ä½•è¿›è¡Œã€‚ å¦‚æœæœåŠ¡å™¨æœ¬èº«å·²ç»æœ‰äº†é¦–é€‰çš„å›é¦ˆé€‰æ‹©ï¼Œé‚£ä¹ˆåœ¨ Location ä¸­åº”å½“æŒ‡æ˜è¿™ä¸ªå›é¦ˆçš„ URIï¼›æµè§ˆå™¨å¯èƒ½ä¼šå°†è¿™ä¸ª Location å€¼ä½œä¸ºè‡ªåŠ¨é‡å®šå‘çš„åœ°å€ã€‚æ­¤å¤–ï¼Œé™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚ 301 è¢«è¯·æ±‚çš„èµ„æºå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼Œå¹¶ä¸”å°†æ¥ä»»ä½•å¯¹æ­¤èµ„æºçš„å¼•ç”¨éƒ½åº”è¯¥ä½¿ç”¨æœ¬å“åº”è¿”å›çš„è‹¥å¹²ä¸ª URI ä¹‹ä¸€ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“è‡ªåŠ¨æŠŠè¯·æ±‚çš„åœ°å€ä¿®æ”¹ä¸ºä»æœåŠ¡å™¨åé¦ˆå›æ¥çš„åœ°å€ã€‚é™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚ æ–°çš„æ°¸ä¹…æ€§çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª GET æˆ–è€… HEAD è¯·æ±‚ï¼Œå› æ­¤æµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ æ³¨æ„ï¼šå¯¹äºæŸäº›ä½¿ç”¨ HTTP/1.0 åè®®çš„æµè§ˆå™¨ï¼Œå½“å®ƒä»¬å‘é€çš„ POST è¯·æ±‚å¾—åˆ°äº†ä¸€ä¸ª301å“åº”çš„è¯ï¼Œæ¥ä¸‹æ¥çš„é‡å®šå‘è¯·æ±‚å°†ä¼šå˜æˆ GET æ–¹å¼ã€‚ 302 è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„ URI å“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚ æ–°çš„ä¸´æ—¶æ€§çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª GET æˆ–è€… HEAD è¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ æ³¨æ„ï¼šè™½ç„¶RFC 1945å’ŒRFC 2068è§„èŒƒä¸å…è®¸å®¢æˆ·ç«¯åœ¨é‡å®šå‘æ—¶æ”¹å˜è¯·æ±‚çš„æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå¤šç°å­˜çš„æµè§ˆå™¨å°†302å“åº”è§†ä½œä¸º303å“åº”ï¼Œå¹¶ä¸”ä½¿ç”¨ GET æ–¹å¼è®¿é—®åœ¨ Location ä¸­è§„å®šçš„ URIï¼Œè€Œæ— è§†åŸå…ˆè¯·æ±‚çš„æ–¹æ³•ã€‚çŠ¶æ€ç 303å’Œ307è¢«æ·»åŠ äº†è¿›æ¥ï¼Œç”¨ä»¥æ˜ç¡®æœåŠ¡å™¨æœŸå¾…å®¢æˆ·ç«¯è¿›è¡Œä½•ç§ååº”ã€‚ 303 å¯¹åº”å½“å‰è¯·æ±‚çš„å“åº”å¯ä»¥åœ¨å¦ä¸€ä¸ª URI ä¸Šè¢«æ‰¾åˆ°ï¼Œè€Œä¸”å®¢æˆ·ç«¯åº”å½“é‡‡ç”¨ GET çš„æ–¹å¼è®¿é—®é‚£ä¸ªèµ„æºã€‚è¿™ä¸ªæ–¹æ³•çš„å­˜åœ¨ä¸»è¦æ˜¯ä¸ºäº†å…è®¸ç”±è„šæœ¬æ¿€æ´»çš„POSTè¯·æ±‚è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–°çš„èµ„æºã€‚è¿™ä¸ªæ–°çš„ URI ä¸æ˜¯åŸå§‹èµ„æºçš„æ›¿ä»£å¼•ç”¨ã€‚åŒæ—¶ï¼Œ303å“åº”ç¦æ­¢è¢«ç¼“å­˜ã€‚å½“ç„¶ï¼Œç¬¬äºŒä¸ªè¯·æ±‚ï¼ˆé‡å®šå‘ï¼‰å¯èƒ½è¢«ç¼“å­˜ã€‚ æ–°çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ æ³¨æ„ï¼šè®¸å¤š HTTP/1.1 ç‰ˆä»¥å‰çš„ æµè§ˆå™¨ä¸èƒ½æ­£ç¡®ç†è§£303çŠ¶æ€ã€‚å¦‚æœéœ€è¦è€ƒè™‘ä¸è¿™äº›æµè§ˆå™¨ä¹‹é—´çš„äº’åŠ¨ï¼Œ302çŠ¶æ€ç åº”è¯¥å¯ä»¥èƒœä»»ï¼Œå› ä¸ºå¤§å¤šæ•°çš„æµè§ˆå™¨å¤„ç†302å“åº”æ—¶çš„æ–¹å¼æ°æ°å°±æ˜¯ä¸Šè¿°è§„èŒƒè¦æ±‚å®¢æˆ·ç«¯å¤„ç†303å“åº”æ—¶åº”å½“åšçš„ã€‚ 304 å¦‚æœå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªå¸¦æ¡ä»¶çš„ GET è¯·æ±‚ä¸”è¯¥è¯·æ±‚å·²è¢«å…è®¸ï¼Œè€Œæ–‡æ¡£çš„å†…å®¹ï¼ˆè‡ªä¸Šæ¬¡è®¿é—®ä»¥æ¥æˆ–è€…æ ¹æ®è¯·æ±‚çš„æ¡ä»¶ï¼‰å¹¶æ²¡æœ‰æ”¹å˜ï¼Œåˆ™æœåŠ¡å™¨åº”å½“è¿”å›è¿™ä¸ªçŠ¶æ€ç ã€‚304å“åº”ç¦æ­¢åŒ…å«æ¶ˆæ¯ä½“ï¼Œå› æ­¤å§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚ è¯¥å“åº”å¿…é¡»åŒ…å«ä»¥ä¸‹çš„å¤´ä¿¡æ¯ï¼š Dateï¼Œé™¤éè¿™ä¸ªæœåŠ¡å™¨æ²¡æœ‰æ—¶é’Ÿã€‚å‡å¦‚æ²¡æœ‰æ—¶é’Ÿçš„æœåŠ¡å™¨ä¹Ÿéµå®ˆè¿™äº›è§„åˆ™ï¼Œé‚£ä¹ˆä»£ç†æœåŠ¡å™¨ä»¥åŠå®¢æˆ·ç«¯å¯ä»¥è‡ªè¡Œå°† Date å­—æ®µæ·»åŠ åˆ°æ¥æ”¶åˆ°çš„å“åº”å¤´ä¸­å»ï¼ˆæ­£å¦‚RFC 2068ä¸­è§„å®šçš„ä¸€æ ·ï¼‰ï¼Œç¼“å­˜æœºåˆ¶å°†ä¼šæ­£å¸¸å·¥ä½œã€‚ ETag å’Œ/æˆ– Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¿”å›200å“åº”ã€‚ Expires, Cache-Controlï¼Œå’Œ/æˆ–Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚ å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº†å¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å¦åˆ™ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ªå¸¦æ¡ä»¶çš„ GET è¯·æ±‚ä½¿ç”¨äº†å¼±ç¼“å­˜éªŒè¯ï¼‰ï¼Œæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜äº†çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚ å‡å¦‚æŸä¸ª304å“åº”æŒ‡æ˜äº†å½“å‰æŸä¸ªå®ä½“æ²¡æœ‰ç¼“å­˜ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»å¿½è§†è¿™ä¸ªå“åº”ï¼Œå¹¶ä¸”é‡å¤å‘é€ä¸åŒ…å«é™åˆ¶æ¡ä»¶çš„è¯·æ±‚ã€‚ å‡å¦‚æ¥æ”¶åˆ°ä¸€ä¸ªè¦æ±‚æ›´æ–°æŸä¸ªç¼“å­˜æ¡ç›®çš„304å“åº”ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»æ›´æ–°æ•´ä¸ªæ¡ç›®ä»¥åæ˜ æ‰€æœ‰åœ¨å“åº”ä¸­è¢«æ›´æ–°çš„å­—æ®µçš„å€¼ã€‚ 305 è¢«è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡æŒ‡å®šçš„ä»£ç†æ‰èƒ½è¢«è®¿é—®ã€‚Location åŸŸä¸­å°†ç»™å‡ºæŒ‡å®šçš„ä»£ç†æ‰€åœ¨çš„ URI ä¿¡æ¯ï¼Œæ¥æ”¶è€…éœ€è¦é‡å¤å‘é€ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œé€šè¿‡è¿™ä¸ªä»£ç†æ‰èƒ½è®¿é—®ç›¸åº”èµ„æºã€‚åªæœ‰åŸå§‹æœåŠ¡å™¨æ‰èƒ½å»ºç«‹305å“åº”ã€‚ æ³¨æ„ï¼šRFC 2068ä¸­æ²¡æœ‰æ˜ç¡®305å“åº”æ˜¯ä¸ºäº†é‡å®šå‘ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œè€Œä¸”åªèƒ½è¢«åŸå§‹æœåŠ¡å™¨å»ºç«‹ã€‚å¿½è§†è¿™äº›é™åˆ¶å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å®‰å…¨åæœã€‚ 306 åœ¨æœ€æ–°ç‰ˆçš„è§„èŒƒä¸­ï¼Œ306çŠ¶æ€ç å·²ç»ä¸å†è¢«ä½¿ç”¨ã€‚ 307 è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„URI å“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚ æ–°çš„ä¸´æ—¶æ€§çš„URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚å› ä¸ºéƒ¨åˆ†æµè§ˆå™¨ä¸èƒ½è¯†åˆ«307å“åº”ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä¸Šè¿°å¿…è¦ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿç†è§£å¹¶å‘æ–°çš„ URI å‘å‡ºè®¿é—®è¯·æ±‚ã€‚ å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ªGET æˆ–è€… HEAD è¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ 400 1ã€è¯­ä¹‰æœ‰è¯¯ï¼Œå½“å‰è¯·æ±‚æ— æ³•è¢«æœåŠ¡å™¨ç†è§£ã€‚é™¤éè¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¸åº”è¯¥é‡å¤æäº¤è¿™ä¸ªè¯·æ±‚ã€‚ 2ã€è¯·æ±‚å‚æ•°æœ‰è¯¯ã€‚ 401 å½“å‰è¯·æ±‚éœ€è¦ç”¨æˆ·éªŒè¯ã€‚è¯¥å“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªé€‚ç”¨äºè¢«è¯·æ±‚èµ„æºçš„ WWW-Authenticate ä¿¡æ¯å¤´ç”¨ä»¥è¯¢é—®ç”¨æˆ·ä¿¡æ¯ã€‚å®¢æˆ·ç«¯å¯ä»¥é‡å¤æäº¤ä¸€ä¸ªåŒ…å«æ°å½“çš„ Authorization å¤´ä¿¡æ¯çš„è¯·æ±‚ã€‚å¦‚æœå½“å‰è¯·æ±‚å·²ç»åŒ…å«äº† Authorization è¯ä¹¦ï¼Œé‚£ä¹ˆ401å“åº”ä»£è¡¨ç€æœåŠ¡å™¨éªŒè¯å·²ç»æ‹’ç»äº†é‚£äº›è¯ä¹¦ã€‚å¦‚æœ401å“åº”åŒ…å«äº†ä¸å‰ä¸€ä¸ªå“åº”ç›¸åŒçš„èº«ä»½éªŒè¯è¯¢é—®ï¼Œä¸”æµè§ˆå™¨å·²ç»è‡³å°‘å°è¯•äº†ä¸€æ¬¡éªŒè¯ï¼Œé‚£ä¹ˆæµè§ˆå™¨åº”å½“å‘ç”¨æˆ·å±•ç¤ºå“åº”ä¸­åŒ…å«çš„å®ä½“ä¿¡æ¯ï¼Œå› ä¸ºè¿™ä¸ªå®ä½“ä¿¡æ¯ä¸­å¯èƒ½åŒ…å«äº†ç›¸å…³è¯Šæ–­ä¿¡æ¯ã€‚å‚è§RFC 2617ã€‚ 402 è¯¥çŠ¶æ€ç æ˜¯ä¸ºäº†å°†æ¥å¯èƒ½çš„éœ€æ±‚è€Œé¢„ç•™çš„ã€‚ 403 æœåŠ¡å™¨å·²ç»ç†è§£è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œå®ƒã€‚ä¸401å“åº”ä¸åŒçš„æ˜¯ï¼Œèº«ä»½éªŒè¯å¹¶ä¸èƒ½æä¾›ä»»ä½•å¸®åŠ©ï¼Œè€Œä¸”è¿™ä¸ªè¯·æ±‚ä¹Ÿä¸åº”è¯¥è¢«é‡å¤æäº¤ã€‚å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œè€Œä¸”æœåŠ¡å™¨å¸Œæœ›èƒ½å¤Ÿè®²æ¸…æ¥šä¸ºä½•è¯·æ±‚ä¸èƒ½è¢«æ‰§è¡Œï¼Œé‚£ä¹ˆå°±åº”è¯¥åœ¨å®ä½“å†…æè¿°æ‹’ç»çš„åŸå› ã€‚å½“ç„¶æœåŠ¡å™¨ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª404å“åº”ï¼Œå‡å¦‚å®ƒä¸å¸Œæœ›è®©å®¢æˆ·ç«¯è·å¾—ä»»ä½•ä¿¡æ¯ã€‚ 404 è¯·æ±‚å¤±è´¥ï¼Œè¯·æ±‚æ‰€å¸Œæœ›å¾—åˆ°çš„èµ„æºæœªè¢«åœ¨æœåŠ¡å™¨ä¸Šå‘ç°ã€‚æ²¡æœ‰ä¿¡æ¯èƒ½å¤Ÿå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªçŠ¶å†µåˆ°åº•æ˜¯æš‚æ—¶çš„è¿˜æ˜¯æ°¸ä¹…çš„ã€‚å‡å¦‚æœåŠ¡å™¨çŸ¥é“æƒ…å†µçš„è¯ï¼Œåº”å½“ä½¿ç”¨410çŠ¶æ€ç æ¥å‘ŠçŸ¥æ—§èµ„æºå› ä¸ºæŸäº›å†…éƒ¨çš„é…ç½®æœºåˆ¶é—®é¢˜ï¼Œå·²ç»æ°¸ä¹…çš„ä¸å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å¯ä»¥è·³è½¬çš„åœ°å€ã€‚404è¿™ä¸ªçŠ¶æ€ç è¢«å¹¿æ³›åº”ç”¨äºå½“æœåŠ¡å™¨ä¸æƒ³æ­ç¤ºåˆ°åº•ä¸ºä½•è¯·æ±‚è¢«æ‹’ç»æˆ–è€…æ²¡æœ‰å…¶ä»–é€‚åˆçš„å“åº”å¯ç”¨çš„æƒ…å†µä¸‹ã€‚ 405 è¯·æ±‚è¡Œä¸­æŒ‡å®šçš„è¯·æ±‚æ–¹æ³•ä¸èƒ½è¢«ç”¨äºè¯·æ±‚ç›¸åº”çš„èµ„æºã€‚è¯¥å“åº”å¿…é¡»è¿”å›ä¸€ä¸ªAllow å¤´ä¿¡æ¯ç”¨ä»¥è¡¨ç¤ºå‡ºå½“å‰èµ„æºèƒ½å¤Ÿæ¥å—çš„è¯·æ±‚æ–¹æ³•çš„åˆ—è¡¨ã€‚ é‰´äº PUTï¼ŒDELETE æ–¹æ³•ä¼šå¯¹æœåŠ¡å™¨ä¸Šçš„èµ„æºè¿›è¡Œå†™æ“ä½œï¼Œå› è€Œç»å¤§éƒ¨åˆ†çš„ç½‘é¡µæœåŠ¡å™¨éƒ½ä¸æ”¯æŒæˆ–è€…åœ¨é»˜è®¤é…ç½®ä¸‹ä¸å…è®¸ä¸Šè¿°è¯·æ±‚æ–¹æ³•ï¼Œå¯¹äºæ­¤ç±»è¯·æ±‚å‡ä¼šè¿”å›405é”™è¯¯ã€‚ 406 è¯·æ±‚çš„èµ„æºçš„å†…å®¹ç‰¹æ€§æ— æ³•æ»¡è¶³è¯·æ±‚å¤´ä¸­çš„æ¡ä»¶ï¼Œå› è€Œæ— æ³•ç”Ÿæˆå“åº”å®ä½“ã€‚ é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”å°±åº”å½“è¿”å›ä¸€ä¸ªåŒ…å«å¯ä»¥è®©ç”¨æˆ·æˆ–è€…æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„å®ä½“ç‰¹æ€§ä»¥åŠåœ°å€åˆ—è¡¨çš„å®ä½“ã€‚å®ä½“çš„æ ¼å¼ç”± Content-Type å¤´ä¸­å®šä¹‰çš„åª’ä½“ç±»å‹å†³å®šã€‚æµè§ˆå™¨å¯ä»¥æ ¹æ®æ ¼å¼åŠè‡ªèº«èƒ½åŠ›è‡ªè¡Œä½œå‡ºæœ€ä½³é€‰æ‹©ã€‚ä½†æ˜¯ï¼Œè§„èŒƒä¸­å¹¶æ²¡æœ‰å®šä¹‰ä»»ä½•ä½œå‡ºæ­¤ç±»è‡ªåŠ¨é€‰æ‹©çš„æ ‡å‡†ã€‚ 407 ä¸401å“åº”ç±»ä¼¼ï¼Œåªä¸è¿‡å®¢æˆ·ç«¯å¿…é¡»åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè¿›è¡Œèº«ä»½éªŒè¯ã€‚ä»£ç†æœåŠ¡å™¨å¿…é¡»è¿”å›ä¸€ä¸ª Proxy-Authenticate ç”¨ä»¥è¿›è¡Œèº«ä»½è¯¢é—®ã€‚å®¢æˆ·ç«¯å¯ä»¥è¿”å›ä¸€ä¸ª Proxy-Authorization ä¿¡æ¯å¤´ç”¨ä»¥éªŒè¯ã€‚å‚è§RFC 2617ã€‚ 408 è¯·æ±‚è¶…æ—¶ã€‚å®¢æˆ·ç«¯æ²¡æœ‰åœ¨æœåŠ¡å™¨é¢„å¤‡ç­‰å¾…çš„æ—¶é—´å†…å®Œæˆä¸€ä¸ªè¯·æ±‚çš„å‘é€ã€‚å®¢æˆ·ç«¯å¯ä»¥éšæ—¶å†æ¬¡æäº¤è¿™ä¸€è¯·æ±‚è€Œæ— éœ€è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚ 409 ç”±äºå’Œè¢«è¯·æ±‚çš„èµ„æºçš„å½“å‰çŠ¶æ€ä¹‹é—´å­˜åœ¨å†²çªï¼Œè¯·æ±‚æ— æ³•å®Œæˆã€‚è¿™ä¸ªä»£ç åªå…è®¸ç”¨åœ¨è¿™æ ·çš„æƒ…å†µä¸‹æ‰èƒ½è¢«ä½¿ç”¨ï¼šç”¨æˆ·è¢«è®¤ä¸ºèƒ½å¤Ÿè§£å†³å†²çªï¼Œå¹¶ä¸”ä¼šé‡æ–°æäº¤æ–°çš„è¯·æ±‚ã€‚è¯¥å“åº”åº”å½“åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·å‘ç°å†²çªçš„æºå¤´ã€‚ å†²çªé€šå¸¸å‘ç”Ÿäºå¯¹ PUT è¯·æ±‚çš„å¤„ç†ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨é‡‡ç”¨ç‰ˆæœ¬æ£€æŸ¥çš„ç¯å¢ƒä¸‹ï¼ŒæŸæ¬¡ PUT æäº¤çš„å¯¹ç‰¹å®šèµ„æºçš„ä¿®æ”¹è¯·æ±‚æ‰€é™„å¸¦çš„ç‰ˆæœ¬ä¿¡æ¯ä¸ä¹‹å‰çš„æŸä¸ªï¼ˆç¬¬ä¸‰æ–¹ï¼‰è¯·æ±‚å‘å†²çªï¼Œé‚£ä¹ˆæ­¤æ—¶æœåŠ¡å™¨å°±åº”è¯¥è¿”å›ä¸€ä¸ª409é”™è¯¯ï¼Œå‘ŠçŸ¥ç”¨æˆ·è¯·æ±‚æ— æ³•å®Œæˆã€‚æ­¤æ—¶ï¼Œå“åº”å®ä½“ä¸­å¾ˆå¯èƒ½ä¼šåŒ…å«ä¸¤ä¸ªå†²çªç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚æ¯”è¾ƒï¼Œä»¥ä¾¿ç”¨æˆ·é‡æ–°æäº¤å½’å¹¶ä»¥åçš„æ–°ç‰ˆæœ¬ã€‚ 410 è¢«è¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šå·²ç»ä¸å†å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å·²çŸ¥çš„è½¬å‘åœ°å€ã€‚è¿™æ ·çš„çŠ¶å†µåº”å½“è¢«è®¤ä¸ºæ˜¯æ°¸ä¹…æ€§çš„ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“åœ¨è·å¾—ç”¨æˆ·è®¸å¯ååˆ é™¤æ‰€æœ‰æŒ‡å‘è¿™ä¸ªåœ°å€çš„å¼•ç”¨ã€‚å¦‚æœæœåŠ¡å™¨ä¸çŸ¥é“æˆ–è€…æ— æ³•ç¡®å®šè¿™ä¸ªçŠ¶å†µæ˜¯å¦æ˜¯æ°¸ä¹…çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨404çŠ¶æ€ç ã€‚é™¤éé¢å¤–è¯´æ˜ï¼Œå¦åˆ™è¿™ä¸ªå“åº”æ˜¯å¯ç¼“å­˜çš„ã€‚ 410å“åº”çš„ç›®çš„ä¸»è¦æ˜¯å¸®åŠ©ç½‘ç«™ç®¡ç†å‘˜ç»´æŠ¤ç½‘ç«™ï¼Œé€šçŸ¥ç”¨æˆ·è¯¥èµ„æºå·²ç»ä¸å†å¯ç”¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ‹¥æœ‰è€…å¸Œæœ›æ‰€æœ‰æŒ‡å‘è¿™ä¸ªèµ„æºçš„è¿œç«¯è¿æ¥ä¹Ÿè¢«åˆ é™¤ã€‚è¿™ç±»äº‹ä»¶åœ¨é™æ—¶ã€å¢å€¼æœåŠ¡ä¸­å¾ˆæ™®éã€‚åŒæ ·ï¼Œ410å“åº”ä¹Ÿè¢«ç”¨äºé€šçŸ¥å®¢æˆ·ç«¯åœ¨å½“å‰æœåŠ¡å™¨ç«™ç‚¹ä¸Šï¼ŒåŸæœ¬å±äºæŸä¸ªä¸ªäººçš„èµ„æºå·²ç»ä¸å†å¯ç”¨ã€‚å½“ç„¶ï¼Œæ˜¯å¦éœ€è¦æŠŠæ‰€æœ‰æ°¸ä¹…ä¸å¯ç”¨çš„èµ„æºæ ‡è®°ä¸ºâ€™410 Goneâ€™ï¼Œä»¥åŠæ˜¯å¦éœ€è¦ä¿æŒæ­¤æ ‡è®°å¤šé•¿æ—¶é—´ï¼Œå®Œå…¨å–å†³äºæœåŠ¡å™¨æ‹¥æœ‰è€…ã€‚ 411 æœåŠ¡å™¨æ‹’ç»åœ¨æ²¡æœ‰å®šä¹‰ Content-Length å¤´çš„æƒ…å†µä¸‹æ¥å—è¯·æ±‚ã€‚åœ¨æ·»åŠ äº†è¡¨æ˜è¯·æ±‚æ¶ˆæ¯ä½“é•¿åº¦çš„æœ‰æ•ˆ Content-Length å¤´ä¹‹åï¼Œå®¢æˆ·ç«¯å¯ä»¥å†æ¬¡æäº¤è¯¥è¯·æ±‚ã€‚ 412 æœåŠ¡å™¨åœ¨éªŒè¯åœ¨è¯·æ±‚çš„å¤´å­—æ®µä¸­ç»™å‡ºå…ˆå†³æ¡ä»¶æ—¶ï¼Œæ²¡èƒ½æ»¡è¶³å…¶ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªã€‚è¿™ä¸ªçŠ¶æ€ç å…è®¸å®¢æˆ·ç«¯åœ¨è·å–èµ„æºæ—¶åœ¨è¯·æ±‚çš„å…ƒä¿¡æ¯ï¼ˆè¯·æ±‚å¤´å­—æ®µæ•°æ®ï¼‰ä¸­è®¾ç½®å…ˆå†³æ¡ä»¶ï¼Œä»¥æ­¤é¿å…è¯¥è¯·æ±‚æ–¹æ³•è¢«åº”ç”¨åˆ°å…¶å¸Œæœ›çš„å†…å®¹ä»¥å¤–çš„èµ„æºä¸Šã€‚ 413 æœåŠ¡å™¨æ‹’ç»å¤„ç†å½“å‰è¯·æ±‚ï¼Œå› ä¸ºè¯¥è¯·æ±‚æäº¤çš„å®ä½“æ•°æ®å¤§å°è¶…è¿‡äº†æœåŠ¡å™¨æ„¿æ„æˆ–è€…èƒ½å¤Ÿå¤„ç†çš„èŒƒå›´ã€‚æ­¤ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯ä»¥å…³é—­è¿æ¥ä»¥å…å®¢æˆ·ç«¯ç»§ç»­å‘é€æ­¤è¯·æ±‚ã€‚ å¦‚æœè¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼ŒæœåŠ¡å™¨åº”å½“è¿”å›ä¸€ä¸ª Retry-After çš„å“åº”å¤´ï¼Œä»¥å‘ŠçŸ¥å®¢æˆ·ç«¯å¯ä»¥åœ¨å¤šå°‘æ—¶é—´ä»¥åé‡æ–°å°è¯•ã€‚ 414 è¯·æ±‚çš„URI é•¿åº¦è¶…è¿‡äº†æœåŠ¡å™¨èƒ½å¤Ÿè§£é‡Šçš„é•¿åº¦ï¼Œå› æ­¤æœåŠ¡å™¨æ‹’ç»å¯¹è¯¥è¯·æ±‚æä¾›æœåŠ¡ã€‚è¿™æ¯”è¾ƒå°‘è§ï¼Œé€šå¸¸çš„æƒ…å†µåŒ…æ‹¬ï¼š æœ¬åº”ä½¿ç”¨POSTæ–¹æ³•çš„è¡¨å•æäº¤å˜æˆäº†GETæ–¹æ³•ï¼Œå¯¼è‡´æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆQuery Stringï¼‰è¿‡é•¿ã€‚ é‡å®šå‘URI â€œé»‘æ´â€ï¼Œä¾‹å¦‚æ¯æ¬¡é‡å®šå‘æŠŠæ—§çš„ URI ä½œä¸ºæ–°çš„ URI çš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´åœ¨è‹¥å¹²æ¬¡é‡å®šå‘å URI è¶…é•¿ã€‚ å®¢æˆ·ç«¯æ­£åœ¨å°è¯•åˆ©ç”¨æŸäº›æœåŠ¡å™¨ä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´æ”»å‡»æœåŠ¡å™¨ã€‚è¿™ç±»æœåŠ¡å™¨ä½¿ç”¨å›ºå®šé•¿åº¦çš„ç¼“å†²è¯»å–æˆ–æ“ä½œè¯·æ±‚çš„ URIï¼Œå½“ GET åçš„å‚æ•°è¶…è¿‡æŸä¸ªæ•°å€¼åï¼Œå¯èƒ½ä¼šäº§ç”Ÿç¼“å†²åŒºæº¢å‡ºï¼Œå¯¼è‡´ä»»æ„ä»£ç è¢«æ‰§è¡Œ[1]ã€‚æ²¡æœ‰æ­¤ç±»æ¼æ´çš„æœåŠ¡å™¨ï¼Œåº”å½“è¿”å›414çŠ¶æ€ç ã€‚ 415 å¯¹äºå½“å‰è¯·æ±‚çš„æ–¹æ³•å’Œæ‰€è¯·æ±‚çš„èµ„æºï¼Œè¯·æ±‚ä¸­æäº¤çš„å®ä½“å¹¶ä¸æ˜¯æœåŠ¡å™¨ä¸­æ‰€æ”¯æŒçš„æ ¼å¼ï¼Œå› æ­¤è¯·æ±‚è¢«æ‹’ç»ã€‚ 416 å¦‚æœè¯·æ±‚ä¸­åŒ…å«äº† Range è¯·æ±‚å¤´ï¼Œå¹¶ä¸” Range ä¸­æŒ‡å®šçš„ä»»ä½•æ•°æ®èŒƒå›´éƒ½ä¸å½“å‰èµ„æºçš„å¯ç”¨èŒƒå›´ä¸é‡åˆï¼ŒåŒæ—¶è¯·æ±‚ä¸­åˆæ²¡æœ‰å®šä¹‰ If-Range è¯·æ±‚å¤´ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±åº”å½“è¿”å›416çŠ¶æ€ç ã€‚ å‡å¦‚ Range ä½¿ç”¨çš„æ˜¯å­—èŠ‚èŒƒå›´ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µå°±æ˜¯æŒ‡è¯·æ±‚æŒ‡å®šçš„æ‰€æœ‰æ•°æ®èŒƒå›´çš„é¦–å­—èŠ‚ä½ç½®éƒ½è¶…è¿‡äº†å½“å‰èµ„æºçš„é•¿åº¦ã€‚æœåŠ¡å™¨ä¹Ÿåº”å½“åœ¨è¿”å›416çŠ¶æ€ç çš„åŒæ—¶ï¼ŒåŒ…å«ä¸€ä¸ª Content-Range å®ä½“å¤´ï¼Œç”¨ä»¥æŒ‡æ˜å½“å‰èµ„æºçš„é•¿åº¦ã€‚è¿™ä¸ªå“åº”ä¹Ÿè¢«ç¦æ­¢ä½¿ç”¨ multipart/byteranges ä½œä¸ºå…¶ Content-Typeã€‚ 417 åœ¨è¯·æ±‚å¤´ Expect ä¸­æŒ‡å®šçš„é¢„æœŸå†…å®¹æ— æ³•è¢«æœåŠ¡å™¨æ»¡è¶³ï¼Œæˆ–è€…è¿™ä¸ªæœåŠ¡å™¨æ˜¯ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå®ƒæœ‰æ˜æ˜¾çš„è¯æ®è¯æ˜åœ¨å½“å‰è·¯ç”±çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒExpect çš„å†…å®¹æ— æ³•è¢«æ»¡è¶³ã€‚ 421 ä»å½“å‰å®¢æˆ·ç«¯æ‰€åœ¨çš„IPåœ°å€åˆ°æœåŠ¡å™¨çš„è¿æ¥æ•°è¶…è¿‡äº†æœåŠ¡å™¨è®¸å¯çš„æœ€å¤§èŒƒå›´ã€‚é€šå¸¸ï¼Œè¿™é‡Œçš„IPåœ°å€æŒ‡çš„æ˜¯ä»æœåŠ¡å™¨ä¸Šçœ‹åˆ°çš„å®¢æˆ·ç«¯åœ°å€ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ç½‘å…³æˆ–è€…ä»£ç†æœåŠ¡å™¨åœ°å€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥æ•°çš„è®¡ç®—å¯èƒ½æ¶‰åŠåˆ°ä¸æ­¢ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·ã€‚ 422 ä»å½“å‰å®¢æˆ·ç«¯æ‰€åœ¨çš„IPåœ°å€åˆ°æœåŠ¡å™¨çš„è¿æ¥æ•°è¶…è¿‡äº†æœåŠ¡å™¨è®¸å¯çš„æœ€å¤§èŒƒå›´ã€‚é€šå¸¸ï¼Œè¿™é‡Œçš„IPåœ°å€æŒ‡çš„æ˜¯ä»æœåŠ¡å™¨ä¸Šçœ‹åˆ°çš„å®¢æˆ·ç«¯åœ°å€ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ç½‘å…³æˆ–è€…ä»£ç†æœåŠ¡å™¨åœ°å€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥æ•°çš„è®¡ç®—å¯èƒ½æ¶‰åŠåˆ°ä¸æ­¢ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·ã€‚ 422 è¯·æ±‚æ ¼å¼æ­£ç¡®ï¼Œä½†æ˜¯ç”±äºå«æœ‰è¯­ä¹‰é”™è¯¯ï¼Œæ— æ³•å“åº”ã€‚ï¼ˆRFC 4918 WebDAVï¼‰423 Locked å½“å‰èµ„æºè¢«é”å®šã€‚ï¼ˆRFC 4918 WebDAVï¼‰ 424 ç”±äºä¹‹å‰çš„æŸä¸ªè¯·æ±‚å‘ç”Ÿçš„é”™è¯¯ï¼Œå¯¼è‡´å½“å‰è¯·æ±‚å¤±è´¥ï¼Œä¾‹å¦‚ PROPPATCHã€‚ï¼ˆRFC 4918 WebDAVï¼‰ 425 åœ¨WebDav Advanced Collections è‰æ¡ˆä¸­å®šä¹‰ï¼Œä½†æ˜¯æœªå‡ºç°åœ¨ã€ŠWebDAV é¡ºåºé›†åè®®ã€‹ï¼ˆRFC 3658ï¼‰ä¸­ã€‚ 426 å®¢æˆ·ç«¯åº”å½“åˆ‡æ¢åˆ°TLS/1.0ã€‚ï¼ˆRFC 2817ï¼‰ 449 ç”±å¾®è½¯æ‰©å±•ï¼Œä»£è¡¨è¯·æ±‚åº”å½“åœ¨æ‰§è¡Œå®Œé€‚å½“çš„æ“ä½œåè¿›è¡Œé‡è¯•ã€‚ 500 æœåŠ¡å™¨é‡åˆ°äº†ä¸€ä¸ªæœªæ›¾é¢„æ–™çš„çŠ¶å†µï¼Œå¯¼è‡´äº†å®ƒæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜éƒ½ä¼šåœ¨æœåŠ¡å™¨çš„ç¨‹åºç å‡ºé”™æ—¶å‡ºç°ã€‚ 501 æœåŠ¡å™¨ä¸æ”¯æŒå½“å‰è¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½ã€‚å½“æœåŠ¡å™¨æ— æ³•è¯†åˆ«è¯·æ±‚çš„æ–¹æ³•ï¼Œå¹¶ä¸”æ— æ³•æ”¯æŒå…¶å¯¹ä»»ä½•èµ„æºçš„è¯·æ±‚ã€‚ 502 ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°æ— æ•ˆçš„å“åº”ã€‚ 503 ç”±äºä¸´æ—¶çš„æœåŠ¡å™¨ç»´æŠ¤æˆ–è€…è¿‡è½½ï¼ŒæœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†è¯·æ±‚ã€‚è¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ä¸”å°†åœ¨ä¸€æ®µæ—¶é—´ä»¥åæ¢å¤ã€‚å¦‚æœèƒ½å¤Ÿé¢„è®¡å»¶è¿Ÿæ—¶é—´ï¼Œé‚£ä¹ˆå“åº”ä¸­å¯ä»¥åŒ…å«ä¸€ä¸ª Retry-After å¤´ç”¨ä»¥æ ‡æ˜è¿™ä¸ªå»¶è¿Ÿæ—¶é—´ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºè¿™ä¸ª Retry-After ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åº”å½“ä»¥å¤„ç†500å“åº”çš„æ–¹å¼å¤„ç†å®ƒã€‚ æ³¨æ„ï¼š503çŠ¶æ€ç çš„å­˜åœ¨å¹¶ä¸æ„å‘³ç€æœåŠ¡å™¨åœ¨è¿‡è½½çš„æ—¶å€™å¿…é¡»ä½¿ç”¨å®ƒã€‚æŸäº›æœåŠ¡å™¨åªä¸è¿‡æ˜¯å¸Œæœ›æ‹’ç»å®¢æˆ·ç«¯çš„è¿æ¥ã€‚ 504 ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨ï¼ˆURIæ ‡è¯†å‡ºçš„æœåŠ¡å™¨ï¼Œä¾‹å¦‚HTTPã€FTPã€LDAPï¼‰æˆ–è€…è¾…åŠ©æœåŠ¡å™¨ï¼ˆä¾‹å¦‚DNSï¼‰æ”¶åˆ°å“åº”ã€‚ æ³¨æ„ï¼šæŸäº›ä»£ç†æœåŠ¡å™¨åœ¨DNSæŸ¥è¯¢è¶…æ—¶æ—¶ä¼šè¿”å›400æˆ–è€…500é”™è¯¯ 505 æœåŠ¡å™¨ä¸æ”¯æŒï¼Œæˆ–è€…æ‹’ç»æ”¯æŒåœ¨è¯·æ±‚ä¸­ä½¿ç”¨çš„ HTTP ç‰ˆæœ¬ã€‚è¿™æš—ç¤ºç€æœåŠ¡å™¨ä¸èƒ½æˆ–ä¸æ„¿ä½¿ç”¨ä¸å®¢æˆ·ç«¯ç›¸åŒçš„ç‰ˆæœ¬ã€‚å“åº”ä¸­åº”å½“åŒ…å«ä¸€ä¸ªæè¿°äº†ä¸ºä½•ç‰ˆæœ¬ä¸è¢«æ”¯æŒä»¥åŠæœåŠ¡å™¨æ”¯æŒå“ªäº›åè®®çš„å®ä½“ã€‚ 506 ç”±ã€Šé€æ˜å†…å®¹åå•†åè®®ã€‹ï¼ˆRFC 2295ï¼‰æ‰©å±•ï¼Œä»£è¡¨æœåŠ¡å™¨å­˜åœ¨å†…éƒ¨é…ç½®é”™è¯¯ï¼šè¢«è¯·æ±‚çš„åå•†å˜å…ƒèµ„æºè¢«é…ç½®ä¸ºåœ¨é€æ˜å†…å®¹åå•†ä¸­ä½¿ç”¨è‡ªå·±ï¼Œå› æ­¤åœ¨ä¸€ä¸ªåå•†å¤„ç†ä¸­ä¸æ˜¯ä¸€ä¸ªåˆé€‚çš„é‡ç‚¹ã€‚ 507 æœåŠ¡å™¨æ— æ³•å­˜å‚¨å®Œæˆè¯·æ±‚æ‰€å¿…é¡»çš„å†…å®¹ã€‚è¿™ä¸ªçŠ¶å†µè¢«è®¤ä¸ºæ˜¯ä¸´æ—¶çš„ã€‚WebDAV (RFC 4918) 509 æœåŠ¡å™¨è¾¾åˆ°å¸¦å®½é™åˆ¶ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªå®˜æ–¹çš„çŠ¶æ€ç ï¼Œä½†æ˜¯ä»è¢«å¹¿æ³›ä½¿ç”¨ã€‚ 510 è·å–èµ„æºæ‰€éœ€è¦çš„ç­–ç•¥å¹¶æ²¡æœ‰æ²¡æ»¡è¶³ã€‚ï¼ˆRFC 2774ï¼‰","categories":[],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/tags/HTTP/"}]},{"title":"åè½¬é“¾è¡¨","slug":"åè½¬é“¾è¡¨","date":"2018-04-10T12:14:31.000Z","updated":"2018-04-12T05:27:41.953Z","comments":true,"path":"2018/04/10/åè½¬é“¾è¡¨/","link":"","permalink":"https://hsb786.github.io/2018/04/10/åè½¬é“¾è¡¨/","excerpt":"å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åçš„é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚","text":"å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åçš„é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738 /** * ç»´æŠ¤ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªæŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ * ç¼ºç‚¹ï¼Œéœ€è¦new å¯¹è±¡ï¼Œå ç”¨å†…å­˜ * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ7:44:22 */private static ListNode reverseList(ListNode head) &#123; ListNode result = new ListNode(head.data); ListNode t; while (head.next != null) &#123; t = result; result = new ListNode(head.next.data); result.next = t; head = head.next; &#125; return result;&#125;/** * @Description: éœ€è¦ç»´æŠ¤ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå½“å‰ï¼Œå‰ä¸€ä¸ªï¼Œä¸‹ä¸€ä¸ª * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ7:57:58 */private static ListNode reverseList2(ListNode head) &#123; ListNode result = null; ListNode t = head; ListNode preNode = null; while (t != null) &#123; ListNode nextNode = t.next; if (nextNode == null) &#123; result = t; &#125; t.next = preNode; preNode = t; t = nextNode; &#125; return result;&#125; æˆ–è€…ç›´æ¥ç”¨Stack","categories":[],"tags":[{"name":"å‰‘æŒ‡Offer","slug":"å‰‘æŒ‡Offer","permalink":"https://hsb786.github.io/tags/å‰‘æŒ‡Offer/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/tags/ç®—æ³•/"}]},{"title":"Spring","slug":"Spring","date":"2018-04-10T09:58:41.000Z","updated":"2018-04-15T10:45:05.730Z","comments":true,"path":"2018/04/10/Spring/","link":"","permalink":"https://hsb786.github.io/2018/04/10/Spring/","excerpt":"Springç»“æ„Springæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶åªæœ‰ä¸‰ä¸ªï¼šBeanï¼ŒContextï¼ŒCore","text":"Springç»“æ„Springæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶åªæœ‰ä¸‰ä¸ªï¼šBeanï¼ŒContextï¼ŒCore Springæ˜¯é¢å‘Beanç¼–ç¨‹ï¼Œè‡ªç„¶Beanç»„ä»¶å°±æ˜¯Springå¯¹Javaå¯¹è±¡Objectçš„å°è£…ï¼Œåœ¨Springå®¹å™¨ä¸­ç®¡ç†çš„å°±æ˜¯è¢«Beanå°è£…äº†çš„Javaå¯¹è±¡ã€‚ Contextç»„ä»¶å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„IOCå®¹å™¨ï¼Œä¹Ÿå°±æ˜¯Springå®¹å™¨ã€‚Contextç»„ä»¶å¯ä»¥å‘ç°æ¯ä¸ªBeanä¹‹é—´çš„å…³ç³»ï¼Œä¸ºå®ƒä»¬å»ºç«‹å¥½Beanä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¸ºBeanæä¾›ç”Ÿå­˜ç¯å¢ƒã€‚ Coreç»„ä»¶ï¼Œå®ƒæ˜¯Contextç»„ä»¶ä¸Beanç»„ä»¶çš„å·¥å…·åŒ…ï¼Œå¯ä»¥æŠŠCoreç»„ä»¶ç†è§£ä¸ºUtilå·¥å…·åŒ… æ€»ç»“æ¥è¯´ï¼ŒBeanç»„ä»¶è§£å†³Beançš„å®šä¹‰ï¼ŒBeançš„åˆ›å»ºä»¥åŠBeançš„è§£æï¼Œä¾‹å¦‚åœ¨Springé…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„èŠ‚ç‚¹ï¼ŒSpringä¼šè§£æå¾—åˆ°å¯¹åº”çš„BeanDefinitionå¯¹è±¡ã€‚Contextç»„ä»¶æä¾›äº†è¿™äº›Beançš„ç”Ÿå­˜ç¯å¢ƒï¼Œä¿å­˜å„ä¸ªBeançš„çŠ¶æ€ã€‚å®é™…ä¸ŠContextç»„ä»¶ç»“åˆBeanç»„ä»¶ï¼ŒCoreç»„ä»¶å…±åŒå»ºç«‹äº†ä¸€ä¸ªBeançš„å®¹å™¨ï¼Œå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦ä»‹ç»çš„IOCå®¹å™¨ã€‚ Springå®¹å™¨Springå®¹å™¨æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºIOCå®¹å™¨ã€‚IOC: Inverse of Controlï¼Œæ§åˆ¶åè½¬ã€‚æ§åˆ¶ï¼šæ§åˆ¶å°±æ˜¯è°ƒç”¨ç±»å¯¹æŸä¸€ä¸ªæ¥å£å…·ä½“å®ç°ç±»çš„é€‰æ‹©æ§åˆ¶æƒåè½¬ï¼šé€‰æ‹©æ§åˆ¶æƒäº¤ç»™ç¬¬ä¸‰æ–¹å†³å®šï¼Œç”±Springå®¹å™¨æ¥ç»Ÿä¸€é…ç½®ç®¡ç†Beanã€‚ ä¸ºäº†æ›´å¥½ç†è§£IOCï¼Œå¤§å®¶ç»å¸¸ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¥ä»£æ›¿æ§åˆ¶åè½¬è¿™ä¸ªæ¦‚å¿µï¼Œå³è®©è°ƒç”¨ç±»å¯¹æŸä¸€æ¥å£çš„å®ç°ç±»çš„ä¾èµ–å…³ç³»ç”±ç¬¬ä¸‰æ–¹å®¹å™¨æ³¨å…¥ï¼Œä»¥ç§»é™¤è°ƒç”¨ç±»å¯¹æŸä¸€æ¥å£å®ç°ç±»çš„ä¾èµ–ã€‚é‚£ä¹ˆIOCå®¹å™¨çš„å·¥ä½œå°±æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶å’Œæ³¨è§£æ¥æè¿°ç±»å’Œç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚åˆ©ç”¨åå°„æœºåˆ¶å®Œæˆç±»çš„åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥ã€‚ BeanFactoryå’ŒApplicationContextBeanFactoryæ˜¯Springæ¡†æ¶æ ¸å¿ƒæ¥å£ï¼Œæä¾›äº†IOCçš„é…ç½®æœºåˆ¶ï¼Œæ˜¯Springçš„åŸºç¡€è®¾æ–½ï¼Œé¢å‘Springæœ¬èº« ApplicationContextæ˜¯å»ºç«‹åœ¨BeanFactoryä¹‹ä¸Šï¼Œæä¾›äº†æ›´å¤šçš„é¢å‘åº”ç”¨çš„åŠŸèƒ½ï¼Œæ˜¯Springç»™å¼€å‘è€…æé«˜äº†IOCå®¹å™¨æ¥å£ Beançš„ç”Ÿå‘½å‘¨æœŸ å¦‚æœåœ¨é…ç½®æ–‡ä»¶ä¸­å£°æ˜äº†å·¥å‚åå¤„ç†å™¨æ¥å£BeanFactoryPostProcessorçš„å®ç°ç±»ï¼Œé‚£ä¹ˆåœ¨Springå®¹å™¨è£…è½½é…ç½®æ–‡ä»¶ä¹‹åï¼Œåˆå§‹åŒ–Beanå®ä¾‹ä¹‹å‰å°†è°ƒç”¨è¿™äº›BeanFactoryPostProcessorå¯¹é…ç½®ä¿¡æ¯è¿›è¡ŒåŠ å·¥å¤„ç†ã€‚ä¹Ÿå°±æ˜¯è¯´å·¥å‚åå¤„ç†å™¨æ˜¯å®¹å™¨çº§åˆ«çš„ï¼Œä»…åœ¨å®¹å™¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œå¯¹é…ç½®æ–‡ä»¶è¿›è¡ŒåŠ å·¥ å½“æˆ‘ä»¬é€šè¿‡getBean(String beanName)æ–¹æ³•å‘å®¹å™¨è¯·æ±‚æŸä¸ªBeanå®ä¾‹çš„æ—¶å€™ï¼Œå¦‚æœå®¹å™¨æ³¨å†Œäº†InstantiationAwareBeanPostProcessoræ¥å£çš„å®ç°ç±»ï¼Œé‚£ä¹ˆåœ¨å®ä¾‹åŒ–Beanä¹‹å‰ï¼Œå°†è°ƒç”¨è¯¥æ¥å£çš„postProcessBeforeInstantiation()æ–¹æ³• å®ä¾‹åŒ–Bean å¦‚æœå®¹å™¨æ³¨å†Œäº†InstantiationAwareBeanPostProcessoræ¥å£çš„å®ç°ç±»ï¼Œé‚£ä¹ˆåœ¨å®ä¾‹åŒ–Beanä¹‹åï¼Œå°†è°ƒç”¨è¯¥æ¥å£çš„postProcessAfterInstantiation()æ–¹æ³• å¦‚æœBeané…ç½®äº†å±æ€§ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¹å™¨åœ¨å°†å±æ€§å€¼é…ç½®åˆ°Beanä¸­ä¹‹å‰ï¼Œå°†è°ƒç”¨InstantiationAwareBeanPostProcessoræ¥å£çš„postProcessPropertyValues()æ–¹æ³• ä¸ºBeanè®¾ç½®å±æ€§å€¼ å¦‚æœBeanå®ç°äº†BeanNameAwareæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„setBeanName()æ–¹æ³•ï¼Œå°†é…ç½®æ–‡ä»¶ä¸­è¯¥Beanå¯¹åº”çš„åç§°è®¾ç½®åˆ°Beanä¸­ å¦‚æœBeanå®ç°äº†BeanFactoryAwareæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„setBeanFactory()æ–¹æ³•ï¼Œå°†BeanFactoryå®¹å™¨å®ä¾‹è®¾ç½®åˆ°Beanä¸­ å¦‚æœBeanå®ç°äº†ApplicationContextAwareæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„setApplicationContext()æ–¹æ³•ï¼Œå°†ApplicationContextå®¹å™¨å®ä¾‹è®¾ç½®åˆ°Beanä¸­ å¦‚æœBeanFactoryè£…é…äº†BeanPostProcessoræ¥å£çš„å®ç°ç±»ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥åå¤„ç†å™¨çš„postProcessBeforeInitialization(Object bean , String beanName)æ–¹æ³•å¯¹Beanè¿›è¡ŒåŠ å·¥ã€‚å…¶ä¸­ï¼Œå…¥å‚beanæ˜¯å½“å‰æ­£åœ¨å¤„ç†çš„Beanï¼Œè€ŒbeanNameæ˜¯å½“å‰Beançš„é…ç½®åã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡æ”¹æ–¹æ³•å¯¹Beanè¿›è¡Œç‰¹æ®Šçš„æ”¹é€ ï¼Œä¾‹å¦‚Springæä¾›çš„AOPåŠŸèƒ½å°±åˆ©ç”¨BeanPostPrecessoræ¥å®ç° å¦‚æœBeanå®ç°äº†InitializingBeanæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„afterPropertiesSet()æ–¹æ³• å¦‚æœåœ¨ä¸­é€šè¿‡init-methodå±æ€§å®šä¹‰äº†åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œè¿™ä¸ªæ–¹æ³• è¿™æ˜¯å·¥å‚åå¤„ç†å™¨BeanPostProcessoræ¥å£å®šä¹‰çš„ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•åœ¨ç¬¬10æ­¥æ‰§è¡Œäº†ï¼Œè¯¥æ¥å£çš„postProcessAfterInitialization(Object bean , String beanName)æ–¹æ³•ç»™å®¹å™¨æä¾›äº†å†æ¬¡å¯¹Beanè¿›è¡ŒåŠ å·¥çš„æœºä¼š å¦‚æœåœ¨ä¸­é…ç½®çš„Beançš„ä½œç”¨èŒƒå›´æ˜¯scope=â€œprototypeâ€ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†è¯¥Beanå®ä¾‹è¿”å›ç»™è°ƒç”¨è€…ï¼Œè¿™äº›Beanå®ä¾‹ä¸å†ç”±Springå®¹å™¨ç®¡ç†ã€‚å¦‚æœscope=â€œsingletonâ€ï¼Œé‚£ä¹ˆå°±ç¼“å­˜è¯¥Beanå®ä¾‹ï¼Œå†è¿”å›ç»™è°ƒç”¨è€…ï¼ŒåŒæ—¶Springå®¹å™¨å°†ç»§ç»­ç®¡ç†ç¼“å­˜æ± ä¸­çš„Beanå®ä¾‹ å¯¹äºscope=â€œsingletonâ€(é»˜è®¤æƒ…å†µ)çš„Beanï¼Œå½“å®¹å™¨å…³é—­çš„æ—¶å€™ï¼Œå¦‚æœBeanå®ç°äº†DisposableBeanæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„destroy()æ–¹æ³• å¯¹äºscope=â€œsingletonâ€(é»˜è®¤æƒ…å†µ)çš„Beanï¼Œå¦‚æœé€šè¿‡destroy-methodå±æ€§é…ç½®çš„é”€æ¯æ–¹æ³•ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ–¹æ³• ä¸Šè¿°16æ­¥æè¿°äº†ApplicationContextç®¡ç†çš„Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œå…¶ä¸­çš„æ¯ä¸€æ­¥éƒ½è°ƒç”¨äº†ç›¸å…³çš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ï¼š Beanè‡ªèº«çš„æ–¹æ³•ï¼šBeançš„æ„é€ å‡½æ•°ï¼ŒBeançš„Setteræ–¹æ³•ï¼Œä»¥åŠinit-methodå’Œdestroy-methodæ–¹æ³• Beançº§ç”Ÿå‘½å‘¨æœŸæ¥å£æ–¹æ³•ï¼šè¿™äº›æ–¹æ³•æ˜¯Springå®¹å™¨è§„å®šçš„ï¼Œç”±Beanå®ç°çš„æ–¹æ³•ï¼Œä¾‹å¦‚BeanNameAwareæ¥å£ï¼ŒBeanFactoryAwareæ¥å£ï¼ŒApplicationContextAwareæ¥å£ï¼ŒInitializingBeanæ¥å£ï¼ŒDisposableBeanæ¥å£ å®¹å™¨çº§ç”Ÿå‘½å‘¨æœŸæ¥å£æ–¹æ³•ï¼šè¿™äº›æ–¹æ³•æ˜¯å®¹å™¨æ¥é…ç½®å®ç°ç±»çš„ï¼Œæ— éœ€Beanæ¥å®ç°ï¼Œåœ¨æµç¨‹å›¾ä¸­ç”¨é»‘ç‚¹æ ‡è¯†çš„æ–¹æ³•ã€‚ç”±äºæ˜¯å®¹å™¨çº§åˆ«çš„åå¤„ç†å™¨ï¼Œè¿™äº›æ–¹æ³•å¯¹å®¹å™¨ä¸­æ‰€æœ‰çš„Beanéƒ½èµ·ä½œç”¨ã€‚ åœ¨ApplicationContextä¸­ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é€šè¿‡å®šä¹‰å·¥å‚åå¤„ç†å™¨å’ŒBeanåå¤„ç†å™¨ï¼Œå®¹å™¨å°±ä¼šæŒ‰ç…§é¢„å®šçš„æœºåˆ¶è¿è¡Œã€‚ä»¥ä¸Šå°±æ˜¯Springå®¹å™¨ä¸­ç®¡ç†çš„Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸æ˜¯æ¯ä¸€æ­¥éƒ½åœ¨å®é™…ä¸­ç”¨åˆ°ï¼Œä½†æ˜¯è¿™äº›ç”Ÿå‘½å‘¨æœŸä½“ç°äº†Springå®¹å™¨å¯¹Beançš„ç®¡ç†ç†å¿µï¼Œæä¾›ç»™å¼€å‘è€…è¶³å¤Ÿçš„ç©ºé—´æ¥è‡ªå·±æ§åˆ¶Beanã€‚ FactoryBeanå¦‚æœæŸäº›Beançš„å®ä¾‹åŒ–è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœæŒ‰ç…§XMLæˆ–è€…æ³¨è§£æ¥é…ç½®çš„è¯éœ€è¦å¤§é‡çš„é…ç½®ä¿¡æ¯ï¼Œå¹¶ä¸”çµæ´»æ€§ä¹Ÿå—é™åˆ¶ã€‚Springä¸ºäº†è§£å†³è¿™ä¸€æƒ…å†µï¼Œæä¾›äº†FactoryBeanï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°è¯¥å·¥å‚æ¥å£æ¥å®šåˆ¶å®ä¾‹åŒ–Beançš„é€»è¾‘ã€‚FactoryBeanæ¥å£å®šä¹‰äº†3ä¸ªæ–¹æ³•ï¼š T getObject():è¿”å›ç”±FactoryBeanåˆ›å»ºçš„Beançš„å®ä¾‹ã€‚ boolean isSingleton():ç”±FactoryBeanåˆ›å»ºçš„Beanæ˜¯Singletonè¿˜æ˜¯prototype Class&lt;?&gt; getObjectType():è¿”å›FactoryBeanåˆ›å»ºçš„Beançš„ç±»å‹ å½“é…ç½®æ–‡ä»¶ä¸­çš„ç±»å‹æ˜¯FactoryBeanæ—¶ï¼Œå®¹å™¨é€šè¿‡getBean()æ–¹æ³•è¿”å›çš„ä¸æ˜¯FactoryBeanæœ¬èº«ï¼Œè€Œæ˜¯FactoryBean.getObject()æ–¹æ³•æ‰€è¿”å›çš„å¯¹è±¡ã€‚Springæä¾›äº†FactoryBeanæ¥å£ç»™æˆ‘ä»¬æä¾›äº†è‡ªå®šä¹‰å®ä¾‹åŒ–Beançš„æ–¹æ³•ï¼Œåœ¨æŸäº›å¤æ‚çš„æƒ…å†µä¸‹å¾ˆæœ‰ç”¨å¤„ã€‚ Springä¸­ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼ å·¥å‚æ¨¡å¼:IOCå®¹å™¨ ä»£ç†æ¨¡å¼:AOP ç­–ç•¥æ¨¡å¼:åœ¨springé‡‡å–åŠ¨æ€ä»£ç†æ—¶ï¼Œæ ¹æ®ä»£ç†çš„ç±»æœ‰æ— å®ç°æ¥å£æœ‰JDKå’ŒCGLIBä¸¤ç§ä»£ç†æ–¹å¼ï¼Œå°±æ˜¯é‡‡ç”¨ç­–ç•¥æ¨¡å¼å®ç°çš„ å•ä¾‹æ¨¡å¼:é»˜è®¤æƒ…å†µä¸‹springä¸­çš„beanåªå­˜åœ¨ä¸€ä¸ªå®ä¾‹ Spring IoCå’ŒAOPIoCçš„æ ¸å¿ƒæ˜¯ä¾èµ–åè½¬ï¼Œå°†åˆ›å»ºå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„ä¾èµ–ç®¡ç†äº¤ç»™IoCå®¹å™¨æ¥åšï¼Œå®Œæˆå¯¹è±¡ä¹‹é—´çš„è§£è€¦ã€‚ AOPä¸»è¦æ˜¯åˆ©ç”¨ä»£ç†æ¨¡å¼ï¼ŒæŠŠè®¸å¤šæ¥å£éƒ½è¦ç”¨çš„åˆå’Œæ¥å£æœ¬èº«ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘æ— å…³çš„éƒ¨åˆ†æŠ½å‡ºæ¥ï¼Œå†™æˆä¸€ä¸ªåˆ‡é¢ï¼Œå•ç‹¬ç»´æŠ¤ï¼Œæ¯”å¦‚æƒé™éªŒè¯ã€‚è¿™æ ·å¯ä»¥ä½¿æ¥å£ç¬¦åˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œåªå…³æ³¨ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿæé«˜äº†ä»£ç çš„é‡ç”¨æ€§ã€‚ å‚è€ƒ Springå®¹å™¨â€”â€”é¢å‘Beanç¼–ç¨‹ é¢è¯•æ€»ç»“","categories":[],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"}]},{"title":"æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—","slug":"æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—","date":"2018-04-10T08:11:33.000Z","updated":"2018-04-12T05:27:51.508Z","comments":true,"path":"2018/04/10/æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—/","link":"","permalink":"https://hsb786.github.io/2018/04/10/æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—/","excerpt":"æŠŠä¸€ä¸ªæ•°ç»„æœ€å¼€å§‹çš„è‹¥å¹²ä¸ªå…ƒç´ æ¬åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ•°ç»„çš„æ—‹è½¬ã€‚è¾“å…¥ä¸€ä¸ªé€’å¢æ’åºæ•°ç»„çš„ä¸€ä¸ªæ—‹è½¬ï¼Œè¾“å‡ºæ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´ ã€‚","text":"æŠŠä¸€ä¸ªæ•°ç»„æœ€å¼€å§‹çš„è‹¥å¹²ä¸ªå…ƒç´ æ¬åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ•°ç»„çš„æ—‹è½¬ã€‚è¾“å…¥ä¸€ä¸ªé€’å¢æ’åºæ•°ç»„çš„ä¸€ä¸ªæ—‹è½¬ï¼Œè¾“å‡ºæ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´ ã€‚æ—‹è½¬æ•°ç»„çš„ç‰¹ç‚¹ï¼š æ—‹è½¬ä¹‹åçš„æ•°ç»„å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªæ’åºçš„å­æ•°ç»„ï¼Œä¸”å‰é¢çš„å­æ•°ç»„çš„å…ƒç´ éƒ½å¤§äºæˆ–ç­‰äºåé¢å­æ•°ç»„çš„å…ƒç´ ã€‚ æœ€å°æˆ–è€…æœ€å¤§å…ƒç´ ä½äºä¸¤ä¸ªå­æ•°ç»„çš„åˆ†ç•Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657/** * ç”±äºæ—‹è½¬æ•°ç»„çš„ç‰¹ç‚¹ï¼Œå‰ä¸€ä¸ªæ•°ç»„ä¸€å®šå¤§äºåä¸€ä¸ªæ•°ç»„ã€‚æ•°ç»„å†…éƒ¨æ˜¯å‡åºçš„ã€‚ * æ‰€ä»¥å°±å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚ * å®šä¹‰minIndexä¸º0ï¼ŒhighIndexä¸ºlength-1 * è‹¥ä¸­é—´ä½å¤§äºarray[minIndex]ï¼Œåˆ™ä»£è¡¨ä¸­é—´ä½å¤„äºå‰é¢éƒ¨åˆ†,å°†minIndexè®¾ä¸ºmidIndexï¼› * å°äºåˆ™å¤„äºåé¢éƒ¨åˆ†,å°†highIndexè®¾ä¸ºmidIndex * æœ€ç»ˆminIndexä½äºå‰ä¸€ä¸ªæ•°ç»„çš„æœ€åä¸€ä½ï¼ŒhighIndexä½äºåä¸€ä¸ªæ•°ç»„çš„ç¬¬ä¸€ä½ * æ˜¾ç„¶æœ€å°å€¼å°±æ˜¯highIndexæ‰€åœ¨çš„å€¼ã€‚ * ç‰¹æ®Šæƒ…å†µï¼Œä½†minIndexä¸highIndexä¸Šçš„å€¼ç›¸ç­‰æ—¶ï¼Œæ— æ³•åˆ¤æ–­ä¸­é—´å€¼æ˜¯åœ¨å‰ï¼Œè¿˜æ˜¯åœ¨åã€‚ * æ‰€ä»¥åªèƒ½ç”¨é¡ºåºæŸ¥æ‰¾ * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ2:56:26 */public static int findMin(int[] array) &#123; int lowIndex = 0; int highIndex = array.length - 1; int midIndex = (lowIndex + highIndex) / 2; // å½“ä»£æŸ¥æ‰¾æ•°ç»„ç¬¬ä¸€ä½å¤§äºæœ€åä¸€ä½æ—¶ï¼Œä»£è¡¨æ˜¯æ—‹è½¬æ•°ç»„ while (array[lowIndex] &gt;= array[highIndex]) &#123; // ä¸´ç•Œæ¡ä»¶ å‰é¢æœ€åä¸€ä½ï¼Œåé¢ç¬¬ä¸€ä½ã€‚ åé¢ç¬¬ä¸€ä½å°±æ˜¯æœ€å°å€¼ if (highIndex - lowIndex == 1) &#123; return array[highIndex]; &#125; // å½“å·¦ä¸‹æ ‡çš„å…ƒç´ ç­‰äºå³ä¸‹æ ‡çš„å…ƒç´ æ—¶ï¼Œæ— æ³•åˆ¤æ–­ä¸­é—´ä½æ˜¯ä½äºå‰é¢è¿˜æ˜¯åé¢çš„ã€‚ // åªèƒ½ç”¨é¡ºåºæŸ¥æ‰¾ if (array[lowIndex] == array[highIndex]) &#123; return findMinInOrder(array, lowIndex, highIndex); &#125; // å½“ä¸­é—´ä½å¤§äºå‰é¢ç¬¬ä¸€ä½æ—¶ï¼Œä»£è¡¨å¤„äºå‰é¢ if (array[midIndex] &gt; array[lowIndex]) &#123; lowIndex = midIndex; &#125; else &#123; // å¦åˆ™å¤„äºåé¢ highIndex = midIndex; &#125; // è®¡ç®—ä¸­é—´ä½ midIndex = (lowIndex + highIndex) / 2; &#125; //å·²æ’å¥½åºï¼Œè¿”å›ä½ä½å³å¯ return array[lowIndex];&#125;/** * @Description: å½“æœ‰é‡å¤å…ƒç´ çš„æ—¶å€™ï¼Œæ— æ³•ç¡®å®šä¸­é—´çš„å…ƒç´ æ˜¯å‰é¢çš„è¿˜æ˜¯åé¢çš„ * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ2:33:52 */private static int findMinInOrder(int[] array, int lowIndex, int highIndex) &#123; int result = array[lowIndex]; for (int i = lowIndex + 1; i &lt;= highIndex; i++) &#123; if (result &gt; array[i]) &#123; result = array[i]; &#125; &#125; return result;&#125;","categories":[],"tags":[{"name":"å‰‘æŒ‡Offer","slug":"å‰‘æŒ‡Offer","permalink":"https://hsb786.github.io/tags/å‰‘æŒ‡Offer/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/tags/ç®—æ³•/"}]},{"title":"ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ","slug":"ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ","date":"2018-04-10T08:11:19.000Z","updated":"2018-04-12T05:28:03.670Z","comments":true,"path":"2018/04/10/ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ/","link":"","permalink":"https://hsb786.github.io/2018/04/10/ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ/","excerpt":"ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ","text":"ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ123456789101112131415161718192021222324252627282930313233343536373839404142/** * Queueæ–¹æ³•: * offer() æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›false * pool() ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼Œæ— åˆ™è¿”å›null * peek() è¿”å›å¤´éƒ¨å…ƒç´  æ— åˆ™è¿”å›null */private static Queue&lt;Object&gt; queue1 = new LinkedList&lt;&gt;();private static Queue&lt;Object&gt; queue2 = new LinkedList&lt;&gt;();private static void push(Object obj) &#123; if (!queue1.isEmpty()) &#123; queue1.offer(obj); &#125; else &#123; queue2.offer(obj); &#125; System.out.println(&quot;å…¥æ ˆ:&quot; + obj);&#125;/** * å°†ä¸€ä¸ªé˜Ÿåˆ—é‡Œçš„æ•°æ®éƒ½å‰ªåˆ‡ç»™å¦ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œåªä¿ç•™æœ€åä¸€ä½ã€‚ * è¿™æ ·å¼¹å‡ºçš„æ•°æ®å°±æ˜¯æ ˆå°¾æ•°æ® * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ1:55:11 */private static void pop() &#123; if (queue1.isEmpty() &amp;&amp; queue2.isEmpty()) &#123; System.out.println(&quot;æ ˆé‡Œæ²¡æœ‰æ•°æ®&quot;); return; &#125; if (queue1.isEmpty()) &#123; while (queue2.size() &gt; 1) &#123; queue1.offer(queue2.poll()); &#125; System.out.println(&quot;å‡ºæ ˆ:&quot; + queue2.poll()); return; &#125; while (queue1.size() &gt; 1) &#123; queue2.offer(queue1.poll()); &#125; System.out.println(&quot;å‡ºæ ˆ:&quot; + queue1.poll());&#125;","categories":[],"tags":[{"name":"å‰‘æŒ‡Offer","slug":"å‰‘æŒ‡Offer","permalink":"https://hsb786.github.io/tags/å‰‘æŒ‡Offer/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/tags/ç®—æ³•/"}]},{"title":"ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—","slug":"ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—","date":"2018-04-10T08:10:52.000Z","updated":"2018-04-12T05:27:59.328Z","comments":true,"path":"2018/04/10/ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—/","link":"","permalink":"https://hsb786.github.io/2018/04/10/ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—/","excerpt":"ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼šè¯·å®ç°ä»–çš„ä¸¤ä¸ªå‡½æ•°appendTailå’ŒdeleteHead,åˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥èŠ‚ç‚¹å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤èŠ‚ç‚¹çš„åŠŸèƒ½ã€‚","text":"ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼šè¯·å®ç°ä»–çš„ä¸¤ä¸ªå‡½æ•°appendTailå’ŒdeleteHead,åˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥èŠ‚ç‚¹å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤èŠ‚ç‚¹çš„åŠŸèƒ½ã€‚1234567891011121314151617181920212223242526272829private static Stack&lt;Object&gt; stack1 = new Stack&lt;Object&gt;();private static Stack&lt;Object&gt; stack2 = new Stack&lt;Object&gt;();/** * stack1ç”¨æ¥å­˜æ”¾å‹å…¥çš„å…ƒç´  * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ1:19:07 */public static void appendTail(Object item) &#123; stack1.push(item);&#125;public static void deleteHead() &#123; //å½“stack2ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥å¼¹å‡º if (!stack2.isEmpty()) &#123; System.out.println(&quot;æ ˆé¡¶:&quot; + stack2.pop()); return; &#125; else &#123; //stack2å‹å…¥stack1å¼¹å‡ºçš„æ•°æ®,è¿™æ ·stack2å°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ— while (!stack1.isEmpty()) &#123; stack2.push(stack1.pop()); &#125; &#125; if (!stack2.isEmpty()) &#123; System.out.println(&quot;æ ˆé¡¶:&quot; + stack2.pop()); &#125; else &#123; System.out.println(&quot;æ ˆä¸­æ²¡æœ‰å…ƒç´ &quot;); &#125;&#125;","categories":[],"tags":[{"name":"å‰‘æŒ‡Offer","slug":"å‰‘æŒ‡Offer","permalink":"https://hsb786.github.io/tags/å‰‘æŒ‡Offer/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/tags/ç®—æ³•/"}]},{"title":"äºŒç»´æ•°ç»„çš„æŸ¥æ‰¾","slug":"äºŒç»´æ•°ç»„çš„æŸ¥æ‰¾","date":"2018-04-10T04:01:22.000Z","updated":"2018-04-12T05:26:43.517Z","comments":true,"path":"2018/04/10/äºŒç»´æ•°ç»„çš„æŸ¥æ‰¾/","link":"","permalink":"https://hsb786.github.io/2018/04/10/äºŒç»´æ•°ç»„çš„æŸ¥æ‰¾/","excerpt":"åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚","text":"åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚12345678910111213141516171819202122/** * ä»å·¦ä¸‹è§’å¼€å§‹æ¯”ï¼ŒæŸ¥æ‰¾çš„æ•°å­—å¤§äºéå†å€¼å³ç§»ï¼›æŸ¥æ‰¾çš„æ•°å­—å°äºéå†å€¼ä¸Šç§» * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸Šåˆ11:55:27 */public static boolean find(int targer, int[][] array) &#123; int rows = array.length; int columns = array[0].length; int i = rows - 1, j = 0; while (targer != array[i][j]) &#123; if (targer &gt; array[i][j]) &#123; j++; &#125; else &#123; i--; &#125; if (i &lt; 0 || j &lt; 0 || i &gt; rows || j &gt; columns) &#123; return false; &#125; &#125; return true;&#125;","categories":[],"tags":[{"name":"å‰‘æŒ‡Offer","slug":"å‰‘æŒ‡Offer","permalink":"https://hsb786.github.io/tags/å‰‘æŒ‡Offer/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/tags/ç®—æ³•/"}]},{"title":"çº¿ç¨‹æ± ","slug":"çº¿ç¨‹æ± ","date":"2018-04-10T02:13:01.000Z","updated":"2018-04-15T12:12:25.244Z","comments":true,"path":"2018/04/10/çº¿ç¨‹æ± /","link":"","permalink":"https://hsb786.github.io/2018/04/10/çº¿ç¨‹æ± /","excerpt":"Executoræ¡†æ¶Exexutoræ¡†æ¶æ˜¯ä¸€ä¸ªæ ¹æ®ä¸€ç»„æ‰§è¡Œç­–ç•¥è°ƒç”¨ï¼Œè°ƒåº¦ï¼Œæ‰§è¡Œå’Œæ§åˆ¶çš„å¼‚æ­¥ä»»åŠ¡çš„æ¡†æ¶ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶çº¿ç¨‹çš„å¯åŠ¨ã€æ‰§è¡Œå’Œå…³é—­ï¼Œå¯ä»¥ç®€åŒ–å¹¶å‘ç¼–ç¨‹çš„æ“ä½œã€‚æ— é™åˆ¶çš„åˆ›å»ºçº¿ç¨‹ä¼šå¼•èµ·åº”ç”¨ç¨‹åºå†…å­˜æº¢å‡ºã€‚æ‰€ä»¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± æ˜¯ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå¯ä»¥é™åˆ¶çº¿ç¨‹çš„æ•°é‡å¹¶ä¸”å¯ä»¥å›æ”¶å†åˆ©ç”¨è¿™äº›çº¿ç¨‹ã€‚Executoræ¡†æ¶åŒ…æ‹¬ï¼šçº¿ç¨‹æ± ã€Executorã€Exexutorsã€ExecutorServiceã€CompletionServiceã€Futureã€Callableç­‰ã€‚","text":"Executoræ¡†æ¶Exexutoræ¡†æ¶æ˜¯ä¸€ä¸ªæ ¹æ®ä¸€ç»„æ‰§è¡Œç­–ç•¥è°ƒç”¨ï¼Œè°ƒåº¦ï¼Œæ‰§è¡Œå’Œæ§åˆ¶çš„å¼‚æ­¥ä»»åŠ¡çš„æ¡†æ¶ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶çº¿ç¨‹çš„å¯åŠ¨ã€æ‰§è¡Œå’Œå…³é—­ï¼Œå¯ä»¥ç®€åŒ–å¹¶å‘ç¼–ç¨‹çš„æ“ä½œã€‚æ— é™åˆ¶çš„åˆ›å»ºçº¿ç¨‹ä¼šå¼•èµ·åº”ç”¨ç¨‹åºå†…å­˜æº¢å‡ºã€‚æ‰€ä»¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± æ˜¯ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå¯ä»¥é™åˆ¶çº¿ç¨‹çš„æ•°é‡å¹¶ä¸”å¯ä»¥å›æ”¶å†åˆ©ç”¨è¿™äº›çº¿ç¨‹ã€‚Executoræ¡†æ¶åŒ…æ‹¬ï¼šçº¿ç¨‹æ± ã€Executorã€Exexutorsã€ExecutorServiceã€CompletionServiceã€Futureã€Callableç­‰ã€‚ å…³äºCallableå’ŒFutureCallableæ¥å£ä½¿ç”¨æ³›å‹å»å®šä¹‰å®ƒçš„è¿”å›ç±»å‹ã€‚Executorsç±»æä¾›äº†ä¸€äº›æœ‰ç”¨çš„æ–¹æ³•å»åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡ŒCallableå†…çš„ä»»åŠ¡ã€‚ç”±äºCallableä»»åŠ¡æ˜¯å¹¶è¡Œçš„ï¼Œæˆ‘ä»¬å¿…é¡»ç­‰å¾…å®ƒè¿”å›çš„ç»“æœã€‚java.util.concurrent.Futureå¯¹è±¡ä¸ºæˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åœ¨çº¿ç¨‹æ± æäº¤Callableä»»åŠ¡åè¿”å›äº†ä¸€ä¸ªFutureå¯¹è±¡ï¼Œä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»¥çŸ¥é“Callableä»»åŠ¡çš„çŠ¶æ€å’Œå¾—åˆ°Callableè¿”å›çš„æ‰§è¡Œç»“æœã€‚Futureæä¾›äº†get()æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥ç­‰å¾…Callableç»“æŸå¹¶è·å–å®ƒçš„æ‰§è¡Œç»“æœã€‚ Futureæä¾›äº†ä¸‰ç§åŠŸèƒ½ï¼š åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å®Œæˆ èƒ½å¤Ÿä¸­æ–­ä»»åŠ¡ èƒ½å¤Ÿè·å–æ‰§è¡Œç»“æœ Futureå¯¹è±¡æä¾›äº†å¼‚æ­¥æ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ— éœ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œçš„å®Œæˆï¼Œåªè¦æäº¤éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶åå†éœ€è¦æ—¶æ£€æŸ¥Futureæ˜¯å¦å·²ç»æœ‰äº†ç»“æœï¼Œå¦‚æœä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡Future.get()æ–¹æ³•è·å¾—æ‰§è¡Œç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒFuture.get()æ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡å¼çš„æ–¹æ³•ï¼Œå¦‚æœè°ƒç”¨æ—¶ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œä¼šç­‰å¾…ç›´åˆ°ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚ FutureTask123456789public class FutureTask&lt;V&gt; implements RunnableFuture&lt;V&gt; public interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; &#123; /** * Sets this Future to the result of its computation * unless it has been cancelled. */ void run();&#125; FutureTaskæ—¢å¯ä»¥åšä¸ºRunnableè¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸ºFutureå¾—åˆ°Callableçš„è¿”å›å€¼ ThreadPoolExecutor å‚æ•° è¯´æ˜ corePoolSize çº¿ç¨‹æ± ä¸­æ ¸å¿ƒçº¿ç¨‹æ•°é‡ maximumPoolSize çº¿ç¨‹æ± ä¸­æœ€å¤§çº¿ç¨‹æ•°é‡ keepAliveTime éæ ¸å¿ƒçº¿ç¨‹å­˜æ´»æ—¶é—´ unit keepAliveTimeçš„æ—¶é—´å•ä½ workQueue å­˜æ”¾ä»»åŠ¡çš„é˜Ÿåˆ— threadFactory ç”¨æ¥ç”Ÿäº§çº¿ç¨‹çš„å·¥å‚ handler å½“çº¿ç¨‹æ± ä¸­ä¸èƒ½å†æ”¾å…¥ä»»åŠ¡æ—¶æ‰§è¡Œçš„handler ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± ä¹‹åçš„å¤„ç†ç­–ç•¥ï¼š å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®å°äºcorePoolSizeï¼Œåˆ™æ¯æ¥ä¸€ä¸ªä»»åŠ¡ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼› å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®&gt;=corePoolSizeï¼Œåˆ™æ¯æ¥ä¸€ä¸ªä»»åŠ¡ï¼Œå°è¯•å°†å…¶æ·»åŠ åˆ°ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å½“ä¸­ï¼Œè‹¥æ·»åŠ æˆåŠŸï¼Œåˆ™è¯¥ä»»åŠ¡ä¼šç­‰å¾…ç©ºé—²çº¿ç¨‹å°†å…¶å–å‡ºæ¥æ‰§è¡Œï¼›è‹¥æ·»åŠ å¤±è´¥ï¼ˆä¸€èˆ¬æ¥è¯´æ˜¯ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å·²æ»¡ï¼‰ï¼Œåˆ™ä¼šå°è¯•åˆ›å»ºæ–°çš„çº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ°maximumPoolSizeï¼Œåˆ™ä¼šé‡‡å–ä»»åŠ¡æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ï¼› å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äºcorePoolSizeæ—¶ï¼Œå¦‚æœæŸçº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡keepAliveTimeï¼Œçº¿ç¨‹å°†è¢«ç»ˆæ­¢ï¼Œç›´è‡³çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®ä¸å¤§äºcorePoolSizeï¼›å¦‚æœå…è®¸ä¸ºæ ¸å¿ƒæ± ä¸­çš„çº¿ç¨‹è®¾ç½®å­˜æ´»æ—¶é—´ï¼Œé‚£ä¹ˆæ ¸å¿ƒæ± ä¸­çš„çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡KeepAliveTimeï¼Œçº¿ç¨‹ä¹Ÿä¼šè¢«ç»ˆæ­¢ é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºçº¿ç¨‹æ± ä¹‹åï¼Œçº¿ç¨‹æ± ä¸­æ˜¯æ²¡æœ‰çº¿ç¨‹çš„ï¼Œéœ€è¦æäº¤ä»»åŠ¡ä¹‹åæ‰ä¼šåˆ›å»ºçº¿ç¨‹ã€‚åœ¨å®é™…ä¸­å¦‚æœéœ€è¦çº¿ç¨‹æ± åˆ›å»ºä¹‹åç«‹å³åˆ›å»ºçº¿ç¨‹ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•åŠåˆ°ï¼š prestartCoreThread()ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼› prestartAllCoreThreads()ï¼šåˆå§‹åŒ–æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹ ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—åŠæ’é˜Ÿç­–ç•¥workQueueï¼Œå®ƒç”¨æ¥å­˜æ”¾ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚workQueueçš„ç±»å‹ä¸ºBlockingQueueï¼Œé€šå¸¸å¯ä»¥å–ä¸‹é¢ä¸‰ç§ç±»å‹ï¼š ArrayBlockingQueueï¼šåŸºäºæ•°ç»„çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—åˆ›å»ºæ—¶å¿…é¡»æŒ‡å®šå¤§å° LinkedBlockingQueueï¼šåŸºäºé“¾è¡¨çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼Œå¦‚æœåˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šæ­¤é˜Ÿåˆ—å¤§å°ï¼Œåˆ™é»˜è®¤ä¸ºInteger.MAX_VALUE synchronousQueueï¼šè¿™ä¸ªé˜Ÿåˆ—æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä¸ä¼šä¿å­˜æäº¤çš„ä»»åŠ¡ï¼Œè€Œæ˜¯å°†ç›´æ¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æ¥çš„ä»»åŠ¡ ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚ æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ é”ä¼˜åŒ– å‡å°‘é”æŒæœ‰æ—¶é—´ å¯ä»¥ä½¿ç”¨åŒæ­¥ä»£ç å—æ¥ä»£æ›¿åŒæ­¥æ–¹æ³•ã€‚è¿™æ ·æ—¢å¯ä»¥å‡å°‘é”æŒæœ‰çš„æ—¶é—´ã€‚ å‡å°‘é”ç²’åº¦ è¦åœ¨å¹¶å‘åœºæ™¯ä¸­ä½¿ç”¨Mapçš„æ—¶å€™ï¼Œè®°å¾—ä½¿ç”¨ConcurrentHashMapæ¥ä»£æ›¿HashTableå’ŒHashMapã€‚ é”åˆ†ç¦» æ™®é€šé”ï¼ˆå¦‚syncronizedï¼‰ä¼šå¯¼è‡´è¯»é˜»å¡å†™ã€å†™ä¹Ÿä¼šé˜»å¡è¯»ï¼ŒåŒæ—¶è¯»è¯»ä¸å†™å†™ä¹‹é—´ä¹Ÿä¼šè¿›è¡Œé˜»å¡ï¼Œå¯ä»¥æƒ³åŠæ³•å°†è¯»æ“ä½œå’Œå†™æ“ä½œåˆ†ç¦»å¼€ã€‚ é”ç²—åŒ– æœ‰äº›æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›æŠŠå¾ˆå¤šæ¬¡é”çš„è¯·æ±‚åˆå¹¶æˆä¸€ä¸ªè¯·æ±‚ï¼Œä»¥é™ä½çŸ­æ—¶é—´å†…å¤§é‡é”è¯·æ±‚ã€åŒæ­¥ã€é‡Šæ”¾å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ é”æ¶ˆé™¤ é”æ¶ˆé™¤æ˜¯Javaè™šæ‹Ÿæœºåœ¨JITç¼–è¯‘æ˜¯ï¼Œé€šè¿‡å¯¹è¿è¡Œä¸Šä¸‹æ–‡çš„æ‰«æï¼Œå»é™¤ä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„é”ï¼Œé€šè¿‡é”æ¶ˆé™¤ï¼Œå¯ä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”æ—¶é—´ã€‚ å‚è€ƒ Javaå¹¶å‘ç¼–ç¨‹ï¼šçº¿ç¨‹æ± çš„ä½¿ç”¨ Javaå¤šçº¿ç¨‹ä¹‹Callableæ¥å£åŠçº¿ç¨‹æ±  äººäººéƒ½èƒ½æŒæ¡çš„JavaæœåŠ¡ç«¯æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ javaé”ä¼˜åŒ–çš„æ–¹æ³•ä¸æ€è·¯-å‡å°‘é”æŒæœ‰æ—¶é—´ã€å‡å°é”ç²’åº¦ã€é”åˆ†ç¦»ã€é”ç²—åŒ–ã€é”æ¶ˆé™¤","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"javaåŸºç¡€æ€»ç»“","slug":"javaåŸºç¡€æ€»ç»“","date":"2018-04-09T13:28:54.000Z","updated":"2018-04-15T06:43:40.471Z","comments":true,"path":"2018/04/09/javaåŸºç¡€æ€»ç»“/","link":"","permalink":"https://hsb786.github.io/2018/04/09/javaåŸºç¡€æ€»ç»“/","excerpt":"åˆå§‹åŒ–é¡ºåº çˆ¶ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ å­ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰ å­ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ å­ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰","text":"åˆå§‹åŒ–é¡ºåº çˆ¶ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ å­ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰ å­ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ å­ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰ Object123456789101112131415161718192021public final native Class&lt;?&gt; getClass()public native int hashCode()public boolean equals(Object obj)protected native Object clone() throws CloneNotSupportedExceptionpublic String toString()public final native void notify()public final native void notifyAll()public final native void wait(long timeout) throws InterruptedExceptionpublic final void wait(long timeout, int nanos) throws InterruptedExceptionpublic final void wait() throws InterruptedExceptionprotected void finalize() throws Throwable &#123;&#125; å¼‚å¸¸Throwableå¯ä»¥ç”¨æ¥è¡¨ç¤ºä»»ä½•å¯ä»¥ä½œä¸ºå¼‚å¸¸æŠ›å‡ºçš„ç±»ï¼Œåˆ†ä¸ºä¸¤ç§ï¼šErrorå’ŒExceptionã€‚å…¶ä¸­Errorç”¨æ¥è¡¨ç¤ºJVMæ— æ³•å¤„ç†çš„é”™è¯¯ï¼ŒExceptionåˆ†ä¸ºä¸¤ç§ï¼š å—æ£€å¼‚å¸¸ï¼ˆchecked exceptionï¼‰ï¼šéœ€è¦tryâ€¦catchâ€¦è¯­å¥æ•è·å¹¶è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸”å¯ä»¥ä»ä¸€åœºæ¢å¤ éå—æ£€å¼‚å¸¸ï¼ˆunchecked exceptionï¼‰ï¼šæ˜¯ç¨‹åºè¿è¡Œæ—¶é”™è¯¯ï¼Œä¾‹å¦‚é™¤0ä¼šå¼•å‘Arithmetic Exceptinoï¼Œæ­¤æ—¶ç¨‹åºå´©æºƒå¹¶ä¸”æ— æ³•æ¢å¤ åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ ç›´æ¥new åå°„ ä½¿ç”¨Classç±»çš„newInstance åªèƒ½è°ƒç”¨æ— å‚æ„é€ å‡½æ•° ä½¿ç”¨Constructorçš„newInstance å¯ä»¥è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•° clone ä¸ä¼šè°ƒç”¨ä»»ä½•æ„é€ å‡½æ•° ååºåˆ—åŒ– ä¸ä¼šè°ƒç”¨ä»»ä½•æ„é€ å‡½æ•° åŠ¨æ€è·å–ç±»çš„æ–¹å¼ ç±»å.class å¯¹è±¡å.getClass Class.forName(â€œç±»åâ€) æ³›å‹å°†é›†åˆä¸­çš„å…ƒç´ é™å®šä¸ºä¸€ä¸ªç‰¹å®šçš„ç±»å‹ javaé›†åˆæœ‰ä¸€ä¸ªç¼ºç‚¹æ˜¯å½“æŠŠä¸€ä¸ªå¯¹è±¡æ”¾å…¥é›†åˆé‡Œé¢ä¹‹åï¼Œé›†åˆå°±ä¼šâ€å¿˜è®°â€è¿™ä¸ªå¯¹è±¡çš„æ•°æ®ç±»å‹ï¼Œå½“å†æ¬¡å–å‡ºè¯¥å¯¹è±¡çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡çš„ç¼–è¯‘ç±»å‹å°±å˜æˆäº†Objectç±»å‹(è¯¥å¯¹è±¡çš„è¿è¡Œæ—¶ç±»å‹æ²¡å˜)ã€‚ é€ æˆçš„é—®é¢˜ï¼š é›†åˆå¯¹å…ƒç´ ç±»å‹æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œè¿™æ ·ä¼šå¼•å‘ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæƒ³åˆ›å»ºä¸€ä¸ªä¿å­˜Dogå¯¹è±¡çš„é›†åˆï¼Œä½†æ˜¯ç¨‹åºä¹Ÿå¯ä»¥è½»æ˜“çš„æŠŠCatå¯¹è±¡ä¿å­˜è¿›å»ï¼Œæ‰€ä»¥ä¼šå¼•å‘å¼‚å¸¸ã€‚ ç”±äºæŠŠå¯¹è±¡ä¿å­˜åˆ°é›†åˆé‡Œé¢æ—¶ï¼Œé›†åˆä¸¢å¤±äº†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œé›†åˆåªçŸ¥é“å®ƒç››è£…çš„æ˜¯Objectï¼Œå› æ­¤å–å‡ºé›†åˆå…ƒç´ ä¹‹åé€šå¸¸è¿˜éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚è¿™ç§å¼ºåˆ¶ç±»å‹è½¬æ¢å³å¢åŠ äº†ç¼–ç¨‹çš„å¤æ‚åº¦ï¼Œä¹Ÿå¯èƒ½å¼•å‘ç±»å‹è½¬æ¢ClassCastExceptionå¼‚å¸¸ã€‚ åœ¨Java7ä»¥å‰ï¼Œå¦‚æœä½¿ç”¨å¸¦æœ‰æ³›å‹çš„æ¥å£ï¼Œç±»å®šä¹‰å¸¸é‡ï¼Œé‚£ä¹ˆè°ƒç”¨æ„é€ å™¨åˆ›å»ºå¯¹è±¡æ—¶æ„é€ å™¨çš„åé¢ä¹Ÿå¿…é¡»å¸¦æ³›å‹ï¼Œè¿™æ˜¾å¾—æœ‰äº›å¤šä½™äº†ã€‚ ä»java7å¼€å§‹ï¼Œjavaå…è®¸åœ¨æ„é€ å™¨åä¸éœ€è¦å¸¦å®Œæ•´çš„æ³›å‹ä¿¡æ¯ï¼Œåªè¦ç»™å‡ºä¸€å¯¹å°–æ‹¬å·(&lt;&gt;)å³å¯ï¼ŒJavaå¯ä»¥æ¨æ–­æ‹¬å·é‡Œé¢åº”è¯¥æ˜¯ä»€ä¹ˆæ³›å‹ä¿¡æ¯ã€‚å³ä¸Šé¢ä¸¤æ¡è¯­å¥å¯ä»¥æ”¹å†™æˆä¸ºå¦‚ä¸‹çš„å½¢å¼ï¼š 12List&lt;String&gt; strList=new ArrayList&lt;String&gt;();Map&lt;String,Integer&gt; scores=new HashMap&lt;String,Integer&gt;(); - æœ¯è¯­ ArrayList&lt;E> æ³›å‹ç±»å‹ ArrayList åŸå§‹ç±»å‹ E å‚æ•°ç±»å‹ &lt;&gt; è¯»ä½œâ€typeofâ€ ArrayList&lt;Intege\\r&gt; å‚æ•°åŒ–çš„ç±»å‹ Integer å®é™…ç±»å‹å‚æ•° â€œ?â€ é€šé…ç¬¦ï¼Ÿè¡¨ç¤ºä»»æ„ç±»å‹ï¼Œä½¿ç”¨ï¼Ÿé€šé…ç¬¦å¯ä»¥å¼•ç”¨å„ç§å‚æ•°åŒ–çš„ç±»å‹ é™å®šé€šé…ç¬¦çš„ä¸Šè¾¹ç•ŒArrayList&lt;? extends Number&gt; collection=new ArrayList(); é™å®šé€šé…ç¬¦çš„ä¸‹è¾¹ç•ŒArrayList&lt;? super Integer&gt; collection=new ArrayList(); â€œæ“¦é™¤â€æ³›å‹æ˜¯æä¾›ç»™javacç¼–è¯‘å™¨ä½¿ç”¨çš„ï¼Œé™å®šé›†åˆçš„è¾“å…¥ç±»å‹ï¼Œç¼–è¯‘å™¨ç¼–è¯‘å¸¦ç±»å‹è¯´æ˜çš„é›†åˆæ—¶ä¼šå»æ‰â€œç±»å‹â€ä¿¡æ¯ã€‚ å¤šæ€å­˜åœ¨çš„ä¸‰ä¸ªæ¡ä»¶ æœ‰ç»§æ‰¿å…³ç³» å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³• çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ ä»¥ä¸‹ä¸‰ç§ç±»å‹çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼š staticæ–¹æ³•ã€‚è¢«staticä¿®é¥°çš„æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œè€Œä¸æ˜¯å±äºå®ä¾‹çš„ finalæ–¹æ³•ã€‚è¢«finalä¿®é¥°çš„æ–¹æ³•æ˜¯æ— æ³•è¢«å­ç±»é‡å†™ privateæ–¹æ³•ã€‚è¢«privateä¿®é¥°çš„æ–¹æ³•å¯¹å­ç±»ä¸å¯è§ï¼Œ å¤šæ€çš„åˆ†ç±» ç¼–è¯‘æ—¶å¤šæ€ï¼Œå³æ–¹æ³•çš„é‡è½½ è¿è¡Œæ—¶å¤šæ€ï¼Œå³æ–¹æ³•çš„é‡å†™ throwå’Œthrowsthrow: è¡¨ç¤ºæŠ›å‡ºä¸€ä¸ªç±»çš„å®ä¾‹ã€‚throwå…³é”®å­—å¯ä»¥å†™åœ¨ä»»ä½•åœ°æ–¹ï¼Œå¹¶ä¸å¼ºåˆ¶å¿…é¡»å†™åœ¨catchå—ä¸­ï¼Œè¿è¡Œåˆ°throwæ‰€åœ¨çš„è¡Œï¼Œæ‰“å°å¼‚å¸¸å¹¶ç«‹å³é€€å‡ºå½“å‰æ–¹æ³•ã€‚ throws: ç”¨äºæ–¹æ³•å£°æ˜ï¼ŒæŒ‡æ˜å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ã€‚ ArrayListtransient Object[] elementData; æ‰©å®¹1.5å€ int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); åº•å±‚åŸºäºæ•°ç»„å®ç° æ’å…¥å’Œåˆ é™¤çš„æ—¶å€™ï¼Œæ¶‰åŠåˆ°å…ƒç´ å¤åˆ¶","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"å¤šçº¿ç¨‹åŸºç¡€","slug":"å¤šçº¿ç¨‹åŸºç¡€","date":"2018-04-09T13:03:41.000Z","updated":"2018-04-14T06:31:11.726Z","comments":true,"path":"2018/04/09/å¤šçº¿ç¨‹åŸºç¡€/","link":"","permalink":"https://hsb786.github.io/2018/04/09/å¤šçº¿ç¨‹åŸºç¡€/","excerpt":"çº¿ç¨‹é—´é€šä¿¡çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­ç‹¬ç«‹çš„ä¸ªä½“ï¼Œä½†è¿™äº›ä¸ªä½“å¦‚æœä¸ç»è¿‡ç‰¹æ®Šå¤„ç†å°±ä¸èƒ½æˆä¸ºä¸€ä¸ªæ•´ä½“ã€‚åœ¨çº¿ç¨‹é—´è¿›è¡Œé€šä¿¡åï¼Œç³»ç»Ÿä¹‹é—´çš„äº¤äº’æ€§ä¼šæ›´åŠ å¼ºå¤§ï¼Œåœ¨å¤§å¤§æé«˜CPUåˆ©ç”¨ç‡çš„åŒæ—¶è¿˜ä¼šä½¿ç¨‹åºå‘˜å¯¹å„çº¿ç¨‹ä»»åŠ¡åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­è¿›è¡Œæœ‰æ•ˆçš„æŠŠæ§ä¸ç›‘ç£ã€‚","text":"çº¿ç¨‹é—´é€šä¿¡çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­ç‹¬ç«‹çš„ä¸ªä½“ï¼Œä½†è¿™äº›ä¸ªä½“å¦‚æœä¸ç»è¿‡ç‰¹æ®Šå¤„ç†å°±ä¸èƒ½æˆä¸ºä¸€ä¸ªæ•´ä½“ã€‚åœ¨çº¿ç¨‹é—´è¿›è¡Œé€šä¿¡åï¼Œç³»ç»Ÿä¹‹é—´çš„äº¤äº’æ€§ä¼šæ›´åŠ å¼ºå¤§ï¼Œåœ¨å¤§å¤§æé«˜CPUåˆ©ç”¨ç‡çš„åŒæ—¶è¿˜ä¼šä½¿ç¨‹åºå‘˜å¯¹å„çº¿ç¨‹ä»»åŠ¡åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­è¿›è¡Œæœ‰æ•ˆçš„æŠŠæ§ä¸ç›‘ç£ã€‚ é”é˜Ÿåˆ—æ¯ä¸ªé”å¯¹è±¡éƒ½æœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯å°±ç»ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯é˜»å¡é˜Ÿåˆ—ã€‚å°±ç»ªé˜Ÿåˆ—å­˜å‚¨äº†å°†è¦è·å¾—é”çš„çº¿ç¨‹ï¼Œé˜»å¡é˜Ÿåˆ—å­˜å‚¨äº†è¢«é˜»å¡çš„çº¿ç¨‹ã€‚ä¸€ä¸ªçº¿ç¨‹è¢«å”¤é†’åï¼Œæ‰ä¼šè¿›å…¥å°±ç»ªé˜Ÿåˆ—ï¼Œç­‰å¾…CPUçš„è°ƒåº¦ï¼›åä¹‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¢«waitåï¼Œå°±ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¢«å”¤é†’ã€‚ å¤šçº¿ç¨‹å¯¹è±¡çš„å¸¸ç”¨å‡½æ•° Thread.currentThread()æ–¹æ³•è¿”å›ä»£ç æ®µæ­£åœ¨è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„ä¿¡æ¯ Threadå¯¹è±¡å®ä¾‹.isAlive()æ–¹æ³•çš„åŠŸèƒ½æ˜¯åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦å¤„äºæ´»è·ƒçŠ¶æ€(æ­£åœ¨è¿è¡ŒçŠ¶æ€æˆ–è€…å‡†å¤‡å¼€å§‹è¿è¡ŒçŠ¶æ€) Thread.sleep()æ–¹æ³•çš„ä½œç”¨æ˜¯åœ¨æŒ‡å®šçš„æ¯«ç§’æ•°å†…è®©â€å½“å‰æ‰§è¡Œçš„çº¿ç¨‹â€ä¼‘çœ (æš‚åœæ‰§è¡Œ) getId()æ–¹æ³•å¯ä»¥è·å–çº¿ç¨‹çš„å”¯ä¸€æ ‡è¯† yield()æ–¹æ³•çš„ä½œç”¨æ˜¯æ”¾å¼ƒå½“å‰çš„CPUèµ„æºï¼Œå°†å®ƒè®©ç»™å…¶ä»–çš„ä»»åŠ¡å»å ç”¨CPUæ‰§è¡Œæ—¶é—´ã€‚å½“æ”¾å¼ƒçš„æ—¶é—´ä¸ç¡®å®šï¼Œæœ‰å¯èƒ½åˆšåˆšæ”¾å¼ƒï¼Œé©¬ä¸Šåˆè·å–CPUæ—¶é—´ç‰‡ã€‚ å¯¹è±¡é”ä½•æ—¶ä¼šè¢«é‡Šæ”¾ æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å— åœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¼‚å¸¸è€Œå¯¼è‡´çº¿ç¨‹ç»ˆæ­¢ åœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†é”æ‰€å±å¯¹è±¡çš„wait()æ–¹æ³•ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šé‡Šæ”¾é”ï¼Œè¿›è¡Œå¯¹è±¡çš„ç­‰å¾…æ±  å¦‚ä½•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¤„äºåœæ­¢çŠ¶æ€ Thread.interrupted():æµ‹è¯•å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»ä¸­æ–­ï¼Œstaticæ–¹æ³•ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•åçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€è¢«æ¸…é™¤ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœè¿ç»­ï¼’æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™ç¬¬äºŒæ¬¡è°ƒç”¨å°†è¿”å›falseã€‚ this.isInterrupted():æµ‹è¯•çº¿ç¨‹Threadå¯¹è±¡å®ä¾‹æ˜¯å¦å·²ç»ä¸­æ–­ï¼Œéstaticæ–¹æ³•ï¼Œä¸æ¸…é™¤çŠ¶æ€æ ‡è¯† è°ƒç”¨interrupt()æ–¹æ³•ä¸ä¼šçœŸçš„åœæ­¢çº¿ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰“äº†ä¸€ä¸ªåœæ­¢çš„æ ‡è®°ï¼Œè¿˜éœ€è¦é…åˆå…¶ä»–çš„ä»£ç æ¥åœæ­¢çº¿ç¨‹ã€‚ å®ˆæŠ¤çº¿ç¨‹å®ˆæŠ¤çº¿ç¨‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿ç¨‹ï¼Œå½“è¿›ç¨‹ä¸­ä¸å­˜åœ¨éå®ˆæŠ¤çº¿ç¨‹äº†ï¼Œå®ˆæŠ¤çº¿ç¨‹å°±è‡ªåŠ¨é”€æ¯ã€‚å…¸å‹çš„å®ˆæŠ¤çº¿ç¨‹å°±æ˜¯åƒåœ¾å›æ”¶çº¿ç¨‹ï¼Œå½“è¿›ç¨‹ä¸­æ²¡æœ‰éå®ˆæŠ¤çº¿ç¨‹äº†ï¼Œåˆ™åƒåœ¾å›æ”¶çº¿ç¨‹ä¹Ÿå°±æ²¡æœ‰å­˜åœ¨çš„å¿…è¦äº†ï¼Œè‡ªåŠ¨é”€æ¯ã€‚Deamonçš„ä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯GC(åƒåœ¾å›æ”¶å™¨)ã€‚ å¯¹è±¡åŠå˜é‡çš„å¹¶å‘è®¿é—®â€œéçº¿ç¨‹å®‰å…¨â€å…¶å®ä¼šåœ¨å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå¯¹è±¡ä¸­çš„å®ä¾‹å˜é‡è¿›è¡Œå¹¶å‘è®¿é—®æ—¶å‘ç”Ÿï¼Œäº§ç”Ÿçš„åæœå°±æ˜¯â€è„è¯»â€ï¼Œä¹Ÿå°±æ˜¯å–åˆ°çš„æ•°æ®å…¶å®æ˜¯è¢«æ›´æ”¹è¿‡çš„ã€‚è€Œâ€çº¿ç¨‹å®‰å…¨â€è·å¾—çš„å®ä¾‹å˜é‡çš„å€¼æ˜¯ç»è¿‡åŒæ­¥å¤„ç†çš„ï¼Œä¸ä¼šå‡ºç°â€è„è¯»â€çš„ç°è±¡ã€‚ æ–¹æ³•å†…çš„ç§æœ‰å˜é‡â€œéçº¿ç¨‹å®‰å…¨â€é—®é¢˜å­˜åœ¨äºâ€å®ä¾‹å˜é‡â€ï¼Œå¦‚æœæ˜¯æ–¹æ³•å†…éƒ¨çš„ç§æœ‰å˜é‡ï¼Œåˆ™ä¸å­˜åœ¨â€éçº¿ç¨‹å®‰å…¨â€é—®é¢˜ï¼Œæ°¸è¿œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ˜¯æ–¹æ³•å†…éƒ¨çš„å˜é‡æ˜¯ç§æœ‰(ä½œç”¨åŸŸ)çš„ç‰¹æ€§é€ æˆçš„ã€‚ é”å…³é”®å­—synchronizedå–å¾—çš„é”éƒ½æ˜¯å¯¹è±¡é”ï¼Œè€Œä¸æ˜¯æŠŠä¸€æ®µä»£ç æˆ–è€…æ–¹æ³•(å‡½æ•°)å½“ä½œé”ï¼Œå“ªä¸ªçº¿ç¨‹å…ˆæ‰§è¡Œå¸¦synchronizedå…³é”®å­—çš„æ–¹æ³•ï¼Œå“ªä¸ªçº¿ç¨‹å°±æŒæœ‰è¯¥æ–¹æ³•æ‰€å±å¯¹è±¡çš„é”Lockï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹åªèƒ½å‘ˆç°ç­‰å¾…çŠ¶æ€ï¼Œå‰ææ˜¯å¤šä¸ªçº¿ç¨‹è®¿é—®çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹è®¿é—®å¤šä¸ªå¯¹è±¡ï¼Œåˆ™JVMä¼šåˆ›å»ºå¤šä¸ªé”ã€‚ â€œå¯é‡å…¥é”â€:å½“æœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡æƒ³è¦è·å¾—è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ã€‚ç‰¹åˆ«çš„è¯´æ˜ï¼Œå½“å­˜åœ¨çˆ¶å­ç±»ç»§æ‰¿å…³ç³»æ—¶ï¼Œå­ç±»æ˜¯å®Œå…¨å¯ä»¥é€šè¿‡â€å¯é‡å…¥é”â€è°ƒç”¨çˆ¶ç±»çš„åŒæ­¥æ–¹æ³•çš„ã€‚ é™æ€åŒæ­¥synchronizedæ–¹æ³•ä¸synchronized(class)ä»£ç å—å…³é”®å­—synchronizedè¿˜å¯ä»¥åº”ç”¨åœ¨staticé™æ€æ–¹æ³•ä¸Šï¼Œå¦‚æœè¿™æ ·å†™ï¼Œé‚£æ˜¯å¯¹å½“å‰çš„.javaæ–‡ä»¶å¯¹åº”çš„Classç±»è¿›è¡ŒæŒé”ã€‚synchronizedå…³é”®å­—åŠ åˆ°staticé™æ€æ–¹æ³•ä¸Šæ˜¯ç»™Classç±»ä¸Šé”ï¼Œå¯ä»¥å¯¹ç±»çš„æ‰€æœ‰å¯¹è±¡å®ä¾‹èµ·ä½œç”¨ï¼Œè€Œsynchronizedå…³é”®å­—åŠ åˆ°éstaticé™æ€æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡ä¸Šé”ï¼Œè¿™2ä¸ªé”ä¸æ˜¯åŒä¸€ä¸ªé”ã€‚synchronized(class)ä»£ç å—çš„ä½œç”¨å…¶å®å’Œsynchronized staticæ–¹æ³•çš„ä½œç”¨ä¸€æ ·ã€‚æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsynchronized(ClassName)ä¸synchronized(ClassNameçš„å®ä¾‹)ï¼Œçº¿ç¨‹å„è‡ªè·å–å„è‡ªçš„é”ï¼Œä¸ä¼šæœ‰ç­‰å¾…ã€‚ æ³¨æ„:æˆ‘ä»¬åœ¨å°†ä»»ä½•æ•°æ®ç±»å‹ä½œä¸ºåŒæ­¥é”æ—¶ï¼Œéœ€è¦è§‚å¯Ÿï¼Œæ˜¯å¦æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶æŒæœ‰é”å¯¹è±¡ï¼Œå¦‚æœåŒæ—¶æŒæœ‰ç›¸åŒçš„é”å¯¹è±¡ï¼Œåˆ™è¿™äº›çº¿ç¨‹ä¹‹é—´å°±æ˜¯åŒæ­¥çš„ï¼›å¦‚æœåˆ†åˆ«è·å¾—é”å¯¹è±¡ï¼Œå°±æ˜¯å¼‚æ­¥çš„ã€‚ volatileå…³é”®å­—volatileçš„ä¸»è¦ä½œç”¨æ˜¯ä½¿å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹é—´å¯è§ã€‚ç®€å•åœ°è¯´å°±æ˜¯å½“çº¿ç¨‹Aå¯¹å˜é‡Xè¿›è¡Œäº†ä¿®æ”¹åï¼Œåœ¨çº¿ç¨‹Aåé¢æ‰§è¡Œçš„å…¶ä»–çº¿ç¨‹èƒ½çœ‹åˆ°å˜é‡Xçš„å˜åŠ¨ã€‚åŒæ—¶å…³é”®å­—synchronizedä¹Ÿå¯ä»¥åŒæ ·çš„å®Œæˆvolatileå…³é”®å­—å¯è§æ€§çš„åŠŸèƒ½ã€‚(happens-before) ThreadLocalç±»ThreadLocalä¸»è¦è§£å†³çš„å°±æ˜¯æ¯ä¸ªçº¿ç¨‹ç»‘å®šè‡ªå·±çš„å€¼ï¼Œå¯ä»¥å°†ThreadLocalç±»æ¯”å–»æˆå…¨å±€å­˜æ”¾æ•°æ®çš„ç›’å­ï¼Œç›’å­ä¸­å¯ä»¥å­˜å‚¨æ¯ä¸ªçº¿ç¨‹çš„ç§æœ‰æ•°æ®ã€‚ ç±»Threadlocalè§£å†³çš„æ˜¯å˜é‡åœ¨ä¸åŒçº¿ç¨‹é—´çš„éš”ç¦»æ€§ï¼Œä¹Ÿå°±æ˜¯ä¸åŒçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„å€¼ï¼Œä¸åŒçº¿ç¨‹ä¸­çš„å€¼æ˜¯å¯ä»¥æ”¾å…¥Threadlocalç±»ä¸­è¿›è¡Œä¿å­˜çš„ã€‚ å…¬å¹³é”ä¸éå…¬å¹³é”å…¬å¹³ä¸éå…¬å¹³é”ï¼šé”Lockåˆ†ä¸ºâ€å…¬å¹³é”â€å’Œâ€éå…¬å¹³é”â€ï¼Œå…¬å¹³é”è¡¨ç¤ºçº¿ç¨‹è·å–é”çš„é¡ºåºæ˜¯æŒ‰ç…§çº¿ç¨‹åŠ é”çš„é¡ºåºæ¥åˆ†é…çš„ï¼Œå³å…ˆæ¥å…ˆå¾—çš„FIFOå…ˆè¿›å…ˆå‡ºé¡ºåºã€‚è€Œéå…¬å¹³é”å°±æ˜¯ä¸€ç§è·å–é”çš„æŠ¢å æœºåˆ¶ï¼Œæ˜¯éšæœºè·å¾—é”çš„ï¼Œå’Œå…¬å¹³é”ä¸ä¸€æ ·çš„å°±æ˜¯å…ˆæ¥çš„ä¸ä¸€å®šå…ˆå¾—åˆ°é”ï¼Œè¿™ä¸ªæ–¹å¼å¯èƒ½é€ æˆæŸäº›çº¿ç¨‹ä¸€ç›´æ‹¿ä¸åˆ°é”ï¼Œç»“æœå°±æ˜¯ä¸å…¬å¹³çš„äº†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReentrantLockç±»ä½¿ç”¨çš„æ˜¯éå…¬å¹³é”ã€‚ ReentrantReadWriteLockç±»ReentrantLockå…·æœ‰å®Œå…¨äº’æ–¥æ’ä»–çš„æ•ˆæœï¼Œå³åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡ŒReentrantLock.lock()æ–¹æ³•åé¢çš„ä»»åŠ¡ã€‚è¿™æ ·åšè™½ç„¶ä¿è¯äº†å®ä¾‹å˜é‡çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œä½†æ•ˆç‡å´æ˜¯éå¸¸ä½ä¸‹çš„ã€‚æ‰€ä»¥åœ¨JDKä¸­æä¾›äº†ä¸€ç§è¯»å†™é”ReentrantReadWriteLockç±»ï¼Œä½¿ç”¨å®ƒå¯ä»¥åŠ å¿«è¿è¡Œæ•ˆç‡ã€‚ è¯»å†™é”è¡¨ç¤ºä¹Ÿæœ‰ä¸¤ä¸ªé”ï¼Œä¸€ä¸ªæ˜¯è¯»æ“ä½œç›¸å…³çš„é”ï¼Œä¹Ÿç§°ä¸ºå…±äº«é”ï¼›å¦ä¸€ä¸ªæ˜¯å†™æ“ä½œç›¸å…³çš„é”ï¼Œä¹Ÿå«æ’ä»–é”ã€‚ä¹Ÿå°±æ˜¯å¤šä¸ªè¯»é”ä¹‹é—´ä¸äº’æ–¥ï¼Œè¯»é”ä¸å†™é”äº’æ–¥ï¼Œå†™é”ä¸å†™é”äº’æ–¥ã€‚åœ¨æ²¡æœ‰çº¿ç¨‹Threadè¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œè¿›è¡Œè¯»å–æ“ä½œçš„å¤šä¸ªThreadéƒ½å¯ä»¥è·å–è¯»é”ï¼Œè€Œè¿›è¡Œå†™å…¥æ“ä½œçš„çº¿ç¨‹Threadåªæœ‰åœ¨è·å–å†™é”åæ‰èƒ½è¿›è¡Œå†™å…¥æ“ä½œã€‚å³å¤šä¸ªThreadå¯ä»¥åŒæ—¶è¿›è¡Œè¯»å–æ“ä½œï¼Œä½†æ˜¯åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªThreadè¿›è¡Œå†™å…¥æ“ä½œã€‚ ç®€å•å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354public class ReadWriteLock &#123; private int readThreadCounter = 0; // æ­£åœ¨è¯»å–çš„çº¿ç¨‹æ•°ï¼ˆ0ä¸ªæˆ–å¤šä¸ªï¼‰ private int waitingWriteCounter = 0; // ç­‰å¾…å†™å…¥çš„çº¿ç¨‹æ•°ï¼ˆ0ä¸ªæˆ–å¤šä¸ªï¼‰ private int writeThreadCounter = 0; // æ­£åœ¨å†™å…¥çš„çº¿ç¨‹æ•°ï¼ˆ0ä¸ªæˆ–1ä¸ªï¼‰ private boolean writeFlag = true; // æ˜¯å¦å¯¹å†™å…¥ä¼˜å…ˆï¼ˆé»˜è®¤ä¸ºæ˜¯ï¼‰ // è¯»å–åŠ é” public synchronized void readLock() throws InterruptedException &#123; // è‹¥å­˜åœ¨æ­£åœ¨å†™å…¥çš„çº¿ç¨‹ï¼Œæˆ–å½“å†™å…¥ä¼˜å…ˆæ—¶å­˜åœ¨ç­‰å¾…å†™å…¥çš„çº¿ç¨‹ï¼Œåˆ™å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºç­‰å¾…çŠ¶æ€ while (writeThreadCounter &gt; 0 || (writeFlag &amp;&amp; waitingWriteCounter &gt; 0)) &#123; wait(); &#125; // ä½¿æ­£åœ¨è¯»å–çš„çº¿ç¨‹æ•°åŠ ä¸€ readThreadCounter++; &#125; // è¯»å–è§£é” public synchronized void readUnlock() &#123; // ä½¿æ­£åœ¨è¯»å–çš„çº¿ç¨‹æ•°å‡ä¸€ readThreadCounter--; // è¯»å–ç»“æŸï¼Œå¯¹å†™å…¥ä¼˜å…ˆ writeFlag = true; // é€šçŸ¥æ‰€æœ‰å¤„äº wait çŠ¶æ€çš„çº¿ç¨‹ notifyAll(); &#125; // å†™å…¥åŠ é” public synchronized void writeLock() throws InterruptedException &#123; // ä½¿ç­‰å¾…å†™å…¥çš„çº¿ç¨‹æ•°åŠ ä¸€ waitingWriteCounter++; try &#123; // è‹¥å­˜åœ¨æ­£åœ¨è¯»å–çš„çº¿ç¨‹ï¼Œæˆ–å­˜åœ¨æ­£åœ¨å†™å…¥çš„çº¿ç¨‹ï¼Œåˆ™å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºç­‰å¾…çŠ¶æ€ while (readThreadCounter &gt; 0 || writeThreadCounter &gt; 0) &#123; wait(); &#125; &#125; finally &#123; // ä½¿ç­‰å¾…å†™å…¥çš„çº¿ç¨‹æ•°å‡ä¸€ waitingWriteCounter--; &#125; // ä½¿æ­£åœ¨å†™å…¥çš„çº¿ç¨‹æ•°åŠ ä¸€ writeThreadCounter++; &#125; // å†™å…¥è§£é” public synchronized void writeUnlock() &#123; // ä½¿æ­£åœ¨å†™å…¥çš„çº¿ç¨‹æ•°å‡ä¸€ writeThreadCounter--; // å†™å…¥ç»“æŸï¼Œå¯¹è¯»å–ä¼˜å…ˆ writeFlag = false; // é€šçŸ¥æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ notifyAll(); &#125;&#125; Javaå¤šçº¿ç¨‹å­¦ä¹ ç¬”è®° Lock é‚£ç‚¹äº‹å„¿","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"æœ¯è¯­","slug":"æœ¯è¯­","date":"2018-04-09T05:53:41.000Z","updated":"2018-04-15T06:22:46.867Z","comments":true,"path":"2018/04/09/æœ¯è¯­/","link":"","permalink":"https://hsb786.github.io/2018/04/09/æœ¯è¯­/","excerpt":"happens-beforeåœ¨JMMä¸­ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæ‰§è¡Œçš„ç»“æœéœ€è¦å¯¹å¦ä¸€ä¸ªæ“ä½œå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å¿…é¡»è¦å­˜åœ¨happens-beforeå…³ç³» éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢æåˆ°çš„ä¸¤ä¸ªæ“ä½œå¯ä»¥æ˜¯åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´çš„ï¼Œè€Œä¸”å¹¶ä¸æ„å‘³ç€å‰ä¸€ä¸ªæ“ä½œå¿…é¡»è¦åœ¨åä¸€ä¸ªæ“ä½œä¹‹å‰æ‰§è¡Œï¼Œä»…ä»…è¦æ±‚å‰ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æœå¯¹åä¸€ä¸ªæ“ä½œå¯è§","text":"happens-beforeåœ¨JMMä¸­ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæ‰§è¡Œçš„ç»“æœéœ€è¦å¯¹å¦ä¸€ä¸ªæ“ä½œå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å¿…é¡»è¦å­˜åœ¨happens-beforeå…³ç³» éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢æåˆ°çš„ä¸¤ä¸ªæ“ä½œå¯ä»¥æ˜¯åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´çš„ï¼Œè€Œä¸”å¹¶ä¸æ„å‘³ç€å‰ä¸€ä¸ªæ“ä½œå¿…é¡»è¦åœ¨åä¸€ä¸ªæ“ä½œä¹‹å‰æ‰§è¡Œï¼Œä»…ä»…è¦æ±‚å‰ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æœå¯¹åä¸€ä¸ªæ“ä½œå¯è§ happends-beforeè§„åˆ™ ç¨‹åºé¡ºåºè§„åˆ™ï¼š å•ä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸ªæ“ä½œï¼Œhappens-beforeäºè¯¥çº¿ç¨‹ä¸­çš„ä»»æ„åç»­æ“ä½œ ç›‘è§†å™¨é”è§„åˆ™ï¼š å¯¹ä¸€ä¸ªé”çš„è§£é”ï¼Œhappens-beforeäºéšåå¯¹è¿™ä¸ªé”çš„åŠ é” volatileå˜é‡è§„åˆ™ï¼š å¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™ï¼Œhappends-beforeäºä»»æ„åç»­å¯¹è¿™ä¸ªvolatileå˜é‡çš„è¯» ä¼ é€’æ€§ï¼š å¦‚æœA happeens-before Bï¼Œä¸” B happeend-before Cï¼Œé‚£ä¹ˆA happeens-before C joinè§„åˆ™ï¼š å¦‚æœçº¿ç¨‹Aæ‰§è¡Œæ“ä½œThreadB.join()æˆåŠŸè¿”å›ï¼Œé‚£ä¹ˆçº¿ç¨‹Bä¸­çš„ä»»æ„æ“ä½œhappeens-beforeä¸çº¿ç¨‹Aä»ThreadB.join()æ“ä½œæˆåŠŸè¿”å› fail-fastfail-fastæœºåˆ¶æ˜¯javaé›†åˆ(Collection)ä¸­çš„ä¸€ç§é”™è¯¯æœºåˆ¶ã€‚å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€é›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿfail-fastäº‹ä»¶ã€‚ ä¾‹å¦‚ï¼šå½“æŸä¸€ä¸ªçº¿ç¨‹Aé€šè¿‡iteratorå»éå†æŸé›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œè‹¥è¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜äº†ï¼›é‚£ä¹ˆçº¿ç¨‹Aè®¿é—®é›†åˆæ—¶ï¼Œå°±ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ è¦äº†è§£fail-fastæœºåˆ¶ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¯¹ConcurrentModificationException å¼‚å¸¸æœ‰æ‰€äº†è§£ã€‚å½“æ–¹æ³•æ£€æµ‹åˆ°å¯¹è±¡çš„å¹¶å‘ä¿®æ”¹ï¼Œä½†ä¸å…è®¸è¿™ç§ä¿®æ”¹æ—¶å°±æŠ›å‡ºè¯¥å¼‚å¸¸ã€‚åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥å¼‚å¸¸ä¸ä¼šå§‹ç»ˆæŒ‡å‡ºå¯¹è±¡å·²ç»ç”±ä¸åŒçº¿ç¨‹å¹¶å‘ä¿®æ”¹ï¼Œå¦‚æœå•çº¿ç¨‹è¿åäº†è§„åˆ™ï¼ŒåŒæ ·ä¹Ÿæœ‰å¯èƒ½ä¼šæŠ›å‡ºæ”¹å¼‚å¸¸ã€‚è¯šç„¶ï¼Œè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºæ— æ³•å¾—åˆ°ä¿è¯ï¼Œå®ƒä¸èƒ½ä¿è¯ä¸€å®šä¼šå‡ºç°è¯¥é”™è¯¯ï¼Œä½†æ˜¯å¿«é€Ÿå¤±è´¥æ“ä½œä¼šå°½æœ€å¤§åŠªåŠ›æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ å½“ä½¿ç”¨fail-fast iteratorå¯¹Collectionæˆ–å¯¹Mapè¿›è¡Œæ“ä½œè¿‡ç¨‹ä¸­å°è¯•ç›´æ¥ä¿®æ”¹Collection/Mapçš„å†…å®¹æ—¶ï¼Œå³ä½¿æ˜¯åœ¨å•çº¿ç¨‹ä¸‹è¿è¡Œï¼Œjava.util.ConcurrentModificationExceptionå¼‚å¸¸ä¹Ÿå°†æŠ›å‡º Iteratoræ˜¯å·¥ä½œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¸€ä¸ªmutexé”ã€‚Iteratorè¢«åˆ›å»ºä¹‹åä¼šå»ºç«‹ä¸€ä¸ªæŒ‡å‘åŸæ¥å¯¹è±¡çš„å•é“¾ç´¢å¼•è¡¨ï¼Œå½“åŸæ¥å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™ä¸ªç´¢å¼•è¡¨çš„å†…å®¹ä¸ä¼šåŒæ­¥è¯¥è¡¨ï¼Œæ‰€ä»¥å½“ç´¢å¼•æŒ‡é’ˆå¾€åç§»åŠ¨çš„æ—¶å€™å°±æ‰¾ä¸åˆ°è¦è¿­ä»£çš„å¯¹è±¡ï¼Œæ‰€ä»¥æŒ‰ç…§fail-faståŸåˆ™Iteratorä¼šé©¬ä¸ŠæŠ›å‡ºConsurrentModificationExceptionå¼‚å¸¸ã€‚ æ‰€ä»¥Iteratoråœ¨å·¥ä½œçš„æ—¶å€™æ˜¯ä¸å…è®¸è¢«è¿­ä»£çš„å¯¹è±¡è¢«æ”¹å˜çš„ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨Iteratoræœ¬èº«çš„æ–¹æ³•remove()æ¥åˆ é™¤å¯¹è±¡ï¼ŒIteraror.remove()æ–¹æ³•ä¼šåœ¨åˆ é™¤å½“å‰è¿­ä»£å¯¹è±¡çš„åŒæ—¶ç»´æŠ¤ç´¢å¼•çš„ä¸€è‡´æ€§ã€‚ fail-safe é‡‡ç”¨å®‰å…¨å¤±è´¥æœºåˆ¶çš„é›†åˆå®¹å™¨ï¼Œåœ¨éå†æ—¶ä¸æ˜¯ç›´æ¥åœ¨é›†åˆå†…å®¹ä¸Šè®¿é—®çš„ï¼Œè€Œæ˜¯å…ˆå¤åˆ¶åŸæœ‰é›†åˆå†…å®¹ï¼Œåœ¨æ‹·è´çš„é›†åˆä¸Šè¿›è¡Œéå†ã€‚ åŸç†ï¼šç”±äºè¿­ä»£æ—¶æ˜¯å¯¹åŸé›†åˆçš„æ‹·è´è¿›è¡Œéå†ï¼Œæ‰€ä»¥åœ¨éå†è¿‡ç¨‹ä¸­å¯¹åŸé›†åˆæ‰€ä½œçš„ä¿®æ”¹å¹¶ä¸èƒ½è¢«è¿­ä»£å™¨æ£€æµ‹åˆ°ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘Concurrent Modification Exceptionã€‚ ç¼ºç‚¹ï¼šåŸºäºæ‹·è´å†…å®¹çš„ä¼˜ç‚¹æ˜¯é¿å…äº†Concurrent Modification Exceptionï¼Œä½†åŒæ ·åœ°ï¼Œè¿­ä»£å™¨å¹¶ä¸èƒ½è®¿é—®åˆ°ä¿®æ”¹åçš„å†…å®¹ï¼Œå³ï¼šè¿­ä»£å™¨éå†çš„æ˜¯å¼€å§‹éå†é‚£ä¸€åˆ»æ‹¿åˆ°çš„é›†åˆæ‹·è´ï¼Œåœ¨éå†æœŸé—´åŸé›†åˆå‘ç”Ÿçš„ä¿®æ”¹è¿­ä»£å™¨æ˜¯ä¸çŸ¥é“çš„ã€‚ åœºæ™¯ï¼šjava.util.concurrentåŒ…ä¸‹çš„å®¹å™¨éƒ½æ˜¯å®‰å…¨å¤±è´¥ï¼Œå¯ä»¥åœ¨å¤šçº¿ç¨‹ä¸‹å¹¶å‘ä½¿ç”¨ï¼Œå¹¶å‘ä¿®æ”¹ã€‚ æ•°æ®åº“ä¸‰å¤§èŒƒå¼ 1NFï¼šå­—æ®µä¸å¯å†åˆ† 2NFï¼šä¸»é”®ä¾èµ–ï¼Œä¸€å¼ è¡¨é‡Œçš„æ•°æ®ï¼Œå¿…é¡»æ˜¯è·Ÿä¸»é”®ç›¸å…³çš„ 3NFï¼šä»»æ„ä¸¤ä¸ªè¡¨ä¸èƒ½å‡ºç°é‡å¤çš„éä¸»é”®å­—æ®µ è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™å•ä¸€èŒè´£(Single Responsibility Principle)ï¼šä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£ å¼€é—­(Open-Closed Principle)ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ é‡Œæ°æ›¿æ¢(Liskov Subsitution Principle)ï¼šå­ç±»èƒ½å‡ºç°åœ¨åŸºç±»å‡ºç°çš„åœ°æ–¹ ä¾èµ–å€’ç½®(Dependency Inversion Principle)ï¼šé’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç±»ç¼–ç¨‹ æ¥å£éš”ç¦»(Interface Segregation Principle)ï¼šä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£ è¿ªç±³ç‰¹(Law of Demeter)ï¼šä¸€ä¸ªç±»å°½å¯èƒ½å°‘çš„ä¸å…¶å®ƒç±»å‘ç”Ÿç›¸äº’ä½œç”¨ åˆ†å¸ƒå¼é¢†åŸŸCAPç†è®ºConsistency(ä¸€è‡´æ€§)ï¼šæ•°æ®ä¸€è‡´æ›´æ–°ï¼Œæ‰€æœ‰æ•°æ®å˜åŠ¨éƒ½æ˜¯åŒæ­¥çš„ Availability(å¯ç”¨æ€§)ï¼šå¥½çš„å“åº”æ€§èƒ½ Partition tolerance(åˆ†åŒºå®¹å¿æ€§)ï¼šå¯é æ€§ å®šç†ï¼šä»»ä½•åˆ†å¸ƒå¼ç³»ç»Ÿåªå¯åŒæ—¶æ»¡è¶³äºŒç‚¹ï¼Œæ²¡æ³•ä¸‰è€…å…¼é¡¾ã€‚ å¿ å‘Šï¼šæ¶æ„å¸ˆä¸è¦å°†ç²¾åŠ›æµªè´¹åœ¨å¦‚ä½•è®¾è®¡èƒ½æ»¡è¶³ä¸‰è€…çš„å®Œç¾åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè€Œæ˜¯åº”è¯¥è¿›è¡Œå–èˆã€‚ å¼ºä¸€è‡´æ€§,å¼±ä¸€è‡´æ€§,æœ€ç»ˆä¸€è‡´æ€§å¼ºä¸€è‡´æ€§ å½“æ›´æ–°æ“ä½œå®Œæˆä¹‹åï¼Œä»»ä½•å¤šä¸ªåç»­è¿›ç¨‹æˆ–è€…çº¿ç¨‹çš„è®¿é—®éƒ½ä¼šè¿”å›æœ€æ–°çš„æ›´æ–°è¿‡çš„å€¼ã€‚è¿™ç§æ˜¯å¯¹ç”¨æˆ·æœ€å‹å¥½çš„ï¼Œå°±æ˜¯ç”¨æˆ·ä¸Šä¸€æ¬¡å†™ä»€ä¹ˆï¼Œä¸‹ä¸€æ¬¡å°±ä¿è¯èƒ½è¯»åˆ°ä»€ä¹ˆã€‚æ ¹æ® CAP ç†è®ºï¼Œè¿™ç§å®ç°éœ€è¦ç‰ºç‰²å¯ç”¨æ€§ã€‚ å¼±ä¸€è‡´æ€§ ç³»ç»Ÿå¹¶ä¸ä¿è¯ç»­è¿›ç¨‹æˆ–è€…çº¿ç¨‹çš„è®¿é—®éƒ½ä¼šè¿”å›æœ€æ–°çš„æ›´æ–°è¿‡çš„å€¼ã€‚ç³»ç»Ÿåœ¨æ•°æ®å†™å…¥æˆåŠŸä¹‹åï¼Œä¸æ‰¿è¯ºç«‹å³å¯ä»¥è¯»åˆ°æœ€æ–°å†™å…¥çš„å€¼ï¼Œä¹Ÿä¸ä¼šå…·ä½“çš„æ‰¿è¯ºå¤šä¹…ä¹‹åå¯ä»¥è¯»åˆ°ã€‚ æœ€ç»ˆä¸€è‡´æ€§ å¼±ä¸€è‡´æ€§çš„ç‰¹å®šå½¢å¼ã€‚ç³»ç»Ÿä¿è¯åœ¨æ²¡æœ‰åç»­æ›´æ–°çš„å‰æä¸‹ï¼Œç³»ç»Ÿæœ€ç»ˆè¿”å›ä¸Šä¸€æ¬¡æ›´æ–°æ“ä½œçš„å€¼ã€‚åœ¨æ²¡æœ‰æ•…éšœå‘ç”Ÿçš„å‰æä¸‹ï¼Œä¸ä¸€è‡´çª—å£çš„æ—¶é—´ä¸»è¦å—é€šä¿¡å»¶è¿Ÿï¼Œç³»ç»Ÿè´Ÿè½½å’Œå¤åˆ¶å‰¯æœ¬çš„ä¸ªæ•°å½±å“ã€‚DNS æ˜¯ä¸€ä¸ªå…¸å‹çš„æœ€ç»ˆä¸€è‡´æ€§ç³»ç»Ÿã€‚ å‡å”¤é†’(spurious wake up)Linuxä¸­å¸®åŠ©ä¸­æåˆ°çš„ï¼šåœ¨å¤šæ ¸å¤„ç†å™¨ä¸‹ï¼Œpthread_cond_signalå¯èƒ½ä¼šæ¿€æ´»å¤šäºä¸€ä¸ªçº¿ç¨‹ï¼ˆé˜»å¡åœ¨æ¡ä»¶å˜é‡ä¸Šçš„çº¿ç¨‹ï¼‰ã€‚ ç»“æœæ˜¯ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨pthread_cond_signal()åï¼Œå¤šä¸ªè°ƒç”¨pthread_cond_wait()æˆ–pthread_cond_timedwait()çš„çº¿ç¨‹è¿”å›ã€‚è¿™ç§æ•ˆåº”æˆä¸ºâ€è™šå‡å”¤é†’â€(spurious wakeup) è™½ç„¶è™šå‡å”¤é†’åœ¨pthread_cond_waitå‡½æ•°ä¸­å¯ä»¥è§£å†³ï¼Œä¸ºäº†å‘ç”Ÿæ¦‚ç‡å¾ˆä½çš„æƒ…å†µè€Œé™ä½è¾¹ç¼˜æ¡ä»¶ï¼ˆfringe conditionï¼‰æ•ˆç‡æ˜¯ä¸å€¼å¾—çš„ï¼Œçº æ­£è¿™ä¸ªé—®é¢˜ä¼šé™ä½å¯¹æ‰€æœ‰åŸºäºå®ƒçš„æ‰€æœ‰æ›´é«˜çº§çš„åŒæ­¥æ“ä½œçš„å¹¶å‘åº¦ã€‚æ‰€ä»¥pthread_cond_waitçš„å®ç°ä¸Šæ²¡æœ‰å»è§£å†³å®ƒã€‚ æ‰€ä»¥é€šå¸¸çš„æ ‡å‡†è§£å†³åŠæ³•æ˜¯è¿™æ ·çš„ï¼šå°†æ¡ä»¶çš„åˆ¤æ–­ä»if æ”¹ä¸ºwhile pthread_cond_waitä¸­çš„while()ä¸ä»…ä»…åœ¨ç­‰å¾…æ¡ä»¶å˜é‡å‰æ£€æŸ¥æ¡ä»¶å˜é‡ï¼Œå®é™…ä¸Šåœ¨ç­‰å¾…æ¡ä»¶å˜é‡åä¹Ÿæ£€æŸ¥æ¡ä»¶å˜é‡ã€‚ è¿™æ ·å¯¹conditionè¿›è¡Œå¤šåšä¸€æ¬¡åˆ¤æ–­ï¼Œå³å¯é¿å…â€œè™šå‡å”¤é†’â€. è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨pthread_cond_wait()å‰è¦åŠ ä¸€ä¸ªwhileå¾ªç¯æ¥åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºå‡çš„åŸå› ã€‚ PO(persistant object) æŒä¹…å¯¹è±¡åœ¨ o/r æ˜ å°„çš„æ—¶å€™å‡ºç°çš„æ¦‚å¿µï¼Œå¦‚æœæ²¡æœ‰ o/r æ˜ å°„ï¼Œæ²¡æœ‰è¿™ä¸ªæ¦‚å¿µå­˜åœ¨äº†ã€‚é€šå¸¸å¯¹åº”æ•°æ®æ¨¡å‹ ( æ•°æ®åº“ ), æœ¬èº«è¿˜æœ‰éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ã€‚å¯ä»¥çœ‹æˆæ˜¯ä¸æ•°æ®åº“ä¸­çš„è¡¨ç›¸æ˜ å°„çš„ java å¯¹è±¡ã€‚æœ€ç®€å•çš„ PO å°±æ˜¯å¯¹åº”æ•°æ®åº“ä¸­æŸä¸ªè¡¨ä¸­çš„ä¸€æ¡è®°å½•ï¼Œå¤šä¸ªè®°å½•å¯ä»¥ç”¨ PO çš„é›†åˆã€‚ PO ä¸­åº”è¯¥ä¸åŒ…å«ä»»ä½•å¯¹æ•°æ®åº“çš„æ“ä½œã€‚ DOï¼ˆDomain Objectï¼‰é¢†åŸŸå¯¹è±¡å°±æ˜¯ä»ç°å®ä¸–ç•Œä¸­æŠ½è±¡å‡ºæ¥çš„æœ‰å½¢æˆ–æ— å½¢çš„ä¸šåŠ¡å®ä½“ã€‚ä¸€èˆ¬å’Œæ•°æ®ä¸­çš„è¡¨ç»“æ„å¯¹åº”ã€‚ TO(Transfer Object) ï¼Œæ•°æ®ä¼ è¾“å¯¹è±¡åœ¨åº”ç”¨ç¨‹åºä¸åŒ tie( å…³ç³» ) ä¹‹é—´ä¼ è¾“çš„å¯¹è±¡ DTOï¼ˆData Transfer Objectï¼‰æ•°æ®ä¼ è¾“å¯¹è±¡è¿™ä¸ªæ¦‚å¿µæ¥æºäºJ2EEçš„è®¾è®¡æ¨¡å¼ï¼ŒåŸæ¥çš„ç›®çš„æ˜¯ä¸ºäº†EJBçš„åˆ†å¸ƒå¼åº”ç”¨æä¾›ç²—ç²’åº¦çš„æ•°æ®å®ä½“ï¼Œä»¥å‡å°‘åˆ†å¸ƒå¼è°ƒç”¨çš„æ¬¡æ•°ï¼Œä»è€Œæé«˜åˆ†å¸ƒå¼è°ƒç”¨çš„æ€§èƒ½å’Œé™ä½ç½‘ç»œè´Ÿè½½ï¼Œä½†åœ¨è¿™é‡Œï¼Œæˆ‘æ³›æŒ‡ç”¨äºå±•ç¤ºå±‚ä¸æœåŠ¡å±‚ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚ VO(view object) å€¼å¯¹è±¡è§†å›¾å¯¹è±¡ï¼Œç”¨äºå±•ç¤ºå±‚ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠæŸä¸ªæŒ‡å®šé¡µé¢ï¼ˆæˆ–ç»„ä»¶ï¼‰çš„æ‰€æœ‰æ•°æ®å°è£…èµ·æ¥ã€‚ BO(business object) ä¸šåŠ¡å¯¹è±¡ä»ä¸šåŠ¡æ¨¡å‹çš„è§’åº¦çœ‹ , è§ UML å…ƒä»¶é¢†åŸŸæ¨¡å‹ä¸­çš„é¢†åŸŸå¯¹è±¡ã€‚å°è£…ä¸šåŠ¡é€»è¾‘çš„ java å¯¹è±¡ , é€šè¿‡è°ƒç”¨ DAO æ–¹æ³• , ç»“åˆ PO,VO è¿›è¡Œä¸šåŠ¡æ“ä½œã€‚ business object: ä¸šåŠ¡å¯¹è±¡ ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸šåŠ¡é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒçš„å¯¹è±¡ã€‚ æ¯”å¦‚ä¸€ä¸ªç®€å†ï¼Œæœ‰æ•™è‚²ç»å†ã€å·¥ä½œç»å†ã€ç¤¾ä¼šå…³ç³»ç­‰ç­‰ã€‚ æˆ‘ä»¬å¯ä»¥æŠŠæ•™è‚²ç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œå·¥ä½œç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œç¤¾ä¼šå…³ç³»å¯¹åº”ä¸€ä¸ª PO ã€‚ å»ºç«‹ä¸€ä¸ªå¯¹åº”ç®€å†çš„ BO å¯¹è±¡å¤„ç†ç®€å†ï¼Œæ¯ä¸ª BO åŒ…å«è¿™äº› PO ã€‚ è¿™æ ·å¤„ç†ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹ BO å»å¤„ç†ã€‚ POJO(plain ordinary java object) ç®€å•æ— è§„åˆ™ java å¯¹è±¡çº¯çš„ä¼ ç»Ÿæ„ä¹‰çš„ java å¯¹è±¡ã€‚å°±æ˜¯è¯´åœ¨ä¸€äº› Object/Relation Mapping å·¥å…·ä¸­ï¼Œèƒ½å¤Ÿåšåˆ°ç»´æŠ¤æ•°æ®åº“è¡¨è®°å½•çš„ persisent object å®Œå…¨æ˜¯ä¸€ä¸ªç¬¦åˆ Java Bean è§„èŒƒçš„çº¯ Java å¯¹è±¡ï¼Œæ²¡æœ‰å¢åŠ åˆ«çš„å±æ€§å’Œæ–¹æ³•ã€‚æˆ‘çš„ç†è§£å°±æ˜¯æœ€åŸºæœ¬çš„ Java Bean ï¼Œåªæœ‰å±æ€§å­—æ®µåŠ setter å’Œ getter æ–¹æ³•ï¼ã€‚ DAO(data access object) æ•°æ®è®¿é—®å¯¹è±¡æ˜¯ä¸€ä¸ª sun çš„ä¸€ä¸ªæ ‡å‡† j2ee è®¾è®¡æ¨¡å¼ï¼Œ è¿™ä¸ªæ¨¡å¼ä¸­æœ‰ä¸ªæ¥å£å°±æ˜¯ DAO ï¼Œå®ƒè´ŸæŒä¹…å±‚çš„æ“ä½œã€‚ä¸ºä¸šåŠ¡å±‚æä¾›æ¥å£ã€‚æ­¤å¯¹è±¡ç”¨äºè®¿é—®æ•°æ®åº“ã€‚é€šå¸¸å’Œ PO ç»“åˆä½¿ç”¨ï¼Œ DAO ä¸­åŒ…å«äº†å„ç§æ•°æ®åº“çš„æ“ä½œæ–¹æ³•ã€‚é€šè¿‡å®ƒçš„æ–¹æ³• , ç»“åˆ PO å¯¹æ•°æ®åº“è¿›è¡Œç›¸å…³çš„æ“ä½œã€‚å¤¹åœ¨ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®åº“èµ„æºä¸­é—´ã€‚é…åˆ VO, æä¾›æ•°æ®åº“çš„ CRUD æ“ä½œ è®¾è®¡æ¨¡å¼åˆ†ç±»è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼Œå…±23ç§ã€‚ åˆ›å»ºå‹æ¨¡å¼ï¼šå•ä¾‹æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€‚ ç»“æ„å‹æ¨¡å¼ï¼šé€‚é…å™¨æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€‚ è¡Œä¸ºå‹æ¨¡å¼ï¼šæ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreteræ¨¡å¼ï¼‰ã€çŠ¶æ€æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€èŒè´£é“¾æ¨¡å¼(è´£ä»»é“¾æ¨¡å¼)ã€è®¿é—®è€…æ¨¡å¼ã€‚ 23ç§è®¾è®¡æ¨¡å¼ç®€å•ä»‹ç»Abstract Factoryï¼ˆæŠ½è±¡å·¥å‚æ¨¡å¼ï¼‰ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚ Adapterï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚Adapteræ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ Bridgeï¼ˆæ¡¥æ¥æ¨¡å¼ï¼‰ï¼šå°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚ Builderï¼ˆå»ºé€ è€…æ¨¡å¼ï¼‰ï¼šå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚ Chain of Responsibilityï¼ˆè´£ä»»é“¾æ¨¡å¼ï¼‰ï¼šä¸ºè§£é™¤è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´è€¦åˆï¼Œè€Œä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒã€‚ Commandï¼ˆå‘½ä»¤æ¨¡å¼ï¼‰ï¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯å–æ¶ˆçš„æ“ä½œã€‚ Compositeï¼ˆç»„åˆæ¨¡å¼ï¼‰ï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚å®ƒä½¿å¾—å®¢æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œå¤åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚ Decoratorï¼ˆè£…é¥°æ¨¡å¼ï¼‰ï¼šåŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±æ‰©å±•åŠŸèƒ½è€Œè¨€ï¼Œ å®ƒæ¯”ç”Ÿæˆå­ç±»æ–¹å¼æ›´ä¸ºçµæ´»ã€‚ Facadeï¼ˆå¤–è§‚æ¨¡å¼ï¼‰ï¼šä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼ŒFacadeæ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚ Factory Methodï¼ˆå·¥å‚æ¨¡å¼ï¼‰ï¼šå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå°†å“ªä¸€ä¸ªç±»å®ä¾‹åŒ–ã€‚Factory Methodä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚ Flyweightï¼ˆäº«å…ƒæ¨¡å¼ï¼‰ï¼šè¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚ Interpreterï¼ˆè§£æå™¨æ¨¡å¼ï¼‰ï¼šç»™å®šä¸€ä¸ªè¯­è¨€, å®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨, è¯¥è§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚ Iteratorï¼ˆè¿­ä»£å™¨æ¨¡å¼ï¼‰ï¼šæä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ Mediatorï¼ˆä¸­ä»‹æ¨¡å¼ï¼‰ï¼šç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ Mementoï¼ˆå¤‡å¿˜å½•æ¨¡å¼ï¼‰ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯å°†è¯¥å¯¹è±¡æ¢å¤åˆ°ä¿å­˜çš„çŠ¶æ€ã€‚ Observerï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰ï¼šå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»,ä»¥ä¾¿å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶,æ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨åˆ·æ–°ã€‚ Prototypeï¼ˆåŸå‹æ¨¡å¼ï¼‰ï¼šç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™ä¸ªåŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ Proxyï¼ˆä»£ç†æ¨¡å¼ï¼‰ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ Singletonï¼ˆå•ä¾‹æ¨¡å¼ï¼‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚ å•ä¾‹æ¨¡å¼æ˜¯æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œä½†æ˜¯å¯¹äºJavaçš„å¼€å‘è€…æ¥è¯´ï¼Œå®ƒå´æœ‰å¾ˆå¤šç¼ºé™·ã€‚åœ¨ä¹æœˆçš„ä¸“æ ä¸­ï¼ŒDavid Gearyæ¢è®¨äº†å•ä¾‹æ¨¡å¼ä»¥åŠåœ¨é¢å¯¹å¤šçº¿ç¨‹ï¼ˆmulti-threadingï¼‰ã€ç±»è£…è½½å™¨ï¼ˆclass loadersï¼‰å’Œåºåˆ—åŒ–ï¼ˆserializationï¼‰æ—¶å¦‚ä½•å¤„ç†è¿™äº›ç¼ºé™·ã€‚ Stateï¼ˆçŠ¶æ€æ¨¡å¼ï¼‰ï¼šå…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒæ‰€å±çš„ç±»ã€‚ Strategyï¼ˆç­–ç•¥æ¨¡å¼ï¼‰ï¼šå®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚æœ¬æ¨¡å¼ä½¿å¾—ç®—æ³•çš„å˜åŒ–å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ã€‚ Template Methodï¼ˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼‰ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚Template Methodä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚ Visitorï¼ˆè®¿é—®è€…æ¨¡å¼ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œã€‚å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚","categories":[],"tags":[{"name":"æœ¯è¯­","slug":"æœ¯è¯­","permalink":"https://hsb786.github.io/tags/æœ¯è¯­/"}]},{"title":"è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿","slug":"è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿","date":"2018-04-09T00:42:41.000Z","updated":"2018-04-15T10:37:44.365Z","comments":true,"path":"2018/04/09/è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿/","link":"","permalink":"https://hsb786.github.io/2018/04/09/è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿/","excerpt":"æ¥å£ä¸å¯ä»¥å®ç°æ¥å£ï¼Œå¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£ æŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿å…·ä½“ç±» staticä¸èƒ½è¢«é‡å†™ï¼Œé‡å†™æ˜¯è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ staticå˜é‡å‘ç”Ÿåœ¨é™æ€è§£æé˜¶æ®µï¼Œæ­¤æ—¶å·²ç»å°†å­—æ®µçš„ç¬¦å·å¼•ç”¨è½¬æ¢æˆäº†å†…å­˜å¼•ç”¨ï¼Œå°†å®ƒä¸å¯¹åº”çš„ç±»å…³è”åœ¨äº†ä¸€èµ·","text":"æ¥å£ä¸å¯ä»¥å®ç°æ¥å£ï¼Œå¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£ æŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿å…·ä½“ç±» staticä¸èƒ½è¢«é‡å†™ï¼Œé‡å†™æ˜¯è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ staticå˜é‡å‘ç”Ÿåœ¨é™æ€è§£æé˜¶æ®µï¼Œæ­¤æ—¶å·²ç»å°†å­—æ®µçš„ç¬¦å·å¼•ç”¨è½¬æ¢æˆäº†å†…å­˜å¼•ç”¨ï¼Œå°†å®ƒä¸å¯¹åº”çš„ç±»å…³è”åœ¨äº†ä¸€èµ·å­ç±»æ„é€ æ–¹æ³•é»˜è®¤ä¼šå¯»æ‰¾çˆ¶ç±»æ— å‚æ„é€ æ–¹æ³•ï¼Œè‹¥æ²¡æœ‰ï¼Œç¼–è¯‘ä¸é€šè¿‡ å…³äºæŠ½è±¡ç±»JDK 1.8ä»¥å‰ï¼ŒæŠ½è±¡ç±»çš„æ–¹æ³•é»˜è®¤è®¿é—®æƒé™ä¸ºprotectedJDK 1.8æ—¶ï¼ŒæŠ½è±¡ç±»çš„æ–¹æ³•é»˜è®¤è®¿é—®æƒé™å˜ä¸ºdefault å…³äºæ¥å£JDK 1.8ä»¥å‰ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å¿…é¡»æ˜¯publicçš„JDK 1.8æ—¶ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯defaultï¼Œè¿˜å¯ä»¥æ˜¯staticJDK 1.9æ—¶ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯privateçš„ volatile ç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼š æ·»åŠ å†…å­˜å±éšœï¼Œä¿è¯å‰é¢å·²ç»å®Œæˆï¼Œåé¢éƒ½æ²¡å¼€å§‹ï¼ˆhappens-beforeï¼‰ å†…éƒ¨ç±»è®¿é—®å¤–éƒ¨ç±» å¤–éƒ¨ç±».this.æˆå‘˜XX é‡è½½é™æ€ç»‘å®šï¼Œæ ¹æ®å‚æ•°çš„é™æ€ç±»å‹è€Œä¸æ˜¯å®é™…ç±»å‹ä½œä¸ºåˆ¤æ–­ä¾æ®çš„ javaçš„8ä¸­åŸºæœ¬ç±»å‹ï¼Œé™¤äº†floatå’Œdoubleä¹‹å¤–ï¼Œå…¶å®ƒ6ç§éƒ½å®ç°äº†å¸¸é‡æ±  booleanç±»å‹ä¸å…è®¸è¿›è¡Œä»»ä½•ç±»å‹çš„è½¬æ¢å¤„ç† java7ä»¥åï¼Œå¸¸é‡æ± è¢«æ”¾å…¥åˆ°å †ç©ºé—´ä¸­ã€‚å¯¼è‡´intern()å‡½æ•°çš„åŠŸèƒ½ä¸åŒã€‚intern()æ£€æŸ¥å¸¸é‡æ± æ—¶å€™å­˜åœ¨è¯¥å­—ç¬¦ä¸²ï¼Œå­˜åœ¨çš„è¯å°±ç›´æ¥è¿”å›ï¼›å¦åˆ™è¿”å›é¦–æ¬¡åœ¨å †ä¸­å£°æ˜çš„ç›¸åŒå­—ç¬¦ä¸²çš„å¼•ç”¨ ArrayList é»˜è®¤å®¹é‡ 10 HashMap 16 newInstance ä½æ•ˆç‡ï¼Œåªèƒ½è°ƒç”¨æ— å‚æ„é€ ã€‚å°†newè¿™ä¸ªæ–¹å¼åˆ†è§£ä¸ºä¸¤æ­¥ï¼š é¦–å…ˆè°ƒç”¨classçš„åŠ è½½æ–¹å¼åŠ è½½æŸä¸ªç±»ï¼Œç„¶åå®ä¾‹åŒ– HashSetåº•å±‚å€Ÿç”¨HashMapï¼Œåˆ©ç”¨HashMapä¸­keyä¸é‡å¤çš„ç‰¹æ€§ 12345private static final Object PRESENT=new Object(); public boolean add(E e) &#123; return map.put(e, PRESENT)==null;&#125; å­—ç¬¦åªæœ‰åœ¨å†…å­˜ä¸­æ‰ä¼šå½¢æˆï¼Œå…¶å®ƒéƒ½æ˜¯ä»¥å­—èŠ‚çš„æ–¹å¼è¿›è¡Œçš„ å¼ºå¼•ç”¨ï¼š Object obj=new Object()ï¼Œåªè¦å¼•ç”¨è¿˜åœ¨ï¼Œå°±ä¸ä¼šè¢«å›æ”¶è½¯å¼•ç”¨ï¼š å†…å­˜ä¸å¤Ÿæ‰ä¼šè¢«å›æ”¶å¼±å¼•ç”¨ï¼š ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ä¼šè¢«å›æ”¶ã€‚è™šå¼•ç”¨ï¼š éšæ—¶å¯èƒ½è¢«å›æ”¶ï¼Œç›®çš„æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ å†…åŠ è½½å™¨ï¼š JVMåŠ¨æ€åŠ è½½æ‰€éœ€çš„ç±»ã€‚ å§”æ‰˜ã€å¯è§ã€å•ä¸€ã€‚åŒäº²å§”æ´¾ï¼Œäº¤ç»™çˆ¶åŠ è½½å™¨ï¼›çˆ¶åŠ è½½å™¨åŠ è½½çš„ç±»å­åŠ è½½å™¨éƒ½èƒ½çœ‹åˆ°ï¼›ä¸€ä¸ªç±»åªèƒ½è¢«ä¸€ä¸ªåŠ è½½ä¸€æ¬¡ æ¯ä¸ªå¯¹è±¡æœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼š å°±ç»ªé˜Ÿåˆ—ã€é˜»å¡é˜Ÿåˆ— ReentrantLockç»“åˆConditionå¯ä»¥æœ‰é€‰æ‹©æ€§åœ°è¿›è¡Œé€šçŸ¥ï¼Œåœ¨è°ƒåº¦ä¸Šæ›´åŠ çµæ´» æŒ‡ä»¤é‡æ’åºï¼š ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¸ºäº†ä¼˜åŒ–ç¨‹åºæ€§èƒ½è€Œå¯¹æŒ‡ä»¤åºåˆ—è¿›è¡Œé‡æ–°æ’åºçš„ä¸€ç§æ‰‹æ®µ nullå¯ä»¥å¼ºåˆ¶è½¬æ¢ä¸ºä»»ä½•javaç±»ç±»å‹ï¼›å…¶è¿”å›å€¼è¿˜æ˜¯nullï¼Œå¯ä»¥è°ƒç”¨staticæ–¹æ³• åŸºæœ¬ç±»å‹ä¸åŒ…è£…ç±»æ¯”è¾ƒï¼›åŒ…è£…ç±»æ‹†ç®±ï¼Œè¿›è¡Œå€¼æ¯”è¾ƒ å­ç±»ï¼Œä¹Ÿå«å¯¼å‡ºç±»ã€æ´¾ç”Ÿç±» Math.round() +0.5Math.ceil() å‘ä¸Šå–æ•´Math.floor() å‘ä¸‹å–æ•´ ç±»å˜é‡æœ‰é»˜è®¤å€¼ï¼Œå±€éƒ¨å˜é‡æ˜¯æ²¡æœ‰é»˜è®¤å€¼çš„ waitï¼Œsleepéƒ½å¿…é¡»è¿›è¡Œå¼‚å¸¸æ•è· IllegalMonitorStateException æŠ›å‡ºè¯¥å¼‚å¸¸è¡¨æ˜æŸä¸€çº¿ç¨‹å·²ç»è¯•å›¾ç­‰å¾…å¯¹è±¡çš„ç›‘è§†å™¨ï¼Œæˆ–è€…è¯•å›¾é€šçŸ¥å…¶ä»–æ­£åœ¨ç­‰å¾…å¯¹è±¡çš„ç›‘è§†å™¨ï¼Œç„¶è€Œæœ¬èº«æ²¡æœ‰æŒ‡å®šçš„ç›‘è§†å™¨çš„çº¿ç¨‹ã€‚ ä¹Ÿå°±æ˜¯å½“å‰çš„çº¿ç¨‹ä¸æ˜¯æ­¤å¯¹è±¡ç›‘è§†å™¨çš„æ‰€æœ‰è€…ã€‚å½“å‰çº¿ç¨‹è¦é”å®šè¯¥å¯¹è±¡ä¹‹åï¼Œæ‰èƒ½ç”¨é”å®šçš„å¯¹è±¡æ‰§è¡Œè¿™äº›æ–¹æ³•ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°synchronizedå…³é”®å­—ï¼Œé”å®šå“ªä¸ªå¯¹è±¡å°±ç”¨å“ªä¸ªå¯¹è±¡æ¥æ‰§è¡Œnotify(), notifyAll(),wait(), wait(long), wait(long, int)æ“ä½œï¼Œå¦åˆ™å°±ä¼šæŠ¥IllegalMonitorStateExceptionå¼‚å¸¸ã€‚ 1234567891011121314151617181920enum AccountType&#123; SAVING, FIXED, CURRENT; private AccountType() &#123; System.out.println(â€œIt is a account typeâ€); &#125;&#125;class EnumOne&#123; public static void main(String[]args) &#123; System.out.println(AccountType.FIXED); &#125;&#125;//output It is a account typeIt is a account typeIt is a account type æšä¸¾ç±»åœ¨åå°å®ç°æ—¶ï¼Œå®é™…ä¸Šæ˜¯è½¬åŒ–ä¸ºä¸€ä¸ªç»§æ‰¿äº†java.lang.Enumç±»çš„å®ä½“ç±»ï¼ŒåŸå…ˆçš„æšä¸¾ç±»å‹å˜æˆå¯¹åº”çš„å®ä½“ç±»å‹ï¼Œä¸Šä¾‹ä¸­AccountTypeå˜æˆäº†ä¸ªclass AccountTypeï¼Œå¹¶ä¸”ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ„é€ å‡½æ•°ï¼Œè‹¥åŸæ¥æœ‰æ„é€ å‡½æ•°ï¼Œåˆ™åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ ä¸¤ä¸ªå‚æ•°ï¼Œç”Ÿæˆæ–°çš„æ„é€ å‡½æ•°ï¼Œå¦‚ä¸Šä¾‹å­ä¸­ï¼š private AccountType(){ System.out.println(â€œIt is a account typeâ€); } ä¼šå˜æˆï¼š private AccountType(String s, int i){ super(s,i); System.out.println(â€œIt is a account typeâ€); } è€Œåœ¨è¿™ä¸ªç±»ä¸­ï¼Œä¼šæ·»åŠ è‹¥å¹²å­—æ®µæ¥ä»£è¡¨å…·ä½“çš„æšä¸¾ç±»å‹ï¼š 123456public static final AccountType SAVING;public static final AccountType FIXED;public static final AccountType CURRENT; ~~~ è€Œä¸”è¿˜ä¼šæ·»åŠ ä¸€æ®µstaticä»£ç æ®µï¼š static{ SAVING = new AccountType(â€œSAVINGâ€, 0); â€¦ CURRENT = new AccountType(â€œCURRENTâ€, 0); $VALUES = new AccountType[]{ SAVING, FIXED, CURRENT } } ~~~ ä»¥æ­¤æ¥åˆå§‹åŒ–æšä¸¾ä¸­çš„æ¯ä¸ªå…·ä½“ç±»å‹ã€‚ï¼ˆå¹¶å°†æ‰€æœ‰å…·ä½“ç±»å‹æ”¾åˆ°ä¸€ä¸ª$VALUEæ•°ç»„ä¸­ï¼Œä»¥ä¾¿ç”¨åºå·è®¿é—®å…·ä½“ç±»å‹ï¼‰åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­new AccountTypeæ„é€ å‡½æ•°è¢«è°ƒç”¨äº†ä¸‰æ¬¡ï¼Œæ‰€ä»¥Enumä¸­å®šä¹‰çš„æ„é€ å‡½æ•°ä¸­çš„æ‰“å°ä»£ç è¢«æ‰§è¡Œäº†3éã€‚ Javaçš„è·¨å¹³å°ç‰¹æ€§æ˜¯æŒ‡å®ƒçš„å­—èŠ‚ç å¯ä»¥åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œ","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"åŒºåˆ«","slug":"åŒºåˆ«","date":"2018-04-08T23:48:41.000Z","updated":"2018-04-15T06:06:18.932Z","comments":true,"path":"2018/04/09/åŒºåˆ«/","link":"","permalink":"https://hsb786.github.io/2018/04/09/åŒºåˆ«/","excerpt":"sleepå’ŒwaitåŒºåˆ« sleepæ˜¯Threadç±»çš„staticæ–¹æ³•ï¼› waitæ˜¯Objectç±»çš„æ–¹æ³• sleepç¡çœ æ—¶ä¿æŒå¯¹è±¡é”ï¼› waité‡Šæ”¾é” sleepå¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼› waitå¿…é¡»æ”¾åœ¨synchronized blockä¸­ï¼Œå¦åˆ™ä¼šåœ¨runtimeæ—¶æ‰”å‡ºIllegalMonitorStateExcetionå¼‚å¸¸","text":"sleepå’ŒwaitåŒºåˆ« sleepæ˜¯Threadç±»çš„staticæ–¹æ³•ï¼› waitæ˜¯Objectç±»çš„æ–¹æ³• sleepç¡çœ æ—¶ä¿æŒå¯¹è±¡é”ï¼› waité‡Šæ”¾é” sleepå¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼› waitå¿…é¡»æ”¾åœ¨synchronized blockä¸­ï¼Œå¦åˆ™ä¼šåœ¨runtimeæ—¶æ‰”å‡ºIllegalMonitorStateExcetionå¼‚å¸¸ synchronizedå’ŒvolatileåŒºåˆ« volatileæ˜¯çº¿ç¨‹åŒæ­¥çš„è½»é‡çº§å®ç°ï¼Œæ€§èƒ½æ¯”synchronizedå¥½ volatileåªèƒ½ä¿®é¥°å˜é‡ï¼› synchronizedå¯ä¿®é¥°æ–¹æ³•å’Œä»£ç å— volatileèƒ½ä¿è¯æ•°æ®å¯è§æ€§ï¼Œä¸ä¿è¯åŸå­æ€§ï¼› synchronizedå¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥é—´æ¥ä¿è¯å¯è§æ€§ã€‚synchronizedä¼šå°†ç§æœ‰å†…å­˜å’Œå…¬å…±å†…å­˜ä¸­çš„æ•°æ®è¿›è¡ŒåŒæ­¥ volatileè§£å†³çš„æ˜¯å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹é—´çš„å¯è§æ€§ï¼› synchronizedè§£å†³çš„æ˜¯å¤šä¸ªçº¿ç¨‹è®¿é—®èµ„æºçš„åŒæ­¥æ€§ å†…éƒ¨ç±»åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªç±»(ç§æœ‰å†…éƒ¨ç±»ï¼Œé™æ€å†…éƒ¨ç±»)åœ¨æ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç±»(å±€éƒ¨å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±») ç§æœ‰å†…éƒ¨ç±»ç¼–è¯‘å™¨åšçš„æ‰‹è„š åœ¨å†…éƒ¨ç±»ä¸­åˆ›å»ºäº†åŒ…å¯è§æ„é€ å™¨ï¼Œä»è€Œä½¿å¤–éƒ¨ç±»è·å¾—äº†åˆ›å»ºæƒé™ åœ¨å¤–éƒ¨ç±»ä¸­åˆ›å»ºäº†è®¿é—®ç§æœ‰å˜é‡çš„é™æ€æ–¹æ³•ï¼Œä»è€Œä½¿å†…éƒ¨ç±»è·å¾—äº†èŒƒå›´æƒé™ é™æ€å†…éƒ¨ç±»åªèƒ½è®¿é—®å…¶å¤–éƒ¨ç±»çš„é™æ€æˆå‘˜ å±€éƒ¨å†…éƒ¨ç±»æ²¡æœ‰ä¿®é¥°ç¬¦ï¼Œå±€éƒ¨å†…éƒ¨ç±»åªèƒ½èŒƒå›´è¯¥æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”è¿™äº›å±€éƒ¨å˜é‡ä¸€å®šè¦æ˜¯finalä¿®é¥°çš„å¸¸é‡æˆ–è€…éšå«æ˜¯finalçš„(java8) åŒ¿åå†…éƒ¨ç±»ä¸èƒ½æŠ½è±¡ï¼›ä»…èƒ½è¢«ä½¿ç”¨ä¸€æ¬¡ï¼›ä¸èƒ½å­˜åœ¨é™æ€æˆå‘˜å˜é‡å’Œæ–¹æ³• åªæœ‰é™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®é™æ€æˆå‘˜å˜é‡ Sessionå’ŒCookieçš„åŒºåˆ« Sessionæ˜¯åœ¨æœåŠ¡ç«¯ä¿å­˜çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨æ¥è·Ÿè¸ªç”¨æˆ·çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ•°æ®å¯ä»¥ä¿å­˜åœ¨é›†ç¾¤ã€æ•°æ®åº“ã€æ–‡ä»¶ä¸­ã€‚ Cookieæ˜¯å®¢æˆ·ç«¯ä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨æ¥è®°å½•ç”¨æˆ·çš„ä¸€äº›ä¿¡æ¯ï¼Œä¹Ÿæ˜¯å®ç°Sessionçš„ä¸€ç§æ–¹å¼ã€‚ å®¢æˆ·ç«¯ä¼ JSESSIONIDï¼ŒæœåŠ¡ç«¯å°±å¯ä»¥é€šè¿‡è¿™ä¸ªIDï¼Œæ¥å°†å­˜å‚¨åˆ°æœåŠ¡ç«¯çš„æ•°æ®å–å‡º Servletå’ŒFilterçš„åŒºåˆ« Filterå¯¹ç”¨æˆ·è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ï¼Œæ¥ç€å°†è¯·æ±‚äº¤ç»™Servletè¿›è¡Œå¤„ç†å¹¶ç”Ÿæˆå“åº”ï¼Œæœ€åFilterå†å¯¹å“åº”çš„æ•°æ®è¿›è¡Œåå¤„ç†ã€‚ å¼ºã€è½¯ã€å¼±ã€è™šå¼•ç”¨å¼ºå¼•ç”¨ Object obj=new Object()ï¼Œåªè¦å¼•ç”¨è¿˜åœ¨ï¼Œå°±ä¸ä¼šè¢«å›æ”¶è½¯å¼•ç”¨ å†…å­˜ä¸å¤Ÿæ‰ä¼šè¢«å›æ”¶å¼±å¼•ç”¨ ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ä¼šè¢«å›æ”¶ã€‚è™šå¼•ç”¨ éšæ—¶å¯èƒ½è¢«å›æ”¶ï¼Œç›®çš„æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚ åƒåœ¾å›æ”¶æœŸæ˜¯ä¸€ä¸ªä¼˜å…ˆçº§è¾ƒä½çš„çº¿ç¨‹ï¼Œå¹¶ä¸ä¸€å®šèƒ½è¿…é€Ÿå‘ç°å¼±å¼•ç”¨å¯¹è±¡ HashMapå’ŒHashtableçš„åŒºåˆ«å…ˆåæ§½ä¸€ä¸‹Hashtableçš„å‘½åï¼Œä¸ºå•¥tè¦å°å†™ Hashtableæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼› HashMapä¸æ˜¯ Hashtableä¸å…è®¸æœ‰nullçš„KVï¼› HashMapå…è®¸ Hashtableç»§æ‰¿Dictionaryç±»ï¼› HashMapç»§æ‰¿AbstractMap HashMapæœ‰ä¸€ä¸ªå­ç±»LinkedHashMapï¼Œå¯¹è¿™ä¸ªç±»å¯¹è±¡è¿›è¡Œè¿­ä»£æ—¶ï¼Œå®ƒçš„é¡ºåºæ˜¯æœ‰åºçš„ã€‚å¯ä»¥è½»æ˜“çš„å°†LinkedHashMapè½¬æ¢æˆHashMapï¼› Hashtableä¸å¥½å®ç° ç›¸åŒç‚¹ï¼šéƒ½å®ç°äº†Mapæ¥å£ joinå’Œsynchronizedçš„åŒºåˆ«joinåœ¨å†…éƒ¨ä½¿ç”¨wait()æ–¹æ³•è¿›è¡Œç­‰å¾…ï¼›synchronizedä½¿ç”¨çš„æ˜¯å¯¹è±¡ç›‘è§†å™¨åŸç†ä½œä¸ºåŒæ­¥ joinå’Œsleepçš„åŒºåˆ«joinåº•å±‚è°ƒç”¨waitæ–¹æ³•ï¼Œæ‰§è¡Œåˆ°waité‡Šæ”¾é”sleepåœ¨ç¡çœ æ—¶ä¸é‡Šæ”¾é” JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†çš„åŒºåˆ« JDKåŠ¨æ€åŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨åå°„æœºåˆ¶ç”Ÿå­˜ä¸€ä¸ªå®ç°ä»£ç†æ¥å£çš„åŒ¿åç±»ï¼Œåœ¨è°ƒç”¨å…·ä½“æ–¹æ³•å‰è°ƒç”¨InvokeHandleræ¥å¤„ç†ã€‚JDKåŠ¨æ€ä»£ç†åªèƒ½å¯¹å®ç°äº†æ¥å£çš„ç±»ç”Ÿæˆä»£ç†ï¼Œè€Œä¸èƒ½é’ˆå¯¹ç±» CGLIBåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨ASMå¼€æºåŒ…ï¼Œå°†ç›®æ ‡å¯¹è±¡ç±»çš„classæ–‡ä»¶åŠ è½½è¿›æ¥ï¼Œé€šè¿‡ä¿®æ”¹å…¶å­—èŠ‚ç ç”Ÿæˆå­ç±»æ¥å¤„ç†ã€‚CGLIBæ˜¯é’ˆå¯¹ç±»å®ç°ä»£ç†ï¼Œä¸»è¦æ˜¯å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ–¹æ³•ã€‚ JDKåŠ¨æ€ä»£ç†æ˜¯é¢å‘æ¥å£çš„ï¼Œåœ¨åˆ›å»ºä»£ç†å®ç°ç±»æ—¶æ¯”CGLIBè¦å¿«ï¼Œåˆ›å»ºä»£ç†é€Ÿåº¦å¿«ã€‚CGLIBåŠ¨æ€ä»£ç†æ˜¯é€šè¿‡å­—èŠ‚ç åº•å±‚ç»§æ‰¿è¦ä»£ç†ç±»çš„ç›®æ ‡ç±»æ¥å®ç°ï¼Œåˆ›å»ºé€Ÿåº¦æ²¡æœ‰JDKåŠ¨æ€ä»£ç†å¿«ï¼Œä½†æ˜¯è¿è¡Œé€Ÿåº¦æ¯”JDKåŠ¨æ€ä»£ç†å¿«ã€‚ é‡è½½å’Œé‡å†™çš„åŒºåˆ«é‡è½½ï¼š æ–¹æ³•æœ‰åŒæ ·çš„åç§°ï¼Œä½†æ˜¯å‚æ•°åˆ—è¡¨ä¸åŒ é‡å†™ï¼šåœ¨javaçš„å­ç±»ä¸çˆ¶ç±»ä¸­æœ‰ä¸¤ä¸ªåç§°ã€å‚æ•°åˆ—è¡¨éƒ½ç›¸åŒçš„æ–¹æ³•çš„æƒ…å†µã€‚ç”±äºå®ƒä»¬å…·æœ‰ç›¸åŒçš„æ–¹æ³•ç­¾åï¼Œæ‰€ä»¥å­ç±»ä¸­çš„æ–°æ–¹æ³•å°†è¦†ç›–çˆ¶ç±»ä¸­åŸæœ‰çš„æ–¹æ³• åŒºåˆ« é‡è½½ é‡å†™ ç¼–è¯‘æœŸæ¦‚å¿µï¼Œéµå¾ªâ€œç¼–è¯‘æœŸç»‘å®šâ€ï¼Œå³åœ¨ç¼–è¯‘æ—¶æ ¹æ®å‚æ•°å˜é‡çš„ç±»å‹åˆ¤æ–­åº”è¯¥è°ƒç”¨å“ªä¸ªæ–¹æ³• è¿è¡ŒæœŸæ¦‚å¿µï¼Œéµå¾ªâ€œè¿è¡ŒæœŸç»‘å®šâ€ï¼Œå³åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œæ ¹æ®å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å®é™…å¯¹è±¡çš„ç±»å‹æ¥è°ƒç”¨æ–¹æ³• æ–¹æ³•ç­¾åå¿…é¡»ä¸åŒ æ–¹æ³•ç­¾åå¿…é¡»ä¸€æ · è¿”å›ç±»å‹å¯ä»¥ä¸åŒ è¿”å›ç±»å‹å¿…é¡»ç›¸åŒ æ— é™åˆ¶ æ›´å¥½çš„è®¿é—®ï¼Œä¸èƒ½æŠ›å‡ºæ›´å¹¿æ³›çš„å¼‚å¸¸ï¼ˆéµå¾ªé‡Œå¼æ›¿æ¢åŸåˆ™ï¼‰ ç»„åˆä¸ç»§æ‰¿çš„åŒºåˆ«å’Œè”ç³»åœ¨ç»§æ‰¿ç»“æ„ä¸­ï¼Œçˆ¶ç±»çš„å†…éƒ¨ç»†èŠ‚å¯¹äºå­ç±»æ˜¯å¯è§çš„ã€‚æ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¹Ÿå¯ä»¥è¯´é€šè¿‡ç»§æ‰¿çš„ä»£ç å¤ç”¨æ˜¯ä¸€ç§ç™½ç›’å¼ä»£ç å¤ç”¨ã€‚ï¼ˆå¦‚æœåŸºç±»çš„å®ç°å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»çš„å®ç°ä¹Ÿå°†éšä¹‹æ”¹å˜ã€‚è¿™æ ·å°±å¯¼è‡´äº†å­ç±»è¡Œä¸ºçš„ä¸å¯é¢„çŸ¥æ€§ï¼›) ç»„åˆæ˜¯é€šè¿‡å¯¹ç°æœ‰çš„å¯¹è±¡è¿›è¡Œæ‹¼è£…ï¼ˆç»„åˆï¼‰äº§ç”Ÿæ–°çš„ã€æ›´å¤æ‚çš„åŠŸèƒ½ã€‚å› ä¸ºåœ¨å¯¹è±¡ä¹‹é—´ï¼Œå„è‡ªçš„å†…éƒ¨ç»†èŠ‚æ˜¯ä¸å¯è§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¯´è¿™ç§æ–¹å¼çš„ä»£ç å¤ç”¨æ˜¯é»‘ç›’å¼ä»£ç å¤ç”¨ã€‚ï¼ˆå› ä¸ºç»„åˆä¸­ä¸€èˆ¬éƒ½å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘æœŸæ ¹æœ¬ä¸çŸ¥é“å…·ä½“ä¼šè°ƒç”¨å“ªä¸ªå®ç°ç±»çš„æ–¹æ³•ï¼‰ ç»§æ‰¿ï¼Œåœ¨å†™ä»£ç çš„æ—¶å€™å°±è¦æŒ‡åå…·ä½“ç»§æ‰¿å“ªä¸ªç±»ï¼Œæ‰€ä»¥ï¼Œåœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº†å…³ç³»ã€‚ï¼ˆä»åŸºç±»ç»§æ‰¿æ¥çš„å®ç°æ˜¯æ— æ³•åœ¨è¿è¡ŒæœŸåŠ¨æ€æ”¹å˜çš„ï¼Œå› æ­¤é™ä½äº†åº”ç”¨çš„çµæ´»æ€§ã€‚ï¼‰ ç»„åˆï¼Œåœ¨å†™ä»£ç çš„æ—¶å€™å¯ä»¥é‡‡ç”¨é¢å‘æ¥å£ç¼–ç¨‹ã€‚æ‰€ä»¥ï¼Œç±»çš„ç»„åˆå…³ç³»ä¸€èˆ¬åœ¨è¿è¡ŒæœŸç¡®å®šã€‚ ä¼˜ç¼ºç‚¹å¯¹æ¯” ç»„ åˆ å…³ ç³» ç»§ æ‰¿ å…³ ç³» ä¼˜ç‚¹ï¼šä¸ç ´åå°è£…ï¼Œæ•´ä½“ç±»ä¸å±€éƒ¨ç±»ä¹‹é—´æ¾è€¦åˆï¼Œå½¼æ­¤ç›¸å¯¹ç‹¬ç«‹ ç¼ºç‚¹ï¼šç ´åå°è£…ï¼Œå­ç±»ä¸çˆ¶ç±»ä¹‹é—´ç´§å¯†è€¦åˆï¼Œå­ç±»ä¾èµ–äºçˆ¶ç±»çš„å®ç°ï¼Œå­ç±»ç¼ºä¹ç‹¬ç«‹æ€§ ä¼˜ç‚¹ï¼šå…·æœ‰è¾ƒå¥½çš„å¯æ‰©å±•æ€§ ç¼ºç‚¹ï¼šæ”¯æŒæ‰©å±•ï¼Œä½†æ˜¯å¾€å¾€ä»¥å¢åŠ ç³»ç»Ÿç»“æ„çš„å¤æ‚åº¦ä¸ºä»£ä»· ä¼˜ç‚¹ï¼šæ”¯æŒåŠ¨æ€ç»„åˆã€‚åœ¨è¿è¡Œæ—¶ï¼Œæ•´ä½“å¯¹è±¡å¯ä»¥é€‰æ‹©ä¸åŒç±»å‹çš„å±€éƒ¨å¯¹è±¡ ç¼ºç‚¹ï¼šä¸æ”¯æŒåŠ¨æ€ç»§æ‰¿ã€‚åœ¨è¿è¡Œæ—¶ï¼Œå­ç±»æ— æ³•é€‰æ‹©ä¸åŒçš„çˆ¶ç±» ä¼˜ç‚¹ï¼šæ•´ä½“ç±»å¯ä»¥å¯¹å±€éƒ¨ç±»è¿›è¡ŒåŒ…è£…ï¼Œå°è£…å±€éƒ¨ç±»çš„æ¥å£ï¼Œæä¾›æ–°çš„æ¥å£ ç¼ºç‚¹ï¼šå­ç±»ä¸èƒ½æ”¹å˜çˆ¶ç±»çš„æ¥å£ ç¼ºç‚¹ï¼šæ•´ä½“ç±»ä¸èƒ½è‡ªåŠ¨è·å¾—å’Œå±€éƒ¨ç±»åŒæ ·çš„æ¥å£ ä¼˜ç‚¹ï¼šå­ç±»èƒ½è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„æ¥å£ ç¼ºç‚¹ï¼šåˆ›å»ºæ•´ä½“ç±»çš„å¯¹è±¡æ—¶ï¼Œéœ€è¦åˆ›å»ºæ‰€æœ‰å±€éƒ¨ç±»çš„å¯¹è±¡ ä¼˜ç‚¹ï¼šåˆ›å»ºå­ç±»çš„å¯¹è±¡æ—¶ï¼Œæ— é¡»åˆ›å»ºçˆ¶ç±»çš„å¯¹è±¡ å¦‚ä½•é€‰æ‹© ç»§æ‰¿è¦æ…ç”¨ï¼Œå…¶ä½¿ç”¨åœºåˆä»…é™äºä½ ç¡®ä¿¡ä½¿ç”¨è¯¥æŠ€æœ¯æœ‰æ•ˆçš„æƒ…å†µã€‚ä¸€ä¸ªåˆ¤æ–­æ–¹æ³•æ˜¯ï¼Œé—®ä¸€é—®è‡ªå·±æ˜¯å¦éœ€è¦ä»æ–°ç±»å‘åŸºç±»è¿›è¡Œå‘ä¸Šè½¬å‹ã€‚å¦‚æœæ˜¯å¿…é¡»çš„ï¼Œåˆ™ç»§æ‰¿æ˜¯å¿…è¦çš„ã€‚åä¹‹åˆ™åº”è¯¥å¥½å¥½è€ƒè™‘æ˜¯å¦éœ€è¦ç»§æ‰¿ã€‚&lt;&lt;javaç¼–ç¨‹æ€æƒ³&gt;&gt; åªæœ‰å½“å­ç±»çœŸæ­£æ˜¯è¶…ç±»çš„å­ç±»å‹æ—¶ï¼Œæ‰é€‚åˆç”¨ç»§æ‰¿ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºä¸¤ä¸ªç±»Aå’ŒBï¼Œåªæœ‰å½“ä¸¤è€…ä¹‹é—´ç¡®å®å­˜åœ¨is-aå…³ç³»çš„æ—¶å€™ï¼Œç±»Bæ‰åº”è¯¥ç»§æ‰¿ç±»Aã€‚&lt;> Compareableå’ŒComparatorComparableï¼šä¸€ä¸ªå®ç°äº†Comparableæ¥å£çš„ç±»ï¼Œå¯ä»¥è®©å…¶è‡ªèº«çš„å¯¹è±¡å’Œå…¶å®ƒå¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªç±»çš„å¯¹è±¡ä¹‹é—´è¦æƒ³æ¯”è¾ƒï¼Œå¯¹åº”çš„ç±»å°±è¦å®ç°Compareableæ¥å£ï¼Œå¹¶å®ç°compareTo()æ–¹æ³•ã€‚ Comparatorï¼šä¸æ”¹å˜åŸæœ‰çš„ç±»ã€‚é€šè¿‡å®šä¹‰ä¸€ä¸ªç±»å®ç°Comparatoræ¥å£ï¼Œé‡å†™compare()æ–¹æ³•ã€‚ Comparatoré€šå¸¸ç”¨äºæ’åºã€‚Javaä¸­çš„Collectinoså’ŒArrayséƒ½åŒ…æ‹¬æ’åºçš„sortæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªComparatorçš„å®ä¾‹(æ¯”è¾ƒå™¨)æ¥è¿›è¡Œæ’åºï¼›new TreeSet&lt;&gt;(new Comparator()) getAttributeå’ŒgetParameterçš„åŒºåˆ«ServletRequestæ¥å£ä¸­æä¾›äº†getAttributeå’ŒgetParameterä¸¤ä¸ªæ–¹æ³•ï¼Œéƒ½æ˜¯ç”¨äºè·å–å‚æ•°ï¼ˆå±æ€§ï¼‰å€¼çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæˆ–è€…è¯´Attributeå’ŒParameterçš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æ¥æºä¸åŒ å‚æ•°ï¼ˆparameterï¼‰æ˜¯ä»å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¸­ç”±ç”¨æˆ·æä¾›çš„ï¼Œè‹¥æ˜¯GETæ–¹æ³•æ˜¯ä»URLä¸­ æä¾›çš„ï¼Œè‹¥æ˜¯POSTæ–¹æ³•æ˜¯ä»è¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰ä¸­æä¾›çš„ï¼› å±æ€§ï¼ˆattributeï¼‰æ˜¯æœåŠ¡å™¨ç«¯çš„ç»„ä»¶ï¼ˆJSPæˆ–è€…Servletï¼‰åˆ©ç”¨requst.setAttributeï¼ˆï¼‰è®¾ç½®çš„. æ“ä½œä¸åŒ å‚æ•°ï¼ˆparameterï¼‰çš„å€¼åªèƒ½è¯»å–ä¸èƒ½ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.getParameter()è¯»å–ï¼› å±æ€§ï¼ˆattributeï¼‰çš„å€¼æ—¢å¯ä»¥è¯»å–äº¦å¯ä»¥ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.setAttribute(),è®¾ç½®å¯ä½¿ç”¨request.getAttribute() æ•°æ®ç±»å‹ä¸åŒ å‚æ•°ï¼ˆparameterï¼‰ä¸ç®¡å‰å°ä¼ æ¥çš„å€¼è¯­ä¹‰æ˜¯ä»€ä¹ˆï¼Œåœ¨æœåŠ¡å™¨è·å–æ—¶éƒ½ä»¥Stringç±»å‹çœ‹å¾…ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯çš„å‚æ•°å€¼åªèƒ½æ˜¯ç®€å•ç±»å‹çš„å€¼ï¼Œä¸èƒ½æ˜¯å¤æ‚ç±»å‹ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯¹è±¡ã€‚ å±æ€§ï¼ˆattributeï¼‰çš„å€¼å¯ä»¥æ˜¯ä»»æ„ä¸€ä¸ªObjectç±»å‹ã€‚ forwardå’Œincludeçš„åŒºåˆ«void forward(ServletRequest request, ServletResponse response) â€“ æŠŠä¸€ä¸ªservletçš„è¯·æ±‚è½¬å‘åˆ°æœåŠ¡å™¨ä¸Šçš„å…¶ä»–èµ„æºä¸­ï¼ˆHtmlã€jspã€servletï¼‰ã€‚ void include(ServletRequest request, ServletResponse response) â€“ æŠŠå¦ä¸€ä¸ªèµ„æºçš„å†…å®¹åŒ…å«åˆ°å½“å‰å“åº”ä¸­ã€‚ å¦‚æœä½¿ç”¨forwardè·³è½¬ï¼Œforwardè¯­å¥åé¢çš„responseè¾“å‡ºåˆ™ä¸ä¼šæ‰§è¡Œï¼Œä¼šè·³è½¬åˆ°forwardæŒ‡å®šçš„servletä¸­å»æ‰§è¡Œã€‚ ç”¨includeæ¥è·³è½¬ï¼Œåˆ™includeçš„servletæ‰§è¡Œå®Œåï¼Œå†è¿”å›åˆ°åŸæ¥çš„servletæ‰§è¡Œforwardè¯­å¥åé¢çš„responseçš„è¾“å‡ºã€‚","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"hashï¼ˆè½¬è½½ï¼‰","slug":"hashï¼ˆè½¬è½½ï¼‰","date":"2018-04-08T13:23:41.000Z","updated":"2018-04-15T05:49:44.734Z","comments":true,"path":"2018/04/08/hashï¼ˆè½¬è½½ï¼‰/","link":"","permalink":"https://hsb786.github.io/2018/04/08/hashï¼ˆè½¬è½½ï¼‰/","excerpt":"Hashï¼Œä¸€èˆ¬ç¿»è¯‘åšâ€œæ•£åˆ—â€ï¼Œä¹Ÿæœ‰ç›´æ¥éŸ³è¯‘ä¸ºâ€œå“ˆå¸Œâ€çš„ï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œé€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ã€‚è¿™ç§è½¬æ¢æ˜¯ä¸€ç§å‹ç¼©æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ•£åˆ—å€¼çš„ç©ºé—´é€šå¸¸è¿œå°äºè¾“å…¥çš„ç©ºé—´ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šæ•£åˆ—æˆç›¸åŒçš„è¾“å‡ºï¼Œæ‰€ä»¥ä¸å¯èƒ½ä»æ•£åˆ—å€¼æ¥å”¯ä¸€çš„ç¡®å®šè¾“å…¥å€¼ã€‚ç®€å•çš„è¯´å°±æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯æ‘˜è¦çš„å‡½æ•°ã€‚","text":"Hashï¼Œä¸€èˆ¬ç¿»è¯‘åšâ€œæ•£åˆ—â€ï¼Œä¹Ÿæœ‰ç›´æ¥éŸ³è¯‘ä¸ºâ€œå“ˆå¸Œâ€çš„ï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œé€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ã€‚è¿™ç§è½¬æ¢æ˜¯ä¸€ç§å‹ç¼©æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ•£åˆ—å€¼çš„ç©ºé—´é€šå¸¸è¿œå°äºè¾“å…¥çš„ç©ºé—´ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šæ•£åˆ—æˆç›¸åŒçš„è¾“å‡ºï¼Œæ‰€ä»¥ä¸å¯èƒ½ä»æ•£åˆ—å€¼æ¥å”¯ä¸€çš„ç¡®å®šè¾“å…¥å€¼ã€‚ç®€å•çš„è¯´å°±æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯æ‘˜è¦çš„å‡½æ•°ã€‚ æ‰€æœ‰æ•£åˆ—å‡½æ•°éƒ½æœ‰å¦‚ä¸‹ä¸€ä¸ªåŸºæœ¬ç‰¹æ€§ï¼šæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„æ•£åˆ—å€¼å¦‚æœä¸åŒï¼Œé‚£ä¹ˆè¾“å…¥å€¼è‚¯å®šä¹Ÿä¸åŒã€‚ä½†æ˜¯ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„æ•£åˆ—å€¼å¦‚æœç›¸åŒï¼Œè¾“å…¥å€¼ä¸ä¸€å®šç›¸åŒã€‚ ä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„æ•£åˆ—å€¼ç›¸åŒçš„ç°è±¡å«åšç¢°æ’ã€‚ å¸¸è§çš„Hashå‡½æ•°æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š ç›´æ¥å®šå€æ³•ï¼šç›´æ¥ä»¥å…³é”®å­—kæˆ–è€…kåŠ ä¸ŠæŸä¸ªå¸¸æ•°ï¼ˆk+cï¼‰ä½œä¸ºå“ˆå¸Œåœ°å€ã€‚ æ•°å­—åˆ†ææ³•ï¼šæå–å…³é”®å­—ä¸­å–å€¼æ¯”è¾ƒå‡åŒ€çš„æ•°å­—ä½œä¸ºå“ˆå¸Œåœ°å€ã€‚ é™¤ç•™ä½™æ•°æ³•ï¼šç”¨å…³é”®å­—ké™¤ä»¥æŸä¸ªä¸å¤§äºå“ˆå¸Œè¡¨é•¿åº¦mçš„æ•°pï¼Œå°†æ‰€å¾—ä½™æ•°ä½œä¸ºå“ˆå¸Œè¡¨åœ°å€ã€‚ åˆ†æ®µå åŠ æ³•ï¼šæŒ‰ç…§å“ˆå¸Œè¡¨åœ°å€ä½æ•°å°†å…³é”®å­—åˆ†æˆä½æ•°ç›¸ç­‰çš„å‡ éƒ¨åˆ†ï¼Œå…¶ä¸­æœ€åä¸€éƒ¨åˆ†å¯ä»¥æ¯”è¾ƒçŸ­ã€‚ç„¶åå°†è¿™å‡ éƒ¨åˆ†ç›¸åŠ ï¼Œèˆå¼ƒæœ€é«˜è¿›ä½åçš„ç»“æœå°±æ˜¯è¯¥å…³é”®å­—çš„å“ˆå¸Œåœ°å€ã€‚ å¹³æ–¹å–ä¸­æ³•ï¼šå¦‚æœå…³é”®å­—å„ä¸ªéƒ¨åˆ†åˆ†å¸ƒéƒ½ä¸å‡åŒ€çš„è¯ï¼Œå¯ä»¥å…ˆæ±‚å‡ºå®ƒçš„å¹³æ–¹å€¼ï¼Œç„¶åæŒ‰ç…§éœ€æ±‚å–ä¸­é—´çš„å‡ ä½ä½œä¸ºå“ˆå¸Œåœ°å€ã€‚ ä¼ªéšæœºæ•°æ³•ï¼šé‡‡ç”¨ä¸€ä¸ªä¼ªéšæœºæ•°å½“ä½œå“ˆå¸Œå‡½æ•°ã€‚ ä¸Šé¢ä»‹ç»è¿‡ç¢°æ’ã€‚è¡¡é‡ä¸€ä¸ªå“ˆå¸Œå‡½æ•°çš„å¥½åçš„é‡è¦æŒ‡æ ‡å°±æ˜¯å‘ç”Ÿç¢°æ’çš„æ¦‚ç‡ä»¥åŠå‘ç”Ÿç¢°æ’çš„è§£å†³æ–¹æ¡ˆã€‚ä»»ä½•å“ˆå¸Œå‡½æ•°åŸºæœ¬éƒ½æ— æ³•å½»åº•é¿å…ç¢°æ’ï¼Œå¸¸è§çš„è§£å†³ç¢°æ’çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š å¼€æ”¾å®šå€æ³•ï¼š å¼€æ”¾å®šå€æ³•å°±æ˜¯ä¸€æ—¦å‘ç”Ÿäº†å†²çªï¼Œå°±å»å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºçš„æ•£åˆ—åœ°å€ï¼Œåªè¦æ•£åˆ—è¡¨è¶³å¤Ÿå¤§ï¼Œç©ºçš„æ•£åˆ—åœ°å€æ€»èƒ½æ‰¾åˆ°ï¼Œå¹¶å°†è®°å½•å­˜å…¥ã€‚ é“¾åœ°å€æ³• å°†å“ˆå¸Œè¡¨çš„æ¯ä¸ªå•å…ƒä½œä¸ºé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œæ‰€æœ‰å“ˆå¸Œåœ°å€ä¸ºiçš„å…ƒç´ æ„æˆä¸€ä¸ªåŒä¹‰è¯é“¾è¡¨ã€‚å³å‘ç”Ÿå†²çªæ—¶å°±æŠŠè¯¥å…³é”®å­—é“¾åœ¨ä»¥è¯¥å•å…ƒä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨çš„å°¾éƒ¨ã€‚ å†å“ˆå¸Œæ³• å½“å“ˆå¸Œåœ°å€å‘ç”Ÿå†²çªç”¨å…¶ä»–çš„å‡½æ•°è®¡ç®—å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°åœ°å€ï¼Œç›´åˆ°å†²çªä¸å†äº§ç”Ÿä¸ºæ­¢ã€‚ å»ºç«‹å…¬å…±æº¢å‡ºåŒº å°†å“ˆå¸Œè¡¨åˆ†ä¸ºåŸºæœ¬è¡¨å’Œæº¢å‡ºè¡¨ä¸¤éƒ¨åˆ†ï¼Œå‘ç”Ÿå†²çªçš„å…ƒç´ éƒ½æ”¾å…¥æº¢å‡ºè¡¨ä¸­ã€‚ å‚è€ƒ å…¨ç½‘æŠŠMapä¸­çš„hash()åˆ†æçš„æœ€é€å½»çš„æ–‡ç« ï¼Œåˆ«æ— äºŒå®¶ã€‚","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"äº‹åŠ¡","slug":"äº‹åŠ¡","date":"2018-04-08T09:58:41.000Z","updated":"2018-04-14T07:56:31.393Z","comments":true,"path":"2018/04/08/äº‹åŠ¡/","link":"","permalink":"https://hsb786.github.io/2018/04/08/äº‹åŠ¡/","excerpt":"äº‹åŠ¡ï¼ˆTransactionï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¦åšçš„æˆ–æ‰€åšçš„äº‹æƒ…ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­æ˜¯æŒ‡è®¿é—®å¹¶å¯èƒ½æ›´æ–°æ•°æ®åº“ä¸­å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒï¼ˆunitï¼‰ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­ï¼Œäº‹åŠ¡é€šå¸¸å°±æ˜¯æŒ‡æ•°æ®åº“äº‹åŠ¡ã€‚","text":"äº‹åŠ¡ï¼ˆTransactionï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¦åšçš„æˆ–æ‰€åšçš„äº‹æƒ…ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­æ˜¯æŒ‡è®¿é—®å¹¶å¯èƒ½æ›´æ–°æ•°æ®åº“ä¸­å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒï¼ˆunitï¼‰ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­ï¼Œäº‹åŠ¡é€šå¸¸å°±æ˜¯æŒ‡æ•°æ®åº“äº‹åŠ¡ã€‚ æ¦‚å¿µä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡é€šå¸¸åŒ…å«å¯¹æ•°æ®åº“è¿›è¡Œè¯»æˆ–å†™çš„ä¸€ä¸ªæ“ä½œåºåˆ—ã€‚å®ƒçš„å­˜åœ¨åŒ…æ‹¬æœ‰ä»¥ä¸‹ä¸¤ä¸ªç›®çš„ ä¸ºæ•°æ®åº“æä¾›äº†ä¸€ä¸ªä»å¤±è´¥ä¸­æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€çš„æ–¹æ³•ï¼ŒåŒæ—¶æä¾›äº†æ•°æ®åº“å³ä½¿åœ¨å¼‚å¸¸çŠ¶æ€ä¸‹ä»èƒ½ä¿æŒä¸€è‡´æ€§çš„æ–¹æ³•ã€‚ å½“å¤šä¸ªåº”ç”¨ç¨‹åºåœ¨å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œå¯ä»¥åœ¨è¿™äº›åº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¸€ä¸ªéš”ç¦»çš„æ–¹æ³•ï¼Œä»¥é˜²æ­¢å½¼æ­¤çš„æ“ä½œäº’ç›¸å¹²æ‰°ã€‚ å½“ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ç»™äº†DBMSï¼ˆæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰ï¼Œåˆ™DBMSéœ€è¦ç¡®ä¿è¯¥äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸå®Œæˆä¸”å…¶ç»“æœè¢«æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå¦‚æœäº‹åŠ¡ä¸­æœ‰çš„æ“ä½œæ²¡æœ‰æˆåŠŸå®Œæˆï¼Œåˆ™äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½éœ€è¦è¢«å›æ»šï¼Œå›åˆ°äº‹åŠ¡æ‰§è¡Œå‰çš„çŠ¶æ€ï¼ˆè¦ä¹ˆå…¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ½ä¸æ‰§è¡Œï¼‰;åŒæ—¶ï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æˆ–è€…å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œæ— å½±å“ï¼Œæ‰€æœ‰çš„äº‹åŠ¡éƒ½å¥½åƒåœ¨ç‹¬ç«‹çš„è¿è¡Œã€‚ ä½†åœ¨ç°å®æƒ…å†µä¸‹ï¼Œå¤±è´¥çš„é£é™©å¾ˆé«˜ã€‚åœ¨ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰å¯èƒ½ä¼šé‡ä¸Šäº‹åŠ¡æ“ä½œå¤±è´¥ã€æ•°æ®åº“ç³»ç»Ÿ/æ“ä½œç³»ç»Ÿå¤±è´¥ï¼Œç”šè‡³æ˜¯å­˜å‚¨ä»‹è´¨å¤±è´¥ç­‰æƒ…å†µã€‚è¿™ä¾¿éœ€è¦DBMSå¯¹ä¸€ä¸ªæ‰§è¡Œå¤±è´¥çš„äº‹åŠ¡æ‰§è¡Œæ¢å¤æ“ä½œï¼Œå°†å…¶æ•°æ®åº“çŠ¶æ€æ¢å¤åˆ°ä¸€è‡´çŠ¶æ€ï¼ˆæ•°æ®çš„ä¸€è‡´æ€§å¾—åˆ°ä¿è¯çš„çŠ¶æ€ï¼‰ã€‚ä¸ºäº†å®ç°å°†æ•°æ®åº“çŠ¶æ€æ¢å¤åˆ°ä¸€è‡´çŠ¶æ€çš„åŠŸèƒ½ï¼ŒDBMSé€šå¸¸éœ€è¦ç»´æŠ¤äº‹åŠ¡æ—¥å¿—ä»¥è¿½è¸ªäº‹åŠ¡ä¸­æ‰€æœ‰å½±å“æ•°æ®åº“æ•°æ®çš„æ“ä½œã€‚ ç‰¹æ€§å¹¶éä»»æ„çš„å¯¹æ•°æ®åº“çš„æ“ä½œåºåˆ—éƒ½æ˜¯æ•°æ®åº“äº‹åŠ¡ã€‚äº‹åŠ¡åº”è¯¥å…·æœ‰4ä¸ªå±æ€§ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ã€‚è¿™å››ä¸ªå±æ€§é€šå¸¸ç§°ä¸ºACIDç‰¹æ€§ã€‚ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡åº”ç¡®ä¿æ•°æ®åº“çš„çŠ¶æ€ä»ä¸€ä¸ªä¸€è‡´çŠ¶æ€è½¬å˜ä¸ºå¦ä¸€ä¸ªä¸€è‡´çŠ¶æ€ã€‚ä¸€è‡´çŠ¶æ€çš„å«ä¹‰æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®åº”æ»¡è¶³å®Œæ•´æ€§çº¦æŸã€‚éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸åº”å½±å“å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œã€‚æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œä»–å¯¹æ•°æ®åº“çš„ä¿®æ”¹åº”è¯¥æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚ åŸå­æ€§æ˜¯åŸºç¡€ï¼Œéš”ç¦»æ€§æ˜¯æ‰‹æ®µï¼ŒæŒä¹…æ€§æ˜¯ç›®çš„ï¼Œæœ€é‡è¦çš„æ˜¯ä¸€è‡´æ€§ è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»Dirty Readï¼ˆè„è¯»ï¼‰ï¼šåˆç§°æ— æ•ˆæ•°æ®çš„è¯»å‡ºã€‚æŒ‡ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“ä¸­ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡è®¿é—®å¹¶ä½¿ç”¨äº†è¯¥æ•°æ®ã€‚ç”±äºè¿™ä¸ªæ•°æ®è¿˜æ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥å¦å¤–ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°çš„è¿™ä¸ªæ•°æ®æ˜¯è„æ•°æ®ã€‚ æ—¶é—´ äº‹åŠ¡Aï¼ˆå­˜æ¬¾ï¼‰ äº‹ç‰©Bï¼ˆå–æ¬¾ï¼‰ T1 å¼€å§‹äº‹åŠ¡ T2 å¼€å§‹äº‹åŠ¡ T3 æŸ¥è¯¢ä½™é¢ï¼ˆ1000 å…ƒï¼‰ T4 å–å‡º 1000 å…ƒï¼ˆä½™é¢ 0 å…ƒï¼‰ T5 æŸ¥è¯¢ä½™é¢ï¼ˆ0 å…ƒï¼‰ T6 æ’¤é”€äº‹åŠ¡ï¼ˆä½™é¢æ¢å¤ä¸º 1000 å…ƒï¼‰ T7 å­˜å…¥ 500 å…ƒï¼ˆä½™é¢ 500 å…ƒï¼‰ T8 æäº¤äº‹åŠ¡ Unrepeatable Readï¼ˆä¸å¯é‡å¤è¯»ï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…å¯¹ä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢å´è¿”å›äº†ä¸åŒæ•°æ®ã€‚è¿™æ˜¯å› ä¸ºå…¶å®ƒäº‹åŠ¡ä¿®æ”¹çš„æäº¤è€Œå¼•èµ·çš„ã€‚ æ—¶é—´ äº‹åŠ¡Aï¼ˆå­˜æ¬¾ï¼‰ äº‹ç‰©Bï¼ˆå–æ¬¾ï¼‰ T1 å¼€å§‹äº‹åŠ¡ T2 å¼€å§‹äº‹åŠ¡ T3 æŸ¥è¯¢ä½™é¢ï¼ˆ1000 å…ƒï¼‰ T4 æŸ¥è¯¢ä½™é¢ï¼ˆ1000 å…ƒï¼‰ T5 å–å‡º 1000 å…ƒï¼ˆä½™é¢ 0 å…ƒ) T6 æäº¤äº‹åŠ¡ T7 æŸ¥è¯¢ä½™é¢ï¼ˆ0 å…ƒ) Phantom Readï¼ˆå¹»è¯»ï¼‰ï¼šæŒ‡å½“äº‹åŠ¡ä¸æ˜¯ç‹¬ç«‹æ‰§è¡Œæ—¶å‘ç”Ÿçš„ä¸€ç§ç°è±¡ã€‚ä¾‹å¦‚ç¬¬ä¸€ä¸ªäº‹åŠ¡æ¶‰åŠåˆ°è¡¨ä¸­å…¨éƒ¨æ•°æ®è¡Œçš„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ·»åŠ äº†ä¸€è¡Œæ–°æ•°æ®ï¼Œé‚£ä¹ˆæ‰§è¡Œç¬¬ä¸€ä¸ªäº‹åŠ¡åï¼Œå‘ç°è¡¨ä¸­è¿˜æœ‰æ²¡æœ‰è¢«ä¿®æ”¹çš„æ•°æ®è¡Œã€‚ æ—¶é—´ äº‹åŠ¡ Aï¼ˆç»Ÿè®¡æ€»å­˜æ¬¾ï¼‰ äº‹ç‰©Bï¼ˆå–æ¬¾ï¼‰ T1 å¼€å§‹äº‹åŠ¡ T2 å¼€å§‹äº‹åŠ¡ T3 ç»Ÿè®¡æ€»å­˜æ¬¾ï¼ˆ10000 å…ƒï¼‰ T4 å­˜å…¥ 100 å…ƒ T5 æäº¤äº‹åŠ¡ T6 ç»Ÿè®¡æ€»å­˜æ¬¾ï¼ˆ10100 å…ƒï¼‰ é“¶è¡Œå·¥ä½œäººå‘˜ï¼Œæ¯æ¬¡ç»Ÿè®¡æ€»å­˜æ¬¾ï¼Œéƒ½çœ‹åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚ä¸è¿‡è¿™ä¹Ÿç¡®å®ä¹ŸæŒºæ­£å¸¸çš„ï¼Œæ€»å­˜æ¬¾å¢å¤šäº†ï¼Œè‚¯å®šæ˜¯è¿™ä¸ªæ—¶å€™æœ‰äººåœ¨å­˜é’±ã€‚ä½†æ˜¯å¦‚æœé“¶è¡Œç³»ç»ŸçœŸçš„è¿™æ ·è®¾è®¡ï¼Œé‚£ç®—æ˜¯ç©å®Œäº†ã€‚è¿™åŒæ ·ä¹Ÿæ˜¯äº‹åŠ¡æ²¡æœ‰éš”ç¦»æ‰€é€ æˆçš„ï¼Œä½†å¯¹äºå¤§å¤šæ•°åº”ç”¨ç³»ç»Ÿè€Œè¨€ï¼Œè¿™ä¼¼ä¹ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œå¯ä»¥ç†è§£ï¼Œä¹Ÿæ˜¯å…è®¸çš„ã€‚é“¶è¡Œé‡Œé‚£äº›æ¶å¿ƒçš„é‚£äº›ç³»ç»Ÿï¼Œè¦æ±‚éå¸¸ä¸¥å¯†ï¼Œç»Ÿè®¡çš„æ—¶å€™ï¼Œç”šè‡³ä¼šå°†æ‰€æœ‰çš„å…¶ä»–æ“ä½œç»™éš”ç¦»å¼€ï¼Œè¿™ç§éš”ç¦»çº§åˆ«å°±ç®—éå¸¸é«˜äº†ï¼ˆä¼°è®¡è¦åˆ° SERIALIZABLE çº§åˆ«äº†ï¼‰ã€‚ å½’çº³ è„è¯»ï¼šäº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B æœªæäº¤çš„æ•°æ®ï¼Œå¹¶åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåˆåšäº†å…¶ä»–æ“ä½œã€‚ ä¸å¯é‡å¤è¯»ï¼šäº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B å·²æäº¤çš„æ›´æ”¹æ•°æ®ã€‚ å¹»è¯»ï¼šäº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B å·²æäº¤çš„æ–°å¢æ•°æ®ã€‚ ç¬¬ä¸€æ¡æ˜¯åšå†³æŠµåˆ¶çš„ï¼Œåä¸¤æ¡åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä¸ä½œè€ƒè™‘ã€‚ éš”ç¦»çº§åˆ« æœªæäº¤è¯»(Read uncommitted)ï¼šä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ® æäº¤è¯»(Read committed)ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹æ•°æ®è¿‡ç¨‹ä¸­ï¼Œå…¶å®ƒäº‹åŠ¡ä¸èƒ½è¯»è¯¥æ•°æ® æ•°æ®åº“é”æƒ…å†µ äº‹åŠ¡å¯¹å½“å‰è¯»å–çš„æ•°æ®åŠ è¡Œçº§å…±äº«é”ï¼ˆå½“è¯»åˆ°æ—¶æ‰åŠ é”ï¼‰ï¼Œä¸€æ—¦è¯»å®Œè¯¥è¡Œï¼Œç«‹å³é‡Šæ”¾è¯¥è¡Œçº§å…±äº«é” äº‹åŠ¡åœ¨æ›´æ–°æŸæ•°æ®çš„ç¬é—´ï¼ˆå°±æ˜¯å‘ç”Ÿæ›´æ–°çš„ç¬é—´ï¼‰ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡Œçº§æ’ä»–é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ã€‚ å¯é‡å¤è¯»(Repeatable reads)ï¼šè§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ æ•°æ®åº“é”æƒ…å†µ äº‹åŠ¡åœ¨è¯»å–æŸæ•°æ®çš„ç¬é—´ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡Œçº§å…±äº«é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ äº‹åŠ¡åœ¨æ›´æ–°æŸæ•°æ®çš„ç¬é—´ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡Œçº§æ’ä»–é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ åºåˆ—åŒ–(Serializable)ï¼šæœ€é«˜çš„éš”ç¦»çº§åˆ« æ•°æ®åº“é”æƒ…å†µ äº‹åŠ¡åœ¨è¯»å–æ•°æ®æ—¶ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡¨çº§å…±äº«é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ äº‹åŠ¡åœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡¨çº§æ’ä»–é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ äº‹åŠ¡éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯» READ_UNCOMMITTED å…è®¸ å…è®¸ å…è®¸ READ_COMMITTED ç¦æ­¢ å…è®¸ å…è®¸ REPEATABLE_READ ç¦æ­¢ ç¦æ­¢ å…è®¸ SERIALIZABLE ç¦æ­¢ ç¦æ­¢ ç¦æ­¢ éš”ç¦»çº§åˆ«è¶Šé«˜ï¼ŒåŒæ—¶åœ¨å¹¶å‘æ€§ä¸Šä¹Ÿè¶Šä½ æˆ‘ä»¬çŸ¥é“ JDBC åªæ˜¯è¿æ¥ Java ç¨‹åºä¸æ•°æ®åº“çš„æ¡¥æ¢è€Œå·²ï¼Œé‚£ä¹ˆæ•°æ®åº“åˆæ˜¯æ€æ ·éš”ç¦»äº‹åŠ¡çš„å‘¢ï¼Ÿå…¶å®å®ƒå°±æ˜¯â€œé”â€è¿™ä¸ªä¸œè¥¿ã€‚å½“æ’å…¥æ•°æ®æ—¶ï¼Œå°±é”å®šè¡¨ï¼Œè¿™å«â€œé”è¡¨â€ï¼›å½“æ›´æ–°æ•°æ®æ—¶ï¼Œå°±é”å®šè¡Œï¼Œè¿™å«â€œé”è¡Œâ€ã€‚ é™¤äº† JDBC ç»™æˆ‘ä»¬æä¾›çš„äº‹åŠ¡éš”ç¦»çº§åˆ«è¿™ç§è§£å†³æ–¹æ¡ˆä»¥å¤–ï¼Œè¿˜æœ‰å“ªäº›è§£å†³æ–¹æ¡ˆå¯ä»¥å®Œå–„äº‹åŠ¡ç®¡ç†åŠŸèƒ½å‘¢ï¼Ÿ ä¸å¦¨çœ‹çœ‹ Spring çš„è§£å†³æ–¹æ¡ˆå§ï¼Œå…¶å®å®ƒæ˜¯å¯¹ JDBC çš„ä¸€ä¸ªè¡¥å……æˆ–æ‰©å±•ã€‚å®ƒæä¾›äº†ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œå°±æ˜¯ï¼šäº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆTransaction Propagation Behaviorï¼‰ã€‚ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆTransaction Propagation Behaviorï¼‰ PROPAGATION_REQUIRED RROPAGATION_REQUIRES_NEW PROPAGATION_NESTED PROPAGATION_SUPPORTS PROPAGATION_NOT_SUPPORTED PROPAGATION_NEVER PROPAGATION_MANDATORY é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼Œäº‹åŠ¡æ˜¯ä»å“ªé‡Œæ¥ï¼Ÿä¼ æ’­åˆ°å“ªé‡Œå»ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œä»æ–¹æ³• A ä¼ æ’­åˆ°æ–¹æ³• Bã€‚Spring è§£å†³çš„åªæ˜¯æ–¹æ³•ä¹‹é—´çš„äº‹åŠ¡ä¼ æ’­ï¼Œé‚£æƒ…å†µå°±å¤šäº†ï¼Œæ¯”å¦‚: æ–¹æ³• A æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B ä¹Ÿæœ‰äº‹åŠ¡ã€‚ æ–¹æ³• A æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B æ²¡æœ‰äº‹åŠ¡ã€‚ æ–¹æ³• A æ²¡æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B æœ‰äº‹åŠ¡ã€‚ æ–¹æ³• A æ²¡æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B ä¹Ÿæ²¡æœ‰äº‹åŠ¡ã€‚ å‡è®¾äº‹åŠ¡ä»æ–¹æ³• A ä¼ æ’­åˆ°æ–¹æ³• Bï¼Œæ‚¨éœ€è¦é¢å¯¹æ–¹æ³• Bï¼Œé—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼š æ–¹æ³• A æœ‰äº‹åŠ¡å—ï¼Ÿ å¦‚æœæ²¡æœ‰ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼›å¦‚æœæœ‰ï¼Œå°±åŠ å…¥å½“å‰äº‹åŠ¡ã€‚è¿™å°±æ˜¯ PROPAGATION_REQUIREDï¼Œå®ƒä¹Ÿæ˜¯ Spring æä¾›çš„é»˜è®¤äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œé€‚åˆç»å¤§å¤šæ•°æƒ…å†µã€‚ å¦‚æœæ²¡æœ‰ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼›å¦‚æœæœ‰ï¼Œå°±å°†å½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚è¿™å°±æ˜¯ RROPAGATION_REQUIRES_NEWï¼Œæ„æ€å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå®ƒå’ŒåŸæ¥çš„äº‹åŠ¡æ²¡æœ‰ä»»ä½•å…³ç³»äº†ã€‚ å¦‚æœæ²¡æœ‰ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼›å¦‚æœæœ‰ï¼Œå°±åœ¨å½“å‰äº‹åŠ¡ä¸­åµŒå¥—å…¶ä»–äº‹åŠ¡ã€‚è¿™å°±æ˜¯ PROPAGATION_NESTEDï¼Œä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„â€œåµŒå¥—äº‹åŠ¡â€äº†ï¼Œæ‰€åµŒå¥—çš„å­äº‹åŠ¡ä¸ä¸»äº‹åŠ¡ä¹‹é—´æ˜¯æœ‰å…³è”çš„ï¼ˆå½“ä¸»äº‹åŠ¡æäº¤æˆ–å›æ»šï¼Œå­äº‹åŠ¡ä¹Ÿä¼šæäº¤æˆ–å›æ»šï¼‰ã€‚ å¦‚æœæ²¡æœ‰ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼›å¦‚æœæœ‰ï¼Œå°±ä½¿ç”¨å½“å‰äº‹åŠ¡ã€‚è¿™å°±æ˜¯ PROPAGATION_SUPPORTSï¼Œè¿™ç§æ–¹å¼éå¸¸éšæ„ï¼Œæ²¡æœ‰å°±æ²¡æœ‰ï¼Œæœ‰å°±æœ‰ï¼Œæœ‰ç‚¹æ— æ‰€è°“çš„æ€åº¦ï¼Œåæ­£æˆ‘æ˜¯æ”¯æŒä½ çš„ã€‚ å¦‚æœæ²¡æœ‰ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼›å¦‚æœæœ‰ï¼Œå°±å°†å½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚è¿™å°±æ˜¯ PROPAGATION_NOT_SUPPORTEDï¼Œè¿™ç§æ–¹å¼éå¸¸å¼ºç¡¬ï¼Œæ²¡æœ‰å°±æ²¡æœ‰ï¼Œæœ‰æˆ‘ä¹Ÿä¸æ”¯æŒä½ ï¼ŒæŠŠä½ æŒ‚èµ·æ¥ï¼Œä¸é¸Ÿä½ ã€‚ å¦‚æœæ²¡æœ‰ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼›å¦‚æœæœ‰ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚è¿™å°±æ˜¯ PROPAGATION_NEVERï¼Œè¿™ç§æ–¹å¼æ›´çŒ›ï¼Œæ²¡æœ‰å°±æ²¡æœ‰ï¼Œæœ‰äº†åè€ŒæŠ¥é”™ï¼Œç¡®å®å¤Ÿç‰›çš„ï¼Œå®ƒè¯´ï¼šæˆ‘ä»ä¸æ”¯æŒäº‹åŠ¡ï¼ å¦‚æœæ²¡æœ‰ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ï¼›å¦‚æœæœ‰ï¼Œå°±ä½¿ç”¨å½“å‰äº‹åŠ¡ã€‚è¿™å°±æ˜¯ PROPAGATION_MANDATORYï¼Œè¿™ç§æ–¹å¼å¯ä»¥è¯´æ˜¯ç‰›é€¼ä¸­çš„ç‰›é€¼äº†ï¼Œæ²¡æœ‰äº‹åŠ¡ç›´æ¥å°±æŠ¥é”™ï¼Œç¡®å®å¤Ÿç‹ çš„ï¼Œå®ƒè¯´ï¼šæˆ‘å¿…é¡»è¦æœ‰äº‹åŠ¡ï¼ Spring ç»™æˆ‘ä»¬å¸¦æ¥äº†äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§è€Œåˆå®ç”¨çš„åŠŸèƒ½ã€‚é™¤æ­¤ä»¥å¤–ï¼Œä¹Ÿæä¾›äº†ä¸€äº›å°çš„é™„åŠ åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š äº‹åŠ¡è¶…æ—¶ï¼ˆTransaction Timeoutï¼‰ï¼šä¸ºäº†è§£å†³äº‹åŠ¡æ—¶é—´å¤ªé•¿ï¼Œæ¶ˆè€—å¤ªå¤šçš„èµ„æºï¼Œæ‰€ä»¥æ•…æ„ç»™äº‹åŠ¡è®¾ç½®ä¸€ä¸ªæœ€å¤§æ—¶å¸¸ï¼Œå¦‚æœè¶…è¿‡äº†ï¼Œå°±å›æ»šäº‹åŠ¡ã€‚ åªè¯»äº‹åŠ¡ï¼ˆReadonly Transactionï¼‰ï¼šä¸ºäº†å¿½ç•¥é‚£äº›ä¸éœ€è¦äº‹åŠ¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å–æ•°æ®ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°æé«˜ä¸€äº›æ€§èƒ½ã€‚ é”çš„åˆ†ç±»æŒ‰é”çº§åˆ«åˆ’åˆ†ï¼šå…±äº«é”(Share Lock) åˆç§°è¯»é”ï¼Œæ˜¯è¯»å–æ“ä½œåˆ›å»ºçš„é”ã€‚å…¶å®ƒç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œç›´åˆ°å·²é‡Šæ”¾æ‰€æœ‰å…±äº«é” å¦‚æœäº‹åŠ¡Tå¯¹æ•°æ®AåŠ ä¸Šå…±äº«é”åï¼Œåˆ™å…¶å®ƒäº‹åŠ¡åªèƒ½å¯¹Aå†åŠ å…±äº«é”ï¼Œä¸èƒ½åŠ æ’ä»–é”ã€‚è·å–å…±äº«é”çš„äº‹åŠ¡åªèƒ½è¯»æ•°æ®ï¼Œä¸èƒ½ä¿®æ”¹æ•°æ® ç”¨æ³• select â€¦ LOCK IN SHARE MODEï¼Œ å½“æ²¡æœ‰å…¶å®ƒçº¿ç¨‹å¯¹æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä»»ä½•ä¸€è¡Œä½¿ç”¨æ’ä»–é”æ—¶ï¼Œå¯ä»¥æˆåŠŸç”³è¯·å…±äº«é”ï¼Œå¦åˆ™ä¼šè¢«é˜»å¡ã€‚å…¶å®ƒçº¿ç¨‹ä¹Ÿå¯ä»¥è¯»å–ä½¿ç”¨äº†å…±äº«é”çš„è¡¨ï¼Œè€Œä¸”è¿™äº›çº¿ç¨‹è¯»å–çš„æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„æ•°æ® æ’ä»–é”(eXclusive Lock) åˆç§°å†™é”ï¼Œå¦‚æœäº‹åŠ¡Tå¯¹æ•°æ®AåŠ ä¸Šæ’ä»–é”åï¼Œåˆ™å…¶ä»–äº‹åŠ¡ä¸èƒ½å†å¯¹AåŠ ä»»ä½•ç±»å‹çš„é”ã€‚è·å–æ’ä»–é”çš„äº‹åŠ¡æ—¢èƒ½è¯»æ•°æ®ï¼Œåˆèƒ½ä¿®æ”¹æ•°æ® ç”¨æ³• select â€¦ FOR UPDATE å½“æ²¡æœ‰å…¶å®ƒçº¿ç¨‹å¯¹æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä»»ä½•ä¸€è¡Œä½¿ç”¨æ’ä»–é”æ—¶ï¼Œå¯ä»¥æˆåŠŸç”³è¯·æ’ä»–é”ï¼Œå¦åˆ™ä¼šè¢«é˜»å¡ æŒ‰é”çš„ç²’åº¦åˆ’åˆ†è¡Œçº§é” å¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚åŠ é”ç²’åº¦æœ€å°ï¼Œä½†åŠ é”çš„å¼€é”€æœ€å¤§ã€‚è¡Œçº§é”åˆ†ä¸ºå…±äº«é”å’Œæ’ä»–é” ç‰¹ç‚¹ å¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šåŠ›åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚ è¡¨çº§é” å¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ƒå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—è¾ƒå°‘ï¼Œè¢«å¤§éƒ¨åˆ†MySQLå¼•æ“æ”¯æŒã€‚æœ€å¸¸ä½¿ç”¨çš„MYISAMä¸INNODBéƒ½æ”¯æŒè¡¨çº§é”å®šã€‚è¡¨çº§é”å®šåˆ†ä¸ºè¡¨å…±äº«è¯»é”ï¼ˆå…±äº«é”ï¼‰ä¸è¡¨ç‹¬å å†™é”ï¼ˆæ’ä»–é”ï¼‰ã€‚ ç‰¹ç‚¹ å¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘å‡ºé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ã€‚ é¡µçº§é” é¡µçº§é”æ˜¯MySQLä¸­é”å®šç²’åº¦ä»‹äºè¡Œçº§é”å’Œè¡¨çº§é”ä¸­é—´çš„ä¸€ç§é”ã€‚è¡¨çº§é”é€Ÿåº¦å¿«ï¼Œä½†å†²çªå¤šï¼Œè¡Œçº§å†²çªå°‘ï¼Œä½†é€Ÿåº¦æ…¢ã€‚æ‰€ä»¥å–äº†æŠ˜è¡·çš„é¡µçº§ï¼Œä¸€æ¬¡é”å®šç›¸é‚»çš„ä¸€ç»„è®°å½•ã€‚BDBæ”¯æŒé¡µçº§é” ç‰¹ç‚¹ å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œå¹¶å‘åº¦ä¸€èˆ¬ Innodbä¸­çš„è¡Œé”ä¸è¡¨é” InnoDBè¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ã€‚InnoDBè¿™ç§è¡Œé”å®ç°ç‰¹ç‚¹æ„å‘³ç€ï¼šåªæœ‰é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼ŒInnoDBæ‰ä½¿ç”¨è¡Œçº§é”ï¼Œå¦åˆ™ï¼ŒInnoDBå°†ä½¿ç”¨è¡¨é”ï¼ è¡Œçº§é”ä¸æ­»é” åœ¨MySQLä¸­ï¼Œè¡Œçº§é”å¹¶ä¸æ˜¯ç›´æ¥é”è®°å½•ï¼Œè€Œæ˜¯é”ç´¢å¼•ã€‚ç´¢å¼•åˆ†ä¸ºä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ä¸¤ç§ï¼Œå¦‚æœä¸€æ¡sqlè¯­å¥æ“ä½œäº†ä¸»é”®ç´¢å¼•ï¼ŒMySQLå°±ä¼šé”å®šè¿™æ¡ä¸»é”®ç´¢å¼•ï¼›å¦‚æœä¸€æ¡è¯­å¥æ“ä½œäº†éä¸»é”®ç´¢å¼•ï¼ŒMySQLä¼šå…ˆé”å®šè¯¥éä¸»é”®ç´¢å¼•ï¼Œå†é”å®šç›¸å…³çš„ä¸»é”®ç´¢å¼•ã€‚ åœ¨UPDATEã€DELETEæ“ä½œæ—¶ï¼ŒMySQLä¸ä»…é”å®šWHEREæ¡ä»¶æ‰«æè¿‡çš„æ‰€æœ‰ç´¢å¼•è®°å½•ï¼Œè€Œä¸”ä¼šé”å®šç›¸é‚»çš„é”®å€¼ï¼Œå³æ‰€è°“çš„next-key lockingã€‚ å½“ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œï¼Œä¸€ä¸ªé”ä½äº†ä¸»é”®ç´¢å¼•ï¼Œåœ¨ç­‰å¾…å…¶ä»–ç›¸å…³ç´¢å¼•ã€‚å¦ä¸€ä¸ªé”å®šäº†éä¸»é”®ç´¢å¼•ï¼Œåœ¨ç­‰å¾…ä¸»é”®ç´¢å¼•ã€‚è¿™æ ·å°±ä¼šå‘ç”Ÿæ­»é”ã€‚ å‘ç”Ÿæ­»é”åï¼ŒInnoDBä¸€èˆ¬éƒ½å¯ä»¥æ£€æµ‹åˆ°ï¼Œå¹¶ä½¿ä¸€ä¸ªäº‹åŠ¡é‡Šæ”¾é”å›é€€ï¼Œå¦ä¸€ä¸ªè·å–é”å®Œæˆäº‹åŠ¡ã€‚ å¸¸è§çš„ä¸‰ç§è§£å†³æ­»é”çš„æ–¹æ³• å¦‚æœä¸åŒç¨‹åºä¼šå¹¶å‘å­˜å–å¤šä¸ªè¡¨ï¼Œå°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®è¡¨ï¼Œå¯ä»¥å¤§å¤§é™ä½æ­»é”æœºä¼š åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå°½å¯èƒ½åšåˆ°ä¸€æ¬¡é”å®šæ‰€éœ€è¦çš„æ‰€æœ‰èµ„æºï¼Œå‡å°‘æ­»é”äº§ç”Ÿæ¦‚ç‡ å¯¹äºéå¸¸å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä¸šåŠ¡éƒ¨åˆ†ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å‡çº§é”å®šé¢—ç²’åº¦ï¼Œé€šè¿‡è¡¨çº§é”å®šæ¥å‡å°‘æ­»é”äº§ç”Ÿçš„æ¦‚ç‡ æŒ‰ä½¿ç”¨æ–¹å¼åˆ’åˆ†æ‚²è§‚é” åœ¨å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿé‡Œï¼Œæ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆåˆåâ€œæ‚²è§‚é”â€ï¼ŒPessimistic Concurrency Controlï¼Œç¼©å†™â€œPCCâ€ï¼‰æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ã€‚å®ƒå¯ä»¥é˜»æ­¢ä¸€ä¸ªäº‹åŠ¡ä»¥å½±å“å…¶ä»–ç”¨æˆ·çš„æ–¹å¼æ¥ä¿®æ”¹æ•°æ®ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œçš„æ“ä½œéƒ½æŸè¡Œæ•°æ®åº”ç”¨äº†é”ï¼Œé‚£åªæœ‰å½“è¿™ä¸ªäº‹åŠ¡æŠŠé”é‡Šæ”¾ï¼Œå…¶ä»–äº‹åŠ¡æ‰èƒ½å¤Ÿæ‰§è¡Œä¸è¯¥é”å†²çªçš„æ“ä½œã€‚ æ‚²è§‚å¹¶å‘æ§åˆ¶ä¸»è¦ç”¨äºæ•°æ®äº‰ç”¨æ¿€çƒˆçš„ç¯å¢ƒï¼Œä»¥åŠå‘ç”Ÿå¹¶å‘å†²çªæ—¶ä½¿ç”¨é”ä¿æŠ¤æ•°æ®çš„æˆæœ¬è¦ä½äºå›æ»šäº‹åŠ¡çš„æˆæœ¬çš„ç¯å¢ƒä¸­ã€‚ åœ¨æ•°æ®åº“ä¸­ï¼Œæ‚²è§‚é”çš„æµç¨‹å¦‚ä¸‹ï¼š åœ¨å¯¹ä»»æ„è®°å½•è¿›è¡Œä¿®æ”¹å‰ï¼Œå…ˆå°è¯•ä¸ºè¯¥è®°å½•åŠ ä¸Šæ’ä»–é”ï¼ˆexclusive lockingï¼‰ã€‚ å¦‚æœåŠ é”å¤±è´¥ï¼Œè¯´æ˜è¯¥è®°å½•æ­£åœ¨è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“å‰æŸ¥è¯¢å¯èƒ½è¦ç­‰å¾…æˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚ å…·ä½“å“åº”æ–¹å¼ç”±å¼€å‘è€…æ ¹æ®å®é™…éœ€è¦å†³å®šã€‚ å¦‚æœæˆåŠŸåŠ é”ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¯¹è®°å½•åšä¿®æ”¹ï¼Œäº‹åŠ¡å®Œæˆåå°±ä¼šè§£é”äº†ã€‚ å…¶é—´å¦‚æœæœ‰å…¶ä»–å¯¹è¯¥è®°å½•åšä¿®æ”¹æˆ–åŠ æ’ä»–é”çš„æ“ä½œï¼Œéƒ½ä¼šç­‰å¾…æˆ‘ä»¬è§£é”æˆ–ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ ä½¿ç”¨selectâ€¦for updateä¼šæŠŠæ•°æ®ç»™é”ä½ï¼Œä¸è¿‡æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€äº›é”çš„çº§åˆ«ï¼ŒMySQL InnoDBé»˜è®¤è¡Œçº§é”ã€‚è¡Œçº§é”éƒ½æ˜¯åŸºäºç´¢å¼•çš„ï¼Œå¦‚æœä¸€æ¡SQLè¯­å¥ç”¨ä¸åˆ°ç´¢å¼•æ˜¯ä¸ä¼šä½¿ç”¨è¡Œçº§é”çš„ï¼Œä¼šä½¿ç”¨è¡¨çº§é”æŠŠæ•´å¼ è¡¨é”ä½ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ã€‚ ä¼˜ç‚¹ä¸ä¸è¶³ æ‚²è§‚å¹¶å‘æ§åˆ¶å®é™…ä¸Šæ˜¯â€œå…ˆå–é”å†è®¿é—®â€çš„ä¿å®ˆç­–ç•¥ï¼Œä¸ºæ•°æ®å¤„ç†çš„å®‰å…¨æä¾›äº†ä¿è¯ã€‚ä½†æ˜¯åœ¨æ•ˆç‡æ–¹é¢ï¼Œå¤„ç†åŠ é”çš„æœºåˆ¶ä¼šè®©æ•°æ®åº“äº§ç”Ÿé¢å¤–çš„å¼€é”€ï¼Œè¿˜æœ‰å¢åŠ äº§ç”Ÿæ­»é”çš„æœºä¼šï¼›å¦å¤–ï¼Œåœ¨åªè¯»å‹äº‹åŠ¡å¤„ç†ä¸­ç”±äºä¸ä¼šäº§ç”Ÿå†²çªï¼Œä¹Ÿæ²¡å¿…è¦ä½¿ç”¨é”ï¼Œè¿™æ ·åšåªèƒ½å¢åŠ ç³»ç»Ÿè´Ÿè½½ï¼›è¿˜æœ‰ä¼šé™ä½äº†å¹¶è¡Œæ€§ï¼Œä¸€ä¸ªäº‹åŠ¡å¦‚æœé”å®šäº†æŸè¡Œæ•°æ®ï¼Œå…¶ä»–äº‹åŠ¡å°±å¿…é¡»ç­‰å¾…è¯¥äº‹åŠ¡å¤„ç†å®Œæ‰å¯ä»¥å¤„ç†é‚£è¡Œæ•° ä¹è§‚é” åœ¨å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿé‡Œï¼Œä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆåˆåâ€œä¹è§‚é”â€ï¼ŒOptimistic Concurrency Controlï¼Œç¼©å†™â€œOCCâ€ï¼‰æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ã€‚å®ƒå‡è®¾å¤šç”¨æˆ·å¹¶å‘çš„äº‹åŠ¡åœ¨å¤„ç†æ—¶ä¸ä¼šå½¼æ­¤äº’ç›¸å½±å“ï¼Œå„äº‹åŠ¡èƒ½å¤Ÿåœ¨ä¸äº§ç”Ÿé”çš„æƒ…å†µä¸‹å¤„ç†å„è‡ªå½±å“çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚åœ¨æäº¤æ•°æ®æ›´æ–°ä¹‹å‰ï¼Œæ¯ä¸ªäº‹åŠ¡ä¼šå…ˆæ£€æŸ¥åœ¨è¯¥äº‹åŠ¡è¯»å–æ•°æ®åï¼Œæœ‰æ²¡æœ‰å…¶ä»–äº‹åŠ¡åˆä¿®æ”¹äº†è¯¥æ•°æ®ã€‚å¦‚æœå…¶ä»–äº‹åŠ¡æœ‰æ›´æ–°çš„è¯ï¼Œæ­£åœ¨æäº¤çš„äº‹åŠ¡ä¼šè¿›è¡Œå›æ»šã€‚ä¹è§‚äº‹åŠ¡æ§åˆ¶æœ€æ—©æ˜¯ç”±å­”ç¥¥é‡ï¼ˆH.T.Kungï¼‰æ•™æˆæå‡ºã€‚ ä¹è§‚é”ï¼ˆ Optimistic Locking ï¼‰ ç›¸å¯¹æ‚²è§‚é”è€Œè¨€ï¼Œä¹è§‚é”å‡è®¾è®¤ä¸ºæ•°æ®ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šé€ æˆå†²çªï¼Œæ‰€ä»¥åœ¨æ•°æ®è¿›è¡Œæäº¤æ›´æ–°çš„æ—¶å€™ï¼Œæ‰ä¼šæ­£å¼å¯¹æ•°æ®çš„å†²çªä¸å¦è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå‘ç°å†²çªäº†ï¼Œåˆ™è®©è¿”å›ç”¨æˆ·é”™è¯¯çš„ä¿¡æ¯ï¼Œè®©ç”¨æˆ·å†³å®šå¦‚ä½•å»åšã€‚ ç›¸å¯¹äºæ‚²è§‚é”ï¼Œåœ¨å¯¹æ•°æ®åº“è¿›è¡Œå¤„ç†çš„æ—¶å€™ï¼Œä¹è§‚é”å¹¶ä¸ä¼šä½¿ç”¨æ•°æ®åº“æä¾›çš„é”æœºåˆ¶ã€‚ä¸€èˆ¬çš„å®ç°ä¹è§‚é”çš„æ–¹å¼å°±æ˜¯è®°å½•æ•°æ®ç‰ˆæœ¬ã€‚ æ•°æ®ç‰ˆæœ¬,ä¸ºæ•°æ®å¢åŠ çš„ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°†ç‰ˆæœ¬æ ‡è¯†çš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼ŒåŒæ—¶å¯¹ç‰ˆæœ¬æ ‡è¯†è¿›è¡Œæ›´æ–°ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ç‰ˆæœ¬æ ‡è¯†è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ç‰ˆæœ¬æ ‡è¯†å€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚ ä¼˜ç‚¹ä¸ä¸è¶³ ä¹è§‚å¹¶å‘æ§åˆ¶ç›¸ä¿¡äº‹åŠ¡ä¹‹é—´çš„æ•°æ®ç«äº‰(data race)çš„æ¦‚ç‡æ˜¯æ¯”è¾ƒå°çš„ï¼Œå› æ­¤å°½å¯èƒ½ç›´æ¥åšä¸‹å»ï¼Œç›´åˆ°æäº¤çš„æ—¶å€™æ‰å»é”å®šï¼Œæ‰€ä»¥ä¸ä¼šäº§ç”Ÿä»»ä½•é”å’Œæ­»é”ã€‚ä½†å¦‚æœç›´æ¥ç®€å•è¿™ä¹ˆåšï¼Œè¿˜æ˜¯æœ‰å¯èƒ½ä¼šé‡åˆ°ä¸å¯é¢„æœŸçš„ç»“æœï¼Œä¾‹å¦‚ä¸¤ä¸ªäº‹åŠ¡éƒ½è¯»å–äº†æ•°æ®åº“çš„æŸä¸€è¡Œï¼Œç»è¿‡ä¿®æ”¹ä»¥åå†™å›æ•°æ®åº“ï¼Œè¿™æ—¶å°±é‡åˆ°äº†é—®é¢˜ã€‚ æ‚²è§‚é”ï¼Œå°±æ˜¯æ€»è§‰å¾—æœ‰åˆæ°‘æƒ³å®³æœ•ï¼Œæ¯æ¬¡è®¿é—®æ•°æ®çš„æ—¶å€™éƒ½è§‰å¾—ä¼šæœ‰åˆ«äººä¿®æ”¹å®ƒï¼Œæ‰€ä»¥æ¯æ¬¡æ‹¿æ•°æ®æ—¶éƒ½ä¼šä¸Šé”ï¼Œç¡®ä¿åœ¨è‡ªå·±ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¢«ä»–äººè®¿é—®ã€‚ä¹è§‚é”å°±æ˜¯å¾ˆå•çº¯ï¼Œå¿ƒæ€å¥½ï¼Œæ‰€ä»¥æ¯æ¬¡æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¸ä¼šä¸Šé”ï¼Œåªæ˜¯åœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™å»åˆ¤æ–­è¯¥æ•°æ®æ˜¯å¦è¢«åˆ«äººä¿®æ”¹è¿‡ã€‚(é˜¿å§¨çœŸæœ‰æ„æ€) å¤§å¤šæ•°çš„å…³ç³»æ•°æ®åº“å†™å…¥æ“ä½œéƒ½æ˜¯åŸºäºæ‚²è§‚é”ï¼Œç¼ºç‚¹åœ¨äºå¦‚æœæŒæœ‰é”çš„å®¢æˆ·ç«¯è¿è¡Œçš„å¾ˆæ…¢ï¼Œé‚£ä¹ˆç­‰å¾…è§£é”çš„å®¢æˆ·ç«¯è¢«é˜»å¡çš„æ—¶é—´å°±è¶Šé•¿ã€‚Redisçš„äº‹åŠ¡æ˜¯åŸºäºä¹è§‚é”çš„æœºåˆ¶ï¼Œä¸ä¼šåœ¨æ‰§è¡ŒWATCHå‘½ä»¤æ—¶å¯¹æ•°æ®è¿›è¡ŒåŠ é”ï¼Œåªæ˜¯ä¼šåœ¨æ•°æ®å·²ç»è¢«å…¶ä»–å®¢æˆ·ç«¯æŠ¢å…ˆä¿®æ”¹äº†çš„æƒ…å†µä¸‹ï¼Œé€šçŸ¥æ‰§è¡ŒWATCHå‘½ä»¤çš„å®¢æˆ·ç«¯ã€‚ä¹è§‚é”é€‚ç”¨äºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå› ä¸ºåœ¨å†™æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„æ—¶å€™ï¼Œä¼šä¸æ–­åœ°retryï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚ å‚è€ƒ æ•°æ®åº“ é¢è¯•æ€»ç»“ Transaction é‚£ç‚¹äº‹å„¿","categories":[],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"},{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/tags/sql/"}]},{"title":"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’","slug":"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’","date":"2018-04-08T09:58:41.000Z","updated":"2018-04-12T10:43:16.657Z","comments":true,"path":"2018/04/08/å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’/","link":"","permalink":"https://hsb786.github.io/2018/04/08/å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’/","excerpt":"å€¼ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°å¤åˆ¶ä¸€ä»½ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†ä¸ä¼šå½±å“åˆ°å®é™…å‚æ•°ã€‚ å¼•ç”¨ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°çš„åœ°å€ç›´æ¥ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†å½±å“åˆ°å®é™…å‚æ•°ã€‚","text":"å€¼ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°å¤åˆ¶ä¸€ä»½ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†ä¸ä¼šå½±å“åˆ°å®é™…å‚æ•°ã€‚ å¼•ç”¨ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°çš„åœ°å€ç›´æ¥ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†å½±å“åˆ°å®é™…å‚æ•°ã€‚æ±‚å€¼ç­–ç•¥ | æ±‚å€¼æ—¶é—´ | æ±‚å€¼æ–¹å¼ | æ ¹æœ¬åŒºåˆ«â€”|â€”|â€”|â€”å€¼ä¼ é€’ | è°ƒç”¨å‰ | å€¼çš„ç»“æœï¼ˆåŸå€¼çš„å‰¯æœ¬ï¼‰| ä¼šåˆ›å»ºå‰¯æœ¬å¼•ç”¨ä¼ é€’ | è°ƒç”¨å‰ | åŸå€¼ï¼ˆåŸå§‹å¯¹è±¡ï¼Œæ— å‰¯æœ¬ï¼‰| ä¸åˆ›å»ºå‰¯æœ¬ å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ«å¹¶ä¸æ˜¯ä¼ é€’çš„å†…å®¹ï¼Œè€Œæ˜¯å®å‚åˆ°åº•æœ‰æ²¡æœ‰è¢«å¤åˆ¶ä¸€ä»½åˆ°å½¢å‚ javaåªæœ‰å€¼ä¼ é€’ï¼Œä¸å­˜åœ¨å¼•ç”¨ä¼ é€’ javaåœ¨ä¼ é€’å¼•ç”¨ç±»å‹æ•°æ®æ—¶ï¼ŒæŠŠå®é™…å‚æ•°çš„å†…å­˜åœ°å€å¤åˆ¶äº†ä¸€ä»½ï¼Œä¼ é€’ç»™äº†å½¢å‚","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ä¸€äº›å°æŠ€å·§","slug":"ä¸€äº›å°æŠ€å·§","date":"2018-04-08T09:58:41.000Z","updated":"2018-04-15T05:44:54.198Z","comments":true,"path":"2018/04/08/ä¸€äº›å°æŠ€å·§/","link":"","permalink":"https://hsb786.github.io/2018/04/08/ä¸€äº›å°æŠ€å·§/","excerpt":"ä½è¿ç®—ç›´æ¥å¯¹å†…å­˜æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦è½¬æˆåè¿›åˆ¶ï¼Œå› æ­¤å¤„ç†é€Ÿåº¦éå¸¸å¿« X % 2^n = X &amp; (2^n-1)","text":"ä½è¿ç®—ç›´æ¥å¯¹å†…å­˜æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦è½¬æˆåè¿›åˆ¶ï¼Œå› æ­¤å¤„ç†é€Ÿåº¦éå¸¸å¿« X % 2^n = X &amp; (2^n-1) åˆ¤æ®µä¸€ä¸ªæ•°ç»„æ˜¯å¦åŒ…å«æŸä¸ªå€¼12Set&lt;String&gt; set=new HashSet&lt;String&gt;(Arrays.asList(arr)); return set.contains(targetValue); æ•ˆç‡æ…¢ï¼Œè¦å°†æ•°ç»„å‹å…¥Collectionç±»å‹ä¸­ï¼Œé¦–å…ˆè¦å°†æ•°ç»„å…ƒç´ éå†ä¸€éï¼Œç„¶åå†ä½¿ç”¨é›†åˆç±»åšå…¶å®ƒæ“ä½œã€‚ å¯ä»¥ä½¿ç”¨Apache Commonsç±»åº“ä¸­æä¾›çš„ArrayUtilsç±»çš„containsæ–¹æ³•containså†…éƒ¨è°ƒç”¨indexOfæ–¹æ³• 123456789101112131415161718192021222324252627282930public static boolean contains(Object[] array, Object objectToFind) &#123; return indexOf(array, objectToFind) != INDEX_NOT_FOUND;&#125;public static int indexOf(Object[] array, Object objectToFind) &#123; return indexOf(array, objectToFind, 0);&#125;public static int indexOf(Object[] array, Object objectToFind, int startIndex) &#123; if (array == null) &#123; return INDEX_NOT_FOUND; &#125; if (startIndex &lt; 0) &#123; startIndex = 0; &#125; if (objectToFind == null) &#123; for (int i = startIndex; i &lt; array.length; i++) &#123; if (array[i] == null) &#123; return i; &#125; &#125; &#125; else if (array.getClass().getComponentType().isInstance(objectToFind)) &#123; for (int i = startIndex; i &lt; array.length; i++) &#123; if (objectToFind.equals(array[i])) &#123; return i; &#125; &#125; &#125; return INDEX_NOT_FOUND;&#125; æ•´æ•°äºŒè¿›åˆ¶è¡¨ç¤ºä¸­1çš„ä¸ªæ•° 123456int count=0;while(n!=0) &#123; //å°†äºŒè¿›åˆ¶è¡¨ç¤ºä¸­çš„æœ€ä½ä½çš„1å˜ä¸º0 n=n&amp;(n-1); count++;&#125;","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ","slug":"é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ","date":"2018-04-08T09:58:41.000Z","updated":"2018-04-12T10:48:59.497Z","comments":true,"path":"2018/04/08/é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ/","link":"","permalink":"https://hsb786.github.io/2018/04/08/é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ/","excerpt":"è¿ç»­ç‚¹å‡»å¤šä¸ªæŒ‰é’®ï¼Œå¯èƒ½å¯¼è‡´å…ˆè¯·æ±‚çš„æ•°æ®åæ˜¾ç¤ºå‡ºæ¥ã€‚ è§£å†³æ–¹æ¡ˆ 1. å°†ajaxè¯·æ±‚çš„asyncè®¾ç½®ä¸ºfalse 2. åˆ©ç”¨jquery ajaxPrefilterä¸­æ–­è¯·æ±‚ 3. åŠ é®ç½©æ¡†","text":"è¿ç»­ç‚¹å‡»å¤šä¸ªæŒ‰é’®ï¼Œå¯èƒ½å¯¼è‡´å…ˆè¯·æ±‚çš„æ•°æ®åæ˜¾ç¤ºå‡ºæ¥ã€‚ è§£å†³æ–¹æ¡ˆ 1. å°†ajaxè¯·æ±‚çš„asyncè®¾ç½®ä¸ºfalse 2. åˆ©ç”¨jquery ajaxPrefilterä¸­æ–­è¯·æ±‚ 3. åŠ é®ç½©æ¡†12345678910111213141516171819var pendingRequests = &#123;&#125;;$.ajaxPrefilter(function( options, originalOptions, jqXHR ) &#123; var key = options.url; console.log(key); if (!pendingRequests[key]) &#123; pendingRequests[key] = jqXHR; &#125;else&#123; //jqXHR.abort(); //æ”¾å¼ƒåè§¦å‘çš„æäº¤ pendingRequests[key].abort(); // æ”¾å¼ƒå…ˆè§¦å‘çš„æäº¤ &#125; var complete = options.complete; options.complete = function(jqXHR, textStatus) &#123; pendingRequests[key] = null; if ($.isFunction(complete)) &#123; complete.apply(this, arguments); &#125; &#125;;&#125;); æ ¸å¿ƒæ€æƒ³æ˜¯ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå‘é€è¯·æ±‚æ—¶ï¼Œå°†è¯·æ±‚åŠ å…¥é˜Ÿåˆ—ï¼Œè¯·æ±‚å“åº”åï¼Œä»é˜Ÿåˆ—ä¸­æ¸…æ¥šï¼Œè¿™å°±ä¿è¯äº†åœ¨ä»»ä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªåŒæ ·çš„è¯·æ±‚å‘é€ å±€é™æ€§ï¼šä»…å¯¹jqueryçš„ajaxæœ‰ä½œç”¨ å‚è€ƒ é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ","categories":[],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/tags/å‰ç«¯/"}]},{"title":"SpringMVC","slug":"SpringMVC","date":"2018-04-08T09:58:41.000Z","updated":"2018-04-12T10:40:40.410Z","comments":true,"path":"2018/04/08/SpringMVC/","link":"","permalink":"https://hsb786.github.io/2018/04/08/SpringMVC/","excerpt":"SpringMVCå·¥ä½œæµç¨‹SpringMVCæ˜¯ä¸€ç§åŸºäºServeltçš„æŠ€æœ¯ï¼Œå®ƒæä¾›äº†æ§åˆ¶å™¨DispatchServletå’Œç›¸å…³ç»„ä»¶ï¼Œè¿™äº›SpringMVCçš„ç»„ä»¶ä¸€èµ·åè°ƒå·¥ä½œï¼Œå®Œæˆå¯¹webè¯·æ±‚çš„ç›¸åº”ã€‚","text":"SpringMVCå·¥ä½œæµç¨‹SpringMVCæ˜¯ä¸€ç§åŸºäºServeltçš„æŠ€æœ¯ï¼Œå®ƒæä¾›äº†æ§åˆ¶å™¨DispatchServletå’Œç›¸å…³ç»„ä»¶ï¼Œè¿™äº›SpringMVCçš„ç»„ä»¶ä¸€èµ·åè°ƒå·¥ä½œï¼Œå®Œæˆå¯¹webè¯·æ±‚çš„ç›¸åº”ã€‚ å®¢æˆ·ç«¯å‘å‡ºä¸€ä¸ªHTTPè¯·æ±‚ï¼ŒWebæœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨æ£€æŸ¥HTTPè¯·æ±‚çš„è·¯å¾„ï¼Œå¦‚æœåŒ¹é…DispatchServeltçš„è¯·æ±‚æ˜ å°„è·¯å¾„(web.xmlä¸­æŒ‡å®š)ï¼Œåˆ™Webå®¹å™¨å°†è¯¥è¯·æ±‚è½¬äº¤ç»™å¯¹åº”çš„DispatchServletå¤„ç† DispatchServletæ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åï¼Œå°†æ ¹æ®è¯·æ±‚çš„ä¿¡æ¯ä»¥åŠHandlerMappingé…ç½®æ‰¾åˆ°å¤„ç†è¯·æ±‚çš„å¤„ç†å™¨ï¼ˆHandlerï¼‰ã€‚HandlerMappingå¯ä»¥ç®€å•ç†è§£ä¸ºç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦URLåŸŸä¸å¤„ç†å™¨Handlerä¹‹é—´çš„å…³ç³»ã€‚ æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å™¨ä¹‹åï¼Œé€šè¿‡HandlerAdapterå¯¹Handlerè¿›è¡Œå°è£…ï¼Œå†ä»¥åŒä¸€çš„é€‚é…å™¨æ¥å£è°ƒç”¨Handlerã€‚å› ä¸ºä¸ºäº†æ›´åŠ çµæ´»çš„ç¼–ç å’ŒAOPå¢å¼ºåŠŸèƒ½ï¼ŒSpringMVCä¼šç»™å¤„ç†å™¨åŠ å…¥æ‹¦æˆªå™¨ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å¤„ç†å™¨æ‰§è¡Œå‰ååŠ å…¥æ‰§è¡Œå‰ååŠ å…¥è‡ªå·±çš„ä»£ç ï¼Œäºæ˜¯å°±æ„æˆäº†ä¸€ä¸ªå¤„ç†å™¨çš„æ‰§è¡Œé“¾ï¼Œæ‰€ä»¥SpringMVCæä¾›äº†å¤„ç†å™¨é€‚é…å™¨HandlerAdapterï¼Œå¸®åŠ©æˆ‘ä»¬è¿è¡Œç›¸åº”çš„å¤„ç†å™¨ä»¥åŠæˆ‘ä»¬æ·»åŠ è¿›å»çš„æ‹¦æˆªå™¨ã€‚ å¤„ç†å™¨å®Œæˆäº†è¯·æ±‚çš„ä¸šåŠ¡é€»è¾‘ä¹‹åå°†è¿”å›ä¸€ä¸ªModelAndViewå¯¹è±¡ç»™DIspatcherServletï¼Œè¿™é‡ŒModelAndViewåŒ…å«äº†è§†å›¾çš„é€»è¾‘åå’Œæ¨¡å‹æ•°æ®ä¿¡æ¯ã€‚ å¾—åˆ°äº†ModelAndViewä¹‹åï¼ŒDispatchServletå€ŸåŠ©ViewResolverè§†å›¾è§£æå™¨å°†é€»è¾‘è¯•å›¾è½¬æ¢ä¸ºçœŸå®è§†å›¾ã€‚ é€šè¿‡ViewResolverè§†å›¾è§£æå™¨å¾—åˆ°äº†çœŸå®è§†å›¾åï¼ŒDispatServletä½¿ç”¨è¿™ä¸ªçœŸå®è§†å›¾å¯¹è±¡å¯¹ModelAndViewä¸­çš„æ¨¡å‹æ•°æ®è¿›è¡Œæ¸²æŸ“ã€‚ æœ€ç»ˆDispatchServletå°†æ¸²æŸ“è¿‡åçš„è§†å›¾å¯¹è±¡è¿”å›ç»™è¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å¾—åˆ°çš„å“åº”å¯èƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„HTMLé¡µé¢ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªJSONä¸²ï¼Œç”šè‡³æ˜¯ä¸€å¼ å›¾ç‰‡ç­‰ç­‰ä¸åŒçš„è§†å›¾æ¨¡å‹ã€‚ å¦ä¸€ä¸ªè¯´æ³• DispatcherServletæ˜¯ä»€ä¹ˆå®ƒæ˜¯Spring MVCçš„æ ¸å¿ƒã€‚æ¯ä¸ªç”±Spring MVCå¤„ç†çš„è¯·æ±‚éƒ½è¦ç»è¿‡DispatcherServletã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå®ƒæ˜¯å‰ç«¯æ§åˆ¶å™¨æ¨¡å¼çš„å®ç°ï¼Œä¸ºåº”ç”¨æä¾›ä¸€ä¸ªç»Ÿä¸€å…¥å£ã€‚DispatcherServletæ˜¯è¿æ¥Javaä¸Springçš„æ¡¥æ¢ï¼Œå¤„ç†æ‰€æœ‰ä¼ å…¥çš„è¯·æ±‚ã€‚å¹¶ä¸”ä¸å…¶ä»–å£°æ˜åœ¨web.xmlä¸­çš„Servletä¸€æ ·ï¼Œä¹Ÿæ˜¯é€šè¿‡ä¸€ä¸ªURL patternå°†æ¯ä¸ªè¯·æ±‚æ˜ å°„åˆ°DispatcherServletã€‚DispatcherServletè´Ÿè´£å°†è¯·æ±‚å§”æ´¾ç»™Spring MVCä¸­å…¶ä»–çš„ç»„å¤„ä»¶ç†ï¼Œæ¯”å¦‚æ³¨æœ‰@Controlleræˆ–@RestControllerçš„Controllerç±»ï¼ŒHandlerMappersï¼ˆå¤„ç†æ˜ å°„ï¼‰ï¼ŒView Resolvers(è§†å›¾è§£æå™¨)ç­‰ç­‰ã€‚ å°½ç®¡ï¼Œè¯·æ±‚æ˜ å°„æ˜¯ç”± @ResquestMapping æ³¨è§£å®Œæˆçš„ï¼Œä½†å®é™…ä¸Šæ˜¯ç”± DispatcherServlet å°†è¯·æ±‚å§”æ´¾ç»™ç›¸åº”çš„ Controller æ¥å¤„ç†çš„ã€‚ DispatcherServletå¦‚ä½•å¤„ç†è¯·æ±‚æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼ŒDispatcherServlet è¢«ç”¨æ¥å¤„ç†æ‰€æœ‰ä¼ å…¥çš„è¯·æ±‚ï¼Œå¹¶å°†å®ƒä»¬è·¯ç”±åˆ°ä¸åŒçš„ Controller æ¥è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ã€‚å®ƒå†³å®šäº†ç”±å“ªä¸ª Controller å¤„ç†è¯·æ±‚ã€‚ DispatcherServlet ä½¿ç”¨å¤„ç†å™¨æ˜ å°„æ¥å°†ä¼ å…¥çš„è¯·æ±‚è·¯ç”±åˆ°å¤„ç†å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨ BeanNameUrlHandlerMapping å’Œ ç”± @RequestMapping æ³¨è§£é©±åŠ¨çš„DefaultAnnotationHandlerMappingã€‚ ä¸ºäº†æ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ï¼Œå®ƒä¼šæ‰«ææ‰€æœ‰å£°æ˜äº† @Controller æ³¨è§£çš„ç±»ï¼Œå¹¶ä¸”é€šè¿‡ @RequestMapping æ³¨è§£æ‰¾åˆ°è´Ÿè´£å¤„ç†è¯¥è¯·æ±‚çš„æ–¹æ³•ã€‚@RequestMapping æ³¨è§£å¯ä»¥é€šè¿‡è·¯å¾„æ¥æ˜ å°„è¯·æ±‚(æ¯”å¦‚: @RequestMapping(â€œpathâ€)), ä¹Ÿå¯ä»¥é€šè¿‡ HTTP æ–¹æ³•(æ¯”å¦‚: @RequestMapping(â€œpathâ€, method=RequestMethod.GET)), ä¹Ÿå¯ä»¥é€šè¿‡è¯·æ±‚å‚æ•°(æ¯”å¦‚: @RequestMapping(â€œpathâ€â€, method=RequestMethod.POST, params=â€param1â€)),è¿˜å¯ä»¥é€šè¿‡ HTTP è¯·æ±‚å¤´(æ¯”å¦‚: @RequestMapping(â€œpathâ€, header=â€content-type=text/*â€))ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç±»çº§åˆ«å£°æ˜ @RequestMapping æ³¨è§£æ¥è¿‡æ»¤ä¼ å…¥çš„è¯·æ±‚ã€‚ åœ¨è¯·æ±‚å¤„ç†ä¹‹åï¼ŒController ä¼šå°†é€»è¾‘è§†å›¾çš„åå­—å’Œ model è¿”å›ç»™ DispatcherServletã€‚ä¹‹ååˆ©ç”¨è§†å›¾è§£æå™¨å®šä½åˆ°çœŸæ­£çš„ View ä»¥ä¾¿æ¸²æŸ“ç»“æœã€‚æˆ‘ä»¬å¯ä»¥æŒ‡å®šä½¿ç”¨çš„è§†å›¾è§£æå™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒDispatcherServlet ä½¿ç”¨ InternalResourceViewResolveræ¥å°†é€»è¾‘è§†å›¾çš„åå­—è½¬æ¢æˆçœŸæ­£çš„è§†å›¾ï¼Œæ¯”å¦‚ JSPã€‚ é€‰å®šè§†å›¾ä¹‹åï¼ŒDispatcherServlet ä¼šå°†æ•°æ®æ¨¡å‹ä¸è§†å›¾ç›¸ç»“åˆï¼Œå¹¶å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¹¶ä¸æ˜¯ä»»ä½•æ—¶å€™éƒ½éœ€è¦è§†å›¾ï¼Œæ¯”å¦‚ä¸€ä¸ª RESTful çš„ web æœåŠ¡å°±ä¸éœ€è¦ï¼Œå®ƒä»¬çš„å¤„ç†æ–¹æ³•ä¼šåˆ©ç”¨ @ResponseBody æ³¨è§£ç›´æ¥å°†è¯·æ±‚ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¯ä»¥çœ‹REST with Spring courseäº†è§£æ›´å¤šå…³äºå¦‚ä½•ä½¿ç”¨ Spring MVC å¼€å‘å’Œæµ‹è¯• RESTful æœåŠ¡çš„çŸ¥è¯†ã€‚ æ€»ç»“ DispatcherServlet æ˜¯ Spring MVC åº”ç”¨ä¸­ä¸»è¦çš„æ§åˆ¶å™¨ã€‚æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šå…ˆç»ç”± DispatcherServlet å¤„ç†ï¼Œå†ç”± Controller (å£°æ˜æœ‰ @Controller æ³¨è§£çš„ç±») å¤„ç†ã€‚ DispatcherServlet æ˜¯å‰ç«¯æ§åˆ¶å™¨æ¨¡å¼çš„å®ç°ã€‚å‰ç«¯æ§åˆ¶å™¨å°±æ˜¯ä¸ªç”¨æ¥å¤„ç†ç½‘ç«™æ‰€æœ‰è¯·æ±‚çš„æ§åˆ¶å™¨ã€‚ å°±åƒå…¶ä»–çš„ Servletï¼Œ DispatcherServlet ä¹Ÿæ˜¯å£°æ˜å’Œé…ç½®åœ¨ web.xml æ–‡ä»¶ä¸­çš„ï¼š 1234567891011&lt;web-app&gt; &lt;servlet&gt; &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt; &lt;url-pattern&gt;*&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;/web-app&gt; DispatcherServlet ç»§æ‰¿è‡ª HttpServlet åŸºç±»ã€‚Servlet å¼•æ“(æ¯”å¦‚ Tomcat) åˆ›å»ºè¯¥ç±»çš„å®ä¾‹ï¼Œå¹¶ä¸”è°ƒç”¨å®ƒä¸åŒçš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šinit(), service(), destroy()ã€‚ DispatcherServlet ä¸º Spring MVC åº”ç”¨æä¾›ç»Ÿä¸€å…¥å£ï¼Œå¤„ç†æ‰€æœ‰çš„è¯·æ±‚ã€‚ DispatcherServlet ä¹Ÿå®Œå…¨ä¸ Spring IoC å®¹å™¨é›†æˆï¼Œå¯ä»¥ä½¿ç”¨ Spring æ¡†æ¶çš„æ¯ä¸€ä¸ªç‰¹æ€§ï¼Œæ¯”å¦‚ä¾èµ–æ³¨å…¥ã€‚ å½“ DispatcherServlet è¢«é…ç½®ä¸º load-on-startup = 1,æ„å‘³ç€è¯¥ servlet ä¼šåœ¨å¯åŠ¨æ—¶ç”±å®¹å™¨åˆ›å»ºï¼Œè€Œä¸æ˜¯åœ¨è¯·æ±‚åˆ°è¾¾æ—¶ã€‚è¿™æ ·åšä¼šé™ä½ç¬¬ä¸€æ¬¡è¯·æ±‚çš„å“åº”æ—¶é—´ï¼Œå› ä¸ºDispatcherServlet ä¼šåœ¨å¯åŠ¨æ—¶åšå¤§é‡å·¥ä½œï¼ŒåŒ…æ‹¬æ‰«æå’ŒæŸ¥æ‰¾æ‰€æœ‰çš„ Controller å’Œ RequestMappingã€‚ åœ¨ DispatcherServlet åˆå§‹åŒ–æœŸé—´ï¼ŒSpring æ¡†æ¶ä¼šåœ¨ WEB-INF æ–‡ä»¶å¤¹ä¸­æŸ¥æ‰¾åä¸º [servlet-name]-servlet.xml çš„æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºç›¸åº”çš„ beanã€‚æ¯”å¦‚ï¼Œå¦‚æœ servlet åƒä¸Šé¢ web.xml æ–‡ä»¶ä¸­é…ç½®çš„ä¸€æ ·ï¼Œåä¸º â€œSpringMVCâ€ï¼Œé‚£ä¹ˆä¼šæŸ¥æ‰¾ â€œSpringMVC-Servlet.xmlâ€çš„æ–‡ä»¶ã€‚å¦‚æœå…¨å±€ä½œç”¨åŸŸä¸­æœ‰ç›¸åŒåå­—çš„beanï¼Œä¼šè¢«è¦†ç›–ã€‚å¯ä»¥ç”¨ servlet åˆå§‹åŒ–å‚æ•° contextConfigLocationæ›´æ”¹é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚ åœ¨ Spring MVC æ¡†æ¶ä¸­ï¼Œæ¯ä¸ª DispatcherServlet éƒ½æœ‰å®ƒè‡ªå·±çš„ WebApplicationContext ï¼Œå¹¶ä¸”ç»§æ‰¿äº†æ ¹ WebApplicationContext ä¸­å®šä¹‰çš„æ‰€æœ‰ beanã€‚è¿™äº›ç»§æ‰¿çš„ bean åœ¨ servlet æŒ‡å®šçš„ä½œç”¨åŸŸä¸­å¯ä»¥è¢«é‡è½½ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶æŒ‡å®šä½œç”¨åŸŸä¸­å®šä¹‰æ–°çš„ beanã€‚ Spring MVC ä¸­çš„ DispatcherServletä¹Ÿå…è®¸è¿”å› Servlet API å®šä¹‰çš„ last-modification-dateã€‚ä¸ºäº†å†³å®šè¯·æ±‚æœ€åä¿®æ”¹æ—¶é—´ï¼ŒDispatcherServletä¼šå…ˆæŸ¥æ‰¾åˆé€‚çš„ handler mappingï¼Œç„¶åæ£€æµ‹å¤„ç†å™¨æ˜¯å¦å®ç°äº† LastModified æ¥å£ã€‚å¦‚æœå®ç°äº†ï¼Œå°±è°ƒç”¨æ¥å£çš„ getLastModified(request) æ–¹æ³•ï¼Œå¹¶å°†è¯¥å€¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ ä»¥ä¸Šå°±æ˜¯å…³äº DispatcherSerlvet çš„å†…å®¹ã€‚æ­£å¦‚ä¸Šé¢æ‰€è®²ï¼ŒDispacherServlet æ˜¯ Spring MVC çš„éª¨å¹²ï¼Œæ˜¯ä¸»è¦çš„æ§åˆ¶å™¨ï¼Œç”¨æ¥å°†ä¸åŒçš„ HTTP è¯·æ±‚è·¯ç”±å½“ç›¸åº”çš„ Controllerã€‚å®ƒæ˜¯å‰ç«¯æ§åˆ¶å™¨è®¾è®¡æ¨¡å¼çš„å®ç°ï¼Œå¹¶ä¸”ä¸ºåº”ç”¨æä¾›å•ä¸€å…¥å£ã€‚å¯ä»¥åœ¨ web.xml ä¸­é…ç½® DispatcherServletï¼Œä½†å»ºè®®å°† load-on-startup è®¾ç½®ä¸º 1ã€‚è¿™æ ·å®¹å™¨ä¼šåœ¨å¯åŠ¨æ—¶åŠ è½½è¯¥ Serlvet è€Œä¸æ˜¯è¯·æ±‚åˆ°è¾¾æ—¶ã€‚è¿™æ ·èƒ½å‡å°‘ç¬¬ä¸€ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´ã€‚ å‚è€ƒ Spring-MVCæ¡†æ¶å…¥é—¨ ã€è¯‘ã€‘Spring MVC ä¸­çš„ DispatcherServlet","categories":[],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"}]},{"title":"Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„","slug":"Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„","date":"2018-04-08T09:48:41.000Z","updated":"2018-04-12T10:26:36.981Z","comments":true,"path":"2018/04/08/Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„/","link":"","permalink":"https://hsb786.github.io/2018/04/08/Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„/","excerpt":"çº¿ç¨‹å’Œå…±äº«æ•°æ® åœ¨JVMä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹ç‹¬äº«ä¸€å—æ ˆå†…å­˜ï¼Œå…¶ä¸­åŒ…æ‹¬å±€éƒ¨å˜é‡ã€çº¿ç¨‹è°ƒç”¨çš„æ¯ä¸ªæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ã€‚å…¶å®ƒçº¿ç¨‹æ— æ³•è¯»å–åˆ°è¯¥æ ˆå†…å­˜å—ä¸­çš„æ•°æ®ã€‚æ ˆä¸­çš„æ•°æ®ä»…é™äºåŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚ åœ¨JVMä¸­ï¼Œå †å†…å­˜æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ã€‚å¯¹è±¡åœ¨å †ä¸­ã€‚ è¿˜æœ‰ä¸€éƒ¨åˆ†æ•°æ®ä¿å­˜JVMä¸­çš„æ–¹æ³•åŒºä¸­ï¼Œæ¯”å¦‚ç±»çš„é™æ€å˜é‡ã€‚æ–¹æ³•åŒºå’Œæ ˆç±»ä¼¼ï¼Œå…¶ä¸­åªåŒ…å«åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚å’Œæ ˆä¸åŒçš„æ˜¯ï¼Œæ–¹æ³•åŒºä¸­çš„é™æ€å˜é‡å¯ä»¥è¢«æ‰€æœ‰çº¿ç¨‹è®¿é—®åˆ°ã€‚","text":"çº¿ç¨‹å’Œå…±äº«æ•°æ® åœ¨JVMä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹ç‹¬äº«ä¸€å—æ ˆå†…å­˜ï¼Œå…¶ä¸­åŒ…æ‹¬å±€éƒ¨å˜é‡ã€çº¿ç¨‹è°ƒç”¨çš„æ¯ä¸ªæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ã€‚å…¶å®ƒçº¿ç¨‹æ— æ³•è¯»å–åˆ°è¯¥æ ˆå†…å­˜å—ä¸­çš„æ•°æ®ã€‚æ ˆä¸­çš„æ•°æ®ä»…é™äºåŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚ åœ¨JVMä¸­ï¼Œå †å†…å­˜æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ã€‚å¯¹è±¡åœ¨å †ä¸­ã€‚ è¿˜æœ‰ä¸€éƒ¨åˆ†æ•°æ®ä¿å­˜JVMä¸­çš„æ–¹æ³•åŒºä¸­ï¼Œæ¯”å¦‚ç±»çš„é™æ€å˜é‡ã€‚æ–¹æ³•åŒºå’Œæ ˆç±»ä¼¼ï¼Œå…¶ä¸­åªåŒ…å«åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚å’Œæ ˆä¸åŒçš„æ˜¯ï¼Œæ–¹æ³•åŒºä¸­çš„é™æ€å˜é‡å¯ä»¥è¢«æ‰€æœ‰çº¿ç¨‹è®¿é—®åˆ°ã€‚ å¯¹è±¡å’Œç±»çš„é” JMMä¸­æœ‰ä¸¤å—åŒºåŸŸå¯ä»¥è¢«æ‰€æœ‰çº¿ç¨‹å…±äº« å †ï¼Œå­˜æ”¾ç€æ‰€æœ‰å¯¹è±¡æ–¹æ³•åŒºï¼Œå­˜æ”¾ç€é™æ€å˜é‡ é‚£ä¹ˆï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹æƒ³è¦åŒæ—¶è®¿é—®åŒä¸€ä¸ªå¯¹è±¡æˆ–è€…é™æ€å˜é‡ï¼Œå°±éœ€è¦è¢«ç®¡æ§ï¼Œå¦åˆ™å¯èƒ½å‡ºç°ä¸å¯é¢„æœŸçš„ç»“æœ ä¸ºäº†åè°ƒå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å…±äº«æ•°æ®è®¿é—®ï¼Œè™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å’Œç±»éƒ½åˆ†é…äº†ä¸€ä¸ªé”ã€‚è¿™ä¸ªé”å°±åƒä¸€ä¸ªç‰¹æƒï¼Œåœ¨åŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥â€œæ‹¥æœ‰â€è¿™ä¸ªç±»æˆ–è€…å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹æƒ³è¦è·å¾—æŸä¸ªç±»æˆ–è€…å¯¹è±¡çš„é”ï¼Œéœ€è¦è¯¢é—®è™šæ‹Ÿæœºã€‚å½“ä¸€ä¸ªçº¿ç¨‹å‘è™šæ‹Ÿæœºç”³è¯·æŸä¸ªç±»æˆ–è€…å¯¹è±¡çš„é”ä¹‹åï¼Œä¹Ÿè®¸å¾ˆå¿«æˆ–è€…å¾ˆæ…¢è™šæ‹Ÿæœºå¯ä»¥æŠŠé”åˆ†é…ç»™è¿™ä¸ªçº¿ç¨‹ï¼ŒåŒæ—¶è¿™ä¸ªçº¿ç¨‹ä¹Ÿè®¸æ°¸è¿œä¹Ÿæ— æ³•è·å¾—é”ã€‚ä½†çº¿ç¨‹ä¸å†éœ€è¦é”çš„æ—¶å€™ï¼Œä»–å†æŠŠé”è¿˜ç»™è™šæ‹Ÿæœºã€‚è¿™æ—¶è™šæ‹Ÿæœºå°±å¯ä»¥å†æŠŠé”åˆ†é…ç»™å…¶å®ƒç”³è¯·é”çš„çº¿ç¨‹ã€‚ ç±»é”å…¶å®é€šè¿‡å¯¹è±¡é”å®ç°çš„ã€‚å› ä¸ºå½“è™šæ‹ŸæœºåŠ è½½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œä¼šä¸ºè¿™ä¸ªç±»å®ä¾‹åŒ–ä¸€ä¸ªjava.lang.Classå¯¹è±¡ï¼Œå½“ä½ é”ä½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå…¶å®é”ä½çš„æ˜¯å…¶å¯¹åº”çš„Classå¯¹è±¡ ç›‘è§†å™¨ï¼ˆMonitorsï¼‰ é”å…¶å®æ˜¯é€šè¿‡ç›‘è§†å™¨å®ç°çš„ï¼Œç›‘è§†å™¨ä¸»è¦åŠŸèƒ½æ˜¯ç›‘æ§ä¸€æ®µä»£ç ï¼Œç¡®ä¿åœ¨åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œã€‚ æ¯ä¸ªç›‘è§†å™¨éƒ½ä¸ä¸€ä¸ªå¯¹è±¡ç›¸å…³è”ã€‚å½“çº¿ç¨‹æ‰§è¡Œåˆ°ç›‘è§†å™¨ç›‘è§†ä¸‹çš„ä»£ç å—ä¸­çš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ—¶ï¼Œçº¿ç¨‹å¿…é¡»è·å–å¯¹è¢«å¼•ç”¨å¯¹è±¡çš„é”å®šã€‚åœ¨çº¿ç¨‹è·å–é”ä¹‹å‰ï¼Œå®ƒæ˜¯æ— æ³•æ‰§è¡Œè¿™æ®µä»£ç çš„ï¼Œä¸€æ—¦è·å¾—é”ï¼Œçº¿ç¨‹ä¾¿å¯ä»¥è¿›å…¥â€œè¢«ä¿æŠ¤â€çš„ä»£ç å¼€å§‹æ‰§è¡Œã€‚ å½“çº¿ç¨‹ç¦»å¼€ä»£ç å—æ—¶ï¼Œæ— è®ºå¦‚ä½•ç¦»å¼€ï¼Œéƒ½ä¼šé‡Šæ”¾æ‰€å…³è”å¯¹è±¡çš„é” å¤šæ¬¡åŠ é” åŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯¹åŒä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¤šæ¬¡åŠ é”ã€‚æ¯ä¸ªå¯¹è±¡ç»´æŠ¤ç€ä¸€ä¸ªè®°å½•ç€è¢«é”æ¬¡æ•°çš„è®¡æ•°å™¨ã€‚æœªè¢«é”å®šçš„å¯¹è±¡çš„è¯¥è®¡æ•°å™¨ä¸º0ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å¾—é”åï¼Œè¯¥è®¡æ•°å™¨è‡ªå¢å˜ä¸º1ï¼Œå½“åŒä¸€ä¸ªçº¿ç¨‹å†æ¬¡è·å¾—è¯¥å¯¹è±¡çš„é”çš„æ—¶å€™ï¼Œè®¡æ•°å™¨å†æ¬¡è‡ªå¢ã€‚å½“åŒä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”çš„æ—¶å€™ï¼Œè®¡æ•°å™¨å†è‡ªå‡ã€‚å½“è®¡æ•°å™¨ä¸º0çš„æ—¶å€™ã€‚é”å°†è¢«é‡Šæ”¾ï¼Œå…¶å®ƒçº¿ç¨‹ä¾¿å¯ä»¥è·å¾—é”ã€‚ åŒæ­¥ åœ¨Javaä¸­ï¼Œå½“æœ‰å¤šä¸ªçº¿ç¨‹éƒ½å¿…é¡»è¦å¯¹åŒä¸€ä¸ªå…±äº«æ•°æ®è¿›è¡Œè®¿é—®æ—¶ï¼Œæœ‰ä¸€ç§åè°ƒæ–¹å¼å«åšåŒæ­¥ã€‚Javaè¯­è¨€æä¾›äº†ä¸¤ç§å†…ç½®æ–¹å¼æ¥ä½¿çº¿ç¨‹åŒæ­¥çš„è®¿é—®æ•°æ®ï¼šåŒæ­¥ä»£ç å—å’ŒåŒæ­¥æ–¹æ³•ã€‚ å‚è€ƒ Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"lombok","slug":"lombok","date":"2018-04-08T08:23:41.000Z","updated":"2018-04-11T04:46:26.649Z","comments":true,"path":"2018/04/08/lombok/","link":"","permalink":"https://hsb786.github.io/2018/04/08/lombok/","excerpt":"é€šè¿‡ä½¿ç”¨@Dataæ³¨è§£è‡ªåŠ¨å¸®ä½ ç”Ÿæˆgetters,setters,toString(),equals(),hashCode()æ–¹æ³• @AllArgsConstructor å…¨å‚æ„é€ å‡½æ•° @NoArgsConstructor æ— å‚æ„é€ å‡½æ•°","text":"é€šè¿‡ä½¿ç”¨@Dataæ³¨è§£è‡ªåŠ¨å¸®ä½ ç”Ÿæˆgetters,setters,toString(),equals(),hashCode()æ–¹æ³• @AllArgsConstructor å…¨å‚æ„é€ å‡½æ•° @NoArgsConstructor æ— å‚æ„é€ å‡½æ•°","categories":[],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"NaN","slug":"NaN","date":"2018-04-08T08:07:41.000Z","updated":"2018-04-12T10:18:38.350Z","comments":true,"path":"2018/04/08/NaN/","link":"","permalink":"https://hsb786.github.io/2018/04/08/NaN/","excerpt":"","text":"NaNè¡¨ç¤ºæœªå®šä¹‰æˆ–ä¸å¯è¡¨ç¤ºçš„å€¼ A constant holding a Not-a-Number (NaN) value of type public static final double NaN = 0.0d /0.0; Javaä¸­çš„Doubleå’ŒFloatéƒ½æœ‰isNaNã€‚åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯NaNï¼Œé€šè¿‡v!=vçš„æ–¹å¼ã€‚ NaNæ˜¯å”¯ä¸€ä¸è‡ªå·±ä¸ç›¸ç­‰çš„å€¼ï¼ŒNaNä¸ä»»ä½•å€¼éƒ½ä¸ç›¸ç­‰ã€‚","categories":[],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"VSCodeå¿«æ·é”®","slug":"VSCodeå¿«æ·é”®","date":"2018-04-08T07:58:41.000Z","updated":"2018-04-13T04:19:33.526Z","comments":true,"path":"2018/04/08/VSCodeå¿«æ·é”®/","link":"","permalink":"https://hsb786.github.io/2018/04/08/VSCodeå¿«æ·é”®/","excerpt":"","text":"å‘½ä»¤ è¯­ä¹‰ ctrl B ä¾§è¾¹æ æ˜¾/éš ctrl shift E èµ„æºç®¡ç†å™¨ ctrl tab æ–‡ä»¶åˆ‡æ¢ F1æˆ–ctrl shift p å‘½ä»¤çª—å£ ctrl , ç”¨æˆ·è®¾ç½®","categories":[],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"gitå‘½ä»¤","slug":"gitCommand","date":"2018-04-08T07:42:41.000Z","updated":"2018-04-14T06:01:14.203Z","comments":true,"path":"2018/04/08/gitCommand/","link":"","permalink":"https://hsb786.github.io/2018/04/08/gitCommand/","excerpt":"","text":"","categories":[],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"markdown","slug":"markdown","date":"2018-04-08T04:31:41.000Z","updated":"2018-04-13T11:31:54.189Z","comments":true,"path":"2018/04/08/markdown/","link":"","permalink":"https://hsb786.github.io/2018/04/08/markdown/","excerpt":"Cmd Markdown ç®€æ˜è¯­æ³•æ‰‹å†Œæ ‡ç­¾ï¼š Cmd-Markdown","text":"Cmd Markdown ç®€æ˜è¯­æ³•æ‰‹å†Œæ ‡ç­¾ï¼š Cmd-Markdown 1. æ–œä½“å’Œç²—ä½“ä½¿ç”¨ * å’Œ ** è¡¨ç¤ºæ–œä½“å’Œç²—ä½“ã€‚ ç¤ºä¾‹ï¼š è¿™æ˜¯ æ–œä½“ï¼Œè¿™æ˜¯ ç²—ä½“ã€‚ 2. åˆ†çº§æ ‡é¢˜ä½¿ç”¨ === è¡¨ç¤ºä¸€çº§æ ‡é¢˜ï¼Œä½¿ç”¨ â€” è¡¨ç¤ºäºŒçº§æ ‡é¢˜ã€‚ ç¤ºä¾‹ï¼š 1234567è¿™æ˜¯ä¸€ä¸ªä¸€çº§æ ‡é¢˜============================è¿™æ˜¯ä¸€ä¸ªäºŒçº§æ ‡é¢˜--------------------------------------------------### è¿™æ˜¯ä¸€ä¸ªä¸‰çº§æ ‡é¢˜ ä½ ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨è¡Œé¦–åŠ äº•å·è¡¨ç¤ºä¸åŒçº§åˆ«çš„æ ‡é¢˜ (H1-H6)ï¼Œä¾‹å¦‚ï¼š# H1, ## H2, ### H3ï¼Œ#### H4ã€‚ 3. å¤–é“¾æ¥ä½¿ç”¨ [æè¿°](é“¾æ¥åœ°å€) ä¸ºæ–‡å­—å¢åŠ å¤–é“¾æ¥ã€‚ ç¤ºä¾‹ï¼š è¿™æ˜¯å»å¾€ æœ¬äººåšå®¢ çš„é“¾æ¥ã€‚ 4. æ— åºåˆ—è¡¨ä½¿ç”¨ *ï¼Œ+ï¼Œ- è¡¨ç¤ºæ— åºåˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š æ— åºåˆ—è¡¨é¡¹ ä¸€ æ— åºåˆ—è¡¨é¡¹ äºŒ æ— åºåˆ—è¡¨é¡¹ ä¸‰ 5. æœ‰åºåˆ—è¡¨ä½¿ç”¨æ•°å­—å’Œç‚¹è¡¨ç¤ºæœ‰åºåˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š æœ‰åºåˆ—è¡¨é¡¹ ä¸€ æœ‰åºåˆ—è¡¨é¡¹ äºŒ æœ‰åºåˆ—è¡¨é¡¹ ä¸‰ 6. æ–‡å­—å¼•ç”¨ä½¿ç”¨ &gt; è¡¨ç¤ºæ–‡å­—å¼•ç”¨ã€‚ ç¤ºä¾‹ï¼š é‡ç«çƒ§ä¸å°½ï¼Œæ˜¥é£å¹åˆç”Ÿã€‚ 7. è¡Œå†…ä»£ç å—ä½¿ç”¨ `ä»£ç ` è¡¨ç¤ºè¡Œå†…ä»£ç å—ã€‚ ç¤ºä¾‹ï¼š è®©æˆ‘ä»¬èŠèŠ htmlã€‚ 8. ä»£ç å—ä½¿ç”¨ å››ä¸ªç¼©è¿›ç©ºæ ¼ è¡¨ç¤ºä»£ç å—ã€‚ ç¤ºä¾‹ï¼š è¿™æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œæ­¤è¡Œå·¦ä¾§æœ‰å››ä¸ªä¸å¯è§çš„ç©ºæ ¼ã€‚ 9. æ’å…¥å›¾åƒä½¿ç”¨ ![æè¿°](å›¾ç‰‡é“¾æ¥åœ°å€) æ’å…¥å›¾åƒã€‚ ç¤ºä¾‹ï¼š Cmd Markdown é«˜é˜¶è¯­æ³•æ‰‹å†Œ1. å†…å®¹ç›®å½•åœ¨æ®µè½ä¸­å¡«å†™ [TOC] ä»¥æ˜¾ç¤ºå…¨æ–‡å†…å®¹çš„ç›®å½•ç»“æ„ã€‚ [TOC] 2. æ ‡ç­¾åˆ†ç±»åœ¨ç¼–è¾‘åŒºä»»æ„è¡Œçš„åˆ—é¦–ä½ç½®è¾“å…¥ä»¥ä¸‹ä»£ç ç»™æ–‡ç¨¿æ ‡ç­¾ï¼š æ ‡ç­¾ï¼š æ•°å­¦ è‹±è¯­ Markdown æˆ–è€… Tagsï¼š æ•°å­¦ è‹±è¯­ Markdown 3. åˆ é™¤çº¿ä½¿ç”¨ ~~ è¡¨ç¤ºåˆ é™¤çº¿ã€‚ è¿™æ˜¯ä¸€æ®µé”™è¯¯çš„æ–‡æœ¬ã€‚ 4. æ³¨è„šä½¿ç”¨ [^keyword] è¡¨ç¤ºæ³¨è„šã€‚ è¿™æ˜¯ä¸€ä¸ªæ³¨è„š[^footnote]çš„æ ·ä¾‹ã€‚ è¿™æ˜¯ç¬¬äºŒä¸ªæ³¨è„š[^footnote2]çš„æ ·ä¾‹ã€‚ 5. LaTeX å…¬å¼$ è¡¨ç¤ºè¡Œå†…å…¬å¼ï¼š è´¨èƒ½å®ˆæ’æ–¹ç¨‹å¯ä»¥ç”¨ä¸€ä¸ªå¾ˆç®€æ´çš„æ–¹ç¨‹å¼ $E=mc^2$ æ¥è¡¨è¾¾ã€‚ $$ è¡¨ç¤ºæ•´è¡Œå…¬å¼ï¼š $$\\sum_{i=1}^n a_i=0$$ $$f(x_1,x_x,\\ldots,x_n) = x_1^2 + x_2^2 + \\cdots + x_n^2 $$ $$\\sum^{j-1}{k=0}{\\widehat{\\gamma}{kj} z_k}$$ è®¿é—® MathJax å‚è€ƒæ›´å¤šä½¿ç”¨æ–¹æ³•ã€‚ 6. åŠ å¼ºçš„ä»£ç å—æ”¯æŒå››åä¸€ç§ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•é«˜äº®çš„æ˜¾ç¤ºï¼Œè¡Œå·æ˜¾ç¤ºã€‚ éä»£ç ç¤ºä¾‹ï¼š 1$ sudo apt-get install vim-gnome Python ç¤ºä¾‹ï¼š 123456789101112@requires_authorizationdef somefunc(param1='', param2=0): '''A docstring''' if param1 &gt; param2: # interesting print 'Greater' return (param2 - param1 + 1) or Noneclass SomeClass: pass&gt;&gt;&gt; message = '''interpreter... prompt''' JavaScript ç¤ºä¾‹ï¼š 1234567891011121314151617/*** nth element in the fibonacci series.* @param n &gt;= 0* @return the nth element, &gt;= 0.*/function fib(n) &#123; var a = 1, b = 1; var tmp; while (--n &gt;= 0) &#123; tmp = a; a += b; b = tmp; &#125; return a;&#125;document.write(fib(10)); 7. æµç¨‹å›¾ç¤ºä¾‹12345678910st=&gt;start: Start:&gt;https://www.zybuluo.comio=&gt;inputoutput: verificationop=&gt;operation: Your Operationcond=&gt;condition: Yes or No?sub=&gt;subroutine: Your Subroutinee=&gt;endst-&gt;io-&gt;op-&gt;condcond(yes)-&gt;econd(no)-&gt;sub-&gt;io æ›´å¤šè¯­æ³•å‚è€ƒï¼šæµç¨‹å›¾è¯­æ³•å‚è€ƒ8. åºåˆ—å›¾ç¤ºä¾‹ 1123Alice-&gt;Bob: Hello Bob, how are you?Note right of Bob: Bob thinksBob--&gt;Alice: I am good thanks! ç¤ºä¾‹ 212345Title: Here is a titleA-&gt;B: Normal lineB--&gt;C: Dashed lineC-&gt;&gt;D: Open arrowD--&gt;&gt;A: Dashed open arrow æ›´å¤šè¯­æ³•å‚è€ƒï¼šåºåˆ—å›¾è¯­æ³•å‚è€ƒ9. ç”˜ç‰¹å›¾ç”˜ç‰¹å›¾å†…åœ¨æ€æƒ³ç®€å•ã€‚åŸºæœ¬æ˜¯ä¸€æ¡çº¿æ¡å›¾ï¼Œæ¨ªè½´è¡¨ç¤ºæ—¶é—´ï¼Œçºµè½´è¡¨ç¤ºæ´»åŠ¨ï¼ˆé¡¹ç›®ï¼‰ï¼Œçº¿æ¡è¡¨ç¤ºåœ¨æ•´ä¸ªæœŸé—´ä¸Šè®¡åˆ’å’Œå®é™…çš„æ´»åŠ¨å®Œæˆæƒ…å†µã€‚å®ƒç›´è§‚åœ°è¡¨æ˜ä»»åŠ¡è®¡åˆ’åœ¨ä»€ä¹ˆæ—¶å€™è¿›è¡Œï¼ŒåŠå®é™…è¿›å±•ä¸è®¡åˆ’è¦æ±‚çš„å¯¹æ¯”ã€‚ 12345678910111213title é¡¹ç›®å¼€å‘æµç¨‹section é¡¹ç›®ç¡®å®š éœ€æ±‚åˆ†æ :a1, 2016-06-22, 3d å¯è¡Œæ€§æŠ¥å‘Š :after a1, 5d æ¦‚å¿µéªŒè¯ : 5dsection é¡¹ç›®å®æ–½ æ¦‚è¦è®¾è®¡ :2016-07-05 , 5d è¯¦ç»†è®¾è®¡ :2016-07-08, 10d ç¼–ç  :2016-07-15, 10d æµ‹è¯• :2016-07-22, 5dsection å‘å¸ƒéªŒæ”¶ å‘å¸ƒ: 2d éªŒæ”¶: 3d æ›´å¤šè¯­æ³•å‚è€ƒï¼šç”˜ç‰¹å›¾è¯­æ³•å‚è€ƒ10. Mermaid æµç¨‹å›¾1234A[Hard edge] --&gt;|Link text| B(Round edge)B --&gt; C&#123;Decision&#125;C --&gt;|One| D[Result one]C --&gt;|Two| E[Result two] æ›´å¤šè¯­æ³•å‚è€ƒï¼šMermaid æµç¨‹å›¾è¯­æ³•å‚è€ƒ11. Mermaid åºåˆ—å›¾1234Alice-&gt;John: Hello John, how are you?loop every minute John--&gt;Alice: Great!end æ›´å¤šè¯­æ³•å‚è€ƒï¼šMermaid åºåˆ—å›¾è¯­æ³•å‚è€ƒ12. è¡¨æ ¼æ”¯æŒ é¡¹ç›® ä»·æ ¼ æ•°é‡ è®¡ç®—æœº \\$1600 5 æ‰‹æœº \\$12 12 ç®¡çº¿ \\$1 234 13. å®šä¹‰å‹åˆ—è¡¨åè¯ 1: å®šä¹‰ 1ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å— 2: è¿™æ˜¯ä»£ç å—çš„å®šä¹‰ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å—ï¼ˆå·¦ä¾§æœ‰å…«ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ 14. Html æ ‡ç­¾æœ¬ç«™æ”¯æŒåœ¨ Markdown è¯­æ³•ä¸­åµŒå¥— Html æ ‡ç­¾ï¼Œè­¬å¦‚ï¼Œä½ å¯ä»¥ç”¨ Html å†™ä¸€ä¸ªçºµè·¨ä¸¤è¡Œçš„è¡¨æ ¼ï¼š &lt;table&gt; &lt;tr&gt; &lt;th rowspan=&quot;2&quot;&gt;å€¼ç­äººå‘˜&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸä¸€&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸäºŒ&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸä¸‰&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;æå¼º&lt;/td&gt; &lt;td&gt;å¼ æ˜&lt;/td&gt; &lt;td&gt;ç‹å¹³&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; å€¼ç­äººå‘˜ æ˜ŸæœŸä¸€ æ˜ŸæœŸäºŒ æ˜ŸæœŸä¸‰ æå¼º å¼ æ˜ ç‹å¹³ 15. å†…åµŒå›¾æ ‡æœ¬ç«™çš„å›¾æ ‡ç³»ç»Ÿå¯¹å¤–å¼€æ”¾ï¼Œåœ¨æ–‡æ¡£ä¸­è¾“å…¥ &lt;i class=&quot;icon-weibo&quot;&gt;&lt;/i&gt; å³æ˜¾ç¤ºå¾®åšçš„å›¾æ ‡ï¼š æ›¿æ¢ ä¸Šè¿° i æ ‡ç­¾ å†…çš„ icon-weibo ä»¥æ˜¾ç¤ºä¸åŒçš„å›¾æ ‡ï¼Œä¾‹å¦‚ï¼š &lt;i class=&quot;icon-renren&quot;&gt;&lt;/i&gt; å³æ˜¾ç¤ºäººäººçš„å›¾æ ‡ï¼š æ›´å¤šçš„å›¾æ ‡å’Œç©æ³•å¯ä»¥å‚çœ‹ font-awesome å®˜æ–¹ç½‘ç«™ã€‚ 16. å¾…åŠäº‹å®œ Todo åˆ—è¡¨ä½¿ç”¨å¸¦æœ‰ [ ] æˆ– [x] ï¼ˆæœªå®Œæˆæˆ–å·²å®Œæˆï¼‰é¡¹çš„åˆ—è¡¨è¯­æ³•æ’°å†™ä¸€ä¸ªå¾…åŠäº‹å®œåˆ—è¡¨ï¼Œå¹¶ä¸”æ”¯æŒå­åˆ—è¡¨åµŒå¥—ä»¥åŠæ··ç”¨Markdownè¯­æ³•ï¼Œä¾‹å¦‚ï¼š - [ ] **Cmd Markdown å¼€å‘** - [ ] æ”¹è¿› Cmd æ¸²æŸ“ç®—æ³•ï¼Œä½¿ç”¨å±€éƒ¨æ¸²æŸ“æŠ€æœ¯æé«˜æ¸²æŸ“æ•ˆç‡ - [ ] æ”¯æŒä»¥ PDF æ ¼å¼å¯¼å‡ºæ–‡ç¨¿ - [x] æ–°å¢Todoåˆ—è¡¨åŠŸèƒ½ [è¯­æ³•å‚è€ƒ](https://github.com/blog/1375-task-lists-in-gfm-issues-pulls-comments) - [x] æ”¹è¿› LaTex åŠŸèƒ½ - [x] ä¿®å¤ LaTex å…¬å¼æ¸²æŸ“é—®é¢˜ - [x] æ–°å¢ LaTex å…¬å¼ç¼–å·åŠŸèƒ½ [è¯­æ³•å‚è€ƒ](http://docs.mathjax.org/en/latest/tex.html#tex-eq-numbers) - [ ] **ä¸ƒæœˆæ—…è¡Œå‡†å¤‡** - [ ] å‡†å¤‡é‚®è½®ä¸Šéœ€è¦æºå¸¦çš„ç‰©å“ - [ ] æµè§ˆæ—¥æœ¬å…ç¨åº—çš„ç‰©å“ - [x] è´­ä¹°è“å®çŸ³å…¬ä¸»å·ä¸ƒæœˆä¸€æ—¥çš„èˆ¹ç¥¨ å¯¹åº”æ˜¾ç¤ºå¦‚ä¸‹å¾…åŠäº‹å®œ Todo åˆ—è¡¨ï¼š Cmd Markdown å¼€å‘ æ”¹è¿› Cmd æ¸²æŸ“ç®—æ³•ï¼Œä½¿ç”¨å±€éƒ¨æ¸²æŸ“æŠ€æœ¯æé«˜æ¸²æŸ“æ•ˆç‡ æ”¯æŒä»¥ PDF æ ¼å¼å¯¼å‡ºæ–‡ç¨¿ æ–°å¢Todoåˆ—è¡¨åŠŸèƒ½ è¯­æ³•å‚è€ƒ æ”¹è¿› LaTex åŠŸèƒ½ ä¿®å¤ LaTex å…¬å¼æ¸²æŸ“é—®é¢˜ æ–°å¢ LaTex å…¬å¼ç¼–å·åŠŸèƒ½ è¯­æ³•å‚è€ƒ ä¸ƒæœˆæ—…è¡Œå‡†å¤‡ å‡†å¤‡é‚®è½®ä¸Šéœ€è¦æºå¸¦çš„ç‰©å“ æµè§ˆæ—¥æœ¬å…ç¨åº—çš„ç‰©å“ è´­ä¹°è“å®çŸ³å…¬ä¸»å·ä¸ƒæœˆä¸€æ—¥çš„èˆ¹ç¥¨","categories":[],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]}]}
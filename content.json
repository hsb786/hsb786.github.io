{"meta":{"title":"HuShengBinâ€™s blog","subtitle":"ç æ¸£çš„ä¸ªäººåšå®¢","description":"è®°å½•ç æ¸£çš„å¥‹æ–—å²","author":"HuShengBin","url":"https://hsb786.github.io"},"pages":[{"title":"å…³äºæˆ‘","date":"2018-04-09T10:17:26.000Z","updated":"2018-04-18T12:01:33.892Z","comments":true,"path":"about/index.html","permalink":"https://hsb786.github.io/about/index.html","excerpt":"","text":"1995 å¤©æ°åº§ï¼Œèº«é«˜ä¸é«˜ ç æ¸£ä¸€æšï¼Œå–œæ¬¢æ•²ä»£ç ï¼Œå¯æƒœå¤ªç¬¨ å¸¸å¹´æ··è¿¹åœ¨çŸ¥ä¹ã€è±†ç“£ã€ç½‘æ˜“äº‘ï¼Œæƒ³åšä¸ªæ–‡è‰ºé’å¹´ï¼Œå¯æƒœæ²¡é‚£ä¸ªæ°”è´¨ å¯¹ç§‘æŠ€éå¸¸æ„Ÿå…´è¶£ï¼Œå¯æƒœç©· å’–å•¡å°±æ˜¯ç”Ÿå‘½ è”ç³»æ–¹å¼ï¼š786398798@qq.com"},{"title":"åˆ†ç±»","date":"2018-04-20T13:36:52.783Z","updated":"2018-04-20T13:36:52.783Z","comments":true,"path":"categories/index.html","permalink":"https://hsb786.github.io/categories/index.html","excerpt":"","text":""},{"title":"äºŒå‰æ ‘","date":"2018-04-24T11:41:05.000Z","updated":"2018-04-24T12:00:13.137Z","comments":true,"path":"temp/äºŒå‰æ ‘.html","permalink":"https://hsb786.github.io/temp/äºŒå‰æ ‘.html","excerpt":"å¥½ä¹…æ²¡ç”¨è¿‡æ ‘äº†ï¼ŒåŸºæœ¬ä¸Šå…¨å¿˜è®°äº†ï¼Œè¡¥ä¹ ä¸€ä¸‹ã€‚","text":"å¥½ä¹…æ²¡ç”¨è¿‡æ ‘äº†ï¼ŒåŸºæœ¬ä¸Šå…¨å¿˜è®°äº†ï¼Œè¡¥ä¹ ä¸€ä¸‹ã€‚ äºŒå‰æ ‘(binary tree)æ˜¯ä¸€æ£µæ ‘ï¼Œå…¶ä¸­æ¯ä¸ªç»“ç‚¹éƒ½ä¸èƒ½æœ‰å¤šäºä¸¤ä¸ªå„¿å­ã€‚ äºŒå‰æ’åºæ ‘çš„æ€§è´¨: è‹¥ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ è‹¥ä»»æ„èŠ‚ç‚¹çš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ ä»»æ„èŠ‚ç‚¹çš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æŸ¥æ‰¾æ ‘ æ²¡æœ‰é”®å€¼ç›¸ç­‰çš„èŠ‚ç‚¹ éå†äºŒå‰æ ‘çš„éå†æ˜¯æŒ‡ä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼ŒæŒ‰ç…§æŸç§æ¬¡åºä¾æ¬¡è®¿é—®äºŒå‰æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹ï¼Œä½¿å¾—æ¯ä¸ªç»“ç‚¹è¢«è®¿é—®ä¸€æ¬¡ä¸”ä»…è¢«è®¿é—®ä¸€æ¬¡ã€‚äºŒå‰æ ‘çš„éå†æ–¹å¼æœ‰å¾ˆå¤šï¼Œä¸»è¦æœ‰å‰åºéå†ï¼Œä¸­åºéå†ï¼Œååºéå†ã€‚ å‰åºéå†è‹¥äºŒå‰æ ‘ä¸ºç©ºï¼Œåˆ™ç©ºæ“ä½œè¿”å›ï¼Œå¦åˆ™å…ˆè®¿é—®æ ¹èŠ‚ç‚¹ï¼Œç„¶åå‰åºéå†å·¦å­æ ‘ï¼Œå†å‰åºéå†å³å­æ ‘ 5-4-2-1-3-9-7-6-8 12345678public void preOrder(Node currNode) &#123; if (currNode == null) &#123; return; &#125; System.out.print(currNode.data + &quot; &quot;); preOrder(currNode.left); preOrder(currNode.right);&#125; ä¸­åºéå†æ ‘ä¸ºç©ºï¼Œåˆ™ç©ºæ“ä½œè¿”å›ï¼›å¦åˆ™ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼ˆæ³¨æ„å¹¶ä¸æ˜¯å…ˆè®¿é—®æ ¹èŠ‚ç‚¹ï¼‰ï¼Œä¸­åºéå†æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼Œç„¶åæ˜¯è®¿é—®æ ¹èŠ‚ç‚¹ï¼Œæœ€åä¸­åºéå†å³å­æ ‘ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ˜¯äºŒå‰æ’åºæ ‘ï¼Œä¸­åºéå†çš„ç»“æœå°±æ˜¯ä¸ªæœ‰åºåºåˆ—ã€‚ 1-2-3-4-5-6-7-8-912345678public void inOrder(Node currNode) &#123; if (currNode == null) &#123; return; &#125; inOrder(currNode.left); System.out.print(currNode.data + &quot; &quot;); inOrder(currNode.right);&#125; ååºéå†è‹¥æ ‘ä¸ºç©ºï¼Œåˆ™ç©ºæ“ä½œè¿”å›ï¼›ç„¶åå…ˆéå†å·¦å­æ ‘ï¼Œå†éå†å³å­æ ‘ï¼Œæœ€åè®¿é—®æ ¹ç»“ç‚¹ï¼Œåœ¨éå†å·¦ã€å³å­æ ‘æ—¶ï¼Œä»ç„¶å…ˆéå†å·¦å­æ ‘ï¼Œç„¶åéå†å³å­æ ‘ï¼Œæœ€åéå†æ ¹ç»“ç‚¹ 1-3-2-4-6-8-7-9-5 12345678public void postOrder(Node currNode) &#123; if (currNode == null) &#123; return; &#125; postOrder(currNode.left); System.out.print(currNode.data + &quot; &quot;); postOrder(currNode.right);&#125;"},{"title":"ThreadGroup","date":"2018-04-24T12:31:13.000Z","updated":"2018-04-24T13:13:01.044Z","comments":true,"path":"temp/ThreadGroup.html","permalink":"https://hsb786.github.io/temp/ThreadGroup.html","excerpt":"çœ‹Threadæºç æ—¶å‘ç°äº†ThreadGroupï¼Œä»¥å‰éƒ½æ²¡çœ‹åˆ°è¿‡ã€‚","text":"çœ‹Threadæºç æ—¶å‘ç°äº†ThreadGroupï¼Œä»¥å‰éƒ½æ²¡çœ‹åˆ°è¿‡ã€‚ A thread group represents a set of threads. In addition, a thread group can also include other thread groups. The thread groups form a tree in which every thread group except the initial thread group has a parent.ThreadGroupç”¨æ¥å­˜æ”¾çº¿ç¨‹çš„é›†åˆï¼Œä¸€ä¸ªthreadGroupå¯ä»¥åŒ…å«å…¶ä»–threadGroupã€‚çº¿ç¨‹ç»„æ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œé™¤äº†åˆå§‹çº¿ç¨‹ç»„ä¹‹å¤–ï¼Œéƒ½æœ‰ä¸€ä¸ªçˆ¶ç»“ç‚¹ã€‚ 12345678910111213141516171819202122232425262728//java.lang.ThreadGrouppublic class ThreadGroup implements Thread.UncaughtExceptionHandler &#123; private final ThreadGroup parent; //çˆ¶ç±»ThreadGroup String name; //åç§° int maxPriority; //çº¿ç¨‹æœ€å¤§ä¼˜å…ˆçº§ boolean destroyed; //æ˜¯å¦è¢«é”€æ¯ boolean daemon; //æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ boolean vmAllowSuspension; //æ˜¯å¦å¯ä»¥ä¸­æ–­ int nUnstartedThreads = 0; //è¿˜æœªå¯åŠ¨çš„çº¿ç¨‹ int nthreads; //ThreadGroupä¸­çº¿ç¨‹æ•° Thread threads[]; //ThreadGroupä¸­çº¿ç¨‹æ•°ç»„ int ngroups; //çº¿ç¨‹ç»„æ•° ThreadGroup groups[]; //çº¿ç¨‹ç»„æ•°ç»„ /** * Creates an empty Thread group that is not in any Thread group. * This method is used to create the system Thread group. */ private ThreadGroup() &#123; // called from C code this.name = &quot;system&quot;; this.maxPriority = Thread.MAX_PRIORITY; this.parent = null; &#125; ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&#125; ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰çº¿ç¨‹éƒ½å±äºæŒ‡å®šçº¿ç¨‹ç»„ï¼Œå¦‚æœæ²¡æœ‰æ˜¾ç¤ºæŒ‡å®šå±äºå“ªä¸ªçº¿ç¨‹ç»„ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹å°±å±äºé»˜è®¤çº¿ç¨‹ç»„ï¼ˆå³mainçº¿ç¨‹ç»„ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå­çº¿ç¨‹å’Œçˆ¶çº¿ç¨‹å¤„äºåŒä¸€ä¸ªçº¿ç¨‹ç»„ã€‚ åªæœ‰åœ¨åˆ›å»ºçº¿ç¨‹æ—¶æ‰èƒ½æŒ‡å®šå…¶æ‰€åœ¨çš„çº¿ç¨‹ç»„ï¼Œçº¿ç¨‹è¿è¡Œä¸­é€”ä¸èƒ½æ”¹å˜å®ƒæ‰€å±çš„çº¿ç¨‹ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹ä¸€æ—¦æŒ‡å®šæ‰€åœ¨çš„çº¿ç¨‹ç»„ï¼Œå°±ç›´åˆ°è¯¥çº¿ç¨‹ç»“æŸã€‚ å…ˆåšä¸ªå°æµ‹è¯• UncaughtExceptionHandleråœ¨Threadç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªUncaughtExceptionHandleræ¥å£1234567//Thread.class @FunctionalInterface public interface UncaughtExceptionHandler &#123; //Method invoked when the given thread terminates due to the given uncaught exception. //ä½†çº¿ç¨‹ç”±äºæœªæ•æ‰çš„å¼‚å¸¸è€Œä¸­æ–­æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ void uncaughtException(Thread t, Throwable e); &#125; ä¸¾ä¸ªæ —å­ğŸ‚123456789101112131415161718public class T01 &#123; public static void main(String[] args) &#123; // è®¾ç½®ä¸»çº¿ç¨‹çš„å¼‚å¸¸å¤„ç†å™¨ Thread.currentThread().setUncaughtExceptionHandler(new MyExHandler()); int a = 5 / 0; &#125;&#125;// å®šä¹‰è‡ªå·±çš„å¼‚å¸¸å¤„ç†å™¨class MyExHandler implements Thread.UncaughtExceptionHandler &#123; // å®ç°uncaughtExceptionæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†å¤„ç†çº¿ç¨‹çš„æœªå¤„ç†å¼‚å¸¸ public void uncaughtException(Thread t, Throwable e) &#123; System.out.println(t + &quot; çº¿ç¨‹å‡ºç°äº†å¼‚å¸¸ï¼š&quot; + e); &#125;&#125;//outputThread[main,5,main] çº¿ç¨‹å‡ºç°äº†å¼‚å¸¸ï¼šjava.lang.ArithmeticException: / by zero çº¿ç¨‹ç»„å’Œçº¿ç¨‹æ± çš„åŒºåˆ«çº¿ç¨‹ç»„ çº¿ç¨‹ç»„å­˜åœ¨çš„æ„ä¹‰ï¼Œé¦–è¦åŸå› æ˜¯å®‰å…¨ã€‚ javaé»˜è®¤åˆ›å»ºçš„çº¿ç¨‹éƒ½æ˜¯å±äºç³»ç»Ÿçº¿ç¨‹ç»„ï¼Œè€ŒåŒä¸€ä¸ªçº¿ç¨‹ç»„çš„çº¿ç¨‹æ˜¯å¯ä»¥ç›¸äº’ä¿®æ”¹å¯¹æ–¹çš„æ•°æ®çš„ã€‚ ä½†å¦‚æœåœ¨ä¸åŒçš„çº¿ç¨‹ç»„ä¸­ï¼Œé‚£ä¹ˆå°±ä¸èƒ½â€œè·¨çº¿ç¨‹ç»„â€ä¿®æ”¹æ•°æ®ï¼Œå¯ä»¥ä»ä¸€å®šç¨‹åº¦ä¸Šä¿è¯æ•°æ®å®‰å…¨ã€‚ çº¿ç¨‹æ±  çº¿ç¨‹æ± å­˜åœ¨çš„æ„ä¹‰ï¼Œé¦–è¦ä½œç”¨æ˜¯æ•ˆç‡ã€‚ çº¿ç¨‹çš„åˆ›å»ºå’Œç»“æŸéƒ½éœ€è¦è€—è´¹ä¸€å®šçš„ç³»ç»Ÿæ—¶é—´ï¼ˆç‰¹åˆ«æ˜¯åˆ›å»ºï¼‰ï¼Œä¸åœåˆ›å»ºå’Œåˆ é™¤çº¿ç¨‹ä¼šæµªè´¹å¤§é‡çš„æ—¶é—´ã€‚æ‰€ä»¥ï¼Œåœ¨åˆ›å»ºå‡ºä¸€æ¡çº¿ç¨‹å¹¶ä½¿å…¶åœ¨æ‰§è¡Œå®Œä»»åŠ¡åä¸ç»“æŸï¼Œè€Œæ˜¯ä½¿å…¶è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œåœ¨éœ€è¦ç”¨æ—¶å†å”¤é†’ï¼Œé‚£ä¹ˆ å°±å¯ä»¥èŠ‚çœä¸€å®šçš„æ—¶é—´ã€‚ å¦‚æœè¿™æ ·çš„çº¿ç¨‹æ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ± æ¥è¿›è¡Œç®¡ç†ã€‚ä¿è¯æ•ˆç‡ã€‚ å‚è€ƒ Java å¤šçº¿ç¨‹ï¼ˆä¸ƒï¼‰â€”â€”çº¿ç¨‹ç»„ä¸çº¿ç¨‹æ±  Javaå¹¶å‘ç¼–ç¨‹ä¸æŠ€æœ¯å†…å¹•:ThreadGroupçº¿ç¨‹ç»„åº”ç”¨"},{"title":"äºŒç»´æ•°ç»„çš„æŸ¥æ‰¾","date":"2018-04-10T04:01:22.000Z","updated":"2018-04-20T13:20:59.669Z","comments":true,"path":"temp/äºŒç»´æ•°ç»„çš„æŸ¥æ‰¾.html","permalink":"https://hsb786.github.io/temp/äºŒç»´æ•°ç»„çš„æŸ¥æ‰¾.html","excerpt":"åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚","text":"åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚12345678910111213141516171819202122/** * ä»å·¦ä¸‹è§’å¼€å§‹æ¯”ï¼ŒæŸ¥æ‰¾çš„æ•°å­—å¤§äºéå†å€¼å³ç§»ï¼›æŸ¥æ‰¾çš„æ•°å­—å°äºéå†å€¼ä¸Šç§» * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸Šåˆ11:55:27 */public static boolean find(int targer, int[][] array) &#123; int rows = array.length; int columns = array[0].length; int i = rows - 1, j = 0; while (targer != array[i][j]) &#123; if (targer &gt; array[i][j]) &#123; j++; &#125; else &#123; i--; &#125; if (i &lt; 0 || j &lt; 0 || i &gt; rows || j &gt; columns) &#123; return false; &#125; &#125; return true;&#125;"},{"title":"IO/NIO","date":"2018-04-17T10:55:26.000Z","updated":"2018-04-17T11:02:18.313Z","comments":true,"path":"temp/IO-NIO.html","permalink":"https://hsb786.github.io/temp/IO-NIO.html","excerpt":"","text":"IOå­—èŠ‚IOå­—èŠ‚æµå¤„ç†å•å…ƒä¸º1ä¸ªå­—èŠ‚ï¼Œä¸»è¦ç”¨åœ¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œå­—èŠ‚ç”¨æ¥ä¸æ–‡ä»¶æ‰“äº¤é“ï¼Œæ‰€æœ‰æ–‡ä»¶çš„å‚¨å­˜éƒ½æ˜¯é€šè¿‡å­—èŠ‚ï¼ˆbyteï¼‰çš„æ–¹å¼ï¼Œåœ¨ç£ç›˜ä¸Šä¿ç•™çš„å¹¶ä¸æ˜¯æ–‡ä»¶çš„å­—ç¬¦è€Œæ˜¯å…ˆæŠŠå­—ç¬¦ç¼–ç æˆå­—èŠ‚ï¼Œå†å‚¨å­˜è¿™äº›å­—èŠ‚åˆ°ç£ç›˜ã€‚åœ¨è¯»å–æ–‡ä»¶ï¼ˆç‰¹åˆ«æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼‰æ—¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°è¯»å–å½¢æˆå­—èŠ‚åºåˆ—ã€‚ å­—ç¬¦IOå®é™…ä¸­å¾ˆå¤šçš„æ•°æ®æ˜¯æ–‡æœ¬ï¼Œå› æ­¤æœ‰äº†å­—ç¬¦æµçš„æ¦‚å¿µï¼Œå­—ç¬¦æµåªç”¨äºå¤„ç†æ–‡å­—æ•°æ®ã€‚å­—ç¬¦æµå¤„ç†å•å…ƒä¸º2ä¸ªå­—èŠ‚çš„Unicodeå­—ç¬¦ã€‚ å­—ç¬¦æµä¸­çš„å¯¹è±¡èåˆäº†ç¼–ç è¡¨ï¼Œä½¿ç”¨çš„æ˜¯é»˜è®¤çš„ç¼–ç ï¼Œå³å½“å‰ç³»ç»Ÿçš„ç¼–ç ã€‚åœ¨å®é™…å¼€å‘ä¸­å‡ºç°çš„æ±‰å­—ä¹±ç é—®é¢˜å®é™…ä¸Šéƒ½æ˜¯åœ¨å­—ç¬¦æµå’Œå­—èŠ‚æµä¹‹é—´è½¬åŒ–ä¸ç»Ÿä¸€è€Œé€ æˆçš„ã€‚ NIOChannelï¼ˆé€šé“ï¼‰ï¼ŒBufferï¼ˆç¼“å­˜åŒºï¼‰ï¼ŒSelectorï¼ˆé€‰æ‹©å™¨ï¼‰ Channelï¼ˆé€šé“ï¼‰åœ¨ä¼ ç»ŸIOä¸­æˆ‘ä»¬è¦è¯»å–ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹æ—¶InputStreamå®é™…ä¸Šå°±æ˜¯ä¸ºè¯»å–æ–‡ä»¶æä¾›äº†ä¸€ä¸ªé€šé“ï¼Œå› æ­¤å¯ä»¥å°†NIO ä¸­çš„ChannelåŒä¼ ç»ŸIOä¸­çš„Streamæ¥ç±»æ¯”ã€‚ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œä¼ ç»ŸIOä¸­çš„Streamæ˜¯å•å‘çš„ï¼Œæ¯”å¦‚InputStreamåªèƒ½è¿›è¡Œè¯»å–æ“ä½œï¼ŒOutputStreamåªèƒ½è¿›è¡Œå†™æ“ä½œï¼›è€ŒChannelæ˜¯åŒå‘çš„ï¼Œæ—¢å¯ç”¨æ¥è¿›è¡Œè¯»æ“ä½œåˆå¯ç”¨æ¥è¿›è¡Œå†™æ“ä½œã€‚"},{"title":"åè½¬é“¾è¡¨","date":"2018-04-10T12:14:31.000Z","updated":"2018-04-20T13:21:09.478Z","comments":true,"path":"temp/åè½¬é“¾è¡¨.html","permalink":"https://hsb786.github.io/temp/åè½¬é“¾è¡¨.html","excerpt":"å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åçš„é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚","text":"å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åçš„é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738 /** * ç»´æŠ¤ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªæŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ * ç¼ºç‚¹ï¼Œéœ€è¦new å¯¹è±¡ï¼Œå ç”¨å†…å­˜ * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ7:44:22 */private static ListNode reverseList(ListNode head) &#123; ListNode result = new ListNode(head.data); ListNode t; while (head.next != null) &#123; t = result; result = new ListNode(head.next.data); result.next = t; head = head.next; &#125; return result;&#125;/** * @Description: éœ€è¦ç»´æŠ¤ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå½“å‰ï¼Œå‰ä¸€ä¸ªï¼Œä¸‹ä¸€ä¸ª * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ7:57:58 */private static ListNode reverseList2(ListNode head) &#123; ListNode result = null; ListNode t = head; ListNode preNode = null; while (t != null) &#123; ListNode nextNode = t.next; if (nextNode == null) &#123; result = t; &#125; t.next = preNode; preNode = t; t = nextNode; &#125; return result;&#125; æˆ–è€…ç›´æ¥ç”¨Stack"},{"title":"åŠ¨æ€è§„åˆ’","date":"2018-04-18T06:39:56.000Z","updated":"2018-04-18T07:17:22.758Z","comments":true,"path":"temp/åŠ¨æ€è§„åˆ’.html","permalink":"https://hsb786.github.io/temp/åŠ¨æ€è§„åˆ’.html","excerpt":"åŠ¨æ€è§„åˆ’(dynamic programming)æ˜¯è¿ç­¹å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ˜¯æ±‚è§£å†³ç­–è¿‡ç¨‹(decision process)æœ€ä¼˜åŒ–çš„æ•°å­¦æ–¹æ³•ã€‚20ä¸–çºª50å¹´ä»£åˆç¾å›½æ•°å­¦å®¶R.E.Bellmanç­‰äººåœ¨ç ”ç©¶å¤šé˜¶æ®µå†³ç­–è¿‡ç¨‹(multistep decision process)çš„ä¼˜åŒ–é—®é¢˜æ—¶ï¼Œæå‡ºäº†è‘—åçš„æœ€ä¼˜åŒ–åŸç†(principle of optimality)ï¼ŒæŠŠå¤šé˜¶æ®µè¿‡ç¨‹è½¬åŒ–ä¸ºä¸€ç³»åˆ—å•é˜¶æ®µé—®é¢˜ï¼Œåˆ©ç”¨å„é˜¶æ®µä¹‹é—´çš„å…³ç³»ï¼Œé€ä¸ªæ±‚è§£ï¼Œåˆ›ç«‹äº†è§£å†³è¿™ç±»è¿‡ç¨‹ä¼˜åŒ–é—®é¢˜çš„æ–°æ–¹æ³•â€”â€”åŠ¨æ€è§„åˆ’ã€‚1957å¹´å‡ºç‰ˆäº†ä»–çš„åè‘—ã€ŠDynamic Programmingã€‹ï¼Œè¿™æ˜¯è¯¥é¢†åŸŸçš„ç¬¬ä¸€æœ¬è‘—ä½œã€‚","text":"åŠ¨æ€è§„åˆ’(dynamic programming)æ˜¯è¿ç­¹å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ˜¯æ±‚è§£å†³ç­–è¿‡ç¨‹(decision process)æœ€ä¼˜åŒ–çš„æ•°å­¦æ–¹æ³•ã€‚20ä¸–çºª50å¹´ä»£åˆç¾å›½æ•°å­¦å®¶R.E.Bellmanç­‰äººåœ¨ç ”ç©¶å¤šé˜¶æ®µå†³ç­–è¿‡ç¨‹(multistep decision process)çš„ä¼˜åŒ–é—®é¢˜æ—¶ï¼Œæå‡ºäº†è‘—åçš„æœ€ä¼˜åŒ–åŸç†(principle of optimality)ï¼ŒæŠŠå¤šé˜¶æ®µè¿‡ç¨‹è½¬åŒ–ä¸ºä¸€ç³»åˆ—å•é˜¶æ®µé—®é¢˜ï¼Œåˆ©ç”¨å„é˜¶æ®µä¹‹é—´çš„å…³ç³»ï¼Œé€ä¸ªæ±‚è§£ï¼Œåˆ›ç«‹äº†è§£å†³è¿™ç±»è¿‡ç¨‹ä¼˜åŒ–é—®é¢˜çš„æ–°æ–¹æ³•â€”â€”åŠ¨æ€è§„åˆ’ã€‚1957å¹´å‡ºç‰ˆäº†ä»–çš„åè‘—ã€ŠDynamic Programmingã€‹ï¼Œè¿™æ˜¯è¯¥é¢†åŸŸçš„ç¬¬ä¸€æœ¬è‘—ä½œã€‚ ä¸‰è¦ç´ ï¼šæœ€ä¼˜å­ç»“æ„ï¼Œè¾¹ç•Œï¼ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ é—®é¢˜ï¼šæœ‰ä¸€ä¸ªå›½å®¶å‘ç°äº†5åº§é‡‘çŸ¿ï¼Œæ¯åº§é‡‘çŸ¿çš„é»„é‡‘å‚¨é‡ä¸åŒï¼Œéœ€è¦å‚ä¸æŒ–æ˜çš„å·¥äººæ•°ä¹Ÿä¸åŒã€‚å‚ä¸æŒ–çŸ¿å·¥äººçš„æ€»æ•°æ˜¯10äººã€‚æ¯åº§é‡‘çŸ¿è¦ä¹ˆå…¨æŒ–ï¼Œè¦ä¹ˆä¸æŒ–ï¼Œä¸èƒ½æ´¾å‡ºä¸€åŠäººæŒ–å–ä¸€åŠé‡‘çŸ¿ã€‚è¦æ±‚ç”¨ç¨‹åºæ±‚è§£å‡ºï¼Œè¦æƒ³å¾—åˆ°å°½å¯èƒ½å¤šçš„é»„é‡‘ï¼Œåº”è¯¥é€‰æ‹©æŒ–å–å“ªå‡ åº§é‡‘çŸ¿ï¼Ÿ å°†é‡‘çŸ¿æ•°é‡è®¾ä¸ºNï¼Œå·¥äººæ•°è®¾ä¸ºWï¼Œé‡‘çŸ¿çš„é»„é‡‘é‡è®¾ä¸ºæ•°ç»„G[]ï¼Œé‡‘çŸ¿çš„ç”¨å·¥é‡è®¾ä¸ºæ•°ç»„P[] æœ€ä¼˜å­ç»“æ„ï¼š é‚£ä¹ˆ5åº§é‡‘çŸ¿å’Œ4åº§é‡‘çŸ¿çš„æœ€ä¼˜é€‰æ‹©ä¹‹é—´å­˜åœ¨è¿™æ ·çš„å…³ç³»ï¼š F(5,10) = MAX ( F(4,10) , F(4,10-P[4])+G[4] ) è¾¹ç•Œï¼šå½“N=1,W&gt;=P[0]æ—¶ï¼ŒF(N,W) = G[0];å½“N=1,W&gt;=P[0]æ—¶ï¼ŒF(N,W) = 0; çŠ¶æ€è½¬ç§»æ–¹ç¨‹: F(n,w) = 0 (n&lt;=1, w&lt;p[0]); F(n,w) = g[0] (n==1, w&gt;=p[0]); F(n,w) = F(n-1,w) (n&gt;1, w&lt;p[n-1]) F(n,w) = max(F(n-1,w), F(n-1,w-p[n-1])+g[n-1]) (n&gt;1, w&gt;=p[n-1]) å‚è€ƒ æ¼«ç”»ï¼šä»€ä¹ˆæ˜¯åŠ¨æ€è§„åˆ’ï¼Ÿï¼ˆæ•´åˆç‰ˆï¼‰"},{"title":"java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰","date":"2018-04-12T07:56:55.000Z","updated":"2018-04-20T13:17:04.928Z","comments":true,"path":"temp/java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰.html","permalink":"https://hsb786.github.io/temp/java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰.html","excerpt":"Java 8å¸¦æ¥äº†å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬Lambda è¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ã€æµ(Stream API)ã€é»˜è®¤æ–¹æ³•ã€Optionalã€ç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹ã€æ–°çš„æ—¶é—´ APIï¼Œç­‰ç­‰å„ä¸ªæ–¹é¢ã€‚","text":"Java 8å¸¦æ¥äº†å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬Lambda è¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ã€æµ(Stream API)ã€é»˜è®¤æ–¹æ³•ã€Optionalã€ç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹ã€æ–°çš„æ—¶é—´ APIï¼Œç­‰ç­‰å„ä¸ªæ–¹é¢ã€‚ Default Methods for InterfacesJava 8 å…è®¸æˆ‘ä»¬ä½¿ç”¨defaultå…³é”®å­—ï¼Œä¸ºæ¥å£å£°æ˜æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•å®ç°ã€‚è¿™ä¸ªç‰¹æ€§åˆè¢«ç§°ä¸ºæ‰©å±•æ–¹æ³•ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼š 1234567interface Formula &#123; double calculate(int a); default double sqrt(int a) &#123; return Math.sqrt(a); &#125;&#125; åœ¨æ¥å£Formulaä¸­ï¼Œé™¤äº†æŠ½è±¡æ–¹æ³•caculateä»¥å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•sqrt.Formulaçš„å®ç°ç±»åªéœ€è¦å®ç°æŠ½è±¡æ–¹æ³•caculateå°±å¯ä»¥äº†ã€‚é»˜è®¤æ–¹æ³•sqrtå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ 123456789Formula formula = new Formula() &#123; @Override public double calculate(int a) &#123; return sqrt(a * 100); &#125;&#125;;formula.calculate(100); // 100.0formula.sqrt(16); // 4.0 é‚£ä¹ˆè¿™ä¸ªæ–°ç‰¹å¾æœ‰å•¥ç”¨å‘¢ï¼Ÿ æˆ‘ä»¬å¾€å¾€ä¼šç¢°åˆ°è¿™æ ·ä¸€ä¸ªæƒ…å†µæˆ‘ä»¬å®šä¹‰çš„æ¥å£æ ¹æ®ä¸åŒçš„åœºæ™¯å®šä¹‰äº†å‡ ä¸ªä¸åŒçš„å®ç°ç±»ï¼Œé‚£ä¹ˆå¦‚æœéœ€è¦è¿™å‡ ä¸ªå®ç°ç±»è°ƒç”¨çš„æ–¹æ³•éƒ½å¾—åˆ°åŒä¸€ä¸ªç»“æœæˆ–è€…åªæœ‰ä¸€ä¸ªå®ç°ç±»éœ€è¦è¿™ä¸ªæ¥å£æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å»é‡å†™æ¯ä¸ªå®ç°äº†è¿™ä¸ªæ¥å£çš„ç±»ï¼Œè€Œè¿™å¤§å¤§å¢åŠ äº†æˆ‘ä»¬çš„å®ç°éœ€æ±‚çš„è´Ÿæ‹…ã€‚ æ­£æ˜¯ä¸ºäº†è§£å†³Javaæ¥å£ä¸­åªèƒ½å®šä¹‰æŠ½è±¡æ–¹æ³•çš„é—®é¢˜ã€‚Java8æ–°å¢åŠ äº†é»˜è®¤æ–¹æ³•çš„ç‰¹æ€§ã€‚é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿æ¥å£é‡å†™æˆæŠ½è±¡æ–¹æ³•æˆ–è€…é‡æ–°å®šä¹‰æˆé»˜è®¤æ–¹æ³•ã€‚é™¤äº†é»˜è®¤æ–¹æ³•ï¼Œæ¥å£é‡Œè¿˜å¯ä»¥å£°æ˜é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥å®ç°ã€‚ä¾‹å­å¦‚ä¸‹ï¼š123456private interface DefaulableFactory &#123; // Interfaces now allow static methods static Defaulable create( Supplier&lt; Defaulable &gt; supplier ) &#123; return supplier.get(); &#125;&#125; Conflictå› ä¸ºä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªç±»å®ç°äº†å¤šä¸ªæ¥å£ï¼Œè€Œè¿™äº›æ¥å£ä¸­å­˜åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šæ–¹æ³•ç­¾åç›¸åŒçš„é»˜è®¤æ–¹æ³•æ—¶å°±ä¼šäº§ç”Ÿå†²çªï¼Œjava8å®šä¹‰å¦‚ä¸‹ä¸‰æ¡åŸåˆ™æ¥è§£å†³å†²çªï¼š ç±»æˆ–çˆ¶ç±»ä¸­æ˜¾å¼å£°æ˜çš„æ–¹æ³•ï¼Œå…¶ä¼˜å…ˆçº§é«˜äºæ‰€æœ‰çš„é»˜è®¤æ–¹æ³•ï¼› å¦‚æœ1è§„åˆ™å¤±æ•ˆï¼Œåˆ™é€‰æ‹©ä¸å½“å‰ç±»è·ç¦»æœ€è¿‘çš„å…·æœ‰å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•ï¼› å¦‚æœ2è§„åˆ™ä¹Ÿå¤±æ•ˆï¼Œåˆ™éœ€è¦æ˜¾å¼æŒ‡å®šæ¥å£ã€‚ Lambda ExpressionsLambdaè¡¨è¾¾å¼ï¼ˆåˆè¢«æˆä¸ºâ€œé—­åŒ…â€æˆ–â€œåŒ¿åæ–¹æ³•â€ï¼‰æ˜¯ç®€æ´åœ°è¡¨ç¤ºå¯ä¼ é€’çš„åŒ¿åå‡½æ•°çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒæä¾›äº†è½»é‡çº§çš„è¯­æ³• é‡ç‚¹ç•™æ„è¿™å››ä¸ªå…³é”®è¯ï¼šåŒ¿åã€å‡½æ•°ã€ä¼ é€’ã€ç®€æ´ Lambdaçš„ä¸‰ä¸ªéƒ¨åˆ†ï¼š å‚æ•°åˆ—è¡¨ ç®­å¤´ Lambda ä¸»ä½“ Lambdaçš„åŸºæœ¬è¯­æ³•å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™æ ·å­çš„äº†ï¼š (parameters) -&gt; expression (parameters) -&gt; { statements; } 1234567Collections.sort(names, (String a, String b) -&gt; &#123; return b.compareTo(a);&#125;);æˆ–è€…æ˜¯Collections.sort(names, (String a, String b) -&gt; b.compareTo(a));äº¦æˆ–æ˜¯Collections.sort(names, (a, b) -&gt; b.compareTo(a)); Lexiacal Scopeè®¿é—®å±€éƒ¨å˜é‡å¯ä»¥ç›´æ¥åœ¨Lambdaè¡¨è¾¾å¼ä¸­è®¿é—®å¤–å±‚çš„å±€éƒ¨å˜é‡ï¼Œä½†æ˜¯å’ŒåŒ¿åå¯¹è±¡ä¸åŒçš„æ˜¯ï¼ŒLambdaè¡¨è¾¾å¼çš„å±€éƒ¨å˜é‡å¯ä»¥ä¸ç”¨å£°æ˜ä¸ºfinalï¼Œä¸è¿‡å±€éƒ¨å˜é‡å¿…é¡»ä¸å¯è¢«åé¢çš„ä»£ç ä¿®æ”¹ï¼ˆå³éšæ€§çš„å…·æœ‰finalçš„è¯­ä¹‰ï¼‰ã€‚ egï¼šä¸‹é¢ä»£ç æ— æ³•ç¼–è¯‘1234int num = 1; Converter&lt;Integer, String&gt; s = (param) -&gt; String.valueOf(param + num); num = 5; åœ¨Lambdaè¡¨è¾¾å¼ä¸­è¯•å›¾ä¿®æ”¹å±€éƒ¨å˜é‡æ˜¯ä¸å…è®¸çš„ï¼ åœ¨ Lambda è¡¨è¾¾å¼å½“ä¸­è¢«å¼•ç”¨çš„å˜é‡çš„å€¼ä¸å¯ä»¥è¢«æ›´æ”¹ã€‚ åœ¨ Lambda è¡¨è¾¾å¼å½“ä¸­ä¸å…è®¸å£°æ˜ä¸€ä¸ªä¸å±€éƒ¨å˜é‡åŒåçš„å‚æ•°æˆ–è€…å±€éƒ¨å˜é‡ã€‚ å’Œå±€éƒ¨å˜é‡ä¸åŒçš„æ˜¯ï¼ŒLambdaå†…éƒ¨å¯¹äºå®ä¾‹çš„å­—æ®µï¼ˆå³ï¼šæˆå‘˜å˜é‡ï¼‰ä»¥åŠé™æ€å˜é‡æ˜¯å³å¯è¯»åˆå¯å†™ã€‚ ä¸èƒ½è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•Lambdaè¡¨è¾¾å¼ä¸­æ˜¯æ— æ³•è®¿é—®åˆ°é»˜è®¤æ–¹æ³•çš„ã€‚ è¡¥å……ï¼šLambdaè¡¨è¾¾å¼å¯¹å€¼å°é—­ï¼Œå¯¹å˜é‡å¼€æ”¾çš„åŸæ–‡æ˜¯ï¼šlambda expressions close over values, not variablesï¼Œåœ¨è¿™é‡Œå¢åŠ ä¸€ä¸ªä¾‹å­ä»¥è¯´æ˜è¿™ä¸ªç‰¹æ€§ï¼š 12345int sum = 0;list.forEach(e -&gt; &#123; sum += e.size(); &#125;); // Illegal, close over valuesList&lt;Integer&gt; aList = new List&lt;&gt;();list.forEach(e -&gt; &#123; aList.add(e); &#125;); // Legal, open over variables åŒ¿åå†…éƒ¨ç±»çš„ç®€å†™ï¼ŸLambdaè¡¨è¾¾å¼é€šè¿‡invokedynamicæŒ‡ä»¤å®ç°ï¼Œä¹¦å†™Lambdaè¡¨è¾¾å¼ä¸ä¼šäº§ç”Ÿæ–°çš„ç±»ã€‚å¦‚æœæœ‰å¦‚ä¸‹ä»£ç ï¼Œç¼–è¯‘ä¹‹ååªæœ‰ä¸€ä¸ªclassæ–‡ä»¶ Lambdaè¡¨è¾¾å¼ä¸­çš„thisæ—¢ç„¶Lambdaè¡¨è¾¾å¼ä¸æ˜¯å†…éƒ¨ç±»çš„ç®€å†™ï¼Œé‚£ä¹ˆLambdaå†…éƒ¨çš„thiså¼•ç”¨ä¹Ÿå°±è·Ÿå†…éƒ¨ç±»å¯¹è±¡æ²¡ä»€ä¹ˆå…³ç³»äº†ã€‚åœ¨Lambdaè¡¨è¾¾å¼ä¸­thisçš„æ„ä¹‰è·Ÿåœ¨è¡¨è¾¾å¼å¤–éƒ¨å®Œå…¨ä¸€æ ·ã€‚ Functional Interfacesä»»æ„åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨æ¥åšæˆLambdaè¡¨è¾¾å¼ã€‚ä¸ºäº†è®©ä½ å®šä¹‰çš„æ¥å£æ»¡è¶³è¦æ±‚ï¼Œä½ åº”å½“åœ¨æ¥å£å‰åŠ ä¸Š@FunctionalInterface æ ‡æ³¨ã€‚ç¼–è¯‘å™¨ä¼šæ³¨æ„åˆ°è¿™ä¸ªæ ‡æ³¨ï¼Œå¦‚æœä½ çš„æ¥å£ä¸­å®šä¹‰äº†ç¬¬äºŒä¸ªæŠ½è±¡æ–¹æ³•çš„è¯ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ 12345678@FunctionalInterfaceinterface Converter&lt;F, T&gt; &#123; T convert(F from);&#125; Converter&lt;String, Integer&gt; converter = (from) -&gt; Integer.valueOf(from);Integer converted = converter.convert(&quot;123&quot;);System.out.println(converted); // 123 æ³¨æ„ï¼Œå¦‚æœä½ ä¸å†™@FunctionalInterface æ ‡æ³¨ï¼Œç¨‹åºä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ ä¸‹é¢æ˜¯Java SE 7ä¸­å·²ç»å­˜åœ¨çš„å‡½æ•°å¼æ¥å£ï¼š java.lang.Runnable java.util.concurrent.Callable java.security.PrivilegedAction java.util.Comparator java.io.FileFilter java.beans.PropertyChangeListener é™¤æ­¤ä¹‹å¤–ï¼ŒJava SE 8ä¸­å¢åŠ äº†ä¸€ä¸ªæ–°çš„åŒ…ï¼šjava.util.functionï¼Œå®ƒé‡Œé¢åŒ…å«äº†å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚ï¼š Predicateâ€”â€”æ¥æ”¶Tå¯¹è±¡å¹¶è¿”å›boolean Consumerâ€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œä¸è¿”å›å€¼ Function&lt;T, R&gt;â€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œè¿”å›Rå¯¹è±¡ Supplierâ€”â€”æä¾›Tå¯¹è±¡ï¼ˆä¾‹å¦‚å·¥å‚ï¼‰ï¼Œä¸æ¥æ”¶å€¼ UnaryOperatorâ€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œè¿”å›Tå¯¹è±¡ BinaryOperatorâ€”â€”æ¥æ”¶ä¸¤ä¸ªTå¯¹è±¡ï¼Œè¿”å›Tå¯¹è±¡ é™¤äº†ä¸Šé¢çš„è¿™äº›åŸºæœ¬çš„å‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€äº›é’ˆå¯¹åŸå§‹ç±»å‹ï¼ˆPrimitive typeï¼‰çš„ç‰¹åŒ–ï¼ˆSpecializationï¼‰å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚IntSupplierå’ŒLongBinaryOperatorã€‚ï¼ˆæˆ‘ä»¬åªä¸ºintã€longå’Œdoubleæä¾›äº†ç‰¹åŒ–å‡½æ•°å¼æ¥å£ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å…¶å®ƒåŸå§‹ç±»å‹åˆ™éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢ï¼‰åŒæ ·çš„æˆ‘ä»¬ä¹Ÿæä¾›äº†ä¸€äº›é’ˆå¯¹å¤šä¸ªå‚æ•°çš„å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚BiFunction&lt;T, U, R&gt;ï¼Œå®ƒæ¥æ”¶Tå¯¹è±¡å’ŒUå¯¹è±¡ï¼Œè¿”å›Rå¯¹è±¡ã€‚ Method and Constructor ReferencesLambdaè¡¨è¾¾å¼å…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œå¹¶å…è®¸æˆ‘ä»¬ä»¥å‡½æ•°å¼æ¥å£çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿåœ¨å·²æœ‰çš„æ–¹æ³•ä¸Šå®ç°åŒæ ·çš„ç‰¹æ€§ã€‚ æ–¹æ³•å¼•ç”¨å’ŒLambdaè¡¨è¾¾å¼æ‹¥æœ‰ç›¸åŒçš„ç‰¹æ€§ï¼ˆä¾‹å¦‚ï¼Œå®ƒä»¬éƒ½éœ€è¦ä¸€ä¸ªç›®æ ‡ç±»å‹ï¼Œå¹¶éœ€è¦è¢«è½¬åŒ–ä¸ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹ï¼‰ï¼Œä¸è¿‡æˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸ºæ–¹æ³•å¼•ç”¨æä¾›æ–¹æ³•ä½“ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ–¹æ³•åç§°å¼•ç”¨å·²æœ‰æ–¹æ³•ã€‚ æ–¹æ³•å¼•ç”¨å°±æ˜¯æ›¿ä»£é‚£äº›è½¬å‘å‚æ•°çš„ Lambda è¡¨è¾¾å¼çš„è¯­æ³•ç³–ã€‚æ–¹æ³•å¼•ç”¨æœ‰å¾ˆå¤šç§ï¼Œå®ƒä»¬çš„è¯­æ³•å¦‚ä¸‹ï¼š é™æ€æ–¹æ³•å¼•ç”¨ï¼šClassName::methodName å®é™…ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šinstanceReference::methodName è¶…ç±»ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šsuper::methodName ç±»å‹ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šClassName::methodName æ„é€ æ–¹æ³•å¼•ç”¨ï¼šClass::new æ•°ç»„æ„é€ æ–¹æ³•å¼•ç”¨ï¼šTypeName[]::new å¯¹äºé™æ€æ–¹æ³•å¼•ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç±»åå’Œæ–¹æ³•åä¹‹é—´åŠ å…¥::åˆ†éš”ç¬¦ï¼Œä¾‹å¦‚Integer::sumã€‚ ç»“åˆLambdaå¯ä»¥ä½¿æˆ‘ä»¬çš„ä»£ç æ›´åŠ ç®€æ´ï¼š 1234List&lt;String&gt; strings = Arrays.asList(&quot;a&quot;, &quot;b&quot;);strings.stream().map(String::toUpperCase).forEach(System.out::println);List&lt;Character&gt; chars = Arrays.asList(&apos;a&apos;, &apos;b&apos;); System.out.println(chars.stream().map(String::valueOf).collect(Collectors.joining(&quot;,&quot;))); OptionalNullPointExceptionå¯ä»¥è¯´æ˜¯æ‰€æœ‰Javaç¨‹åºå‘˜éƒ½é‡åˆ°è¿‡çš„ä¸€ä¸ªå¼‚å¸¸ï¼Œè™½ç„¶Javaä»è®¾è®¡ä¹‹åˆå°±åŠ›å›¾è®©ç¨‹åºå‘˜è„±ç¦»æŒ‡é’ˆçš„è‹¦æµ·ï¼Œä½†æ˜¯æŒ‡é’ˆç¡®å®æ˜¯å®é™…å­˜åœ¨çš„ï¼Œè€Œjavaè®¾è®¡è€…ä¹Ÿåªèƒ½æ˜¯è®©æŒ‡é’ˆåœ¨Javaè¯­è¨€ä¸­å˜å¾—æ›´åŠ ç®€å•ã€æ˜“ç”¨ï¼Œè€Œä¸èƒ½å®Œå…¨çš„å°†å…¶å‰”é™¤ï¼Œæ‰€ä»¥æ‰æœ‰äº†æˆ‘ä»¬æ—¥å¸¸æ‰€è§åˆ°çš„å…³é”®å­—nullã€‚ ç©ºæŒ‡é’ˆå¼‚å¸¸æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯¹äºè¿™ä¸€ç±»å¼‚å¸¸ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„å¤„ç†ç­–ç•¥ï¼Œé‚£ä¹ˆæœ€ä½³å®è·µåœ¨äºè®©ç¨‹åºæ—©ç‚¹æŒ‚æ‰ï¼Œä½†æ˜¯å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œä¸æ˜¯å¼€å‘äººå‘˜æ²¡æœ‰å…·ä½“çš„å¤„ç†ç­–ç•¥ï¼Œè€Œæ˜¯æ ¹æœ¬æ²¡æœ‰æ„è¯†åˆ°ç©ºæŒ‡é’ˆå¼‚å¸¸çš„å­˜åœ¨ã€‚å½“å¼‚å¸¸çœŸçš„å‘ç”Ÿçš„æ—¶å€™ï¼Œå¤„ç†ç­–ç•¥ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨å­˜åœ¨å¼‚å¸¸çš„åœ°æ–¹æ·»åŠ ä¸€ä¸ªifè¯­å¥åˆ¤å®šå³å¯ï¼Œä½†æ˜¯è¿™æ ·çš„åº”å¯¹ç­–ç•¥ä¼šè®©æˆ‘ä»¬çš„ç¨‹åºå‡ºç°è¶Šæ¥è¶Šå¤šçš„nullåˆ¤å®šï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªè‰¯å¥½çš„ç¨‹åºè®¾è®¡ï¼Œåº”è¯¥è®©ä»£ç ä¸­å°½é‡å°‘å‡ºç°nullå…³é”®å­—ï¼Œè€ŒJava8æ‰€æä¾›çš„Optionalç±»åˆ™åœ¨å‡å°‘NullPointExceptionçš„åŒæ—¶ï¼Œä¹Ÿæå‡äº†ä»£ç çš„ç¾è§‚åº¦ã€‚ä½†é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œå®ƒå¹¶ ä¸æ˜¯å¯¹nullå…³é”®å­—çš„ä¸€ç§æ›¿ä»£ï¼Œè€Œæ˜¯å¯¹äºnullåˆ¤å®šæä¾›äº†ä¸€ç§æ›´åŠ ä¼˜é›…çš„å®ç°ï¼Œä»è€Œé¿å…NullPointExceptionã€‚ java.util.Optional å¯¹å¯èƒ½ç¼ºå¤±çš„å€¼å»ºæ¨¡,å¼•å…¥çš„ç›®çš„å¹¶éæ˜¯è¦æ¶ˆé™¤æ¯ä¸€ä¸ª null å¼•ç”¨ï¼Œè€Œæ˜¯å¸®åŠ©ä½ æ›´å¥½åœ°è®¾è®¡å‡ºæ™®é€‚çš„ APIã€‚ åˆ›å»º Optional å¯¹è±¡,ä¸‰ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼š Optional.emptyï¼šåˆ›å»ºç©ºçš„ Optional å¯¹è±¡ Optional.ofï¼šä¾æ®éç©ºå€¼åˆ›å»º Optional å¯¹è±¡ï¼Œè‹¥ä¼ ç©ºå€¼ä¼šæŠ› NPE Optianal.ofNullableï¼šåˆ›å»º Optional å¯¹è±¡ï¼Œå…è®¸ä¼ ç©ºå€¼ Optional APIï¼š isPresent(): å˜é‡å­˜åœ¨è¿”å›true get(): è¿”å›å°è£…çš„å˜é‡å€¼ï¼Œæˆ–è€…æŠ›å‡º NoSuchElementException orElse(T other): æä¾›é»˜è®¤å€¼ orElseGet(Supplier&lt;? extends T&gt; other): orElse æ–¹æ³•çš„å»¶è¿Ÿè°ƒç”¨ç‰ˆ orElseThrow(Supplier&lt;&gt; extends X&gt; exceptionSupplier): ç±»ä¼¼ getï¼Œä½†å¯ä»¥å®šåˆ¶å¸Œæœ›æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ ifPresent(Consumer&lt;? super T&gt;): å˜é‡å­˜åœ¨æ—¶å¯ä»¥æ‰§è¡Œä¸€ä¸ªæ–¹æ³• filter(Predicate&lt;? super T&gt; predicate): è¿‡æ»¤ map(Function&lt;? super T, ? extends U&gt; mapper): è½¬æ¢ flatMap(Function&lt;? super T, Optional&lt;U>>mapper): è½¬æ¢æˆOptional å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šOptionalæ˜¯ä¸€ä¸ªfinalç±»ï¼Œæœªå®ç°ä»»ä½•æ¥å£ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨åˆ©ç”¨è¯¥ç±»åŒ…è£…å®šä¹‰ç±»çš„å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰çš„ç±»æœ‰åºåˆ—åŒ–çš„éœ€æ±‚ï¼Œé‚£ä¹ˆå› ä¸ºOptionalæ²¡æœ‰å®ç°Serializableæ¥å£ï¼Œè¿™ä¸ªæ—¶å€™æ‰§è¡Œåºåˆ—åŒ–æ“ä½œå°±ä¼šæœ‰é—®é¢˜ Optional ç±»è®¾è®¡çš„åˆè¡·ä»…ä»…æ˜¯è¦æ”¯æŒèƒ½è¿”å› Optional å¯¹è±¡çš„æ–¹æ³•ï¼Œæ²¡æœ‰è€ƒè™‘å°†å®ƒä½œä¸ºç±»çš„å­—æ®µä½¿ç”¨â€¦ å¦å¤–ï¼Œåœ¨Java9ä¸­å¯¹Optionalæ·»åŠ äº†ä¸‰ä¸ªæ–°çš„æ–¹æ³•ï¼š public Optional or(Supplier&lt;? extends Optional&lt;? extends T&gt;&gt; supplier)or æ–¹æ³•çš„ä½œç”¨æ˜¯ï¼Œå¦‚æœä¸€ä¸ª Optional åŒ…å«å€¼ï¼Œåˆ™è¿”å›è‡ªå·±ï¼›å¦åˆ™è¿”å›ç”±å‚æ•° supplier è·å¾—çš„ Optional public void ifPresentOrElse(Consumer&lt;? super T&gt; action, Runnable emptyAction)ifPresentOrElse æ–¹æ³•çš„ç”¨é€”æ˜¯ï¼Œå¦‚æœä¸€ä¸ª Optional åŒ…å«å€¼ï¼Œåˆ™å¯¹å…¶åŒ…å«çš„å€¼è°ƒç”¨å‡½æ•° actionï¼Œå³ action.accept(value)ï¼Œè¿™ä¸ ifPresent ä¸€è‡´ï¼›ä¸ ifPresent æ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼ŒifPresentOrElse è¿˜æœ‰ç¬¬äºŒä¸ªå‚æ•° emptyAction â€”â€” å¦‚æœ Optional ä¸åŒ…å«å€¼ï¼Œé‚£ä¹ˆ ifPresentOrElse ä¾¿ä¼šè°ƒç”¨ emptyActionï¼Œå³ emptyAction.run() public Stream stream()stream æ–¹æ³•çš„ä½œç”¨å°±æ˜¯å°† Optional è½¬ä¸ºä¸€ä¸ª Streamï¼Œå¦‚æœè¯¥ Optional ä¸­åŒ…å«å€¼ï¼Œé‚£ä¹ˆå°±è¿”å›åŒ…å«è¿™ä¸ªå€¼çš„ Streamï¼›å¦åˆ™è¿”å›ä¸€ä¸ªç©ºçš„ Streamï¼ˆStream.empty()ï¼‰ ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ Java8ï¼Œæˆ‘ä»¬ä¼šå†™ä¸‹é¢çš„ä»£ç ï¼š 12345678// æ­¤å¤„ getUserById è¿”å›çš„æ˜¯ Optional&lt;User&gt;public List&lt;User&gt; getUsers(Collection&lt;Integer&gt; userIds) &#123; return userIds.stream() .map(this::getUserById) // è·å¾— Stream&lt;Optional&lt;User&gt;&gt; .filter(Optional::isPresent)// å»æ‰ä¸åŒ…å«å€¼çš„ Optional .map(Optional::get) .collect(Collectors.toList());&#125; è€Œæœ‰äº† Optional.stream()ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶ç®€åŒ–ä¸ºï¼š 123456public List&lt;User&gt; getUsers(Collection&lt;Integer&gt; userIds) &#123; return userIds.stream() .map(this::getUserById) // è·å¾— Stream&lt;Optional&lt;User&gt;&gt; .flatMap(Optional::stream) // Stream çš„ flatMap æ–¹æ³•å°†å¤šä¸ªæµåˆæˆä¸€ä¸ªæµ .collect(Collectors.toList());&#125; Streams æµæ˜¯ä»€ä¹ˆ12345Arrays.asList(&quot;a1&quot;, &quot;a2&quot;, &quot;b1&quot;, &quot;c2&quot;, &quot;c1&quot;).stream() .filter(s -&gt; s.startsWith(&quot;c&quot;)) .map(String::toUpperCase) .sorted() .forEach(System.out::println); æµæ˜¯Java SE 8ç±»åº“ä¸­æ–°å¢çš„å…³é”®æŠ½è±¡ï¼Œå®ƒè¢«å®šä¹‰äºjava.util.streamï¼ˆè¿™ä¸ªåŒ…é‡Œæœ‰è‹¥å¹²æµç±»å‹ï¼šStreamä»£è¡¨å¯¹è±¡å¼•ç”¨æµï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ç³»åˆ—ç‰¹åŒ–ï¼ˆspecializationï¼‰æµï¼Œæ¯”å¦‚IntStreamä»£è¡¨æ•´å½¢æ•°å­—æµï¼‰ã€‚æ¯ä¸ªæµä»£è¡¨ä¸€ä¸ªå€¼åºåˆ—ï¼Œæµæä¾›ä¸€ç³»åˆ—å¸¸ç”¨çš„èšé›†æ“ä½œï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä¾¿æ·çš„åœ¨å®ƒä¸Šé¢è¿›è¡Œå„ç§è¿ç®—ã€‚é›†åˆç±»åº“ä¹Ÿæä¾›äº†ä¾¿æ·çš„æ–¹å¼ä½¿æˆ‘ä»¬å¯ä»¥ä»¥æ“ä½œæµçš„æ–¹å¼ä½¿ç”¨é›†åˆã€æ•°ç»„ä»¥åŠå…¶å®ƒæ•°æ®ç»“æ„ã€‚æµçš„æ“ä½œå¯ä»¥è¢«ç»„åˆæˆæµæ°´çº¿ï¼ˆPipelineï¼‰ã€‚ å¼•å…¥çš„åŸå› ï¼š å£°æ˜æ€§æ–¹å¼å¤„ç†æ•°æ®é›†åˆ é€æ˜åœ°å¹¶è¡Œå¤„ç†ï¼Œæé«˜æ€§èƒ½ æµ çš„å®šä¹‰ï¼šä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„å…ƒç´ åºåˆ— ä¸¤ä¸ªé‡è¦ç‰¹ç‚¹ æµæ°´çº¿ å†…éƒ¨è¿­ä»£ æµä¸é›†åˆï¼š é›†åˆä¸æµçš„å·®å¼‚å°±åœ¨äºä»€ä¹ˆæ—¶å€™è¿›è¡Œè®¡ç®— é›†åˆæ˜¯å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼ŒåŒ…å«æ•°æ®ç»“æ„ä¸­ç›®å‰æ‰€æœ‰çš„å€¼ æµçš„å…ƒç´ åˆ™æ˜¯æŒ‰éœ€è®¡ç®—/ç”Ÿæˆ å¦ä¸€ä¸ªå…³é”®åŒºåˆ«åœ¨äºéå†æ•°æ®çš„æ–¹å¼ é›†åˆä½¿ç”¨ Collection æ¥å£ï¼Œéœ€è¦ç”¨æˆ·å»åšè¿­ä»£ï¼Œç§°ä¸ºå¤–éƒ¨è¿­ä»£ æµçš„ Streams åº“ä½¿ç”¨å†…éƒ¨è¿­ä»£ æµçš„ä½¿ç”¨ ä¸€ä¸ªæ•°æ®æºï¼ˆå¦‚é›†åˆï¼‰æ¥æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼› ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼Œå½¢æˆä¸€æ¡æµçš„æµæ°´çº¿ï¼› ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰§è¡Œæµæ°´çº¿ï¼Œå¹¶èƒ½ç”Ÿæˆç»“æœã€‚ æµçš„æµæ°´çº¿èƒŒåçš„ç†å¿µç±»ä¼¼äºæ„å»ºå™¨æ¨¡å¼ã€‚å¸¸è§çš„ä¸­é—´æ“ä½œæœ‰filter,map,limit,sorted,distinctï¼›å¸¸è§çš„ç»ˆç«¯æ“ä½œæœ‰ forEach,count,collectã€‚ æµçš„æ“ä½œç±»å‹åˆ†ä¸ºä¸¤ç§ï¼š Intermediateï¼šä¸€ä¸ªæµå¯ä»¥åé¢è·Ÿéšé›¶ä¸ªæˆ–å¤šä¸ª intermediate æ“ä½œã€‚å…¶ç›®çš„ä¸»è¦æ˜¯æ‰“å¼€æµï¼Œåšå‡ºæŸç§ç¨‹åº¦çš„æ•°æ®æ˜ å°„/è¿‡æ»¤ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„æµï¼Œäº¤ç»™ä¸‹ä¸€ä¸ªæ“ä½œä½¿ç”¨ã€‚è¿™ç±»æ“ä½œéƒ½æ˜¯æƒ°æ€§åŒ–çš„ï¼ˆlazyï¼‰ï¼Œå°±æ˜¯è¯´ï¼Œä»…ä»…è°ƒç”¨åˆ°è¿™ç±»æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰çœŸæ­£å¼€å§‹æµçš„éå†ã€‚ Terminalï¼šä¸€ä¸ªæµåªèƒ½æœ‰ä¸€ä¸ª terminal æ“ä½œï¼Œå½“è¿™ä¸ªæ“ä½œæ‰§è¡Œåï¼Œæµå°±è¢«ä½¿ç”¨â€œå…‰â€äº†ï¼Œæ— æ³•å†è¢«æ“ä½œã€‚æ‰€ä»¥è¿™å¿…å®šæ˜¯æµçš„æœ€åä¸€ä¸ªæ“ä½œã€‚Terminal æ“ä½œçš„æ‰§è¡Œï¼Œæ‰ä¼šçœŸæ­£å¼€å§‹æµçš„éå†ï¼Œå¹¶ä¸”ä¼šç”Ÿæˆä¸€ä¸ªç»“æœï¼Œæˆ–è€…ä¸€ä¸ª side effectã€‚ æµçš„ä½¿ç”¨æ„å»ºæµ ç”±å€¼åˆ›å»ºæµï¼šStream.ofã€Stream.emptyã€IntStream.range ç”±é›†åˆåˆ›å»ºæµï¼šCollection.streamã€Collection.parallelStream ç”±æ•°ç»„åˆ›å»ºæµï¼šArrays.stream(æ•°ç»„å˜é‡) ç”±æ–‡ä»¶ç”Ÿæˆæµï¼šFiles.linesã€Files.walk ç”±BufferedReaderåˆ›å»ºæµï¼šjava.io.BufferedReader.lines ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµï¼Œ è¿­ä»£ï¼š Stream.iterateï¼ˆæ¥å—ä¸€ä¸ªç§å­å€¼ï¼Œå’Œä¸€ä¸ªUnaryOperatorï¼‰ ç”Ÿæˆï¼šStream.generateï¼ˆæ¥æ”¶ä¸€ä¸ªSupplieræ¥å£ï¼‰ ä½¿ç”¨æµIntermediateï¼ˆä¸­é—´æ“ä½œï¼‰ï¼š ç­›é€‰ è°“è¯ç­›é€‰ï¼šfilter ç­›é€‰äº’å¼‚çš„å…ƒç´ ï¼šdistinct å¿½ç•¥å¤´å‡ ä¸ªå…ƒç´ ï¼šskip æˆªçŸ­è‡³æŒ‡å®šé•¿åº¦ï¼šlimit æ’åºï¼šsorted å·ç„ï¼ˆè¾“å‡ºï¼‰ï¼špeek å¹³è¡ŒåŒ–ï¼šparallel ä¸²è¡ŒåŒ–ï¼šsequential æ˜ å°„ å¯¹æµä¸­æ¯ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°ï¼šmap æµçš„æ‰å¹³åŒ–ï¼šflatMap è½¬ä¸ºåŸå§‹æµï¼šmapToIntã€mapToIntã€mapToInt ä»åŸå§‹æµè½¬ä¸ºæ™®é€šæµï¼šboxed æ•°å€¼èŒƒå›´ range:[èµ·å§‹å€¼ï¼Œç»“æŸå€¼) rangeClosed:[èµ·å§‹å€¼ï¼Œç»“æŸå€¼] Terminalï¼ˆç»ˆç»“æ“ä½œï¼‰ æŸ¥æ‰¾å’ŒåŒ¹é… æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ ï¼šanyMatch æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ ï¼šallMatch/noneMatch æŸ¥æ‰¾å…ƒç´ ï¼šfindAny æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼šfindFirst å½’çº¦ï¼ˆæŠ˜å ï¼‰ï¼šreduce(åˆå€¼ï¼Œç»“åˆæ“ä½œ) å…ƒç´ æ±‚å’Œï¼šcountã€sum æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šminã€ max éå† forEachã€ forEachOrdered anyMatch,allMatch,noneMatch éƒ½ç”¨åˆ°äº†çŸ­è·¯ï¼›distinct,sortedæ˜¯æœ‰çŠ¶æ€ä¸”æ— ç•Œçš„ï¼Œskip,limit,reduceæ˜¯æœ‰çŠ¶æ€ä¸”æœ‰ç•Œçš„ã€‚åŸå§‹ç±»å‹æµç‰¹åŒ–ï¼šIntStream,DoubleStream,LongStreamï¼Œé¿å…æš—å«çš„è£…ç®±æˆæœ¬ã€‚ æ˜ å°„åˆ°æ•°å€¼æµï¼šmapToInt,mapToDouble,mapToLong è½¬æ¢å›æµå¯¹è±¡ï¼šboxed é»˜è®¤å€¼ï¼šOptionalInt,OptionalDouble,OptionalLong ç”¨æµæ”¶é›†æ•°æ®å¯¹æµè°ƒç”¨ collect æ–¹æ³•å°†å¯¹æµä¸­çš„å…ƒç´ è§¦å‘å½’çº¦æ“ä½œï¼ˆç”± Collector æ¥å‚æ•°åŒ–ï¼‰ã€‚ Collectors å®ç”¨ç±»æä¾›äº†è®¸å¤šé™æ€å·¥å‚æ–¹æ³•ï¼Œç”¨æ¥åˆ›å»ºå¸¸è§æ”¶é›†å™¨çš„å®ä¾‹ï¼Œä¸»è¦æä¾›ä¸‰å¤§åŠŸèƒ½ï¼š å°†æµå…ƒç´ å½’çº¦å’Œæ±‡æ€»ä¸ºä¸€ä¸ªå€¼ å…ƒç´ åˆ†ç»„ å…ƒç´ åˆ†åŒº å½’çº¦å’Œæ±‡æ€»(Collectors ç±»ä¸­çš„å·¥å‚æ–¹æ³•)ï¼š ç»Ÿè®¡ä¸ªæ•°ï¼šCollectors.counting æŸ¥æ‰¾æµä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šCollectors.maxBy,Collectors.minBy æ±‡æ€»ï¼šCollectors.summingInt,Collectors.averagingInt,summarizingInt/IntSummaryStatisticsã€‚è¿˜æœ‰å¯¹åº”çš„ long å’Œ double ç±»å‹çš„å‡½æ•° è¿æ¥å­—ç¬¦ä¸²ï¼šjoining å¹¿ä¹‰çš„å½’çº¦æ±‡æ€»ï¼šCollectors.reducing(èµ·å§‹å€¼ï¼Œæ˜ å°„æ–¹æ³•ï¼ŒäºŒå…ƒç»“åˆ)/Collectors.reducing(äºŒå…ƒç»“åˆ)ã€‚Collectors.reducing å·¥å‚æ–¹æ³•æ˜¯æ‰€æœ‰ä¸Šè¿°ç‰¹æ®Šæƒ…å†µçš„ä¸€èˆ¬åŒ–ã€‚ collect vs. reduceï¼Œä¸¤è€…éƒ½æ˜¯ Stream æ¥å£çš„æ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äºï¼š è¯­æ„é—®é¢˜ reduce æ–¹æ³•æ—¨åœ¨æŠŠä¸¤ä¸ªå€¼ç»“åˆèµ·æ¥ç”Ÿæˆä¸€ä¸ªæ–°å€¼ï¼Œæ˜¯ä¸å¯å˜çš„å½’çº¦ï¼› collect æ–¹æ³•è®¾è®¡å°±æ˜¯è¦æ”¹å˜å®¹å™¨ï¼Œä»è€Œç´¯ç§¯è¦è¾“å‡ºçš„ç»“æœ å®é™…é—®é¢˜ ä»¥é”™è¯¯çš„è¯­ä¹‰ä½¿ç”¨ reduce ä¼šå¯¼è‡´å½’çº¦è¿‡ç¨‹ä¸èƒ½å¹¶è¡Œå·¥ä½œ åˆ†ç»„å’Œåˆ†åŒº åˆ†ç»„ï¼šCollectors.groupingBy å¤šçº§åˆ†ç»„ æŒ‰å­æ•°ç»„æ”¶é›†æ•°æ®: maxBy æŠŠæ”¶é›†å™¨çš„ç»“æœè½¬æ¢ä¸ºå¦ä¸€ç§ç»“æœ collectingAndThen ä¸ groupingBy è”åˆä½¿ç”¨çš„å…¶ä»–æ”¶é›†å™¨ä¾‹å­ï¼šsummingInt,mapping åˆ†åŒºï¼šCollectors.partitioningByæ˜¯åˆ†ç»„çš„ç‰¹æ®Šæƒ…å†µï¼Œç”±ä¸€ä¸ªè°“è¯ä½œä¸ºåˆ†ç±»å‡½æ•°(åˆ†åŒºå‡½æ•°)ï¼Œè¿”å›ä¸€ä¸ªMapï¼Œåªæœ‰ä¸¤ä¸ªBooleanç±»å‹çš„keyã€‚ Ex1:ä½¿ç”¨collect()ç”ŸæˆCollectionå‰é¢å·²ç»æåˆ°é€šè¿‡collect()æ–¹æ³•å°†Streamè½¬æ¢æˆå®¹å™¨çš„æ–¹æ³•ï¼Œè¿™é‡Œå†æ±‡æ€»ä¸€ä¸‹ã€‚å°†Streamè½¬æ¢æˆListæˆ–Setæ˜¯æ¯”è¾ƒå¸¸è§çš„æ“ä½œï¼Œæ‰€ä»¥Collectorså·¥å…·å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹åº”çš„æ”¶é›†å™¨ï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç å³å¯å®Œæˆï¼š 123456// å°†Streamè½¬æ¢æˆListæˆ–SetStream&lt;String&gt; stream = Stream.of(&quot;I&quot;, &quot;love&quot;, &quot;you&quot;, &quot;too&quot;);List&lt;String&gt; list = stream.collect(Collectors.toList()); // (1)Set&lt;String&gt; set = stream.collect(Collectors.toSet()); // (2)ä¸Šè¿°ä»£ç èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œä½†ç”±äºè¿”å›ç»“æœæ˜¯æ¥å£ç±»å‹ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ç±»åº“å®é™…é€‰æ‹©çš„å®¹å™¨ç±»å‹æ˜¯ä»€ä¹ˆï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½ä¼šæƒ³è¦äººä¸ºæŒ‡å®šå®¹å™¨çš„å®é™…ç±»å‹ï¼Œè¿™ä¸ªéœ€æ±‚å¯é€šè¿‡Collectors.toCollection(Supplier&lt;C&gt; collectionFactory)æ–¹æ³•å®Œæˆã€‚ 123// ä½¿ç”¨toCollection()æŒ‡å®šè§„çº¦å®¹å™¨çš„ç±»å‹ArrayList&lt;String&gt; arrayList = stream.collect(Collectors.toCollection(ArrayList::new));// (3)HashSet&lt;String&gt; hashSet = stream.collect(Collectors.toCollection(HashSet::new));// (4) ä¸Šè¿°ä»£ç (3)å¤„æŒ‡å®šè§„çº¦ç»“æœæ˜¯ArrayListï¼Œè€Œ(4)å¤„æŒ‡å®šè§„çº¦ç»“æœä¸ºHashSetã€‚ä¸€åˆ‡å¦‚ä½ æ‰€æ„¿ã€‚ Ex2:ä½¿ç”¨collect()ç”ŸæˆMapå‰é¢å·²ç»è¯´è¿‡StreamèƒŒåä¾èµ–äºæŸç§æ•°æ®æºï¼Œæ•°æ®æºå¯ä»¥æ˜¯æ•°ç»„ã€å®¹å™¨ç­‰ï¼Œä½†ä¸èƒ½æ˜¯Mapã€‚åè¿‡æ¥ä»Streamç”ŸæˆMapæ˜¯å¯ä»¥çš„ï¼Œä½†æˆ‘ä»¬è¦æƒ³æ¸…æ¥šMapçš„keyå’Œvalueåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼Œæ ¹æœ¬åŸå› æ˜¯æˆ‘ä»¬è¦æƒ³æ¸…æ¥šè¦å¹²ä»€ä¹ˆã€‚é€šå¸¸åœ¨ä¸‰ç§æƒ…å†µä¸‹collect()çš„ç»“æœä¼šæ˜¯Mapï¼š ä½¿ç”¨Collectors.toMap()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šå¦‚ä½•ç”ŸæˆMapçš„keyå’Œvalueã€‚ ä½¿ç”¨Collectors.partitioningBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œå¯¹å…ƒç´ è¿›è¡ŒäºŒåˆ†åŒºæ“ä½œæ—¶ç”¨åˆ°ã€‚ ä½¿ç”¨Collectors.groupingBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œå¯¹å…ƒç´ åšgroupæ“ä½œæ—¶ç”¨åˆ°ã€‚ æƒ…å†µ1ï¼šä½¿ç”¨toMap()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€ç›´æ¥çš„ï¼Œå‰é¢ä¾‹å­ä¸­å·²æåˆ°ï¼Œè¿™æ˜¯å’ŒCollectors.toCollection()å¹¶åˆ—çš„æ–¹æ³•ã€‚å¦‚ä¸‹ä»£ç å±•ç¤ºå°†å­¦ç”Ÿåˆ—è¡¨è½¬æ¢æˆç”±&lt;å­¦ç”Ÿï¼ŒGPA&gt;ç»„æˆçš„Mapã€‚éå¸¸ç›´è§‚ï¼Œæ— éœ€å¤šè¨€ã€‚ 1234// ä½¿ç”¨toMap()ç»Ÿè®¡å­¦ç”ŸGPAMap&lt;Student, Double&gt; studentToGPA = students.stream().collect(Collectors.toMap(Functions.identity(),// å¦‚ä½•ç”Ÿæˆkey student -&gt; computeGPA(student)));// å¦‚ä½•ç”Ÿæˆvalue æƒ…å†µ2ï¼šä½¿ç”¨partitioningBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™ç§æƒ…å†µé€‚ç”¨äºå°†Streamä¸­çš„å…ƒç´ ä¾æ®æŸä¸ªäºŒå€¼é€»è¾‘ï¼ˆæ»¡è¶³æ¡ä»¶ï¼Œæˆ–ä¸æ»¡è¶³ï¼‰åˆ†æˆäº’è¡¥ç›¸äº¤çš„ä¸¤éƒ¨åˆ†ï¼Œæ¯”å¦‚ç”·å¥³æ€§åˆ«ã€æˆç»©åŠæ ¼ä¸å¦ç­‰ã€‚ä¸‹åˆ—ä»£ç å±•ç¤ºå°†å­¦ç”Ÿåˆ†æˆæˆç»©åŠæ ¼æˆ–ä¸åŠæ ¼çš„ä¸¤éƒ¨åˆ†ã€‚ 123// Partition students into passing and failingMap&lt;Boolean, List&lt;Student&gt;&gt; passingFailing = students.stream() .collect(Collectors.partitioningBy(s -&gt; s.getGrade() &gt;= PASS_THRESHOLD)); æƒ…å†µ3ï¼šä½¿ç”¨groupingBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™æ˜¯æ¯”è¾ƒçµæ´»çš„ä¸€ç§æƒ…å†µã€‚è·ŸSQLä¸­çš„group byè¯­å¥ç±»ä¼¼ï¼Œè¿™é‡Œçš„groupingBy()ä¹Ÿæ˜¯æŒ‰ç…§æŸä¸ªå±æ€§å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå±æ€§ç›¸åŒçš„å…ƒç´ ä¼šè¢«å¯¹åº”åˆ°Mapçš„åŒä¸€ä¸ªkeyä¸Šã€‚ä¸‹åˆ—ä»£ç å±•ç¤ºå°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨è¿›è¡Œåˆ†ç»„ï¼š 123// Group employees by departmentMap&lt;Department, List&lt;Employee&gt;&gt; byDept = employees.stream() .collect(Collectors.groupingBy(Employee::getDepartment)); ä»¥ä¸Šåªæ˜¯åˆ†ç»„çš„æœ€åŸºæœ¬ç”¨æ³•ï¼Œæœ‰äº›æ—¶å€™ä»…ä»…åˆ†ç»„æ˜¯ä¸å¤Ÿçš„ã€‚åœ¨SQLä¸­ä½¿ç”¨group byæ˜¯ä¸ºäº†ååŠ©å…¶ä»–æŸ¥è¯¢ï¼Œæ¯”å¦‚1. å…ˆå°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨åˆ†ç»„ï¼Œ2. ç„¶åç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨å‘˜å·¥çš„äººæ•°ã€‚Javaç±»åº“è®¾è®¡è€…ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ç§æƒ…å†µï¼Œå¢å¼ºç‰ˆçš„groupingBy()èƒ½å¤Ÿæ»¡è¶³è¿™ç§éœ€æ±‚ã€‚å¢å¼ºç‰ˆçš„groupingBy()å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ åˆ†ç»„ä¹‹åå†æ‰§è¡ŒæŸç§è¿ç®—ï¼Œæ¯”å¦‚æ±‚å’Œã€è®¡æ•°ã€å¹³å‡å€¼ã€ç±»å‹è½¬æ¢ç­‰ã€‚è¿™ç§å…ˆå°†å…ƒç´ åˆ†ç»„çš„æ”¶é›†å™¨å«åšä¸Šæ¸¸æ”¶é›†å™¨ï¼Œä¹‹åæ‰§è¡Œå…¶ä»–è¿ç®—çš„æ”¶é›†å™¨å«åšä¸‹æ¸¸æ”¶é›†å™¨(downstream Collector)ã€‚ 1234// ä½¿ç”¨ä¸‹æ¸¸æ”¶é›†å™¨ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨çš„äººæ•°Map&lt;Department, Integer&gt; totalByDept = employees.stream() .collect(Collectors.groupingBy(Employee::getDepartment, Collectors.counting()));// ä¸‹æ¸¸æ”¶é›†å™¨ ä¸Šé¢ä»£ç çš„é€»è¾‘æ˜¯ä¸æ˜¯è¶Šçœ‹è¶ŠåƒSQLï¼Ÿé«˜åº¦éç»“æ„åŒ–ã€‚è¿˜æœ‰æ›´ç‹ çš„ï¼Œä¸‹æ¸¸æ”¶é›†å™¨è¿˜å¯ä»¥åŒ…å«æ›´ä¸‹æ¸¸çš„æ”¶é›†å™¨ï¼Œè¿™ç»ä¸æ˜¯ä¸ºäº†ç‚«æŠ€è€Œå¢åŠ çš„æŠŠæˆï¼Œè€Œæ˜¯å®é™…åœºæ™¯éœ€è¦ã€‚è€ƒè™‘å°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨åˆ†ç»„çš„åœºæ™¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¾—åˆ°æ¯ä¸ªå‘˜å·¥çš„åå­—ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸ªEmployeeå¯¹è±¡ï¼Œå¯é€šè¿‡å¦‚ä¸‹æ–¹å¼åšåˆ°ï¼š 12345// æŒ‰ç…§éƒ¨é—¨å¯¹å‘˜å·¥åˆ†å¸ƒç»„ï¼Œå¹¶åªä¿ç•™å‘˜å·¥çš„åå­—Map&lt;Department, List&lt;String&gt;&gt; byDept = employees.stream() .collect(Collectors.groupingBy(Employee::getDepartment, Collectors.mapping(Employee::getName,// ä¸‹æ¸¸æ”¶é›†å™¨ Collectors.toList())));// æ›´ä¸‹æ¸¸çš„æ”¶é›†å™¨ Notice And Optimization æµä¸å¯è¢«å¤ç”¨ ä¸€èˆ¬å…ˆfilterã€limitã€skipæ“ä½œåå†è¿›è¡Œsortedã€peekã€mapç­‰æ“ä½œä»¥è¾¾åˆ°short-circuiting ç›®çš„ Streamæ“ä½œåˆ†ç±» æ–¹æ³• ä¸­é—´æ“ä½œ(Intermediate operations) æ— çŠ¶æ€(Stateless) unordered() filter() map() mapToInt() mapToLong() mapToDouble() flatMap() flatMapToInt() flatMapToLong() flatMapToDouble() peek() æœ‰çŠ¶æ€(Stateful) distinct() sorted() sorted() limit() skip() ç»“æŸæ“ä½œ(Terminal operations) éçŸ­è·¯æ“ä½œ forEach() forEachOrdered() toArray() reduce() collect() max() min() count() çŸ­è·¯æ“ä½œ(short-circuiting) anyMatch() allMatch() noneMatch() findFirst() findAny() Streamä¸Šçš„æ‰€æœ‰æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»“æŸæ“ä½œï¼Œä¸­é—´æ“ä½œåªæ˜¯ä¸€ç§æ ‡è®°ï¼Œåªæœ‰ç»“æŸæ“ä½œæ‰ä¼šè§¦å‘å®é™…è®¡ç®—ã€‚ä¸­é—´æ“ä½œåˆå¯ä»¥åˆ†ä¸ºæ— çŠ¶æ€çš„(Stateless)å’Œæœ‰çŠ¶æ€çš„(Stateful)ï¼Œæ— çŠ¶æ€ä¸­é—´æ“ä½œæ˜¯æŒ‡å…ƒç´ çš„å¤„ç†ä¸å—å‰é¢å…ƒç´ çš„å½±å“ï¼Œè€Œæœ‰çŠ¶æ€çš„ä¸­é—´æ“ä½œå¿…é¡»ç­‰åˆ°æ‰€æœ‰å…ƒç´ å¤„ç†ä¹‹åæ‰çŸ¥é“æœ€ç»ˆç»“æœï¼Œæ¯”å¦‚æ’åºæ˜¯æœ‰çŠ¶æ€æ“ä½œï¼Œåœ¨è¯»å–æ‰€æœ‰å…ƒç´ ä¹‹å‰å¹¶ä¸èƒ½ç¡®å®šæ’åºç»“æœï¼›ç»“æŸæ“ä½œåˆå¯ä»¥åˆ†ä¸ºçŸ­è·¯æ“ä½œå’ŒéçŸ­è·¯æ“ä½œï¼ŒçŸ­è·¯æ“ä½œæ˜¯æŒ‡ä¸ç”¨å¤„ç†å…¨éƒ¨å…ƒç´ å°±å¯ä»¥è¿”å›ç»“æœï¼Œæ¯”å¦‚æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚ä¹‹æ‰€ä»¥è¦è¿›è¡Œå¦‚æ­¤ç²¾ç»†çš„åˆ’åˆ†ï¼Œæ˜¯å› ä¸ºåº•å±‚å¯¹æ¯ä¸€ç§æƒ…å†µçš„å¤„ç†æ–¹å¼ä¸åŒã€‚ Java8 å¯¹å­—ç¬¦ä¸²è¿æ¥çš„æ”¹è¿›æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸€ç§éœ€æ±‚å°±æ˜¯å°†è‹¥å¹²ä¸ªå­—ç¬¦ä¸²ç”¨æŸä¸ªé“¾æ¥ç¬¦è¡”æ¥èµ·æ¥ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ª Listï¼Œå°†å…¶æ ¼å¼åŒ–ä¸º å…ƒç´ 1, å…ƒç´ 2, å…ƒç´ 3, â€¦ å…ƒç´ N çš„å­—ç¬¦ä¸²å½¢å¼ã€‚ ä»¥å‰æˆ‘ä»¬çš„ä¸€èˆ¬åšæ³•å°±æ˜¯ä½¿ç”¨StringBuilderï¼š 1234567891011121314151617181920212223public static String formatList(List&lt;String&gt; list, String delimiter) &#123; StringBuilder result = new StringBuilder(); for (String str : list) &#123; result.append(str).append(delimiter); &#125; // åˆ é™¤æœ«å°¾å¤šä½™çš„ delimiter result.delete(result.length() - delimiter.length(), result.length()); return result.toString();&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ StringBuilderï¼š&quot;); String format = formatList(list, &quot;,&quot;); System.out.println(format);&#125;//è¿è¡Œç»“æœä½¿ç”¨ StringBuilderï¼ša,b,c,d,e,f,g JDK1.8 æ—¶ï¼Œæ·»åŠ äº†ä¸€ä¸ªæ–°çš„ç”¨äºå­—ç¬¦ä¸²è¿æ¥çš„ç±»ï¼Œä¸“é—¨ç”¨äºè¿™ç§éœ€è¦ åˆ†éš”ç¬¦ çš„åœºåˆï¼Œå®ƒå°±æ˜¯ StringJoinerã€‚StringJoiner åœ¨æ„é€ æ—¶å¯ä»¥æŒ‡å®šä¸€ä¸ªåˆ†éš”ç¬¦ï¼ˆdelimiterï¼‰ï¼Œç„¶åæ¯è¿æ¥ä¸€ä¸ªå…ƒç´ å®ƒä¾¿ä¼šåŠ ä¸Šä¸€ä¸ª delimiterï¼Œä½¿ç”¨ StringJoiner æ”¹å†™ formatListï¼š 123456789101112131415public static String formatList(List&lt;String&gt; list, String delimiter) &#123; StringJoiner result = new StringJoiner(delimiter); for (String str : list) &#123; result.add(str); &#125; return result.toString();&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ StringJoinerï¼š&quot;); String format = formatList(list, &quot;,&quot;); System.out.println(format);&#125; æˆ–è€…ä½¿ç”¨String.join: 123public static String formatList(List&lt;String&gt; list, String delimiter) &#123; return String.join(delimiter, list);&#125; String.join æ–¹æ³•çš„ä¸è¶³ â€”â€” å®ƒä¸èƒ½æŒ‡å®šå‰ç¼€å’Œåç¼€ â€”â€” æ¯”å¦‚æˆ‘ä»¬å¦‚æœæƒ³è¦ç›´æ¥å°† List æ ¼å¼åŒ–ä¸º { å…ƒç´ 1, å…ƒç´ 2, å…ƒç´ 3, â€¦ å…ƒç´ N } å‘¢ï¼Ÿï¼ˆæ­¤æ—¶å‰ç¼€ä¸º â€œ{ â€œï¼Œåç¼€ä¸º â€œ }â€ï¼‰ 1234567891011121314151617public static String formatList( List&lt;String&gt; list, String delimiter, String prefix, String suffix) &#123; StringJoiner result = new StringJoiner(delimiter, prefix, suffix); for (String str : list) &#123; result.add(str); &#125; return result.toString();&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ StringJoinerï¼Œå¸¦å‰ç¼€å’Œåç¼€ï¼š&quot;); String format = formatList(list, &quot;, &quot;, &quot;&#123; &quot;, &quot; &#125;&quot;); System.out.println(format);&#125; äº‹å®ä¸Šï¼ŒJava8 å¯¹äºå­—ç¬¦ä¸²é›†åˆçš„è¿æ¥æ“ä½œæä¾›äº†ä¸€ä¸ªä¸“é—¨çš„æµå¼ APIï¼Œå³ Collectors.joining å‡½æ•° æ— å‚çš„ joining() æ–¹æ³•ï¼Œå³ä¸å­˜åœ¨è¿æ¥ç¬¦ï¼ˆåº•å±‚å®ç°ä¸º StringBuilderï¼‰ï¼› joining(CharSequence delimiter) æ–¹æ³•ï¼Œå³åˆ†éš”ç¬¦ä¸º delimiterï¼ˆåº•å±‚å®ç°ä¸º StringJoinerï¼‰ï¼› joining(CharSequence delimiter, CharSequence prefix, CharSequence suffix)æ–¹æ³•ï¼Œå³åˆ†éš”ç¬¦ä¸º delimiterï¼Œå‰ç¼€ä¸º prefixï¼Œåç¼€ä¸º suffixï¼ˆåº•å±‚å®ç°ä¸º StringJoinerï¼‰ã€‚ é‚£æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸‰ä¸ªå‚æ•°çš„ Collectors.joining æ–¹æ³•æ”¹å†™ formatListï¼š 12345678910111213public static String formatList( List&lt;String&gt; list, String delimiter, String prefix, String suffix) &#123; return list.stream().collect(Collectors.joining(delimiter, prefix, suffix));&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ Collectors.joiningï¼š&quot;); String format = formatList(list, &quot;, &quot;, &quot;&#123; &quot;, &quot; &#125;&quot;); System.out.println(format);&#125; Java8 ä¸­ Map æ¥å£çš„æ–°æ–¹æ³•å‡å¦‚ç°åœ¨æˆ‘ä»¬å­˜åœ¨è¿™æ ·çš„éœ€æ±‚ï¼šç»™å®šä¸€ä¸ª Listï¼Œç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ‰€æœ‰ä½ç½®ã€‚ æ¯”å¦‚ï¼Œç»™å®š listï¼š[â€œaâ€, â€œbâ€, â€œbâ€, â€œcâ€, â€œcâ€, â€œcâ€, â€œdâ€, â€œdâ€, â€œdâ€, â€œfâ€, â€œfâ€, â€œgâ€] ï¼Œé‚£ä¹ˆåº”è¯¥è¿”å›ï¼š123456a : [0]b : [1, 2]c : [3, 4, 5]d : [6, 7, 8]f : [9, 10]g : [11] å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬å¾ˆé€‚åˆä½¿ç”¨ Map æ¥å®Œæˆè¿™ä»¶äº‹æƒ…ï¼š 12345678910111213141516171819202122232425public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; list.size(); i++) &#123; String str = list.get(i); List&lt;Integer&gt; positions = positionsMap.get(str); if (positions == null) &#123; // å¦‚æœ positionsMap è¿˜ä¸å­˜åœ¨ str è¿™ä¸ªé”®åŠå…¶å¯¹åº”çš„ List&lt;Integer&gt; positions = new ArrayList&lt;&gt;(1); positionsMap.put(str, positions); // å°† str åŠå…¶å¯¹åº”çš„ positions æ”¾å…¥ positionsMap &#125; positions.add(i); // å°†ç´¢å¼•åŠ å…¥ str ç›¸å…³è”çš„ List&lt;Integer&gt; ä¸­ &#125; return positionsMap;&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;f&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ Java8 ä¹‹å‰çš„ APIï¼š&quot;); Map&lt;String, List&lt;Integer&gt;&gt; elementPositions = getElementPositions(list); System.out.println(elementPositions);&#125; è¿è¡Œç»“æœ 12ä½¿ç”¨ Java8 ä¹‹å‰çš„ APIï¼š&#123;a=[0], b=[1, 2], c=[3, 4, 5], d=[6, 7, 8], f=[9, 10], g=[11]&#125; computeIfAbsent1234567891011121314151617public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; list.size(); i++) &#123; positionsMap.computeIfAbsent(list.get(i), k -&gt; new ArrayList&lt;&gt;(1)).add(i); &#125; return positionsMap;&#125;public static void main(String[] args) throws Exception &#123; List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;f&quot;, &quot;f&quot;, &quot;g&quot;); System.out.println(&quot;ä½¿ç”¨ computeIfAbsentï¼š&quot;); Map&lt;String, List&lt;Integer&gt;&gt; elementPositions = getElementPositions(list); System.out.println(elementPositions);&#125; å½“ forEach éœ€è¦ç´¢å¼•1234567public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; list.size(); i++) &#123; positionsMap.computeIfAbsent(list.get(i), k -&gt; new ArrayList&lt;&gt;(1)).add(i); &#125; return positionsMap;&#125; ä½†æ˜¯æ–¹æ³•é‡Œé¢çš„forå¾ªç¯ä¼¼ä¹è®©è¿™ä¸ªæ–¹æ³•ä¸å¤ªä¼˜é›…äº†ï¼ŒJava8ä¸­Iterableæä¾›çš„foreachå¹¶ä¸å¸¦ç´¢å¼•çš„ï¼š æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªï¼š 1234567891011public static &lt;E&gt; void forEach( Iterable&lt;? extends E&gt; elements, BiConsumer&lt;Integer, ? super E&gt; action) &#123; Objects.requireNonNull(elements); Objects.requireNonNull(action); int index = 0; for (E element : elements) &#123; action.accept(index++, element); &#125; &#125;&#125; ç„¶åæ”¹é€ getElementPositionsæ–¹æ³•ï¼š 123456789public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123; Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;(); Iterables.forEach(list, (index, str) -&gt; &#123; positionsMap.computeIfAbsent(str, k -&gt; new ArrayList&lt;&gt;(1)).add(index); &#125;); return positionsMap;&#125; å‚è€ƒ Java8 Noob Tutorial"},{"title":"æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—","date":"2018-04-10T08:11:33.000Z","updated":"2018-04-20T13:23:05.149Z","comments":true,"path":"temp/æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—.html","permalink":"https://hsb786.github.io/temp/æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—.html","excerpt":"æŠŠä¸€ä¸ªæ•°ç»„æœ€å¼€å§‹çš„è‹¥å¹²ä¸ªå…ƒç´ æ¬åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ•°ç»„çš„æ—‹è½¬ã€‚è¾“å…¥ä¸€ä¸ªé€’å¢æ’åºæ•°ç»„çš„ä¸€ä¸ªæ—‹è½¬ï¼Œè¾“å‡ºæ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´ ã€‚","text":"æŠŠä¸€ä¸ªæ•°ç»„æœ€å¼€å§‹çš„è‹¥å¹²ä¸ªå…ƒç´ æ¬åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ•°ç»„çš„æ—‹è½¬ã€‚è¾“å…¥ä¸€ä¸ªé€’å¢æ’åºæ•°ç»„çš„ä¸€ä¸ªæ—‹è½¬ï¼Œè¾“å‡ºæ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´ ã€‚æ—‹è½¬æ•°ç»„çš„ç‰¹ç‚¹ï¼š æ—‹è½¬ä¹‹åçš„æ•°ç»„å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªæ’åºçš„å­æ•°ç»„ï¼Œä¸”å‰é¢çš„å­æ•°ç»„çš„å…ƒç´ éƒ½å¤§äºæˆ–ç­‰äºåé¢å­æ•°ç»„çš„å…ƒç´ ã€‚ æœ€å°æˆ–è€…æœ€å¤§å…ƒç´ ä½äºä¸¤ä¸ªå­æ•°ç»„çš„åˆ†ç•Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657/** * ç”±äºæ—‹è½¬æ•°ç»„çš„ç‰¹ç‚¹ï¼Œå‰ä¸€ä¸ªæ•°ç»„ä¸€å®šå¤§äºåä¸€ä¸ªæ•°ç»„ã€‚æ•°ç»„å†…éƒ¨æ˜¯å‡åºçš„ã€‚ * æ‰€ä»¥å°±å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚ * å®šä¹‰minIndexä¸º0ï¼ŒhighIndexä¸ºlength-1 * è‹¥ä¸­é—´ä½å¤§äºarray[minIndex]ï¼Œåˆ™ä»£è¡¨ä¸­é—´ä½å¤„äºå‰é¢éƒ¨åˆ†,å°†minIndexè®¾ä¸ºmidIndexï¼› * å°äºåˆ™å¤„äºåé¢éƒ¨åˆ†,å°†highIndexè®¾ä¸ºmidIndex * æœ€ç»ˆminIndexä½äºå‰ä¸€ä¸ªæ•°ç»„çš„æœ€åä¸€ä½ï¼ŒhighIndexä½äºåä¸€ä¸ªæ•°ç»„çš„ç¬¬ä¸€ä½ * æ˜¾ç„¶æœ€å°å€¼å°±æ˜¯highIndexæ‰€åœ¨çš„å€¼ã€‚ * ç‰¹æ®Šæƒ…å†µï¼Œä½†minIndexä¸highIndexä¸Šçš„å€¼ç›¸ç­‰æ—¶ï¼Œæ— æ³•åˆ¤æ–­ä¸­é—´å€¼æ˜¯åœ¨å‰ï¼Œè¿˜æ˜¯åœ¨åã€‚ * æ‰€ä»¥åªèƒ½ç”¨é¡ºåºæŸ¥æ‰¾ * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ2:56:26 */public static int findMin(int[] array) &#123; int lowIndex = 0; int highIndex = array.length - 1; int midIndex = (lowIndex + highIndex) / 2; // å½“ä»£æŸ¥æ‰¾æ•°ç»„ç¬¬ä¸€ä½å¤§äºæœ€åä¸€ä½æ—¶ï¼Œä»£è¡¨æ˜¯æ—‹è½¬æ•°ç»„ while (array[lowIndex] &gt;= array[highIndex]) &#123; // ä¸´ç•Œæ¡ä»¶ å‰é¢æœ€åä¸€ä½ï¼Œåé¢ç¬¬ä¸€ä½ã€‚ åé¢ç¬¬ä¸€ä½å°±æ˜¯æœ€å°å€¼ if (highIndex - lowIndex == 1) &#123; return array[highIndex]; &#125; // å½“å·¦ä¸‹æ ‡çš„å…ƒç´ ç­‰äºå³ä¸‹æ ‡çš„å…ƒç´ æ—¶ï¼Œæ— æ³•åˆ¤æ–­ä¸­é—´ä½æ˜¯ä½äºå‰é¢è¿˜æ˜¯åé¢çš„ã€‚ // åªèƒ½ç”¨é¡ºåºæŸ¥æ‰¾ if (array[lowIndex] == array[highIndex]) &#123; return findMinInOrder(array, lowIndex, highIndex); &#125; // å½“ä¸­é—´ä½å¤§äºå‰é¢ç¬¬ä¸€ä½æ—¶ï¼Œä»£è¡¨å¤„äºå‰é¢ if (array[midIndex] &gt; array[lowIndex]) &#123; lowIndex = midIndex; &#125; else &#123; // å¦åˆ™å¤„äºåé¢ highIndex = midIndex; &#125; // è®¡ç®—ä¸­é—´ä½ midIndex = (lowIndex + highIndex) / 2; &#125; //å·²æ’å¥½åºï¼Œè¿”å›ä½ä½å³å¯ return array[lowIndex];&#125;/** * @Description: å½“æœ‰é‡å¤å…ƒç´ çš„æ—¶å€™ï¼Œæ— æ³•ç¡®å®šä¸­é—´çš„å…ƒç´ æ˜¯å‰é¢çš„è¿˜æ˜¯åé¢çš„ * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ2:33:52 */private static int findMinInOrder(int[] array, int lowIndex, int highIndex) &#123; int result = array[lowIndex]; for (int i = lowIndex + 1; i &lt;= highIndex; i++) &#123; if (result &gt; array[i]) &#123; result = array[i]; &#125; &#125; return result;&#125;"},{"title":"åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨","date":"2018-04-12T07:29:59.000Z","updated":"2018-04-20T13:21:40.349Z","comments":true,"path":"temp/åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨.html","permalink":"https://hsb786.github.io/temp/åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨.html","excerpt":"è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹äººæ˜¯æŒ‰ç…§é€’å¢æ’åºçš„ã€‚","text":"è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹äººæ˜¯æŒ‰ç…§é€’å¢æ’åºçš„ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public static ListNode merge(ListNode list1, ListNode list2) &#123; if (list1 == null) &#123; return list2; &#125; if (list2 == null) &#123; return list1; &#125; if (list1.data &lt; list2.data) &#123; list1.next = merge(list1.next, list2); return list1; &#125; else &#123; list2.next = merge(list1, list2.next); return list2; &#125;&#125;public static ListNode mergeSortedList(ListNode list1, ListNode list2) &#123; if (list1 == null) &#123; return list2; &#125; if (list2 == null) &#123; return list1; &#125; ListNode mergeHead = null; ListNode current = null; if (list1.data &lt;= list2.data) &#123; mergeHead = current = list1; list1 = list1.next; &#125; else &#123; mergeHead = current = list2; list2 = list2.next; &#125; while (list1 != null &amp;&amp; list2 != null) &#123; if (list1.data &lt;= list2.data) &#123; current.next = list1; current = current.next; list1 = list1.next; &#125; else &#123; current.next = list2; current = current.next; list2 = list2.next; &#125; &#125; if (list1 == null) &#123; current.next = list2; &#125; else &#123; current.next = list1; &#125; return mergeHead;&#125;"},{"title":"ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—","date":"2018-04-10T08:10:52.000Z","updated":"2018-04-20T13:23:35.986Z","comments":true,"path":"temp/ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html","permalink":"https://hsb786.github.io/temp/ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html","excerpt":"ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼šè¯·å®ç°ä»–çš„ä¸¤ä¸ªå‡½æ•°appendTailå’ŒdeleteHead,åˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥èŠ‚ç‚¹å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤èŠ‚ç‚¹çš„åŠŸèƒ½ã€‚","text":"ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼šè¯·å®ç°ä»–çš„ä¸¤ä¸ªå‡½æ•°appendTailå’ŒdeleteHead,åˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥èŠ‚ç‚¹å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤èŠ‚ç‚¹çš„åŠŸèƒ½ã€‚1234567891011121314151617181920212223242526272829private static Stack&lt;Object&gt; stack1 = new Stack&lt;Object&gt;();private static Stack&lt;Object&gt; stack2 = new Stack&lt;Object&gt;();/** * stack1ç”¨æ¥å­˜æ”¾å‹å…¥çš„å…ƒç´  * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ1:19:07 */public static void appendTail(Object item) &#123; stack1.push(item);&#125;public static void deleteHead() &#123; //å½“stack2ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥å¼¹å‡º if (!stack2.isEmpty()) &#123; System.out.println(&quot;æ ˆé¡¶:&quot; + stack2.pop()); return; &#125; else &#123; //stack2å‹å…¥stack1å¼¹å‡ºçš„æ•°æ®,è¿™æ ·stack2å°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ— while (!stack1.isEmpty()) &#123; stack2.push(stack1.pop()); &#125; &#125; if (!stack2.isEmpty()) &#123; System.out.println(&quot;æ ˆé¡¶:&quot; + stack2.pop()); &#125; else &#123; System.out.println(&quot;æ ˆä¸­æ²¡æœ‰å…ƒç´ &quot;); &#125;&#125;"},{"title":"æ ‡ç­¾","date":"2018-04-20T13:36:26.660Z","updated":"2018-04-20T13:36:26.660Z","comments":true,"path":"tags/index.html","permalink":"https://hsb786.github.io/tags/index.html","excerpt":"","text":""},{"title":"ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ","date":"2018-04-10T08:11:19.000Z","updated":"2018-04-20T13:23:29.908Z","comments":true,"path":"temp/ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ.html","permalink":"https://hsb786.github.io/temp/ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ.html","excerpt":"ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ","text":"ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ123456789101112131415161718192021222324252627282930313233343536373839404142/** * Queueæ–¹æ³•: * offer() æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›false * pool() ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼Œæ— åˆ™è¿”å›null * peek() è¿”å›å¤´éƒ¨å…ƒç´  æ— åˆ™è¿”å›null */private static Queue&lt;Object&gt; queue1 = new LinkedList&lt;&gt;();private static Queue&lt;Object&gt; queue2 = new LinkedList&lt;&gt;();private static void push(Object obj) &#123; if (!queue1.isEmpty()) &#123; queue1.offer(obj); &#125; else &#123; queue2.offer(obj); &#125; System.out.println(&quot;å…¥æ ˆ:&quot; + obj);&#125;/** * å°†ä¸€ä¸ªé˜Ÿåˆ—é‡Œçš„æ•°æ®éƒ½å‰ªåˆ‡ç»™å¦ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œåªä¿ç•™æœ€åä¸€ä½ã€‚ * è¿™æ ·å¼¹å‡ºçš„æ•°æ®å°±æ˜¯æ ˆå°¾æ•°æ® * @author: husb * @date: 2018å¹´4æœˆ10æ—¥ ä¸‹åˆ1:55:11 */private static void pop() &#123; if (queue1.isEmpty() &amp;&amp; queue2.isEmpty()) &#123; System.out.println(&quot;æ ˆé‡Œæ²¡æœ‰æ•°æ®&quot;); return; &#125; if (queue1.isEmpty()) &#123; while (queue2.size() &gt; 1) &#123; queue1.offer(queue2.poll()); &#125; System.out.println(&quot;å‡ºæ ˆ:&quot; + queue2.poll()); return; &#125; while (queue1.size() &gt; 1) &#123; queue2.offer(queue1.poll()); &#125; System.out.println(&quot;å‡ºæ ˆ:&quot; + queue1.poll());&#125;"},{"title":"è®¡ç®—æœºä¸æ“ä½œç³»ç»Ÿ","date":"2018-04-27T10:48:58.000Z","updated":"2018-04-27T11:31:22.341Z","comments":true,"path":"temp/è®¡ç®—æœºä¸æ“ä½œç³»ç»Ÿ.html","permalink":"https://hsb786.github.io/temp/è®¡ç®—æœºä¸æ“ä½œç³»ç»Ÿ.html","excerpt":"","text":"The wheel turns, nothing is ever new. æ—¶è¿‡å¢ƒè¿,çƒ‚äº‹ä¾ç„¶ã€‚æœ€è¿‘çš„çŠ¶æ€ğŸ˜¥ï¼Œå‘ç°è¦å­¦çš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šï¼Œä»¥å‰å­¦è¿‡çš„åŸºæœ¬ä¸Šä¹Ÿå¿˜çš„å·®ä¸å¤šäº†ã€‚ å››ä¸ªç‰¹æ€§ å¹¶å‘ï¼šåŒä¸€æ®µæ—¶é—´å†…å¤šä¸ªçº¿ç¨‹æ‰§è¡Œ å…±äº«ï¼šç³»ç»Ÿä¸­çš„èµ„æºå¯ä»¥è¢«å†…å­˜ä¸­å¤šä¸ªå¹¶å‘æ‰§è¡Œçš„çº¿ç¨‹å…±åŒä½¿ç”¨ è™šæ‹Ÿï¼šé€šè¿‡æ—¶åˆ†å¤ç”¨ï¼ˆå¦‚åˆ†æ—¶ç³»ç»Ÿï¼‰ä»¥åŠç©ºåˆ†å¤ç”¨ï¼ˆå¦‚è™šæ‹Ÿå†…å­˜ï¼‰æŠ€æœ¯å®ç°æŠŠä¸€ä¸ªç‰©ç†å®ä½“è™šæ‹Ÿä¸ºå¤šä¸ª å¼‚æ­¥ï¼šç³»ç»Ÿä¸­çš„è¿›ç¨‹æ˜¯ä»¥èµ°èµ°åœåœçš„æ–¹å¼æ‰§è¡Œçš„ï¼Œä¸”ä»¥ä¸€ç§ä¸å¯é¢„çŸ¥çš„é€Ÿåº¦æ¨è¿› è¿›ç¨‹ä¸çº¿ç¨‹ è¿›ç¨‹processï¼šç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œ çº¿ç¨‹threadï¼šCPUçš„åŸºæœ¬è°ƒåº¦å•ä½ å…¨ä¸–ç•Œå‡ åäº¿å°ç”µè„‘ï¼Œè¿æ¥åœ¨ä¸€èµ·ï¼Œä¸¤ä¸¤é€šä¿¡ã€‚ä¸Šæµ·çš„æŸä¸€å—ç½‘å¡é€å‡ºä¿¡å·ï¼Œæ´›æ‰çŸ¶çš„å¦ä¸€å—ç½‘å¡å±…ç„¶å°±æ”¶åˆ°äº†ï¼Œä¸¤è€…å®é™…ä¸Šæ ¹æœ¬ä¸çŸ¥é“å¯¹æ–¹çš„ç‰©ç†ä½ç½®ï¼Œä½ ä¸è§‰å¾—è¿™æ˜¯å¾ˆç¥å¥‡çš„äº‹æƒ…å—ï¼Ÿ äº’è”ç½‘çš„æ ¸å¿ƒæ˜¯ä¸€ç³»åˆ—åè®®ï¼Œæ€»ç§°ä¸ºâ€œäº’è”ç½‘åè®®â€ï¼ˆInternet Protocol Suiteï¼‰ã€‚å®ƒä»¬å¯¹ç”µè„‘å¦‚ä½•è¿æ¥å’Œç»„ç½‘ï¼Œåšå‡ºäº†è¯¦å°½çš„è§„å®šã€‚ç†è§£äº†è¿™äº›åè®®ï¼Œå°±ç†è§£äº†äº’è”ç½‘çš„åŸç†ã€‚ äº”å±‚æ¨¡å‹äº’è”ç½‘çš„å®ç°ï¼Œåˆ†æˆå¥½å‡ å±‚ã€‚æ¯ä¸€å±‚éƒ½æœ‰è‡ªå·±çš„åŠŸèƒ½ï¼Œå°±åƒå»ºç­‘ç‰©ä¸€æ ·ï¼Œæ¯ä¸€å±‚éƒ½é ä¸‹ä¸€å±‚æ”¯æŒã€‚ å¦‚ä½•åˆ†å±‚æœ‰ä¸åŒçš„æ¨¡å‹ï¼Œæœ‰çš„æ¨¡å‹åˆ†ä¸ƒå±‚ï¼Œæœ‰çš„åˆ†å››å±‚ã€‚ å®ä½“å±‚ç”µè„‘è¦ç»„ç½‘ï¼Œç¬¬ä¸€ä»¶äº‹è¦å¹²ä»€ä¹ˆï¼Ÿå½“ç„¶æ˜¯å…ˆæŠŠç”µè„‘è¿èµ·æ¥ï¼Œå¯ä»¥ç”¨å…‰ç¼†ã€ç”µç¼†ã€åŒç»çº¿ã€æ— çº¿ç”µæ³¢ç­‰æ–¹å¼ã€‚ è¿™å°±å«åšâ€å®ä½“å±‚â€ï¼Œå®ƒå°±æ˜¯æŠŠç”µè„‘è¿æ¥èµ·æ¥çš„ç‰©ç†æ‰‹æ®µã€‚å®ƒä¸»è¦è§„å®šäº†ç½‘ç»œçš„ä¸€äº›ç”µæ°”ç‰¹æ€§ï¼Œä½œç”¨æ˜¯è´Ÿè´£ä¼ é€0å’Œ1çš„ç”µä¿¡å·ã€‚ é“¾æ¥å±‚å•çº¯çš„0å’Œ1æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå¿…é¡»è§„å®šè§£è¯»æ–¹å¼ï¼šå¤šå°‘ä¸ªç”µä¿¡å·ç®—ä¸€ç»„ï¼Ÿæ¯ä¸ªä¿¡å·ä½æœ‰ä½•æ„ä¹‰ï¼Ÿ è¿™å°±æ˜¯â€é“¾æ¥å±‚â€çš„åŠŸèƒ½ï¼Œå®ƒåœ¨â€å®ä½“å±‚â€çš„ä¸Šæ–¹ï¼Œç¡®å®šäº†0å’Œ1çš„åˆ†ç»„æ–¹å¼ã€‚ ä»¥å¤ªç½‘åè®®ä»¥å¤ªç½‘è§„å®šï¼Œä¸€ç»„ç”µä¿¡å·æ„æˆä¸€ä¸ªæ•°æ®åŒ…ï¼Œå«åšâ€å¸§â€ï¼ˆFrameï¼‰ã€‚æ¯ä¸€å¸§åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šæ ‡å¤´ï¼ˆHeadï¼‰å’Œæ•°æ®ï¼ˆDataï¼‰ã€‚ â€œæ ‡å¤´â€åŒ…å«æ•°æ®åŒ…çš„ä¸€äº›è¯´æ˜é¡¹ï¼Œæ¯”å¦‚å‘é€è€…ã€æ¥å—è€…ã€æ•°æ®ç±»å‹ç­‰ç­‰ï¼›â€æ•°æ®â€åˆ™æ˜¯æ•°æ®åŒ…çš„å…·ä½“å†…å®¹ã€‚ â€œæ ‡å¤´â€çš„é•¿åº¦ï¼Œå›ºå®šä¸º18å­—èŠ‚ã€‚â€æ•°æ®â€çš„é•¿åº¦ï¼Œæœ€çŸ­ä¸º46å­—èŠ‚ï¼Œæœ€é•¿ä¸º1500å­—èŠ‚ã€‚å› æ­¤ï¼Œæ•´ä¸ªâ€å¸§â€æœ€çŸ­ä¸º64å­—èŠ‚ï¼Œæœ€é•¿ä¸º1518å­—èŠ‚ã€‚å¦‚æœæ•°æ®å¾ˆé•¿ï¼Œå°±å¿…é¡»åˆ†å‰²æˆå¤šä¸ªå¸§è¿›è¡Œå‘é€ã€‚ MACåœ°å€ä¸Šé¢æåˆ°ï¼Œä»¥å¤ªç½‘æ•°æ®åŒ…çš„â€æ ‡å¤´â€ï¼ŒåŒ…å«äº†å‘é€è€…å’Œæ¥å—è€…çš„ä¿¡æ¯ã€‚é‚£ä¹ˆï¼Œå‘é€è€…å’Œæ¥å—è€…æ˜¯å¦‚ä½•æ ‡è¯†å‘¢ï¼Ÿ ä»¥å¤ªç½‘è§„å®šï¼Œè¿å…¥ç½‘ç»œçš„æ‰€æœ‰è®¾å¤‡ï¼Œéƒ½å¿…é¡»å…·æœ‰â€ç½‘å¡â€æ¥å£ã€‚æ•°æ®åŒ…å¿…é¡»æ˜¯ä»ä¸€å—ç½‘å¡ï¼Œä¼ é€åˆ°å¦ä¸€å—ç½‘å¡ã€‚ç½‘å¡çš„åœ°å€ï¼Œå°±æ˜¯æ•°æ®åŒ…çš„å‘é€åœ°å€å’Œæ¥æ”¶åœ°å€ï¼Œè¿™å«åšMACåœ°å€ã€‚ æ¯å—ç½‘å¡å‡ºå‚çš„æ—¶å€™ï¼Œéƒ½æœ‰ä¸€ä¸ªå…¨ä¸–ç•Œç‹¬ä¸€æ— äºŒçš„MACåœ°å€ï¼Œé•¿åº¦æ˜¯48ä¸ªäºŒè¿›åˆ¶ä½ï¼Œé€šå¸¸ç”¨12ä¸ªåå…­è¿›åˆ¶æ•°è¡¨ç¤ºã€‚ å‰6ä¸ªåå…­è¿›åˆ¶æ•°æ˜¯å‚å•†ç¼–å·ï¼Œå6ä¸ªæ˜¯è¯¥å‚å•†çš„ç½‘å¡æµæ°´å·ã€‚æœ‰äº†MACåœ°å€ï¼Œå°±å¯ä»¥å®šä½ç½‘å¡å’Œæ•°æ®åŒ…çš„è·¯å¾„äº†ã€‚ å¹¿æ’­æœ‰äº†MACåœ°å€ï¼Œç³»ç»Ÿæ€æ ·æ‰èƒ½æŠŠæ•°æ®åŒ…å‡†ç¡®é€åˆ°æ¥æ”¶æ–¹ï¼Ÿ å›ç­”æ˜¯ä»¥å¤ªç½‘é‡‡ç”¨äº†ä¸€ç§å¾ˆâ€åŸå§‹â€çš„æ–¹å¼ï¼Œå®ƒä¸æ˜¯æŠŠæ•°æ®åŒ…å‡†ç¡®é€åˆ°æ¥æ”¶æ–¹ï¼Œè€Œæ˜¯å‘æœ¬ç½‘ç»œå†…æ‰€æœ‰è®¡ç®—æœºå‘é€ï¼Œè®©æ¯å°è®¡ç®—æœºè‡ªå·±åˆ¤æ–­ï¼Œæ˜¯å¦ä¸ºæ¥æ”¶æ–¹ã€‚ è¯»å–æ•°æ®åŒ…çš„â€æ ‡å¤´â€ï¼Œæ‰¾åˆ°æ¥æ”¶æ–¹çš„MACåœ°å€ï¼Œç„¶åä¸è‡ªèº«çš„MACåœ°å€ç›¸æ¯”è¾ƒï¼Œå¦‚æœä¸¤è€…ç›¸åŒï¼Œå°±æ¥å—è¿™ä¸ªåŒ…ï¼Œåšè¿›ä¸€æ­¥å¤„ç†ï¼Œå¦åˆ™å°±ä¸¢å¼ƒè¿™ä¸ªåŒ…ã€‚è¿™ç§å‘é€æ–¹å¼å°±å«åšâ€å¹¿æ’­â€ï¼ˆbroadcastingï¼‰ã€‚ ç½‘ç»œå±‚ä»¥å¤ªç½‘åè®®ï¼Œä¾é MACåœ°å€å‘é€æ•°æ®ã€‚ç†è®ºä¸Šï¼Œå•å•ä¾é MACåœ°å€ï¼Œä¸Šæµ·çš„ç½‘å¡å°±å¯ä»¥æ‰¾åˆ°æ´›æ‰çŸ¶çš„ç½‘å¡äº†ï¼ŒæŠ€æœ¯ä¸Šæ˜¯å¯ä»¥å®ç°çš„ã€‚ ä½†æ˜¯ï¼Œè¿™æ ·åšæœ‰ä¸€ä¸ªé‡å¤§çš„ç¼ºç‚¹ã€‚ä»¥å¤ªç½‘é‡‡ç”¨å¹¿æ’­æ–¹å¼å‘é€æ•°æ®åŒ…ï¼Œæ‰€æœ‰æˆå‘˜äººæ‰‹ä¸€â€åŒ…â€ï¼Œä¸ä»…æ•ˆç‡ä½ï¼Œè€Œä¸”å±€é™åœ¨å‘é€è€…æ‰€åœ¨çš„å­ç½‘ç»œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸¤å°è®¡ç®—æœºä¸åœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œå¹¿æ’­æ˜¯ä¼ ä¸è¿‡å»çš„ã€‚è¿™ç§è®¾è®¡æ˜¯åˆç†çš„ï¼Œå¦åˆ™äº’è”ç½‘ä¸Šæ¯ä¸€å°è®¡ç®—æœºéƒ½ä¼šæ”¶åˆ°æ‰€æœ‰åŒ…ï¼Œé‚£ä¼šå¼•èµ·ç¾éš¾ã€‚ äº’è”ç½‘æ˜¯æ— æ•°å­ç½‘ç»œå…±åŒç»„æˆçš„ä¸€ä¸ªå·¨å‹ç½‘ç»œï¼Œå¾ˆåƒæƒ³è±¡ä¸Šæµ·å’Œæ´›æ‰çŸ¶çš„ç”µè„‘ä¼šåœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œè¿™å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚ å› æ­¤ï¼Œå¿…é¡»æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œèƒ½å¤ŸåŒºåˆ†å“ªäº›MACåœ°å€å±äºåŒä¸€ä¸ªå­ç½‘ç»œï¼Œå“ªäº›ä¸æ˜¯ã€‚å¦‚æœæ˜¯åŒä¸€ä¸ªå­ç½‘ç»œï¼Œå°±é‡‡ç”¨å¹¿æ’­æ–¹å¼å‘é€ï¼Œå¦åˆ™å°±é‡‡ç”¨â€è·¯ç”±â€æ–¹å¼å‘é€ã€‚é—æ†¾çš„æ˜¯ï¼ŒMACåœ°å€æœ¬èº«æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚å®ƒåªä¸å‚å•†æœ‰å…³ï¼Œä¸æ‰€å¤„ç½‘ç»œæ— å…³ã€‚ è¿™å°±å¯¼è‡´äº†â€ç½‘ç»œå±‚â€çš„è¯ç”Ÿã€‚å®ƒçš„ä½œç”¨æ˜¯å¼•è¿›ä¸€å¥—æ–°çš„åœ°å€ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤ŸåŒºåˆ†ä¸åŒçš„è®¡ç®—æœºæ˜¯å¦å±äºåŒä¸€ä¸ªå­ç½‘ç»œã€‚è¿™å¥—åœ°å€å°±å«åšâ€ç½‘ç»œåœ°å€â€ï¼Œç®€ç§°â€ç½‘å€â€ã€‚ äºæ˜¯ï¼Œâ€ç½‘ç»œå±‚â€å‡ºç°ä»¥åï¼Œæ¯å°è®¡ç®—æœºæœ‰äº†ä¸¤ç§åœ°å€ï¼Œä¸€ç§æ˜¯MACåœ°å€ï¼Œå¦ä¸€ç§æ˜¯ç½‘ç»œåœ°å€ã€‚ä¸¤ç§åœ°å€ä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ï¼ŒMACåœ°å€æ˜¯ç»‘å®šåœ¨ç½‘å¡ä¸Šçš„ï¼Œç½‘ç»œåœ°å€åˆ™æ˜¯ç®¡ç†å‘˜åˆ†é…çš„ï¼Œå®ƒä»¬åªæ˜¯éšæœºç»„åˆåœ¨ä¸€èµ·ã€‚ ç½‘ç»œåœ°å€å¸®åŠ©æˆ‘ä»¬ç¡®å®šè®¡ç®—æœºæ‰€åœ¨çš„å­ç½‘ç»œï¼ŒMACåœ°å€åˆ™å°†æ•°æ®åŒ…é€åˆ°è¯¥å­ç½‘ç»œä¸­çš„ç›®æ ‡ç½‘å¡ã€‚å› æ­¤ï¼Œä»é€»è¾‘ä¸Šå¯ä»¥æ¨æ–­ï¼Œå¿…å®šæ˜¯å…ˆå¤„ç†ç½‘ç»œåœ°å€ï¼Œç„¶åå†å¤„ç†MACåœ°å€ã€‚ å‚è€ƒ äº’è”ç½‘åè®®å…¥é—¨ï¼ˆä¸€ï¼‰"}],"posts":[{"title":"ç¬”è®°ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","slug":"ç¬”è®°ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","date":"2018-05-21T06:51:05.000Z","updated":"2018-05-21T07:59:44.689Z","comments":true,"path":"2018/05/21/ç¬”è®°ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","link":"","permalink":"https://hsb786.github.io/2018/05/21/ç¬”è®°ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","excerpt":"è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿","text":"è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿ è™šæ‹Ÿæœºæ ˆè™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚ æ ˆå¸§æ˜¯æ–¹æ³•åŒºè¿è¡Œæ—¶çš„åŸºç¡€æ•°æ®ç»“æ„ æˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„â€œæ ˆâ€æŒ‡çš„å°±æ˜¯è™šæ‹Ÿæœºæ ˆä¸­å±€éƒ¨å˜é‡è¡¨éƒ¨åˆ†ã€‚å±€éƒ¨å˜é‡è¡¨å­˜æ”¾äº†ç¼–è¯‘å™¨å¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨å’ŒreturnAddressç±»å‹ï¼ˆæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚ å…¶ä¸­64ä½é•¿åº¦çš„longå’Œdoubleç±»å‹çš„æ•°æ®ä¼šå ç”¨2ä¸ªå±€éƒ¨å˜é‡è¡¨ç©ºé—´ï¼ˆSlotï¼‰ï¼Œå…¶ä½™çš„æ•°æ®ç±»å‹åªå ç”¨1ä¸ªã€‚å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´åœ¨ç¼–è¯‘å™¨é—´å®Œæˆåˆ†é…ï¼Œå½“è¿›å…¥ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦åœ¨æ ˆä¸­åˆ†é…å¤šå¤§çš„å±€éƒ¨å˜é‡ç©ºé—´æ˜¯å®Œå…¨ç¡®å®šçš„ï¼Œåœ¨æ–¹æ³•è¿è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°ã€‚ æ–¹æ³•åŒºæ–¹æ³•åŒºï¼ˆMethod Areaï¼‰ç”¨äºå­˜å‚¨è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³ä½¿ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚è™½ç„¶Javaè™šæ‹Ÿæœºè§„åˆ’æŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒå´æœ‰ä¸€ä¸ªåˆ«åå«åšNon-Heap(éå †)ï¼Œç›®çš„åº”è¯¥æ˜¯ä¸Javaå †åŒºåˆ†å¼€æ¥ã€‚ æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£å¹¶ä¸ç­‰ä»·ï¼Œåªæ˜¯ä½¿ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºè€Œå·²ã€‚ç›®å‰jdk7å·²ç»æŠŠåŸæ¥æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦ä¸²å¸¸é‡æ± ç§»åˆ°å †ä¸­ï¼›jdk8æ”¹ç”¨Native Memoryæ¥å®ç°æ–¹æ³•åŒºï¼Œå³æ‰€è°“çš„å…ƒç©ºé—´ã€‚ å¯¹è±¡çš„è®¿é—®å®šä½Javaç¨‹åºéœ€è¦é€šè¿‡æ ˆä¸Šçš„referenceæ•°æ®æ¥æ“ä½œå †ä¸Šçš„å…·ä½“å¯¹è±¡ã€‚ç”±äºreferenceç±»å‹åœ¨Javaè™šæ‹Ÿæœºè§„åˆ’ä¸­åªè§„å®šäº†ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶æ²¡æœ‰å®šä¹‰è¿™ä¸ªå¼•ç”¨åº”è¯¥é€šè¿‡ä½•ç§æ–¹å¼å»å®šä½ã€è®¿é—®å †ä¸­çš„å¯¹è±¡çš„å…·ä½“ä½ç½®ï¼Œæ‰€ä»¥å¯¹è±¡è®¿é—®æ–¹å¼ä¹Ÿæ˜¯å–å†³äºè™šæ‹Ÿæœºå®ç°è€Œå®šçš„ã€‚ç›®å‰ä¸»æµçš„è®¿é—®æ–¹å¼æœ‰ä½¿ç”¨å¥æŸ„å’Œç›´æ¥æŒ‡é’ˆä¸¤ç§ã€‚ å¦‚æœä½¿ç”¨å¥æŸ„è®¿é—®çš„è¯ï¼Œé‚£ä¹ˆJavaå †ä¸­å°†ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜æ¥ä½œä¸ºå¥æŸ„æ± ï¼Œreferenceä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªçš„å…·ä½“åœ°å€ä¿¡æ¯ã€‚ å¦‚æœä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®ï¼Œé‚£ä¹ˆJavaå †å¯¹è±¡çš„å¸ƒå±€ä¸­å°±å¿…é¡»è€ƒè™‘å¦‚ä½•æ”¾ç½®è®¿é—®ç±»å‹æ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œreferenceä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡åœ°å€ ä½¿ç”¨å¥æŸ„æ¥è®¿é—®è®¿é—®çš„æœ€å¤§å¥½å¤„å°±æ˜¯referenceä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨ï¼ˆåƒåœ¾æ”¶é›†æ—¶ç§»åŠ¨å¯¹è±¡æ˜¯éå¸¸æ™®éçš„è¡Œä¸ºï¼‰æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œreferenceæœ¬èº«ä¸éœ€è¦æ”¹åŠ¨ã€‚ä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®æ–¹å¼çš„æœ€å¤§å¥½å¤„å°±æ˜¯é€Ÿåº¦æ›´å¿«ï¼Œå®ƒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ï¼Œç”±äºå¯¹è±¡çš„è®¿é—®åœ¨Javaä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤è¿™ç±»å¼€é”€ç§¯å°æˆå¤šåä¹Ÿæ˜¯ä¸€é¡¹éå¸¸å¯è§‚çš„æ‰§è¡Œæˆæœ¬ã€‚Sun HotSpotä½¿ç”¨ç¬¬äºŒç§æ–¹å¼è¿›è¡Œå¯¹è±¡èŒƒå›´ å¯è¾¾æ€§åˆ†æç®—æ³•åŸºæœ¬æ€æƒ³ï¼šé€šè¿‡ä¸€ç³»åˆ—çš„ç§°ä¸ºâ€œGC Rootsâ€çš„å¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼ˆReference Chainï¼‰ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼ˆç”¨å›¾è®ºçš„è¯æ¥è¯´ï¼Œå°±æ˜¯ä»GC Rootsåˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼‰æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œå¯ä½œä¸ºGC Rootsçš„å¯¹è±¡åŒ…æ‹¬ä¸‹é¢å‡ ç§ï¼š è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ã€‚ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ã€‚ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ã€‚ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆå³ä¸€èˆ¬è¯´çš„Nativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","slug":"çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","permalink":"https://hsb786.github.io/categories/çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº/"},{"name":"é•¿æœŸæ›´æ–°","slug":"çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº/é•¿æœŸæ›´æ–°","permalink":"https://hsb786.github.io/categories/çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº/é•¿æœŸæ›´æ–°/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"é¢è¯•ç¬”è®°","slug":"é¢è¯•ç¬”è®°","date":"2018-05-10T11:17:07.000Z","updated":"2018-05-10T11:51:04.323Z","comments":true,"path":"2018/05/10/é¢è¯•ç¬”è®°/","link":"","permalink":"https://hsb786.github.io/2018/05/10/é¢è¯•ç¬”è®°/","excerpt":"å‰å‡ å¤©ä¸€ç›´åœ¨æè®ºæ–‡ï¼Œæ˜¨å¤©çš„é¢è¯•éƒ½æ²¡å¥½å¥½å‡†å¤‡ä¸€ä¸‹ï¼Œç°åœ¨å›æƒ³èµ·æ¥çŠ¯äº†å¾ˆå¤šä½çº§é”™è¯¯ğŸ˜”ï¼Œå¸Œæœ›èƒ½è¿‡å§ã€‚","text":"å‰å‡ å¤©ä¸€ç›´åœ¨æè®ºæ–‡ï¼Œæ˜¨å¤©çš„é¢è¯•éƒ½æ²¡å¥½å¥½å‡†å¤‡ä¸€ä¸‹ï¼Œç°åœ¨å›æƒ³èµ·æ¥çŠ¯äº†å¾ˆå¤šä½çº§é”™è¯¯ğŸ˜”ï¼Œå¸Œæœ›èƒ½è¿‡å§ã€‚ union ç”¨äºåˆå¹¶å¤šä¸ªselectè¯­å¥çš„ç»“æœé›†123SELECT column_name(s) FROM table_name1UNIONSELECT column_name(s) FROM table_name2 StringBufferä¸StringBuilderçš„åŒºåˆ«åªåœ¨äºStringBufferæ–¹æ³•ç”¨synchronizedä¿®é¥° append() åŸç†å¤§æ¦‚æ˜¯é¦–å…ˆç»™valueæŒ‡å®šå®¹é‡ï¼Œå°†åŸæ¥çš„valueå¤åˆ¶åˆ°æ–°valueï¼›å†å°†è¦æ·»åŠ çš„å…ƒç´ åŠ åˆ°valueåé¢ã€‚ensureCapacityInternal()æ–¹æ³•å°†valueæ‰©å®¹ä¸ºæ–°valueçš„å®¹é‡ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455//StringBuffer@Overridepublic synchronized StringBuffer append(String str) &#123; toStringCache = null; super.append(str); return this;&#125;//AbstractStringBuilderpublic AbstractStringBuilder append(String str) &#123; if (str == null) return appendNull(); int len = str.length(); //ç»™valueæŒ‡å®šå®¹é‡ ensureCapacityInternal(count + len); //åº•å±‚è°ƒç”¨System.arraycopy()ï¼Œå°†stræ·»åŠ åˆ°valueåé¢ str.getChars(0, len, value, count); count += len; return this;&#125;private void ensureCapacityInternal(int minimumCapacity) &#123; // overflow-conscious code if (minimumCapacity - value.length &gt; 0) expandCapacity(minimumCapacity);&#125;/** * This implements the expansion semantics of ensureCapacity with no * size check or synchronization. */void expandCapacity(int minimumCapacity) &#123; int newCapacity = value.length * 2 + 2; if (newCapacity - minimumCapacity &lt; 0) newCapacity = minimumCapacity; if (newCapacity &lt; 0) &#123; if (minimumCapacity &lt; 0) // overflow throw new OutOfMemoryError(); newCapacity = Integer.MAX_VALUE; &#125; value = Arrays.copyOf(value, newCapacity);&#125;//Stringpublic void getChars(int srcBegin, int srcEnd, char dst[], int dstBegin) &#123; if (srcBegin &lt; 0) &#123; throw new StringIndexOutOfBoundsException(srcBegin); &#125; if (srcEnd &gt; value.length) &#123; throw new StringIndexOutOfBoundsException(srcEnd); &#125; if (srcBegin &gt; srcEnd) &#123; throw new StringIndexOutOfBoundsException(srcEnd - srcBegin); &#125; System.arraycopy(value, srcBegin, dst, dstBegin, srcEnd - srcBegin);&#125; å°†æ–°ç”Ÿä»£å†…å­˜åˆ†ä¸ºä¸€å—å¤§çš„EdenåŒºå’Œä¸¤å—å°çš„Survivorï¼›æ¯æ¬¡ä½¿ç”¨Edenå’Œä¸€ä¸ªSurvivorï¼Œå›æ”¶æ—¶å°†Edenå’ŒSurvivorå­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªSurvivorï¼ˆHotSpotçš„æ¯”ä¾‹Edenï¼šSurvivor = 8ï¼š1ï¼‰ Full GCæš‚æ—¶æœªäº†è§£ ConcurrentHashMapå®ç°åŸç†æš‚æ—¶æœªçœ‹ æš‚æ—¶åªè®°ä½è¿™äº›ï¼Œç°åœ¨å›æƒ³èµ·æ¥ï¼Œæ„Ÿè§‰å¾ˆå¤šé—®é¢˜éƒ½æ²¡å›ç­”å¥½ï¼ŒçŠ¯äº†ä¸€äº›ä¸è¯¥çŠ¯çš„é”™è¯¯ï¼Œé¢è¯•å®˜éƒ½å¤šæ¬¡æç¤ºæˆ‘äº†ï¼Œæˆ‘ç«Ÿç„¶æ²¡å¯Ÿè§‰åˆ°ã€‚å¸Œæœ›èƒ½è¿‡å§ã€‚æ€»ç»“èµ·æ¥ï¼Œå¹³å¸¸å°±ä¸€ä¸ªäººå­¦ä¸€ç‚¹ä¸œè¥¿ï¼Œä¹Ÿæ²¡æœ‰å’Œä»–äººäº¤æµè¿‡ï¼Œå¯¼è‡´æœ‰äº›ä¸œè¥¿æ˜æ˜çŸ¥é“ï¼Œå´è¡¨è¾¾é”™è¯¯ï¼Œå¸Œæœ›èº«è¾¹èƒ½æœ‰å¤§ç‰›å’Œæˆ‘äº¤æµæŠ€æœ¯ã€‚","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"https://hsb786.github.io/categories/æ‚è°ˆ/"}],"tags":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"https://hsb786.github.io/tags/æ‚è°ˆ/"}]},{"title":"Javaè¯­æ³•ç³–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","slug":"Javaè¯­æ³•ç³–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","date":"2018-05-05T07:06:23.000Z","updated":"2018-05-07T03:30:29.909Z","comments":true,"path":"2018/05/05/Javaè¯­æ³•ç³–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","link":"","permalink":"https://hsb786.github.io/2018/05/05/Javaè¯­æ³•ç³–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","excerpt":"è¯­æ³•ç³–å¯ä»¥çœ‹åšæ˜¯ç¼–è¯‘å™¨å®ç°çš„ä¸€äº›â€œå°æŠŠæˆâ€ï¼Œè¿™äº›â€œå°æŠŠæˆâ€å¯èƒ½ä¼šä½¿å¾—æ•ˆç‡â€œå¤§æå‡â€ï¼Œä½†æˆ‘ä»¬ä¹Ÿåº”è¯¥å»äº†è§£è¿™äº›â€œå°æŠŠæˆâ€èƒŒåçš„çœŸå®ä¸–ç•Œï¼Œé‚£æ ·æ‰èƒ½åˆ©ç”¨å¥½å®ƒä»¬ï¼Œè€Œä¸æ˜¯è¢«å®ƒä»¬æ‰€è¿·æƒ‘","text":"è¯­æ³•ç³–å¯ä»¥çœ‹åšæ˜¯ç¼–è¯‘å™¨å®ç°çš„ä¸€äº›â€œå°æŠŠæˆâ€ï¼Œè¿™äº›â€œå°æŠŠæˆâ€å¯èƒ½ä¼šä½¿å¾—æ•ˆç‡â€œå¤§æå‡â€ï¼Œä½†æˆ‘ä»¬ä¹Ÿåº”è¯¥å»äº†è§£è¿™äº›â€œå°æŠŠæˆâ€èƒŒåçš„çœŸå®ä¸–ç•Œï¼Œé‚£æ ·æ‰èƒ½åˆ©ç”¨å¥½å®ƒä»¬ï¼Œè€Œä¸æ˜¯è¢«å®ƒä»¬æ‰€è¿·æƒ‘ æ³›å‹ä¸ç±»å‹æ“¦é™¤æ³›å‹æ˜¯JDK1.5çš„ä¸€é¡¹æ–°å¢ç‰¹æ€§ï¼Œå®ƒçš„æœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»å‹ï¼ˆParametersized Typeï¼‰çš„åº”ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚è¿™ç§å‚æ•°ç±»å‹å¯ä»¥ç”¨åœ¨ç±»ã€æ¥å£å’Œæ–¹æ³•çš„åˆ›å»ºä¸­ï¼Œåˆ†åˆ«ä¸ºæ³›å‹ç±»ã€æ³›å‹æ¥å£å’Œæ³›å‹æ–¹æ³•ã€‚ åœ¨Javaè¯­è¨€å¤„äºè¿˜æ²¡æœ‰å‡ºç°æ³›å‹çš„ç‰ˆæœ¬æ—¶ï¼Œåªèƒ½é€šè¿‡Objectæ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»å’Œç±»å‹å¼ºåˆ¶è½¬æ¢ä¸¤ä¸ªç‰¹ç‚¹çš„é…åˆæ¥å®ç°æ³›å‹ç±»å‹æ³›åŒ–ã€‚Objectè½¬æ¢æˆä»»ä½•å¯¹è±¡éƒ½æ˜¯æœ‰å¯èƒ½çš„ï¼Œä½†æ˜¯æ­£å› ä¸ºæœ‰æ— é™çš„å¯èƒ½æ€§ï¼Œå°±åªæœ‰ç¨‹åºå‘˜å’Œè¿è¡ŒæœŸçš„è™šæ‹Ÿæœºæ‰çŸ¥é“è¿™ä¸ªObjectåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆç±»å‹çš„å¯¹è±¡ã€‚åœ¨ç¼–è¯‘æœŸé—´ï¼Œç¼–è¯‘å™¨æ— æ³•æ£€æŸ¥è¿™ä¸ªObjectçš„å¼ºåˆ¶è½¬å‹æ˜¯å¦æˆåŠŸï¼Œå¦‚æœä»…ä»…ä¾èµ–ç¨‹åºå‘˜å»ä¿éšœè¿™é¡¹æ“ä½œçš„æ­£ç¡®æ€§ï¼Œè®¸å¤šClassCastExceptionçš„é£é™©å°±ä¼šè½¬å«åˆ°ç¨‹åºè¿è¡ŒæœŸé—´ã€‚ Javaè¯­è¨€çš„æ³›å‹åªåœ¨ç¨‹åºæºç ä¸­å­˜åœ¨ï¼Œåœ¨ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œå·²ç»æ›¿æ¢ä¸ºåŸæ¥çš„åŸç”Ÿç±»å‹ï¼ˆRaw Typeï¼Œä¹Ÿæˆä¸ºè£¸ç±»å‹ï¼‰äº†ï¼Œå¹¶ä¸”åœ¨ç›¸åº”çš„åœ°æ–¹æ’å…¥äº†å¼ºåˆ¶è½¬å‹ä»£ç ã€‚Javaè¯­è¨€ä¸­çš„æ³›å‹å®ç°æ–¹æ³•ç§°ä¸ºç±»å‹æ“¦é™¤ï¼ŒåŸºäºè¿™ç§æ–¹æ³•å®ç°çš„æ³›å‹ç§°ä¸ºä¼ªæ³›å‹ã€‚ 123Map&lt;String, String&gt; map = new HashMap&lt;&gt;();map.put(&quot;Hello&quot;, &quot;you&quot;);System.out.println(map.get(&quot;Hello&quot;)); åç¼–è¯‘åçš„ä»£ç 123456//Map map=new HashMap(); ä¹¦æœ¬ä¸Šçš„ç­”æ¡ˆ,java7Map&lt;String, String&gt; map = new HashMap();//å¥‡æ€ªï¼Œæˆ‘ç”¨jadåç¼–è¯‘åï¼Œå‰é¢&lt;&gt;æ²¡æœ‰æ“¦é™¤ï¼Œåé¢&lt;&gt;æ“¦é™¤äº†ï¼Œéš¾é“æ˜¯å› ä¸ºç”¨çš„æ˜¯java8çš„åŸå› å—ï¼Ÿmap.put(&quot;Hello&quot;, &quot;you&quot;);//å¼ºåˆ¶è½¬å‹System.out.println((String)map.get(&quot;Hello&quot;)); å½“æ³›å‹é‡è§é‡è½½112345public static void method(List&lt;String&gt; list) &#123;&#125;public static void method(List&lt;Integer&gt; list) &#123; &#125; ç¼–è¯‘ä¸èƒ½é€šè¿‡ï¼ŒList&lt;String>å’ŒList&lt;Integer>éƒ½å˜æˆäº†åŸç”Ÿç±»å‹List&lt;E> å½“æ³›å‹é‡è§é‡è½½21234567public static String method(List&lt;String&gt; list) &#123; return &quot;1&quot;;&#125;public static int method(List&lt;Integer&gt; list) &#123; return 0;&#125; SUN JDK1.6çš„javacç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘ï¼Œå…¶å®ƒç¼–è¯‘å™¨ä»ç„¶å¯èƒ½ä¼šæ‹’ç»ç¼–è¯‘è¿™æ®µä»£ç  æ–¹æ³•é‡è½½è¦æ±‚æ–¹æ³•å…·å¤‡ä¸åŒçš„ç‰¹å¾ç­¾åï¼Œè¿”å›å€¼å¹¶ä¸åŒ…å«åœ¨æ–¹æ³•çš„ç‰¹å¾ç­¾åä¸­ï¼Œæ‰€ä»¥è¿”å›å€¼ä¸å‚ä¸é‡è½½é€‰æ‹© ä½†æ˜¯åœ¨Classæ–‡ä»¶æ ¼å¼ä¸­ï¼Œåªè¦æè¿°ç¬¦ä¸æ˜¯å®Œå…¨ä¸€è‡´çš„ä¸¤ä¸ªæ–¹æ³•å°±å¯ä»¥å…±å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªæ–¹æ³•å¦‚æœæœ‰ç›¸åŒçš„åç§°å’Œç‰¹å¾ç­¾åï¼Œä½†è¿”å›å€¼ä¸åŒï¼Œé‚£å®ƒä»¬ä¹Ÿæ˜¯å¯ä»¥åˆæ³•åœ°å…±å­˜äºä¸€ä¸ªClassæ–‡ä»¶ä¸­ è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ä¸éå†å¾ªç¯123456List&lt;Integer&gt; list=Arrays.asList(1,2,3,4);int sum=0;for(int i:list) &#123; sum+=i;&#125;System.out.println(sum); 12345678List&lt;Integer&gt; list = Arrays.asList(new Integer[] &#123; Integer.valueOf(1), Integer.valueOf(2), Integer.valueOf(3), Integer.valueOf(4) &#125;);int sum = 0;for (Iterator localIterator = list.iterator(); localIterator.hasNext();)&#123; int i = ((Integer)localIterator.next()).intValue(); sum += i;&#125;System.out.println(sum); éå†å¾ªç¯æŠŠä»£ç è¿˜åŸæˆäº†è¿­ä»£å™¨çš„å®ç°ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä½•éå†å¾ªç¯éœ€è¦è¢«éå†çš„ç±»å®ç°Iterableæ¥å£çš„å®ç° é™·é˜±12345678910111213Integer a=1;Integer b=2;Integer c=3;Integer d=3;Integer e=321;Integer f=321;Long g=3L;System.out.println(c==d); trueSystem.out.println(e==f); falseSystem.out.println(c==(a+b)); trueSystem.out.println(c.equals(a+b)); trueSystem.out.println(g==(a+b)); trueSystem.out.println(g.equals(a+b)); false 12345678910111213Integer a = Integer.valueOf(1);Integer b = Integer.valueOf(2);Integer c = Integer.valueOf(3);Integer d = Integer.valueOf(3);Integer e = Integer.valueOf(321);Integer f = Integer.valueOf(321);Long g = Long.valueOf(3L);System.out.println(c == d);System.out.println(e == f);System.out.println(c.intValue() == a.intValue() + b.intValue());System.out.println(c.equals(Integer.valueOf(a.intValue() + b.intValue())));System.out.println(g.longValue() == a.intValue() + b.intValue());System.out.println(g.equals(Integer.valueOf(a.intValue() + b.intValue()))); æ¡ä»¶ç¼–è¯‘ç¼–è¯‘å™¨å¹¶éä¸€ä¸ªä¸€ä¸ªåœ°ç¼–è¯‘Javaæ–‡ä»¶ï¼Œè€Œæ˜¯å°†æ‰€æœ‰ç¼–è¯‘å•å…ƒçš„è¯­æ³•æ ‘é¡¶çº§èŠ‚ç‚¹è¾“å…¥åˆ°å¾…å¤„ç†åˆ—è¡¨åè¿›è¡Œç¼–è¯‘ï¼Œå› æ­¤å„ä¸ªæ–‡ä»¶ä¹‹é—´èƒ½å¤Ÿäº’ç›¸æä¾›ç¬¦å·ä¿¡æ¯ã€‚ï¼ˆä»€ä¹ˆé¬¼ï¼Ÿåœ¨è¯´ä»€ä¹ˆğŸ˜±ï¼‰ 12345if(true) &#123; System.out.println(&quot;1&quot;);&#125;else &#123; System.out.println(&quot;2&quot;);&#125; åç¼–è¯‘å1System.out.println(&quot;1&quot;);","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","slug":"çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","permalink":"https://hsb786.github.io/categories/çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","slug":"çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","date":"2018-05-05T05:16:29.000Z","updated":"2018-05-07T04:31:48.099Z","comments":true,"path":"2018/05/05/çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","link":"","permalink":"https://hsb786.github.io/2018/05/05/çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","excerpt":"çº¿ç¨‹å®‰å…¨çš„ä»£ç éƒ½å¿…é¡»å…·å¤‡ä¸€ä¸ªç‰¹å¾ï¼šä»£ç æœ¬èº«å°è£…äº†æ‰€æœ‰å¿…è¦çš„æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µï¼ˆå¦‚äº’æ–¥åŒæ­¥ç­‰ï¼‰ï¼Œä»¤è°ƒç”¨è€…æ— é¡»å…³å¿ƒå¤šçº¿ç¨‹çš„é—®é¢˜ï¼Œæ›´æ— é¡»è‡ªå·±é‡‡å–ä»»ä½•æªæ–½æ¥ä¿è¯å¤šçº¿ç¨‹çš„æ­£ç¡®ä½¿ç”¨ã€‚","text":"çº¿ç¨‹å®‰å…¨çš„ä»£ç éƒ½å¿…é¡»å…·å¤‡ä¸€ä¸ªç‰¹å¾ï¼šä»£ç æœ¬èº«å°è£…äº†æ‰€æœ‰å¿…è¦çš„æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µï¼ˆå¦‚äº’æ–¥åŒæ­¥ç­‰ï¼‰ï¼Œä»¤è°ƒç”¨è€…æ— é¡»å…³å¿ƒå¤šçº¿ç¨‹çš„é—®é¢˜ï¼Œæ›´æ— é¡»è‡ªå·±é‡‡å–ä»»ä½•æªæ–½æ¥ä¿è¯å¤šçº¿ç¨‹çš„æ­£ç¡®ä½¿ç”¨ã€‚ ä¸å¯å˜ä¸å¯å˜ï¼ˆImmutableï¼‰çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®åœ°æ„å»ºå‡ºæ¥ï¼Œé‚£å…¶å¤–éƒ¨çš„å¯è§çŠ¶æ€æ°¸è¿œä¹Ÿä¸ä¼šæ”¹å˜ï¼Œæ°¸è¿œä¹Ÿä¸ä¼šçœ‹åˆ°å®ƒåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚â€œä¸å¯å˜â€å¸¦æ¥çš„å®‰å…¨æ€§æ˜¯æœ€ç®€å•å’Œæœ€çº¯ç²¹çš„ã€‚ çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•1.äº’æ–¥åŒæ­¥äº’æ–¥åŒæ­¥ï¼ˆMutualExclusion &amp; Synchronizationï¼‰æ˜¯å¸¸è§çš„ä¸€ç§å¹¶å‘æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µã€‚åŒæ­¥æ˜¯æŒ‡åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶ï¼Œä¿è¯å…±äº«æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶åˆ»åªè¢«ä¸€ä¸ªï¼ˆæˆ–è€…æ˜¯ä¸€äº›ï¼Œä½¿ç”¨ä¿¡å·é‡çš„æ—¶å€™ï¼‰çº¿ç¨‹ä½¿ç”¨ã€‚è€Œäº’æ–¥æ˜¯å®ç°åŒæ­¥çš„ä¸€ç§æ‰‹æ®µï¼Œä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ã€äº’æ–¥é‡ï¼ˆMutexï¼‰å’Œä¿¡å·é‡ï¼ˆSemaphoreï¼‰éƒ½æ˜¯ä¸»è¦çš„äº’æ–¥å®ç°æ–¹æ³•ã€‚å› æ­¤ï¼Œåœ¨è¿™4ä¸ªå­—é‡Œï¼Œäº’æ–¥æ˜¯å› ï¼ŒåŒæ­¥æ˜¯æœï¼›äº’æ–¥æ˜¯æ–¹æ³•ï¼ŒåŒæ­¥æ—¶ç›®çš„ã€‚ åœ¨Javaä¸­ï¼Œæœ€åŸºæœ¬çš„äº’æ–¥åŒæ­¥æ‰‹æ®µå°±æ˜¯synchronizedå…³é”®å­—ï¼Œsynchronizedå…³é”®å­—ç»è¿‡ç¼–è¯‘ä¹‹åï¼Œä¼šåœ¨åŒæ­¥å—çš„å‰ååˆ†åˆ«å½¢æˆmonitorenterå’Œmonitorexitè¿™ä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤ï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚ç éƒ½éœ€è¦ä¸€ä¸ªreferenceç±»å‹çš„å‚æ•°æ¥æŒ‡æ˜è¦é”å®šå’Œè§£é”çš„å¯¹è±¡ã€‚å¦‚æœJavaç¨‹åºä¸­çš„synchronizedæ˜ç¡®æŒ‡å®šäº†å¯¹è±¡å‚æ•°ï¼Œé‚£å°±æ˜¯è¿™ä¸ªå¯¹è±¡çš„referenceï¼›å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šï¼Œé‚£å°±æ ¹æ®synchronizedä¿®é¥°çš„æ˜¯å®ä¾‹æ–¹æ³•è¿˜æ˜¯ç±»æ–¹æ³•ï¼Œå»å–å¯¹åº”çš„å¯¹è±¡å®ä¾‹æˆ–Classå¯¹è±¡æ¥ä½œä¸ºé”å¯¹è±¡ã€‚ æ ¹æ®è™šæ‹Ÿæœºè§„èŒƒçš„è¦æ±‚ï¼Œåœ¨æ‰§è¡ŒmonitorenteræŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆè¦å°è¯•è·å–å¯¹è±¡çš„é”ã€‚å¦‚æœè¿™ä¸ªå¯¹è±¡æ²¡è¢«é”å®šï¼Œæˆ–è€…å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†é‚£ä¸ªå¯¹è±¡çš„é”ï¼ŒæŠŠé”çš„è®¡æ•°å™¨åŠ 1ï¼Œç›¸åº”çš„ï¼Œåœ¨æ‰§è¡ŒmonitorexitæŒ‡ä»¤æ—¶ä¼šå°†é”è®¡æ•°å™¨å‡1ï¼Œå½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œé”å°±è¢«é‡Šæ”¾ã€‚å¦‚æœè·å–å¯¹è±¡é”å¤±è´¥ï¼Œé‚£å½“å‰çº¿ç¨‹å°±è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°å¯¹è±¡é”è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾ä¸ºæ­¢ã€‚ åœ¨è™šæ‹Ÿæœºè§„èŒƒå¯¹monitorenterå’Œmonitorexitçš„è¡Œä¸ºæè¿°ä¸­ï¼Œæœ‰ä¸¤ç‚¹æ˜¯éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ã€‚é¦–å…ˆï¼ŒsynchronizedåŒæ­¥å—å¯¹åŒä¸€æ¡çº¿ç¨‹æ¥è¯´æ˜¯å¯é‡å…¥çš„ï¼Œä¸ä¼šå‡ºç°è‡ªå·±æŠŠè‡ªå·±é”æ­»çš„é—®é¢˜ã€‚å…¶æ¬¡ï¼ŒåŒæ­¥å—åœ¨å·²è¿›å…¥çš„çº¿ç¨‹æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¼šé˜»å¡åé¢å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ã€‚Javaçš„çº¿ç¨‹æ˜¯æ˜ å°„åˆ°æ“ä½œç³»ç»Ÿçš„åŸç”Ÿçº¿ç¨‹ä¹‹ä¸Šçš„ï¼Œå¦‚æœè¦é˜»å¡æˆ–å”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œéƒ½éœ€è¦æ“ä½œç³»ç»Ÿæ¥å¸®å¿™å®Œæˆï¼Œè¿™å°±éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°æ ¸å¿ƒæ€ä¸­ï¼Œå› æ­¤çŠ¶æ€è½¬æ¢éœ€è¦è€—è´¹å¾ˆå¤šçš„å¤„ç†å™¨æ—¶é—´ã€‚å¯¹äºä»£ç ç®€å•çš„åŒæ­¥å—ï¼ˆå¦‚è¢«synchronizedä¿®é¥°çš„getterï¼ˆï¼‰æˆ–setterï¼ˆï¼‰æ–¹æ³•ï¼‰ï¼ŒçŠ¶æ€è½¬æ¢æ¶ˆè€—çš„æ—¶é—´æœ‰å¯èƒ½æ¯”ç”¨æˆ·ä»£ç æ‰§è¡Œçš„æ—¶é—´è¿˜è¦é•¿ã€‚æ‰€ä»¥synchronizedæ˜¯Javaè¯­è¨€ä¸­ä¸€ä¸ªé‡é‡çº§ï¼ˆHeavyweightï¼‰çš„æ“ä½œ é™¤äº†synchronizedä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨java.util.concurrentï¼ˆä¸‹æ–‡ç§°J.U.Cï¼‰åŒ…ä¸­çš„é‡å…¥é”ï¼ˆReentrantLockï¼‰æ¥å®ç°åŒæ­¥ï¼Œåœ¨åŸºæœ¬ç”¨æ³•ä¸Šï¼ŒReentrantLockä¸synchronizedå¾ˆç›¸ä¼¼ï¼Œä»–ä»¬éƒ½å…·å¤‡ä¸€æ ·çš„çº¿ç¨‹é‡å…¥ç‰¹æ€§ï¼Œåªæ˜¯ä»£ç å†™æ³•ä¸Šæœ‰ç‚¹åŒºåˆ«ï¼Œä¸€ä¸ªè¡¨ç°ä¸ºAPIå±‚é¢çš„äº’æ–¥é”ï¼ˆlockï¼ˆï¼‰å’Œunlockï¼ˆï¼‰æ–¹æ³•é…åˆtry/finallyè¯­å¥å—æ¥å®Œæˆï¼‰ï¼Œå¦ä¸€ä¸ªè¡¨ç°ä¸ºåŸç”Ÿè¯­æ³•å±‚é¢çš„äº’æ–¥é”ã€‚ä¸è¿‡ï¼Œç›¸æ¯”synchronized,ReentrantLockå¢åŠ äº†ä¸€äº›é«˜çº§åŠŸèƒ½ï¼Œä¸»è¦æœ‰ä»¥ä¸‹3é¡¹ï¼šç­‰å¾…å¯ä¸­æ–­ã€å¯å®ç°å…¬å¹³é”ï¼Œä»¥åŠé”å¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶ã€‚ ç­‰å¾…å¯ä¸­æ–­æ˜¯æŒ‡å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾é”çš„æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ï¼Œå¯ä¸­æ–­ç‰¹æ€§å¯¹å¤„ç†æ‰§è¡Œæ—¶é—´éå¸¸é•¿çš„åŒæ­¥å—å¾ˆæœ‰å¸®åŠ©ã€‚ å…¬å¹³é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºæ¥ä¾æ¬¡è·å¾—é”ï¼›è€Œéå…¬å¹³é”åˆ™ä¸ä¿è¯è¿™ä¸€ç‚¹ï¼Œåœ¨é”è¢«é‡Šæ”¾æ—¶ï¼Œä»»ä½•ä¸€ä¸ªç­‰å¾…é”çš„çº¿ç¨‹éƒ½æœ‰æœºä¼šè·å¾—é”ã€‚synchronizedä¸­çš„é”æ˜¯éå…¬å¹³çš„ï¼ŒReentrantLocké»˜è®¤æƒ…å†µä¸‹ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†å¯ä»¥é€šè¿‡å¸¦å¸ƒå°”å€¼çš„æ„é€ å‡½æ•°è¦æ±‚ä½¿ç”¨å…¬å¹³é”ã€‚ é”ç»‘å®šå¤šä¸ªæ¡ä»¶æ˜¯æŒ‡ä¸€ä¸ªReentrantLockå¯¹è±¡å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ªConditionå¯¹è±¡ï¼Œè€Œåœ¨synchronizedä¸­ï¼Œé”å¯¹è±¡çš„waitï¼ˆï¼‰å’Œnotifyï¼ˆï¼‰æˆ–notifyAllï¼ˆï¼‰æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªéšå«çš„æ¡ä»¶ï¼Œå¦‚æœè¦å’Œå¤šäºä¸€ä¸ªçš„æ¡ä»¶å…³è”çš„æ—¶å€™ï¼Œå°±ä¸å¾—ä¸é¢å¤–åœ°æ·»åŠ ä¸€ä¸ªé”ï¼Œè€ŒReentrantLockåˆ™æ— é¡»è¿™æ ·åšï¼Œåªéœ€è¦å¤šæ¬¡è°ƒç”¨newConditionï¼ˆï¼‰æ–¹æ³•å³å¯ã€‚ è™šæ‹Ÿæœºåœ¨æœªæ¥çš„æ€§èƒ½æ”¹è¿›ä¸­ä¼šæ›´åŠ åå‘äºåŸç”Ÿçš„synchronizedï¼Œæ‰€ä»¥è¿˜æ˜¯æå€¡åœ¨synchronizedèƒ½å®ç°éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨synchronizedæ¥è¿›è¡ŒåŒæ­¥ã€‚ 2.éé˜»å¡åŒæ­¥äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯è¿›è¡Œçº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ï¼ˆBlocking Synchronizationï¼‰ã€‚éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬æœ‰äº†å¦å¤–ä¸€ä¸ªé€‰æ‹©ï¼šåŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥ï¼Œé€šä¿—åœ°è¯´ï¼Œå°±æ˜¯å…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼›å¦‚æœå…±äº«æ•°æ®æœ‰äº‰ç”¨ï¼Œäº§ç”Ÿäº†å†²çªï¼Œé‚£å°±å†é‡‡å–å…¶ä»–çš„è¡¥å¿æªæ–½ï¼ˆæœ€å¸¸è§çš„è¡¥å¿æªæ–½å°±æ˜¯ä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼‰ï¼Œè¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦æŠŠçº¿ç¨‹æŒ‚èµ·ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ï¼ˆNon-Blocking Synchronizationï¼‰ã€‚ ç¡¬ä»¶ä¿è¯ä¸€ä¸ªä»è¯­ä¹‰ä¸Šçœ‹èµ·æ¥éœ€è¦å¤šæ¬¡æ“ä½œçš„è¡Œä¸ºåªé€šè¿‡ä¸€æ¡å¤„ç†å™¨æŒ‡ä»¤å°±èƒ½å®Œæˆï¼Œ è¿™ç±»æŒ‡ä»¤å¸¸ç”¨çš„æœ‰ï¼š æµ‹è¯•å¹¶è®¾ç½®ï¼ˆTest-and-Setï¼‰ã€‚ è·å–å¹¶å¢åŠ ï¼ˆFetch-and-Incrementï¼‰ã€‚ äº¤æ¢ï¼ˆSwapï¼‰ã€‚ æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare-and-Swapï¼ŒCASï¼‰ã€‚ åŠ è½½é“¾æ¥/æ¡ä»¶å­˜å‚¨ï¼ˆLoad-Linked/Store-Conditionalï¼ŒLL/SCï¼‰ã€‚ CASæŒ‡ä»¤éœ€è¦æœ‰3ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜ä½ç½®ï¼ˆåœ¨Javaä¸­å¯ä»¥ç®€å•ç†è§£ä¸ºå˜é‡çš„å†…å­˜åœ°å€ï¼Œç”¨Vè¡¨ç¤ºï¼‰ã€æ—§çš„é¢„æœŸå€¼ï¼ˆç”¨Aè¡¨ç¤ºï¼‰å’Œæ–°å€¼ï¼ˆç”¨Bè¡¨ç¤ºï¼‰ã€‚CASæŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œå½“ä¸”ä»…å½“Vç¬¦åˆæ—§é¢„æœŸå€¼Aæ—¶ï¼Œå¤„ç†å™¨ç”¨æ–°å€¼Bæ›´æ–°Vçš„å€¼ï¼Œå¦åˆ™å®ƒå°±ä¸æ‰§è¡Œæ›´æ–°ï¼Œä½†æ˜¯æ— è®ºæ˜¯å¦æ›´æ–°äº†Vçš„å€¼ï¼Œéƒ½ä¼šè¿”å›Vçš„æ—§å€¼ï¼Œä¸Šè¿°çš„å¤„ç†è¿‡ç¨‹æ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚ åœ¨JDK 1.5ä¹‹åï¼ŒJavaç¨‹åºä¸­æ‰å¯ä»¥ä½¿ç”¨CASæ“ä½œï¼Œè¯¥æ“ä½œç”±sun.misc.Unsafeç±»é‡Œé¢çš„compareAndSwapIntï¼ˆï¼‰å’ŒcompareAndSwapLongï¼ˆï¼‰ç­‰å‡ ä¸ªæ–¹æ³•åŒ…è£…æä¾›ï¼Œè™šæ‹Ÿæœºåœ¨å†…éƒ¨å¯¹è¿™äº›æ–¹æ³•åšäº†ç‰¹æ®Šå¤„ç†ï¼Œå³æ—¶ç¼–è¯‘å‡ºæ¥çš„ç»“æœå°±æ˜¯ä¸€æ¡å¹³å°ç›¸å…³çš„å¤„ç†å™¨CASæŒ‡ä»¤ï¼Œæ²¡æœ‰æ–¹æ³•è°ƒç”¨çš„è¿‡ç¨‹ï¼Œæˆ–è€…å¯ä»¥è®¤ä¸ºæ˜¯æ— æ¡ä»¶å†…è”è¿›å»äº† ç”±äºUnsafeç±»ä¸æ˜¯æä¾›ç»™ç”¨æˆ·ç¨‹åºè°ƒç”¨çš„ç±»ï¼ˆUnsafe.getUnsafeï¼ˆï¼‰çš„ä»£ç ä¸­é™åˆ¶äº†åªæœ‰å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰åŠ è½½çš„Classæ‰èƒ½è®¿é—®å®ƒï¼‰ï¼Œå› æ­¤ï¼Œå¦‚æœä¸é‡‡ç”¨åå°„æ‰‹æ®µï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡å…¶ä»–çš„Java APIæ¥é—´æ¥ä½¿ç”¨å®ƒï¼Œå¦‚J.U.CåŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±»ï¼Œå…¶ä¸­çš„compareAndSetï¼ˆï¼‰å’ŒgetAndIncrementï¼ˆï¼‰ç­‰æ–¹æ³•éƒ½ä½¿ç”¨äº†Unsafeç±»çš„CASæ“ä½œã€‚ 3.æ— åŒæ­¥æ–¹æ¡ˆè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ï¼Œä¸¤è€…æ²¡æœ‰å› æœå…³ç³»ã€‚åŒæ­¥åªæ˜¯ä¿è¯å…±äº«æ•°æ®äº‰ç”¨æ—¶çš„æ­£ç¡®æ€§çš„æ‰‹æ®µï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ï¼Œå› æ­¤ä¼šæœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç¬”è€…ç®€å•åœ°ä»‹ç»å…¶ä¸­çš„ä¸¤ç±»ã€‚ å¯é‡å…¥ä»£ç ï¼ˆReentrant Codeï¼‰ï¼šè¿™ç§ä»£ç ä¹Ÿå«åšçº¯ä»£ç ï¼ˆPure Codeï¼‰ï¼Œå¯ä»¥åœ¨ä»£ç æ‰§è¡Œçš„ä»»ä½•æ—¶åˆ»ä¸­æ–­å®ƒï¼Œè½¬è€Œå»æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç ï¼ˆåŒ…æ‹¬é€’å½’è°ƒç”¨å®ƒæœ¬èº«ï¼‰ï¼Œè€Œåœ¨æ§åˆ¶æƒè¿”å›åï¼ŒåŸæ¥çš„ç¨‹åºä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚ç›¸å¯¹çº¿ç¨‹å®‰å…¨æ¥è¯´ï¼Œå¯é‡å…¥æ€§æ˜¯æ›´åŸºæœ¬çš„ç‰¹æ€§ï¼Œå®ƒå¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå³æ‰€æœ‰çš„å¯é‡å…¥çš„ä»£ç éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯å¹¶éæ‰€æœ‰çš„çº¿ç¨‹å®‰å…¨çš„ä»£ç éƒ½æ˜¯å¯é‡å…¥çš„ã€‚ğŸ¤¨ä»€ä¹ˆæ„æ€ï¼Ÿæ˜¯æŒ‡Lambdaè¡¨è¾¾å¼å—ï¼Ÿæ— å‰¯ä½œç”¨çš„ï¼Œçº¯ç²¹çš„å‡½æ•°ï¼Œä¸åº”è¯¥æœ‰ï¼ˆå¯¹å¤–éƒ¨å¯è§çš„ï¼‰å¯¹è±¡ä¿®æ”¹ å¯é‡å…¥ä»£ç æœ‰ä¸€äº›å…±åŒçš„ç‰¹å¾ï¼Œä¾‹å¦‚ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºã€ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥ã€ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„åŸåˆ™æ¥åˆ¤æ–­ä»£ç æ˜¯å¦å…·å¤‡å¯é‡å…¥æ€§ï¼šå¦‚æœä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„è¿”å›ç»“æœæ˜¯å¯ä»¥é¢„æµ‹çš„ï¼Œåªè¦è¾“å…¥äº†ç›¸åŒçš„æ•°æ®ï¼Œå°±éƒ½èƒ½è¿”å›ç›¸åŒçš„ç»“æœï¼Œé‚£å®ƒå°±æ»¡è¶³å¯é‡å…¥æ€§çš„è¦æ±‚ï¼Œå½“ç„¶ä¹Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storageï¼‰ï¼šå¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼Ÿå¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œè¿™æ ·ï¼Œæ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜ã€‚ğŸ™ƒä¸å¤ªå¥½ç†è§£ï¼Œå…¶å®å°±æ˜¯ThreadLocalï¼Œä¸ºå˜é‡åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­éƒ½åˆ›å»ºäº†ä¸€ä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆæ¯ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®è‡ªå·±å†…éƒ¨çš„å‰¯æœ¬å˜é‡ã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","slug":"çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","permalink":"https://hsb786.github.io/categories/çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","slug":"Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘","date":"2018-05-05T04:00:23.000Z","updated":"2018-05-05T05:17:00.226Z","comments":true,"path":"2018/05/05/Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","link":"","permalink":"https://hsb786.github.io/2018/05/05/Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹ã€æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‘/","excerpt":"Amdahlå®šå¾‹é€šè¿‡ç³»ç»Ÿä¸­å¹¶è¡ŒåŒ–ä¸ä¸²è¡ŒåŒ–çš„æ¯”é‡æ¥æè¿°å¤šå¤„ç†å™¨ç³»ç»Ÿèƒ½è·å¾—çš„è¿ç®—åŠ é€Ÿèƒ½åŠ›ï¼Œæ‘©å°”å®šå¾‹åˆ™ç”¨äºæè¿°å¤„ç†å™¨æ™¶ä½“ç®¡æ•°é‡ä¸è¿è¡Œæ•ˆç‡ä¹‹é—´çš„å‘å±•å…³ç³»ã€‚è¿™ä¸¤ä¸ªå®šå¾‹çš„æ›´æ›¿ä»£è¡¨äº†è¿‘å¹´æ¥ç¡¬ä»¶å‘å±•ä»è¿½æ±‚å¤„ç†å™¨é¢‘ç‡åˆ°è¿½æ±‚å¤šæ ¸å¿ƒå¹¶è¡Œå¤„ç†çš„å‘å±•è¿‡ç¨‹ã€‚","text":"Amdahlå®šå¾‹é€šè¿‡ç³»ç»Ÿä¸­å¹¶è¡ŒåŒ–ä¸ä¸²è¡ŒåŒ–çš„æ¯”é‡æ¥æè¿°å¤šå¤„ç†å™¨ç³»ç»Ÿèƒ½è·å¾—çš„è¿ç®—åŠ é€Ÿèƒ½åŠ›ï¼Œæ‘©å°”å®šå¾‹åˆ™ç”¨äºæè¿°å¤„ç†å™¨æ™¶ä½“ç®¡æ•°é‡ä¸è¿è¡Œæ•ˆç‡ä¹‹é—´çš„å‘å±•å…³ç³»ã€‚è¿™ä¸¤ä¸ªå®šå¾‹çš„æ›´æ›¿ä»£è¡¨äº†è¿‘å¹´æ¥ç¡¬ä»¶å‘å±•ä»è¿½æ±‚å¤„ç†å™¨é¢‘ç‡åˆ°è¿½æ±‚å¤šæ ¸å¿ƒå¹¶è¡Œå¤„ç†çš„å‘å±•è¿‡ç¨‹ã€‚ ç¡¬ä»¶çš„æ•ˆç‡ä¸ä¸€è‡´æ€§ç”±äºè®¡ç®—æœºçš„å­˜å‚¨è®¾å¤‡ä¸å¤„ç†å™¨çš„è¿ç®—é€Ÿåº¦æœ‰å‡ ä¸ªæ•°é‡çº§çš„å·®è·ï¼Œæ‰€ä»¥ç°ä»£è®¡ç®—æœºç³»ç»Ÿéƒ½ä¸å¾—ä¸åŠ å…¥ä¸€å±‚è¯»å†™é€Ÿåº¦å°½å¯èƒ½æ¥è¿‘å¤„ç†å™¨è¿ç®—é€Ÿåº¦çš„é«˜é€Ÿç¼“å­˜ï¼ˆCacheï¼‰æ¥ä½œä¸ºå†…å­˜ä¸å¤„ç†å™¨ä¹‹é—´çš„ç¼“å†²ï¼šå°†è¿ç®—éœ€è¦ä½¿ç”¨åˆ°çš„æ•°æ®å¤åˆ¶åˆ°ç¼“å­˜ä¸­ï¼Œè®©é«˜é€Ÿè¿ç®—èƒ½å¿«é€Ÿè¿›è¡Œï¼Œå½“è¿ç®—ç»“æŸåå†ä»ç¼“å­˜åŒæ­¥å›å†…å­˜ä¸­ï¼Œè¿™æ ·å¤„ç†å™¨å°±æ— éœ€ç­‰å¾…ç¼“æ…¢çš„å†…å­˜è¯»å†™äº†ã€‚ ç¼“å­˜ä¸€è‡´æ€§ï¼ˆCache Coherenceï¼‰ã€‚åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„é«˜é€Ÿç¼“å­˜ï¼Œè€Œå®ƒä»¬åˆå…±çŒ®åŒä¸€ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰ã€‚å½“å¤šä¸ªå¤„ç†å™¨çš„è¿ç®—ä»»åŠ¡éƒ½æ¶‰åŠåˆ°åŒä¸€å—ä¸»å†…å­˜åŒºåŸŸæ—¶ï¼Œå°†å¯èƒ½å¯¼è‡´å„è‡ªçš„ç¼“å­˜æ•°æ®ä¸ä¸€è‡´ã€‚ä¸ºäº†è§£å†³ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œéœ€è¦å„ä¸ªå¤„ç†å™¨è®¿é—®ç¼“å­˜æ—¶éƒ½éµå¾ªä¸€äº›åè®®ã€‚ é™¤äº†å¢åŠ é«˜é€Ÿç¼“å­˜ä¹‹å¤–ï¼Œä¸ºäº†ä½¿å¾—å¤„ç†å™¨å†…éƒ¨çš„è¿ç®—å•ä½èƒ½å°½é‡è¢«å……åˆ†åˆ©ç”¨ï¼Œå¤„ç†å™¨å¯èƒ½ä¼šå¯¹è¾“å…¥ä»£ç è¿›è¡Œä¹±åºæ‰§è¡Œï¼ˆOut of Order Executionï¼‰ä¼˜åŒ–ï¼Œå¤„ç†å™¨ä¼šåœ¨è®¡ç®—ä¹‹åå°†ä¹±åºæ‰§è¡Œçš„ç»“æœè¿›è¡Œé‡ç»„ï¼Œä¿è¯è¯¥ç»“æœä¸é¡ºåºæ‰§è¡Œçš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä½†ä¸ä¿è¯ç¨‹åºä¸­å„ä¸ªè¯­å¥è®¡ç®—çš„å…ˆåé¡ºåºä¸è¾“å…¥ä»£ç ä¸­çš„é¡ºåºæ˜¯ä¸€è‡´çš„ã€‚ä¸å¤„ç†å™¨çš„ä¹±åºæ‰§è¡Œä¼˜åŒ–ç±»ä¼¼ï¼ŒJavaè™šæ‹Ÿæœºçš„å³æ—¶ç¼–è¯‘å™¨ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„æŒ‡ä»¤é‡æ’åºï¼ˆInstruction Reorderï¼‰ä¼˜åŒ–ã€‚ Javaå†…å­˜æ¨¡å‹Javaè™šæ‹Ÿæœºè§„åˆ’ä¸­è¯•å›¾å®šä¹‰ä¸€ç§Javaå†…å­˜æ¨¡å‹ï¼ˆJava Memory Modelï¼ŒJMMï¼‰æ¥å±è”½æ‰å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ï¼Œä»¥å®ç°è®©Javaç¨‹åºåœ¨å„ç§å¹³å°ä¸Šéƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚ ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜Javaå†…å­˜æ¨¡å‹çš„ä¸»è¦ç›®æ ‡æ˜¯å®šä¹‰ç¨‹åºä¸­å„ä¸ªå˜é‡çš„è®¿é—®è§„åˆ™ï¼Œå³åœ¨è™šæ‹Ÿæœºä¸­å°†å˜é‡å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­å–å‡ºå˜é‡è¿™æ ·çš„åº•å±‚ç»†èŠ‚ã€‚æ­¤å¤„çš„å˜é‡ï¼ˆVariablesï¼‰ä¸Javaç¼–ç¨‹ä¸­æ‰€è¯´çš„å˜é‡æœ‰æ‰€åŒºåˆ«ï¼Œå®ƒåŒ…æ‹¬äº†å®ä¾‹å­—æ®µã€é™æ€å­—æ®µå’Œæ„æˆæ•°ç»„å¯¹è±¡çš„å…ƒç´ ï¼Œä½†ä¸åŒ…æ‹¬å±€éƒ¨å˜é‡ä¸æ–¹æ³•å‚æ•°ï¼Œå› ä¸ºåè€…æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œä¸ä¼šè¢«å…±äº«ï¼Œè‡ªç„¶å°±ä¸ä¼šå­˜åœ¨ç«äº‰é—®é¢˜ã€‚ Javaå†…å­˜æ¨¡å‹è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰ä¸­ã€‚æ¯æ¡çº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼ˆWorking Memoryï¼‰ï¼Œçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¿å­˜äº†è¢«çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œï¼ˆè¯»å–ã€èµ‹å€¼ç­‰ï¼‰éƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚ä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œçº¿ç¨‹é—´å˜é‡å€¼çš„ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚ å¯¹äºvolatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™å…³é”®å­—volatileå¯ä»¥è¯´æ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ å½“ä¸€ä¸ªå˜é‡å®šä¹‰ä¸ºvolatileä¹‹åï¼Œå®ƒå°†å…·å¤‡ä¸¤ç§ç‰¹æ€§ï¼Œç¬¬ä¸€æ˜¯ä¿è¯æ­¤å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§ï¼Œè¿™é‡Œçš„â€œå¯è§æ€§â€æ˜¯æŒ‡å½“ä¸€æ¡çº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œæ–°å€¼å¯¹äºå…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯å¯ä»¥ç«‹å³å¾—çŸ¥çš„ã€‚ç¬¬äºŒæ˜¯ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼Œæ™®é€šçš„å˜é‡ä»…ä»…ä¼šä¿è¯åœ¨è¯¥æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€æœ‰ä¾èµ–èµ‹å€¼ç»“æœçš„åœ°æ–¹éƒ½èƒ½è·å–åˆ°æ­£ç¡®çš„ç»“æœï¼Œè€Œä¸èƒ½ä¿è¯å˜é‡èµ‹å€¼æ“ä½œçš„é¡ºåºä¸ç¨‹åºä»£ç ä¸­çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸€è‡´çš„ å¯¹äºlongå’Œdoubleå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™å…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢«volatileä¿®é¥°çš„64ä½æ•°æ®çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡32ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œå³è™šæ‹Ÿæœºå®ç°é€‰æ‹©å¯ä»¥ä¸ä¿è¯64ä½æ•°æ®ç±»å‹çš„åŸå­æ€§ï¼Œè¿™ç‚¹å°±æ˜¯æ‰€è°“çš„longå’Œdoubleçš„éåŸå­æ€§åå®šï¼ˆNonatomic Treatment of double and long Variablesï¼‰ Javaå†…å­˜æ¨¡å‹è™½ç„¶å…è®¸è™šæ‹Ÿæœºä¸æŠŠlongå’Œdoubleå˜é‡çš„è¯»å†™å®ç°æˆåŸå­æ“ä½œï¼Œä½†å…è®¸è™šæ‹Ÿæœºé€‰æ‹©æŠŠè¿™äº›æ“ä½œå®ç°ä¸ºå…·æœ‰åŸå­æ€§çš„æ“ä½œï¼Œè€Œä¸”è¿˜â€œå¼ºçƒˆå»ºè®®â€è™šæ‹Ÿæœºè¿™æ ·å®ç°ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œç›®å‰å„ç§å¹³å°ä¸‹çš„å•†ç”¨è™šæ‹Ÿæœºå‡ ä¹éƒ½é€‰æ‹©æŠŠ64ä¸ºæ•°æ®çš„è¯»å†™æ“ä½œä½œä¸ºåŸå­æ“ä½œæ¥å¯¹å¾…ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ä¸€èˆ¬ä¸éœ€è¦æŠŠç”¨åˆ°çš„longå’Œdoubleå˜é‡ä¸“é—¨å£°æ˜ä¸ºvolatileã€‚ åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šåŸºæœ¬æ•°æ®ç±»å‹çš„è®¿é—®è¯»å†™æ˜¯å…·å¤‡åŸå­æ€§çš„ï¼ˆä¾‹å¤–å°±æ˜¯longå’Œdoubleæ˜¯éåŸå­æ€§åå®šï¼‰ å¯è§æ€§ï¼ˆVisibilityï¼‰ï¼šå¯è§æ€§æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚ æœ‰åºæ€§ï¼ˆOrderingï¼‰ï¼šå¦‚æœåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼›å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— åºçš„ã€‚å‰åŠå¥æ˜¯æŒ‡â€œçº¿ç¨‹å†…è¡¨ç°ä¸ºä¸²è¡Œçš„è¯­ä¹‰â€ï¼ˆWithin-Thread As-If-Serial Semanticsï¼‰ï¼ŒååŠå¥æ˜¯æŒ‡â€œæŒ‡ä»¤é‡æ’åºâ€ç°è±¡å’Œâ€œå·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜åŒæ­¥å»¶è¿Ÿâ€ç°è±¡ã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","slug":"çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº","permalink":"https://hsb786.github.io/categories/çˆªå“‡/æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"å‡½æ•°å¼çš„æ€è€ƒã€Java8å®æˆ˜ã€‘","slug":"å‡½æ•°å¼çš„æ€è€ƒã€Java8å®æˆ˜ã€‘","date":"2018-05-02T11:28:31.000Z","updated":"2018-05-07T04:35:12.446Z","comments":true,"path":"2018/05/02/å‡½æ•°å¼çš„æ€è€ƒã€Java8å®æˆ˜ã€‘/","link":"","permalink":"https://hsb786.github.io/2018/05/02/å‡½æ•°å¼çš„æ€è€ƒã€Java8å®æˆ˜ã€‘/","excerpt":"å¦‚æœä¸€ä¸ªæ–¹æ³•æ—¢ä¸ä¿®æ”¹å®ƒå†…åµŒç±»çš„çŠ¶æ€ï¼Œä¹Ÿä¸ä¿®æ”¹å…¶ä»–å¯¹è±¡çš„çŠ¶æ€ï¼Œä½¿ç”¨returnè¿”å›æ‰€æœ‰çš„è®¡ç®—ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä¹ˆç§°å…¶ä¸ºçº¯ç²¹çš„æˆ–è€…æ— å‰¯ä½œç”¨çš„","text":"å¦‚æœä¸€ä¸ªæ–¹æ³•æ—¢ä¸ä¿®æ”¹å®ƒå†…åµŒç±»çš„çŠ¶æ€ï¼Œä¹Ÿä¸ä¿®æ”¹å…¶ä»–å¯¹è±¡çš„çŠ¶æ€ï¼Œä½¿ç”¨returnè¿”å›æ‰€æœ‰çš„è®¡ç®—ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä¹ˆç§°å…¶ä¸ºçº¯ç²¹çš„æˆ–è€…æ— å‰¯ä½œç”¨çš„ å‰¯ä½œç”¨å°±æ˜¯å‡½æ•°çš„æ•ˆæœå·²ç»è¶…å‡ºäº†å‡½æ•°è‡ªèº«çš„èŒƒç•´ï¼š é™¤äº†æ„é€ å™¨å†…çš„åˆå§‹åŒ–æ“ä½œï¼Œå¯¹ç±»ä¸­æ•°æ®ç»“æ„çš„ä»»ä½•ä¿®æ”¹ï¼ŒåŒ…æ‹¬å­—æ®µçš„èµ‹å€¼æ“ä½œï¼ˆsetteræ–¹æ³•ï¼‰ æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ è¿›è¡Œè¾“å…¥/è¾“å‡ºæ“ä½œï¼Œæ¯”å¦‚å‘ä¸€ä¸ªæ–‡ä»¶å†™æ•°æ® ä»å¦ä¸€ä¸ªè§’åº¦æ¥çœ‹â€œæ— å‰¯ä½œç”¨â€çš„è¯ï¼Œæˆ‘ä»¬å°±åº”è¯¥è€ƒè™‘ä¸å¯å˜å¯¹è±¡ã€‚ä¸å¯å˜å¯¹è±¡æ˜¯è¿™æ ·ä¸€ç§å¯¹è±¡ï¼Œå®ƒä»¬ä¸€æ—¦å®Œæˆåˆå§‹åŒ–å°±ä¸ä¼šè¢«ä»»ä½•æ–¹æ³•ä¿®æ”¹çŠ¶æ€ã€‚è¿™æ„å‘³ç€ä¸€æ—¦ä¸€ä¸ªä¸å¯å˜å¯¹è±¡åˆå§‹åŒ–å®Œæ¯•ï¼Œå®ƒæ°¸è¿œä¸ä¼šè¿›å…¥åˆ°ä¸€ä¸ªæ— æ³•é¢„æœŸçš„çŠ¶æ€ã€‚ä½ å¯ä»¥æ”¾å¿ƒåœ°å…±äº«å®ƒï¼Œæ— éœ€ä¿ç•™ä»»ä½•å‰¯æœ¬ï¼Œå¹¶ä¸”ç”±äºå®ƒä»¬ä¸ä¼šè¢«ä¿®æ”¹ï¼Œè¿˜æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ å£°æ˜å¼ç¼–ç¨‹ä¸€èˆ¬é€šè¿‡ç¼–ç¨‹å®ç°ä¸€ä¸ªç³»ç»Ÿï¼Œæœ‰ä¸¤ç§æ€è€ƒæ–¹å¼ã€‚ä¸€ç§ä¸“æ³¨äºå¦‚ä½•å®ç°ï¼Œæ¯”å¦‚ï¼šâ€œé¦–å…ˆåšè¿™ä¸ªï¼Œç´§æ¥ç€æ›´æ–°é‚£ä¸ªï¼Œç„¶åâ€¦â€¦.â€ã€‚è¿™ç§â€œå¦‚ä½•åšâ€é£æ ¼çš„ç¼–ç¨‹æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸ºâ€œå‘½ä»¤å¼â€ç¼–ç¨‹12345678Transaction mostExpensive = transactions.get(0); if(mostExpensive == null) throw new IllegalArgumentException(&quot;Empty list of transactions&quot;) for(Transaction t: transactions.subList(1, transactions.size()))&#123; if(t.getValue() &gt; mostExpensive.getValue())&#123; mostExpensive = t; &#125; &#125; å¦ä¸€ç§æ–¹å¼åˆ™æ›´åŠ å…³æ³¨è¦åšä»€ä¹ˆ123Optional&lt;Transaction&gt; mostExpensive = transactions.stream() .max(comparing(Transaction::getValue)); è¿™ä¸ªæŸ¥è¯¢æŠŠæœ€ç»ˆå¦‚ä½•å®ç°çš„ç»†èŠ‚ç•™ç»™äº†å‡½æ•°åº“ã€‚æˆ‘ä»¬æŠŠè¿™ç§æ€æƒ³ç§°ä¹‹ä¸ºå†…éƒ¨è¿­ä»£ã€‚å®ƒçš„å·¨å¤§ä¼˜åŠ¿åœ¨äºä½ çš„æŸ¥è¯¢è¯­å¥ç°åœ¨è¯»èµ·æ¥å°±åƒæ˜¯é—®é¢˜é™ˆè¿°ï¼Œç”±äºé‡‡ç”¨äº†è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±èƒ½ç†è§£å®ƒçš„åŠŸèƒ½ï¼Œæ¯”ç†è§£ä¸€ç³»åˆ—çš„å‘½ä»¤è¦ç®€æ´å¾—å¤š é‡‡ç”¨â€œè¦åšä»€ä¹ˆâ€é£æ ¼çš„ç¼–ç¨‹é€šå¸¸è¢«ç§°ä¸ºå£°æ˜å¼ç¼–ç¨‹ã€‚ä½ æŒ‡å®šè§„åˆ™ï¼Œç»™å‡ºäº†å¸Œæœ›å®ç°çš„ç›®æ ‡ï¼Œè®©ç³»ç»Ÿæ¥å†³å®šå¦‚ä½•å®ç°è¿™ä¸ªç›®æ ‡ã€‚å®ƒå¸¦æ¥çš„å¥½å¤„éå¸¸æ˜æ˜¾ï¼Œç”¨è¿™ç§æ–¹å¼ç¼–å†™çš„ä»£ç æ›´åŠ æ¥è¿‘é—®é¢˜é™ˆè¿°ã€‚ å‡½æ•°å¼ç¼–ç¨‹å…·ä½“å®ç°äº†å‰é¢ä»‹ç»çš„å£°æ˜å¼ç¼–ç¨‹å’Œæ— å‰¯ä½œç”¨è®¡ç®—ã€‚è¿™ä¸¤ä¸ªæ€æƒ³èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å®¹æ˜“åœ°æ„å»ºå’Œç»´æŠ¤ç³»ç»Ÿ ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹å®ƒæ˜¯ä¸€ç§ä½¿ç”¨å‡½æ•°è¿›è¡Œç¼–ç¨‹çš„æ–¹å¼ åœ¨å‡½æ•°å¼ç¼–ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¸€ä¸ªâ€œå‡½æ•°â€å¯¹åº”äºä¸€ä¸ªæ•°å­¦å‡½æ•°ï¼šå®ƒæ¥å—é›¶ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªç»“æœï¼Œå¹¶ä¸”ä¸ä¼šæœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªé»‘ç›’ï¼Œå®ƒæ¥æ”¶è¾“å…¥å¹¶äº§ç”Ÿä¸€äº›è¾“å‡º å½“è°ˆè®ºâ€œå‡½æ•°å¼â€æ—¶ï¼Œæˆ‘ä»¬æƒ³è¯´çš„å…¶å®æ˜¯â€œåƒæ•°å­¦å‡½æ•°é‚£æ ·â€”â€”æ²¡æœ‰å‰¯ä½œç”¨â€ å‡½æ•°å¼Javaç¼–ç¨‹å‡½æ•°å¼Javaç¼–ç¨‹ç¼–ç¨‹å®æˆ˜ä¸­ï¼Œä½ æ˜¯æ— æ³•ç”¨Javaè¯­è¨€ä»¥çº¯ç²¹çš„å‡½æ•°å¼æ¥å®Œæˆä¸€ä¸ªç¨‹åºçš„ã€‚æ¯”å¦‚ï¼ŒJavaçš„I/Oæ¨¡å‹å°±åŒ…å«äº†å¸¦å‰¯ä½œç”¨çš„æ–¹æ³•ï¼ˆè°ƒç”¨Scanner.nextLineå°±æœ‰å‰¯ä½œç”¨ï¼Œå®ƒä¼šä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–ä¸€è¡Œï¼Œé€šå¸¸æƒ…å†µä¸¤æ¬¡è°ƒç”¨çš„ç»“æœå®Œå…¨ä¸åŒï¼‰ã€‚ä¸è¿‡ï¼Œä½ è¿˜æ˜¯æœ‰å¯èƒ½ä¸ºä½ ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ç¼–å†™æ¥è¿‘çº¯ç²¹å‡½æ•°å¼çš„å®ç°ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œå¦‚æœä½ å¸Œæœ›ç¼–å†™å‡½æ•°å¼çš„ç¨‹åºï¼Œé¦–å…ˆéœ€è¦åšçš„æ˜¯ç¡®ä¿æ²¡æœ‰äººèƒ½è§‰å¯Ÿåˆ°ä½ ä»£ç çš„å‰¯ä½œç”¨ï¼Œè¿™ä¹Ÿæ˜¯å‡½æ•°å¼çš„å«ä¹‰ã€‚å‡è®¾è¿™æ ·ä¸€ä¸ªå‡½æ•°æˆ–è€…æ–¹æ³•ï¼Œå®ƒæ²¡æœ‰å‰¯ä½œç”¨ï¼Œè¿›å…¥æ–¹æ³•ä½“æ‰§è¡Œæ—¶ä¼šå¯¹ä¸€ä¸ªå­—æ®µçš„å€¼åŠ ä¸€ï¼Œé€€å‡ºæ–¹æ³•ä½“ä¹‹å‰ä¼šå¯¹è¯¥å­—æ®µå‡ä¸€ã€‚å¯¹ä¸€ä¸ªå•çº¿ç¨‹çš„ç¨‹åºè€Œè¨€ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯æ²¡æœ‰å‰¯ä½œç”¨çš„ï¼Œå¯ä»¥çœ‹ä½œå‡½æ•°å¼çš„å®ç°ã€‚æ¢ä¸ªè§’åº¦è€Œè¨€ï¼Œå¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æŸ¥çœ‹è¯¥å­—æ®µçš„å€¼â€”â€”æˆ–è€…æ›´ç³Ÿç³•çš„æƒ…å†µï¼Œè¯¥æ–¹æ³•ä¼šåŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹å¹¶å‘è°ƒç”¨â€”â€”é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¸èƒ½ç§°ä¹‹ä¸ºå‡½æ•°å¼çš„å®ç°äº†ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥ç”¨åŠ é”çš„æ–¹å¼å¯¹æ–¹æ³•çš„æ–¹æ³•ä½“è¿›è¡Œå°è£…ï¼Œæ©ç›–è¿™ä¸€é—®é¢˜ï¼Œä½ ç”šè‡³å¯ä»¥å†æ¬¡å£°ç§°è¯¥æ–¹æ³•ç¬¦åˆå‡½æ•°å¼çš„çº¦å®šã€‚ä½†æ˜¯ï¼Œè¿™æ ·åšä¹‹åï¼Œä½ å°±å¤±å»äº†åœ¨ä½ çš„å¤šæ ¸å¤„ç†å™¨çš„ä¸¤ä¸ªæ ¸ä¸Šå¹¶å‘æ‰§è¡Œä¸¤ä¸ªæ–¹æ³•è°ƒç”¨çš„èƒ½åŠ›ã€‚å®ƒçš„å‰¯ä½œç”¨å¯¹ç¨‹åºå¯èƒ½æ˜¯ä¸å¯è§çš„ï¼Œä¸è¿‡å¯¹äºç¨‹åºå‘˜ä½ è€Œè¨€æ˜¯å¯è§çš„ï¼Œå› ä¸ºç¨‹åºè¿è¡Œçš„é€Ÿåº¦å˜æ…¢äº†ï¼ æˆ‘ä»¬çš„å‡†åˆ™æ˜¯ï¼Œè¢«ç§°ä¸ºâ€œå‡½æ•°å¼â€çš„å‡½æ•°æˆ–æ–¹æ³•éƒ½åªèƒ½ä¿®æ”¹æœ¬åœ°å˜é‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒå¼•ç”¨çš„å¯¹è±¡éƒ½åº”è¯¥æ˜¯ä¸å¯ä¿®æ”¹çš„å¯¹è±¡ã€‚é€šè¿‡è¿™ç§è§„å®šï¼Œæˆ‘ä»¬æœŸæœ›æ‰€æœ‰çš„å­—æ®µéƒ½ä¸ºfinalç±»å‹ï¼Œæ‰€æœ‰çš„å¼•ç”¨ç±»å‹å­—æ®µéƒ½æŒ‡å‘ä¸å¯å˜å¯¹è±¡ã€‚ æˆ‘ä»¬å‰è¿°çš„å‡†åˆ™æ˜¯ä¸å®Œå¤‡çš„ï¼Œè¦æˆä¸ºçœŸæ­£çš„å‡½æ•°å¼ç¨‹åºè¿˜æœ‰ä¸€ä¸ªé™„åŠ æ¡ä»¶ï¼Œä¸è¿‡å®ƒåœ¨æœ€åˆæ—¶ä¸å¤ªä¸ºå¤§å®¶æ‰€é‡è§†ã€‚è¦è¢«ç§°ä¸ºå‡½æ•°å¼ï¼Œå‡½æ•°æˆ–è€…æ–¹æ³•ä¸åº”è¯¥æŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œæœ‰ä¸€ä¸ªæä¸ºç®€å•è€Œåˆæä¸ºæ•™æ¡çš„è§£é‡Šï¼šä½ ä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºä¸€æ—¦æŠ›å‡ºå¼‚å¸¸ï¼Œå°±æ„å‘³ç€ç»“æœè¢«ç»ˆæ­¢äº†ï¼›ä¸å†åƒæˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„é»‘ç›’æ¨¡å¼é‚£æ ·ï¼Œç”±returnè¿”å›ä¸€ä¸ªæ°å½“çš„ç»“æœå€¼ã€‚ä¸è¿‡ï¼Œè¿™ä¸€è§„åˆ™ä¼¼ä¹åˆå’Œæˆ‘ä»¬å®é™…çš„æ•°å­¦ä½¿ç”¨æœ‰å†²çªï¼šè™½ç„¶åˆæ³•çš„æ•°å­¦å‡½æ•°ä¸ºæ¯ä¸ªåˆæ³•çš„å‚æ•°å€¼è¿”å›ä¸€ä¸ªç¡®å®šçš„ç»“æœï¼Œå¾ˆå¤šé€šç”¨çš„æ•°å­¦æ“ä½œåœ¨ä¸¥æ ¼æ„ä¹‰ä¸Šç§°ä¹‹ä¸ºå±€éƒ¨å‡½æ•°å¼ï¼ˆpartial functionï¼‰å¯èƒ½æ›´ä¸ºå¦¥å½“ã€‚è¿™ç§å‡½æ•°å¯¹äºæŸäº›è¾“å…¥å€¼ï¼Œç”šè‡³æ˜¯å¤§å¤šæ•°çš„è¾“å…¥å€¼éƒ½è¿”å›ä¸€ä¸ªç¡®å®šçš„ç»“æœï¼›ä¸è¿‡å¯¹å¦ä¸€äº›è¾“å…¥å€¼ï¼Œå®ƒçš„ç»“æœæ˜¯æœªå®šä¹‰çš„ï¼Œç”šè‡³ä¸è¿”å›ä»»ä½•ç»“æœã€‚è¿™å…¶ä¸­ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯é™¤æ³•å’Œå¼€å¹³æ–¹è¿ç®—ï¼Œå¦‚æœé™¤æ³•çš„ç¬¬äºŒæ“ä½œæ•°æ˜¯0ï¼Œæˆ–è€…å¼€å¹³æ–¹çš„å‚æ•°ä¸ºè´Ÿæ•°å°±ä¼šå‘ç”Ÿè¿™æ ·çš„æƒ…å†µã€‚ä»¥Javaé‚£æ ·æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸çš„æ–¹å¼å¯¹è¿™äº›æƒ…å†µè¿›è¡Œå»ºæ¨¡çœ‹èµ·æ¥éå¸¸è‡ªç„¶ã€‚è¿™é‡Œå­˜åœ¨ç€ä¸€å®šçš„äº‰æ‰§ï¼Œæœ‰çš„ä½œè€…è®¤ä¸ºæŠ›å‡ºä»£è¡¨ä¸¥é‡é”™è¯¯çš„å¼‚å¸¸æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†æ˜¯æ•è·å¼‚å¸¸æ˜¯ä¸€ç§éå‡½æ•°å¼çš„æ§åˆ¶æµï¼Œå› ä¸ºè¿™ç§æ“ä½œè¿èƒŒäº†æˆ‘ä»¬åœ¨é»‘ç›’æ¨¡å‹ä¸­å®šä¹‰çš„â€œä¼ é€’å‚æ•°ï¼Œè¿”å›ç»“æœâ€çš„è§„åˆ™ï¼Œå¼•å‡ºäº†ä»£è¡¨å¼‚å¸¸å¤„ç†çš„ç¬¬ä¸‰æ”¯ç®­å¤´ é‚£ä¹ˆï¼Œå¦‚æœä¸ä½¿ç”¨å¼‚å¸¸ï¼Œä½ è¯¥å¦‚ä½•å¯¹é™¤æ³•è¿™æ ·çš„å‡½æ•°è¿›è¡Œå»ºæ¨¡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è¯·ä½¿ç”¨Optionalç±»å‹ï¼šä½ åº”è¯¥é¿å…è®©sqrtä½¿ç”¨double sqrt(double)è¿™æ ·çš„å‡½æ•°ç­¾åï¼Œå› ä¸ºè¿™ç§æ–¹å¼å¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼›ä¸ä¹‹ç›¸åæˆ‘ä»¬æ¨èä½ ä½¿ç”¨Optional sqrt(double)â€”â€”è¿™ç§æ–¹å¼ä¸‹ï¼Œå‡½æ•°è¦ä¹ˆè¿”å›ä¸€ä¸ªå€¼è¡¨ç¤ºè°ƒç”¨æˆåŠŸï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨æ˜å…¶æ— æ³•è¿›è¡ŒæŒ‡å®šçš„æ“ä½œã€‚å½“ç„¶ï¼Œè¿™æ„å‘³ç€è°ƒç”¨è€…éœ€è¦æ£€æŸ¥æ–¹æ³•è¿”å›çš„æ˜¯å¦ä¸ºä¸€ä¸ªç©ºçš„Optionalå¯¹è±¡ã€‚è¿™ä»¶äº‹å¬èµ·æ¥ä»£ä»·ä¸å°ï¼Œä¾æ®æˆ‘ä»¬ä¹‹å‰å¯¹å‡½æ•°å¼ç¼–ç¨‹å’Œçº¯ç²¹çš„å‡½æ•°å¼ç¼–ç¨‹çš„æ¯”è¾ƒï¼Œä»å®é™…æ“ä½œçš„è§’åº¦å‡ºå‘ï¼Œä½ å¯ä»¥é€‰æ‹©åœ¨æœ¬åœ°å±€éƒ¨åœ°ä½¿ç”¨å¼‚å¸¸ï¼Œé¿å…é€šè¿‡æ¥å£å°†ç»“æœæš´éœ²ç»™å…¶ä»–æ–¹æ³•ï¼Œè¿™ç§æ–¹å¼æ—¢å–å¾—äº†å‡½æ•°å¼çš„ä¼˜ç‚¹ï¼Œåˆä¸ä¼šè¿‡åº¦è†¨èƒ€ä»£ç ã€‚ æœ€åï¼Œä½œä¸ºå‡½æ•°å¼çš„ç¨‹åºï¼Œä½ çš„å‡½æ•°æˆ–æ–¹æ³•è°ƒç”¨çš„åº“å‡½æ•°å¦‚æœæœ‰å‰¯ä½œç”¨ï¼Œä½ å¿…é¡»è®¾æ³•éšè—å®ƒä»¬çš„éå‡½æ•°å¼è¡Œä¸ºï¼Œå¦åˆ™å°±ä¸èƒ½è°ƒç”¨è¿™äº›æ–¹æ³• å¼•ç”¨é€æ˜æ€§â€œæ²¡æœ‰å¯æ„ŸçŸ¥çš„å‰¯ä½œç”¨â€ï¼ˆä¸æ”¹å˜å¯¹è°ƒç”¨è€…å¯è§çš„å˜é‡ã€ä¸è¿›è¡ŒIOã€ä¸æŠ›å‡ºå¼‚å¸¸ï¼‰çš„è¿™äº›é™åˆ¶éƒ½éšå«ç€å¼•ç”¨é€æ˜æ€§ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°åªè¦ä¼ é€’åŒæ ·çš„å‚æ•°å€¼ï¼Œæ€»æ˜¯è¿”å›åŒæ ·çš„ç»“æœï¼Œé‚£è¿™ä¸ªå‡½æ•°å°±æ˜¯å¼•ç”¨é€æ˜çš„ã€‚String.replaceæ–¹æ³•å°±æ˜¯å¼•ç”¨é€æ˜çš„ï¼Œå› ä¸ºåƒâ€raoulâ€.replace(â€˜râ€™, â€˜Râ€™)è¿™æ ·çš„è°ƒç”¨æ€»æ˜¯è¿”å›åŒæ ·çš„ç»“æœï¼ˆreplaceæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œç”¨å°å†™çš„ræ›¿æ¢æ‰æ‰€æœ‰å¤§å†™çš„Rï¼‰ï¼Œè€Œä¸æ˜¯æ›´æ–°å®ƒçš„thiså¯¹è±¡ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«çœ‹æˆå‡½æ•°å¼çš„ã€‚ å¼•ç”¨é€æ˜æ€§æ˜¯ç†è§£ç¨‹åºçš„ä¸€ä¸ªé‡è¦å±æ€§ã€‚å®ƒè¿˜åŒ…å«äº†å¯¹ä»£ä»·æ˜‚è´µæˆ–è€…éœ€é•¿æ—¶é—´è®¡ç®—æ‰èƒ½å¾—åˆ°ç»“æœçš„å˜é‡å€¼çš„ä¼˜åŒ–ï¼ˆé€šè¿‡ä¿å­˜æœºåˆ¶è€Œä¸æ˜¯é‡å¤è®¡ç®—ï¼‰ï¼Œæˆ‘ä»¬é€šå¸¸å°†å…¶ç§°ä¸ºè®°å¿†åŒ–æˆ–è€…ç¼“å­˜ã€‚ é¢å‘å¯¹è±¡çš„ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹çš„å¯¹æ¯” æç«¯çš„é¢å‘å¯¹è±¡ï¼šä»»ä½•äº‹ç‰©éƒ½æ˜¯å¯¹è±¡ï¼Œç¨‹åºè¦ä¹ˆé€šè¿‡æ›´æ–°å­—æ®µå®Œæˆæ“ä½œï¼Œè¦ä¹ˆè°ƒç”¨å¯¹ä¸å®ƒç›¸å…³çš„å¯¹è±¡è¿›è¡Œæ›´æ–°çš„æ–¹æ³• å¼•ç”¨é€æ˜çš„å‡½æ•°å¼ç¼–ç¨‹ï¼šæ–¹æ³•ä¸åº”è¯¥æœ‰ï¼ˆå¯¹å¤–éƒ¨å¯è§çš„ï¼‰å¯¹è±¡ä¿®æ”¹ å°ç»“ ä»é•¿è¿œçœ‹ï¼Œå‡å°‘å…±äº«çš„å¯å˜æ•°æ®ç»“æ„èƒ½å¸®åŠ©ä½ é™ä½ç»´æŠ¤å’Œè°ƒè¯•ç¨‹åºçš„ä»£ä»· å‡½æ•°å¼ç¼–ç¨‹æ”¯æŒæ— å‰¯ä½œç”¨çš„æ–¹æ³•å’Œå£°æ˜å¼ç¼–ç¨‹ å‡½æ•°å¼æ–¹æ³•å¯ä»¥ç”±å®ƒçš„è¾“å…¥å‚æ•°åŠè¾“å‡ºç»“æœè¿›è¡Œåˆ¤æ–­ å¦‚æœä¸€ä¸ªå‡½æ•°ä½¿ç”¨ç›¸åŒçš„å‚æ•°å€¼è°ƒç”¨ï¼Œæ€»æ˜¯è¿”å›ç›¸åŒçš„ç»“æœï¼Œé‚£ä¹ˆå®ƒæ˜¯å¼•ç”¨é€æ˜çš„","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"é»˜è®¤æ–¹æ³•ã€Java8å®æˆ˜ã€‘","slug":"é»˜è®¤æ–¹æ³•ã€Java8å®æˆ˜ã€‘","date":"2018-05-02T10:27:47.000Z","updated":"2018-05-07T04:36:50.639Z","comments":true,"path":"2018/05/02/é»˜è®¤æ–¹æ³•ã€Java8å®æˆ˜ã€‘/","link":"","permalink":"https://hsb786.github.io/2018/05/02/é»˜è®¤æ–¹æ³•ã€Java8å®æˆ˜ã€‘/","excerpt":"Java8ä¸­çš„æ¥å£ç°åœ¨æ”¯æŒåœ¨å£°æ˜æ–¹æ³•çš„åŒæ—¶æä¾›å®ç°","text":"Java8ä¸­çš„æ¥å£ç°åœ¨æ”¯æŒåœ¨å£°æ˜æ–¹æ³•çš„åŒæ—¶æä¾›å®ç° Java8å…è®¸åœ¨æ¥å£å†…å£°æ˜é™æ€æ–¹æ³• Java8å¼•å…¥äº†ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œå«é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡é»˜è®¤æ–¹æ³•ï¼Œä½ å¯ä»¥æŒ‡å®šæ¥å£æ–¹æ³•çš„é»˜è®¤å®ç° å‘æ¥å£æ·»åŠ æ–¹æ³•æ˜¯è¯¸å¤šé—®é¢˜çš„ç½ªæ¶ä¹‹æºï¼›ä¸€æ—¦æ¥å£å‘ç”Ÿå˜åŒ–ï¼Œå®ç°è¿™äº›æ¥å£çš„ç±»å¾€å¾€ä¹Ÿéœ€è¦æ›´æ–°ï¼Œæä¾›æ–°æ·»æ–¹æ³•çš„å®ç°æ‰èƒ½é€‚é…æ¥å£çš„å˜åŒ–ã€‚å¦‚æœä½ å¯¹æ¥å£ä»¥åŠå®ƒæ‰€æœ‰ç›¸å…³çš„å®ç°æœ‰å®Œå…¨çš„æ§åˆ¶ï¼Œè¿™å¯èƒ½ä¸æ˜¯ä¸ªå¤§é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µæ˜¯æå°‘çš„ã€‚è¿™å°±æ˜¯å¼•å…¥é»˜è®¤æ–¹æ³•çš„ç›®çš„ï¼šå®ƒè®©ç±»å¯ä»¥è‡ªåŠ¨åœ°ç»§æ‰¿æ¥å£çš„ä¸€ä¸ªé»˜è®¤å®ç°ã€‚ é™æ€æ–¹æ³•åŠæ¥å£ åŒæ—¶å®šä¹‰æ¥å£ä»¥åŠå·¥å…·è¾…åŠ©ç±»ï¼ˆcompanion classï¼‰æ˜¯Javaè¯­è¨€å¸¸ç”¨çš„ä¸€ç§æ¨¡å¼ï¼Œå·¥å…·ç±»å®šä¹‰äº†ä¸æ¥å£å®ä¾‹åä½œçš„å¾ˆå¤šé™æ€æ–¹æ³•ã€‚æ¯”å¦‚ï¼ŒCollectionså°±æ˜¯å¤„ç†Collectå¯¹è±¡çš„è¾…åŠ©ç±»ã€‚ç”±äºé™æ€æ–¹æ³•å¯ä»¥å­˜åœ¨äºæ¥å£å†…éƒ¨ï¼Œä½ ä»£ç ä¸­çš„è¿™äº›è¾…åŠ©ç±»å°±æ²¡æœ‰äº†å­˜åœ¨çš„å¿…è¦ï¼Œä½ å¯ä»¥æŠŠè¿™äº›é™æ€æ–¹æ³•è½¬ç§»åˆ°æ¥å£å†…éƒ¨ã€‚ä¸ºäº†ä¿è¯å‘åçš„å…¼å®¹æ€§ï¼Œè¿™äº›ç±»ä¾ç„¶ä¼šå­˜åœ¨ä¸Javaåº”ç”¨ç¨‹åºçš„æ¥å£ä¹‹ä¸­ã€‚ ä¸åŒç±»å‹çš„å…¼å®¹æ€§ï¼šäºŒè¿›åˆ¶ã€æºä»£ç å’Œå‡½æ•°è¡Œä¸º äºŒè¿›åˆ¶çº§çš„å…¼å®¹æ€§ï¼šç°æœ‰çš„äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶èƒ½æ— ç¼æŒç»­é“¾æ¥ï¼ˆåŒ…æ‹¬éªŒè¯ã€å‡†å¤‡å’Œè§£æï¼‰å’Œè¿è¡Œã€‚æ¯”å¦‚ï¼Œä¸ºæ¥å£æ·»åŠ ä¸€ä¸ªæ–¹æ³•å°±æ˜¯äºŒè¿›åˆ¶çº§çš„å…¼å®¹ï¼Œè¿™ç§æ–¹å¼ä¸‹ï¼Œå¦‚æœæ–°æ·»åŠ çš„æ–¹æ³•ä¸è¢«è°ƒç”¨ï¼Œæ¥å£å·²ç»å®ç°çš„æ–¹æ³•å¯ä»¥ç»§ç»­è¿è¡Œï¼Œä¸ä¼šå‡ºç°é”™è¯¯ æºä»£ç çº§çš„å…¼å®¹æ€§ï¼šå¼•å…¥å˜åŒ–ä¹‹åï¼Œç°æœ‰çš„ç¨‹åºä¾ç„¶èƒ½æˆåŠŸç¼–è¯‘é€šè¿‡ã€‚æ¯”å¦‚ï¼Œå‘æ¥å£æ·»åŠ æ–°çš„æ–¹æ³•å°±ä¸æ˜¯æºç çº§çš„å…¼å®¹ï¼Œå› ä¸ºé—ç•™ä»£ç å¹¶æ²¡æœ‰å®ç°æ–°å¼•å…¥çš„æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒä»¬æ— æ³•é¡ºåˆ©é€šè¿‡ç¼–è¯‘ å‡½æ•°è¡Œä¸ºçº§çš„å…¼å®¹æ€§ï¼šå˜æ›´å‘ç”Ÿä¹‹åï¼Œç¨‹åºæ¥å—åŒæ ·çš„è¾“å…¥èƒ½å¾—åˆ°åŒæ ·çš„ç»“æœã€‚æ¯”å¦‚ï¼Œä¸ºæ¥å£æ·»åŠ æ–°çš„æ–¹æ³•å°±æ˜¯å‡½æ•°è¡Œä¸ºå…¼å®¹çš„ï¼Œå› ä¸ºæ–°æ·»åŠ çš„æ–¹æ³•åœ¨ç¨‹åºä¸­å¹¶æœªè¢«è°ƒç”¨ï¼ˆæŠ‘æˆ–è¯¥æ¥å£åœ¨å®ç°ä¸­è¢«è¦†ç›–äº†ï¼‰ é»˜è®¤æ–¹æ³•çš„ä½¿ç”¨æ¨¡å¼å¯é€‰æ–¹æ³•ç±»å®ç°äº†æ¥å£ï¼Œä¸è¿‡å´åˆ»æ„åœ°å°†ä¸€äº›æ–¹æ³•çš„å®ç°ç•™ç™½ã€‚æˆ‘ä»¬ä»¥Iteratoræ¥å£ä¸ºä¾‹æ¥è¯´ã€‚Iteratoræ¥å£å®šä¹‰äº†hasNextã€nextï¼Œè¿˜å®šä¹‰äº†removeæ–¹æ³•ã€‚Java 8ä¹‹å‰ï¼Œç”±äºç”¨æˆ·é€šå¸¸ä¸ä¼šä½¿ç”¨è¯¥æ–¹æ³•ï¼Œremoveæ–¹æ³•å¸¸è¢«å¿½ç•¥ã€‚å› æ­¤ï¼Œå®ç°Interatoræ¥å£çš„ç±»é€šå¸¸ä¼šä¸ºremoveæ–¹æ³•æ”¾ç½®ä¸€ä¸ªç©ºçš„å®ç°ï¼Œè¿™äº›éƒ½æ˜¯äº›æ¯«æ— ç”¨å¤„çš„æ¨¡æ¿ä»£ç ã€‚é‡‡ç”¨é»˜è®¤æ–¹æ³•ä¹‹åï¼Œä½ å¯ä»¥ä¸ºè¿™ç§ç±»å‹çš„æ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤çš„å®ç°ï¼Œè¿™æ ·å®ä½“ç±»å°±æ— éœ€åœ¨è‡ªå·±çš„å®ç°ä¸­æ˜¾å¼åœ°æä¾›ä¸€ä¸ªç©ºæ–¹æ³•ã€‚æ¯”å¦‚ï¼Œåœ¨Java 8ä¸­ï¼ŒIteratoræ¥å£å°±ä¸ºremoveæ–¹æ³•æä¾›äº†ä¸€ä¸ªé»˜è®¤å®ç°ï¼Œå¦‚ä¸‹æ‰€ç¤º1234567interface Iterator&lt;T&gt; &#123; boolean hasNext(); T next(); default void remove() &#123; throw new UnsupportedOperationException(); &#125; &#125; é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å‡å°‘æ— æ•ˆçš„æ¨¡å—ä»£ç ã€‚å®ç°Iteratoræ¥å£çš„æ¯ä¸€ä¸ªç±»éƒ½ä¸éœ€è¦å†å£°æ˜ä¸€ä¸ªç©ºçš„removeæ–¹æ³•äº†ï¼Œå› ä¸ºå®ƒç°åœ¨å·²ç»æœ‰ä¸€ä¸ªé»˜è®¤çš„å®ç° è¡Œä¸ºçš„å¤šç»§æ‰¿è®©ç±»ä»å¤šä¸ªæ¥æºé‡ç”¨ä»£ç  ç»§æ‰¿ä¸åº”è¯¥æˆä¸ºä½ ä¸€è°ˆåˆ°ä»£ç å¤ç”¨å°±è¯•å›¾å€šé çš„ä¸‡ç²¾æ²¹ã€‚æ¯”å¦‚ï¼Œä»ä¸€ä¸ªæ‹¥æœ‰100ä¸ªæ–¹æ³•åŠå­—æ®µçš„ç±»è¿›è¡Œç»§æ‰¿å°±ä¸æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºè¿™å…¶å®ä¼šå¼•å…¥ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚ä½ å®Œå…¨å¯ä»¥ä½¿ç”¨ä»£ç†æœ‰æ•ˆåœ°è§„é¿è¿™ç§çª˜å¢ƒï¼Œå³åˆ›å»ºä¸€ä¸ªæ–¹æ³•é€šè¿‡è¯¥ç±»çš„æˆå‘˜å˜é‡ç›´æ¥è°ƒç”¨è¯¥ç±»çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰çš„æ—¶å€™æˆ‘ä»¬å‘ç°æœ‰äº›ç±»è¢«åˆ»æ„åœ°å£°æ˜ä¸ºfinalç±»å‹ï¼šå£°æ˜ä¸ºfinalçš„ç±»ä¸èƒ½è¢«å…¶ä»–çš„ç±»ç»§æ‰¿ï¼Œé¿å…å‘ç”Ÿè¿™æ ·çš„åæ¨¡å¼ï¼Œé˜²æ­¢æ ¸å¿ƒä»£ç çš„åŠŸèƒ½è¢«æ±¡æŸ“ã€‚æ³¨æ„ï¼Œæœ‰çš„æ—¶å€™å£°æ˜ä¸ºfinalçš„ç±»éƒ½ä¼šæœ‰å…¶ä¸åŒçš„åŸå› ï¼Œæ¯”å¦‚ï¼ŒStringç±»è¢«å£°æ˜ä¸ºfinalï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›æœ‰äººå¯¹è¿™æ ·çš„æ ¸å¿ƒåŠŸèƒ½äº§ç”Ÿå¹²æ‰°ã€‚ è§£å†³å†²çªçš„è§„åˆ™éšç€é»˜è®¤æ–¹æ³•åœ¨Java8ä¸­å¼•å…¥ï¼Œæœ‰å¯èƒ½å‡ºç°ä¸€ä¸ªç±»ç»§æ‰¿äº†å¤šä¸ªæ–¹æ³•è€Œå®ƒä»¬ä½¿ç”¨çš„å´æ˜¯åŒæ ·çš„å‡½æ•°ç­¾åã€‚é€šè¿‡ä¸‰æ¡è§„åˆ™å¯ä»¥è¿›è¡Œåˆ¤æ–­ï¼š ç±»ä¸­çš„æ–¹æ³•ä¼˜å…ˆçº§æœ€é«˜ï¼Œç±»æˆ–çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•çš„ä¼˜å…ˆçº§é«˜äºä»»ä½•å£°æ˜ä¸ºé»˜è®¤æ–¹æ³•çš„ä¼˜å…ˆçº§ å¦‚æœæ— æ³•ä¾æ®ç¬¬ä¸€æ¡è¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆå­æ¥å£çš„ä¼˜å…ˆçº§æœ€é«˜ï¼šå‡½æ•°ç­¾åç›¸åŒæ—¶ï¼Œä¼˜å…ˆé€‰æ‹©æ‹¥æœ‰æœ€å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•çš„æ¥å£ï¼Œå³å¦‚æœBç»§æ‰¿äº†Aï¼Œé‚£ä¹ˆBå°±æ¯”Aæ›´åŠ å…·ä½“ æœ€åï¼Œå¦‚æœè¿˜æ˜¯æ— æ³•åˆ¤æ–­ï¼Œç»§æ‰¿äº†å¤šä¸ªæ¥å£çš„ç±»å¿…é¡»é€šè¿‡æ˜¾ç¤ºè¦†ç›–å’Œè°ƒç”¨æœŸæœ›çš„æ–¹æ³•ï¼Œæ˜¾ç¤ºåœ°é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªé»˜è®¤æ–¹æ³•çš„å®ç° æ€»ç»“ Java8ä¸­çš„æ¥å£å¯ä»¥é€šè¿‡é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•æä¾›å®ç° é»˜è®¤æ–¹æ³•çš„å¼€å¤´ä»¥å…³é”®å­—defaultä¿®é¥°ï¼Œæ–¹æ³•ä½“ä¸å¸¸è§„çš„ç±»æ–¹æ³•ç›¸åŒ å‘å‘å¸ƒçš„æ¥å£æ·»åŠ æŠ½è±¡æ–¹æ³•ä¸æ˜¯æºç å…¼å®¹çš„ é»˜è®¤æ–¹æ³•çš„å‡ºç°èƒ½å¸®åŠ©åº“çš„è®¾è®¡è€…ä»¥åå‘å…¼å®¹çš„æ–¹å¼æ¼”è¿›API é»˜è®¤æ–¹æ³•å¯ä»¥ç”¨äºåˆ›å»ºå¯é€‰æ–¹æ³•å’Œè¡Œä¸ºçš„å¤šç»§æ‰¿ ç±»æˆ–è€…çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•çš„ä¼˜å…ˆçº§é«˜äºä»»ä½•é»˜è®¤æ–¹æ³•ã€‚å¦‚æœå‰ä¸€æ¡æ— æ³•è§£å†³å†²çªï¼Œé‚£å°±é€‰æ‹©åŒå‡½æ•°ç­¾åçš„æ–¹æ³•ä¸­å®ç°å¾—æœ€å…·ä½“çš„é‚£ä¸ªæ¥å£çš„æ–¹æ³• ä¸¤ä¸ªé»˜è®¤æ–¹æ³•éƒ½åŒæ ·å…·ä½“æ—¶ï¼Œä½ éœ€è¦åœ¨ç±»ä¸­è¦†ç›–è¯¥æ–¹æ³•ï¼Œæ˜¾ç¤ºåœ°é€‰æ‹©ä½¿ç”¨å“ªä¸ªæ¥å£ä¸­æä¾›çš„æ–¹æ³•","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"é‡æ„ã€Java8å®æˆ˜ã€‘","slug":"é‡æ„ã€Java8å®æˆ˜ã€‘","date":"2018-05-02T07:11:48.000Z","updated":"2018-05-02T10:26:53.042Z","comments":true,"path":"2018/05/02/é‡æ„ã€Java8å®æˆ˜ã€‘/","link":"","permalink":"https://hsb786.github.io/2018/05/02/é‡æ„ã€Java8å®æˆ˜ã€‘/","excerpt":"åˆ©ç”¨Java8çš„å„ç§ç‰¹æ€§æ›´æœ‰æ•ˆåœ°æ”¹å–„ä»£ç è´¨é‡","text":"åˆ©ç”¨Java8çš„å„ç§ç‰¹æ€§æ›´æœ‰æ•ˆåœ°æ”¹å–„ä»£ç è´¨é‡ ä»åŒ¿åç±»åˆ°Lambdaè¡¨è¾¾å¼çš„è½¬æ¢åŒ¿åç±»æå…¶ç¹çä¸”å®¹æ˜“å‡ºé”™ï¼›é‡‡ç”¨Lambdaè¡¨è¾¾å¼ä¹‹åï¼Œä½ çš„ä»£ç ä¼šæ›´ç®€æ´ï¼Œå¯è¯»æ€§æ›´å¥½ ä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œå°†åŒ¿åç±»è½¬æ¢æˆLambdaè¡¨è¾¾å¼å¯èƒ½æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„è¿‡ç¨‹ã€‚é¦–å…ˆï¼ŒåŒ¿åç±»å’ŒLambdaè¡¨è¾¾å¼ä¸­çš„thiså’Œsuperçš„å«ä¹‰æ˜¯ä¸åŒçš„ã€‚åœ¨åŒ¿åç±»ä¸­ï¼Œthisä»£è¡¨çš„æ˜¯ç±»è‡ªèº«ï¼Œä½†æ˜¯åœ¨Lambdaä¸­ï¼Œå®ƒä»£è¡¨çš„æ˜¯åŒ…å«ç±»ã€‚å…¶æ¬¡ï¼ŒåŒ¿åç±»å¯ä»¥å±è”½åŒ…å«ç±»çš„å¸¸é‡ï¼Œè€ŒLambdaè¡¨è¾¾å¼ä¸èƒ½ï¼ˆå®ƒä»¬ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼‰ 12345678910111213int a = 10; Runnable r1 = () -&gt; &#123; //ç¼–è¯‘é”™è¯¯ int a = 2; System.out.println(a); &#125;; Runnable r2 = new Runnable()&#123; public void run()&#123; //ä¸€åˆ‡æ­£å¸¸ int a = 2; System.out.println(a); &#125; &#125;; æœ€åï¼Œåœ¨æ¶‰åŠé‡è½½çš„ä¸Šä¸‹æ–‡é‡Œï¼Œå°†åŒ¿åç±»è½¬æ¢ä¸ºLambdaè¡¨è¾¾å¼å¯èƒ½å¯¼è‡´æœ€ç»ˆçš„ä»£ç æ›´åŠ æ™¦æ¶©ã€‚å®é™…ä¸Šï¼ŒåŒ¿åç±»çš„ç±»å‹æ˜¯åœ¨åˆå§‹åŒ–æ—¶ç¡®å®šçš„ï¼Œè€ŒLambdaçš„ç±»å‹ã€‚1234567891011121314151617181920//å®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£interface Task&#123; public void execute(); &#125; public static void doSomething(Runnable r)&#123; r.run(); &#125; public static void doSomething(Task a)&#123; a.execute(); &#125; //ä½¿ç”¨åŒ¿åç±»å®ç°çš„Taskï¼Œä¸€åˆ‡æ­£å¸¸doSomething(new Task() &#123; public void execute() &#123; System.out.println(&quot;Danger danger!!&quot;); &#125; &#125;); //ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ—¶ï¼ŒdoSome-thing(Runnable)å’ŒdoSomething(Task)éƒ½åŒ¹é…è¯¥ç±»å‹doSomething(() -&gt; System.out.println(&quot;Danger danger!!&quot;)); //ä½ å¯ä»¥å¯¹Taskå°è¯•ä½¿ç”¨æ˜¾å¼çš„ç±»å‹è½¬æ¢æ¥è§£å†³è¿™ç§æ¨¡æ£±ä¸¤å¯çš„æƒ…å†µï¼šdoSomething((Task)() -&gt; System.out.println(&quot;Danger danger!!&quot;)); ä½¿ç”¨Lambdaé‡æ„é¢å‘å¯¹è±¡çš„è®¾è®¡æ¨¡å¼ç­–ç•¥æ¨¡å¼ç­–ç•¥æ¨¡å¼ä»£è¡¨äº†è§£å†³ä¸€ç±»ç®—æ³•çš„é€šç”¨è§£å†³æ–¹æ¡ˆï¼Œä½ å¯ä»¥åœ¨è¿è¡Œæ—¶é€‰æ‹©ä½¿ç”¨å“ªç§æ–¹æ¡ˆ ç­–ç•¥æ¨¡å¼åŒ…å«ä¸‰éƒ¨åˆ†å†…å®¹ ä¸€ä¸ªä»£è¡¨æŸä¸ªç®—æ³•çš„æ¥å£ï¼ˆå®ƒæ˜¯ç­–ç•¥æ¨¡å¼çš„æ¥å£ï¼‰ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ªè¯¥æ¥å£çš„å…·ä½“å®ç°ï¼Œå®ƒä»¬ä»£è¡¨äº†ç®—æ³•çš„å¤šç§å®ç°ï¼ˆæ¯”å¦‚ï¼Œå®ä½“ç±»Concrete- StrategyAæˆ–è€…ConcreteStrategyBï¼‰ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ªä½¿ç”¨ç­–ç•¥å¯¹è±¡çš„å®¢æˆ·ã€‚ æˆ‘ä»¬å‡è®¾ä½ å¸Œæœ›éªŒè¯è¾“å…¥çš„å†…å®¹æ˜¯å¦æ ¹æ®æ ‡å‡†è¿›è¡Œäº†æ°å½“çš„æ ¼å¼åŒ–ï¼ˆæ¯”å¦‚åªåŒ…å«å°å†™å­—æ¯æˆ–æ•°å­—ï¼‰ã€‚ä½ å¯ä»¥ä»å®šä¹‰ä¸€ä¸ªéªŒè¯æ–‡æœ¬ï¼ˆä»¥Stringçš„å½¢å¼è¡¨ç¤ºï¼‰çš„æ¥å£å…¥æ‰‹123public interface ValidationStrategy &#123; boolean execute(String s); &#125; å…¶æ¬¡ï¼Œä½ å®šä¹‰äº†è¯¥æ¥å£çš„ä¸€ä¸ªæˆ–å¤šä¸ªå…·ä½“å®ç°ï¼š12345678910public class IsAllLowerCase implements ValidationStrategy &#123; public boolean execute(String s)&#123; return s.matches(&quot;[a-z]+&quot;); &#125; &#125; public class IsNumeric implements ValidationStrategy &#123; public boolean execute(String s)&#123; return s.matches(&quot;\\\\d+&quot;); &#125; &#125; ä¹‹åï¼Œä½ å°±å¯ä»¥åœ¨ä½ çš„ç¨‹åºä¸­ä½¿ç”¨è¿™äº›ç•¥æœ‰å·®å¼‚çš„éªŒè¯ç­–ç•¥äº†ï¼š1234567891011121314public class Validator&#123; private final ValidationStrategy strategy; public Validator(ValidationStrategy v)&#123; this.strategy = v; &#125; public boolean validate(String s)&#123; return strategy.execute(s); &#125; &#125; Validator numericValidator = new Validator(new IsNumeric()); boolean b1 = numericValidator.validate(&quot;aaaa&quot;); Validator lowerCaseValidator = new Validator(new IsAllLowerCase ()); boolean b2 = lowerCaseValidator.validate(&quot;bbbb&quot;); ValidationStrategyæ˜¯ä¸€ä¸ªå‡½æ•°æ¥å£äº†ï¼ˆé™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜ä¸Predicateå…·æœ‰åŒæ ·çš„å‡½æ•°æè¿°ï¼‰ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦å£°æ˜æ–°çš„ç±»æ¥å®ç°ä¸åŒçš„ç­–ç•¥ï¼Œé€šè¿‡ç›´æ¥ä¼ é€’Lambdaè¡¨è¾¾å¼å°±èƒ½è¾¾åˆ°åŒæ ·çš„ç›®çš„ï¼Œå¹¶ä¸”è¿˜æ›´ç®€æ´123456Validator numericValidator = new Validator((String s) -&gt; s.matches(&quot;[a-z]+&quot;)); boolean b1 = numericValidator.validate(&quot;aaaa&quot;); Validator lowerCaseValidator = new Validator((String s) -&gt; s.matches(&quot;\\\\d+&quot;)); boolean b2 = lowerCaseValidator.validate(&quot;bbbb&quot;); æ¨¡æ¿æ–¹æ³•å¦‚æœä½ éœ€è¦é‡‡ç”¨æŸä¸ªç®—æ³•çš„æ¡†æ¶ï¼ŒåŒæ—¶åˆå¸Œæœ›æœ‰ä¸€å®šçš„çµæ´»åº¦ï¼Œèƒ½å¯¹å®ƒçš„æŸäº›éƒ¨åˆ†è¿›è¡Œæ”¹è¿›ï¼Œé‚£ä¹ˆé‡‡ç”¨æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼æ˜¯æ¯”è¾ƒé€šç”¨çš„æ–¹æ¡ˆã€‚å®šä¹‰ï¼šè§„å®šä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚ å‡è®¾ä½ éœ€è¦ç¼–å†™ä¸€ä¸ªç®€å•çš„åœ¨çº¿é“¶è¡Œåº”ç”¨ã€‚é€šå¸¸ï¼Œ ç”¨æˆ·éœ€è¦è¾“å…¥ä¸€ä¸ªç”¨æˆ·è´¦æˆ·ï¼Œä¹‹ååº”ç”¨æ‰èƒ½ä»é“¶è¡Œçš„æ•°æ®åº“ä¸­å¾—åˆ°ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼Œæœ€ç»ˆå®Œæˆä¸€äº›è®©ç”¨æˆ·æ»¡æ„çš„æ“ä½œã€‚ä¸åŒåˆ†è¡Œçš„åœ¨çº¿é“¶è¡Œåº”ç”¨è®©å®¢æˆ·æ»¡æ„çš„æ–¹å¼å¯èƒ½è¿˜ç•¥æœ‰ä¸åŒï¼Œæ¯”å¦‚ç»™å®¢æˆ·çš„è´¦æˆ·å‘æ”¾çº¢åˆ©ï¼Œæˆ–è€…ä»…ä»…æ˜¯å°‘å‘é€ä¸€äº›æ¨å¹¿æ–‡ä»¶ã€‚ä½ å¯èƒ½é€šè¿‡ä¸‹é¢çš„æŠ½è±¡ç±»æ–¹å¼æ¥å®ç°åœ¨çº¿é“¶è¡Œåº”ç”¨ï¼š1234567abstract class OnlineBanking &#123; public void processCustomer(int id)&#123; Customer c = Database.getCustomerWithId(id); makeCustomerHappy(c); &#125; abstract void makeCustomerHappy(Customer c); &#125; processCustomeræ–¹æ³•æ­å»ºäº†åœ¨çº¿é“¶è¡Œç®—æ³•çš„æ¡†æ¶ï¼šè·å–å®¢æˆ·æä¾›çš„IDï¼Œç„¶åæä¾›æœåŠ¡è®©ç”¨æˆ·æ»¡æ„ã€‚ä¸åŒçš„æ”¯è¡Œå¯ä»¥é€šè¿‡ç»§æ‰¿OnlineBankingç±»ï¼Œå¯¹è¯¥æ–¹æ³•æä¾›å·®å¼‚åŒ–çš„å®ç°ã€‚ ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼š1234public void processCustomer(int id, Consumer&lt;Customer&gt; makeCustomerHappy)&#123; Customer c = Database.getCustomerWithId(id); makeCustomerHappy.accept(c); &#125; ç°åœ¨ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°é€šè¿‡ä¼ é€’Lambdaè¡¨è¾¾å¼ï¼Œç›´æ¥æ’å…¥ä¸åŒçš„è¡Œä¸ºï¼Œä¸å†éœ€è¦ç»§æ‰¿OnlineBankingç±»äº†ï¼š12new OnlineBankingLambda().processCustomer(1337, (Customer c) -&gt; System.out.println(&quot;Hello &quot; + c.getName()); è§‚å¯Ÿè€…æ¨¡å¼è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„æ–¹æ¡ˆï¼ŒæŸäº›äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚çŠ¶æ€è½¬å˜ï¼‰ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ï¼ˆé€šå¸¸æˆ‘ä»¬ç§°ä¹‹ä¸ºä¸»é¢˜ï¼‰éœ€è¦è‡ªåŠ¨åœ°é€šçŸ¥å…¶ä»–å¤šä¸ªå¯¹ï¼ˆç§°ä¸ºè§‚å¯Ÿè€…ï¼‰ï¼Œå°±ä¼šé‡‡ç”¨è¯¥æ–¹æ¡ˆ ä½ éœ€è¦ä¸ºTwitterè¿™æ ·çš„åº”ç”¨è®¾è®¡å¹¶å®ç°ä¸€ä¸ªå®šåˆ¶åŒ–çš„é€šçŸ¥ç³»ç»Ÿã€‚æƒ³æ³•å¾ˆç®€å•ï¼šå¥½å‡ å®¶æŠ¥çº¸æœºæ„ï¼Œæ¯”å¦‚ã€Šçº½çº¦æ—¶æŠ¥ã€‹ã€Šå«æŠ¥ã€‹ä»¥åŠã€Šä¸–ç•ŒæŠ¥ã€‹éƒ½è®¢é˜…äº†æ–°é—»ï¼Œä»–ä»¬å¸Œæœ›å½“æ¥æ”¶çš„æ–°é—»ä¸­åŒ…å«ä»–ä»¬æ„Ÿå…´è¶£çš„å…³é”®å­—æ—¶ï¼Œèƒ½å¾—åˆ°ç‰¹åˆ«é€šçŸ¥ã€‚ é¦–å…ˆï¼Œä½ éœ€è¦ä¸€ä¸ªè§‚å¯Ÿè€…æ¥å£ï¼Œå®ƒå°†ä¸åŒçš„è§‚å¯Ÿè€…èšåˆåœ¨ä¸€èµ·ã€‚å®ƒä»…æœ‰ä¸€ä¸ªåä¸ºnotifyçš„æ–¹æ³•ï¼Œä¸€æ—¦æ¥æ”¶åˆ°ä¸€æ¡æ–°çš„æ–°é—»ï¼Œè¯¥æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼š123interface Observer &#123; void notify(String tweet); &#125; ç°åœ¨ï¼Œä½ å¯ä»¥å£°æ˜ä¸åŒçš„è§‚å¯Ÿè€…ï¼ˆæ¯”å¦‚ï¼Œè¿™é‡Œæ˜¯ä¸‰å®¶ä¸åŒçš„æŠ¥çº¸æœºæ„ï¼‰ï¼Œä¾æ®æ–°é—»ä¸­ä¸åŒçš„å…³é”®å­—åˆ†åˆ«å®šä¹‰ä¸åŒçš„è¡Œä¸ºï¼š123456789101112131415161718192021class NYTimes implements Observer&#123; public void notify(String tweet) &#123; if(tweet != null &amp;&amp; tweet.contains(&quot;money&quot;))&#123; System.out.println(&quot;Breaking news in NY! &quot; + tweet); &#125; &#125; &#125; class Guardian implements Observer&#123; public void notify(String tweet) &#123; if(tweet != null &amp;&amp; tweet.contains(&quot;queen&quot;))&#123; System.out.println(&quot;Yet another news in London... &quot; + tweet); &#125; &#125; &#125; class LeMonde implements Observer&#123; public void notify(String tweet) &#123; if(tweet != null &amp;&amp; tweet.contains(&quot;wine&quot;))&#123; System.out.println(&quot;Today cheese, wine and news! &quot; + tweet); &#125; &#125; &#125; 1234interface Subject&#123; void registerObserver(Observer o); void notifyObservers(String tweet); &#125; Subjectä½¿ç”¨registerObserveræ–¹æ³•å¯ä»¥æ³¨å†Œä¸€ä¸ªæ–°çš„è§‚å¯Ÿè€…ï¼Œä½¿ç”¨notifyObserversæ–¹æ³•é€šçŸ¥å®ƒçš„è§‚å¯Ÿè€…ä¸€ä¸ªæ–°é—»çš„åˆ°æ¥ã€‚123456789class Feed implements Subject&#123; private final List&lt;Observer&gt; observers = new ArrayList&lt;&gt;(); public void registerObserver(Observer o) &#123; this.observers.add(o); &#125; public void notifyObservers(String tweet) &#123; observers.forEach(o -&gt; o.notify(tweet)); &#125; &#125; Feedç±»åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè§‚å¯Ÿè€…åˆ—è¡¨ï¼Œä¸€æ¡æ–°é—»åˆ°è¾¾æ—¶ï¼Œå®ƒå°±è¿›è¡Œé€šçŸ¥ã€‚12345Feed f = new Feed(); f.registerObserver(new NYTimes()); f.registerObserver(new Guardian()); f.registerObserver(new LeMonde()); f.notifyObservers(&quot;The queen said her favourite book is Java 8 in Action!&quot;); Observeræ¥å£çš„æ‰€æœ‰å®ç°ç±»éƒ½æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼šnotifyã€‚æ–°é—»åˆ°è¾¾æ—¶ï¼Œå®ƒä»¬éƒ½åªæ˜¯å¯¹åŒä¸€æ®µä»£ç å°è£…æ‰§è¡Œã€‚Lambdaè¡¨è¾¾å¼çš„è®¾è®¡åˆè¡·å°±æ˜¯è¦æ¶ˆé™¤è¿™æ ·çš„åƒµåŒ–ä»£ç 12345678910f.registerObserver((String tweet) -&gt; &#123; if(tweet != null &amp;&amp; tweet.contains(&quot;money&quot;))&#123; System.out.println(&quot;Breaking news in NY! &quot; + tweet); &#125; &#125;); f.registerObserver((String tweet) -&gt; &#123; if(tweet != null &amp;&amp; tweet.contains(&quot;queen&quot;))&#123; System.out.println(&quot;Yet another news in London... &quot; + tweet); &#125; &#125;); é‚£ä¹ˆï¼Œæ˜¯å¦æˆ‘ä»¬éšæ—¶éšåœ°éƒ½å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼æˆ‘ä»¬å‰æ–‡ä»‹ç»çš„ä¾‹å­ä¸­ï¼ŒLambdaé€‚é…å¾—å¾ˆå¥½ï¼Œé‚£æ˜¯å› ä¸ºéœ€è¦æ‰§è¡Œçš„åŠ¨ä½œéƒ½å¾ˆç®€å•ï¼Œå› æ­¤æ‰èƒ½å¾ˆæ–¹ä¾¿åœ°æ¶ˆé™¤åƒµåŒ–ä»£ç ã€‚ä½†æ˜¯ï¼Œè§‚å¯Ÿè€…çš„é€»è¾‘æœ‰å¯èƒ½ååˆ†å¤æ‚ï¼Œå®ƒä»¬å¯èƒ½è¿˜æŒæœ‰çŠ¶æ€ï¼ŒæŠ‘æˆ–å®šä¹‰äº†å¤šä¸ªæ–¹æ³•ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚åœ¨è¿™äº›æƒ…å½¢ä¸‹ï¼Œä½ è¿˜æ˜¯åº”è¯¥ç»§ç»­ä½¿ç”¨ç±»çš„æ–¹å¼ã€‚ è´£ä»»é“¾æ¨¡å¼è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå¤„ç†å¯¹è±¡åºåˆ—ï¼ˆæ¯”å¦‚æ“ä½œåºåˆ—ï¼‰çš„é€šç”¨æ–¹æ¡ˆã€‚ä¸€ä¸ªå¤„ç†å¯¹è±¡å¯èƒ½éœ€è¦åœ¨å®Œæˆä¸€äº›å·¥ä½œä¹‹åï¼Œå°†ç»“æœä¼ é€’ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ¥ç€åšä¸€äº›å·¥ä½œï¼Œå†è½¬äº¤ç»™ä¸‹ä¸€ä¸ªå¤„ç†å¯¹è±¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚ è¿™å°±æ˜¯ä¹‹å‰ä»‹ç»çš„æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ã€‚handleæ–¹æ³•æä¾›äº†å¦‚ä½•è¿›è¡Œå·¥ä½œå¤„ç†çš„æ¡†æ¶ã€‚ä¸åŒçš„å¤„ç†å¯¹è±¡å¯ä»¥é€šè¿‡ç»§æ‰¿ProcessingObjectç±»ï¼Œæä¾›handleWorkæ–¹æ³•æ¥è¿›è¡Œåˆ›å»ºã€‚1234567891011121314public abstract class ProcessingObject&lt;T&gt; &#123; protected ProcessingObject&lt;T&gt; successor; public void setSuccessor(ProcessingObject&lt;T&gt; successor)&#123; this.successor = successor; &#125; public T handle(T input)&#123; T r = handleWork(input); if(successor != null)&#123; return successor.handle(r); &#125; return r; &#125; abstract protected T handleWork(T input); &#125; 12345public class HeaderTextProcessing extends ProcessingObject&lt;String&gt; &#123; public String handleWork(String text)&#123; return &quot;From Raoul, Mario and Alan: &quot; + text; &#125; &#125; 123456ProcessingObject&lt;String&gt; p1 = new HeaderTextProcessing(); ProcessingObject&lt;String&gt; p2 = new SpellCheckerProcessing(); p1.setSuccessor(p2);String result = p1.handle(&quot;Aren&apos;t labdas really sexy?!!&quot;); System.out.println(result); //æ‰“å°è¾“å‡ºâ€œFrom Raoul, Marioand Alan: Aren&apos;t lambdas reallysexy?!!â€ ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼š1234567UnaryOperator&lt;String&gt; headerProcessing = (String text) -&gt; &quot;From Raoul, Mario and Alan: &quot; + text;UnaryOperator&lt;String&gt; spellCheckerProcessing = (String text) -&gt; text.replaceAll(&quot;labda&quot;, &quot;lambda&quot;); Function&lt;String, String&gt; pipeline = headerProcessing.andThen(spellCheckerProcessing); String result = pipeline.apply(&quot;Aren&apos;t labdas really sexy?!!&quot;); å·¥å‚æ¨¡å¼ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œä½ æ— éœ€å‘å®¢æˆ·æš´éœ²å®ä¾‹åŒ–çš„é€»è¾‘å°±èƒ½å®Œæˆå¯¹è±¡çš„åˆ›å»ºã€‚ 12345678910public class ProductFactory &#123; public static Product createProduct(String name)&#123; switch(name)&#123; case &quot;loan&quot;: return new Loan(); case &quot;stock&quot;: return new Stock(); case &quot;bond&quot;: return new Bond(); default: throw new RuntimeException(&quot;No such product &quot; + name); &#125; &#125; &#125; è¿™é‡Œè´·æ¬¾ï¼ˆLoanï¼‰ã€è‚¡ç¥¨ï¼ˆStockï¼‰å’Œå€ºåˆ¸ï¼ˆBondï¼‰éƒ½æ˜¯äº§å“ï¼ˆProductï¼‰çš„å­ç±»ã€‚createProductæ–¹æ³•å¯ä»¥é€šè¿‡é™„åŠ çš„é€»è¾‘æ¥è®¾ç½®æ¯ä¸ªåˆ›å»ºçš„äº§å“ã€‚ä½†æ˜¯å¸¦æ¥çš„å¥½å¤„ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œä½ åœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¸ç”¨å†æ‹…å¿ƒä¼šå°†æ„é€ å‡½æ•°æˆ–è€…é…ç½®æš´éœ²ç»™å®¢æˆ·ï¼Œè¿™ä½¿å¾—å®¢æˆ·åˆ›å»ºäº§å“æ—¶æ›´åŠ ç®€å•1Product p = ProductFactory.createProduct(&quot;loan&quot;); ä½¿ç”¨Lambdaè¡¨è¾¾å¼123456789101112final static Map&lt;String, Supplier&lt;Product&gt;&gt; map = new HashMap&lt;&gt;(); static &#123; map.put(&quot;loan&quot;, Loan::new); map.put(&quot;stock&quot;, Stock::new); map.put(&quot;bond&quot;, Bond::new); &#125; public static Product createProduct(String name)&#123; Supplier&lt;Product&gt; p = map.get(name); if(p != null) return p.get(); throw new IllegalArgumentException(&quot;No such product &quot; + name); &#125;","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"å¹¶è¡Œæµã€java8å®æˆ˜ã€‘","slug":"å¹¶è¡Œæµã€java8å®æˆ˜ã€‘","date":"2018-04-30T13:14:14.000Z","updated":"2018-04-30T13:36:50.196Z","comments":true,"path":"2018/04/30/å¹¶è¡Œæµã€java8å®æˆ˜ã€‘/","link":"","permalink":"https://hsb786.github.io/2018/04/30/å¹¶è¡Œæµã€java8å®æˆ˜ã€‘/","excerpt":"å¹¶è¡Œæµå°±æ˜¯ä¸€ä¸ªæŠŠå†…å®¹åˆ†æˆå¤šä¸ªæ•°æ®å—ï¼Œå¹¶ç”¨ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å¤„ç†æ¯ä¸ªæ•°æ®å—çš„æµ","text":"å¹¶è¡Œæµå°±æ˜¯ä¸€ä¸ªæŠŠå†…å®¹åˆ†æˆå¤šä¸ªæ•°æ®å—ï¼Œå¹¶ç”¨ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å¤„ç†æ¯ä¸ªæ•°æ®å—çš„æµ åœ¨Java7ä¹‹å‰ï¼Œå¹¶è¡Œå¤„ç†æ•°æ®é›†åˆéå¸¸éº»çƒ¦ ç¬¬ä¸€ï¼Œä½ å¾—æ˜ç¡®åœ°æŠŠåŒ…å«æ•°æ®çš„æ•°æ®ç»“æ„åˆ†æˆè‹¥å¹²å­éƒ¨åˆ† ç¬¬äºŒï¼Œä½ è¦æŠŠæ¯ä¸ªå­éƒ¨åˆ†åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ ç¬¬ä¸‰ï¼Œä½ éœ€è¦åœ¨æ°å½“çš„æ—¶å€™å¯¹å®ƒä»¬è¿›è¡ŒåŒæ­¥æ¥é¿å…ä¸å¸Œæœ›å‡ºç°çš„ç«äº‰æ¡ä»¶ï¼Œç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆï¼Œæœ€åæŠŠè¿™äº›éƒ¨åˆ†ç»“æœåˆå¹¶èµ·æ¥ å¹¶è¡Œæµå¯ä»¥é€šè¿‡å¯¹æ”¶é›†æºè°ƒç”¨parallelStreamæ–¹æ³•æ¥æŠŠé›†åˆè½¬æ¢ä¸ºå¹¶è¡Œæµ å¯¹é¡ºåºæµè°ƒç”¨parallelæ–¹æ³•123456public static long parallelSum(long n) &#123; return Stream.iterate(1L, i -&gt; i + 1) .limit(n) .parallel() .reduce(0L, Long::sum); &#125; è¯·æ³¨æ„ï¼Œåœ¨ç°å®ä¸­ï¼Œå¯¹é¡ºåºæµè°ƒç”¨parallelæ–¹æ³•å¹¶ä¸æ„å‘³ç€æµæœ¬èº«æœ‰ä»»ä½•å®é™…çš„å˜åŒ–ã€‚å®ƒåœ¨å†…éƒ¨å®é™…ä¸Šå°±æ˜¯è®¾äº†ä¸€ä¸ªbooleanæ ‡å¿—ï¼Œè¡¨ç¤ºä½ æƒ³è®©è°ƒç”¨parallelä¹‹åè¿›è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½å¹¶è¡Œæ‰§è¡Œã€‚ç±»ä¼¼åœ°ï¼Œä½ åªéœ€è¦å¯¹å¹¶è¡Œæµè°ƒç”¨sequentialæ–¹æ³•å°±å¯ä»¥æŠŠå®ƒå˜æˆé¡ºåºæµã€‚è¯·æ³¨æ„ï¼Œä½ å¯èƒ½ä»¥ä¸ºæŠŠè¿™ä¸¤ä¸ªæ–¹æ³•ç»“åˆèµ·æ¥ï¼Œå°±å¯ä»¥æ›´ç»†åŒ–åœ°æ§åˆ¶åœ¨éå†æµæ—¶å“ªäº›æ“ä½œè¦å¹¶è¡Œæ‰§è¡Œï¼Œå“ªäº›è¦é¡ºåºæ‰§è¡Œ123456stream.parallel() .filter(...) .sequential() .map(...) .parallel() .reduce(); ä½†æœ€åä¸€æ¬¡paralleræˆ–sequentialè°ƒç”¨ä¼šå½±å“æ•´ä¸ªæµæ°´çº¿ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæµæ°´çº¿ä¼šå¹¶å‘æ‰§è¡Œï¼Œå› ä¸ºæœ€åè°ƒç”¨çš„æ˜¯å®ƒ å¹¶è¡Œæµå†…éƒ¨ä½¿ç”¨äº†é»˜è®¤çš„ForkJoinPoolï¼Œå®ƒé»˜è®¤çš„çº¿ç¨‹æ•°é‡å°±æ˜¯ä½ çš„å¤„ç†å™¨æ•°é‡ é«˜æ•ˆä½¿ç”¨å¹¶è¡Œæµ å¦‚æœæœ‰ç–‘é—®ï¼Œæµ‹é‡ã€‚æŠŠé¡ºåºæµè½¬æˆå¹¶è¡Œæµè½»è€Œæ˜“ä¸¾ï¼Œä½†å´ä¸ä¸€å®šæ˜¯å¥½äº‹ ç•™æ„è£…ç®±ã€‚è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±æ“ä½œä¼šå¤§å¤§é™ä½æ€§èƒ½ã€‚Java8ä¸­æœ‰åŸå§‹ç±»å‹æµ(IntStreamã€LongStreamã€DoubleStream)æ¥é¿å…è¿™ç§æ“ä½œï¼Œä½†å‡¡æœ‰å¯èƒ½éƒ½åº”è¯¥ç”¨è¿™äº›æµ æœ‰äº›æ“ä½œæœ¬èº«åœ¨å¹¶è¡Œæµä¸Šçš„æ€§èƒ½å°±æ¯”é¡ºåºæµå·®ã€‚ç‰¹åˆ«æ˜¯limitå’ŒfindFirstç­‰ä¾èµ–äºå…ƒç´ é¡ºåºçš„æ“ä½œï¼Œå®ƒä»¬åœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œçš„ä»£ä»·éå¸¸å¤§ã€‚ä¾‹å¦‚ï¼ŒfindAnyä¼šæ¯”findFirstæ€§èƒ½å¥½ï¼Œå› ä¸ºå®ƒä¸ä¸€å®šè¦æŒ‰é¡ºåºæ¥æ‰§è¡Œã€‚ä½ æ€»æ˜¯å¯ä»¥è°ƒç”¨unorderedæ–¹æ³•æ¥æŠŠæœ‰åºæµå˜æˆæ— åºæµã€‚é‚£ä¹ˆï¼Œå¦‚æœä½ éœ€è¦æµä¸­çš„nä¸ªå…ƒç´ è€Œä¸æ˜¯ä¸“é—¨è¦å‰nä¸ªçš„è¯ï¼Œå¯¹æ— åºå¹¶è¡Œæµè°ƒç”¨limitå¯èƒ½ä¼šæ¯”å•ä¸ªæœ‰åºæµï¼ˆæ¯”å¦‚æ•°æ®æºæ˜¯ä¸€ä¸ªListï¼‰æ›´é«˜æ•ˆ è¿˜è¦è€ƒè™‘æµçš„æ“ä½œæµæ°´çº¿çš„æ€»è®¡ç®—æˆæœ¬ã€‚è®¾Næ˜¯è¦å¤„ç†çš„å…ƒç´ çš„æ€»æ•°ï¼ŒQæ˜¯ä¸€ä¸ªå…ƒç´ é€šè¿‡æµæ°´çº¿çš„å¤§è‡´å¤„ç†æˆæœ¬ï¼Œåˆ™N*Qå°±æ˜¯è¿™ä¸ªå¯¹æˆæœ¬çš„ä¸€ä¸ªç²—ç•¥çš„å®šæ€§ä¼°è®¡ã€‚Qå€¼è¾ƒé«˜å°±æ„å‘³ç€ä½¿ç”¨å¹¶è¡Œæµæ—¶æ€§èƒ½å¥½çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ã€‚ å¯¹äºè¾ƒå°çš„æ•°æ®é‡ï¼Œé€‰æ‹©å¹¶è¡Œæµå‡ ä¹ä»æ¥éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½çš„å†³å®šã€‚å¹¶è¡Œå¤„ç†å°‘æ•°å‡ ä¸ªå…ƒç´ çš„å¥½å¤„è¿˜æŠµä¸ä¸Šå¹¶è¡ŒåŒ–é€ æˆçš„é¢å¤–å¼€é”€ã€‚ è¦è€ƒè™‘æµèƒŒåçš„æ•°æ®ç»“æ„æ˜¯å¦æ˜“äºåˆ†è§£ã€‚ä¾‹å¦‚ï¼ŒArrayListçš„æ‹†åˆ†æ•ˆç‡æ¯”LinkedListé«˜å¾—å¤šï¼Œå› ä¸ºå‰è€…ç”¨ä¸ç€éå†å°±å¯ä»¥å¹³å‡æ‹†åˆ†ï¼Œè€Œåè€…åˆ™å¿…é¡»éå†ã€‚å¦å¤–ï¼Œç”¨rangeå·¥å‚æ–¹æ³•åˆ›å»ºçš„åŸå§‹ç±»å‹æµä¹Ÿå¯ä»¥å¿«é€Ÿåˆ†è§£ æµè‡ªèº«çš„ç‰¹ç‚¹ï¼Œä»¥åŠæµæ°´çº¿ä¸­çš„ä¸­é—´æ“ä½œä¿®æ”¹æµçš„æ–¹å¼ï¼Œéƒ½å¯èƒ½ä¼šæ”¹å˜åˆ†è§£è¿‡ç¨‹çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªSIZEDæµå¯ä»¥åˆ†æˆå¤§å°ç›¸ç­‰çš„ä¸¤éƒ¨åˆ†ï¼Œè¿™æ ·æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥æ¯”è¾ƒé«˜æ•ˆåœ°å¹¶è¡Œå¤„ç†ï¼Œä½†ç­›é€‰æ“ä½œå¯èƒ½ä¸¢å¼ƒçš„å…ƒç´ ä¸ªæ•°å´æ— æ³•é¢„æµ‹ï¼Œå¯¼è‡´æµæœ¬èº«çš„å¤§å°æœªçŸ¥ã€‚ è¿˜è¦è€ƒè™‘ç»ˆç«¯æ“ä½œä¸­åˆå¹¶æ­¥éª¤çš„ä»£ä»·æ˜¯å¤§æ˜¯å°ï¼ˆä¾‹å¦‚Collectorä¸­çš„combineræ–¹æ³•ï¼‰ã€‚å¦‚æœè¿™ä¸€æ­¥ä»£ä»·å¾ˆå¤§ï¼Œé‚£ä¹ˆç»„åˆæ¯ä¸ªå­æµäº§ç”Ÿçš„éƒ¨åˆ†ç»“æœæ‰€ä»˜å‡ºçš„ä»£ä»·å°±å¯èƒ½ä¼šè¶…å‡ºé€šè¿‡å¹¶è¡Œæµå¾—åˆ°çš„æ€§èƒ½æå‡ æµçš„æ•°æ®æºå’Œå¯åˆ†è§£æ€§ æº å¯åˆ†è§£æ€§ ArrayList æä½³ LinkedList å·® IntStream.range æä½³ Stream.iterate å·® HashSet å¥½ TreeSet å¥½","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Optionalã€java8å®æˆ˜ã€‘","slug":"Optionalã€java8å®æˆ˜ã€‘","date":"2018-04-30T10:42:41.000Z","updated":"2018-05-07T04:43:51.989Z","comments":true,"path":"2018/04/30/Optionalã€java8å®æˆ˜ã€‘/","link":"","permalink":"https://hsb786.github.io/2018/04/30/Optionalã€java8å®æˆ˜ã€‘/","excerpt":"Null References: The Billion Dollar Mistake","text":"Null References: The Billion Dollar Mistake nullå¸¦æ¥çš„ç§ç§é—®é¢˜ å®ƒæ˜¯é”™è¯¯ä¹‹æº NullPointerExceptionæ˜¯ç›®å‰Javaç¨‹åºå¼€å‘ä¸­æœ€å…¸å‹çš„å¼‚å¸¸ å®ƒä¼šä½¿ä½ çš„ä»£ç è†¨èƒ€ å®ƒè®©ä½ çš„ä»£ç å……æ–¥ç€æ·±åº¦åµŒå¥—çš„nullæ£€æŸ¥ï¼Œä»£ç çš„å¯è¯»æ€§ç³Ÿç³•é€é¡¶ å®ƒè‡ªèº«æ˜¯æ¯«æ— æ„ä¹‰çš„ nullè‡ªèº«æ²¡æœ‰ä»»ä½•çš„è¯­ä¹‰ï¼Œå°¤å…¶æ˜¯ï¼Œå®ƒä»£è¡¨çš„æ˜¯åœ¨é™æ€ç±»å‹è¯­è¨€ä¸­ä»¥ä¸€ç§é”™è¯¯çš„æ–¹å¼å¯¹ç¼ºå°‘å˜é‡å€¼çš„å»ºæ¨¡ å®ƒç ´åäº†Javaçš„å“²å­¦ Javaä¸€ç›´è¯•å›¾é¿å…è®©ç¨‹åºå‘˜æ„è¯†åˆ°æŒ‡é’ˆçš„å­˜åœ¨ï¼Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯ï¼šnullæŒ‡é’ˆ å®ƒåœ¨Javaçš„ç±»å‹ç³»ç»Ÿä¸Šå¼€äº†ä¸ªå£å­ nullå¹¶ä¸å±äºä»»ä½•ç±»å‹ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è¢«èµ‹å€¼ç»™ä»»æ„å¼•ç”¨ç±»å‹çš„å˜é‡ã€‚è¿™ä¼šå¯¼è‡´é—®é¢˜, åŸå› æ˜¯å½“è¿™ä¸ªå˜é‡è¢«ä¼ é€’åˆ°ç³»ç»Ÿä¸­çš„å¦ä¸€ä¸ªéƒ¨åˆ†åï¼Œä½ å°†æ— æ³•è·çŸ¥è¿™ä¸ªnullå˜é‡æœ€åˆçš„èµ‹å€¼åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ã€‚ Optionaljava.util.Optional&lt;T&gt;æ˜¯ä¸€ä¸ªå°è£…Optionalå€¼çš„ç±»ã€‚å˜é‡å­˜åœ¨æ—¶ï¼ŒOptionalç±»åªæ˜¯å¯¹ç±»ç®€å•å°è£…ï¼›å˜é‡ä¸å­˜åœ¨æ—¶ï¼Œç¼ºå¤±çš„å€¼ä¼šè¢«å»ºæ¨¡æˆä¸€ä¸ªâ€œç©ºâ€çš„Optionalå¯¹è±¡ï¼Œç”±æ–¹æ³•Optional.empty()è¿”å›ã€‚Optional.empty()æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼Œå®ƒè¿”å›Optionalç±»çš„ç‰¹å®šå•ä¸€å®ä¾‹ã€‚ nullå¼•ç”¨å’ŒOptional.empty()åŒºåˆ«ï¼Ÿä»è¯­ä¹‰ä¸Šï¼Œæ²¡åŒºåˆ«ï¼›ä»å®é™…ä½¿ç”¨ä¸­ï¼Œå¦‚æœä½ å°è¯•è§£å¼•ç”¨ä¸€ä¸ªnullï¼Œä¸€å®šä¼šè§¦å‘NullPointerExceptionï¼Œä¸è¿‡ä½¿ç”¨Optional.empty()å°±å®Œå…¨æ²¡äº‹ï¼Œå®ƒæ˜¯Optionalç±»çš„ä¸€ä¸ªæœ‰æ•ˆå¯¹è±¡ã€‚ 123456789101112131415//äººpublic class Person &#123; private Optional&lt;Car&gt; car; public Optional&lt;Car&gt; getCar() &#123; return car; &#125; &#125;//è½¦public class Car &#123; private Optional&lt;Insurance&gt; insurance; public Optional&lt;Insurance&gt; getInsurance() &#123; return insurance; &#125; &#125; //ä¿é™©å…¬å¸ å¿…é¡»æœ‰åå­—public class Insurance &#123; private String name; public String getName() &#123; return name; &#125;&#125; åˆ›å»ºOptionalå¯¹è±¡ å£°æ˜ä¸€ä¸ªç©ºçš„Optional Optional&lt;Car&gt; optCar = Optional.empty(); ä¾æ®ä¸€ä¸ªéç©ºå€¼åˆ›å»ºOptional Optional&lt;Car&gt; optCar = Optional.of(car); å¦‚æœcaræ˜¯ä¸€ä¸ªnullï¼Œè¿™æ®µä»£ç ä¼šç«‹å³æŠ›å‡ºä¸€ä¸ªNullPointerExceptionï¼Œè€Œä¸æ˜¯ç­‰åˆ°ä½ è¯•å›¾è®¿é—®carçš„å±æ€§å€¼æ—¶æ‰è¿”å›ä¸€ä¸ªé”™è¯¯ å¯æ¥å—nullçš„Optional Optional&lt;Car&gt; optCar = Optional.ofNullable(car); å¦‚æœcaræ˜¯nullï¼Œé‚£ä¹ˆå¾—åˆ°çš„Optionalå¯¹è±¡å°±æ˜¯ä¸ªç©ºå¯¹è±¡ ä½¿ç”¨mapä»Optionalå¯¹è±¡ä¸­æå–å’Œè½¬æ¢å€¼æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦ä»insuranceå…¬å¸å¯¹è±¡ä¸­æå–å…¬å¸çš„åç§°ã€‚æå–åç§°ä¹‹å‰ï¼Œä½ éœ€è¦æ£€æŸ¥insuranceå¯¹è±¡æ˜¯å¦ä¸ºnull1234String name = null; if(insurance != null)&#123; name = insurance.getName(); &#125; 12Optional&lt;Insurance&gt; optInsurance = Optional.ofNullable(insurance); Optional&lt;String&gt; name = optInsurance.map(Insurance::getName); å¯ä»¥æŠŠOptionalå¯¹è±¡çœ‹æˆä¸€ç§ç‰¹æ®Šçš„é›†åˆæ•°æ®ï¼Œå®ƒè‡³å¤šåŒ…å«ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœOptionalåŒ…å«ä¸€ä¸ªå€¼ï¼Œé‚£å‡½æ•°å°±å°†è¯¥å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™mapï¼Œå¯¹è¯¥å€¼è¿›è¡Œè½¬æ¢ã€‚å¦‚æœOptionalä¸ºç©ºï¼Œå°±ä»€ä¹ˆä¹Ÿä¸åšã€‚ ä½¿ç”¨flatMapé“¾æ¥Optionalå¯¹è±¡12345Optional&lt;Person&gt; optPerson = Optional.of(person); Optional&lt;String&gt; name = optPerson.map(Person::getCar) .map(Car::getInsurance) .map(Insurance::getName); æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚optPersonæ˜¯Optionalç±»å‹çš„å˜é‡ï¼Œè°ƒç”¨mapæ–¹æ³•æ²¡æœ‰é—®é¢˜ã€‚ä½†getCarè¿”å›çš„æ˜¯ä¸€ä¸ªOptionalç±»å‹çš„å¯¹è±¡ï¼Œè¿™ä»¥ä¸ºç€mapæ“ä½œçš„ç»“æœæ˜¯ä¸€ä¸ªOptional&lt;Optional&gt;ç±»å‹çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œå®ƒå¯¹getInsuranceçš„è°ƒç”¨æ˜¯éæ³•çš„ã€‚åµŒå¥—å¼Optionalç»“æ„ è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŸflatMapæ–¹æ³•ã€‚ä½¿ç”¨æµæ—¶ï¼ŒflatMapæ–¹æ³•æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ä¸€ä¸ªæµã€‚è¿™ä¸ªæ–¹æ³•ä¼šåº”ç”¨åˆ°æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªæ–°çš„æµçš„æµã€‚ä½†æ˜¯flatMapä¼šç”¨æµçš„å†…å®¹æ›¿æ¢æ¯ä¸ªæ–°ç”Ÿå­˜çš„æµã€‚æ¢å¥è¯è¯´ï¼Œç”±æ–¹æ³•ç”Ÿæˆçš„å„ä¸ªæµä¼šè¢«åˆå¹¶æˆ–è€…æ‰å¹³åŒ–ä¸ºä¸€ä¸ªå•ä¸€çš„æµã€‚ 123456public String getCarInsuranceName(Optional&lt;Person&gt; person) &#123; return person.flatMap(Person::getCar) .flatMap(Car::getInsurance) .map(Insurance::getName) .orElse(&quot;Unknown&quot;); &#125; Optionalæ— æ³•åºåˆ—åŒ– Javaè¯­è¨€çš„æ¶æ„å¸ˆBrian Goetzæ›¾ç»éå¸¸æ˜ç¡®åœ°é™ˆè¿°è¿‡ï¼ŒOptionalçš„è®¾è®¡åˆè¡·ä»…ä»…æ˜¯è¦æ”¯æŒèƒ½è¿”å›Optionalå¯¹è±¡çš„è¯­æ³•ã€‚ ç”±äºOptionalç±»è®¾è®¡æ—¶å°±æ²¡ç‰¹åˆ«è€ƒè™‘å°†å…¶ä½œä¸ºç±»çš„å­—æ®µä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¹¶æœªå®ç°Serializableæ¥å£ã€‚å¦‚æœä½ ä¸€å®šè¦å®ç°åºåˆ—åŒ–çš„åŸŸæ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¾‹å­123456public class Person &#123; private Car car; public Optional&lt;Car&gt; getCarAsOptional() &#123; return Optional.ofNullable(car); &#125; &#125; é»˜è®¤è¡Œä¸ºåŠè§£å¼•ç”¨Optionalå¯¹è±¡Optionalç±»æä¾›äº†å¤šç§æ–¹æ³•è¯»å–Optionalå®ä¾‹ä¸­çš„å˜é‡å€¼ get()æ˜¯è¿™äº›æ–¹æ³•ä¸­æœ€ç®€å•ä½†åˆæœ€ä¸å®‰å…¨çš„æ–¹æ³•ã€‚å¦‚æœå˜é‡å­˜åœ¨ï¼Œå®ƒç›´æ¥è¿”å›å°è£…çš„å˜é‡å€¼ï¼Œå¦åˆ™å°±æŠ›å‡ºä¸€ä¸ªNoSuchElementExceptionå¼‚å¸¸ orElse(T other)ã€‚å®ƒå…è®¸ä½ åœ¨Optionalå¯¹è±¡ä¸åŒ…å«å€¼æ—¶æä¾›ä¸€ä¸ªé»˜è®¤å€¼ orElseGet(Supplier&lt;? extends T&gt; other)æ˜¯orElseæ–¹æ³•çš„å»¶è¿Ÿè°ƒç”¨ç‰ˆï¼ŒSupplieræ–¹æ³•åªæœ‰åœ¨Optionalå¯¹è±¡ä¸å«å€¼æ—¶æ‰æ‰§è¡Œè°ƒç”¨ã€‚å¦‚æœåˆ›å»ºé»˜è®¤å€¼æ˜¯ä»¶è€—æ—¶è´¹åŠ›çš„å·¥ä½œï¼Œä½ åº”è¯¥è€ƒè™‘é‡‡ç”¨è¿™ç§æ–¹å¼ï¼ˆå€Ÿæ­¤æå‡ç¨‹åºçš„æ€§èƒ½ï¼‰ï¼Œæˆ–è€…ä½ éœ€è¦éå¸¸ç¡®å®šæŸä¸ªæ–¹æ³•ä»…åœ¨Optionalä¸ºç©ºæ—¶æ‰è¿›è¡Œè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘è¯¥æ–¹å¼ï¼ˆè¿™ç§æƒ…å†µæœ‰ä¸¥æ ¼çš„é™åˆ¶æ¡ä»¶ï¼‰ã€‚ orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier)å’Œgetæ–¹æ³•éå¸¸ç±»ä¼¼ï¼Œå®ƒä»¬é­é‡Optionalå¯¹è±¡ä¸ºç©ºæ—¶éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œä½†æ˜¯ä½¿ç”¨orElseThrowä½ å¯ä»¥å®šåˆ¶å¸Œæœ›æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚ ifPresent(Consumer&lt;? super T&gt;)è®©ä½ èƒ½åœ¨å˜é‡å€¼å­˜åœ¨æ—¶æ‰§è¡Œä¸€ä¸ªä½œä¸ºå‚æ•°ä¼ å…¥çš„æ–¹æ³•ï¼Œå¦åˆ™å°±ä¸è¿›è¡Œä»»ä½•æ“ä½œ ä¸¤ä¸ªOptionalå¯¹è±¡çš„ç»„åˆå‡è®¾ä½ æœ‰è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªPersonå’Œä¸€ä¸ªCarå¯¹è±¡ï¼Œå¹¶ä»¥æ­¤ä¸ºæ¡ä»¶å¯¹å¤–éƒ¨æä¾›çš„æœåŠ¡è¿›è¡ŒæŸ¥è¯¢ï¼Œé€šè¿‡ä¸€äº›å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¯•å›¾æ‰¾åˆ°æ»¡è¶³è¯¥ç»„åˆçš„æœ€ä¾¿å®œçš„ä¿é™©å…¬å¸ 12345public Insurance findCheapestInsurance(Person person, Car car) &#123; // ä¸åŒçš„ä¿é™©å…¬å¸æä¾›çš„æŸ¥è¯¢æœåŠ¡ // å¯¹æ¯”æ‰€æœ‰æ•°æ® return cheapestCompany; &#125; 1234567public Optional&lt;Insurance&gt; nullSafeFindCheapestInsurance( Optional&lt;Person&gt; person, Optional&lt;Car&gt; car) &#123; if (person.isPresent() &amp;&amp; car.isPresent()) &#123; return Optional.of(findCheapestInsurance(person.get(), car.get())); &#125; else &#123; return Optional.empty(); &#125; &#125; è¯¥æ–¹æ³•çš„å…·ä½“å®ç°å’Œä¹‹å‰æ›¾ç»å®ç°çš„nullæ£€æŸ¥å¤ªç›¸ä¼¼äº† å¯ä»¥åƒä½¿ç”¨ä¸‰å…ƒæ“ä½œç¬¦é‚£æ ·ï¼Œæ— éœ€ä»»ä½•æ¡ä»¶åˆ¤æ–­çš„ç»“æ„ï¼Œä»¥ä¸€è¡Œè¯­å¥å®ç°è¯¥æ–¹æ³•123public Optional&lt;Insurance&gt; nullSafeFindCheapestInsurance( Optional&lt;Person&gt; person, Optional&lt;Car&gt; car) &#123; return person.flatMap(p -&gt; car.map(c -&gt; findCheapestInsurance(p, c))); &#125; ä½¿ç”¨filterå‰”é™¤ç‰¹å®šçš„å€¼1234Optional&lt;Insurance&gt; optInsurance = ...; optInsurance.filter(insurance -&gt; &quot;CambridgeInsurance&quot;.equals(insurance.getName())) .ifPresent(x -&gt; System.out.println(&quot;ok&quot;)); Optionalç±»çš„æ–¹æ³• æ–¹æ³• æè¿° empty è¿”å›ä¸€ä¸ªç©ºçš„Optionalå®ä¾‹ filter å¦‚æœå€¼å­˜åœ¨å¹¶ä¸”æ»¡è¶³æä¾›çš„è°“è¯ï¼Œå°±è¿”å›åŒ…å«è¯¥å€¼çš„Optionalå¯¹è±¡ï¼›å¦åˆ™è¿”å›ä¸€ä¸ªç©ºçš„Optionalå¯¹è±¡ map å¦‚æœå€¼å­˜åœ¨ï¼Œå°±å¯¹è¯¥å€¼æ‰§è¡Œæä¾›çš„mappingå‡½æ•°è°ƒç”¨ flatMap å¦‚æœå€¼å­˜åœ¨ï¼Œå°±å¯¹è¯¥å€¼æ‰§è¡Œæä¾›çš„mappingå‡½æ•°è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµ get å¦‚æœå€¼å­˜åœ¨ï¼Œå°†è¯¥å€¼ç”¨Optionalå°è£…è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªNoSuchElementExcepitonå¼‚å¸¸ ifPresent å¦‚æœå€¼å­˜åœ¨ï¼Œå°±æ‰§è¡Œä½¿ç”¨è¯¥å€¼çš„æ–¹æ³•è°ƒç”¨ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åš isPresent å¦‚æœå€¼å­˜åœ¨å°±è¿”å›trueï¼Œå¦åˆ™è¿”å›false of å°†æŒ‡å®šå€¼ç”¨Optionalå°è£…ä¹‹åè¿”å›ï¼Œå¦‚æœè¯¥å€¼ä¸ºnullï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªNullPointerExceptionå¼‚å¸¸ ofNullable å°†æŒ‡å®šå€¼ç”¨Optionalå°è£…ä¹‹åè¿”å›ï¼Œå¦‚æœè¯¥å€¼ä¸ºnullï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºçš„Optionalå¯¹è±¡ orElse å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ orElseGet å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªç”±æŒ‡å®šçš„Supplieræ¥å£ç”Ÿæˆçš„å€¼ orElseThrow å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªç”±æŒ‡å®šçš„Supplieræ¥å£ç”Ÿæˆçš„å¼‚å¸¸ ç”¨Optionalå°è£…å¯èƒ½ä¸ºnullçš„å€¼Optional&lt;Object&gt; value = Optional.ofNullable(map.get(&quot;key&quot;)); å¼‚å¸¸ä¸Optionalçš„å¯¹æ¯”ç”±äºæŸç§åŸå› ï¼Œå‡½æ•°æ— æ³•è¿”å›æŸä¸ªå€¼ï¼Œè¿™æ—¶é™¤äº†è¿”å›nullï¼ŒJava APIæ¯”è¾ƒå¸¸è§çš„æ›¿ä»£åšæ³•æ˜¯æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚è¿™ç§æƒ…å†µæ¯”è¾ƒå…¸å‹çš„ä¾‹å­å°±æ˜¯ä½¿ç”¨é™æ€æ–¹æ³•Integer.parseInt(String)ï¼Œå°†Stringè½¬æ¢ä¸ºintã€‚å¦‚æœStringæ— æ³•è§£æåˆ°å¯¹åº”çš„æ•´å‹ï¼Œè¯¥æ–¹æ³•å°±æŠ›å‡ºä¸€ä¸ªNumberFormatExceptionã€‚1234567public static Optional&lt;Integer&gt; stringToInt(String s) &#123; try &#123; return Optional.of(Integer.parseInt(s)); &#125; catch (NumberFormatException e) &#123; return Optional.empty(); &#125; &#125; å¯ä»¥å°†å¤šä¸ªç±»ä¼¼çš„æ–¹æ³•å°è£…åˆ°ä¸€ä¸ªå·¥å…·ç±»ä¸­ï¼Œè®©æˆ‘ä»¬ç§°ä¹‹ä¸ºOptionalUtilityã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ ä»¥åå°±èƒ½ç›´æ¥è°ƒç”¨OptionalUtility.stringToIntæ–¹æ³•ï¼Œå°†Stringè½¬æ¢ä¸ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œè€Œä¸å†éœ€è¦è®°å¾—ä½ åœ¨å…¶ä¸­å°è£…äº†ç¬¨æ‹™çš„try/catchçš„é€»è¾‘äº† æ€»ç»“ nullå¼•ç”¨åœ¨å†å²ä¸Šè¢«å¼•å…¥åˆ°ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ï¼Œç›®çš„æ˜¯ä¸ºäº†è¡¨ç¤ºå˜é‡å€¼çš„ç¼ºå¤± Java8ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç±»java.util.Optionalï¼Œå¯¹å­˜åœ¨æˆ–ç¼ºå¤±çš„å˜é‡å€¼è¿›è¡Œå»ºæ¨¡ ä½ å¯ä»¥ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•Optional.emptyã€Optional.ofä»¥åŠOptional.ofNullableåˆ›å»ºOptionalå¯¹è±¡ Optionalç±»æ”¯æŒå¤šç§æ–¹æ³•ï¼Œæ¯”å¦‚mapã€flagMapã€filterï¼Œå®ƒä»¬åœ¨æ¦‚å¿µä¸Šä¸Streamç±»ä¸­å¯¹åº”çš„æ–¹æ³•ååˆ†ç›¸ä¼¼ ä½¿ç”¨Optionalä¼šè¿«ä½¿ä½ æ›´ç§¯æåœ°è§£å¼•ç”¨Optionalå¯¹è±¡ï¼Œä»¥åº”å¯¹å˜é‡å€¼ç¼ºå¤±çš„é—®é¢˜ï¼Œæœ€ç»ˆï¼Œä½ èƒ½æ›´æœ‰æ•ˆåœ°é˜²æ­¢ä»£ç ä¸­å‡ºç°ä¸æœŸè€Œè‡³çš„ç©ºæŒ‡é’ˆå¼‚å¸¸","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"æµã€Java8å®æˆ˜ã€‘","slug":"æµã€Java8å®æˆ˜ã€‘","date":"2018-04-30T04:02:22.000Z","updated":"2018-05-02T06:44:25.982Z","comments":true,"path":"2018/04/30/æµã€Java8å®æˆ˜ã€‘/","link":"","permalink":"https://hsb786.github.io/2018/04/30/æµã€Java8å®æˆ˜ã€‘/","excerpt":"æµæ˜¯Java APIçš„æ–°æˆå‘˜ï¼Œå®ƒå…è®¸ä½ ä»¥å£°æ˜æ€§æ–¹å¼å¤„ç†æ•°æ®é›†åˆï¼ˆé€šè¿‡æŸ¥è¯¢è¯­å¥æ¥è¡¨è¾¾ï¼Œè€Œä¸æ˜¯ä¸´æ—¶ç¼–å†™ä¸€ä¸ªå®ç°ï¼‰","text":"æµæ˜¯Java APIçš„æ–°æˆå‘˜ï¼Œå®ƒå…è®¸ä½ ä»¥å£°æ˜æ€§æ–¹å¼å¤„ç†æ•°æ®é›†åˆï¼ˆé€šè¿‡æŸ¥è¯¢è¯­å¥æ¥è¡¨è¾¾ï¼Œè€Œä¸æ˜¯ä¸´æ—¶ç¼–å†™ä¸€ä¸ªå®ç°ï¼‰ ä¸¾ä¸ªæ —å­ğŸ‚ ä»£ç æ˜¯ä»¥å£°æ˜æ€§æ–¹å¼å†™çš„ï¼šè¯´æ˜æƒ³è¦å®Œæˆä»€ä¹ˆè€Œä¸æ˜¯è¯´æ˜å¦‚ä½•å®ç°ä¸€ä¸ªæ“ä½œ å¯ä»¥æŠŠå‡ ä¸ªåŸºç¡€æ“ä½œé“¾æ¥èµ·æ¥ï¼Œæ¥è¡¨è¾¾å¤æ‚çš„æ•°æ®å¤„ç†æµæ°´çº¿ï¼ŒåŒæ—¶ä¿æŒä»£ç æ¸…æ™°å¯è¯» Stream API: å£°æ˜æ€§â€”â€”æ›´ç®€æ´ï¼Œæ›´æ˜“è¯» å¯å¤åˆâ€”â€”æ›´çµæ´» å¯å¹¶è¡Œâ€”â€”æ€§èƒ½å¾ˆå¥½ æµç®€ä»‹ç®€çŸ­çš„å®šä¹‰å°±æ˜¯â€œä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„å…ƒç´ åºåˆ—â€ å…ƒç´ åºåˆ—â€”â€”å°±åƒé›†åˆä¸€æ ·ï¼Œæµä¹Ÿæä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è®¿é—®ç‰¹å®šå…ƒç´ ç±»å‹çš„ä¸€ç»„æœ‰åºå€¼ã€‚å› ä¸ºé›†åˆæ˜¯æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å®ƒçš„ä¸»è¦ç›®çš„æ˜¯ä»¥ç‰¹å®šçš„æ—¶é—´/ç©ºé—´å¤æ‚åº¦å­˜å‚¨å’Œè®¿é—®å…ƒç´ ï¼ˆå¦‚ArrayListä¸LinkedListï¼‰ã€‚ä½†æµçš„ç›®çš„åœ¨äºè¡¨è¾¾è®¡ç®—ï¼Œæ¯”å¦‚ä½ å‰é¢è§åˆ°çš„filterã€sortedå’Œmapã€‚é›†åˆè®²çš„æ˜¯æ•°æ®ï¼Œæµè®²çš„æ˜¯è®¡ç®—ã€‚ æºâ€”â€”æµä¼šä½¿ç”¨ä¸€ä¸ªæä¾›æ•°æ®çš„æºï¼Œå¦‚é›†åˆã€æ•°ç»„æˆ–è¾“å…¥/è¾“å‡ºèµ„æºã€‚è¯·æ³¨æ„ï¼Œä»æœ‰åºé›†åˆç”Ÿæˆæµæ—¶ä¼šä¿ç•™åŸæœ‰çš„é¡ºåºã€‚ç”±åˆ—è¡¨ç”Ÿæˆçš„æµï¼Œå…¶å…ƒç´ é¡ºåºä¸åˆ—è¡¨ä¸€è‡´ã€‚ æ•°æ®å¤„ç†æ“ä½œâ€”â€”æµçš„æ•°æ®å¤„ç†åŠŸèƒ½æ”¯æŒç±»ä¼¼äºæ•°æ®åº“çš„æ“ä½œï¼Œä»¥åŠå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­çš„å¸¸ç”¨æ“ä½œï¼Œå¦‚filterã€mapã€reduceã€findã€matchã€sortç­‰ã€‚æµæ“ä½œå¯ä»¥é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯å¹¶è¡Œæ‰§è¡Œ ç‰¹ç‚¹ï¼š æµæ°´çº¿â€”â€”å¾ˆå¤šæµæ“ä½œæœ¬èº«ä¼šè¿”å›ä¸€ä¸ªæµï¼Œè¿™æ ·å¤šä¸ªæ“ä½œå°±å¯ä»¥é“¾æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¤§çš„æµæ°´çº¿ã€‚ å†…éƒ¨è¿­ä»£â€”â€”ä¸ä½¿ç”¨è¿­ä»£å™¨æ˜¾å¼è¿­ä»£çš„é›†åˆä¸åŒï¼Œæµçš„è¿­ä»£æ“ä½œæ˜¯åœ¨èƒŒåè¿›è¡Œçš„ã€‚ æµä¸é›†åˆé›†åˆä¸æµä¹‹é—´çš„å·®å¼‚å°±åœ¨äºä»€ä¹ˆæ—¶å€™è¿›è¡Œè®¡ç®—ã€‚é›†åˆæ˜¯ä¸€ä¸ªå†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼Œå®ƒåŒ…å«æ•°æ®ç»“æ„ä¸­ç›®å‰æ‰€æœ‰çš„å€¼â€”â€”é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¾—å…ˆç®—å‡ºæ¥æ‰èƒ½æ·»åŠ åˆ°é›†åˆä¸­ã€‚ï¼ˆä½ å¯ä»¥å¾€é›†åˆé‡ŒåŠ ä¸œè¥¿æˆ–è€…åˆ ä¸œè¥¿ï¼Œä½†æ˜¯ä¸ç®¡ä»€ä¹ˆæ—¶å€™ï¼Œé›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æ”¾åœ¨å†…å­˜é‡Œçš„ï¼Œå…ƒç´ éƒ½å¾—å…ˆç®—å‡ºæ¥æ‰èƒ½æˆä¸ºé›†åˆçš„ä¸€éƒ¨åˆ†ã€‚ï¼‰ç›¸æ¯”ä¹‹ä¸‹ï¼Œæµåˆ™æ˜¯åœ¨æ¦‚å¿µä¸Šå›ºå®šçš„æ•°æ®ç»“æ„ï¼ˆä½ ä¸èƒ½æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼‰ï¼Œå…¶å…ƒç´ åˆ™æ˜¯æŒ‰éœ€è®¡ç®—çš„ã€‚ åªèƒ½éå†ä¸€æ¬¡è¯·æ³¨æ„ï¼Œå’Œè¿­ä»£å™¨ç±»ä¼¼ï¼Œæµåªèƒ½éå†ä¸€æ¬¡ã€‚éå†å®Œä¹‹åï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªæµå·²ç»è¢«æ¶ˆè´¹æ‰äº†ã€‚ä½ å¯ä»¥ä»åŸå§‹æ•°æ®æºé‚£é‡Œå†è·å¾—ä¸€ä¸ªæ–°çš„æµæ¥é‡æ–°éå†ä¸€éï¼Œå°±åƒè¿­ä»£å™¨ä¸€æ · å¤–éƒ¨è¿­ä»£ä¸å†…éƒ¨è¿­ä»£ä½¿ç”¨Collectionæ¥å£éœ€è¦ç”¨æˆ·å»åšè¿­ä»£ï¼ˆæ¯”å¦‚ç”¨for-eachï¼‰ï¼Œè¿™ç§°ä¸ºå¤–éƒ¨è¿­ä»£ã€‚ç›¸åï¼ŒStreamsåº“ä½¿ç”¨å†…éƒ¨è¿­ä»£â€”â€”å®ƒå¸®ä½ æŠŠè¿­ä»£åšäº†ï¼Œè¿˜æŠŠå¾—åˆ°çš„æµå€¼å­˜åœ¨äº†æŸä¸ªåœ°æ–¹ï¼Œä½ åªè¦ç»™å‡ºä¸€ä¸ªå‡½æ•°è¯´è¦å¹²ä»€ä¹ˆå°±å¯ä»¥äº†ã€‚ å¤–éƒ¨è¿­ä»£ä¸€ä¸ªé›†åˆï¼Œæ˜¾å¼åœ°å–å‡ºæ¯ä¸ªé¡¹ç›®å†åŠ ä»¥å¤„ç†ã€‚å†…éƒ¨è¿­ä»£æ—¶ï¼Œé¡¹ç›®å¯ä»¥é€æ˜åœ°å¹¶è¡Œå¤„ç†ï¼Œæˆ–è€…ç”¨æ›´ä¼˜åŒ–çš„é¡ºåºè¿›è¡Œå¤„ç†ã€‚è¦æ˜¯ç”¨Javaè¿‡å»çš„é‚£ç§å¤–éƒ¨è¿­ä»£æ–¹æ³•ï¼Œè¿™äº›ä¼˜åŒ–éƒ½æ˜¯å¾ˆå›°éš¾çš„ã€‚è¿™ä¼¼ä¹æœ‰ç‚¹å„¿é¸¡è›‹é‡ŒæŒ‘éª¨å¤´ï¼Œä½†è¿™å·®ä¸å¤šå°±æ˜¯Java 8å¼•å…¥æµçš„ç†ç”±äº†â€”â€”Streamsåº“çš„å†…éƒ¨è¿­ä»£å¯ä»¥è‡ªåŠ¨é€‰æ‹©ä¸€ç§é€‚åˆä½ ç¡¬ä»¶çš„æ•°æ®è¡¨ç¤ºå’Œå¹¶è¡Œå®ç°ã€‚ä¸æ­¤ç›¸åï¼Œä¸€æ—¦é€šè¿‡å†™for-eachè€Œé€‰æ‹©äº†å¤–éƒ¨è¿­ä»£ï¼Œé‚£ä½ åŸºæœ¬ä¸Šå°±è¦è‡ªå·±ç®¡ç†æ‰€æœ‰çš„å¹¶è¡Œé—®é¢˜äº†ï¼ˆè‡ªå·±ç®¡ç†å®é™…ä¸Šæ„å‘³ç€â€œæŸä¸ªè‰¯è¾°å‰æ—¥æˆ‘ä»¬ä¼šæŠŠå®ƒå¹¶è¡ŒåŒ–â€æˆ–â€œå¼€å§‹äº†å…³äºä»»åŠ¡å’Œsynchronizedçš„æ¼«é•¿è€Œè‰°è‹¦çš„æ–—äº‰â€ï¼‰ã€‚Java 8éœ€è¦ä¸€ä¸ªç±»ä¼¼äºCollectionå´æ²¡æœ‰è¿­ä»£å™¨çš„æ¥å£ï¼Œäºæ˜¯å°±æœ‰äº†Streamï¼ æµæ“ä½œ12345List&lt;String&gt; names = menu.stream() //è·å¾—æµ .filter(d -&gt; d.getCalories() &gt; 300) //ä¸­é—´æ“ä½œ .map(Dish::getName) .limit(3) .collect(toList()); //å°†Streamè½¬æ¢ä¸ºList filterã€mapå’Œlimitå¯ä»¥è¿æˆä¸€æ¡æµæ°´çº¿ collectè§¦å‘æµæ°´çº¿æ‰§è¡Œå¹¶å…³é—­å®ƒ å¯ä»¥è¿æ¥èµ·æ¥çš„æ“ä½œç§°ä¸ºä¸­é—´æ“ä½œï¼Œå…³é—­æµçš„æ“ä½œç§°ä¸ºç»ˆç«¯æ“ä½œ ä¸­é—´æ“ä½œè¯¸å¦‚filteræˆ–sortedç­‰ä¸­é—´æ“ä½œä¼šè¿”å›å¦ä¸€ä¸ªæµã€‚è¿™è®©å¤šä¸ªæ“ä½œå¯ä»¥è¿æ¥èµ·æ¥å½¢æˆä¸€ä¸ªæŸ¥è¯¢ã€‚é‡è¦çš„æ˜¯ï¼Œé™¤éæµæ°´çº¿ä¸Šè§¦å‘ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œå¦åˆ™ä¸­é—´æ“ä½œä¸ä¼šæ‰§è¡Œä»»ä½•å¤„ç†â€”â€”å®ƒä»¬å¾ˆæ‡’ã€‚è¿™æ˜¯å› ä¸ºä¸­é—´æ“ä½œä¸€èˆ¬éƒ½å¯ä»¥åˆå¹¶èµ·æ¥ï¼Œåœ¨ç»ˆç«¯æ“ä½œæ—¶ä¸€æ¬¡æ€§å…¨éƒ¨å¤„ç†ã€‚ 1234567filtering pork mapping pork filtering beef mapping beef filtering chicken mapping chicken [pork, beef, chicken] ä½ ä¼šå‘ç°ï¼Œæœ‰å¥½å‡ ç§ä¼˜åŒ–åˆ©ç”¨äº†æµçš„å»¶è¿Ÿæ€§è´¨ã€‚ç¬¬ä¸€ï¼Œå°½ç®¡å¾ˆå¤šèœçš„çƒ­é‡éƒ½é«˜äº300å¡è·¯é‡Œï¼Œä½†åªé€‰å‡ºäº†å‰ä¸‰ä¸ªï¼è¿™æ˜¯å› ä¸ºlimitæ“ä½œå’Œä¸€ç§ç§°ä¸ºçŸ­è·¯çš„æŠ€å·§ã€‚ç¬¬äºŒï¼Œå°½ç®¡filterå’Œmapæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ“ä½œï¼Œä½†å®ƒä»¬åˆå¹¶åˆ°åŒä¸€æ¬¡éå†ä¸­äº†ï¼ˆæˆ‘ä»¬æŠŠè¿™ç§æŠ€æœ¯å«ä½œå¾ªç¯åˆå¹¶ï¼‰ã€‚ ç»ˆç«¯æ“ä½œç»ˆç«¯æ“ä½œä¼šä»æµçš„æµæ°´çº¿ç”Ÿæˆç»“æœã€‚å…¶ç»“æœæ˜¯ä»»ä½•ä¸æ˜¯æµçš„å€¼ï¼Œæ¯”å¦‚Listã€Integerï¼Œç”šè‡³voidã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„æµæ°´çº¿ä¸­ï¼ŒforEachæ˜¯ä¸€ä¸ªè¿”å›voidçš„ç»ˆç«¯æ“ä½œï¼Œå®ƒä¼šå¯¹æºä¸­çš„æ¯é“èœåº”ç”¨ä¸€ä¸ªLambdaã€‚æŠŠSystem.out.printlnä¼ é€’ç»™forEachï¼Œå¹¶è¦æ±‚å®ƒæ‰“å°å‡ºç”±menuç”Ÿæˆçš„æµä¸­çš„æ¯ä¸€ä¸ªDishï¼š menu.stream().forEach(System.out::println); ä½¿ç”¨æµæµçš„ä½¿ç”¨ä¸€èˆ¬åŒ…æ‹¬ä¸‰ä»¶äº‹ï¼š ä¸€ä¸ªæ•°æ®æºï¼ˆå¦‚é›†åˆï¼‰æ¥æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼› ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼Œå½¢æˆä¸€æ¡æµçš„æµæ°´çº¿ï¼› ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰§è¡Œæµæ°´çº¿ï¼Œå¹¶èƒ½ç”Ÿæˆç»“æœã€‚ æµçš„æµæ°´çº¿èƒŒåçš„ç†å¿µç±»ä¼¼äºæ„å»ºå™¨æ¨¡å¼ã€‚åœ¨æ„å»ºå™¨æ¨¡å¼ä¸­æœ‰ä¸€ä¸ªè°ƒç”¨é“¾ç”¨æ¥è®¾ç½®ä¸€å¥—é…ç½®ï¼ˆå¯¹æµæ¥è¯´è¿™å°±æ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼‰ï¼Œæ¥ç€æ˜¯è°ƒç”¨builtæ–¹æ³•ï¼ˆå¯¹æµæ¥è¯´å°±æ˜¯ç»ˆç«¯æ“ä½œï¼‰ã€‚ ä¸­é—´æ“ä½œï¼š æ“ä½œ ç±»å‹ è¿”å›ç±»å‹ æ“ä½œå‚æ•° å‡½æ•°æè¿°ç¬¦ filter ä¸­é—´ Stream&lt;T> Predicate&lt;T> T -&gt; boolean map ä¸­é—´ Stream&lt;T> Function&lt;T,R> T -&gt; R limit ä¸­é—´ Stream&lt;T> sorted ä¸­é—´ Stream&lt;T> Comparator&lt;T> (T,T) -&gt; int distinct ä¸­é—´ Stream&lt;T> ç»ˆç«¯æ“ä½œï¼š æ“ä½œ ç±»å‹ ç›®çš„ forEach ç»ˆç«¯ æ¶ˆè´¹æµä¸­çš„æ¯ä¸ªå…ƒç´ å¹¶å¯¹å…¶åº”ç”¨Lambdaã€‚è¿™ä¸€æ“ä½œè¿”å›void count ç»ˆç«¯ è¿”å›æµä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚è¿™ä¸€æ“ä½œè¿”å›long collect ç»ˆç«¯ æŠŠæµå½’çº¦æˆä¸€ä¸ªé›†åˆï¼Œæ¯”å¦‚Listã€Mapç”šè‡³æ˜¯Integer å°ç»“ æµæ˜¯â€ä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„ä¸€ç³»åˆ—å…ƒç´ â€ æµåˆ©ç”¨å†…éƒ¨è¿­ä»£ï¼š è¿­ä»£é€šè¿‡filterã€mapã€sortedç­‰æ“ä½œè¢«æŠ½è±¡æ‰äº† æµæ“ä½œæœ‰ä¸¤ç±»ï¼š ä¸­é—´æ“ä½œå’Œç»ˆç«¯æ“ä½œ filterå’Œmapç­‰ä¸­é—´æ“ä½œè´¹è¿”å›ä¸€ä¸ªæµï¼Œå¹¶å¯ä»¥é“¾æ¥åœ¨ä¸€èµ·ã€‚å¯ä»¥ç”¨å®ƒä»¬æ¥è®¾ç½®ä¸€æ¡æµæ°´çº¿ï¼Œä½†å¹¶ä¸ä¼šç”Ÿæˆä»»ä½•ç»“æœ forEachå’Œcountç­‰ç»ˆç«¯æ“ä½œä¼šè¿”å›ä¸€ä¸ªéæµçš„å€¼ï¼Œå¹¶å¤„ç†æµæ°´çº¿ä»¥è¿”å›ç»“æœ æµä¸­çš„å…ƒç´ æ˜¯æŒ‰éœ€è®¡ç®—çš„ ä½¿ç”¨æµç­›é€‰ä½¿ç”¨è°“è¯ç­›é€‰Streamsæ¥å£æ”¯æŒfilteræ–¹æ³•ã€‚è¯¥æ“ä½œè´¹æ¥å—ä¸€ä¸ªè°“è¯ï¼ˆä¸€ä¸ªè¿”å›booleançš„å‡½æ•°ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰ç¬¦åˆè°“è¯çš„å…ƒç´ çš„æµ123List&lt;Dish&gt; vegetarianMenu = menu.stream() .filter(Dish::isVegetarian) //ç­›é€‰å‡ºæ‰€æœ‰ç´ èœ .collect(toList()); ç­›é€‰å„å¼‚çš„å…ƒç´ æµè¿˜æ”¯æŒä¸€ä¸ªå«åšdistinctçš„æ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå…ƒç´ å„å¼‚ï¼ˆæ ¹æ®æµæ‰€ç”Ÿæˆå…ƒç´ çš„hashCodeå’Œequalsæ–¹æ³•å®ç°ï¼‰çš„æµã€‚12345List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 1, 3, 3, 2, 4); numbers.stream() .filter(i -&gt; i % 2 == 0) .distinct() .forEach(System.out::println); æˆªæ–­æµæµæ”¯æŒlimit(n)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªä¸è¶…è¿‡ç»™å®šé•¿åº¦çš„æµ1234List&lt;Dish&gt; dishes = menu.stream() .filter(d -&gt; d.getCalories() &gt; 300) .limit(3) .collect(toList()); è·³è¿‡å…ƒç´ æµè¿˜æ”¯æŒskip(n)æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰nä¸ªå…ƒç´ çš„æµã€‚å¦‚æœæµä¸­å…ƒç´ ä¸è¶³nä¸ªï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæµã€‚ æ˜ å°„ä»æŸäº›å¯¹è±¡ä¸­é€‰æ‹©ä¿¡æ¯ã€‚ï¼ˆä½¿ç”¨æ˜ å°„ä¸€è¯ï¼Œæ˜¯å› ä¸ºå®ƒå’Œè½¬æ¢ç±»ä¼¼ï¼Œä½†å…¶ä¸­çš„ç»†å¾®å·®åˆ«åœ¨äºå®ƒæ˜¯â€œåˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬â€è€Œä¸æ˜¯å»â€œä¿®æ”¹â€ï¼‰ å¯¹æµä¸­æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°æµæ”¯æŒmapæ–¹æ³•ï¼Œå®ƒä¼šæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ 123List&lt;String&gt; dishNames = menu.stream() .map(Dish::getName) .collect(toList()); æµçš„æ‰å¹³åŒ–å¯¹äºä¸€å¼ å•è¯è¡¨ï¼Œå¦‚ä½•è¿”å›ä¸€å¼ åˆ—è¡¨ï¼Œåˆ—å‡ºé‡Œé¢å„ä¸ç›¸åŒçš„å­—ç¬¦å‘¢ï¼Ÿä¾‹å¦‚ï¼Œç»™å®šå•è¯åˆ—è¡¨[â€œHelloâ€,â€Worldâ€]ï¼Œä½ æƒ³è¦è¿”å›åˆ—è¡¨[â€œHâ€,â€eâ€,â€lâ€, â€œoâ€,â€Wâ€,â€râ€,â€dâ€]ã€‚ ä½ å¯èƒ½ä¼šè®¤ä¸ºè¿™å¾ˆå®¹æ˜“ï¼Œä½ å¯ä»¥æŠŠæ¯ä¸ªå•è¯æ˜ å°„æˆä¸€å¼ å­—ç¬¦è¡¨ï¼Œç„¶åè°ƒç”¨distinctæ¥è¿‡æ»¤é‡å¤çš„å­—ç¬¦ã€‚ç¬¬ä¸€ä¸ªç‰ˆæœ¬å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š1234words.stream() .map(word -&gt; word.split(&quot;&quot;)) .distinct() .collect(toList()); è¿™ä¸ªæ–¹æ³•çš„é—®é¢˜åœ¨äºï¼Œä¼ é€’ç»™mapæ–¹æ³•çš„Lambdaä¸ºæ¯ä¸ªå•è¯è¿”å›äº†ä¸€ä¸ªString[]ï¼ˆStringåˆ—è¡¨ï¼‰ ã€‚å› æ­¤ï¼Œmapè¿”å›çš„æµå®é™…ä¸Šæ˜¯Stream&lt;String[]&gt;ç±»å‹çš„ã€‚ å°è¯•ä½¿ç”¨mapå’ŒArrays.stream()Arrays.stream()å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„å¹¶äº§ç”Ÿä¸€ä¸ªæµ12345words.stream() .map(word -&gt; word.split(&quot;&quot;)) .map(Arrays::stream) .distinct() .collect(toList()); å½“å‰çš„è§£å†³æ–¹æ¡ˆä»ç„¶æä¸å®šï¼è¿™æ˜¯å› ä¸ºï¼Œä½ ç°åœ¨å¾—åˆ°çš„æ˜¯ä¸€ä¸ªæµçš„åˆ—è¡¨ï¼ˆæ›´å‡†ç¡®åœ°è¯´æ˜¯Streamï¼‰ï¼çš„ç¡®ï¼Œä½ å…ˆæ˜¯æŠŠæ¯ä¸ªå•è¯è½¬æ¢æˆä¸€ä¸ªå­—æ¯æ•°ç»„ï¼Œç„¶åæŠŠæ¯ä¸ªæ•°ç»„å˜æˆäº†ä¸€ä¸ªç‹¬ç«‹çš„æµã€‚ ä½¿ç”¨flatMap123456List&lt;String&gt; uniqueCharacters = words.stream() .map(w -&gt; w.split(&quot;&quot;)) .flatMap(Arrays::stream) .distinct() .collect(Collectors.toList()); ä½¿ç”¨flatMapæ–¹æ³•çš„æ•ˆæœæ˜¯ï¼Œå„ä¸ªæ•°ç»„å¹¶ä¸æ˜¯åˆ†åˆ«æ˜ å°„æˆä¸€ä¸ªæµï¼Œè€Œæ˜¯æ˜ å°„æˆæµçš„å†…å®¹ã€‚æ‰€æœ‰ä½¿ç”¨map(Arrays::steam)æ—¶ç”Ÿæˆçš„å•ä¸ªæµè¢«åˆå¹¶èµ·æ¥ï¼Œå³æ‰å¹³åŒ–ä¸ºä¸€ä¸ªæµã€‚ æ€»è€Œè¨€ä¹‹ï¼Œflatmapæ–¹æ³•è®©ä½ æŠŠä¸€ä¸ªæµä¸­çš„æ¯ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰çš„æµè¿æ¥èµ·æ¥æˆä¸ºä¸€ä¸ªæµã€‚ æŸ¥æ‰¾å’ŒåŒ¹é…æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ anyMatchæ–¹æ³•â€œæµä¸­æ˜¯å¦æœ‰ä¸€ä¸ªå…ƒç´ èƒ½åŒ¹é…ç»™å®šçš„è°“è¯â€ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥çœ‹çœ‹èœå•é‡Œé¢æ˜¯å¦æœ‰ç´ é£Ÿå¯é€‰æ‹©ï¼š123if(menu.stream().anyMatch(Dish::isVegetarian))&#123; System.out.println(&quot;The menu is (somewhat) vegetarian friendly!!&quot;); &#125; æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ allMatchæ–¹æ³•çš„å·¥ä½œåŸç†å’ŒanyMatchç±»ä¼¼ï¼Œä½†å®ƒä¼šçœ‹çœ‹æµä¸­çš„å…ƒç´ æ˜¯å¦éƒ½èƒ½åŒ¹é…ç»™å®šçš„è°“è¯ noneMatchå’ŒallMatchç›¸å¯¹çš„æ˜¯noneMatchã€‚å®ƒå¯ä»¥ç¡®ä¿æµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ä¸ç»™å®šçš„è°“è¯åŒ¹é…ã€‚ anyMatchã€allMatchå’ŒnoneMatchè¿™ä¸‰ä¸ªæ“ä½œéƒ½ç”¨åˆ°äº†æˆ‘ä»¬æ‰€è°“çš„çŸ­è·¯ï¼Œè¿™å°±æ˜¯å¤§å®¶ç†Ÿæ‚‰çš„Javaä¸­&amp;&amp;å’Œ||è¿ç®—ç¬¦çŸ­è·¯åœ¨æµä¸­çš„ç‰ˆæœ¬ã€‚ çŸ­è·¯æ±‚å€¼æœ‰äº›æ“ä½œä¸éœ€è¦å¤„ç†æ•´ä¸ªæµå°±èƒ½å¾—åˆ°ç»“æœ æŸ¥æ‰¾å…ƒç´ findAnyæ–¹æ³•å°†è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ 1234Optional&lt;Dish&gt; dish = menu.stream() .filter(Dish::isVegetarian) .findAny(); Optional Optional&lt;T>ç±»ï¼ˆjava.util.Optionalï¼‰æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ï¼Œä»£è¡¨ä¸€ä¸ªå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨ isPresent() å°†åœ¨OptionalåŒ…å«å€¼çš„æ—¶å€™è¿”å›trueï¼Œå¦åˆ™è¿”å›false ifPresent(Consumer&lt;T> block) ä¼šåœ¨å€¼å­˜åœ¨çš„æ—¶å€™æ‰§è¡Œç»™å®šçš„ä»£ç å— T get() ä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªNoSuchElementå¼‚å¸¸ T orElse(T other) ä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼1234menu.stream() .filter(Dish::isVegetarian) .findAny() .ifPresent(d -&gt; System.out.println(d.getName()); æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ findFirst æ‰¾åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ åœ¨å¹¶è¡Œä¸Šé™åˆ¶æ›´å¤šã€‚å¦‚æœä½ ä¸å…³å¿ƒè¿”å›çš„å…ƒç´ æ˜¯å“ªä¸ªï¼Œè¯·ä½¿ç”¨findAnyï¼Œå› ä¸ºå®ƒåœ¨ä½¿ç”¨å¹¶è¡Œæµæ—¶é™åˆ¶è¾ƒå°‘ã€‚ å½’çº¦å°†æµä¸­æ‰€æœ‰å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚ç”¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„æœ¯è¯­æ¥è¯´ï¼Œè¿™ç§°ä¸ºæŠ˜å ï¼ˆfoldï¼‰ï¼Œå› ä¸ºä½ å¯ä»¥å°†è¿™ä¸ªæ“ä½œçœ‹æˆæŠŠä¸€å¼ é•¿é•¿çš„çº¸ï¼ˆä½ çš„æµï¼‰åå¤æŠ˜å æˆä¸€ä¸ªå°æ–¹å—ï¼Œè€Œè¿™å°±æ˜¯æŠ˜å æ“ä½œçš„ç»“æœã€‚ å…ƒç´ æ±‚å’Œint sum = numbers.stream() . reduce(0, (a,b) -&gt; a+b); reduce æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š ä¸€ä¸ªåˆå§‹å€¼ï¼Œè¿™é‡Œæ˜¯0ï¼› ä¸€ä¸ªBinaryOperator&lt;T>æ¥å°†ä¸¤ä¸ªå…ƒç´ ç»“åˆèµ·æ¥äº§ç”Ÿä¸€ä¸ªæ–°å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯lambda(a,b) -&gt; a+b åœ¨Java8ä¸­ï¼ŒIntegerç±»ç°åœ¨æœ‰äº†ä¸€ä¸ªé™æ€çš„sumæ–¹æ³•æ¥å¯¹ä¸¤ä¸ªæ•°æ±‚å’Œ int sum = numbers.stream().reduce(0, Integer::sum); reduceè¿˜æœ‰ä¸€ä¸ªé‡è½½çš„å˜ä½“ï¼Œå®ƒä¸æ¥å—åˆå§‹å€¼ï¼Œä½†æ˜¯ä¼šè¿”å›ä¸€ä¸ªOptionalå¯¹è±¡ï¼š Optional&lt;Integer&gt; sum = numbers.stream().reduce((a, b) -&gt; (a + b)); ä¸ºä»€ä¹ˆå®ƒè¿”å›ä¸€ä¸ªOptionalå‘¢ï¼Ÿè€ƒè™‘æµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ çš„æƒ…å†µã€‚reduceæ“ä½œæ— æ³•è¿”å›å…¶å’Œï¼Œå› ä¸ºå®ƒæ²¡æœ‰åˆå§‹å€¼ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç»“æœè¢«åŒ…è£¹åœ¨ä¸€ä¸ªOptionalå¯¹è±¡é‡Œï¼Œä»¥è¡¨æ˜å’Œå¯èƒ½ä¸å­˜åœ¨ æœ€å¤§å€¼å’Œæœ€å°å€¼Optional&lt;Integer&gt; max = numbers.stream().reduce(Integer::max); æ— çŠ¶æ€å’Œæœ‰çŠ¶æ€è¯¸å¦‚mapæˆ–filterç­‰æ“ä½œä¼šä»è¾“å…¥æµä¸­è·å–æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶åœ¨è¾“å‡ºæµä¸­å¾—åˆ°0æˆ–1ä¸ªç»“æœï¼Œè¿™äº›æ“ä½œä¸€èˆ¬éƒ½æ˜¯æ— çŠ¶æ€çš„ï¼šå®ƒä»¬æ²¡æœ‰å†…éƒ¨çŠ¶æ€ ä½†è¯¸å¦‚reduceã€sumã€maxç­‰æ“ä½œéœ€è¦å†…éƒ¨çŠ¶æ€æ¥ç§¯ç´¯ç»“æœï¼Œä¸ç®¡æµä¸­æœ‰å¤šå°‘å…ƒç´ è¦å¤„ç†ï¼Œå†…éƒ¨çŠ¶æ€éƒ½æ˜¯æœ‰ç•Œçš„ ç›¸åï¼Œè¯¸å¦‚sortæˆ–distinctç­‰æ“ä½œä¸€å¼€å§‹éƒ½å’Œfilterå’Œmapå·®ä¸å¤šâ€”â€”éƒ½æ˜¯æ¥å—ä¸€ä¸ªæµï¼Œå†ç”Ÿæˆä¸€ä¸ªæµï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®çš„åŒºåˆ«ï¼šä»æµä¸­æ’åºå’Œåˆ é™¤é‡å¤é¡¹æ—¶éƒ½éœ€è¦çŸ¥é“å…ˆå‰çš„å†å²ã€‚ä¾‹å¦‚ï¼Œæ’åºè¦æ±‚æ‰€æœ‰å…ƒç´ éƒ½æ”¾å…¥ç¼“å†²åŒºåæ‰èƒ½ç»™è¾“å‡ºæµåŠ å…¥ä¸€ä¸ªé¡¹ç›®ï¼Œè¿™ä¸€æ“ä½œçš„å­˜å‚¨è¦æ±‚æ˜¯æ— ç•Œçš„ã€‚è¦æ˜¯æµæ¯”è¾ƒå¤§æˆ–æ˜¯æ— é™çš„ï¼Œå°±å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼ˆæŠŠè´¨æ•°æµå€’åºä¼šåšä»€ä¹ˆå‘¢ï¼Ÿå®ƒåº”å½“è¿”å›æœ€å¤§çš„è´¨æ•°ï¼Œä½†æ•°å­¦å‘Šè¯‰æˆ‘ä»¬å®ƒä¸å­˜åœ¨ï¼‰ã€‚æˆ‘ä»¬æŠŠè¿™äº›æ“ä½œå«ä½œæœ‰çŠ¶æ€æ“ä½œ ä¸­é—´æ“ä½œå’Œç»ˆç«¯æ“ä½œ æ“ä½œ ç±»å‹ è¿”å›ç±»å‹ ä½¿ç”¨çš„ç±»å‹/å‡½æ•°å¼æ¥å£ å‡½æ•°æè¿°ç¬¦ filter ä¸­é—´ Stream&lt;T> Predicate&lt;T> T -&gt; boolean distinct ä¸­é—´ (æœ‰çŠ¶æ€-æ— ç•Œ) Stream&lt;T> skip ä¸­é—´(æœ‰çŠ¶æ€-æœ‰ç•Œ) Stream&lt;T> long limit ä¸­é—´(æœ‰çŠ¶æ€-æœ‰ç•Œ) Stream&lt;T> long map ä¸­é—´ Stream&lt;T> Function&lt;T,R> T -&gt; R flatMap ä¸­é—´ Stream&lt;T> Function&lt;T,R> T -&gt; Stream&lt;R> sorted ä¸­é—´(æœ‰çŠ¶æ€-æ— ç•Œ) Stream&lt;T> Comparator (T,T) -&gt; int anyMatch ç»ˆç«¯ boolean Predicate&lt;T> T -&gt; boolean noneMatch ç»ˆç«¯ boolean Predicate&lt;T> T -&gt; boolean allMatch ç»ˆç«¯ boolean Predicate&lt;T> T -&gt; boolean findAny ç»ˆç«¯ Optional&lt;T> findFirst ç»ˆç«¯ Optional&lt;T> forEach ç»ˆç«¯ void Consumer&lt;T> T -&gt; void collect ç»ˆç«¯ R Collector&lt;T,A,R> reduce ç»ˆç«¯(æœ‰çŠ¶æ€-æœ‰ç•Œ) Optional&lt;T> BinaryOperator&lt;T> (T,T) -&gt; T count ç»ˆç«¯ long æ•°å€¼æµåŸå§‹ç±»å‹æµç‰¹åŒ–Java8å¼•å…¥äº†ä¸‰ä¸ªåŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥å£ï¼šInputStreamã€DoubleStreamå’ŒLongStreamï¼Œåˆ†åˆ«å°†æµä¸­çš„å…ƒç´ ç‰¹åŒ–ä¸ºintã€longå’Œdoubleï¼Œä»è€Œé¿å…äº†æš—å«çš„è£…ç®±æˆæœ¬ã€‚æ¯ä¸ªæ¥å£éƒ½å¸¦æ¥äº†è¿›è¡Œå¸¸ç”¨æ•°å€¼å½’çº¦çš„æ–°æ–¹æ³•ï¼Œæ¯”å¦‚å¯¹æ•°å€¼æµæ±‚å’Œçš„sumï¼Œæ‰¾åˆ°æœ€å¤§å…ƒç´ çš„maxï¼Œæ±‚å¹³å‡å€¼averageç­‰ã€‚ æ˜ å°„åˆ°æ•°å€¼æµ123int calories = menu.stream() .mapToInt(Dish::getCalories) .sum(); è½¬æ¢å›å¯¹è±¡æµ 123IntStream intStream = menu.stream().mapToInt(Dish::getCalories);//æ¯ä¸ªintéƒ½ä¼šè£…ç®±æˆä¸€ä¸ªInteger Stream&lt;Integer&gt; stream = intStream.boxed(); é»˜è®¤å€¼OptionalIntæ±‚å’Œçš„é‚£ä¸ªä¾‹å­å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒæœ‰ä¸€ä¸ªé»˜è®¤å€¼ï¼š0ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ è¦è®¡ç®—IntStreamä¸­çš„æœ€å¤§å…ƒç´ ï¼Œå°±å¾—æ¢ä¸ªæ³•å­äº†ï¼Œå› ä¸º0æ˜¯é”™è¯¯çš„ç»“æœã€‚å¦‚ä½•åŒºåˆ†æ²¡æœ‰å…ƒç´ çš„æµå’Œæœ€å¤§å€¼çœŸçš„æ˜¯0çš„æµå‘¢ï¼Ÿå‰é¢æˆ‘ä»¬ä»‹ç»äº†Optionalç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥è¡¨ç¤ºå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨çš„å®¹å™¨ã€‚Optionalå¯ä»¥ç”¨Integerã€Stringç­‰å‚è€ƒç±»å‹æ¥å‚æ•°åŒ–ã€‚å¯¹äºä¸‰ç§åŸå§‹æµç‰¹åŒ–ï¼Œä¹Ÿåˆ†åˆ«æœ‰ä¸€ä¸ªOptionalåŸå§‹ç±»å‹ç‰¹åŒ–ç‰ˆæœ¬ï¼šOptionalIntã€OptionalDoubleå’ŒOptionalLongã€‚123OptionalInt maxCalories = menu.stream() .mapToInt(Dish::getCalories) .max(); ç°åœ¨ï¼Œå¦‚æœæ²¡æœ‰æœ€å¤§å€¼çš„è¯ï¼Œä½ å°±å¯ä»¥æ˜¾å¼å¤„ç†OptionalIntå»å®šä¹‰ä¸€ä¸ªé»˜è®¤å€¼äº†ï¼š int max = maxCalories.orElse(1); æ•°å€¼èŒƒå›´å’Œæ•°å­—æ‰“äº¤é“æ—¶ï¼Œæœ‰ä¸€ä¸ªå¸¸ç”¨çš„ä¸œè¥¿å°±æ˜¯æ•°å€¼èŒƒå›´ã€‚æ¯”å¦‚ï¼Œå‡è®¾ä½ æƒ³è¦ç”Ÿæˆ1å’Œ100ä¹‹é—´çš„æ‰€æœ‰æ•°å­—ã€‚Java 8å¼•å…¥äº†ä¸¤ä¸ªå¯ä»¥ç”¨äºIntStreamå’ŒLongStreamçš„é™æ€æ–¹æ³•ï¼Œå¸®åŠ©ç”Ÿæˆè¿™ç§èŒƒå›´ï¼šrangeå’ŒrangeClosedã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ¥å—èµ·å§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ¥å—ç»“æŸå€¼ã€‚ä½†rangeæ˜¯ä¸åŒ…å«ç»“æŸå€¼çš„ï¼Œè€ŒrangeClosedåˆ™åŒ…å«ç»“æŸå€¼ã€‚123IntStream evenNumbers = IntStream.rangeClosed(1, 100) .filter(n -&gt; n % 2 == 0);System.out.println(evenNumbers.count()); æ„å»ºæµç”±å€¼åˆ›å»ºæµå¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•Stream.ofï¼Œé€šè¿‡æ˜¾å¼å€¼åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚12345Stream&lt;String&gt; stream = Stream.of(&quot;Java 8 &quot;, &quot;Lambdas &quot;, &quot;In &quot;, &quot;Action&quot;); stream.map(String::toUpperCase).forEach(System.out::println);//ä½¿ç”¨emptyå¾—åˆ°ä¸€ä¸ªç©ºæµStream&lt;String&gt; emptyStream = Stream.empty(); ç”±æ•°ç»„åˆ›å»ºæµå¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•Arrays.streamä»æ•°ç»„åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚12int[] numbers = &#123;2, 3, 5, 7, 11, 13&#125;; int sum = Arrays.stream(numbers).sum(); ç”±æ–‡ä»¶ç”ŸæˆæµJavaä¸­ç”¨äºå¤„ç†æ–‡ä»¶ç­‰I/Oæ“ä½œçš„NIO APIï¼ˆéé˜»å¡ I/Oï¼‰å·²æ›´æ–°ï¼Œä»¥ä¾¿åˆ©ç”¨Stream APIã€‚java.nio.file.Filesä¸­çš„å¾ˆå¤šé™æ€æ–¹Files.linesï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªç”±æŒ‡å®šæ–‡ä»¶ä¸­çš„å„è¡Œæ„æˆçš„å­—ç¬¦ä¸²æµ123456789long uniqueWords = 0; try(Stream&lt;String&gt; lines = Files.lines(Paths.get(&quot;data.txt&quot;), Charset.defaultCharset()))&#123; uniqueWords = lines.flatMap(line -&gt; Arrays.stream(line.split(&quot; &quot;))) .distinct() .count(); &#125; catch(IOException e)&#123; &#125; ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµStream APIæä¾›äº†ä¸¤ä¸ªé™æ€æ–¹æ³•æ¥ä»å‡½æ•°ç”Ÿæˆæµï¼šStream.iterateå’ŒStream.generateã€‚è¿™ä¸¤ä¸ªæ“ä½œå¯ä»¥åˆ›å»ºæ‰€è°“çš„æ— é™æµï¼šä¸åƒä»å›ºå®šé›†åˆåˆ›å»ºçš„æµé‚£æ ·æœ‰å›ºå®šå¤§å°çš„æµã€‚ç”±iterateå’Œgenerateäº§ç”Ÿçš„æµä¼šç”¨ç»™å®šçš„å‡½æ•°æŒ‰éœ€åˆ›å»ºå€¼ï¼Œå› æ­¤å¯ä»¥æ— ç©·æ— å°½åœ°è®¡ç®—ä¸‹å»ï¼ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥ä½¿ç”¨limit(n)æ¥å¯¹è¿™ç§æµåŠ ä»¥é™åˆ¶ï¼Œä»¥é¿å…æ‰“å°æ— ç©·å¤šä¸ªå€¼ã€‚ è¿­ä»£123Stream.iterate(0, n -&gt; n + 2) .limit(10) .forEach(System.out::println); iterateæ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ªæ‰€æœ‰æ­£å¶æ•°çš„æµï¼šæµçš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯åˆå§‹å€¼0ã€‚ç„¶ååŠ ä¸Š2æ¥ç”Ÿæˆæ–°çš„å€¼2ï¼Œå†åŠ ä¸Š2æ¥å¾—åˆ°æ–°çš„å€¼4ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™ç§iterateæ“ä½œåŸºæœ¬ä¸Šæ˜¯é¡ºåºçš„ï¼Œå› ä¸ºç»“æœå–å†³äºå‰ä¸€æ¬¡åº”ç”¨ã€‚è¯·æ³¨æ„ï¼Œæ­¤æ“ä½œå°†ç”Ÿæˆä¸€ä¸ªæ— é™æµâ€”â€”è¿™ä¸ªæµæ²¡æœ‰ç»“å°¾ï¼Œå› ä¸ºå€¼æ˜¯æŒ‰éœ€è®¡ç®—çš„ï¼Œå¯ä»¥æ°¸è¿œè®¡ç®—ä¸‹å»ã€‚æˆ‘ä»¬è¯´è¿™ä¸ªæµæ˜¯æ— ç•Œçš„ã€‚æ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è®¨è®ºçš„ï¼Œè¿™æ˜¯æµå’Œé›†åˆä¹‹é—´çš„ä¸€ä¸ªå…³é”®åŒºåˆ«ã€‚ ç”Ÿæˆ ä¸iterateæ–¹æ³•ç±»ä¼¼ï¼Œgenerateæ–¹æ³•ä¹Ÿå¯è®©ä½ æŒ‰éœ€ç”Ÿæˆä¸€ä¸ªæ— é™æµã€‚ä½†generateä¸æ˜¯ä¾æ¬¡å¯¹æ¯ä¸ªæ–°ç”Ÿæˆçš„å€¼åº”ç”¨å‡½æ•°çš„ã€‚å®ƒæ¥å—ä¸€ä¸ªSupplierç±»å‹çš„Lambdaæä¾›æ–°çš„å€¼123Stream.generate(Math::random) .limit(5) .forEach(System.out::println); å°ç»“ Streams APIå¯ä»¥è¡¨è¾¾å¤æ‚çš„æ•°æ®å¤„ç†æŸ¥è¯¢ã€‚ ä½ å¯ä»¥ä½¿ç”¨filterã€distinctã€skipå’Œlimitå¯¹æµåšç­›é€‰å’Œåˆ‡ç‰‡ã€‚ ä½ å¯ä»¥ä½¿ç”¨mapå’ŒflatMapæå–æˆ–è½¬æ¢æµä¸­çš„å…ƒç´ ã€‚ ä½ å¯ä»¥ä½¿ç”¨findFirstå’ŒfindAnyæ–¹æ³•æŸ¥æ‰¾æµä¸­çš„å…ƒç´ ã€‚ä½ å¯ä»¥ç”¨allMatchã€noneMatchå’ŒanyMatchæ–¹æ³•è®©æµåŒ¹é…ç»™å®šçš„è°“è¯ã€‚ è¿™äº›æ–¹æ³•éƒ½åˆ©ç”¨äº†çŸ­è·¯ï¼šæ‰¾åˆ°ç»“æœå°±ç«‹å³åœæ­¢è®¡ç®—ï¼›æ²¡æœ‰å¿…è¦å¤„ç†æ•´ä¸ªæµã€‚ ä½ å¯ä»¥åˆ©ç”¨reduceæ–¹æ³•å°†æµä¸­æ‰€æœ‰çš„å…ƒç´ è¿­ä»£åˆå¹¶æˆä¸€ä¸ªç»“æœï¼Œä¾‹å¦‚æ±‚å’Œæˆ–æŸ¥æ‰¾æœ€å¤§å…ƒç´ ã€‚ filterå’Œmapç­‰æ“ä½œæ˜¯æ— çŠ¶æ€çš„ï¼Œå®ƒä»¬å¹¶ä¸å­˜å‚¨ä»»ä½•çŠ¶æ€ã€‚reduceç­‰æ“ä½œè¦å­˜å‚¨çŠ¶æ€æ‰èƒ½è®¡ç®—å‡ºä¸€ä¸ªå€¼ã€‚sortedå’Œdistinctç­‰æ“ä½œä¹Ÿè¦å­˜å‚¨çŠ¶æ€ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦æŠŠæµä¸­çš„æ‰€æœ‰å…ƒç´ ç¼“å­˜èµ·æ¥æ‰èƒ½è¿”å›ä¸€ä¸ªæ–°çš„æµã€‚è¿™ç§æ“ä½œç§°ä¸ºæœ‰çŠ¶æ€æ“ä½œã€‚ æµæœ‰ä¸‰ç§åŸºæœ¬çš„åŸå§‹ç±»å‹ç‰¹åŒ–ï¼šIntStreamã€DoubleStreamå’ŒLongStreamã€‚å®ƒä»¬çš„æ“ä½œä¹Ÿæœ‰ç›¸åº”çš„ç‰¹åŒ–ã€‚ æµä¸ä»…å¯ä»¥ä»é›†åˆåˆ›å»ºï¼Œä¹Ÿå¯ä»å€¼ã€æ•°ç»„ã€æ–‡ä»¶ä»¥åŠiterateä¸generateç­‰ç‰¹å®šæ–¹æ³•åˆ›å»ºã€‚ æ— é™æµæ˜¯æ²¡æœ‰å›ºå®šå¤§å°çš„æµã€‚ ç”¨æµæ”¶é›†æ•°æ®ä¸¾ä¸ªæ —å­ğŸ‚123//å¯¹äº¤æ˜“æŒ‰ç…§è´§å¸åˆ†ç»„Map&lt;Currency, List&lt;Transaction&gt;&gt; transactionsByCurrencies = transactions.stream().collect(groupingBy(Transaction::getCurrency)); å‡½æ•°å¼ç¼–ç¨‹ç›¸å¯¹äºæŒ‡ä»¤å¼ç¼–ç¨‹çš„ä¸€ä¸ªä¸»è¦ä¼˜åŠ¿ï¼šä½ åªéœ€è¦æŒ‡å‡ºå¸Œæœ›çš„ç»“æœâ€”â€”â€œåšä»€ä¹ˆâ€ï¼Œè€Œä¸ç”¨æ“å¿ƒæ‰§è¡Œçš„æ­¥éª¤â€”â€”â€œå¦‚ä½•åšâ€ã€‚åœ¨ä¸Šä¸€ä¸ªä¾‹å­é‡Œï¼Œä¼ é€’ç»™collectæ–¹æ³•çš„å‚æ•°æ˜¯Collectoræ¥å£çš„ä¸€ä¸ªå®ç° å¯¹æµè°ƒç”¨collectæ–¹æ³•å°†å¯¹æµä¸­çš„å…ƒç´ è§¦å‘ä¸€ä¸ªå½’çº¦æ“ä½œï¼ˆç”±Collectoræ¥å‚æ•°åŒ–ï¼‰ Collectoræ¥å£ä¸­æ–¹æ³•çš„å®ç°å†³å®šäº†å¦‚ä½•å¯¹æµæ‰§è¡Œå½’çº¦æ“ä½œï¼›Collectorsç±»æä¾›äº†å¾ˆå¤šé™æ€å·¥å‚æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå¸¸è§æ”¶é›†å™¨å®ä¾‹ å½’çº¦ä¸æ±‡æ€»1234import static java.util.stream.Collectors.*; long howManyDishes = menu.stream().collect(counting()); //æˆ–è€…long howManyDishes = menu.stream().count(); æŸ¥æ‰¾æµä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼Collectors.maxByå’ŒCollectors.minByï¼Œæ¥è®¡ç®—æµä¸­çš„æœ€å¤§æˆ–æœ€å°å€¼ã€‚è¿™ä¸¤ä¸ªæ”¶é›†å™¨æ¥æ”¶ä¸€ä¸ªComparatorå‚æ•°æ¥æ¯”è¾ƒæµä¸­çš„å…ƒç´ ã€‚ 12345Comparator&lt;Dish&gt; dishCaloriesComparator = Comparator.comparingInt(Dish::getCalories); Optional&lt;Dish&gt; mostCalorieDish = menu.stream() .collect(maxBy(dishCaloriesComparator)); æ±‡æ€»Collectors.summingIntã€‚å®ƒå¯æ¥å—ä¸€ä¸ªæŠŠå¯¹è±¡æ˜ å°„ä¸ºæ±‚å’Œæ‰€éœ€intçš„å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ”¶é›†å™¨ int totalCalories = menu.stream().collect(summingInt(Dish::getCalories)); Collectors.summingLongå’ŒCollectors.summingDoubleæ–¹æ³•çš„ä½œç”¨å®Œå…¨ä¸€æ ·ï¼Œå¯ä»¥ç”¨äºæ±‚å’Œå­—æ®µä¸ºlongæˆ–doubleçš„æƒ…å†µ æ±‡æ€»ä¸ä»…ä»…æ˜¯æ±‚å’Œï¼›è¿˜æœ‰Collectors.averagingIntï¼Œè¿åŒå¯¹åº”çš„averagingLongå’ŒaveragingDoubleå¯ä»¥è®¡ç®—æ•°å€¼çš„å¹³å‡æ•° ä½ å¯èƒ½æƒ³è¦å¾—åˆ°ä¸¤ä¸ªæˆ–æ›´å¤šè¿™æ ·çš„ç»“æœï¼Œè€Œä¸”ä½ å¸Œæœ›åªéœ€ä¸€æ¬¡æ“ä½œå°±å¯ä»¥å®Œæˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨summarizingIntå·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ä¸€æ¬¡summarizingæ“ä½œä½ å¯ä»¥å°±æ•°å‡ºèœå•ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œå¹¶å¾—åˆ°èœè‚´çƒ­é‡æ€»å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼š12IntSummaryStatistics menuStatistics = menu.stream().collect(summarizingInt(Dish::getCalories)); è¿™ä¸ªæ”¶é›†å™¨ä¼šæŠŠæ‰€æœ‰è¿™äº›ä¿¡æ¯æ”¶é›†åˆ°ä¸€ä¸ªå«ä½œIntSummaryStatisticsçš„ç±»é‡Œï¼Œå®ƒæä¾›äº†æ–¹ä¾¿çš„å–å€¼ï¼ˆgetterï¼‰æ–¹æ³•æ¥è®¿é—®ç»“æœã€‚æ‰“å°menuStatisticobjectä¼šå¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼š12IntSummaryStatistics&#123;count=9, sum=4300, min=120, average=477.777778, max=800&#125; åŒæ ·ï¼Œç›¸åº”çš„summarizingLongå’ŒsummarizingDoubleå·¥å‚æ–¹æ³•æœ‰ç›¸å…³çš„LongSummary- Statisticså’ŒDoubleSummaryStatisticsç±»å‹ï¼Œé€‚ç”¨äºæ”¶é›†çš„å±æ€§æ˜¯åŸå§‹ç±»å‹longæˆ–doubleçš„æƒ…å†µã€‚ è¿æ¥å­—ç¬¦ä¸²joiningå·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨ä¼šæŠŠå¯¹æµä¸­æ¯ä¸€ä¸ªå¯¹è±¡åº”ç”¨toStringæ–¹æ³•å¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œjoiningåœ¨å†…éƒ¨ä½¿ç”¨äº†StringBuilderæ¥æŠŠç”Ÿæˆçš„å­—ç¬¦ä¸²é€ä¸ªè¿½åŠ èµ·æ¥ String shortMenu = menu.stream().map(Dish::getName).collect(joining()); joiningå·¥å‚æ–¹æ³•æœ‰ä¸€ä¸ªé‡è½½ç‰ˆæœ¬å¯ä»¥æ¥å—å…ƒç´ ä¹‹é—´çš„åˆ†ç•Œç¬¦ String shortMenu = menu.stream().map(Dish::getName).collect(joining(&quot;, &quot;); å¹¿ä¹‰çš„å½’çº¦æ±‡æ€»äº‹å®ä¸Šï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºçš„æ‰€æœ‰æ”¶é›†å™¨ï¼Œéƒ½æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨reducingå·¥å‚æ–¹æ³•å®šä¹‰çš„å½’çº¦è¿‡ç¨‹çš„ç‰¹æ®Šæƒ…å†µè€Œå·²ã€‚Collectors.reducingå·¥å‚æ–¹æ³•æ˜¯æ‰€æœ‰è¿™äº›ç‰¹æ®Šæƒ…å†µçš„ä¸€èˆ¬åŒ–12int totalCalories = menu.stream().collect(reducing( 0, Dish::getCalories, (i, j) -&gt; i + j)); å®ƒéœ€è¦ä¸‰ä¸ªå‚æ•°ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½’çº¦æ“ä½œçš„èµ·å§‹å€¼ï¼Œä¹Ÿæ˜¯æµä¸­æ²¡æœ‰å…ƒç´ æ—¶çš„è¿”å›å€¼ï¼Œæ‰€ä»¥å¾ˆæ˜¾ç„¶å¯¹äºæ•°å€¼å’Œè€Œè¨€0æ˜¯ä¸€ä¸ªåˆé€‚çš„å€¼ã€‚ ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯å°†èœè‚´è½¬æ¢æˆä¸€ä¸ªè¡¨ç¤ºå…¶æ‰€å«çƒ­é‡çš„intã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªBinaryOperatorï¼Œå°†ä¸¤ä¸ªé¡¹ç›®ç´¯ç§¯æˆä¸€ä¸ªåŒç±»å‹çš„å€¼ã€‚è¿™é‡Œå®ƒå°±æ˜¯å¯¹ä¸¤ä¸ªintæ±‚å’Œã€‚ åŒæ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ ·å•å‚æ•°å½¢å¼çš„reducingæ¥æ‰¾åˆ°çƒ­é‡æœ€é«˜çš„èœ123Optional&lt;Dish&gt; mostCalorieDish = menu.stream().collect(reducing( (d1, d2) -&gt; d1.getCalories() &gt; d2.getCalories() ? d1 : d2)); ä½ å¯ä»¥æŠŠå•å‚æ•°reducingå·¥å‚æ–¹æ³•åˆ›å»ºçš„æ”¶é›†å™¨çœ‹ä½œä¸‰å‚æ•°æ–¹æ³•çš„ç‰¹æ®Šæƒ…å†µï¼Œå®ƒæŠŠæµä¸­çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ä½œä¸ºèµ·ç‚¹ï¼ŒæŠŠæ’ç­‰å‡½æ•°ï¼ˆå³ä¸€ä¸ªå‡½æ•°ä»…ä»…æ˜¯è¿”å›å…¶è¾“å…¥å‚æ•°ï¼‰ä½œä¸ºä¸€ä¸ªè½¬æ¢å‡½æ•°ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œè¦æ˜¯æŠŠå•å‚æ•°reducingæ”¶é›†å™¨ä¼ é€’ç»™ç©ºæµçš„collectæ–¹æ³•ï¼Œæ”¶é›†å™¨å°±æ²¡æœ‰èµ·ç‚¹ï¼›å®ƒå°†å› æ­¤è€Œè¿”å›ä¸€ä¸ªOptionalå¯¹è±¡ã€‚ reduceæ–¹æ³•æ—¨åœ¨æŠŠä¸¤ä¸ªå€¼ç»“åˆèµ·æ¥ç”Ÿæˆä¸€ä¸ªæ–°å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯å˜çš„å½’çº¦ï¼›äºæ­¤ç›¸åï¼Œcollectæ–¹æ³•çš„è®¾è®¡å°±æ˜¯è¦æ”¹å˜å®¹å™¨ï¼Œä»è€Œç´¯ç§¯è¦è¾“å‡ºçš„ç»“æœ reducingæ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ªBinaryOperator&lt;t>ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªBiFunction&lt;T,T,T>ã€‚è¿™å°±æ„å‘³ç€å®ƒéœ€è¦çš„å‡½æ•°å¿…é¡»èƒ½æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªç›¸åŒç±»å‹çš„å€¼ 123456789101112//å°±å®é™…åº”ç”¨è€Œè¨€ï¼Œä¸ç®¡æ˜¯ä»å¯è¯»æ€§è¿˜æ˜¯æ€§èƒ½æ–¹é¢è€ƒè™‘ï¼Œæˆ‘ä»¬å§‹ç»ˆå»ºè®®ä½¿ç”¨joiningæ”¶é›†å™¨ã€‚String shortMenu = menu.stream().map(Dish::getName).collect(joining());String shortMenu = menu.stream().map(Dish::getName) .collect( reducing ( (s1, s2) -&gt; s1 + s2 ) ).get();String shortMenu = menu.stream() .collect( reducing( &quot;&quot;,Dish::getName, (s1, s2) -&gt; s1 + s2 ) ); //æ— æ³•ç¼–è¯‘ï¼Œè¿™é‡Œç”¨çš„Lambdaè¡¨è¾¾å¼æ¥å—çš„å‚æ•°æ˜¯ä¸¤ä¸ªèœï¼Œè¿”å›çš„å´æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚String shortMenu = menu.stream() .collect( reducing( (d1, d2) -&gt; d1.getName() + d2.getName() ) ).get(); åˆ†ç»„123456Map&lt;Dish.Type, List&lt;Dish&gt;&gt; dishesByType = menu.stream().collect(groupingBy(Dish::getType));//ç»“æœ&#123;FISH=[prawns, salmon], OTHER=[french fries, rice, season fruit, pizza], MEAT=[pork, beef, chicken]&#125; åˆ†ç±»å‡½æ•°ä¸ä¸€å®šåƒæ–¹æ³•å¼•ç”¨é‚£æ ·å¯ç”¨ï¼Œå› ä¸ºä½ æƒ³ç”¨ä»¥åˆ†ç±»çš„æ¡ä»¶å¯èƒ½æ¯”ç®€å•çš„å±æ€§è®¿é—®å™¨è¦å¤æ‚ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³æŠŠçƒ­é‡ä¸åˆ°400å¡è·¯é‡Œçš„èœåˆ’åˆ†ä¸ºâ€œä½çƒ­é‡â€ï¼ˆdietï¼‰ï¼Œçƒ­é‡400åˆ°700å¡è·¯é‡Œçš„èœåˆ’ä¸ºâ€œæ™®é€šâ€ï¼ˆnormalï¼‰ï¼Œé«˜äº700å¡è·¯é‡Œçš„åˆ’ä¸ºâ€œé«˜çƒ­é‡â€ï¼ˆfatï¼‰ã€‚ç”±äºDishç±»çš„ä½œè€…æ²¡æœ‰æŠŠè¿™ä¸ªæ“ä½œå†™æˆä¸€ä¸ªæ–¹æ³•ï¼Œä½ æ— æ³•ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼Œä½†ä½ å¯ä»¥æŠŠè¿™ä¸ªé€»è¾‘å†™æˆLambdaè¡¨è¾¾å¼ï¼š123456789public enum CaloricLevel &#123; DIET, NORMAL, FAT &#125; Map&lt;CaloricLevel, List&lt;Dish&gt;&gt; dishesByCaloricLevel = menu.stream().collect( groupingBy(dish -&gt; &#123; if (dish.getCalories() &lt;= 400) return CaloricLevel.DIET; else if (dish.getCalories() &lt;= 700) return CaloricLevel.NORMAL; else return CaloricLevel.FAT; &#125; )); å¤šçº§åˆ†ç»„è¦å®ç°å¤šçº§åˆ†ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç”±åŒå‚æ•°ç‰ˆæœ¬çš„Collectors.groupingByå·¥å‚æ–¹æ³•åˆ›å»ºçš„æ”¶é›†å™¨ï¼Œå®ƒé™¤äº†æ™®é€šçš„åˆ†ç±»å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ¥å—collectorç±»å‹çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚é‚£ä¹ˆè¦è¿›è¡ŒäºŒçº§åˆ†ç»„çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå†…å±‚groupingByä¼ é€’ç»™å¤–å±‚groupingByï¼Œå¹¶å®šä¹‰ä¸€ä¸ªä¸ºæµä¸­é¡¹ç›®åˆ†ç±»çš„äºŒçº§æ ‡å‡† 123456789101112131415Map&lt;Dish.Type, Map&lt;CaloricLevel, List&lt;Dish&gt;&gt;&gt; dishesByTypeCaloricLevel = menu.stream().collect( groupingBy(Dish::getType, groupingBy(dish -&gt; &#123; if (dish.getCalories() &lt;= 400) return CaloricLevel.DIET; else if (dish.getCalories() &lt;= 700) return CaloricLevel.NORMAL; else return CaloricLevel.FAT; &#125; ) ) ); //ç»“æœ&#123;MEAT=&#123;DIET=[chicken], NORMAL=[beef], FAT=[pork]&#125;, FISH=&#123;DIET=[prawns], NORMAL=[salmon]&#125;, OTHER=&#123;DIET=[rice, seasonal fruit], NORMAL=[french fries, pizza]&#125;&#125; åˆ†åŒºåˆ†åŒºæ˜¯åˆ†ç»„çš„ç‰¹æ®Šæƒ…å†µï¼šç”±ä¸€ä¸ªè°“è¯ï¼ˆè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„å‡½æ•°ï¼‰ä½œä¸ºåˆ†ç±»å‡½æ•°ï¼Œç§°ä¸ºåˆ†åŒºå‡½æ•°ã€‚ 12Map&lt;Boolean, List&lt;Dish&gt;&gt; partitionedMenu = menu.stream().collect(partioningBy(Dish::isVegetarian)); Collectorsç±»çš„é™æ€å·¥å‚æ–¹æ³• å·¥å‚æ–¹æ³• è¿”å›ç±»å‹ ç”¨äº ä½¿ç”¨ç¤ºä¾‹ toList List æŠŠæµä¸­æ‰€æœ‰é¡¹ç›®æ”¶é›†åˆ°ä¸€ä¸ªList List dishes = menuStream.collect(toList()); toSet Set æŠŠæµä¸­æ‰€æœ‰é¡¹ç›®æ”¶é›†åˆ°ä¸€ä¸ªSetï¼Œåˆ é™¤é‡å¤é¡¹ Set dishes = menuStream.collect(toSet()); toCollection Collection æŠŠæµä¸­æ‰€æœ‰é¡¹ç›®æ”¶é›†åˆ°ç»™å®šçš„ä¾›åº”æºåˆ›å»ºçš„é›†åˆ Collection dishes = menuStream.collect(toCollection(), ArrayList::new); counting Long è®¡ç®—æµä¸­å…ƒç´ çš„ä¸ªæ•° long howManyDishes = menuStream.collect(counting()); summingInt Integer å¯¹æµä¸­é¡¹ç›®çš„ä¸€ä¸ªæ•´æ•°å±æ€§æ±‚å’Œ int totalCalories = menuStream.collect(summingInt(Dish::getCalories)); averagingInt Double è®¡ç®—æµä¸­é¡¹ç›®Integerå±æ€§çš„å¹³å‡å€¼ double avgCalories = menuStream.collect(averagingInt(Dish::getCalories)) summarizingInt IntSummaryStatistics æ”¶é›†å…³äºæµä¸­é¡¹ç›®Integerå±æ€§çš„ç»Ÿè®¡å€¼ï¼Œä¾‹å¦‚æœ€å¤§ã€æœ€å°ã€æ€»å’Œä¸å¹³å‡å€¼ IntSummaryStatistics menuStatistics = menuStream.collect(summarizingInt(Dish::getCalories)); joining String è¿æ¥å¯¹æµä¸­æ¯ä¸ªé¡¹ç›®è°ƒç”¨toStringæ–¹æ³•æ‰€ç”Ÿæˆçš„å­—ç¬¦ä¸² String shortMenu = menuStream.map(Dish::getName).collect(joining(â€œ, â€œ)); maxBy Optional ä¸€ä¸ªåŒ…è£¹äº†æµä¸­æŒ‰ç…§ç»™å®šæ¯”è¾ƒå™¨é€‰å‡ºçš„æœ€å¤§å…ƒç´ çš„Optionalï¼Œæˆ–å¦‚æœæµä¸ºç©ºåˆ™ä¸ºOptional.empty() Optional fattest = menuStream.collect(maxBy(comparingInt(Dish::getCalories))); minBy Optional ä¸€ä¸ªåŒ…è£¹äº†æµä¸­æŒ‰ç…§ç»™å®šæ¯”è¾ƒå™¨é€‰å‡ºçš„æœ€å°å…ƒç´ çš„Optionalï¼Œæˆ–å¦‚æœæµä¸ºç©ºåˆ™ä¸ºOptional.empty() Optional lightest = menuStream.collect(minBy(comparingInt(Dish::getCalories))); reducing å½’çº¦æ“ä½œäº§ç”Ÿçš„ç±»å‹ ä»ä¸€ä¸ªä½œä¸ºç´¯åŠ å™¨çš„åˆå§‹å€¼å¼€å§‹ï¼Œåˆ©ç”¨BinaryOperatorä¸æµä¸­çš„å…ƒç´ é€ä¸ªç»“åˆï¼Œä»è€Œå°†æµå½’çº¦ä¸ºå•ä¸ªå€¼ int totalCalories = menuStream.collect(reducing(0, Dish::getCalories, Integer::sum)); collectingAndThen è½¬æ¢å‡½æ•°è¿”å›çš„ç±»å‹ åŒ…è£¹å¦ä¸€ä¸ªæ”¶é›†å™¨ï¼Œå¯¹å…¶ç»“æœåº”ç”¨è½¬æ¢å‡½æ•° int howManyDishes = menuStream.collect(collectingAndThen(toList(), List::size)); groupingBy Map&lt;K, List&gt; æ ¹æ®é¡¹ç›®çš„ä¸€ä¸ªå±æ€§çš„å€¼å¯¹æµä¸­çš„é¡¹ç›®ä½œé—®ç»„ï¼Œå¹¶å°†å±æ€§å€¼ä½œä¸ºç»“æœMapçš„é”® Map&lt;Dish.Type,List&gt; dishesByType = menuStream.collect(groupingBy(Dish::getType)); partitioningBy Map&lt;Boolean,List&gt; æ ¹æ®å¯¹æµä¸­æ¯ä¸ªé¡¹ç›®åº”ç”¨è°“è¯çš„ç»“æœæ¥å¯¹é¡¹ç›®è¿›è¡Œåˆ†åŒº Map&lt;Boolean,List&gt; vegetarianDishes = menuStream.collect(partitioningBy(Dish::isVegetarian));","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Lambdaè¡¨è¾¾å¼ã€Java8å®æˆ˜ã€‘","slug":"Lambdaè¡¨è¾¾å¼ã€Java8å®æˆ˜ã€‘","date":"2018-04-29T05:53:37.000Z","updated":"2018-05-07T04:52:50.825Z","comments":true,"path":"2018/04/29/Lambdaè¡¨è¾¾å¼ã€Java8å®æˆ˜ã€‘/","link":"","permalink":"https://hsb786.github.io/2018/04/29/Lambdaè¡¨è¾¾å¼ã€Java8å®æˆ˜ã€‘/","excerpt":"Lambdaè¡¨è¾¾å¼ï¼Œç®€æ´åœ°è¡¨ç¤ºä¸€ä¸ªè¡Œä¸ºæˆ–ä¼ é€’ä»£ç ã€‚ä½ å¯ä»¥æŠŠLambdaè¡¨è¾¾å¼çœ‹ä½œåŒ¿åå‡½æ•°ï¼Œå®ƒåŸºæœ¬ä¸Šå°±æ˜¯æ²¡æœ‰å£°æ˜åç§°çš„æ–¹æ³•ï¼Œä½†å’ŒåŒ¿åç±»ä¸€æ ·ï¼Œå®ƒå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•ã€‚","text":"Lambdaè¡¨è¾¾å¼ï¼Œç®€æ´åœ°è¡¨ç¤ºä¸€ä¸ªè¡Œä¸ºæˆ–ä¼ é€’ä»£ç ã€‚ä½ å¯ä»¥æŠŠLambdaè¡¨è¾¾å¼çœ‹ä½œåŒ¿åå‡½æ•°ï¼Œå®ƒåŸºæœ¬ä¸Šå°±æ˜¯æ²¡æœ‰å£°æ˜åç§°çš„æ–¹æ³•ï¼Œä½†å’ŒåŒ¿åç±»ä¸€æ ·ï¼Œå®ƒå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•ã€‚ åŒ¿åâ€”â€”å®ƒä¸åƒæ™®é€šçš„æ–¹æ³•é‚£æ ·æœ‰ä¸€ä¸ªæ˜ç¡®çš„åç§° å‡½æ•°â€”â€”Lambdaå‡½æ•°ä¸åƒæ–¹æ³•é‚£æ ·å±äºæŸä¸ªç‰¹å®šçš„ç±»ã€‚ä½†å’Œæ–¹æ³•ä¸€æ ·ï¼ŒLambdaæœ‰å‚æ•°åˆ—è¡¨ã€å‡½æ•°ä¸»ä½“ã€è¿”å›ç±»å‹ï¼Œè¿˜å¯èƒ½æœ‰å¯ä»¥æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ ä¼ é€’â€”â€”Lambdaè¡¨è¾¾å¼å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•æˆ–å­˜å‚¨åœ¨å˜é‡ä¸­ ç®€æ´â€”â€”æ— éœ€åƒåŒ¿åç±»é‚£æ ·å†™å¾ˆå¤šæ¨¡å—ä»£ç  Lambdaè¡¨è¾¾å¼æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š å‚æ•°åˆ—è¡¨ ç®­å¤´ Lambdaä¸»ä½“ åŸºæœ¬è¯­æ³•ï¼š (parameters) -&gt; expression (parameters) -&gt; { statements; } () -&gt; â€œRaoulâ€ () -&gt; { return â€œRaoulâ€; }Lambdaéšå«returnï¼Œä½ ä¹Ÿå¯ä»¥æ˜¾å¼è¿”å›è¯­å¥ Lambdaå®ä¾‹ï¼š ä½¿ç”¨æ¡ˆä¾‹ Lambdaå®ä¾‹ å¸ƒå°”è¡¨è¾¾å¼ (List list) -&gt; list.isEmpty() åˆ›å»ºå¯¹è±¡ () -&gt; new Apple(10) æ¶ˆè´¹ä¸€ä¸ªå¯¹è±¡ (Apple a) -&gt; { System.out.println(a.getWeight()); } ä»ä¸€ä¸ªå¯¹è±¡ä¸­é€‰æ‹©/æŠ½å– (String s) -&gt; s.length() ç»„åˆä¸¤ä¸ªå€¼ (int a,int b) -&gt; a*b æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ (Apple a2,Apple a2) -&gt; a1.getWeight().compareTo(a2.getWeight()) å¯ä»¥åœ¨å‡½æ•°å¼æ¥å£ä¸Šä½¿ç”¨Lambdaè¡¨è¾¾å¼ å‡½æ•°å¼æ¥å£å‡½æ•°å¼æ¥å£å°±æ˜¯åªå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ 123456789//java.util.Comparatorpublic interface Comparator&lt;T&gt; &#123; int compare(T o1, T o2); &#125; //java.lang.Runnablepublic interface Runnable&#123; void run(); &#125; ä½œç”¨Lambdaè¡¨è¾¾å¼å…è®¸ä½ ç›´æ¥ä»¥å†…è”çš„å½¢å¼ä¸ºå‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•æä¾›å®ç°ï¼Œå¹¶æŠŠæ•´ä¸ªè¡¨è¾¾å¼ä½œä¸ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹ï¼ˆå…·ä½“æ¥è¯´ï¼Œæ˜¯å‡½æ•°å¼æ¥å£ä¸€ä¸ªå…·ä½“å®ç°çš„å®ä¾‹ï¼‰ã€‚ä½ ç”¨åŒ¿åå†…éƒ¨ç±»ä¹Ÿå¯ä»¥å®ŒæˆåŒæ ·çš„äº‹æƒ…ï¼Œåªä¸è¿‡æ¯”è¾ƒç¬¨æ‹™ï¼šéœ€è¦æä¾›ä¸€ä¸ªå®ç°ï¼Œç„¶åå†ç›´æ¥å†…è”å°†å®ƒå®ä¾‹åŒ–ã€‚123456789//ä½¿ç”¨LambdaRunnable r1 = () -&gt; System.out.println(&quot;Hello World 1&quot;);//ä½¿ç”¨åŒ¿åç±»Runnable r2 = new Runnable()&#123; public void run()&#123; System.out.println(&quot;Hello World 2&quot;); &#125; &#125;; å‡½æ•°æè¿°ç¬¦å‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„ç­¾ååŸºæœ¬ä¸Šå°±æ˜¯Lambdaè¡¨è¾¾å¼çš„ç­¾åï¼Œæˆ‘ä»¬å°†è¿™ç§æŠ½è±¡æ–¹æ³•å«åšå‡½æ•°æè¿°ç¬¦ã€‚ä¾‹å¦‚ï¼ŒRunnableæ¥å£å¯ä»¥çœ‹ä½œä¸€ä¸ªä»€ä¹ˆä¹Ÿä¸æ¥å—ä»€ä¹ˆä¹Ÿä¸è¿”å›ï¼ˆvoidï¼‰çš„å‡½æ•°çš„ç­¾åï¼Œå› ä¸ºå®ƒåªæœ‰ä¸€ä¸ªå«ä½œrunçš„æŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä»€ä¹ˆä¹Ÿä¸æ¥å—ï¼Œä»€ä¹ˆä¹Ÿä¸è¿”å›ã€‚ Lambdaè¡¨è¾¾å¼å¯ä»¥è¢«èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œæˆ–ä¼ é€’ç»™ä¸€ä¸ªæ¥å—å‡½æ•°å¼æ¥å£ä½œä¸ºå‚æ•°çš„æ–¹æ³• @FunctionalInterfaceç”¨äºè¡¨ç¤ºè¯¥æ¥å£ä¼šè®¾è®¡æˆä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚ ä½¿ç”¨å‡½æ•°å¼æ¥å£Predicatejava.util.function.Predicateæ¥å£å®šä¹‰äº†ä¸€ä¸ªåå«testçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒæ¥å—æ³›å‹Tå¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªbooleanã€‚1234@FunctionalInterfacepublic interface Predicate&lt;T&gt; &#123; boolean test(T t);&#125; 123456789101112public static &lt;T&gt; List&lt;T&gt; filter(List&lt;T&gt; list, Predicate&lt;T&gt; p) &#123; List&lt;T&gt; results = new ArrayList&lt;&gt;(); for(T s: list)&#123; if(p.test(s))&#123; results.add(s); &#125; &#125; return results; &#125; Predicate&lt;String&gt; nonEmptyStringPredicate = (String s) -&gt; !s.isEmpty(); List&lt;String&gt; nonEmpty = filter(listOfStrings,nonEmptyStringPredicate); Consumerjava.util.function.Consumerå®šä¹‰äº†ä¸€ä¸ªåå«acceptçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒæ¥å—æ³›å‹Tçš„å¯¹è±¡ï¼Œæ²¡æœ‰è¿”å›ï¼ˆvoidï¼‰ã€‚ä½ å¦‚æœéœ€è¦è®¿é—®ç±»å‹Tçš„å¯¹è±¡ï¼Œå¹¶å¯¹å…¶æ‰§è¡ŒæŸäº›æ“ä½œï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¥å£ã€‚1234@FunctionalInterface public interface Consumer&lt;T&gt;&#123; void accept(T t); &#125; 123456public static &lt;T&gt; void forEach(List&lt;T&gt; list, Consumer&lt;T&gt; c)&#123; for(T i: list)&#123; c.accept(i); &#125; &#125; forEach( Arrays.asList(1,2,3,4,5), (Integer i) -&gt; System.out.println(i) ); java.util.function.Function&lt;T, R&gt;æ¥å£å®šä¹‰äº†ä¸€ä¸ªå«ä½œapplyçš„æ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ³›å‹Tçš„å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ³›å‹Rçš„å¯¹è±¡ã€‚å¦‚æœä½ éœ€è¦å®šä¹‰ä¸€ä¸ªLambdaï¼Œå°†è¾“å…¥å¯¹è±¡çš„ä¿¡æ¯æ˜ å°„åˆ°è¾“å‡ºï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¥å£ï¼ˆæ¯”å¦‚æå–è‹¹æœçš„é‡é‡ï¼Œæˆ–æŠŠå­—ç¬¦ä¸²æ˜ å°„ä¸ºå®ƒçš„é•¿åº¦ï¼‰ã€‚ 1234@FunctionalInterface public interface Function&lt;T, R&gt;&#123; R apply(T t); &#125; 12345678910111213public static &lt;T, R&gt; List&lt;R&gt; map(List&lt;T&gt; list, Function&lt;T, R&gt; f) &#123; List&lt;R&gt; result = new ArrayList&lt;&gt;(); for(T s: list)&#123; result.add(f.apply(s)); &#125; return result; &#125; // [7, 2, 6] List&lt;Integer&gt; l = map( Arrays.asList(&quot;lambdas&quot;,&quot;in&quot;,&quot;action&quot;), (String s) -&gt; s.length() ); LambdasåŠå‡½æ•°å¼æ¥å£çš„ä¾‹å­ï¼š ä½¿ç”¨æ¡ˆä¾‹ Lambdaå®ä¾‹ å¯¹åº”çš„å‡½æ•°å¼æ¥å£ å¸ƒå°”è¡¨è¾¾å¼ (List list) -&gt; list.isEmpty() Predicate&lt;List&gt; åˆ›å»ºå¯¹è±¡ () -&gt; new Apple(10) Supplier æ¶ˆè´¹ä¸€ä¸ªå¯¹è±¡ (Apple a) -&gt; { System.out.println(a.getWeight()); } Consumer ä»ä¸€ä¸ªå¯¹è±¡ä¸­é€‰æ‹©/æŠ½å– (String s) -&gt; s.length() Function&lt;String,Integer&gt;æˆ–ToIntFunction ç»„åˆä¸¤ä¸ªå€¼ (int a,int b) -&gt; a*b IntBinaryOperator æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ (Apple a2,Apple a2) -&gt; a1.getWeight().compareTo(a2.getWeight()) Comparatoræˆ–BiFunction&lt;Apple, Apple, Integer&gt;æˆ–ToIntBiFunction&lt;Apple, Apple&gt; å¼‚å¸¸è¯·æ³¨æ„ï¼Œä»»ä½•å‡½æ•°å¼æ¥å£éƒ½ä¸å…è®¸æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼ˆchecked exceptionï¼‰ã€‚å¦‚æœä½ éœ€è¦Lambdaè¡¨è¾¾å¼æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼šå®šä¹‰ä¸€ä¸ªè‡ªå·±çš„å‡½æ•°å¼æ¥å£ï¼Œå¹¶å£°æ˜å—æ£€å¼‚å¸¸ï¼Œæˆ–è€…æŠŠLambdaåŒ…åœ¨ä¸€ä¸ªtry/catchå—ä¸­ 12345@FunctionalInterface public interface BufferedReaderProcessor &#123; String process(BufferedReader b) throws IOException; &#125; BufferedReaderProcessor p = (BufferedReader br) -&gt; br.readLine(); 12345678Function&lt;BufferedReader, String&gt; f = (BufferedReader b) -&gt; &#123; try &#123; return b.readLine(); &#125; catch(IOException e) &#123; throw new RuntimeException(e); &#125; &#125;; ç±»å‹æ£€æŸ¥Lambdaè¡¨è¾¾å¼æœ¬èº«å¹¶ä¸åŒ…å«å®ƒåœ¨å®ç°å“ªä¸ªå‡½æ•°å¼æ¥å£çš„ä¿¡æ¯ã€‚ Lambdaçš„ç±»å‹æ˜¯ä»ä½¿ç”¨Lambdaçš„ä¸Šä¸‹æ–‡æ¨æ–­å‡ºæ¥çš„ã€‚ä¸Šä¸‹æ–‡ï¼ˆæ¯”å¦‚ï¼Œæ¥å—å®ƒä¼ é€’çš„æ–¹æ³•çš„å‚æ•°ï¼Œæˆ–æ¥å—å®ƒçš„å€¼çš„å±€éƒ¨å˜é‡ï¼‰ä¸­Lambdaè¡¨è¾¾å¼éœ€è¦çš„ç±»å‹ç§°ä¸ºç›®æ ‡ç±»å‹ é¦–å…ˆï¼Œä½ è¦æ‰¾å‡ºfilteræ–¹æ³•çš„å£°æ˜ã€‚ ç¬¬äºŒï¼Œè¦æ±‚å®ƒæ˜¯Predicateï¼ˆç›®æ ‡ç±»å‹ï¼‰å¯¹è±¡çš„ç¬¬äºŒä¸ªæ­£å¼å‚æ•°ã€‚ ç¬¬ä¸‰ï¼ŒPredicateæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå®šä¹‰äº†ä¸€ä¸ªå«ä½œtestçš„æŠ½è±¡æ–¹æ³•ã€‚ ç¬¬å››ï¼Œtestæ–¹æ³•æè¿°äº†ä¸€ä¸ªå‡½æ•°æè¿°ç¬¦ï¼Œå®ƒå¯ä»¥æ¥å—ä¸€ä¸ªAppleï¼Œå¹¶è¿”å›ä¸€ä¸ªbooleanã€‚ æœ€åï¼Œfilterçš„ä»»ä½•å®é™…å‚æ•°éƒ½å¿…é¡»åŒ¹é…è¿™ä¸ªè¦æ±‚ã€‚ åŒæ ·çš„Lambdaï¼Œä¸åŒçš„å‡½æ•°å¼æ¥å£æœ‰äº†ç›®æ ‡ç±»å‹çš„æ¦‚å¿µï¼ŒåŒä¸€ä¸ªLambdaè¡¨è¾¾å¼å°±å¯ä»¥ä¸ä¸åŒçš„å‡½æ•°å¼æ¥å£è”ç³»èµ·æ¥ï¼Œåªè¦å®ƒä»¬çš„æŠ½è±¡æ–¹æ³•ç­¾åèƒ½å¤Ÿå…¼å®¹ã€‚æ¯”å¦‚ï¼Œå‰é¢æåˆ°çš„Callableå’ŒPrivilegedActionï¼Œè¿™ä¸¤ä¸ªæ¥å£éƒ½ä»£è¡¨ç€ä»€ä¹ˆä¹Ÿä¸æ¥å—ä¸”è¿”å›ä¸€ä¸ªæ³›å‹Tçš„å‡½æ•°ã€‚å› æ­¤ï¼Œä¸‹é¢ä¸¤ä¸ªèµ‹å€¼æ˜¯æœ‰æ•ˆçš„ï¼š Callable&lt;Integer&gt; c = () -&gt; 42; PrivilegedAction&lt;Integer&gt; p = () -&gt; 42; ç¬¬ä¸€ä¸ªèµ‹å€¼çš„ç›®æ ‡ç±»å‹æ˜¯Callableï¼Œç¬¬äºŒä¸ªèµ‹å€¼çš„ç›®æ ‡ç±»å‹æ˜¯PrivilegedAction è±å½¢è¿ç®—ç¬¦Java 7ä¸­å·²ç»å¼•å…¥äº†è±å½¢è¿ç®—ç¬¦ï¼ˆ&lt;&gt;ï¼‰ï¼Œåˆ©ç”¨æ³›å‹æ¨æ–­ä»ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹çš„æ€æƒ³ï¼ˆè¿™ä¸€æ€æƒ³ç”šè‡³å¯ä»¥è¿½æº¯åˆ°æ›´æ—©çš„æ³›å‹æ–¹æ³•ï¼‰ã€‚ä¸€ä¸ªç±»å®ä¾‹è¡¨è¾¾å¼å¯ä»¥å‡ºç°åœ¨ä¸¤ä¸ªæˆ–æ›´å¤šä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¹¶ä¼šåƒä¸‹é¢è¿™æ ·æ¨æ–­å‡ºé€‚å½“çš„ç±»å‹å‚æ•°ï¼š List&lt;String> listOfStrings = new ArrayList&lt;&gt;(); List&lt;Integer> listOfIntegers = new ArrayList&lt;&gt;(); ç‰¹æ®Šçš„voidå…¼å®¹è§„åˆ™å¦‚æœä¸€ä¸ªLambdaçš„ä¸»ä½“æ˜¯ä¸€ä¸ªè¯­å¥è¡¨è¾¾å¼ï¼Œå®ƒå°±å’Œä¸€ä¸ªè¿”å›voidçš„å‡½æ•°æè¿°ç¬¦å…¼å®¹ï¼ˆå½“ç„¶éœ€è¦å‚æ•°åˆ—è¡¨ä¹Ÿå…¼å®¹ï¼‰ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸¤è¡Œéƒ½æ˜¯åˆæ³•çš„ï¼Œå°½ç®¡Listçš„addæ–¹æ³•è¿”å›äº†ä¸€ä¸ªbooleanï¼Œè€Œä¸æ˜¯Consumerä¸Šä¸‹æ–‡ï¼ˆT -&gt; voidï¼‰æ‰€è¦æ±‚çš„voidï¼š1234// Predicateè¿”å›äº†ä¸€ä¸ªboolean Predicate&lt;String&gt; p = s -&gt; list.add(s); // Consumerè¿”å›äº†ä¸€ä¸ªvoid Consumer&lt;String&gt; b = s -&gt; list.add(s); ç±»å‹æ¨æ–­Javaç¼–è¯‘å™¨ä¼šä»ä¸Šä¸‹æ–‡ï¼ˆç›®æ ‡ç±»å‹ï¼‰æ¨æ–­å‡ºç”¨ä»€ä¹ˆå‡½æ•°å¼æ¥æ¥é…åˆLambdaè¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€å®ƒä¹Ÿå¯ä»¥æ¨æ–­å‡ºé€‚åˆLambdaçš„ç­¾åï¼Œå› ä¸ºå‡½æ•°æè¿°ç¬¦å¯ä»¥é€šè¿‡ç›®æ ‡ç±»å‹æ¥å¾—åˆ°ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼Œç¼–è¯‘å™¨å¯ä»¥äº†è§£Lambdaè¡¨è¾¾å¼çš„å‚æ•°ç±»å‹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨Lambdaè¯­æ³•ä¸­çœå»æ ‡æ³¨å‚æ•°ç±»å‹ã€‚æ¢å¥è¯è¯´ï¼ŒJavaç¼–è¯‘å™¨ä¼šåƒä¸‹é¢è¿™æ ·æ¨æ–­Lambdaçš„å‚æ•°ç±»å‹ 1234567891011//å‚æ•°aæ²¡æœ‰æ˜¾å¼ç±»å‹List&lt;Apple&gt; greenApples = filter(inventory, a -&gt; &quot;green&quot;.equals(a.getColor())); //æ²¡æœ‰ç±»å‹æ¨æ–­Comparator&lt;Apple&gt; c = (Apple a1, Apple a2) -&gt; a1.getWeight().compareTo(a2.getWeight()); //æœ‰ç±»å‹æ¨æ–­Comparator&lt;Apple&gt; c = (a1, a2) -&gt; a1.getWeight().compareTo(a2.getWeight()); ä½¿ç”¨å±€éƒ¨å˜é‡Lambdaå¯ä»¥æ²¡æœ‰é™åˆ¶åœ°æ•è·ï¼ˆä¹Ÿå°±æ˜¯åœ¨å…¶ä¸»ä½“ä¸­å¼•ç”¨ï¼‰å®ä¾‹å˜é‡å’Œé™æ€å˜é‡ã€‚ä½†å±€éƒ¨å˜é‡å¿…é¡»æ˜¾å¼å£°æ˜ä¸ºfinalï¼Œæˆ–äº‹å®ä¸Šæ˜¯finalã€‚ æ–¹æ³•å¼•ç”¨æ–¹æ³•å¼•ç”¨è®©ä½ å¯ä»¥é‡å¤ä½¿ç”¨ç°æœ‰çš„æ–¹æ³•å®šä¹‰ï¼Œå¹¶åƒLambdaä¸€æ ·ä¼ é€’å®ƒä»¬ã€‚ æ–¹æ³•å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œä»…ä»…è°ƒç”¨ç‰¹å®šæ–¹æ³•çš„Lambdaçš„ä¸€ç§å¿«æ·å†™æ³•ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¦‚æœä¸€ä¸ªLambdaä»£è¡¨çš„åªæ˜¯â€œç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•â€ï¼Œé‚£æœ€å¥½è¿˜æ˜¯ç”¨åç§°æ¥è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯å»æè¿°å¦‚ä½•è°ƒç”¨å®ƒã€‚äº‹å®ä¸Šï¼Œæ–¹æ³•å¼•ç”¨å°±æ˜¯è®©ä½ æ ¹æ®å·²æœ‰çš„æ–¹æ³•å®ç°æ¥åˆ›å»ºLambdaè¡¨è¾¾å¼ã€‚ä½†æ˜¯ï¼Œæ˜¾å¼åœ°æŒ‡æ˜æ–¹æ³•çš„åç§°ï¼Œä½ çš„ä»£ç çš„å¯è¯»æ€§ä¼šæ›´å¥½ã€‚å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿå½“ä½ éœ€è¦ä½¿ç”¨æ–¹æ³•å¼•ç”¨æ—¶ï¼Œç›®æ ‡å¼•ç”¨æ”¾åœ¨åˆ†éš”ç¬¦::å‰ï¼Œæ–¹æ³•çš„åç§°æ”¾åœ¨åé¢ã€‚ä¾‹å¦‚ï¼ŒApple::getWeightå°±æ˜¯å¼•ç”¨äº†Appleç±»ä¸­å®šä¹‰çš„æ–¹æ³•getWeightã€‚è¯·è®°ä½ï¼Œä¸éœ€è¦æ‹¬å·ï¼Œå› ä¸ºä½ æ²¡æœ‰å®é™…è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚æ–¹æ³•å¼•ç”¨å°±æ˜¯Lambdaè¡¨è¾¾å¼(Apple a) -&gt; a.getWeight()çš„å¿«æ·å†™æ³•ã€‚ 12List&lt;String&gt; str = Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;A&quot;,&quot;B&quot;); str.sort((s1, s2) -&gt; s1.compareToIgnoreCase(s2)); Lambdaè¡¨è¾¾å¼çš„ç­¾åä¸Comparatorçš„å‡½æ•°æè¿°ç¬¦å…¼å®¹ã€‚12List&lt;String&gt; str = Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;A&quot;,&quot;B&quot;); str.sort(String::compareToIgnoreCase); æ„é€ å‡½æ•°å¼•ç”¨å¯¹äºä¸€ä¸ªç°æœ‰æ„é€ å‡½æ•°ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒçš„åç§°å’Œå…³é”®å­—newæ¥åˆ›å»ºå®ƒçš„ä¸€ä¸ªå¼•ç”¨ï¼šClassName::newã€‚å®ƒçš„åŠŸèƒ½ä¸æŒ‡å‘é™æ€æ–¹æ³•çš„å¼•ç”¨ç±»ä¼¼ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°æ²¡æœ‰å‚æ•°ã€‚å®ƒé€‚åˆSupplierçš„ç­¾å() -&gt; Appleã€‚ 12345Supplier&lt;Apple&gt; c1 = Apple::new; Apple a1 = c1.get(); //ç­‰ä»·äºSupplier&lt;Apple&gt; c1 = () -&gt; new Apple(); Apple a1 = c1.get(); 12345Function&lt;Integer, Apple&gt; c2 = Apple::new;Apple a2 = c2.apply(110);//ç­‰ä»·äºFunction&lt;Integer, Apple&gt; c2 = (weight) -&gt; new Apple(weight);Apple a2 = c2.apply(110); Comparatorå…·æœ‰ä¸€ä¸ªå«ä½œcomparingçš„é™æ€è¾…åŠ©æ–¹æ³•ï¼Œå®ƒå¯ä»¥æ¥å—ä¸€ä¸ªFunctionæ¥æå–Comparableé”®å€¼ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªComparatorå¯¹è±¡123456inventory.sort((a1, a2) -&gt; a1.getWeight().compareTo(a2.getWeight())); Comparator&lt;Apple&gt; c = Comparator.comparing((Apple a) -&gt; a.getWeight()); import static java.util.Comparator.comparing; inventory.sort(comparing((a) -&gt; a.getWeight())); æ€»ç»“ Lambdaè¡¨è¾¾å¼å¯ä»¥ç†è§£ä¸ºä¸€ç§åŒ¿åå‡½æ•°ï¼šå®ƒæ²¡æœ‰åç§°ï¼Œä½†æœ‰å‚æ•°åˆ—è¡¨ã€å‡½æ•°ä¸»ä½“ã€è¿”å›ç±»å‹ï¼Œå¯èƒ½è¿˜æœ‰ä¸€ä¸ªå¯ä»¥æŠ›å‡ºçš„å¼‚å¸¸çš„åˆ—è¡¨ Lambdaè¡¨è¾¾å¼è®©ä½ å¯ä»¥ç®€æ´åœ°ä¼ é€’ä»£ç  å‡½æ•°å¼æ¥å£å°±æ˜¯ä»…ä»…å£°æ˜äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ åªæœ‰åœ¨æ¥å—å‡½æ•°å¼æ¥å£çš„åœ°æ–¹æ‰å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼ Lambdaè¡¨è¾¾å¼å…è®¸ä½ ç›´æ¥å†…è”ï¼Œä¸ºå‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•æä¾›å®ç°ï¼Œå¹¶ä¸”å°†æ•´ä¸ªè¡¨è¾¾å¼ä½œä¸ºå‡½æ•°å¼æ¥å£çš„ä¸€ä¸ªå®ä¾‹ Java8è‡ªå¸¦ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£ï¼Œæ”¾åœ¨java.util.functionåŒ…é‡Œï¼ŒåŒ…æ‹¬Predicateã€Function&lt;T,R&gt;ã€Supplierã€Consumerå’ŒBinaryOperator ä¸ºäº†é¿å…è£…ç®±æ“ä½œï¼Œå¯¹Predicateå’ŒFunction&lt;T,R&gt;ç­‰é€šç”¨å‡½æ•°å¼æ¥å£çš„åŸå§‹ç±»å‹ç‰¹åŒ–ï¼šIntPredicateã€IntToLongFunctionç­‰ Lambdaè¡¨è¾¾å¼æ‰€éœ€è¦ä»£è¡¨çš„ç±»å‹ç§°ä¸ºç›®æ ‡ç±»å‹ æ–¹æ³•å¼•ç”¨è®©ä½ é‡å¤ä½¿ç”¨ç°æœ‰çš„æ–¹æ³•å®ç°å¹¶ç›´æ¥ä¼ é€’å®ƒä»¬ Comparatorã€Predicateå’ŒFunctionç­‰å‡½æ•°å¼æ¥å£éƒ½æœ‰å‡ ä¸ªå¯ä»¥ç”¨æ¥ç»“åˆLambdaè¡¨è¾¾å¼çš„é»˜è®¤è¿”å›","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"è¡Œä¸ºå‚æ•°åŒ–ã€java8å®æˆ˜ã€‘","slug":"java8å®æˆ˜-è¡Œä¸ºå‚æ•°åŒ–","date":"2018-04-29T04:20:25.000Z","updated":"2018-04-29T13:31:52.933Z","comments":true,"path":"2018/04/29/java8å®æˆ˜-è¡Œä¸ºå‚æ•°åŒ–/","link":"","permalink":"https://hsb786.github.io/2018/04/29/java8å®æˆ˜-è¡Œä¸ºå‚æ•°åŒ–/","excerpt":"è¡Œä¸ºå‚æ•°åŒ–æ˜¯æŒ‡ä¸€ä¸ªæ–¹æ³•çš„åŠŸèƒ½ï¼Œéƒ¨åˆ†æˆ–å…¨éƒ¨ç”±ä¼ é€’ç»™è¿™ä¸ªæ–¹æ³•çš„æŸä¸ªæˆ–å¤šä¸ªå‚æ•°å†³å®šï¼Œä½†è¿™äº›å‚æ•°ä¸æ˜¯ä¸€èˆ¬æ„ä¹‰ä¸Šçš„å€¼ï¼ˆä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—ï¼‰ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªå…·ä½“çš„è¡Œä¸ºï¼Œå…¶æœ¬è´¨æ˜¯ä»£ç ä¼ é€’ï¼Œè¡¨ç°å¯èƒ½æœ‰å¤šç§ï¼šå¯¹è±¡ã€åŒ¿åç±»ã€java8é‡Œçš„Lambdaè¡¨è¾¾å¼ï¼ˆæˆ–æ–¹æ³•å¼•ç”¨ï¼‰ç­‰ã€‚","text":"è¡Œä¸ºå‚æ•°åŒ–æ˜¯æŒ‡ä¸€ä¸ªæ–¹æ³•çš„åŠŸèƒ½ï¼Œéƒ¨åˆ†æˆ–å…¨éƒ¨ç”±ä¼ é€’ç»™è¿™ä¸ªæ–¹æ³•çš„æŸä¸ªæˆ–å¤šä¸ªå‚æ•°å†³å®šï¼Œä½†è¿™äº›å‚æ•°ä¸æ˜¯ä¸€èˆ¬æ„ä¹‰ä¸Šçš„å€¼ï¼ˆä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—ï¼‰ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªå…·ä½“çš„è¡Œä¸ºï¼Œå…¶æœ¬è´¨æ˜¯ä»£ç ä¼ é€’ï¼Œè¡¨ç°å¯èƒ½æœ‰å¤šç§ï¼šå¯¹è±¡ã€åŒ¿åç±»ã€java8é‡Œçš„Lambdaè¡¨è¾¾å¼ï¼ˆæˆ–æ–¹æ³•å¼•ç”¨ï¼‰ç­‰ã€‚ ä¸ºä»€ä¹ˆéœ€è¦è¡Œä¸ºå‚æ•°åŒ–ï¼Ÿä»¥å‰åšå¤–åŒ…é¡¹ç›®çš„æ—¶å€™ï¼Œä¼¼ä¹æ°¸è¿œä¸çŸ¥é“å®¢æˆ·ä¼šåœ¨ä»€ä¹ˆæ—¶å€™æå‡ºæ–°éœ€æ±‚æˆ–éœ€æ±‚å˜æ›´ï¼Œå¦‚æœæ²¡æœ‰è¡Œä¸ºå‚æ•°åŒ–æˆ–ç±»ä¼¼è¡Œä¸ºå‚æ•°åŒ–çš„ä¸œè¥¿ï¼Œå®¢æˆ·çš„éœ€æ±‚å°æœ‰æ”¹åŠ¨å¯èƒ½ä¼šå¸¦æ¥ä»£ç ä¸Šè¾ƒå¤§çš„å˜åŠ¨ï¼Œæˆ–ä¸ºäº†ä¸€ä¸ªå°çš„æ–°éœ€æ±‚å¤åˆ¶ç²˜è´´å¥½å‡ ä¸ªç±»æˆ–æ–¹æ³•ï¼Œä½†è¡Œä¸ºå‚æ•°åŒ–å¯¹äºæŸäº›éœ€æ±‚çš„å˜åŒ–æˆ–æ–°å¢å¯ä»¥åšåˆ°ä»¥ä¸å˜åº”ä¸‡å˜ã€‚ question: å†œæ°‘éœ€è¦ç­›é€‰è‹¹æœï¼Œå¯èƒ½é€šè¿‡é¢œè‰²ï¼Œå¯èƒ½é€šè¿‡é‡é‡ï¼Œä¹Ÿå¯èƒ½é€šè¿‡å…¶å®ƒå±æ€§ã€‚ 12345678910public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; inventory, String color,int weight, boolean flag) &#123; List&lt;Apple&gt; result = new ArrayList&lt;Apple&gt;(); for (Apple apple: inventory)&#123; //flagæ ‡å¿—ç”¨äºåŒºåˆ†æ˜¯é¢œè‰²ç­›é€‰è¿˜æ˜¯é‡é‡ç­›é€‰ if ( (flag &amp;&amp; apple.getColor().equals(color)) ||(!flag &amp;&amp; apple.getWeight() &gt; weight) )&#123; result.add(apple); &#125; &#125; return result;&#125; æ–¹æ³•çœ‹èµ·æ¥å¾ˆç³Ÿç³•ï¼Œä¸æ˜“ç†è§£ï¼Œè€Œä¸”æ— æ³•æ»¡è¶³å†œæ°‘å¯èƒ½æå‡ºçš„æ›´å¤šè¿‡æ»¤éœ€è¦ï¼Œæ¯”å¦‚å¤§å°ã€å½¢çŠ¶ã€äº§åœ°ï¼Œæ›´ä¸ç”¨è¯´å¯èƒ½å‡ºç°çš„ç»„åˆç­›é€‰éœ€æ±‚äº†ã€‚å› æ­¤éœ€è¦ä½œå‡ºæ”¹å˜ï¼Œæ—¢ä¸æƒ³æ¯ä¸€ä¸ªè¿‡æ»¤éœ€æ±‚éƒ½å†™ä¸€ä¸ªå¯¹åº”çš„è¿‡æ»¤æ–¹æ³•ï¼Œåˆä¸æƒ³å†™ä¸€ä¸ªå·¨å¤§è€Œç³Ÿç³•çš„æ–¹æ³•æ¥å®ç°å¤šä¸ªç­›é€‰éœ€æ±‚ï¼Œæ€ä¹ˆåŠï¼Ÿ ç±»ä¸Šä¸€ä¸ªä¾‹å­åœ¨è¿‡æ»¤æ—¶ä¼ é€’çš„æ˜¯å…·ä½“çš„å€¼ï¼ˆå€¼ä¼ é€’ï¼‰ï¼Œå¦‚stringç±»å‹çš„é¢œè‰²ã€intç±»å‹çš„é‡é‡ã€booleanï¼Œä»£è¡¨çš„åªæ˜¯è‹¹æœçš„ä¸€ä¸ªå±æ€§æˆ–çŠ¶æ€ï¼Œæ›´ç³Ÿç³•çš„å®ƒä»¬å¯èƒ½ä¼šæœ‰æ— æ•°ä¸ªç»„åˆï¼Œæ¯ä¸ªç»„åˆéƒ½å¯¹åº”äº†ä¸€ä¸ªæ–°éœ€æ±‚ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•å•çº¯åœ°é å€¼ä¼ é€’æ¥è®¾è®¡å‡ºä¼˜é›…çš„è¿‡æ»¤æ–¹æ³•çš„! ç”±äºæ¯ä¸€æ¬¡ç­›é€‰éƒ½æ˜¯ä¸€ä¸ªå…·ä½“çš„è¡Œä¸ºï¼Œè¡Œä¸ºå†³å®šäº†è¿‡æ»¤çš„ç»“æœ,é‚£ç›´æ¥å°†è¡Œä¸ºä¼ é€’è‡³è¿‡æ»¤æ–¹æ³•å‘¢ï¼Ÿ 1234567891011121314151617181920212223/***å¯¹ç­›é€‰æ ‡å‡†å»ºç«‹æ¨¡å‹*/public interface ApplePredicate&#123; //testæ–¹æ³•å†³å®šäº†appleæ˜¯å¦æ»¡è¶³æˆ‘ä»¬çš„ç­›é€‰æ¡ä»¶ boolean test (Apple apple);&#125;/***ä»£è¡¨äº†é€‰å‡ºè¾ƒé‡è‹¹æœçš„è¿™ä¸€è¡Œä¸º*/public class AppleHeavyWeightPredicate implements ApplePredicate&#123; public boolean test(Apple apple)&#123; return apple.getWeight() &gt; 150; &#125;&#125;/***ä»£è¡¨äº†é€‰å‡ºç»¿è‰²è‹¹æœè¿™ä¸€è¡Œä¸º*/public class AppleGreenColorPredicate implements ApplePredicate&#123; public boolean test(Apple apple)&#123; return &quot;green&quot;.equals(apple.getColor()); &#125;&#125; ä½¿ç”¨äº†â€œç­–ç•¥æ¨¡å¼â€ï¼Œå®šä¹‰ä¸€æ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œç„¶åå†è¿è¡Œæ—¶é€‰æ‹©ä¸€ä¸ªç®—æ³•ã€‚åœ¨è¿™é‡Œï¼Œç®—æ³•æ—å°±æ˜¯ApplePredicateï¼Œä¸åŒçš„ç­–ç•¥å°±æ˜¯AppleHeavyWeightPredicateå’ŒAppleGreenColorPredicateã€‚ éœ€è¦filterApplesæ–¹æ³•æ¥å—ApplePredicateå¯¹è±¡ï¼Œå¯¹Appleåšæ¡ä»¶æµ‹è¯•ã€‚è¿™å°±æ˜¯è¡Œä¸ºå‚æ•°åŒ–ï¼šè®©æ–¹æ³•æ¥å—å¤šç§è¡Œä¸ºä½œä¸ºå‚æ•°ï¼Œå¹¶åœ¨å†…éƒ¨ä½¿ç”¨ï¼Œæ¥å®Œæˆä¸åŒçš„è¡Œä¸º1234567891011public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; inventory,ApplePredicate p)&#123; List&lt;Apple&gt; result = new ArrayList&lt;&gt;(); for(Apple apple: inventory)&#123; //ApplePredicateå¯¹è±¡å°è£…äº†æµ‹è¯•è‹¹æœçš„æ¡ä»¶ //æ»¡è¶³æ¡ä»¶å³æ˜¯æˆ‘ä»¬éœ€è¦é€‰å‡ºçš„ç»“æœ if(p.test(apple))&#123; result.add(apple); &#125; &#125; return result;&#125; è¿™æ ·é’ˆå¯¹ä¸åŒçš„è¿‡æ»¤éœ€æ±‚ï¼ˆè¡Œä¸ºï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸åŒçš„ApplePredicateçš„å®ç°ç±»ï¼Œå³å¯ä½¿ç”¨åŒä¸€ä¸ªè¿‡æ»¤æ–¹æ³•ç­›é€‰å‡ºæˆ‘ä»¬æƒ³è¦çš„è‹¹æœï¼Œæ¯”å¦‚ç­›é€‰å‡ºçº¢è‰²ä¸”è¾ƒé‡çš„è‹¹æœï¼š123456public class AppleRedAndHeavyPredicate implements ApplePredicate&#123; public boolean test(Apple apple)&#123; return &quot;red&quot;.equals(apple.getColor())&amp;&amp; apple.getWeight() &gt; 150; &#125;&#125;List&lt;Apple&gt; redAndHeavyApples =filterApples(inventory, new AppleRedAndHeavyPredicate()); æ— è®ºç­›é€‰éœ€æ±‚çš„ç»„åˆå¤šä¹ˆå¤æ‚ï¼Œéƒ½åªæœ‰ä¸€ä¸ªè¡Œä¸ºå‚æ•°ï¼Œè‡³æ­¤ï¼ŒfilterApplesæ–¹æ³•å·²ç»èƒ½å¤Ÿåº”å¯¹ä¸æ–­å˜åŒ–çš„ç­›é€‰éœ€æ±‚äº†ã€‚ä½†æ¯ä¸€ä¸ªç­›é€‰è¡Œä¸ºéƒ½éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œæ˜¯ä¸æ˜¯å¤ªå•°å—¦äº†ï¼Ÿ ç”±äºè¯¥filterApplesæ–¹æ³•åªèƒ½æ¥å—å¯¹è±¡ï¼Œæ‰€ä»¥ä½ å¿…é¡»æŠŠä»£ç åŒ…è£¹åœ¨ApplePredicateå¯¹è±¡é‡Œã€‚å°±ç±»ä¼¼äºåœ¨å†…è”â€œä¼ é€’ä»£ç â€ï¼Œå› ä¸ºä½ æ˜¯é€šè¿‡ä¸€ä¸ªå®ç°äº†testæ–¹æ³•çš„å¯¹è±¡æ¥ä¼ é€’å¸ƒå°”è¡¨è¾¾å¼çš„ã€‚ åŒ¿åç±»12345List&lt;Apple&gt; redApples = filterApples(inventory, new ApplePredicate() &#123; public boolean test(Apple apple)&#123; return &quot;red&quot;.equals(apple.getColor()); &#125;&#125;); åŒ¿åç±»è™½ç„¶çœå»äº†å¤§é‡è¡Œä¸ºç±»çš„å£°æ˜ï¼Œä½†æ˜¯ä¾ç„¶ç¬¨é‡ï¼ˆæ¨¡æ¿åŒ–çš„ä»£ç å äº†4è¡Œï¼Œå®é™…çš„ç­›é€‰ä»£ç å´åªæœ‰ä¸€è¡Œï¼‰ä¸”åŒ¿åç±»çš„ä½¿ç”¨å¯èƒ½ä¼šè®©äººè´¹è§£ã€‚ Lambdaè¡¨è¾¾å¼List&lt;Apple&gt; result = filterApples(inventory, (Apple apple) -&gt; &quot;red&quot;.equals(apple.getColor())); å°† List ç±»å‹æŠ½è±¡åŒ–ï¼Œè¡Œä¸ºå‚æ•°åŒ–è¶‹äºå®Œç¾å‰æ–¹çš„è¿‡æ»¤æ–¹æ³•åªèƒ½è¿‡æ»¤Appleï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³›å‹è¿›ä¸€æ­¥æŠ½è±¡åŒ–ï¼Œä½¿å…¶å¯ä»¥è¿‡æ»¤Orangeã€Bananaç­‰ä»»ä½•å®ä½“ï¼š123456789101112public interface Predicate&lt;T&gt;&#123; boolean test(T t);&#125;public static &lt;T&gt; List&lt;T&gt; filter(List&lt;T&gt; list, Predicate&lt;T&gt; p)&#123; List&lt;T&gt; result = new ArrayList&lt;&gt;(); for(T e: list)&#123; if(p.test(e))&#123; result.add(e); &#125; &#125; return result;&#125; 1234//ç­›é€‰å‡ºçº¢è‹¹æœList&lt;Apple&gt; redApples = filter(inventory, (Apple apple) -&gt; &quot;red&quot;.equals(apple.getColor()));//ç­›é€‰å‡ºå¶æ•°List&lt;Integer&gt; evenNumbers = filter(numbers, (Integer i) -&gt; i % 2 == 0); æ€»ç»“ è¡Œä¸ºå‚æ•°åŒ–ï¼Œå°±æ˜¯ä¸€ä¸ªæ–¹æ³•æ¥å—å¤šä¸ªä¸åŒçš„è¡Œä¸ºä½œä¸ºå‚æ•°ï¼Œå¹¶åœ¨å†…éƒ¨ä½¿ç”¨å®ƒä»¬ï¼Œå®Œæˆä¸åŒè¡Œä¸ºçš„èƒ½åŠ›ã€‚ è¡Œä¸ºå‚æ•°åŒ–å¯ä»¥è®©ä»£ç æ›´å¥½åœ°é€‚åº”ä¸æ–­å˜åŒ–çš„è¦æ±‚ï¼Œå‡è½»æœªæ¥çš„å·¥ä½œé‡ ä¼ é€’ä»£ç ï¼Œå°±æ˜¯å°†æ–°è¡Œä¸ºä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ã€‚ä½†åœ¨Java8ä¹‹å‰å®ç°èµ·æ¥å¾ˆå•°å—¦ã€‚ä¸ºæ¥å£å£°æ˜è®¸å¤šåªç”¨ä¸€æ¬¡çš„å®ä½“ç±»è€Œé€ æˆçš„å•°å—¦ä»£ç ï¼Œåœ¨Java8ä¹‹å‰å¯ä»¥ç”¨åŒ¿åç±»æ¥å‡å°‘ã€‚ Java APIåŒ…å«å¾ˆå¤šå¯ä»¥ç”¨ä¸åŒè¡Œä¸ºè¿›è¡Œå‚æ•°åŒ–çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬æ’åºã€çº¿ç¨‹ç­‰ã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"Java8å®æˆ˜","slug":"çˆªå“‡/Java8å®æˆ˜","permalink":"https://hsb786.github.io/categories/çˆªå“‡/Java8å®æˆ˜/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"äºŒè¿›åˆ¶é—®é¢˜","slug":"äºŒè¿›åˆ¶é—®é¢˜","date":"2018-04-28T06:12:09.000Z","updated":"2018-05-02T06:13:47.243Z","comments":true,"path":"2018/04/28/äºŒè¿›åˆ¶é—®é¢˜/","link":"","permalink":"https://hsb786.github.io/2018/04/28/äºŒè¿›åˆ¶é—®é¢˜/","excerpt":"0.1+0.2=0.30000000000000004ï¼Œä»Šå¤©å¶å°”çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåˆšå¥½å‰ä¸ä¹…ç¬”è¯•çš„æ—¶å€™ä¹Ÿé‡åˆ°è¿‡ï¼ŒåªçŸ¥é“æ˜¯ç²¾åº¦é—®é¢˜ï¼Œä½†å¿˜äº†æ˜¯ä¸ºä»€ä¹ˆï¼Œå›é¡¾ä¸€ä¸‹ã€‚ğŸ³","text":"0.1+0.2=0.30000000000000004ï¼Œä»Šå¤©å¶å°”çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåˆšå¥½å‰ä¸ä¹…ç¬”è¯•çš„æ—¶å€™ä¹Ÿé‡åˆ°è¿‡ï¼ŒåªçŸ¥é“æ˜¯ç²¾åº¦é—®é¢˜ï¼Œä½†å¿˜äº†æ˜¯ä¸ºä»€ä¹ˆï¼Œå›é¡¾ä¸€ä¸‹ã€‚ğŸ³ æœ‰ä¸ªç½‘ç«™åŸŸåå°±æ˜¯0.300000000000000040.30000000000000004.com ç½‘ç«™ä¸Šä¸¾çš„æ —å­ğŸ‚ è¿ç®— ç»“æœ .1 + .2 0.30000000000000004 .1F + .2F 0.3 Java has built-in support for arbitrary precision numbers using the BigDecimal class.å¯ä»¥ä½¿ç”¨BigDecimalè§£å†³è¿™ä¸ªé—®é¢˜ å¯¼è‡´è¿™ä¸ªé—®é¢˜çš„åŸå›  è®¡ç®—æœºå°†æ‰€æœ‰æ•°æ®ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨ è®¡ç®—æœºç”¨æœ‰é™çš„å¤§å°æ¥å­˜å‚¨æ•°æ® äºŒè¿›åˆ¶åè¿›åˆ¶å°æ•°è½¬æ¢ä¾‹å¦‚åè¿›åˆ¶0.125è½¬æ¢æˆäºŒè¿›åˆ¶ äºŒè¿›åˆ¶ åè¿›åˆ¶ 0.125*2=0.25 å–æ•´æ•°éƒ¨åˆ†0 0.25*2=0.5 å–æ•´æ•°éƒ¨åˆ†0 0.5*2=1 å–æ•´æ•°éƒ¨åˆ†1 æœ€ç»ˆå¾—åˆ°çš„ç»“æœå°±æ˜¯0.001 ä¾‹å¦‚äºŒè¿›åˆ¶0.001è½¬æ¢æˆåè¿›åˆ¶ åè¿›åˆ¶ äºŒè¿›åˆ¶ 0* 2^-1 0 0* 2^-2 0 1* 2^-3 0.125 æœ€ç»ˆå¾—åˆ°çš„ç»“æœå°±æ˜¯0+0+0.125=0.125 çŸ¥é“äº†è¿™äº›å°±ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆ0.1+0.2ï¼=0.3 é¦–å…ˆçœ‹0.1äºŒè¿›åˆ¶è¡¨ç¤ºï¼š0.0 00110011001100110011001100110011 æ— ç©·å¾ªç¯ï¼Œè€Œè®¡ç®—æœºåªèƒ½ç”¨æœ‰é™ä½æ¥å­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥å¿…ç„¶ä¼šæœ‰ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜ã€‚ javaé‡‡ç”¨BigDecimalæ¥è§£å†³è¿™ä¸ªé—®é¢˜ BigDecimalä¾‹å¦‚123.1+.2=0.30000000000000004new BigDecimal(.1).add(new BigDecimal(.2))=0.3000000000000000166533453693773481063544750213623046875new BigDecimal(String.valueOf(.1)).add(new BigDecimal(String.valueOf(.2)))=0.3 ç”±äº0.1æ— æ³•ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œæ‰€ä»¥è°ƒç”¨new BIgDecimal(Double val)ä¾ç„¶æ˜¯æœ‰é—®é¢˜çš„ï¼Œæœ€å¥½è½¬åŒ–ä¸ºStringç±»å‹ã€‚ éœ€è¦æ³¨æ„çš„ä¸œè¥¿BigDecimalæ˜¯ä¸å¯å˜çš„ï¼Œåœ¨è¿›è¡Œæ¯ä¸€æ­¥è¿ç®—æ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚æ‰€ä»¥ä¸é€‚åˆå¤§é‡çš„æ•°å­¦è¿ç®—ï¼Œé€‚ç”¨äºå•†ä¸šè®¡ç®—ä¸­å¯¹è¿›åº¦è¦æ±‚æ¯”è¾ƒé«˜çš„ã€‚ æ„Ÿè§‰ä¸æ‡‚çš„è¿˜æœ‰å¾ˆå¤š å‚è€ƒ 0.30000000000000004.com ä¸ºä»€ä¹ˆjavaé‡Œé¢3*0.1=0.30000000000000004ï¼Œè€Œ4*0.1=0.4ï¼Ÿ","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"å±±é¬¼","slug":"å±±é¬¼","date":"2018-04-24T05:10:17.000Z","updated":"2018-04-24T05:25:15.267Z","comments":true,"path":"2018/04/24/å±±é¬¼/","link":"","permalink":"https://hsb786.github.io/2018/04/24/å±±é¬¼/","excerpt":"æœ€è¿‘åœ¨å¾ªç¯çš„ä¸€é¦–éŸ³ä¹ï¼Œæ­Œè¯å‡ºè‡ªå±ˆåŸã€Šæ¥šè¾Â·ä¹æ­Œã€‹ä¸­çš„ç¬¬ä¹ç« ã€‚","text":"æœ€è¿‘åœ¨å¾ªç¯çš„ä¸€é¦–éŸ³ä¹ï¼Œæ­Œè¯å‡ºè‡ªå±ˆåŸã€Šæ¥šè¾Â·ä¹æ­Œã€‹ä¸­çš„ç¬¬ä¹ç« ã€‚ ä¹æ­ŒÂ·å±±é¬¼ è‹¥æœ‰äººå…®å±±ä¹‹é˜¿ï¼Œè¢«è–œè”å…®å¸¦å¥³ç½—ã€‚ æ—¢å«ç‡å…®åˆå®œç¬‘ï¼Œå­æ…•äºˆå…®å–„çªˆçª•ã€‚ ä¹˜èµ¤è±¹å…®ä»æ–‡é‡Œï¼Œè¾›å¤·è½¦å…®ç»“æ——ã€‚ è¢«çŸ³å…°å…®å¸¦æœè¡¡ã€‚æŠ˜èŠ³é¦¨å…®é—æ‰€æ€ã€‚ ä½™å¤„å¹½ç¯å…®ç»ˆä¸è§å¤©ï¼Œè·¯é™©éš¾å…®ç‹¬åæ¥ã€‚ è¡¨ç‹¬ç«‹å…®å±±ä¹‹ç±»ä¸Šï¼Œäº‘å®¹å®¹å…®è€Œåœ¨ä¸‹ã€‚ æ³å†¥å†¥å…®ç¾Œæ˜¼æ™¦ï¼Œä¸œé£é£˜å…®ç¥çµé›¨ã€‚ ç•™çµä¿®å…®å¿˜å½’ï¼Œå²æ—¢æ™å…®å­°åäºˆã€‚ é‡‡ä¸‰ç§€å…®æ–¼å±±é—´ï¼ŒçŸ³ç£Šç£Šå…®è‘›è”“è”“ã€‚ æ€¨å…¬å­å…®æ€…å¿˜å½’ï¼Œå›æ€æˆ‘å…®ä¸å¾—é—²ã€‚ å±±ä¸­äººå…®èŠ³æœè‹¥ï¼Œé¥®çŸ³æ³‰å…®è«æ¾æŸã€‚ å›æˆ‘å…®ç„¶ç–‘ä½œã€‚ é›·å¡«å¡«å…®é›¨å†¥å†¥ï¼ŒçŒ¿å•¾å•¾å…®åˆå¤œé¸£ã€‚ é£é£’é£’å…®æœ¨è§è§ï¼Œæ€å…¬å­å…®å¾™ç¦»å¿§ã€‚ å±±é¬¼è‡ªå•¼é£é›¨Â·ã€Šå±±é¬¼ã€‹ä¹è¯„.","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"https://hsb786.github.io/categories/æ‚è°ˆ/"}],"tags":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"https://hsb786.github.io/tags/æ‚è°ˆ/"}]},{"title":"RandomAccess","slug":"RandomAccess","date":"2018-04-23T10:30:51.000Z","updated":"2018-04-23T10:58:03.042Z","comments":true,"path":"2018/04/23/RandomAccess/","link":"","permalink":"https://hsb786.github.io/2018/04/23/RandomAccess/","excerpt":"JDKå®˜æ–¹æ–‡æ¡£ä¸Šçš„è§£é‡Šï¼š Marker interface used by List implementations to indicate that they support fast (generally constant time) random access. The primary purpose of this interface is to allow generic algorithms to alter their behavior to provide good performance when applied to either random or sequential access lists.å¤§è‡´æ„æ€å°±æ˜¯ï¼šRandomAccess æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ï¼Œç”¨äºæ ‡æ˜å®ç°è¯¥æ¥å£çš„Listæ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼Œä¸»è¦ç›®çš„æ˜¯ä½¿ç®—æ³•èƒ½å¤Ÿåœ¨éšæœºé¡ºåºè®¿é—®çš„listä¸­è¡¨ç°çš„æ›´åŠ é«˜æ•ˆã€‚","text":"JDKå®˜æ–¹æ–‡æ¡£ä¸Šçš„è§£é‡Šï¼š Marker interface used by List implementations to indicate that they support fast (generally constant time) random access. The primary purpose of this interface is to allow generic algorithms to alter their behavior to provide good performance when applied to either random or sequential access lists.å¤§è‡´æ„æ€å°±æ˜¯ï¼šRandomAccess æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ï¼Œç”¨äºæ ‡æ˜å®ç°è¯¥æ¥å£çš„Listæ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼Œä¸»è¦ç›®çš„æ˜¯ä½¿ç®—æ³•èƒ½å¤Ÿåœ¨éšæœºé¡ºåºè®¿é—®çš„listä¸­è¡¨ç°çš„æ›´åŠ é«˜æ•ˆã€‚ åªå®šä¹‰äº†ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰12public interface RandomAccess &#123;&#125; æ³¨é‡Šä¸Šä¸¾äº†ä¸ªæ —å­ğŸ‚ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç ä¸­ç¬¬ä¸€ç§å¾ªç¯è¿è¡Œæ¯”ç¬¬äºŒç§å¿«12345678910this loop: * &lt;pre&gt; * for (int i=0, n=list.size(); i &amp;lt; n; i++) * list.get(i); * &lt;/pre&gt; * runs faster than this loop: * &lt;pre&gt; * for (Iterator i=list.iterator(); i.hasNext(); ) * i.next(); * &lt;/pre&gt; soï¼Œåœ¨éå†ArrayListæ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ç¬¬ä¸€ç§å¾ªç¯ï¼›åœ¨éå†LinkedListåˆ™ä½¿ç”¨ç¬¬äºŒç§å¾ªç¯ã€‚æ ¹æ®æœ‰æ²¡æœ‰å®ç°RandomAccessæ¥å£æ¥åˆ¤æ–­ã€‚ArrayListå®ç°äº†RandomAccessæ¥å£ï¼ŒLinkedListæ²¡æœ‰å®ç° 12345678//Collections.classpublic static &lt;T&gt;int binarySearch(List&lt;? extends Comparable&lt;? super T&gt;&gt; list, T key) &#123; if (list instanceof RandomAccess || list.size()&lt;BINARYSEARCH_THRESHOLD) return Collections.indexedBinarySearch(list, key); else return Collections.iteratorBinarySearch(list, key);&#125; è¡¥å……foreachå†…éƒ¨æ˜¯é€šè¿‡Iteratorå®ç°çš„ã€‚ 1234567891011public class T01 &#123; public static void main(String[] args) &#123; List&lt;String&gt; list=new ArrayList&lt;&gt;(); list.add(&quot;a&quot;); list.add(&quot;b&quot;); for(String s:list) &#123; System.out.println(s); &#125; &#125;&#125; åç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ã€‚ä»ç¬¬27ï¼Œ37ï¼Œ54è¡Œå¯ä»¥çœ‹å‡ºï¼Œforeachå…¶å®æ˜¯é€šè¿‡Iteratoræ¥å®ç°çš„ã€‚12345678910111213141516171819202122232425262728293031323334353637public class al.T01 &#123; public al.T01(); Code: 0: aload_0 1: invokespecial #8 // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V 4: return public static void main(java.lang.String[]) throws java.lang.Exception; Code: 0: new #19 // class java/util/ArrayList 3: dup 4: invokespecial #21 // Method java/util/ArrayList.&quot;&lt;init&gt;&quot;:()V 7: astore_1 8: aload_1 9: ldc #22 // String a 11: invokeinterface #24, 2 // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z 16: pop 17: aload_1 18: ldc #30 // String b 20: invokeinterface #24, 2 // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z 25: pop 26: aload_1 27: invokeinterface #32, 1 // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator; 32: astore_3 33: goto 53 36: aload_3 37: invokeinterface #36, 1 // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object; 42: checkcast #42 // class java/lang/String 45: astore_2 46: getstatic #44 // Field java/lang/System.out:Ljava/io/PrintStream; 49: aload_2 50: invokevirtual #50 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 53: aload_3 54: invokeinterface #56, 1 // InterfaceMethod java/util/Iterator.hasNext:()Z 59: ifne 36 62: return&#125;","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"HotSpot","slug":"HotSpot","date":"2018-04-23T10:15:36.000Z","updated":"2018-04-23T12:52:33.687Z","comments":true,"path":"2018/04/23/HotSpot/","link":"","permalink":"https://hsb786.github.io/2018/04/23/HotSpot/","excerpt":"ç»å¸¸çœ‹åˆ°HotSpotï¼Œä½†ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚soï¼Œè¿™æ˜¯ä¸€ç¯‡ç§‘æ™®æ–‡ã€‚æ‘˜è‡ª&lt;&lt;æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µ&gt;&gt;ã€‚ç­‰ä»¥åå·¥ä½œäº†ï¼Œä¸€å®šè¦çœ‹è¿™æœ¬ç¥ä¹¦ï¼Œçœ‹ä¸‹æœ‰æ²¡æœ‰ä¼ è¯´ä¸­çš„é‚£ä¹ˆç¥å¥‡ã€‚ğŸ™„ğŸ™„","text":"ç»å¸¸çœ‹åˆ°HotSpotï¼Œä½†ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚soï¼Œè¿™æ˜¯ä¸€ç¯‡ç§‘æ™®æ–‡ã€‚æ‘˜è‡ª&lt;&lt;æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µ&gt;&gt;ã€‚ç­‰ä»¥åå·¥ä½œäº†ï¼Œä¸€å®šè¦çœ‹è¿™æœ¬ç¥ä¹¦ï¼Œçœ‹ä¸‹æœ‰æ²¡æœ‰ä¼ è¯´ä¸­çš„é‚£ä¹ˆç¥å¥‡ã€‚ğŸ™„ğŸ™„ æèµ·HotSpot VMï¼Œç›¸ä¿¡æ‰€æœ‰Javaç¨‹åºå‘˜éƒ½çŸ¥é“ï¼Œå®ƒæ˜¯Sun JDKå’ŒOpenJDKä¸­æ‰€å¸¦çš„è™šæ‹Ÿæœºï¼Œä¹Ÿæ˜¯ç›®å‰ä½¿ç”¨èŒƒå›´æœ€å¹¿çš„Javaè™šæ‹Ÿæœºã€‚ä½†ä¸ä¸€å®šæ‰€æœ‰äººéƒ½çŸ¥é“çš„æ˜¯ï¼Œè¿™ä¸ªç›®å‰çœ‹èµ·æ¥â€œè¡€ç»Ÿçº¯æ­£â€çš„è™šæ‹Ÿæœºåœ¨æœ€åˆå¹¶éç”±Sunå…¬å¸å¼€å‘ï¼Œè€Œæ˜¯ç”±ä¸€å®¶åä¸ºâ€œLongview Technologiesâ€çš„å°å…¬å¸è®¾è®¡çš„ï¼›ç”šè‡³è¿™ä¸ªè™šæ‹Ÿæœºæœ€åˆå¹¶éæ˜¯ä¸ºJavaè¯­è¨€è€Œå¼€å‘çš„ï¼Œå®ƒæ¥æºäºStrongtalk VMï¼Œè€Œè¿™æ¬¾è™šæ‹Ÿæœºä¸­ç›¸å½“å¤šçš„æŠ€æœ¯åˆæ˜¯æ¥æºäºä¸€æ¬¾æ”¯æŒSelfè¯­è¨€å®ç°â€œè¾¾åˆ°Cè¯­è¨€50%ä»¥ä¸Šçš„æ‰§è¡Œæ•ˆç‡â€çš„ç›®æ ‡è€Œè®¾è®¡çš„è™šæ‹Ÿæœºï¼ŒSunå…¬å¸æ³¨æ„åˆ°äº†è¿™æ¬¾è™šæ‹Ÿæœºåœ¨JITç¼–è¯‘ä¸Šæœ‰è®¸å¤šä¼˜ç§€çš„ç†å¿µå’Œå®é™…æ•ˆæœï¼Œåœ¨1997å¹´æ”¶è´­äº†Longview Technologieså…¬å¸ï¼Œä»è€Œè·å¾—äº†HotSpot VMã€‚ HotSpot VMæ—¢ç»§æ‰¿äº†Sunä¹‹å‰ä¸¤æ¬¾å•†ç”¨è™šæ‹Ÿæœºçš„ä¼˜ç‚¹ï¼ˆå¦‚å‰é¢æåˆ°çš„å‡†ç¡®å¼å†…å­˜ç®¡ç†ï¼‰ï¼Œä¹Ÿæœ‰è®¸å¤šè‡ªå·±æ–°çš„æŠ€æœ¯ä¼˜åŠ¿ï¼Œå¦‚å®ƒåç§°ä¸­çš„HotSpotæŒ‡çš„å°±æ˜¯å®ƒçš„çƒ­ç‚¹ä»£ç æ¢æµ‹æŠ€æœ¯ï¼ˆå…¶å®ä¸¤ä¸ªVMåŸºæœ¬ä¸Šæ˜¯åŒæ—¶æœŸçš„ç‹¬ç«‹äº§å“ï¼ŒHotSpotè¿˜ç¨æ—©ä¸€äº›ï¼ŒHotSpotä¸€å¼€å§‹å°±æ˜¯å‡†ç¡®å¼GCï¼Œè€ŒExact VMä¹‹ä¸­ä¹Ÿæœ‰ä¸HotSpotå‡ ä¹ä¸€æ ·çš„çƒ­ç‚¹æ¢æµ‹ã€‚ä¸ºäº†Exact VMå’ŒHotSpot VMå“ªä¸ªæˆä¸ºSunä¸»è¦æ”¯æŒçš„VMäº§å“ï¼Œåœ¨Sunå…¬å¸å†…éƒ¨è¿˜æœ‰è¿‡äº‰è®ºï¼ŒHotSpotæ‰“è´¥Exactå¹¶ä¸èƒ½ç®—æŠ€æœ¯ä¸Šçš„èƒœåˆ©ï¼‰ï¼ŒHotSpot VMçš„çƒ­ç‚¹ä»£ç æ¢æµ‹èƒ½åŠ›å¯ä»¥é€šè¿‡æ‰§è¡Œè®¡æ•°å™¨æ‰¾å‡ºæœ€å…·æœ‰ç¼–è¯‘ä»·å€¼çš„ä»£ç ï¼Œç„¶åé€šçŸ¥JITç¼–è¯‘å™¨ä»¥æ–¹æ³•ä¸ºå•ä½è¿›è¡Œç¼–è¯‘ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•è¢«é¢‘ç¹è°ƒç”¨ï¼Œæˆ–æ–¹æ³•ä¸­æœ‰æ•ˆå¾ªç¯æ¬¡æ•°å¾ˆå¤šï¼Œå°†ä¼šåˆ†åˆ«è§¦å‘æ ‡å‡†ç¼–è¯‘å’ŒOSRï¼ˆæ ˆä¸Šæ›¿æ¢ï¼‰ç¼–è¯‘åŠ¨ä½œã€‚é€šè¿‡ç¼–è¯‘å™¨ä¸è§£é‡Šå™¨æ°å½“åœ°ååŒå·¥ä½œï¼Œå¯ä»¥åœ¨æœ€ä¼˜åŒ–çš„ç¨‹åºå“åº”æ—¶é—´ä¸æœ€ä½³æ‰§è¡Œæ€§èƒ½ä¸­å–å¾—å¹³è¡¡ï¼Œè€Œä¸”æ— é¡»ç­‰å¾…æœ¬åœ°ä»£ç è¾“å‡ºæ‰èƒ½æ‰§è¡Œç¨‹åºï¼Œå³æ—¶ç¼–è¯‘çš„æ—¶é—´å‹åŠ›ä¹Ÿç›¸å¯¹å‡å°ï¼Œè¿™æ ·æœ‰åŠ©äºå¼•å…¥æ›´å¤šçš„ä»£ç ä¼˜åŒ–æŠ€æœ¯ï¼Œè¾“å‡ºè´¨é‡æ›´é«˜çš„æœ¬åœ°ä»£ç ã€‚ åœ¨2006å¹´çš„JavaOneå¤§ä¼šä¸Šï¼ŒSunå…¬å¸å®£å¸ƒæœ€ç»ˆä¼šæŠŠJavaå¼€æºï¼Œå¹¶åœ¨éšåçš„ä¸€å¹´ï¼Œé™†ç»­å°†JDKçš„å„ä¸ªéƒ¨åˆ†ï¼ˆå…¶ä¸­å½“ç„¶ä¹ŸåŒ…æ‹¬äº†HotSpot VMï¼‰åœ¨GPLåè®®ä¸‹å…¬å¼€äº†æºç ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šå»ºç«‹äº†OpenJDKã€‚è¿™æ ·ï¼ŒHotSpot VMä¾¿æˆä¸ºäº†Sun JDKå’ŒOpenJDKä¸¤ä¸ªå®ç°æåº¦æ¥è¿‘çš„JDKé¡¹ç›®çš„å…±åŒè™šæ‹Ÿæœºã€‚ åœ¨2008å¹´å’Œ2009å¹´ï¼ŒOracleå…¬å¸åˆ†åˆ«æ”¶è´­äº†BEAå…¬å¸å’ŒSunå…¬å¸ï¼Œè¿™æ ·Oracleå°±åŒæ—¶æ‹¥æœ‰äº†ä¸¤æ¬¾ä¼˜ç§€çš„Javaè™šæ‹Ÿæœºï¼šJRockit VMå’ŒHotSpot VMã€‚Oracleå…¬å¸å®£å¸ƒåœ¨ä¸ä¹…çš„å°†æ¥ï¼ˆå¤§çº¦åº”åœ¨å‘å¸ƒJDK 8çš„æ—¶å€™ï¼‰ä¼šå®Œæˆè¿™ä¸¤æ¬¾è™šæ‹Ÿæœºçš„æ•´åˆå·¥ä½œï¼Œä½¿ä¹‹ä¼˜åŠ¿äº’è¡¥ã€‚æ•´åˆçš„æ–¹å¼å¤§è‡´ä¸Šæ˜¯åœ¨HotSpotçš„åŸºç¡€ä¸Šï¼Œç§»æ¤JRockitçš„ä¼˜ç§€ç‰¹æ€§ï¼Œè­¬å¦‚ä½¿ç”¨JRockitçš„åƒåœ¾å›æ”¶å™¨ä¸MissionControlæœåŠ¡ï¼Œä½¿ç”¨HotSpotçš„JITç¼–è¯‘å™¨ä¸æ··åˆçš„è¿è¡Œæ—¶ç³»ç»Ÿã€‚","categories":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/categories/JVM/"}],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/tags/JVM/"}]},{"title":"LinkedHashMap","slug":"LinkedHashMap","date":"2018-04-22T11:37:01.000Z","updated":"2018-04-23T11:06:33.655Z","comments":true,"path":"2018/04/22/LinkedHashMap/","link":"","permalink":"https://hsb786.github.io/2018/04/22/LinkedHashMap/","excerpt":"LinkedHashMap ä¿è¯æ’å…¥æ•°æ®çš„æœ‰åºæ€§","text":"LinkedHashMap ä¿è¯æ’å…¥æ•°æ®çš„æœ‰åºæ€§ 12345678910111213141516171819202122232425262728293031public class LinkedHashMap&lt;K,V&gt; extends HashMap&lt;K,V&gt; implements Map&lt;K,V&gt;&#123; static class Entry&lt;K,V&gt; extends HashMap.Node&lt;K,V&gt; &#123; Entry&lt;K,V&gt; before, after; Entry(int hash, K key, V value, Node&lt;K,V&gt; next) &#123; super(hash, key, value, next); &#125; &#125; /** * The head (eldest) of the doubly linked list. */ transient LinkedHashMap.Entry&lt;K,V&gt; head; /** * The tail (youngest) of the doubly linked list. */ transient LinkedHashMap.Entry&lt;K,V&gt; tail; /** * The iteration ordering method for this linked hash map: &lt;tt&gt;true&lt;/tt&gt; * for access-order, &lt;tt&gt;false&lt;/tt&gt; for insertion-order. * * @serial */ final boolean accessOrder; public LinkedHashMap() &#123; super(); accessOrder = false; &#125;&#125; LinkedHashMapå†…éƒ¨æ²¡æœ‰é‡å†™putæ–¹æ³•ï¼Œå¾ˆå¥½å¥‡ï¼Œæ˜¯æ€ä¹ˆæŠŠé“¾è¡¨åŠ ä¸Šå»çš„ã€‚ 123456//HashMap.classfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,boolean evict) &#123; .................... afterNodeInsertion(evict); return null;&#125; åœ¨ä¸€ç¯‡åšå®¢ä¸Šçœ‹åˆ°åŠ é“¾è¡¨æ˜¯é€šè¿‡afterNodeInsertion(evict)ã€‚å¯ä»¥çœ‹å‡ºæ¯æ¬¡putçš„æ—¶å€™éƒ½è°ƒç”¨äº†afterNodeInsertion(evict); è€Œè¿™ä¸ªafterNodeInsertionåœ¨LinkedHashMapä¸­æ˜¯é‡å†™äº†çš„ã€‚ç„¶åå°±å‚»å‘¼å‘¼çš„ç›¸ä¿¡äº†ï¼Œbut åœ¨afterNodeInsertion(evict)ä¸­å¹¶æ²¡æœ‰æ·»åŠ é“¾è¡¨å•Šï¼Œå‚»å‚»çš„ç›¯ç€è¿™æ®µä»£ç çœ‹äº†å¾ˆä¹…ã€‚ 1234567void afterNodeInsertion(boolean evict) &#123; // possibly remove eldest LinkedHashMap.Entry&lt;K,V&gt; first; if (evict &amp;&amp; (first = head) != null &amp;&amp; removeEldestEntry(first)) &#123; K key = first.key; removeNode(hash(key), key, null, false, true); &#125;&#125; äºæ˜¯ï¼Œå¼€å§‹è‡ªå·±æ‰¾ã€‚å‘ç°äº†linkNodeLast()æ–¹æ³•ï¼Œè¿™ä¸å°±æ˜¯å®ç°é“¾è¡¨çš„å…³é”®å—ã€‚1234567891011// link at the end of listprivate void linkNodeLast(LinkedHashMap.Entry&lt;K,V&gt; p) &#123; LinkedHashMap.Entry&lt;K,V&gt; last = tail; tail = p; if (last == null) head = p; else &#123; p.before = last; last.after = p; &#125;&#125; æ¥ç€å‘ç°linkNodeLast()åœ¨newNode()ä¸­è°ƒç”¨123456Node&lt;K,V&gt; newNode(int hash, K key, V value, Node&lt;K,V&gt; e) &#123; LinkedHashMap.Entry&lt;K,V&gt; p = new LinkedHashMap.Entry&lt;K,V&gt;(hash, key, value, e); linkNodeLast(p); return p;&#125; å¹¶ä¸”newNode()åœ¨HashMapä¸­ä¹Ÿå­˜åœ¨ï¼Œæ³¨é‡Šè¿˜å†™å¾—æ¸…æ¸…æ¥šæ¥šï¼Œå°±æ˜¯ç”¨æ¥è¢«LinkedHashMapé‡å†™çš„ã€‚1234567891011121314151617//HashMap.class/* ------------------------------------------------------------ */// LinkedHashMap support/** The following package-protected methods are designed to be* overridden by LinkedHashMap, but not by any other subclass.* Nearly all other internal methods are also package-protected* but are declared final, so can be used by LinkedHashMap, view* classes, and HashSet.*/// Create a regular (non-tree) nodeNode&lt;K,V&gt; newNode(int hash, K key, V value, Node&lt;K,V&gt; next) &#123; return new Node&lt;&gt;(hash, key, value, next);&#125; åœ¨putVal()ä¸­è°ƒç”¨äº†newNode()12345678 final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null);&#125; è¿™æ ·å°±è§£é‡Šé€šäº†ï¼ŒLinkedHashMapæ²¡æœ‰é‡å†™putæ–¹æ³•ã€‚ä¸ºäº†ä¿è¯æœ‰åºï¼Œé‚£ä¹ˆä»–æ˜¯æ€ä¹ˆå®ç°é“¾è¡¨çš„å‘¢ï¼Ÿ åˆ©ç”¨å¤šæ€ï¼Œé€šè¿‡é‡å†™newNode()æ–¹æ³•ï¼Œåœ¨newNode()æ–¹æ³•ä¸­å®ç°äº†é“¾è¡¨çš„è¿æ¥ã€‚è€ŒnewNodeæ–¹æ³•åœ¨putVal()ä¸­è°ƒç”¨äº†ã€‚soï¼Œæ¯æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šç»´æŠ¤ä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚é€šè¿‡é“¾è¡¨å®ç°äº†æœ‰åºã€‚ çœ‹æ¥ï¼Œå¹³æ—¶ä¸èƒ½å¤ªä¾èµ–äºç½‘ä¸Šåˆ«äººåˆ†æçš„ä¸œè¥¿ï¼Œä¸ä¸€å®šæ˜¯å¯¹çš„ã€‚ accessOrder LinkedHashMapä¸­å®šä¹‰äº†accessOrderå±æ€§ã€‚å®˜æ–¹æ˜¯è¿™æ ·è§£é‡Šçš„ï¼šaccessOrderä¸ºtrueæ—¶ï¼Œè¿­ä»£é¡ºåºå°±æ˜¯è®¿é—®é¡ºåºï¼›ä¸ºfalseæ—¶ï¼Œè¿­ä»£é¡ºåºå°±æ˜¯æ’å…¥é¡ºåºã€‚æ’å…¥é¡ºåºå€’å¥½ç†è§£ï¼Œè®¿é—®é¡ºåºæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ1234567/*** The iteration ordering method for this linked hash map: &lt;tt&gt;true&lt;/tt&gt;* for access-order, &lt;tt&gt;false&lt;/tt&gt; for insertion-order.** @serial*/final boolean accessOrder; LinkedHashMapé‡å†™äº†get(Object key)æ–¹æ³•ã€‚accessOrderä¸ºtrueæ—¶ï¼Œè°ƒç”¨äº†afterNodeAccess(e);æ–¹æ³•12345678public V get(Object key) &#123; Node&lt;K,V&gt; e; if ((e = getNode(hash(key), key)) == null) return null; if (accessOrder) afterNodeAccess(e); return e.value;&#125; void afterNodeAccess(Node&lt;K,V&gt; e) æ–¹æ³•æ³¨è§£å†™çš„å¾ˆæ˜ç™½ï¼Œmove node to lastï¼ŒæŠŠnodeç§»åŠ¨åˆ°æœ€åã€‚æ„æ€å°±æ˜¯å¦‚æœaccessOrderè®¾ä¸ºtrueæ—¶ï¼Œæ¯æ¬¡é€šè¿‡get()è·å–ï¼Œéƒ½ä¼šæŠŠè·å–çš„å…ƒç´ ç§»åˆ°é“¾è¡¨çš„æœ€åé¢ã€‚123456789101112131415161718192021222324void afterNodeAccess(Node&lt;K,V&gt; e) &#123; // move node to last LinkedHashMap.Entry&lt;K,V&gt; last; if (accessOrder &amp;&amp; (last = tail) != e) &#123; LinkedHashMap.Entry&lt;K,V&gt; p = (LinkedHashMap.Entry&lt;K,V&gt;)e, b = p.before, a = p.after; p.after = null; if (b == null) head = a; else b.after = a; if (a != null) a.before = b; else last = b; if (last == null) head = p; else &#123; p.before = last; last.after = p; &#125; tail = p; ++modCount; &#125;&#125; final boolean accessOrder; accessOrderåŒ…è®¿é—®æƒé™ï¼Œä¹Ÿæ²¡æœ‰setæ–¹æ³•ï¼Œåªèƒ½é€šè¿‡public LinkedHashMap(int initialCapacity,float loadFactor, boolean accessOrder) æ„é€ å‡½æ•°æ¥å°†accessOrderè®¾ä¸ºtrueã€‚123456public LinkedHashMap(int initialCapacity, float loadFactor, boolean accessOrder) &#123; super(initialCapacity, loadFactor); this.accessOrder = accessOrder; &#125;","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"é›†åˆ","slug":"çˆªå“‡/é›†åˆ","permalink":"https://hsb786.github.io/categories/çˆªå“‡/é›†åˆ/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"HashSet","slug":"HashSet","date":"2018-04-22T10:44:43.000Z","updated":"2018-04-22T11:37:57.346Z","comments":true,"path":"2018/04/22/HashSet/","link":"","permalink":"https://hsb786.github.io/2018/04/22/HashSet/","excerpt":"HashSet åº•å±‚ç”±HashMapå®ç°","text":"HashSet åº•å±‚ç”±HashMapå®ç°12345678910111213141516171819202122232425262728293031public class HashSet&lt;E&gt; extends AbstractSet&lt;E&gt; implements Set&lt;E&gt;, Cloneable, java.io.Serializable&#123; //HashSetåº•å±‚ä½¿ç”¨HashMapå®ç° private transient HashMap&lt;E,Object&gt; map; // Dummy value to associate with an Object in the backing Map //HashSet add(E e)æ–¹æ³•ä¸­ï¼Œkeyä¸ºeï¼Œvalueä¸ºPRESENT private static final Object PRESENT = new Object(); public HashSet() &#123; map = new HashMap&lt;&gt;(); &#125; /** * Constructs a new, empty linked hash set. (This package private * constructor is only used by LinkedHashSet.) The backing * HashMap instance is a LinkedHashMap with the specified initial * capacity and the specified load factor. * * @param initialCapacity the initial capacity of the hash map * @param loadFactor the load factor of the hash map * @param dummy ignored (distinguishes this * constructor from other int, float constructor.) * @throws IllegalArgumentException if the initial capacity is less * than zero, or if the load factor is nonpositive */ //è¿™ä¸ªå°±æœ‰ç‚¹æ„æ€äº†ï¼Œdummyå‚æ•°å…¶å®æ²¡ç”¨ï¼Œåªæ˜¯ä¸ºäº†é‡è½½ï¼Œä¸å…¶å®ƒæ–¹æ³•åŒºåˆ†å¼€äº†è€Œå·²ï¼Œè¿™æ ·ä¹Ÿè¡Œï¼ //æ³¨æ„çš„æ˜¯è¿”å›çš„æ˜¯LinkedHashMapï¼Œæ•°æ®æ˜¯æœ‰é¡ºåºçš„ã€‚ HashSet(int initialCapacity, float loadFactor, boolean dummy) &#123; map = new LinkedHashMap&lt;&gt;(initialCapacity, loadFactor); &#125;&#125; add(E e),remove(Object o)åªæ˜¯ç›´æ¥è°ƒç”¨HashMapçš„putå’Œremoveæ–¹æ³•ã€‚key: e ; value : PRESENT1234567public boolean add(E e) &#123; return map.put(e, PRESENT)==null;&#125;public boolean remove(Object o) &#123; return map.remove(o)==PRESENT;&#125;","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"é›†åˆ","slug":"çˆªå“‡/é›†åˆ","permalink":"https://hsb786.github.io/categories/çˆªå“‡/é›†åˆ/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Javaå†…å­˜è®¿é—®é‡æ’åºçš„ç ”ç©¶ï¼ˆè½¬è½½ï¼‰","slug":"Javaå†…å­˜è®¿é—®é‡æ’åºçš„ç ”ç©¶","date":"2018-04-21T13:40:14.000Z","updated":"2018-04-24T05:49:34.283Z","comments":true,"path":"2018/04/21/Javaå†…å­˜è®¿é—®é‡æ’åºçš„ç ”ç©¶/","link":"","permalink":"https://hsb786.github.io/2018/04/21/Javaå†…å­˜è®¿é—®é‡æ’åºçš„ç ”ç©¶/","excerpt":"ç¾å›¢æŠ€æœ¯åšå®¢ä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼Œè®²çš„å¾ˆå¥½ï¼Œå°±æ˜¯åˆ°äº†åé¢æœ‰äº›çœ‹ä¸å¤ªæ‡‚ï¼Œåªèƒ½æ€ªè‡ªå·±å¤ªèœäº†ã€‚åŸæ–‡é“¾æ¥","text":"ç¾å›¢æŠ€æœ¯åšå®¢ä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼Œè®²çš„å¾ˆå¥½ï¼Œå°±æ˜¯åˆ°äº†åé¢æœ‰äº›çœ‹ä¸å¤ªæ‡‚ï¼Œåªèƒ½æ€ªè‡ªå·±å¤ªèœäº†ã€‚åŸæ–‡é“¾æ¥ ä»€ä¹ˆæ˜¯é‡æ’åº12345678910111213141516171819202122public class PossibleReordering &#123;static int x = 0, y = 0;static int a = 0, b = 0;public static void main(String[] args) throws InterruptedException &#123; Thread one = new Thread(new Runnable() &#123; public void run() &#123; a = 1; x = b; &#125; &#125;); Thread other = new Thread(new Runnable() &#123; public void run() &#123; b = 1; y = a; &#125; &#125;); one.start();other.start(); one.join();other.join(); System.out.println(â€œ(â€ + x + â€œ,â€ + y + â€œ)â€);&#125; å¾ˆå®¹æ˜“æƒ³åˆ°è¿™æ®µä»£ç çš„è¿è¡Œç»“æœå¯èƒ½ä¸º(1,0)ã€(0,1)æˆ–(1,1)ï¼Œå› ä¸ºçº¿ç¨‹oneå¯ä»¥åœ¨çº¿ç¨‹twoå¼€å§‹ä¹‹å‰å°±æ‰§è¡Œå®Œäº†ï¼Œä¹Ÿæœ‰å¯èƒ½åä¹‹ï¼Œç”šè‡³æœ‰å¯èƒ½äºŒè€…çš„æŒ‡ä»¤æ˜¯åŒæ—¶æˆ–äº¤æ›¿æ‰§è¡Œçš„ã€‚ ç„¶è€Œï¼Œè¿™æ®µä»£ç çš„æ‰§è¡Œç»“æœä¹Ÿå¯èƒ½æ˜¯(0,0). å› ä¸ºï¼Œåœ¨å®é™…è¿è¡Œæ—¶ï¼Œä»£ç æŒ‡ä»¤å¯èƒ½å¹¶ä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§ä»£ç è¯­å¥é¡ºåºæ‰§è¡Œçš„ã€‚å¾—åˆ°(0,0)ç»“æœçš„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œa=1å’Œx=bè¿™ä¸¤ä¸ªè¯­å¥çš„èµ‹å€¼æ“ä½œçš„é¡ºåºè¢«é¢ å€’äº†ï¼Œæˆ–è€…è¯´ï¼Œå‘ç”Ÿäº†æŒ‡ä»¤â€œé‡æ’åºâ€(reordering)ã€‚ï¼ˆäº‹å®ä¸Šï¼Œè¾“å‡ºäº†è¿™ä¸€ç»“æœï¼Œå¹¶ä¸ä»£è¡¨ä¸€å®šå‘ç”Ÿäº†æŒ‡ä»¤é‡æ’åºï¼Œå†…å­˜å¯è§æ€§é—®é¢˜ä¹Ÿä¼šå¯¼è‡´è¿™æ ·çš„è¾“å‡ºï¼Œè¯¦è§åæ–‡ï¼‰ å¯¹é‡æ’åºç°è±¡ä¸å¤ªäº†è§£çš„å¼€å‘è€…å¯èƒ½ä¼šå¯¹è¿™ç§ç°è±¡æ„Ÿåˆ°åƒæƒŠï¼Œä½†æ˜¯ï¼Œç¬”è€…å¼€å‘ç¯å¢ƒä¸‹åšçš„ä¸€ä¸ªå°å®éªŒè¯å®äº†è¿™ä¸€ç»“æœã€‚ å®éªŒä»£ç æ˜¯æ„é€ ä¸€ä¸ªå¾ªç¯ï¼Œåå¤æ‰§è¡Œä¸Šé¢çš„å®ä¾‹ä»£ç ï¼Œç›´åˆ°å‡ºç°a=0ä¸”b=0çš„è¾“å‡ºä¸ºæ­¢ã€‚å®éªŒç»“æœè¯´æ˜ï¼Œå¾ªç¯æ‰§è¡Œåˆ°ç¬¬13830æ¬¡æ—¶è¾“å‡ºäº†(0,0). å¤§å¤šæ•°ç°ä»£å¾®å¤„ç†å™¨éƒ½ä¼šé‡‡ç”¨å°†æŒ‡ä»¤ä¹±åºæ‰§è¡Œï¼ˆout-of-order executionï¼Œç®€ç§°OoOEæˆ–OOEï¼‰çš„æ–¹æ³•ï¼Œåœ¨æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è¿è¡Œå½“å‰æœ‰èƒ½åŠ›ç«‹å³æ‰§è¡Œçš„åç»­æŒ‡ä»¤ï¼Œé¿å¼€è·å–ä¸‹ä¸€æ¡æŒ‡ä»¤æ‰€éœ€æ•°æ®æ—¶é€ æˆçš„ç­‰å¾…ã€‚é€šè¿‡ä¹±åºæ‰§è¡Œçš„æŠ€æœ¯ï¼Œå¤„ç†å™¨å¯ä»¥å¤§å¤§æé«˜æ‰§è¡Œæ•ˆç‡ã€‚é™¤äº†å¤„ç†å™¨ï¼Œå¸¸è§çš„Javaè¿è¡Œæ—¶ç¯å¢ƒçš„JITç¼–è¯‘å™¨ä¹Ÿä¼šåšæŒ‡ä»¤é‡æ’åºæ“ä½œï¼Œå³ç”Ÿæˆçš„æœºå™¨æŒ‡ä»¤ä¸å­—èŠ‚ç æŒ‡ä»¤é¡ºåºä¸ä¸€è‡´ã€‚ as-if-serialè¯­ä¹‰As-if-serialè¯­ä¹‰çš„æ„æ€æ˜¯ï¼Œæ‰€æœ‰çš„åŠ¨ä½œ(Action)éƒ½å¯ä»¥ä¸ºäº†ä¼˜åŒ–è€Œè¢«é‡æ’åºï¼Œä½†æ˜¯å¿…é¡»ä¿è¯å®ƒä»¬é‡æ’åºåçš„ç»“æœå’Œç¨‹åºä»£ç æœ¬èº«çš„åº”æœ‰ç»“æœæ˜¯ä¸€è‡´çš„ã€‚Javaç¼–è¯‘å™¨ã€è¿è¡Œæ—¶å’Œå¤„ç†å™¨éƒ½ä¼šä¿è¯å•çº¿ç¨‹ä¸‹çš„as-if-serialè¯­ä¹‰ã€‚æ¯”å¦‚ï¼Œä¸ºäº†ä¿è¯è¿™ä¸€è¯­ä¹‰ï¼Œé‡æ’åºä¸ä¼šå‘ç”Ÿåœ¨æœ‰æ•°æ®ä¾èµ–çš„æ“ä½œä¹‹ä¸­ã€‚ 123int a = 1;int b = 2;int c = a + b; å°†ä¸Šé¢çš„ä»£ç ç¼–è¯‘æˆJavaå­—èŠ‚ç æˆ–ç”Ÿæˆæœºå™¨æŒ‡ä»¤ï¼Œå¯è§†ä¸ºå±•å¼€æˆäº†ä»¥ä¸‹å‡ æ­¥åŠ¨ä½œï¼ˆå®é™…å¯èƒ½ä¼šçœç•¥æˆ–æ·»åŠ æŸäº›æ­¥éª¤ï¼‰ã€‚ å¯¹aèµ‹å€¼1 å¯¹bèµ‹å€¼2 å–açš„å€¼ å–bçš„å€¼ å°†å–åˆ°ä¸¤ä¸ªå€¼ç›¸åŠ åå­˜å…¥c åœ¨ä¸Šé¢5ä¸ªåŠ¨ä½œä¸­ï¼ŒåŠ¨ä½œ1å¯èƒ½ä¼šå’ŒåŠ¨ä½œ2ã€4é‡æ’åºï¼ŒåŠ¨ä½œ2å¯èƒ½ä¼šå’ŒåŠ¨ä½œ1ã€3é‡æ’åºï¼ŒåŠ¨ä½œ3å¯èƒ½ä¼šå’ŒåŠ¨ä½œ2ã€4é‡æ’åºï¼ŒåŠ¨ä½œ4å¯èƒ½ä¼šå’Œ1ã€3é‡æ’åºã€‚ä½†åŠ¨ä½œ1å’ŒåŠ¨ä½œ3ã€5ä¸èƒ½é‡æ’åºã€‚åŠ¨ä½œ2å’ŒåŠ¨ä½œ4ã€5ä¸èƒ½é‡æ’åºã€‚å› ä¸ºå®ƒä»¬ä¹‹é—´å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼Œä¸€æ—¦é‡æ’ï¼Œas-if-serialè¯­ä¹‰ä¾¿æ— æ³•ä¿è¯ã€‚ ä¸ºä¿è¯as-if-serialè¯­ä¹‰ï¼ŒJavaå¼‚å¸¸å¤„ç†æœºåˆ¶ä¹Ÿä¼šä¸ºé‡æ’åºåšä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚ä¾‹å¦‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œy = 0 / 0å¯èƒ½ä¼šè¢«é‡æ’åºåœ¨x = 2ä¹‹å‰æ‰§è¡Œï¼Œä¸ºäº†ä¿è¯æœ€ç»ˆä¸è‡´äºè¾“å‡ºx = 1çš„é”™è¯¯ç»“æœï¼ŒJITåœ¨é‡æ’åºæ—¶ä¼šåœ¨catchè¯­å¥ä¸­æ’å…¥é”™è¯¯ä»£å¿ä»£ç ï¼Œå°†xèµ‹å€¼ä¸º2ï¼Œå°†ç¨‹åºæ¢å¤åˆ°å‘ç”Ÿå¼‚å¸¸æ—¶åº”æœ‰çš„çŠ¶æ€ã€‚è¿™ç§åšæ³•çš„ç¡®å°†å¼‚å¸¸æ•æ‰çš„é€»è¾‘å˜å¾—å¤æ‚äº†ï¼Œä½†æ˜¯JITçš„ä¼˜åŒ–çš„åŸåˆ™æ˜¯ï¼Œå°½åŠ›ä¼˜åŒ–æ­£å¸¸è¿è¡Œä¸‹çš„ä»£ç é€»è¾‘ï¼Œå“ªæ€•ä»¥catchå—é€»è¾‘å˜å¾—å¤æ‚ä¸ºä»£ä»·ï¼Œæ¯•ç«Ÿï¼Œè¿›å…¥catchå—å†…æ˜¯ä¸€ç§â€œå¼‚å¸¸â€æƒ…å†µçš„è¡¨ç°ã€‚ 12345678910111213public class Reordering &#123; public static void main(String[] args) &#123; int x, y; x = 1; try &#123; x = 2; y = 0 / 0; &#125; catch (Exception e) &#123; &#125; finally &#123; System.out.println(&quot;x = &quot; + x); &#125; &#125;&#125; å†…å­˜è®¿é—®é‡æ’åºä¸å†…å­˜å¯è§æ€§è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œä¸ºäº†å°½å¯èƒ½åœ°é¿å…å¤„ç†å™¨è®¿é—®ä¸»å†…å­˜çš„æ—¶é—´å¼€é”€ï¼Œå¤„ç†å™¨å¤§å¤šä¼šåˆ©ç”¨ç¼“å­˜(cache)ä»¥æé«˜æ€§èƒ½ã€‚å…¶æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ åœ¨è¿™ç§æ¨¡å‹ä¸‹ä¼šå­˜åœ¨ä¸€ä¸ªç°è±¡ï¼Œå³ç¼“å­˜ä¸­çš„æ•°æ®ä¸ä¸»å†…å­˜çš„æ•°æ®å¹¶ä¸æ˜¯å®æ—¶åŒæ­¥çš„ï¼Œå„CPUï¼ˆæˆ–CPUæ ¸å¿ƒï¼‰é—´ç¼“å­˜çš„æ•°æ®ä¹Ÿä¸æ˜¯å®æ—¶åŒæ­¥çš„ã€‚è¿™å¯¼è‡´åœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œå„CPUæ‰€çœ‹åˆ°åŒä¸€å†…å­˜åœ°å€çš„æ•°æ®çš„å€¼å¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ã€‚ä»ç¨‹åºçš„è§†è§’æ¥çœ‹ï¼Œå°±æ˜¯åœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œå„ä¸ªçº¿ç¨‹æ‰€çœ‹åˆ°çš„å…±äº«å˜é‡çš„å€¼å¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ã€‚æœ‰çš„è§‚ç‚¹ä¼šå°†è¿™ç§ç°è±¡ä¹Ÿè§†ä¸ºé‡æ’åºçš„ä¸€ç§ï¼Œå‘½åä¸ºâ€œå†…å­˜ç³»ç»Ÿé‡æ’åºâ€ã€‚å› ä¸ºè¿™ç§å†…å­˜å¯è§æ€§é—®é¢˜é€ æˆçš„ç»“æœå°±å¥½åƒæ˜¯å†…å­˜è®¿é—®æŒ‡ä»¤å‘ç”Ÿäº†é‡æ’åºä¸€æ ·ã€‚è¿™ç§å†…å­˜å¯è§æ€§é—®é¢˜ä¹Ÿä¼šå¯¼è‡´ç« èŠ‚ä¸€ä¸­ç¤ºä¾‹ä»£ç å³ä¾¿åœ¨æ²¡æœ‰å‘ç”ŸæŒ‡ä»¤é‡æ’åºçš„æƒ…å†µä¸‹çš„æ‰§è¡Œç»“æœä¹Ÿè¿˜æ˜¯(0, 0)ã€‚ å†…å­˜è®¿é—®é‡æ’åºä¸Javaå†…å­˜æ¨¡å‹Javaçš„ç›®æ ‡æ˜¯æˆä¸ºä¸€é—¨å¹³å°æ— å…³æ€§çš„è¯­è¨€ï¼Œå³Write once, run anywhere. ä½†æ˜¯ä¸åŒç¡¬ä»¶ç¯å¢ƒä¸‹æŒ‡ä»¤é‡æ’åºçš„è§„åˆ™ä¸å°½ç›¸åŒã€‚ä¾‹å¦‚ï¼Œx86ä¸‹è¿è¡Œæ­£å¸¸çš„Javaç¨‹åºåœ¨IA64ä¸‹å°±å¯èƒ½å¾—åˆ°éé¢„æœŸçš„è¿è¡Œç»“æœã€‚ä¸ºæ­¤ï¼ŒJSR-1337åˆ¶å®šäº†Javaå†…å­˜æ¨¡å‹(Java Memory Model, JMM)ï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å¯å‚è€ƒçš„è§„èŒƒï¼Œå±è”½å¹³å°å·®å¼‚æ€§ã€‚ä»Java 5å¼€å§‹ï¼ŒJavaå†…å­˜æ¨¡å‹æˆä¸ºJavaè¯­è¨€è§„èŒƒçš„ä¸€éƒ¨åˆ†ã€‚æ ¹æ®Javaå†…å­˜æ¨¡å‹ä¸­çš„è§„å®šï¼Œå¯ä»¥æ€»ç»“å‡ºä»¥ä¸‹å‡ æ¡happens-beforeè§„åˆ™ã€‚Happens-beforeçš„å‰åä¸¤ä¸ªæ“ä½œä¸ä¼šè¢«é‡æ’åºä¸”åè€…å¯¹å‰è€…çš„å†…å­˜å¯è§ã€‚ ç¨‹åºæ¬¡åºæ³•åˆ™ï¼šçº¿ç¨‹ä¸­çš„æ¯ä¸ªåŠ¨ä½œAéƒ½happens-beforeäºè¯¥çº¿ç¨‹ä¸­çš„æ¯ä¸€ä¸ªåŠ¨ä½œBï¼Œå…¶ä¸­ï¼Œåœ¨ç¨‹åºä¸­ï¼Œæ‰€æœ‰çš„åŠ¨ä½œBéƒ½èƒ½å‡ºç°åœ¨Aä¹‹åã€‚ ç›‘è§†å™¨é”æ³•åˆ™ï¼šå¯¹ä¸€ä¸ªç›‘è§†å™¨é”çš„è§£é” happens-beforeäºæ¯ä¸€ä¸ªåç»­å¯¹åŒä¸€ç›‘è§†å™¨é”çš„åŠ é”ã€‚ volatileå˜é‡æ³•åˆ™ï¼šå¯¹volatileåŸŸçš„å†™å…¥æ“ä½œhappens-beforeäºæ¯ä¸€ä¸ªåç»­å¯¹åŒä¸€ä¸ªåŸŸçš„è¯»å†™æ“ä½œã€‚ çº¿ç¨‹å¯åŠ¨æ³•åˆ™ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œï¼Œå¯¹Thread.startçš„è°ƒç”¨ä¼šhappens-beforeäºæ¯ä¸ªå¯åŠ¨çº¿ç¨‹çš„åŠ¨ä½œã€‚ çº¿ç¨‹ç»ˆç»“æ³•åˆ™ï¼šçº¿ç¨‹ä¸­çš„ä»»ä½•åŠ¨ä½œéƒ½happens-beforeäºå…¶ä»–çº¿ç¨‹æ£€æµ‹åˆ°è¿™ä¸ªçº¿ç¨‹å·²ç»ç»ˆç»“ã€æˆ–è€…ä»Thread.joinè°ƒç”¨ä¸­æˆåŠŸè¿”å›ï¼Œæˆ–Thread.isAliveè¿”å›falseã€‚ ä¸­æ–­æ³•åˆ™ï¼šä¸€ä¸ªçº¿ç¨‹è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹çš„interrupt happens-beforeäºè¢«ä¸­æ–­çš„çº¿ç¨‹å‘ç°ä¸­æ–­ã€‚ ç»ˆç»“æ³•åˆ™ï¼šä¸€ä¸ªå¯¹è±¡çš„æ„é€ å‡½æ•°çš„ç»“æŸhappens-beforeäºè¿™ä¸ªå¯¹è±¡finalizerçš„å¼€å§‹ã€‚ ä¼ é€’æ€§ï¼šå¦‚æœA happens-beforeäºBï¼Œä¸”B happens-beforeäºCï¼Œåˆ™A happens-beforeäºC Happens-beforeå…³ç³»åªæ˜¯å¯¹Javaå†…å­˜æ¨¡å‹çš„ä¸€ç§è¿‘ä¼¼æ€§çš„æè¿°ï¼Œå®ƒå¹¶ä¸å¤Ÿä¸¥è°¨ï¼Œä½†ä¾¿äºæ—¥å¸¸ç¨‹åºå¼€å‘å‚è€ƒä½¿ç”¨ï¼Œå…³äºæ›´ä¸¥è°¨çš„Javaå†…å­˜æ¨¡å‹çš„å®šä¹‰å’Œæè¿°ï¼Œè¯·é˜…è¯»JSR-133åŸæ–‡æˆ–Javaè¯­è¨€è§„èŒƒç« èŠ‚17.4ã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒJavaå†…å­˜æ¨¡å‹å¯¹volatileå’Œfinalçš„è¯­ä¹‰åšäº†æ‰©å±•ã€‚å¯¹volatileè¯­ä¹‰çš„æ‰©å±•ä¿è¯äº†volatileå˜é‡åœ¨ä¸€äº›æƒ…å†µä¸‹ä¸ä¼šé‡æ’åºï¼Œvolatileçš„64ä½å˜é‡doubleå’Œlongçš„è¯»å–å’Œèµ‹å€¼æ“ä½œéƒ½æ˜¯åŸå­çš„ã€‚å¯¹finalè¯­ä¹‰çš„æ‰©å±•ä¿è¯ä¸€ä¸ªå¯¹è±¡çš„æ„å»ºæ–¹æ³•ç»“æŸå‰ï¼Œæ‰€æœ‰finalæˆå‘˜å˜é‡éƒ½å¿…é¡»å®Œæˆåˆå§‹åŒ–ï¼ˆçš„å‰ææ˜¯æ²¡æœ‰thiså¼•ç”¨æº¢å‡ºï¼‰ã€‚ Javaå†…å­˜æ¨¡å‹å…³äºé‡æ’åºçš„è§„å®šï¼Œæ€»ç»“åå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ è¡¨ä¸­â€œç¬¬äºŒé¡¹æ“ä½œâ€çš„å«ä¹‰æ˜¯æŒ‡ï¼Œç¬¬ä¸€é¡¹æ“ä½œä¹‹åçš„æ‰€æœ‰æŒ‡å®šæ“ä½œã€‚å¦‚ï¼Œæ™®é€šè¯»ä¸èƒ½ä¸å…¶ä¹‹åçš„æ‰€æœ‰volatileå†™é‡æ’åºã€‚å¦å¤–ï¼ŒJMMä¹Ÿè§„å®šäº†ä¸Šè¿°volatileå’ŒåŒæ­¥å—çš„è§„åˆ™å°½é€‚ç”¨äºå­˜åœ¨å¤šçº¿ç¨‹è®¿é—®çš„æƒ…æ™¯ã€‚ä¾‹å¦‚ï¼Œè‹¥ç¼–è¯‘å™¨ï¼ˆè¿™é‡Œçš„ç¼–è¯‘å™¨ä¹ŸåŒ…æ‹¬JITï¼Œä¸‹åŒï¼‰è¯æ˜äº†ä¸€ä¸ªvolatileå˜é‡åªèƒ½è¢«å•çº¿ç¨‹è®¿é—®ï¼Œé‚£ä¹ˆå°±å¯èƒ½ä¼šæŠŠå®ƒåšä¸ºæ™®é€šå˜é‡æ¥å¤„ç†ã€‚ç•™ç™½çš„å•å…ƒæ ¼ä»£è¡¨å…è®¸åœ¨ä¸è¿åJavaåŸºæœ¬è¯­ä¹‰çš„æƒ…å†µä¸‹é‡æ’åºã€‚ä¾‹å¦‚ï¼Œç¼–è¯‘å™¨ä¸ä¼šå¯¹å¯¹åŒä¸€å†…å­˜åœ°å€çš„è¯»å’Œå†™æ“ä½œé‡æ’åºï¼Œä½†æ˜¯å…è®¸å¯¹ä¸åŒåœ°å€çš„è¯»å’Œå†™æ“ä½œé‡æ’åºã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†ä¿è¯finalçš„æ–°å¢è¯­ä¹‰ã€‚JSR-133å¯¹äºfinalå˜é‡çš„é‡æ’åºä¹Ÿåšäº†é™åˆ¶ã€‚ æ„å»ºæ–¹æ³•å†…éƒ¨çš„finalæˆå‘˜å˜é‡çš„å­˜å‚¨ï¼Œå¹¶ä¸”ï¼Œå‡å¦‚finalæˆå‘˜å˜é‡æœ¬èº«æ˜¯ä¸€ä¸ªå¼•ç”¨çš„è¯ï¼Œè¿™ä¸ªfinalæˆå‘˜å˜é‡å¯ä»¥å¼•ç”¨åˆ°çš„ä¸€åˆ‡å­˜å‚¨æ“ä½œï¼Œéƒ½ä¸èƒ½ä¸æ„å»ºæ–¹æ³•å¤–çš„å°†å½“æœŸæ„å»ºå¯¹è±¡èµ‹å€¼äºå¤šçº¿ç¨‹å…±äº«å˜é‡çš„å­˜å‚¨æ“ä½œé‡æ’åºã€‚ä¾‹å¦‚å¯¹äºå¦‚ä¸‹è¯­å¥x.finalField = v; â€¦ ; æ„å»ºæ–¹æ³•è¾¹ç•ŒsharedRef = x;v.afield = 1; x.finalField = v; â€¦ ; æ„å»ºæ–¹æ³•è¾¹ç•ŒsharedRef = x;è¿™ä¸¤æ¡è¯­å¥ä¸­ï¼Œæ„å»ºæ–¹æ³•è¾¹ç•Œå‰åçš„æŒ‡ä»¤éƒ½ä¸èƒ½é‡æ’åºã€‚ åˆå§‹è¯»å–å…±äº«å¯¹è±¡ä¸åˆå§‹è¯»å–è¯¥å…±äº«å¯¹è±¡çš„finalæˆå‘˜å˜é‡ä¹‹é—´ä¸èƒ½é‡æ’åºã€‚ä¾‹å¦‚å¯¹äºå¦‚ä¸‹è¯­å¥x = sharedRef; â€¦ ; i = x.finalField;å‰åä¸¤å¥è¯­å¥ä¹‹é—´ä¸ä¼šå‘ç”Ÿé‡æ’åºã€‚ç”±äºè¿™ä¸¤å¥è¯­å¥æœ‰æ•°æ®ä¾èµ–å…³ç³»ï¼Œç¼–è¯‘å™¨æœ¬èº«å°±ä¸ä¼šå¯¹å®ƒä»¬é‡æ’åºï¼Œä½†ç¡®å®æœ‰ä¸€äº›å¤„ç†å™¨ä¼šå¯¹è¿™ç§æƒ…å†µé‡æ’åºï¼Œå› æ­¤ç‰¹åˆ«åˆ¶å®šäº†è¿™ä¸€è§„åˆ™ã€‚ å†…å­˜å±éšœå†…å­˜å±éšœï¼ˆMemory Barrierï¼Œæˆ–æœ‰æ—¶å«åšå†…å­˜æ …æ ï¼ŒMemory Fenceï¼‰æ˜¯ä¸€ç§CPUæŒ‡ä»¤ï¼Œç”¨äºæ§åˆ¶ç‰¹å®šæ¡ä»¶ä¸‹çš„é‡æ’åºå’Œå†…å­˜å¯è§æ€§é—®é¢˜ã€‚Javaç¼–è¯‘å™¨ä¹Ÿä¼šæ ¹æ®å†…å­˜å±éšœçš„è§„åˆ™ç¦æ­¢é‡æ’åºã€‚å†…å­˜å±éšœå¯ä»¥è¢«åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ LoadLoadå±éšœï¼šå¯¹äºè¿™æ ·çš„è¯­å¥Load1; LoadLoad; Load2ï¼Œåœ¨Load2åŠåç»­è¯»å–æ“ä½œè¦è¯»å–çš„æ•°æ®è¢«è®¿é—®å‰ï¼Œä¿è¯Load1è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•ã€‚ StoreStoreå±éšœï¼šå¯¹äºè¿™æ ·çš„è¯­å¥Store1; StoreStore; Store2ï¼Œåœ¨Store2åŠåç»­å†™å…¥æ“ä½œæ‰§è¡Œå‰ï¼Œä¿è¯Store1çš„å†™å…¥æ“ä½œå¯¹å…¶å®ƒå¤„ç†å™¨å¯è§ã€‚ LoadStoreå±éšœï¼šå¯¹äºè¿™æ ·çš„è¯­å¥Load1; LoadStore; Store2ï¼Œåœ¨Store2åŠåç»­å†™å…¥æ“ä½œè¢«åˆ·å‡ºå‰ï¼Œä¿è¯Load1è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•ã€‚ StoreLoadå±éšœï¼šå¯¹äºè¿™æ ·çš„è¯­å¥Store1; StoreLoad; Load2ï¼Œåœ¨Load2åŠåç»­æ‰€æœ‰è¯»å–æ“ä½œæ‰§è¡Œå‰ï¼Œä¿è¯Store1çš„å†™å…¥å¯¹æ‰€æœ‰å¤„ç†å™¨å¯è§ã€‚å®ƒçš„å¼€é”€æ˜¯å››ç§å±éšœä¸­æœ€å¤§çš„ã€‚åœ¨å¤§å¤šæ•°å¤„ç†å™¨çš„å®ç°ä¸­ï¼Œè¿™ä¸ªå±éšœæ˜¯ä¸ªä¸‡èƒ½å±éšœï¼Œå…¼å…·å…¶å®ƒä¸‰ç§å†…å­˜å±éšœçš„åŠŸèƒ½ã€‚ æœ‰çš„å¤„ç†å™¨çš„é‡æ’åºè§„åˆ™è¾ƒä¸¥ï¼Œæ— éœ€å†…å­˜å±éšœä¹Ÿèƒ½å¾ˆå¥½çš„å·¥ä½œï¼ŒJavaç¼–è¯‘å™¨ä¼šåœ¨è¿™ç§æƒ…å†µä¸‹ä¸æ”¾ç½®å†…å­˜å±éšœã€‚ä¸ºäº†å®ç°ä¸Šä¸€ç« ä¸­è®¨è®ºçš„JSR-133çš„è§„å®šï¼ŒJavaç¼–è¯‘å™¨ä¼šè¿™æ ·ä½¿ç”¨å†…å­˜å±éšœã€‚ ä¸ºäº†ä¿è¯finalå­—æ®µçš„ç‰¹æ®Šè¯­ä¹‰ï¼Œä¹Ÿä¼šåœ¨ä¸‹é¢çš„è¯­å¥åŠ å…¥å†…å­˜å±éšœã€‚x.finalField = v; StoreStore; sharedRef = x; Intel 64/IA-32æ¶æ„ä¸‹çš„å†…å­˜è®¿é—®é‡æ’åºIntel 64å’ŒIA-32æ˜¯æˆ‘ä»¬è¾ƒå¸¸ç”¨çš„ç¡¬ä»¶ç¯å¢ƒï¼Œç›¸å¯¹äºå…¶å®ƒå¤„ç†å™¨è€Œè¨€ï¼Œå®ƒä»¬æ‹¥æœ‰ä¸€ç§è¾ƒä¸¥æ ¼çš„é‡æ’åºè§„åˆ™ã€‚Pentium 4ä»¥åçš„Intel 64æˆ–IA-32å¤„ç†çš„é‡æ’åºè§„åˆ™å¦‚ä¸‹ã€‚ åœ¨å•CPUç³»ç»Ÿä¸­ è¯»æ“ä½œä¸ä¸å…¶å®ƒè¯»æ“ä½œé‡æ’åºã€‚ å†™æ“ä½œä¸ä¸å…¶ä¹‹å‰çš„å†™æ“ä½œé‡æ’åºã€‚ å†™å†…å­˜æ“ä½œä¸ä¸å…¶å®ƒå†™æ“ä½œé‡æ’åºï¼Œä½†æœ‰ä»¥ä¸‹å‡ ç§ä¾‹å¤– CLFLUSHçš„å†™æ“ä½œ å¸¦æœ‰non-temporal moveæŒ‡ä»¤(MOVNTI, MOVNTQ, MOVNTDQ, MOVNTPS, and MOVNTPD)çš„streamingå†™å…¥ã€‚ å­—ç¬¦ä¸²æ“ä½œ è¯»æ“ä½œå¯èƒ½ä¼šä¸å…¶ä¹‹å‰çš„å†™ä¸åŒä½ç½®çš„å†™æ“ä½œé‡æ’åºï¼Œä½†ä¸ä¸å…¶ä¹‹å‰çš„å†™ç›¸åŒä½ç½®çš„å†™æ“ä½œé‡æ’åºã€‚ è¯»å’Œå†™æ“ä½œä¸ä¸I/OæŒ‡ä»¤ï¼Œå¸¦é”çš„æŒ‡ä»¤æˆ–åºåˆ—åŒ–æŒ‡ä»¤é‡æ’åºã€‚ è¯»æ“ä½œä¸èƒ½é‡æ’åºåˆ°LFENCEå’ŒMFENCEä¹‹å‰ã€‚ å†™æ“ä½œä¸èƒ½é‡æ’åºåˆ°LFENCEã€SFENCEå’ŒMFENCEä¹‹å‰ã€‚ LFENCEä¸èƒ½é‡æ’åºåˆ°è¯»æ“ä½œä¹‹å‰ã€‚ SFENCEä¸èƒ½é‡æ’åºåˆ°å†™ä¹‹å‰ã€‚ MFENCEä¸èƒ½é‡æ’åºåˆ°è¯»æˆ–å†™æ“ä½œä¹‹å‰ã€‚ åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ å„è‡ªå¤„ç†å™¨å†…éƒ¨éµå¾ªå•å¤„ç†å™¨çš„é‡æ’åºè§„åˆ™ã€‚ å•å¤„ç†å™¨çš„å†™æ“ä½œå¯¹æ‰€æœ‰å¤„ç†å™¨å¯è§æ˜¯åŒæ—¶çš„ã€‚ å„è‡ªå¤„ç†å™¨çš„å†™æ“ä½œä¸ä¼šé‡æ’åºã€‚ å†…å­˜é‡æ’åºéµå®ˆå› æœæ€§(causality)ï¼ˆå†…å­˜é‡æ’åºéµå®ˆä¼ é€’å¯è§æ€§ï¼‰ã€‚ ä»»ä½•å†™æ“ä½œå¯¹äºæ‰§è¡Œè¿™äº›å†™æ“ä½œçš„å¤„ç†å™¨ä¹‹å¤–çš„å¤„ç†å™¨æ¥çœ‹éƒ½æ˜¯ä¸€è‡´çš„ã€‚ så¸¦é”æŒ‡ä»¤æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºJavaç¼–è¯‘å™¨è€Œè¨€ï¼ŒIntel 64/IA-32æ¶æ„ä¸‹å¤„ç†å™¨ä¸éœ€è¦LoadLoadã€LoadStoreã€StoreStoreå±éšœï¼Œå› ä¸ºä¸ä¼šå‘ç”Ÿéœ€è¦è¿™ä¸‰ç§å±éšœçš„é‡æ’åºã€‚ ä¸€ä¾‹Intel 64/IA-32æ¶æ„ä¸‹çš„ä»£ç æ€§èƒ½ä¼˜åŒ–ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œä¸€ä¸ªå®¹å™¨å¯ä»¥æ”¾ä¸€ä¸ªä¸œè¥¿ï¼Œå®¹å™¨æ”¯æŒcreateæ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸œè¥¿å¹¶æ”¾åˆ°å®¹å™¨é‡Œï¼Œæ”¯æŒgetæ–¹æ³•å–åˆ°è¿™ä¸ªå®¹å™¨é‡Œçš„ä¸œè¥¿ã€‚æˆ‘ä»¬å¯ä»¥è¾ƒå®¹æ˜“åœ°å†™å‡ºä¸‹é¢çš„ä»£ç ã€‚ 1234567891011121314151617181920212223242526public class Container &#123; public static class SomeThing &#123; private int status; public SomeThing() &#123; status = 1; &#125; public int getStatus() &#123; return status; &#125; &#125; private SomeThing object; public void create() &#123; object = new SomeThing(); &#125; public SomeThing get() &#123; while (object == null) &#123; Thread.yield(); //ä¸åŠ è¿™å¥è¯å¯èƒ½ä¼šåœ¨æ­¤å‡ºç°æ— é™å¾ªç¯ &#125; return object; &#125;&#125; åœ¨å•çº¿ç¨‹åœºæ™¯ä¸‹ï¼Œè¿™æ®µä»£ç æ‰§è¡Œèµ·æ¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†æ˜¯åœ¨å¤šçº¿ç¨‹å¹¶å‘åœºæ™¯ä¸‹ï¼Œç”±ä¸åŒçš„çº¿ç¨‹createå’Œgetä¸œè¥¿ï¼Œè¿™æ®µä»£ç æ˜¯æœ‰é—®é¢˜çš„ã€‚é—®é¢˜çš„åŸå› ä¸æ™®é€šçš„åŒé‡æ£€æŸ¥é”å®šå•ä¾‹æ¨¡å¼(Double Checked Locking, DCL)10ç±»ä¼¼ï¼Œå³SomeThingçš„æ„å»ºä¸å°†æŒ‡å‘æ„å»ºä¸­çš„SomeThingå¼•ç”¨èµ‹å€¼åˆ°objectå˜é‡è¿™ä¸¤è€…å¯èƒ½ä¼šå‘ç”Ÿé‡æ’åºã€‚å¯¼è‡´getä¸­è¿”å›ä¸€ä¸ªæ­£è¢«æ„å»ºä¸­çš„ä¸å®Œæ•´çš„SomeThingå¯¹è±¡å®ä¾‹ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œé€šå¸¸çš„åŠæ³•æ˜¯ä½¿ç”¨volatileä¿®é¥°objectå­—æ®µã€‚è¿™ç§æ–¹æ³•é¿å…äº†é‡æ’åºï¼Œä¿è¯äº†å†…å­˜å¯è§æ€§ï¼Œæ‘’å¼ƒæ¯”ä½¿ç”¨åŒæ­¥å—å¯¼è‡´çš„æ€§èƒ½æŸå¤±æ›´å°ã€‚ä½†æ˜¯ï¼Œå‡å¦‚ä½¿ç”¨åœºæ™¯å¯¹objectçš„å†…å­˜å¯è§æ€§å¹¶ä¸æ•æ„Ÿçš„è¯ï¼ˆä¸è¦æ±‚ä¸€ä¸ªçº¿ç¨‹å†™å…¥äº†objectï¼Œobjectçš„æ–°å€¼ç«‹å³å¯¹ä¸‹ä¸€ä¸ªè¯»å–çš„çº¿ç¨‹å¯è§ï¼‰ï¼Œåœ¨Intel 64/IA-32ç¯å¢ƒä¸‹ï¼Œæœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ æ ¹æ®ä¸Šä¸€ç« çš„å†…å®¹ï¼Œæˆ‘ä»¬çŸ¥é“Intel 64/IA-32ä¸‹å†™æ“ä½œä¹‹é—´ä¸ä¼šå‘ç”Ÿé‡æ’åºï¼Œå³åœ¨å¤„ç†å™¨ä¸­ï¼Œæ„å»ºSomeThingå¯¹è±¡ä¸èµ‹å€¼åˆ°objectè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´çš„é¡ºåºæ€§æ˜¯å¯ä»¥ä¿è¯çš„ã€‚è¿™æ ·çœ‹èµ·æ¥ï¼Œä»…ä»…ä½¿ç”¨volatileæ¥é¿å…é‡æ’åºæ˜¯å¤šæ­¤ä¸€ä¸¾çš„ã€‚ä½†æ˜¯ï¼ŒJavaç¼–è¯‘å™¨å´å¯èƒ½ç”Ÿæˆé‡æ’åºåçš„æŒ‡ä»¤ã€‚ä½†ä»¤äººé«˜å…´çš„æ˜¯ï¼ŒOracleçš„JDKä¸­æä¾›äº†Unsafe. putOrderedObjectï¼ŒUnsafe. putOrderedIntï¼ŒUnsafe. putOrderedLongè¿™ä¸‰ä¸ªæ–¹æ³•ï¼ŒJDKä¼šåœ¨æ‰§è¡Œè¿™ä¸‰ä¸ªæ–¹æ³•æ—¶æ’å…¥StoreStoreå†…å­˜å±éšœï¼Œé¿å…å‘ç”Ÿå†™æ“ä½œé‡æ’åºã€‚è€Œåœ¨Intel 64/IA-32æ¶æ„ä¸‹ï¼ŒStoreStoreå±éšœå¹¶ä¸éœ€è¦ï¼ŒJavaç¼–è¯‘å™¨ä¼šå°†StoreStoreå±éšœå»é™¤ã€‚æ¯”èµ·å†™å…¥volatileå˜é‡ä¹‹åæ‰§è¡ŒStoreLoadå±éšœçš„å·¨å¤§å¼€é”€ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ³•é™¤äº†é¿å…é‡æ’åºè€Œå¸¦æ¥çš„æ€§èƒ½æŸå¤±ä»¥å¤–ï¼Œä¸ä¼šå¸¦æ¥å…¶å®ƒçš„æ€§èƒ½å¼€é”€ã€‚ æˆ‘ä»¬å°†åšä¸€ä¸ªå°å®éªŒæ¥æ¯”è¾ƒäºŒè€…çš„æ€§èƒ½å·®å¼‚ã€‚ä¸€ç§æ˜¯ä½¿ç”¨volatileä¿®é¥°objectæˆå‘˜å˜é‡ã€‚ 1234567891011121314151617181920212223242526public class Container &#123; public static class SomeThing &#123; private int status; public SomeThing() &#123; status = 1; &#125; public int getStatus() &#123; return status; &#125; &#125; private volatile SomeThing object; public void create() &#123; object = new SomeThing(); &#125; public SomeThing get() &#123; while (object == null) &#123; Thread.yield(); //ä¸åŠ è¿™å¥è¯å¯èƒ½ä¼šåœ¨æ­¤å‡ºç°æ— é™å¾ªç¯ &#125; return object; &#125;&#125; ä¸€ç§æ˜¯åˆ©ç”¨Unsafe. putOrderedObjectåœ¨é¿å…åœ¨é€‚å½“çš„ä½ç½®å‘ç”Ÿé‡æ’åºã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class Container &#123; public static class SomeThing &#123; private int status; public SomeThing() &#123; status = 1; &#125; public int getStatus() &#123; return status; &#125; &#125; private SomeThing object; private Object value; private static final Unsafe unsafe = getUnsafe(); private static final long valueOffset; static &#123; try &#123; valueOffset = unsafe.objectFieldOffset(Container.class.getDeclaredField(&quot;value&quot;)); &#125; catch (Exception ex) &#123; throw new Error(ex); &#125; &#125; public void create() &#123; SomeThing temp = new SomeThing(); unsafe.putOrderedObject(this, valueOffset, null); //å°†valueèµ‹nullå€¼åªæ˜¯ä¸€é¡¹æ— ç”¨æ“ä½œï¼Œå®é™…åˆ©ç”¨çš„æ˜¯è¿™æ¡è¯­å¥çš„å†…å­˜å±éšœ object = temp; &#125; public SomeThing get() &#123; while (object == null) &#123; Thread.yield(); &#125; return object; &#125; public static Unsafe getUnsafe() &#123; try &#123; Field f = Unsafe.class.getDeclaredField(&quot;theUnsafe&quot;); f.setAccessible(true); return (Unsafe)f.get(null); &#125; catch (Exception e) &#123; &#125; return null; &#125;&#125; ç”±äºç›´æ¥è°ƒç”¨Unsafe.getUnsafe()éœ€è¦é…ç½®JREè·å–è¾ƒé«˜æƒé™ï¼Œæˆ‘ä»¬åˆ©ç”¨åå°„è·å–Unsafeä¸­çš„theUnsafeæ¥å–å¾—Unsafeçš„å¯ç”¨å®ä¾‹ã€‚unsafe.putOrderedObject(this, valueOffset, null)è¿™å¥ä»…ä»…æ˜¯ä¸ºäº†å€Ÿç”¨è¿™å¥è¯åŠŸèƒ½çš„é˜²æ­¢å†™é‡æ’åºï¼Œé™¤æ­¤ä¹‹å¤–æ— å…¶å®ƒä½œç”¨ã€‚ åˆ©ç”¨ä¸‹é¢çš„ä»£ç åˆ†åˆ«æµ‹è¯•ä¸¤ç§æ–¹æ¡ˆçš„å®é™…è¿è¡Œæ—¶é—´ã€‚åœ¨è¿è¡Œæ—¶å¼€å¯-serverå’Œ -XX:CompileThreshold=1ä»¥æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒä¸‹é•¿æ—¶é—´è¿è¡Œåçš„JITä¼˜åŒ–æ•ˆæœã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556public static void main(String[] args) throws InterruptedException &#123; final int THREADS_COUNT = 20; final int LOOP_COUNT = 100000; long sum = 0; long min = Integer.MAX_VALUE; long max = 0; for(int n = 0;n &lt;= 100;n++) &#123; final Container basket = new Container(); List&lt;Thread&gt; putThreads = new ArrayList&lt;Thread&gt;(); List&lt;Thread&gt; takeThreads = new ArrayList&lt;Thread&gt;(); for (int i = 0; i &lt; THREADS_COUNT; i++) &#123; putThreads.add(new Thread() &#123; @Override public void run() &#123; for (int j = 0; j &lt; LOOP_COUNT; j++) &#123; basket.create(); &#125; &#125; &#125;); takeThreads.add(new Thread() &#123; @Override public void run() &#123; for (int j = 0; j &lt; LOOP_COUNT; j++) &#123; basket.get().getStatus(); &#125; &#125; &#125;); &#125; long start = System.nanoTime(); for (int i = 0; i &lt; THREADS_COUNT; i++) &#123; takeThreads.get(i).start(); putThreads.get(i).start(); &#125; for (int i = 0; i &lt; THREADS_COUNT; i++) &#123; takeThreads.get(i).join(); putThreads.get(i).join(); &#125; long end = System.nanoTime(); long period = end - start; if(n == 0) &#123; continue; //ç”±äºJITçš„ç¼–è¯‘ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œéœ€è¦æ›´å¤šæ—¶é—´ï¼Œå°†æ­¤æ—¶é—´ä¸è®¡å…¥ç»Ÿè®¡ &#125; sum += (period); System.out.println(period); if(period &lt; min) &#123; min = period; &#125; if(period &gt; max) &#123; max = period; &#125; &#125; System.out.println(&quot;Average : &quot; + sum / 100); System.out.println(&quot;Max : &quot; + max); System.out.println(&quot;Min : &quot; + min);&#125; åœ¨ç¬”è€…çš„è®¡ç®—æœºä¸Šè¿è¡Œæµ‹è¯•ï¼Œé‡‡ç”¨volatileæ–¹æ¡ˆçš„è¿è¡Œç»“æœå¦‚ä¸‹Average : 62535770Max : 82515000Min : 45161000 é‡‡ç”¨unsafe.putOrderedObjectæ–¹æ¡ˆçš„è¿è¡Œç»“æœå¦‚ä¸‹Average : 50746230Max : 68999000Min : 38038000 ä»ç»“æœçœ‹å‡ºï¼Œunsafe.putOrderedObjectæ–¹æ¡ˆæ¯”volatileæ–¹æ¡ˆå¹³å‡è€—æ—¶å‡å°‘18.9%ï¼Œæœ€å¤§è€—æ—¶å‡å°‘16.4%ï¼Œæœ€å°è€—æ—¶å‡å°‘15.8%.å¦å¤–ï¼Œå³ä½¿åœ¨å…¶å®ƒä¼šå‘ç”Ÿå†™å†™é‡æ’åºçš„å¤„ç†å™¨ä¸­ï¼Œç”±äºStoreStoreå±éšœçš„æ€§èƒ½æŸè€—å°äºStoreLoadå±éšœï¼Œé‡‡ç”¨è¿™ä¸€æ–¹æ³•ä¹Ÿæ˜¯ä¸€ç§å¯è¡Œçš„æ–¹æ¡ˆã€‚ä½†å€¼å¾—å†æ¬¡æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€æ–¹æ¡ˆä¸æ˜¯å¯¹volatileè¯­ä¹‰çš„ç­‰ä»·æ›¿æ¢ï¼Œè€Œæ˜¯åœ¨ç‰¹å®šåœºæ™¯ä¸‹åšçš„ç‰¹æ®Šä¼˜åŒ–ï¼Œå®ƒä»…é¿å…äº†å†™å†™é‡æ’åºï¼Œä½†ä¸ä¿è¯å†…å­˜å¯è§æ€§ã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"HashMapä¸­çš„æ‰©å®¹","slug":"HashMapä¸­çš„æ‰©å®¹","date":"2018-04-21T12:10:50.000Z","updated":"2018-04-25T07:17:39.105Z","comments":true,"path":"2018/04/21/HashMapä¸­çš„æ‰©å®¹/","link":"","permalink":"https://hsb786.github.io/2018/04/21/HashMapä¸­çš„æ‰©å®¹/","excerpt":"ä»¥å‰åªçŸ¥é“HashMapä¼šæ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€ï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæ˜¯ä¸¤å€ã€‚è‡ªä»çœ‹äº†ç¾å›¢æŠ€æœ¯åšå®¢åæ‰ç¨å¾®æ‡‚äº†ä¸€ç‚¹ã€‚äºŒè¿›åˆ¶çœŸæ˜¯çƒ¦äººğŸ˜ğŸ˜ğŸ˜","text":"ä»¥å‰åªçŸ¥é“HashMapä¼šæ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€ï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæ˜¯ä¸¤å€ã€‚è‡ªä»çœ‹äº†ç¾å›¢æŠ€æœ¯åšå®¢åæ‰ç¨å¾®æ‡‚äº†ä¸€ç‚¹ã€‚äºŒè¿›åˆ¶çœŸæ˜¯çƒ¦äººğŸ˜ğŸ˜ğŸ˜æœ¯è¯­ï¼š é«˜ä½è¿ç®—ï¼šä¸å¤ªäº†è§£ï¼Œç½‘ä¸Šä¹Ÿæ‰¾ä¸åˆ°è§£é‡Šã€‚è®©é«˜ä½å‚åŠ è¿ç®—? å–æ¨¡è¿ç®—ï¼šä¾‹å¦‚å¯¹äºæ•´æ•°aï¼Œbæ¥è¯´ï¼Œå–æ¨¡æˆ–è€…æ±‚ä½™ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤æ­¥ æ±‚æ•´æ•°å•†: c=a/b è®¡ç®—æ¨¡æˆ–è€…ä½™æ•°ï¼šr=a-c*b å–æ¨¡è¿ç®—æ˜¯rå‘è´Ÿæ— ç©·æ–¹å‘èˆå¼ƒå°æ•°ä½ æ±‚ä½™è¿ç®—æ—¶rå‘æ­£æ— ç©·æ–¹å‘èˆå¼ƒå°æ•°ä½ é’ˆå¯¹java8 æ ¹æ®keyè·å–å“ˆå¸Œæ¡¶æ•°ç»„ç´¢å¼•ä½ç½®12345678910111213141516171819public V put(K key, V value) &#123; return putVal(hash(key), key, value, false, true);&#125;static final int hash(Object key) &#123; int h; //1. h=key.hashCode() å–hashCodeå€¼ //2. h^(H&gt;&gt;&gt;16) é«˜ä½å‚ä¸è¿ç®— return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);&#125;final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; // 3. (n-1)&amp;hash å–æ¨¡è¿ç®— if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); è¿™é‡Œçš„Hashç®—æ³•æœ¬è´¨ä¸Šå°±æ˜¯ä¸‰æ­¥ï¼šå–keyçš„hashCodeå€¼ã€é«˜ä½è¿ç®—ã€å–æ¨¡è¿ç®— å¯¹äºä»»æ„ç»™å®šçš„å¯¹è±¡ï¼Œåªè¦å®ƒçš„hashCode()è¿”å›å€¼ç›¸åŒï¼Œé‚£ä¹ˆç¨‹åºè°ƒç”¨æ–¹æ³•ä¸€æ‰€è®¡ç®—å¾—åˆ°çš„Hashç å€¼æ€»æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯æŠŠhashå€¼å¯¹æ•°ç»„é•¿åº¦å–æ¨¡è¿ç®—ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå…ƒç´ çš„åˆ†å¸ƒç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒå‡åŒ€çš„ã€‚ä½†æ˜¯ï¼Œæ¨¡è¿ç®—çš„æ¶ˆè€—è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œåœ¨HashMapä¸­æ˜¯è¿™æ ·åšçš„ï¼šè°ƒç”¨å–æ¨¡è¿ç®—æ¥è®¡ç®—è¯¥å¯¹è±¡åº”è¯¥ä¿å­˜åœ¨tableæ•°ç»„çš„å“ªä¸ªç´¢å¼•å¤„ã€‚ é€šè¿‡(table.length -1)&amp;hæ¥å¾—åˆ°è¯¥å¯¹è±¡çš„ä¿å­˜ä½ï¼Œè€ŒHashMapåº•å±‚æ•°ç»„çš„é•¿åº¦æ€»æ˜¯2çš„næ¬¡æ–¹ï¼Œè¿™æ˜¯HashMapåœ¨é€Ÿåº¦ä¸Šçš„ä¼˜åŒ–ã€‚å½“lengthæ€»æ˜¯2çš„næ¬¡æ–¹æ—¶ï¼Œ(length-1)&amp; hè¿ç®—ç­‰ä»·äºå¯¹lengthå–æ¨¡ï¼Œä¹Ÿå°±æ˜¯h%lengthï¼Œä½†æ˜¯&amp;æ¯”%å…·æœ‰æ›´é«˜çš„æ•ˆç‡ã€‚ åœ¨JDK1.8çš„å®ç°ä¸­ï¼Œä¼˜åŒ–äº†é«˜ä½è¿ç®—çš„ç®—æ³•ï¼Œé€šè¿‡hashCode()çš„é«˜16ä½å¼‚æˆ–ä½16ä½å®ç°çš„ï¼š(h = k.hashCode()) ^ (h &gt;&gt;&gt; 16)ï¼Œä¸»è¦æ˜¯ä»é€Ÿåº¦ã€åŠŸæ•ˆã€è´¨é‡æ¥è€ƒè™‘çš„ï¼Œè¿™ä¹ˆåšå¯ä»¥åœ¨æ•°ç»„tableçš„lengthæ¯”è¾ƒå°çš„æ—¶å€™ï¼Œä¹Ÿèƒ½ä¿è¯è€ƒè™‘åˆ°é«˜ä½Bitéƒ½å‚ä¸åˆ°Hashçš„è®¡ç®—ä¸­ï¼ŒåŒæ—¶ä¸ä¼šæœ‰å¤ªå¤§çš„å¼€é”€ã€‚è¡¥å……ä¸€ä¸‹ï¼šä¸ºä»€ä¹ˆæ±‚å¾—çš„hashå€¼æ˜¯32ä½çš„ï¼Ÿè¿™æ˜¯å› ä¸ºintç±»å‹4å­—èŠ‚ï¼Œ4X8=32 æ‰©å®¹æœºåˆ¶æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯2æ¬¡å¹‚çš„æ‰©å±•(æŒ‡é•¿åº¦æ‰©ä¸ºåŸæ¥2å€)ï¼Œæ‰€ä»¥ï¼Œå…ƒç´ çš„ä½ç½®è¦ä¹ˆæ˜¯åœ¨åŸä½ç½®ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚çš„ä½ç½®ã€‚çœ‹ä¸‹å›¾å¯ä»¥æ˜ç™½è¿™å¥è¯çš„æ„æ€ï¼Œnä¸ºtableçš„é•¿åº¦ï¼Œå›¾ï¼ˆaï¼‰è¡¨ç¤ºæ‰©å®¹å‰çš„key1å’Œkey2ä¸¤ç§keyç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå›¾ï¼ˆbï¼‰è¡¨ç¤ºæ‰©å®¹åkey1å’Œkey2ä¸¤ç§keyç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå…¶ä¸­hash1æ˜¯key1å¯¹åº”çš„å“ˆå¸Œä¸é«˜ä½è¿ç®—ç»“æœã€‚ å…ƒç´ åœ¨é‡æ–°è®¡ç®—hashä¹‹åï¼Œå› ä¸ºnå˜ä¸º2å€ï¼Œé‚£ä¹ˆn-1çš„maskèŒƒå›´åœ¨é«˜ä½å¤š1bit(çº¢è‰²)ï¼Œå› æ­¤æ–°çš„indexå°±ä¼šå‘ç”Ÿè¿™æ ·çš„å˜åŒ–ï¼š å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ‰©å……HashMapçš„æ—¶å€™ï¼Œä¸éœ€è¦åƒJDK1.7çš„å®ç°é‚£æ ·é‡æ–°è®¡ç®—hashï¼Œåªéœ€è¦çœ‹çœ‹åŸæ¥çš„hashå€¼æ–°å¢çš„é‚£ä¸ªbitæ˜¯1è¿˜æ˜¯0å°±å¥½äº†ï¼Œæ˜¯0çš„è¯ç´¢å¼•æ²¡å˜ï¼Œæ˜¯1çš„è¯ç´¢å¼•å˜æˆâ€œåŸç´¢å¼•+oldCapâ€ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹å›¾ä¸º16æ‰©å……ä¸º32çš„resizeç¤ºæ„å›¾ï¼š è¿™ä¸ªè®¾è®¡ç¡®å®éå¸¸çš„å·§å¦™ï¼Œæ—¢çœå»äº†é‡æ–°è®¡ç®—hashå€¼çš„æ—¶é—´ï¼Œè€Œä¸”åŒæ—¶ï¼Œç”±äºæ–°å¢çš„1bitæ˜¯0è¿˜æ˜¯1å¯ä»¥è®¤ä¸ºæ˜¯éšæœºçš„ï¼Œå› æ­¤resizeçš„è¿‡ç¨‹ï¼Œå‡åŒ€çš„æŠŠä¹‹å‰çš„å†²çªçš„èŠ‚ç‚¹åˆ†æ•£åˆ°æ–°çš„bucketäº†ã€‚è¿™ä¸€å—å°±æ˜¯JDK1.8æ–°å¢çš„ä¼˜åŒ–ç‚¹ã€‚ final Node&lt;K,V&gt;[] resize()123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081final Node&lt;K,V&gt;[] resize() &#123; Node&lt;K,V&gt;[] oldTab = table; int oldCap = (oldTab == null) ? 0 : oldTab.length; int oldThr = threshold; int newCap, newThr = 0; if (oldCap &gt; 0) &#123; // è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§ if (oldCap &gt;= MAXIMUM_CAPACITY) &#123; threshold = Integer.MAX_VALUE; return oldTab; &#125; //// æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) newThr = oldThr &lt;&lt; 1; // double threshold &#125; else if (oldThr &gt; 0) // initial capacity was placed in threshold newCap = oldThr; else &#123; // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); &#125; // è®¡ç®—æ–°çš„resizeä¸Šé™ if (newThr == 0) &#123; float ft = (float)newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); &#125; threshold = newThr; @SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;) Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; table = newTab; if (oldTab != null) &#123; // æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­ for (int j = 0; j &lt; oldCap; ++j) &#123; Node&lt;K,V&gt; e; if ((e = oldTab[j]) != null) &#123; oldTab[j] = null; if (e.next == null) newTab[e.hash &amp; (newCap - 1)] = e; else if (e instanceof TreeNode) ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); else &#123; // é“¾è¡¨ä¼˜åŒ–é‡hashçš„ä»£ç å— Node&lt;K,V&gt; loHead = null, loTail = null; Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; do &#123; next = e.next; // åŸç´¢å¼• if ((e.hash &amp; oldCap) == 0) &#123; if (loTail == null) loHead = e; else loTail.next = e; loTail = e; &#125; // åŸç´¢å¼•+oldCap else &#123; if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; &#125; &#125; while ((e = next) != null); // åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ if (loTail != null) &#123; loTail.next = null; newTab[j] = loHead; &#125; // åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ if (hiTail != null) &#123; hiTail.next = null; newTab[j + oldCap] = hiHead; &#125; &#125; &#125; &#125; &#125; return newTab;&#125; æœ‰ä¸€ç‚¹æä¸æ‡‚ï¼Œif ((e.hash &amp; oldCap) == 0) {è¿™é‡Œä¸ºä»€ä¹ˆè¿™ä¹ˆåˆ¤æ–­å°±èƒ½ç¡®å®šæ–°å¢çš„1bitå°±æ˜¯0å‘¢ğŸ˜±ğŸ˜±ğŸ˜±ã€‚è¢«äºŒè¿›åˆ¶æçš„å¤´æ˜è„‘èƒ€ğŸ˜–ğŸ˜ğŸ˜Ÿã€‚ç°åœ¨å¥½åƒæ˜ç™½äº†ï¼ŒoldCap=01 0000ï¼Œkey1= 00 0101 , key2= 01 0101 key1&amp;oldCap=0ï¼Œæ–°å¢çš„1bitä¸º0ã€‚åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚ æ€»ç»“ (n - 1) &amp; hashï¼Œå½“næ˜¯2æ¬¡å¹‚çš„æ—¶å€™ï¼Œhash%nç­‰äº(n-1)&amp;hashï¼Œ&amp;æ¯”%å…·æœ‰æ›´é«˜çš„æ•ˆç‡ ç”±äºé•¿åº¦æ˜¯2æ¬¡å¹‚çš„æ‰©å±•ï¼Œæ‰€ä»¥ï¼Œå…ƒç´ çš„ä½ç½®è¦ä¹ˆæ˜¯åœ¨åŸä½ç½®ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚çš„ä½ç½®ã€‚ å‚è€ƒ Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"é›†åˆ","slug":"çˆªå“‡/é›†åˆ","permalink":"https://hsb786.github.io/categories/çˆªå“‡/é›†åˆ/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Metaspace","slug":"Metaspace","date":"2018-04-21T04:21:05.000Z","updated":"2018-04-21T07:35:08.004Z","comments":true,"path":"2018/04/21/Metaspace/","link":"","permalink":"https://hsb786.github.io/2018/04/21/Metaspace/","excerpt":"ç°åœ¨java 10 éƒ½å‡ºæ¥äº†ï¼Œå†çœ‹çœ‹è‡ªå·±ï¼Œè¿java 8 éƒ½æ²¡æå®šã€‚Stay Hungry, Stay Foolish Java 8 å½»åº•å°†æ°¸ä¹…ä»£(PermGen)ä»HotSpot JVMç§»é™¤ã€‚æ–¹æ³•åŒºç§»è‡³Metaspaceï¼Œå­—ç¬¦ä¸²å¸¸é‡ç§»è‡³Java Heap In JDK 8, classes metadata is now stored in the native heap and this space is called Metaspace.JDK 8 å¼€å§‹æŠŠç±»çš„å…ƒæ•°æ®å­˜æ”¾åˆ°æœ¬åœ°å †å†…å­˜ï¼ˆnative heapï¼‰ä¸­ï¼Œè¿™ä¸€å—åŒºåŸŸå°±å«Metaspaceã€‚","text":"ç°åœ¨java 10 éƒ½å‡ºæ¥äº†ï¼Œå†çœ‹çœ‹è‡ªå·±ï¼Œè¿java 8 éƒ½æ²¡æå®šã€‚Stay Hungry, Stay Foolish Java 8 å½»åº•å°†æ°¸ä¹…ä»£(PermGen)ä»HotSpot JVMç§»é™¤ã€‚æ–¹æ³•åŒºç§»è‡³Metaspaceï¼Œå­—ç¬¦ä¸²å¸¸é‡ç§»è‡³Java Heap In JDK 8, classes metadata is now stored in the native heap and this space is called Metaspace.JDK 8 å¼€å§‹æŠŠç±»çš„å…ƒæ•°æ®å­˜æ”¾åˆ°æœ¬åœ°å †å†…å­˜ï¼ˆnative heapï¼‰ä¸­ï¼Œè¿™ä¸€å—åŒºåŸŸå°±å«Metaspaceã€‚ ç›®çš„ å­—ç¬¦ä¸²å­˜åœ¨æ°¸ä¹…ä»£ä¸­ï¼Œå®¹æ˜“å‡ºç°æ€§èƒ½é—®é¢˜å’Œå†…å­˜æº¢å‡ºã€‚ ç±»åŠæ–¹æ³•çš„ä¿¡æ¯ç­‰æ¯”è¾ƒéš¾ç¡®å®šå…¶å¤§å°ï¼Œå› æ­¤å¯¹äºæ°¸ä¹…ä»£çš„å¤§å°æŒ‡å®šæ¯”è¾ƒå›°éš¾ï¼Œå¤ªå°å®¹æ˜“å‡ºç°æ°¸ä¹…ä»£æº¢å‡ºï¼Œå¤ªå¤§åˆ™å®¹æ˜“å¯¼è‡´è€å¹´ä»£æº¢å‡ºã€‚ æ°¸ä¹…ä»£ä¼šä¸º GC å¸¦æ¥ä¸å¿…è¦çš„å¤æ‚åº¦ï¼Œå¹¶ä¸”å›æ”¶æ•ˆç‡åä½ã€‚ Oracle å¯èƒ½ä¼šå°†HotSpot ä¸ JRockit åˆäºŒä¸ºä¸€ã€‚ ä¼˜ç‚¹é¿å…äº†OutOfMemoryErrorçš„é—®é¢˜ã€‚ç±»çš„å…ƒæ•°æ®åˆ†é…åªå—æœ¬åœ°å†…å­˜å¤§å°çš„é™åˆ¶ã€‚ GCå¦‚æœMetaspaceçš„ç©ºé—´å ç”¨è¾¾åˆ°äº†è®¾å®šçš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘GCæ¥æ”¶é›†æ­»äº¡å¯¹è±¡å’Œç±»çš„åŠ è½½å™¨ã€‚æ ¹æ®JDK 8çš„ç‰¹æ€§ï¼ŒG1å’ŒCMSéƒ½ä¼šå¾ˆå¥½åœ°æ”¶é›†MetaspaceåŒºï¼ˆä¸€èˆ¬éƒ½ä¼´éšç€Full GCï¼‰ã€‚ JVMå‚æ•° -XX:MetaspaceSize æ˜¯åˆ†é…ç»™ç±»å…ƒæ•°æ®ç©ºé—´ï¼ˆä»¥å­—èŠ‚è®¡ï¼‰çš„åˆå§‹å¤§å°(Oracleé€»è¾‘å­˜å‚¨ä¸Šçš„åˆå§‹é«˜æ°´ä½ï¼Œthe initial high-water-mark )ï¼Œæ­¤å€¼ä¸ºä¼°è®¡å€¼ã€‚MetaspaceSizeçš„å€¼è®¾ç½®çš„è¿‡å¤§ä¼šå»¶é•¿åƒåœ¾å›æ”¶æ—¶é—´ã€‚åƒåœ¾å›æ”¶è¿‡åï¼Œå¼•èµ·ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶çš„ç±»å…ƒæ•°æ®ç©ºé—´çš„å¤§å°å¯èƒ½ä¼šå˜å¤§ã€‚ -XX:MaxMetaspaceSize æ˜¯åˆ†é…ç»™ç±»å…ƒæ•°æ®ç©ºé—´çš„æœ€å¤§å€¼ï¼Œè¶…è¿‡æ­¤å€¼å°±ä¼šè§¦å‘Full GCï¼Œæ­¤å€¼é»˜è®¤æ²¡æœ‰é™åˆ¶ï¼Œä½†åº”å–å†³äºç³»ç»Ÿå†…å­˜çš„å¤§å°ã€‚JVMä¼šåŠ¨æ€åœ°æ”¹å˜æ­¤å€¼ã€‚ -XX:MinMetaspaceFreeRatio è¡¨ç¤ºä¸€æ¬¡GCä»¥åï¼Œä¸ºäº†é¿å…å¢åŠ å…ƒæ•°æ®ç©ºé—´çš„å¤§å°ï¼Œç©ºé—²çš„ç±»å…ƒæ•°æ®çš„å®¹é‡çš„æœ€å°æ¯”ä¾‹ï¼Œä¸å¤Ÿå°±ä¼šå¯¼è‡´åƒåœ¾å›æ”¶ã€‚ -XX:MaxMetaspaceFreeRatio è¡¨ç¤ºä¸€æ¬¡GCä»¥åï¼Œä¸ºäº†é¿å…å¢åŠ å…ƒæ•°æ®ç©ºé—´çš„å¤§å°ï¼Œç©ºé—²çš„ç±»å…ƒæ•°æ®çš„å®¹é‡çš„æœ€å¤§æ¯”ä¾‹ï¼Œä¸å¤Ÿå°±ä¼šå¯¼è‡´åƒåœ¾å›æ”¶ã€‚ å‚è€ƒ æ·±å…¥æ¢ç©¶JVM | æ¢ç§˜ Metaspace Java8å†…å­˜æ¨¡å‹â€”æ°¸ä¹…ä»£(PermGen)å’Œå…ƒç©ºé—´(Metaspace) JDK 8 Memory Layout and garbage collection","categories":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/categories/JVM/"}],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/tags/JVM/"}]},{"title":"jvm-GC","slug":"jvm-GC","date":"2018-04-21T03:10:31.000Z","updated":"2018-04-24T06:06:39.142Z","comments":true,"path":"2018/04/21/jvm-GC/","link":"","permalink":"https://hsb786.github.io/2018/04/21/jvm-GC/","excerpt":"å…³é”®å­—çº¦å®š Young generation â€“&gt;æ–°ç”Ÿä»£ Tenured / Old Generation â€“&gt;è€å¹´ä»£ Perm Area â€“&gt;æ°¸ä¹…ä»£","text":"å…³é”®å­—çº¦å®š Young generation â€“&gt;æ–°ç”Ÿä»£ Tenured / Old Generation â€“&gt;è€å¹´ä»£ Perm Area â€“&gt;æ°¸ä¹…ä»£ æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰æ–°ç”Ÿä»£æ˜¯æ‰€æœ‰æ–°å¯¹è±¡äº§ç”Ÿçš„åœ°æ–¹ã€‚å½“æ–°ç”Ÿä»£å†…å­˜ç©ºé—´è¢«ç”¨å®Œæ—¶ï¼Œå°±ä¼šè§¦å‘åƒåœ¾å›æ”¶ã€‚è¿™ä¸ªåƒåœ¾å›æ”¶å«åšMinor GCã€‚æ–°ç”Ÿä»£åˆ†ä¸ºEndenã€Survivor1ã€Survivor2ã€‚ å¤§å¤šæ•°æ–°å»ºçš„å¯¹è±¡éƒ½ä½äºEdenåŒºã€‚ å½“EdenåŒºè¢«å¯¹è±¡å¡«æ»¡æ—¶ï¼Œå°±ä¼šæ‰§è¡ŒMinor GCã€‚å¹¶æŠŠæ‰€æœ‰å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡è½¬ç§»åˆ°å…¶ä¸­ä¸€ä¸ªsurvivoråŒºã€‚ Minor GCåŒæ ·ä¼šæ£€æŸ¥å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ï¼Œå¦‚æœéœ€è¦ä¼šæŠŠå®ƒä»¬è½¬ç§»åˆ°å¦ä¸€ä¸ªsurvivoråŒºã€‚è¿™æ ·åœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œæ€»ä¼šæœ‰ä¸€ä¸ªç©ºçš„survivoråŒºã€‚ ç»è¿‡å¤šæ¬¡GCå‘¨æœŸåï¼Œä»ç„¶å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ä¼šè¢«è½¬ç§»åˆ°è€å¹´ä»£å†…å­˜ç©ºé—´ã€‚é€šå¸¸è¿™æ˜¯åœ¨æ–°ç”Ÿä»£æœ‰èµ„æ ¼æå‡åˆ°è€å¹´ä»£å‰é€šè¿‡è®¾å®šå¹´é¾„é˜ˆå€¼(é»˜è®¤15)æ¥å®Œæˆçš„ã€‚ è€å¹´ä»£ï¼ˆOld Generationï¼‰ä¸€äº›å¤§å¯¹è±¡(é•¿å­—ç¬¦ä¸²æˆ–æ•°ç»„)å¯èƒ½ä¼šç›´æ¥å­˜æ”¾åˆ°è€å¹´ä»£ã€‚è€å¹´ä»£å†…å­˜é‡ŒåŒ…å«äº†é•¿æœŸå­˜æ´»çš„å¯¹è±¡å’Œç»è¿‡å¤šæ¬¡Minor GCåä¾ç„¶å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ã€‚é€šå¸¸ä¼šåœ¨è€å¹´ä»£å†…å­˜è¢«å æ»¡æ—¶è¿›è¡Œåƒåœ¾å›æ”¶ã€‚è€å¹´ä»£çš„åƒåœ¾æ”¶é›†å«åšMajor GCã€‚ Major GCä¼šèŠ±è´¹æ›´å¤šçš„æ—¶é—´ã€‚ æ°¸ä¹…ä»£ï¼ˆPerm Areaï¼‰æ°¸ä¹…ä»£æˆ–è€…â€œPerm Genâ€åŒ…å«äº†JVMéœ€è¦çš„åº”ç”¨å…ƒæ•°æ®ï¼Œè¿™äº›å…ƒæ•°æ®æè¿°äº†åœ¨åº”ç”¨é‡Œä½¿ç”¨çš„ç±»å’Œæ–¹æ³•ã€‚æ³¨æ„ï¼Œæ°¸ä¹…ä»£ä¸æ˜¯Javaå †å†…å­˜çš„ä¸€éƒ¨åˆ†ã€‚ java8ä¸­ç§»é™¤äº†æ°¸ä¹…ä»£ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯Metaspace(å…ƒç©ºé—´) é‡è¦çš„ä¸œä¸œ åœ¨Javaä¸­ï¼Œå¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸€äº›ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ç­‰å­˜å‚¨åœ¨æ–¹æ³•åŒºã€‚å †å’Œæ–¹æ³•åŒºéƒ½æ˜¯çº¿ç¨‹å…±äº«çš„ã€‚ GCæœºåˆ¶æ˜¯ç”±JVMæä¾›ï¼Œç”¨æ¥æ¸…ç†éœ€è¦æ¸…é™¤çš„å¯¹è±¡ï¼Œå›æ”¶å †å†…å­˜ã€‚ GCæœºåˆ¶å°†Javaç¨‹åºå‘˜ä»å†…å­˜ç®¡ç†ä¸­è§£æ”¾äº†å‡ºæ¥ï¼Œå¯ä»¥æ›´å…³æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚ åœ¨Javaä¸­ï¼ŒGCæ˜¯ç”±ä¸€ä¸ªè¢«ç§°ä¸ºåƒåœ¾å›æ”¶å™¨çš„å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œçš„ã€‚ åœ¨ä»å†…å­˜å›æ”¶ä¸€ä¸ªå¯¹è±¡ä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„finalize()æ–¹æ³•ã€‚ ä½œä¸ºä¸€ä¸ªJavaå¼€å‘è€…ä¸èƒ½å¼ºåˆ¶JVMæ‰§è¡ŒGCï¼›GCçš„è§¦å‘ç”±JVMä¾æ®å †å†…å­˜çš„å¤§å°æ¥å†³å®šã€‚ System.gc()å’ŒRuntime.gc()ä¼šå‘JVMå‘é€æ‰§è¡ŒGCçš„è¯·æ±‚ï¼Œä½†æ˜¯JVMä¸ä¿è¯ä¸€å®šä¼šæ‰§è¡ŒGCã€‚ å¦‚æœå †æ²¡æœ‰å†…å­˜åˆ›å»ºæ–°çš„å¯¹è±¡äº†ï¼Œä¼šæŠ›å‡ºOutOfMemoryErrorã€‚ GCé’ˆå¯¹ä»€ä¹ˆå¯¹è±¡ï¼Ÿäº†è§£GCæœºåˆ¶çš„ç¬¬ä¸€æ­¥å°±æ˜¯ç†è§£ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«å›æ”¶ã€‚å½“ä¸€ä¸ªå¯¹è±¡é€šè¿‡ä¸€ç³»åˆ—æ ¹å¯¹è±¡(æ¯”å¦‚ï¼šé™æ€å±æ€§å¼•ç”¨çš„å¸¸é‡)éƒ½ä¸å¯è¾¾æ—¶å°±ä¼šè¢«å›æ”¶ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½ä¸ºnullã€‚å¾ªç¯ä¾èµ–ä¸ç®—åšå¼•ç”¨ï¼Œå¦‚æœå¯¹è±¡Aæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Bçš„å¼•ç”¨ï¼Œå¯¹è±¡Bä¹Ÿæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Açš„å¼•ç”¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä»¬æ²¡æœ‰å…¶ä»–å¼•ç”¨ï¼Œé‚£ä¹ˆå¯¹è±¡Aå’Œå¯¹è±¡Béƒ½ã€éœ€è¦è¢«å›æ”¶(å¦‚ä¸‹å›¾,ObjAå’ŒObjBéœ€è¦è¢«å›æ”¶)ã€‚ å¼•ç”¨è®°æ•°æ³• æ€æƒ³ï¼šç»™å¯¹è±¡è®¾ç½®å¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å¼•ç”¨è¯¥å¯¹è±¡ä¸€æ¬¡ï¼Œè®¡æ•°å™¨å°±+1ï¼Œå¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å°±-1ï¼Œå½“ä»»æ„æ—¶å€™å¼•ç”¨è®¡æ•°å™¨çš„å€¼éƒ½ä¸º0æ—¶ï¼Œåˆ™è¯¥å¯¹è±¡å¯è¢«å›æ”¶ Javaä¸é€‚ç”¨åŸå› ï¼šæ— æ³•è§£å†³å¯¹è±¡äº’ç›¸å¾ªç¯å¼•ç”¨çš„é—®é¢˜ GC Rootå¯è¾¾æ€§åˆ†ææ³•, å½“ä¸€ä¸ªå¯¹è±¡é€šè¿‡ä¸€ç³»åˆ—æ ¹å¯¹è±¡(Root)éƒ½ä¸å¯è¾¾æ—¶å°±ä¼šè¢«å›æ”¶ã€‚ å¯ä½œä¸ºGC Rootçš„å¯¹è±¡æœ‰: è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆNativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ åœ¨å¯è¾¾æ€§åˆ†æè¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡å¼•ç”¨ç±»å‹ä¼šå¯¹å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸäº§ç”Ÿå½±å“ï¼ŒJAVAä¸­æœ‰è¿™å‡ ç§ç±»å‹çš„å¼•ç”¨ï¼š å¼ºå¼•ç”¨ï¼šåªè¦è¯¥å¼•ç”¨è¿˜æœ‰æ•ˆï¼ŒGCå°±ä¸ä¼šå›æ”¶ è½¯å¼•ç”¨ï¼šå†…å­˜ç©ºé—´è¶³å¤Ÿæ—¶ä¸è¿›è¡Œå›æ”¶ï¼Œåœ¨å†…å­˜æº¢å‡ºå‘ç”Ÿå‰è¿›è¡Œå›æ”¶ã€ç”¨SoftReferenceç±»å®ç° å¼±å¼•ç”¨ï¼šå¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åªèƒ½å­˜æ´»åˆ°ä¸‹ä¸€æ¬¡Gcæ”¶é›†ã€ç”¨WeakReferenceç±»å®ç° è™šå¼•ç”¨ï¼šæ— æ³•é€šè¿‡è™šå¼•ç”¨è·å¾—å¯¹è±¡å®ä¾‹ï¼Œä¹Ÿä¸ä¼šå¯¹å¯¹è±¡çš„ç”Ÿå­˜æ—¶é—´äº§ç”Ÿå½±å“ã€å”¯ä¸€ç›®çš„ï¼šå½“è¯¥å¯¹è±¡è¢«Gcæ”¶é›†æ—¶ï¼Œæ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚ç”¨PhantomReferenceç±»å®ç° ä¸€ä¸ªå¯¹è±¡çœŸæ­£ä¸å¯ç”¨ï¼Œè¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼š é¦–å…ˆè¿›è¡Œå¯è¾¾æ€§åˆ†æï¼Œç­›é€‰å‡ºä¸GC Rootæ²¡ç”¨å¼•ç”¨é“¾çš„å¯¹è±¡ï¼Œè¿›è¡Œç¬¬ä¸€æ¬¡æ ‡è®° ç¬¬ä¸€æ¬¡æ ‡è®°åï¼Œå†è¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œç­›é€‰æ¡ä»¶æ˜¯æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ã€‚è‹¥å¯¹è±¡æœ‰æ²¡æœ‰é‡å†™finalize()æ–¹æ³•ï¼Œæˆ–è€…finalize()æ˜¯å¦å·²è¢«jvmè°ƒç”¨è¿‡ï¼Œåˆ™æ²¡å¿…è¦æ‰§è¡Œï¼ŒGCä¼šå›æ”¶è¯¥å¯¹è±¡ è‹¥æœ‰å¿…è¦æ‰§è¡Œï¼Œåˆ™è¯¥å¯¹è±¡ä¼šè¢«æ”¾å…¥F-Queueä¸­ï¼Œç”±jvmå¼€å¯ä¸€ä¸ªä½ä¼˜å…ˆçº§çš„çº¿ç¨‹å»æ‰§è¡Œå®ƒï¼ˆä½†ä¸ä¸€å®šç­‰å¾…finalizeæ‰§è¡Œå®Œæ¯•ï¼‰ã€‚ finalize()æ˜¯å¯¹è±¡æœ€åä¸€æ¬¡è‡ªæ•‘çš„æœºä¼šï¼Œè‹¥å¯¹è±¡åœ¨finalize()ä¸­é‡æ–°åŠ å…¥åˆ°å¼•ç”¨é“¾ä¸­ï¼Œåˆ™å®ƒä¼šè¢«ç§»å‡ºè¦å›æ”¶çš„å¯¹è±¡çš„é›†åˆã€‚å…¶ä»–å¯¹è±¡åˆ™ä¼šè¢«ç¬¬äºŒæ¬¡æ ‡è®°ï¼Œè¿›è¡Œå›æ”¶ GCç®—æ³• æ ‡è®°æ¸…é™¤ç®—æ³• åˆ†ä¸ºæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚è¯¥ç®—æ³•çš„ç¼ºç‚¹æ˜¯æ•ˆç‡ä¸é«˜å¹¶ä¸”ä¼šäº§ç”Ÿä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚ å¤åˆ¶ç®—æ³• æŠŠå†…å­˜ç©ºé—´åˆ’ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåŒºåŸŸã€‚åƒåœ¾å›æ”¶æ—¶ï¼Œéå†å½“å‰ä½¿ç”¨åŒºåŸŸï¼ŒæŠŠæ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªåŒºåŸŸä¸­ã€‚æ­¤ç®—æ³•æ¯æ¬¡åªå¤„ç†æ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡ï¼Œå› æ­¤å¤åˆ¶æˆæœ¬æ¯”è¾ƒå°ï¼ŒåŒæ—¶å¤åˆ¶è¿‡å»ä»¥åè¿˜èƒ½è¿›è¡Œç›¸åº”çš„å†…å­˜æ•´ç†ï¼Œä¸ä¼šå‡ºç°â€œç¢ç‰‡â€é—®é¢˜ã€‚ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚ç¼ºç‚¹ï¼šä¼šæµªè´¹ä¸€å®šçš„å†…å­˜ã€‚ä¸€èˆ¬æ–°ç”Ÿä»£é‡‡ç”¨è¿™ç§ç®—æ³•ã€‚ æ ‡è®°æ•´ç†ç®—æ³• æ ‡è®°é˜¶æ®µä¸æ ‡è®°æ¸…é™¤ç®—æ³•ä¸€æ ·ã€‚ä½†åç»­å¹¶ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶çš„å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åæ¸…ç†ã€‚ä¼˜ç‚¹æ˜¯ä¸ä¼šé€ æˆå†…å­˜ç¢ç‰‡ã€‚ åˆ†ä»£æ”¶é›†ç®—æ³• æŠŠå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ æ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶ç®—æ³• å°†æ–°ç”Ÿä»£å†…å­˜åˆ†ä¸ºä¸€å—å¤§çš„EdenåŒºå’Œä¸¤å—å°çš„Survivorï¼›æ¯æ¬¡ä½¿ç”¨Edenå’Œä¸€ä¸ªSurvivorï¼Œå›æ”¶æ—¶å°†Edenå’ŒSurvivorå­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªSurvivorï¼ˆHotSpotçš„æ¯”ä¾‹Edenï¼šSurvivor = 8ï¼š1ï¼‰ è€å¹´ä»£ä½¿ç”¨æ ‡è®°-æ¸…ç†æˆ–è€…æ ‡è®°-æ•´ç† å†…å­˜åˆ†é…è§„åˆ™ å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é… å½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ—¶å°±ä¼šå‘èµ·ä¸€æ¬¡Minor GC å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ å…¸å‹çš„å¤§å¯¹è±¡æ˜¯å¾ˆé•¿çš„å­—ç¬¦ä¸²å’Œæ•°ç»„ é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ æ¯ä¸ªå¯¹è±¡æœ‰å¹´é¾„è®¡æ•°å™¨ï¼Œæ¯ç»è¿‡ä¸€æ¬¡GCï¼Œè®¡æ•°å™¨å€¼åŠ ä¸€ï¼Œå½“åˆ°è¾¾ä¸€å®šç¨‹åº¦æ—¶ï¼ˆé»˜è®¤15ï¼‰ï¼Œå°±ä¼šè¿›å…¥è€å¹´ä»£ å¹´é¾„çš„é˜ˆå€¼å¯é€šè¿‡å‚æ•° -XX:MaxTenuringThresholdè®¾ç½® å¯¹è±¡å¹´é¾„çš„åˆ¤å®š Survivorç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äºSurvivorç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— é¡»ç­‰åˆ°MaxTenuringThresholdè¦æ±‚çš„å¹´é¾„ ç©ºé—´åˆ†é…æ‹…ä¿ å‘ç”ŸMinor GCå‰ï¼Œjvmä¼šæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œè‹¥å¤§äºï¼Œåˆ™Minor GCæ˜¯å®‰å…¨çš„ è‹¥ä¸å¤§äºï¼Œjvmä¼šæŸ¥çœ‹HandlePromotionFailureæ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ï¼Œè‹¥ä¸å…è®¸ï¼Œåˆ™æ”¹ä¸ºä¸€æ¬¡Full GC è‹¥å…è®¸æ‹…ä¿å¤±è´¥ï¼Œåˆ™æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œè‹¥å¤§äºï¼Œåˆ™å°è¯•è¿›è¡ŒMinor GCï¼›è‹¥å°äºï¼Œåˆ™è¦æ”¹ä¸ºFull GC Javaä¸­åƒåœ¾å›æ”¶å™¨çš„ç±»å‹Javaæä¾›å¤šç§ç±»å‹çš„åƒåœ¾å›æ”¶å™¨ã€‚JVMä¸­çš„åƒåœ¾æ”¶é›†ä¸€èˆ¬éƒ½é‡‡ç”¨â€œåˆ†ä»£æ”¶é›†â€ï¼Œä¸åŒçš„å †å†…å­˜åŒºåŸŸé‡‡ç”¨ä¸åŒçš„æ”¶é›†ç®—æ³•ï¼Œä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å¢åŠ ååé‡æˆ–é™ä½åœé¡¿æ—¶é—´ã€‚ Serialæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œä¸²è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ ParNewæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼ŒSerialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆï¼Œç”¨å¤šä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œå¹¶è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ä½¿ç”¨-XX:+UseParNewGCå¼€å…³æ¥æ§åˆ¶ä½¿ç”¨ParNew+Serial Oldæ”¶é›†å™¨ç»„åˆæ”¶é›†å†…å­˜ï¼›ä½¿ç”¨-XX:ParallelGCThreadsæ¥è®¾ç½®æ‰§è¡Œå†…å­˜å›æ”¶çš„çº¿ç¨‹æ•°ã€‚ Parallel Scavenge æ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨æ–°ç”Ÿä»£ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œå…³æ³¨CPUååé‡ï¼Œå³è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´/æ€»æ—¶é—´ã€‚ä½¿ç”¨-XX:+UseParallelGCå¼€å…³æ§åˆ¶ä½¿ç”¨Parallel Scavenge+Serial Oldæ”¶é›†å™¨ç»„åˆå›æ”¶åƒåœ¾ã€‚ Serial Oldæ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä¸²è¡Œï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œä½¿ç”¨å•çº¿ç¨‹è¿›è¡ŒGCï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ Parallel Oldæ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨è€å¹´ä»£ï¼Œå¤šçº¿ç¨‹ï¼Œå¹¶è¡Œï¼Œå¤šçº¿ç¨‹æœºåˆ¶ä¸Parallel Scavengeå·®ä¸é”™ï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œåœ¨Parallel Oldæ‰§è¡Œæ—¶ï¼Œä»ç„¶éœ€è¦æš‚åœå…¶å®ƒçº¿ç¨‹ã€‚ CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œè‡´åŠ›äºè·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ï¼ˆå³ç¼©çŸ­åƒåœ¾å›æ”¶çš„æ—¶é—´ï¼‰ï¼Œä½¿ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå¤šçº¿ç¨‹ï¼Œä¼˜ç‚¹æ˜¯å¹¶å‘æ”¶é›†ï¼ˆç”¨æˆ·çº¿ç¨‹å¯ä»¥å’ŒGCçº¿ç¨‹åŒæ—¶å·¥ä½œï¼‰ï¼Œåœé¡¿å°ã€‚ä½¿ç”¨-XX:+UseConcMarkSweepGCè¿›è¡ŒParNew+CMS+Serial Oldè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¼˜å…ˆä½¿ç”¨ParNew+CMSï¼ˆåŸå› è§Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶ä¸€èŠ‚ï¼‰ï¼Œå½“ç”¨æˆ·çº¿ç¨‹å†…å­˜ä¸è¶³æ—¶ï¼Œé‡‡ç”¨å¤‡ç”¨æ–¹æ¡ˆSerial Oldæ”¶é›†ã€‚ ä¸GCæœ‰å…³çš„JVMå‚æ•° å‚æ•° æè¿° -Xms è®¾ç½®JVMå¯åŠ¨æ—¶å †çš„åˆå§‹åŒ–å¤§å°ã€‚ -Xmx è®¾ç½®å †æœ€å¤§å€¼ã€‚ -Xmn è®¾ç½®æ–°ç”Ÿä»£çš„ç©ºé—´å¤§å°ï¼Œå‰©ä¸‹çš„ä¸ºè€å¹´ä»£çš„ç©ºé—´å¤§å°ã€‚ -XX:SurvivorRatio æä¾›EdenåŒºå’ŒsurvivoråŒºçš„ç©ºé—´æ¯”ä¾‹ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ–°ç”Ÿä»£çš„å¤§å°ä¸º10må¹¶ä¸”VMå¼€å…³æ˜¯-XX:SurvivorRatio=2ï¼Œé‚£ä¹ˆå°†ä¼šä¿ç•™5må†…å­˜ç»™EdenåŒºå’Œæ¯ä¸ªSurvivoråŒºåˆ†é…2.5må†…å­˜ã€‚é»˜è®¤æ¯”ä¾‹æ˜¯8ã€‚ -XX:NewRatio æä¾›è€å¹´ä»£å’Œæ–°ç”Ÿä»£çš„æ¯”ä¾‹å¤§å°ã€‚é»˜è®¤å€¼æ˜¯2ã€‚ -XX:MetaspaceSize åˆ†é…ç»™ç±»å…ƒæ•°æ®ç©ºé—´çš„åˆå§‹å¤§å° -XX:MaxMetaspaceSize åˆ†é…ç»™ç±»å…ƒæ•°æ®ç©ºé—´çš„æœ€å¤§å€¼ -XX:MinMetaspaceFreeRatio ä¸€æ¬¡GCä»¥åï¼Œä¸ºäº†é¿å…å¢åŠ å…ƒæ•°æ®ç©ºé—´çš„å¤§å°ï¼Œç©ºé—²çš„ç±»å…ƒæ•°æ®çš„å®¹é‡çš„æœ€å°æ¯”ä¾‹ï¼Œä¸å¤Ÿå°±ä¼šå¯¼è‡´åƒåœ¾å›æ”¶ã€‚ -XX:MaxMetaspaceFreeRatio ä¸€æ¬¡GCä»¥åï¼Œä¸ºäº†é¿å…å¢åŠ å…ƒæ•°æ®ç©ºé—´çš„å¤§å°ï¼Œç©ºé—²çš„ç±»å…ƒæ•°æ®çš„å®¹é‡çš„æœ€å¤§æ¯”ä¾‹ï¼Œä¸å¤Ÿå°±ä¼šå¯¼è‡´åƒåœ¾å›æ”¶ã€‚ GCç›‘æ§å¯ä»¥ä½¿ç”¨JDKè‡ªå¸¦çš„VisualVMè¿›è¡Œç›‘æ§ æ€»ç»“ ä¸ºäº†åˆ†ä»£åƒåœ¾å›æ”¶ï¼ŒJavaå †å†…å­˜åˆ†ä¸º3ä»£ï¼šæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£ã€‚java8å¼€å§‹æ°¸ä¹…ä»£å·²ç§»å‡º æ–°çš„å¯¹è±¡å®ä¾‹ä¼šä¼˜å…ˆåˆ†é…åœ¨æ–°ç”Ÿä»£ï¼Œåœ¨ç»å†å‡ æ¬¡Minor GCå(é»˜è®¤15æ¬¡)ï¼Œè¿˜å­˜æ´»çš„ä¼šè¢«ç§»è‡³è€å¹´ä»£(æŸäº›å¤§å¯¹è±¡ä¼šç›´æ¥åœ¨è€å¹´ä»£åˆ†é…)ã€‚ Minor GCå‘ç”Ÿåœ¨æ–°ç”Ÿä»£ï¼Œå½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶ï¼Œä¼šå‘èµ·ä¸€æ¬¡Minor GCï¼Œå°†EdenåŒºä¸­çš„å­˜æ´»å¯¹è±¡ç§»è‡³SurvivoråŒºã€‚Major GCå‘ç”Ÿåœ¨è€å¹´ä»£ï¼Œå½“å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¤§äºè€å¹´ä»£å‰©ä½™ç©ºé—´æ—¶ä¼šå‘ç”ŸMajor GCã€‚ å‘ç”ŸMajor GCæ—¶ç”¨æˆ·çº¿ç¨‹ä¼šæš‚åœï¼Œä¼šé™ä½ç³»ç»Ÿæ€§èƒ½å’Œååé‡ã€‚ Javaä¸­ä¸èƒ½æ‰‹åŠ¨è§¦å‘GCï¼Œä½†å¯ä»¥ç”¨ä¸åŒçš„å¼•ç”¨ç±»æ¥è¾…åŠ©åƒåœ¾å›æ”¶å™¨å·¥ä½œ(æ¯”å¦‚ï¼šå¼±å¼•ç”¨æˆ–è½¯å¼•ç”¨)ã€‚ å‚è€ƒ ã€è¯‘ã€‘Javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶ Java HotSpot VM Options Javaå†…å­˜ä¸åƒåœ¾å›æ”¶è°ƒä¼˜ Java GC ä¸­çš„ä¸€äº›æ¦‚å¿µ","categories":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/categories/JVM/"}],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/tags/JVM/"}]},{"title":"Unsafe","slug":"Unsafe","date":"2018-04-20T10:48:25.000Z","updated":"2018-04-20T13:19:46.046Z","comments":true,"path":"2018/04/20/Unsafe/","link":"","permalink":"https://hsb786.github.io/2018/04/20/Unsafe/","excerpt":"sun.misc.Unsafeç±»æä¾›çš„åŸå­æ“ä½œæ˜¯åŸºäºæ“ä½œç³»ç»Ÿç›´æ¥å¯¹CPUè¿›è¡Œæ“ä½œ Unsafeç±»åŒ…è£…äº†å¾ˆå¤šä½çº§åˆ«çš„éå®‰å…¨æ€§æ“ä½œï¼Œå¯ä»¥ç›´æ¥æ“ä½œä»»æ„çš„å†…å­˜ã€‚è™½ç„¶è¯¥ç±»çš„å¤§éƒ¨åˆ†æ–¹æ³•éƒ½æ˜¯publicçš„ï¼Œä½†æ˜¯å®ƒåªèƒ½è¢«å—ä¿¡ä»»çš„ä»£ç ä½¿ç”¨ï¼ˆjdkä¸­çš„ä»£ç ï¼‰","text":"sun.misc.Unsafeç±»æä¾›çš„åŸå­æ“ä½œæ˜¯åŸºäºæ“ä½œç³»ç»Ÿç›´æ¥å¯¹CPUè¿›è¡Œæ“ä½œ Unsafeç±»åŒ…è£…äº†å¾ˆå¤šä½çº§åˆ«çš„éå®‰å…¨æ€§æ“ä½œï¼Œå¯ä»¥ç›´æ¥æ“ä½œä»»æ„çš„å†…å­˜ã€‚è™½ç„¶è¯¥ç±»çš„å¤§éƒ¨åˆ†æ–¹æ³•éƒ½æ˜¯publicçš„ï¼Œä½†æ˜¯å®ƒåªèƒ½è¢«å—ä¿¡ä»»çš„ä»£ç ä½¿ç”¨ï¼ˆjdkä¸­çš„ä»£ç ï¼‰1234567891011121314151617181920212223242526272829public final class Unsafe &#123; private static native void registerNatives(); static &#123; registerNatives(); sun.reflect.Reflection.registerMethodsToFilter(Unsafe.class, &quot;getUnsafe&quot;); &#125; //é¥¿æ±‰å¼å•ä¾‹ private Unsafe() &#123;&#125; private static final Unsafe theUnsafe = new Unsafe(); @CallerSensitive public static Unsafe getUnsafe() &#123; //è·å–è°ƒç”¨è¯¥æ–¹æ³•çš„è°ƒç”¨è€…ä¿¡æ¯ Class&lt;?&gt; caller = Reflection.getCallerClass(); //åˆ¤æ–­ç±»åŠ è½½å™¨æ˜¯å¦æ˜¯ç³»ç»Ÿç±»åŠ è½½å™¨ if (!VM.isSystemDomainLoader(caller.getClassLoader())) throw new SecurityException(&quot;Unsafe&quot;); return theUnsafe; &#125; .............&#125;//VM.class public static boolean isSystemDomainLoader(ClassLoader loader) &#123; return loader == null;&#125; Unsafe.getUnsafe()åªèƒ½è¢«boostrap classloaderåŠ è½½çš„ç±»ä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨javaåå°„æ¥è·å–Unsafeçš„å®ä¾‹ã€‚ 123456//è·å–Unsafeç±»ä¸­çš„theUnsafeå­—æ®µField f = Unsafe.class.getDeclaredField(&quot;theUnsafe&quot;);//ç”±äºtheUnsafeè¢«privateä¿®é¥°ï¼Œæ‰€ä»¥è¦è·³è¿‡å®‰å…¨æ£€æŸ¥f.setAccessible(true);//è·å–å½“å‰fçš„å€¼ï¼Œä¹Ÿå°±æ˜¯Unsafeçš„å®ä¾‹Unsafe unsafe = (Unsafe) f.get(null); public native long objectFieldOffset(Field f)å’Œpublic native long staticFieldOffset(Field f)ï¼šç”¨äºè¿”å›ç±»å®šä¹‰ä¸­æŸä¸ªå±æ€§åœ¨ä¸»å†…å­˜ä¸­è®¾å®šçš„åç§»é‡ã€‚ç›¸å½“äºCASä¸­çš„Vã€‚ public final native boolean compareAndSwapInt(Object o, long offset, int expected, int x);ï¼šå¯¹å±æ€§è¿›è¡Œæ¯”è¾ƒå¹¶æ›¿æ¢ï¼ˆCASè¿‡ç¨‹â€”â€”Compare And Swapï¼‰ã€‚offectï¼šVï¼Œexpectedï¼šAï¼Œxï¼šB 1234567891011//java8public final int getAndAddInt(Object o, long offset, int delta) &#123; int v; do &#123; //è‡ªæ—‹ï¼Œä¸€ç›´å¾ªç¯ç›´åˆ°compareAndSwapIntæ‰§è¡ŒæˆåŠŸ v = getIntVolatile(o, offset); &#125; while (!compareAndSwapInt(o, offset, v, v + delta)); return v;&#125;public native int getIntVolatile(Object o, long offset); getAndAddInt()é‡‡ç”¨çš„æ˜¯åŸºäºUnsafeçš„â€ä¹è§‚é”â€è¿›è¡Œå®ç°çš„ï¼Œä¹è§‚åœ°è®¤ä¸ºç¨‹åºä¸­çš„å¹¶å‘æƒ…å†µä¸é‚£ä¹ˆä¸¥é‡ï¼Œæ‰€ä»¥è®©çº¿ç¨‹ä¸æ–­å»å°è¯•æ›´æ–°ã€‚é€‚åˆå¹¶å‘é‡ä¸é«˜çš„æƒ…å†µã€‚ @CallerSensitive12345678910111213141516171819//sun.reflect.CallerSensitive/** * A method annotated @CallerSensitive is sensitive to its calling class, * via &#123;@link sun.reflect.Reflection#getCallerClass Reflection.getCallerClass&#125;, * or via some equivalent. * * @author John R. Rose */@Retention(RetentionPolicy.RUNTIME)@Target(&#123;METHOD&#125;)public @interface CallerSensitive &#123;&#125;//sun.reflect.Reflection/** Returns the class of the caller of the method calling this method, ignoring frames associated with java.lang.reflect.Method.invoke() and its implementation. */@CallerSensitivepublic static native Class&lt;?&gt; getCallerClass(); ç”¨@CallerSensitiveæ³¨è§£ä¿®é¥°çš„æ–¹æ³•ä»ä¸€å¼€å§‹å°±çŸ¥é“å…·ä½“è°ƒç”¨å®ƒçš„å¯¹è±¡ï¼Œè¿™æ ·å°±ä¸ç”¨å†ç»è¿‡ä¸€ç³»åˆ—çš„æ£€æŸ¥æ‰èƒ½ç¡®å®šå…·ä½“è°ƒç”¨å®ƒçš„å¯¹è±¡äº†ã€‚å®ƒå®é™…ä¸Šæ˜¯è°ƒç”¨sun.reflect.Reflection.getCallerClassæ–¹æ³•ã€‚ Reflectionç±»ä½äºè°ƒç”¨æ ˆä¸­çš„0å¸§ä½ç½®ï¼Œsun.reflect.Reflection.getCallerClass()æ–¹æ³•è¿”å›è°ƒç”¨æ ˆä¸­ä»0å¸§å¼€å§‹çš„ç¬¬xå¸§ä¸­çš„ç±»å®ä¾‹ã€‚è¯¥æ–¹æ³•æä¾›çš„æœºåˆ¶å¯ç”¨äºç¡®å®šè°ƒç”¨è€…ç±»ï¼Œä»è€Œå®ç°â€œæ„ŸçŸ¥è°ƒç”¨è€…ï¼ˆCaller Sensitiveï¼‰â€çš„è¡Œä¸ºï¼Œå³å…è®¸åº”ç”¨ç¨‹åºæ ¹æ®è°ƒç”¨ç±»æˆ–è°ƒç”¨æ ˆä¸­çš„å…¶å®ƒç±»æ¥æ”¹å˜å…¶è‡ªèº«çš„è¡Œä¸ºã€‚ æ„Ÿè§‰ä¸å¤ªæ‡‚ï¼Œåšä¸ªæ ‡è®°ï¼Œä»¥åå†æ¥çœ‹å§ å‚è€ƒ çº¿ç¨‹è¿›é˜¶ï¼šå¤šä»»åŠ¡å¤„ç†ï¼ˆ17ï¼‰â€”â€”Javaä¸­çš„é”ï¼ˆUnsafeåŸºç¡€ï¼‰ è·Ÿæˆ‘ä¸€èµ·å‰–æ Java å¹¶å‘æºç ä¹‹ Unsafe JDK8çš„@CallerSensitive JVMæ³¨è§£@CallSensitive æ·±å…¥è§£æJavaåå°„ï¼ˆ2ï¼‰ - invokeæ–¹æ³•","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"å¤šçº¿ç¨‹åŸºç¡€2","slug":"å¤šçº¿ç¨‹åŸºç¡€2","date":"2018-04-20T05:28:33.000Z","updated":"2018-05-02T06:08:26.983Z","comments":true,"path":"2018/04/20/å¤šçº¿ç¨‹åŸºç¡€2/","link":"","permalink":"https://hsb786.github.io/2018/04/20/å¤šçº¿ç¨‹åŸºç¡€2/","excerpt":"çº¿ç¨‹æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº§åˆ«çš„æ¦‚å¿µã€‚JAVAè¯­è¨€ï¼ˆåŒ…æ‹¬å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼‰æœ¬èº«ä¸åˆ›å»ºçº¿ç¨‹ï¼›è€Œæ˜¯è°ƒç”¨æ“ä½œç³»ç»Ÿå±‚æä¾›çš„æ¥å£åˆ›å»ºã€æ§åˆ¶ã€é”€æ¯çº¿ç¨‹å®ä¾‹ã€‚","text":"çº¿ç¨‹æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº§åˆ«çš„æ¦‚å¿µã€‚JAVAè¯­è¨€ï¼ˆåŒ…æ‹¬å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼‰æœ¬èº«ä¸åˆ›å»ºçº¿ç¨‹ï¼›è€Œæ˜¯è°ƒç”¨æ“ä½œç³»ç»Ÿå±‚æä¾›çš„æ¥å£åˆ›å»ºã€æ§åˆ¶ã€é”€æ¯çº¿ç¨‹å®ä¾‹ã€‚ æ ¹æ®æ“ä½œç³»ç»Ÿçš„ä¸åŒï¼ˆWindows/Unix/Linux/å…¶ä»–ï¼‰ï¼Œä»–ä»¬æ‰€æ”¯æŒçš„çº¿ç¨‹åº•å±‚å®ç°å’Œæ“ä½œæ•ˆæœä¹Ÿæ˜¯ä¸å°½ç›¸åŒçš„ã€‚ä¸è¿‡ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ”¯æŒçš„çº¿ç¨‹è‡³å°‘ä¼šæœ‰å››ç§çŠ¶æ€ï¼šå°±ç»ªã€è¿è¡Œã€é˜»å¡å’Œç»ˆæ­¢ã€‚çº¿ç¨‹åœ¨å››ç§çŠ¶æ€ä¸‹è¿›è¡Œåˆ‡æ¢ï¼Œéƒ½æ˜¯è¦æ¶ˆè€—ä¸å°‘çš„CPUè®¡ç®—èƒ½åŠ›çš„ã€‚ æ ¹æ®æ“ä½œç³»ç»Ÿä½¿ç”¨çº¿ç¨‹çš„è¿›ç¨‹çš„ä¸ä¸€æ ·ï¼Œçº¿ç¨‹è¿˜åˆ†ä¸ºç”¨æˆ·çº¿ç¨‹å’Œæ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼ˆå†…æ ¸çº¿ç¨‹ï¼‰ï¼Œæ˜¯æŒ‡æ“ä½œç³»ç»Ÿå†…æ ¸ä¸ºäº†å®Œæˆç¡¬ä»¶æ¥å£å±‚æ“ä½œï¼Œç”±æ“ä½œç³»ç»Ÿå†…æ ¸åˆ›å»ºçš„çº¿ç¨‹ï¼šä¾‹å¦‚I/Oæ“ä½œçš„å†…æ ¸çº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹åº”ç”¨ç¨‹åºæ˜¯ä¸èƒ½å¹²é¢„çš„ï¼›ç”¨æˆ·çº¿ç¨‹ï¼Œæ˜¯æŒ‡ç”¨æˆ·å®‰è£…/ç®¡ç†çš„åº”ç”¨ç¨‹åºï¼Œä¸ºæ‰§è¡ŒæŸä¸€ç§æ“ä½œï¼Œè€Œç”±è¿™ä¸ªåº”ç”¨ç¨‹åºåˆ›å»ºçš„çº¿ç¨‹ã€‚ é»„è‰²é’¥åŒ™ä»£è¡¨å¯¹è±¡é” thread.interrupt()ï¼ŒThread.interrupted()ï¼Œthread.isInterrupted() å½“Threadæ”¶åˆ°interruptä¿¡å·æ˜¯ï¼Œå¯èƒ½çš„ä¸¤ç§ç»“æœ: çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€æ—¶ï¼Œçº¿ç¨‹å¯¹è±¡çš„isInterruptå±æ€§è¢«ç½®ä¸ºtrue å¤„äºé˜»å¡çŠ¶æ€æ˜¯ï¼ŒæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œå…¶isInterruptä¸ä¼šè¢«ç½®ä¸ºtrueã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * Tests whether the current thread has been interrupted. The * &lt;i&gt;interrupted status&lt;/i&gt; of the thread is cleared by this method. In * other words, if this method were to be called twice in succession, the * second call would return false (unless the current thread were * interrupted again, after the first call had cleared its interrupted * status and before the second call had examined it). * * &lt;p&gt;A thread interruption ignored because a thread was not alive * at the time of the interrupt will be reflected by this method * returning false. * * @return &lt;code&gt;true&lt;/code&gt; if the current thread has been interrupted; * &lt;code&gt;false&lt;/code&gt; otherwise. * @see #isInterrupted() * @revised 6.0 */ public static boolean interrupted() &#123; return currentThread().isInterrupted(true); &#125; /** * Tests whether this thread has been interrupted. The &lt;i&gt;interrupted * status&lt;/i&gt; of the thread is unaffected by this method. * * &lt;p&gt;A thread interruption ignored because a thread was not alive * at the time of the interrupt will be reflected by this method * returning false. * * @return &lt;code&gt;true&lt;/code&gt; if this thread has been interrupted; * &lt;code&gt;false&lt;/code&gt; otherwise. * @see #interrupted() * @revised 6.0 */ public boolean isInterrupted() &#123; return isInterrupted(false); &#125; /** * Tests if some Thread has been interrupted. The interrupted state * is reset or not based on the value of ClearInterrupted that is * passed. */ private native boolean isInterrupted(boolean ClearInterrupted); å¯ä»¥çœ‹å‡ºinterruptedå’ŒisInterruptedåŒºåˆ«åœ¨äºä¼ ç»™ClearInterruptedçš„å‚æ•°æ˜¯trueè¿˜æ˜¯falseã€‚ ClearInterruptedå‚æ•°å‘æ“ä½œç³»ç»ŸæŒ‡æ˜æ˜¯å¦åœ¨è·å–çŠ¶æ€åå°†å½“å‰çº¿ç¨‹çš„interruptedçŠ¶æ€é‡ç½®ä¸ºfalseã€‚ è¿™å°±æ„å‘³ç€å½“æŸä¸ªçº¿ç¨‹çš„isInterruptå±æ€§æˆåŠŸè¢«ç½®ä¸ºtrueåï¼Œå¦‚æœæ‚¨ä½¿ç”¨å¯¹è±¡æ–¹æ³•thread.isInterrupted()è·å–å€¼ï¼Œæ— è®ºæ‚¨è·å–å¤šå°‘æ¬¡å¾—åˆ°çš„è¿”å›å€¼éƒ½æ˜¯trueï¼›ä½†æ˜¯å¦‚æœæ‚¨ä½¿ç”¨é™æ€æ–¹æ³•Thread.interrupted()è·å–å€¼ï¼Œé‚£ä¹ˆåªæœ‰ç¬¬ä¸€æ¬¡è·å–çš„ç»“æœæ˜¯trueï¼Œéšåçº¿ç¨‹çš„isInterruptå±æ€§å°†è¢«æ¢å¤æˆfalseï¼Œåç»­æ— è®ºä½¿ç”¨Thread.interrupted()è°ƒç”¨è¿˜æ˜¯ä½¿ç”¨thread.isInterrupted()è°ƒç”¨ï¼Œè·å–çš„ç»“æœéƒ½æ˜¯falseã€‚ Javaè¯­è¨€ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§åŸºç¡€çº¿ç¨‹æ± çš„é€‰æ‹©ï¼šScheduledThreadPoolExecutorå’ŒThreadPoolExecutorã€‚å®ƒä»¬éƒ½å®ç°äº†ExecutorServiceæ¥å£ï¼ˆæ³¨æ„ï¼ŒExecutorServiceæ¥å£æœ¬èº«å’Œâ€œçº¿ç¨‹æ± â€å¹¶æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œå®ƒçš„å®šä¹‰æ›´æ¥è¿‘â€œæ‰§è¡Œå™¨â€ï¼Œè€Œâ€œä½¿ç”¨çº¿ç¨‹ç®¡ç†çš„æ–¹å¼è¿›è¡Œå®ç°â€åªæ˜¯å…¶ä¸­çš„ä¸€ç§å®ç°æ–¹å¼ï¼‰ã€‚ JAVAä¸»è¦çº¿ç¨‹æ± çš„ç»§æ‰¿ç»“æ„ ThreadPoolExecutorï¼šå¯¹äºä»»åŠ¡çš„æ‰§è¡Œæ˜¯ç«‹å³çš„ã€ä¸€æ¬¡æ€§çš„ã€‚ ScheduledThreadPoolExecutorï¼šä¸€ä¸ªç”¨æ¥æ‰§è¡Œå»¶è¿Ÿä»»åŠ¡ã€å®šæ—¶ä»»åŠ¡æˆ–è€…å‘¨æœŸæ€§ä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨å®ƒå¯ä»¥å¤„ç†å®šæ—¶è®¡ç®—ã€å‘¨æœŸæ€§ç»Ÿè®¡ä¸€ç±»çš„ä»»åŠ¡ã€‚ ForkJoinPoolï¼šScheduledThreadPoolExecutorå’ŒThreadPoolExecutoréƒ½æ˜¯åœ¨JDK1.5ç‰ˆæœ¬ä¸­æä¾›çš„ã€‚åœ¨JDK1.7ä¸­ï¼ŒJAVAä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ–°çš„çº¿ç¨‹æ± ForkJoinPoolä»¥åŠé…å¥—çš„ä»»åŠ¡å®šä¹‰ForkJoinTaskã€‚é™¤äº†å¯ä»¥æ‰§è¡Œå®ç°äº†Runnableæ¥å£æˆ–è€…Callableæ¥å£çš„ä»»åŠ¡ä»¥å¤–ï¼ŒForkJoinPoolè¿˜å¯ä»¥æ‰§è¡Œé›†æˆäº†ForkJoinTaskå®šä¹‰çš„ä»»åŠ¡ã€‚ForkJoinPoolçš„æ‰§è¡ŒåŸç†å’ŒThreadPoolExecutorçš„æ‰§è¡ŒåŸç†æ˜¯ä¸ä¸€æ ·çš„ ThreadFactoryçº¿ç¨‹æ± æœ€ä¸»è¦çš„ä¸€é¡¹å·¥ä½œï¼Œå°±æ˜¯åœ¨æ»¡è¶³æŸäº›æ¡ä»¶çš„æƒ…å†µä¸‹åˆ›å»ºçº¿ç¨‹ã€‚è€Œåœ¨ThreadPoolExecutorçº¿ç¨‹æ± ä¸­ï¼Œåˆ›å»ºçº¿ç¨‹çš„å·¥ä½œäº¤ç»™ThreadFactoryæ¥å®Œæˆã€‚è¦ä½¿ç”¨çº¿ç¨‹æ± ï¼Œå°±å¿…é¡»è¦æŒ‡å®šThreadFactoryã€‚ å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ„é€ å‡½æ•°æ—¶å¹¶æ²¡æœ‰æŒ‡å®šä½¿ç”¨çš„ThreadFactoryï¼Œè¿™ä¸ªæ—¶å€™ThreadPoolExecutorä¼šä½¿ç”¨ä¸€ä¸ªé»˜è®¤çš„ThreadFactoryï¼šDefaultThreadFactoryã€‚ï¼ˆè¿™ä¸ªç±»åœ¨Executorså·¥å…·ç±»ä¸­ï¼‰ Executorså·¥å…·ç±»å’ŒThreadPoolExecutorç±»å­˜åœ¨å¾ªç¯ä¾èµ–ï¼šThreadPoolExecutorä¸­ä½¿ç”¨äº†Executorså·¥å…·ç±»ä¸­å®šä¹‰çš„DefaultThreadFactoryï¼›è€Œåœ¨Executorså·¥å…·ç±»ä¸­å´åˆåœ¨åˆ›å»ºThreadPoolExecutorçš„å¯¹è±¡å®ä¾‹ã€‚ å‚è€ƒ å¤šçº¿ç¨‹åŸºç¡€","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/categories/å¤šçº¿ç¨‹/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"CAS","slug":"CAS","date":"2018-04-19T09:41:51.000Z","updated":"2018-04-24T06:25:08.055Z","comments":true,"path":"2018/04/19/CAS/","link":"","permalink":"https://hsb786.github.io/2018/04/19/CAS/","excerpt":"CASï¼ˆCompare And Swapï¼‰ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯æ¯”è¾ƒå’Œæ›¿æ¢ã€‚ CASæœºåˆ¶å½“ä¸­ä½¿ç”¨äº†3ä¸ªåŸºæœ¬æ“ä½œæ•°ï¼šå†…å­˜åœ°å€Vï¼Œæ—§çš„é¢„æœŸå€¼Aï¼Œè¦ä¿®æ”¹çš„æ–°å€¼Bã€‚ æ›´æ–°ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œåªæœ‰å½“å˜é‡çš„é¢„æœŸå€¼Aå’Œå†…å­˜åœ°å€Vå½“ä¸­çš„å®é™…å€¼ç›¸åŒæ—¶ï¼Œæ‰ä¼šå°†å†…å­˜åœ°å€Vå¯¹åº”çš„å€¼ä¿®æ”¹æˆBã€‚","text":"CASï¼ˆCompare And Swapï¼‰ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯æ¯”è¾ƒå’Œæ›¿æ¢ã€‚ CASæœºåˆ¶å½“ä¸­ä½¿ç”¨äº†3ä¸ªåŸºæœ¬æ“ä½œæ•°ï¼šå†…å­˜åœ°å€Vï¼Œæ—§çš„é¢„æœŸå€¼Aï¼Œè¦ä¿®æ”¹çš„æ–°å€¼Bã€‚ æ›´æ–°ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œåªæœ‰å½“å˜é‡çš„é¢„æœŸå€¼Aå’Œå†…å­˜åœ°å€Vå½“ä¸­çš„å®é™…å€¼ç›¸åŒæ—¶ï¼Œæ‰ä¼šå°†å†…å­˜åœ°å€Vå¯¹åº”çš„å€¼ä¿®æ”¹æˆBã€‚ ä¸¾ä¸ªæ —å­ğŸ‚ åœ¨å†…å­˜åœ°å€Vå½“ä¸­ï¼Œå­˜å‚¨ç€å€¼ä¸º10çš„å˜é‡ã€‚ æ­¤æ—¶çº¿ç¨‹1æƒ³è¦æŠŠå˜é‡çš„å€¼å¢åŠ 1ã€‚å¯¹çº¿ç¨‹1æ¥è¯´ï¼Œæ—§çš„é¢„æœŸå€¼A=10ï¼Œè¦ä¿®æ”¹çš„æ–°å€¼B=11ã€‚ åœ¨çº¿ç¨‹1è¦æäº¤æ›´æ–°ä¹‹å‰ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹2æŠ¢å…ˆä¸€æ­¥ï¼ŒæŠŠå†…å­˜åœ°å€Vä¸­çš„å˜é‡å€¼ç‡å…ˆæ›´æ–°æˆäº†11 çº¿ç¨‹1å¼€å§‹æäº¤æ›´æ–°ï¼Œé¦–å…ˆè¿›è¡ŒAå’Œåœ°å€Vçš„å®é™…å€¼æ¯”è¾ƒï¼ˆCompareï¼‰ï¼Œå‘ç°Aä¸ç­‰äºVçš„å®é™…å€¼ï¼Œæäº¤å¤±è´¥ã€‚ çº¿ç¨‹1é‡æ–°è·å–å†…å­˜åœ°å€Vçš„å½“å‰å€¼ï¼Œå¹¶é‡æ–°è®¡ç®—æƒ³è¦ä¿®æ”¹çš„æ–°å€¼ã€‚æ­¤æ—¶å¯¹çº¿ç¨‹1æ¥è¯´ï¼ŒA=11ï¼ŒB=12ã€‚è¿™ä¸ªé‡æ–°å°è¯•çš„è¿‡ç¨‹è¢«ç§°ä¸ºè‡ªæ—‹ã€‚ è¿™ä¸€æ¬¡æ¯”è¾ƒå¹¸è¿ï¼Œæ²¡æœ‰å…¶ä»–çº¿ç¨‹æ”¹å˜åœ°å€Vçš„å€¼ã€‚çº¿ç¨‹1è¿›è¡ŒCompareï¼Œå‘ç°Aå’Œåœ°å€Vçš„å®é™…å€¼æ˜¯ç›¸ç­‰çš„ã€‚ çº¿ç¨‹1è¿›è¡ŒSWAPï¼ŒæŠŠåœ°å€Vçš„å€¼æ›¿æ¢ä¸ºBï¼Œä¹Ÿå°±æ˜¯12ã€‚ synchronizedä¸CASsynchronizedå…³é”®å­—ä¼šè®©æ²¡æœ‰å¾—åˆ°çº¿ç¨‹é”èµ„æºçš„çº¿ç¨‹è¿›å…¥BLOCKEDçŠ¶æ€ï¼Œè€Œååœ¨äº‰å¤ºåˆ°é”èµ„æºåæ¢å¤ä¸ºRUNNABLEçŠ¶æ€ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿç”¨æˆ·æ¨¡å¼å’Œå†…æ ¸æ¨¡å¼çš„åˆ‡æ¢ï¼Œä»£ä»·æ¯”è¾ƒé«˜ã€‚ ä»æ€æƒ³ä¸Šæ¥è¯´ï¼ŒSynchronizedå±äºæ‚²è§‚é”ï¼Œæ‚²è§‚åœ°è®¤ä¸ºç¨‹åºä¸­çš„å¹¶å‘æƒ…å†µä¸¥é‡ï¼Œæ‰€ä»¥ä¸¥é˜²æ­»å®ˆã€‚CASå±äºä¹è§‚é”ï¼Œä¹è§‚åœ°è®¤ä¸ºç¨‹åºä¸­çš„å¹¶å‘æƒ…å†µä¸é‚£ä¹ˆä¸¥é‡ï¼Œæ‰€ä»¥è®©çº¿ç¨‹ä¸æ–­å»å°è¯•æ›´æ–°ã€‚ åŸå­æ“ä½œç±»æŒ‡çš„æ˜¯java.util.concurrent.atomicåŒ…ä¸‹ï¼Œä¸€ç³»åˆ—ä»¥Atomicå¼€å¤´çš„åŒ…è£…ç±»ã€‚ä¾‹å¦‚AtomicBooleanï¼ŒAtomicIntegerï¼ŒAtomicLongã€‚ AtomicInteger12345678910private volatile int value;private static final Unsafe unsafe = Unsafe.getUnsafe();private static final long valueOffset;static &#123; try &#123; valueOffset = unsafe.objectFieldOffset (AtomicInteger.class.getDeclaredField(&quot;value&quot;)); &#125; catch (Exception ex) &#123; throw new Error(ex); &#125;&#125; unsafeï¼šJavaè¯­è¨€ä¸åƒCï¼ŒC++é‚£æ ·å¯ä»¥ç›´æ¥è®¿é—®åº•å±‚æ“ä½œç³»ç»Ÿï¼Œä½†æ˜¯JVMä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåé—¨ï¼Œè¿™ä¸ªåé—¨å°±æ˜¯unsafeã€‚unsafeä¸ºæˆ‘ä»¬æä¾›äº†ç¡¬ä»¶çº§åˆ«çš„åŸå­æ“ä½œã€‚ valueOffsetï¼šè‡³äºvalueOffsetå¯¹è±¡ï¼Œæ˜¯é€šè¿‡unsafe.objectFieldOffsetæ–¹æ³•å¾—åˆ°ï¼Œæ‰€ä»£è¡¨çš„æ˜¯AtomicIntegerå¯¹è±¡valueæˆå‘˜å˜é‡åœ¨å†…å­˜ä¸­çš„åç§»é‡ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°æŠŠvalueOffsetç†è§£ä¸ºvalueå˜é‡çš„å†…å­˜åœ°å€ã€‚ getAndIncrement ç›¸å½“äºi++ï¼Œå…ˆè¿”å›å€¼å†åŠ 1 åœ¨java7ä¸­æ˜¯è¿™æ ·å®ç°çš„12345678910111213//AtomicInteger.classpublic final int getAndIncrement() &#123; for (;;) &#123; int current = get(); int next = current + 1; if (compareAndSet(current, next)) return current; &#125;&#125;public final boolean compareAndSet(int expect, int update) &#123; return unsafe.compareAndSwapInt(this, valueOffset, expect, update);&#125; getAndIncrementæ–¹æ³•å†…éƒ¨ä¼šä¸åœçš„å¾ªç¯ï¼Œç›´åˆ°unsafe.comparAndSwapIntæ–¹æ³•æ‰§è¡ŒæˆåŠŸã€‚valueOffsetç›¸å½“äºå‰é¢è®²çš„Vï¼Œexpectï¼šæ—§çš„é¢„æœŸå€¼Aï¼Œupdateï¼šæ–°çš„é¢„æœŸå€¼B java8ä¸­çš„å®ç°1234//AtomicInteger.classpublic final int getAndIncrement() &#123; return unsafe.getAndAddInt(this, valueOffset, 1);&#125; è¿™æ—¶éœ€è¦æŸ¥çœ‹Unsafeçš„æºç ï¼Œå¯ä»¥ä¸‹è½½openjdkï¼Œopenjdkä¸­æœ‰å…³äºsun.miscåŒ…ä¸­çš„æºç ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œå¯¼è‡´è·Ÿä»£ç çš„æ—¶å€™ä¼šä¸å‡†ç¡®ã€‚è€Œä¸”æˆ‘å‘ç°åŒæ ·æ˜¯java8ï¼Œä»£ç è¿˜æœ‰äº›ä¸ä¸€æ ·ï¼Œå¯èƒ½æ˜¯java8çš„ç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´çš„ã€‚ 1234567891011121314//Unsafe.classpublic final int getAndAddInt(Object o, long offset, int delta) &#123; int v; do &#123; v = getIntVolatile(o, offset); &#125; while (!compareAndSwapInt(o, offset, v, v + delta)); return v;&#125;public native int getIntVolatile(Object o, long offset);public final native boolean compareAndSwapInt(Object o, long offset, int expected, int x); æ„Ÿè§‰è·Ÿjdk7å·®ä¸å¤šï¼Œåªæ˜¯æŠŠè‡ªæ—‹éƒ¨åˆ†çš„ä»£ç ä»AtomicIntegerç§»åŠ¨åˆ°äº†Unsafeä¸­ã€‚ Javaè¯­è¨€CASåº•å±‚å°±æ˜¯åˆ©ç”¨unsafeæä¾›çš„åŸå­æ€§æ“ä½œæ–¹æ³•æ¥å®ç°çš„ã€‚ ç¼ºç‚¹1. CPUå¼€é”€è¾ƒå¤§ åœ¨å¹¶å‘é‡æ¯”è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œå¦‚æœè®¸å¤šçº¿ç¨‹åå¤å°è¯•æ›´æ–°æŸä¸€ä¸ªå˜é‡ï¼Œå´åˆä¸€ç›´æ›´æ–°ä¸æˆåŠŸï¼Œå¾ªç¯å¾€å¤ï¼Œä¼šç»™CPUå¸¦æ¥å¾ˆå¤§çš„å‹åŠ›ã€‚ 2. ä¸èƒ½ä¿è¯ä»£ç å—çš„åŸå­æ€§ CASæœºåˆ¶æ‰€ä¿è¯çš„åªæ˜¯ä¸€ä¸ªå˜é‡çš„åŸå­æ€§æ“ä½œï¼Œè€Œä¸èƒ½ä¿è¯æ•´ä¸ªä»£ç å—çš„åŸå­æ€§ã€‚æ¯”å¦‚éœ€è¦ä¿è¯3ä¸ªå˜é‡å…±åŒè¿›è¡ŒåŸå­æ€§çš„æ›´æ–°ï¼Œå°±ä¸å¾—ä¸ä½¿ç”¨Synchronizedäº†ã€‚ 3. ABAé—®é¢˜ å½“ä¸€ä¸ªå€¼ä»Aæ›´æ–°æˆBï¼Œåˆæ›´æ–°ä¼šAï¼Œæ™®é€šCASæœºåˆ¶ä¼šè¯¯åˆ¤é€šè¿‡æ£€æµ‹ã€‚åˆ©ç”¨ç‰ˆæœ¬å·æ¯”è¾ƒå¯ä»¥æœ‰æ•ˆè§£å†³ABAé—®é¢˜ã€‚ å‚è€ƒ æ¼«ç”»ï¼šä»€ä¹ˆæ˜¯CASæœºåˆ¶ï¼Ÿ æ¼«ç”»ï¼šä»€ä¹ˆæ˜¯CASæœºåˆ¶ï¼Ÿï¼ˆè¿›é˜¶ç¯‡ï¼‰ çº¿ç¨‹è¿›é˜¶ï¼šå¤šä»»åŠ¡å¤„ç†ï¼ˆ17ï¼‰â€”â€”Javaä¸­çš„é”ï¼ˆUnsafeåŸºç¡€ï¼‰","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"RESTful","slug":"RESTful","date":"2018-04-18T05:37:06.000Z","updated":"2018-04-24T06:26:40.095Z","comments":true,"path":"2018/04/18/RESTful/","link":"","permalink":"https://hsb786.github.io/2018/04/18/RESTful/","excerpt":"èµ·æºRESTè¿™ä¸ªè¯ï¼Œæ˜¯Roy Thomas Fieldingåœ¨ä»–2000å¹´çš„åšå£«è®ºæ–‡ä¸­æå‡ºçš„ã€‚Fieldingæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„äººï¼Œä»–æ˜¯HTTPåè®®ï¼ˆ1.0ç‰ˆå’Œ1.1ç‰ˆï¼‰çš„ä¸»è¦è®¾è®¡è€…ã€ApacheæœåŠ¡å™¨è½¯ä»¶çš„ä½œè€…ä¹‹ä¸€ã€ApacheåŸºé‡‘ä¼šçš„ç¬¬ä¸€ä»»ä¸»å¸­ã€‚æ‰€ä»¥ï¼Œä»–çš„è¿™ç¯‡è®ºæ–‡ä¸€ç»å‘è¡¨ï¼Œå°±å¼•èµ·äº†å…³æ³¨ï¼Œå¹¶ä¸”ç«‹å³å¯¹äº’è”ç½‘å¼€å‘äº§ç”Ÿäº†æ·±è¿œçš„å½±å“ã€‚ ä»–åœ¨è®ºæ–‡ä¸­æåˆ°ï¼š â€œæœ¬æ–‡ç ”ç©¶è®¡ç®—æœºç§‘å­¦ä¸¤å¤§å‰æ²¿â€”-è½¯ä»¶å’Œç½‘ç»œâ€”-çš„äº¤å‰ç‚¹ã€‚é•¿æœŸä»¥æ¥ï¼Œè½¯ä»¶ç ”ç©¶ä¸»è¦å…³æ³¨è½¯ä»¶è®¾è®¡çš„åˆ†ç±»ã€è®¾è®¡æ–¹æ³•çš„æ¼”åŒ–ï¼Œå¾ˆå°‘å®¢è§‚åœ°è¯„ä¼°ä¸åŒçš„è®¾è®¡é€‰æ‹©å¯¹ç³»ç»Ÿè¡Œä¸ºçš„å½±å“ã€‚è€Œç›¸ååœ°ï¼Œç½‘ç»œç ”ç©¶ä¸»è¦å…³æ³¨ç³»ç»Ÿä¹‹é—´é€šä¿¡è¡Œä¸ºçš„ç»†èŠ‚ã€å¦‚ä½•æ”¹è¿›ç‰¹å®šé€šä¿¡æœºåˆ¶çš„è¡¨ç°ï¼Œå¸¸å¸¸å¿½è§†äº†ä¸€ä¸ªäº‹å®ï¼Œé‚£å°±æ˜¯æ”¹å˜åº”ç”¨ç¨‹åºçš„äº’åŠ¨é£æ ¼æ¯”æ”¹å˜äº’åŠ¨åè®®ï¼Œå¯¹æ•´ä½“è¡¨ç°æœ‰æ›´å¤§çš„å½±å“ã€‚æˆ‘è¿™ç¯‡æ–‡ç« çš„å†™ä½œç›®çš„ï¼Œå°±æ˜¯æƒ³åœ¨ç¬¦åˆæ¶æ„åŸç†çš„å‰æä¸‹ï¼Œç†è§£å’Œè¯„ä¼°ä»¥ç½‘ç»œä¸ºåŸºç¡€çš„åº”ç”¨è½¯ä»¶çš„æ¶æ„è®¾è®¡ï¼Œå¾—åˆ°ä¸€ä¸ªåŠŸèƒ½å¼ºã€æ€§èƒ½å¥½ã€é€‚å®œé€šä¿¡çš„æ¶æ„ã€‚â€","text":"èµ·æºRESTè¿™ä¸ªè¯ï¼Œæ˜¯Roy Thomas Fieldingåœ¨ä»–2000å¹´çš„åšå£«è®ºæ–‡ä¸­æå‡ºçš„ã€‚Fieldingæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„äººï¼Œä»–æ˜¯HTTPåè®®ï¼ˆ1.0ç‰ˆå’Œ1.1ç‰ˆï¼‰çš„ä¸»è¦è®¾è®¡è€…ã€ApacheæœåŠ¡å™¨è½¯ä»¶çš„ä½œè€…ä¹‹ä¸€ã€ApacheåŸºé‡‘ä¼šçš„ç¬¬ä¸€ä»»ä¸»å¸­ã€‚æ‰€ä»¥ï¼Œä»–çš„è¿™ç¯‡è®ºæ–‡ä¸€ç»å‘è¡¨ï¼Œå°±å¼•èµ·äº†å…³æ³¨ï¼Œå¹¶ä¸”ç«‹å³å¯¹äº’è”ç½‘å¼€å‘äº§ç”Ÿäº†æ·±è¿œçš„å½±å“ã€‚ ä»–åœ¨è®ºæ–‡ä¸­æåˆ°ï¼š â€œæœ¬æ–‡ç ”ç©¶è®¡ç®—æœºç§‘å­¦ä¸¤å¤§å‰æ²¿â€”-è½¯ä»¶å’Œç½‘ç»œâ€”-çš„äº¤å‰ç‚¹ã€‚é•¿æœŸä»¥æ¥ï¼Œè½¯ä»¶ç ”ç©¶ä¸»è¦å…³æ³¨è½¯ä»¶è®¾è®¡çš„åˆ†ç±»ã€è®¾è®¡æ–¹æ³•çš„æ¼”åŒ–ï¼Œå¾ˆå°‘å®¢è§‚åœ°è¯„ä¼°ä¸åŒçš„è®¾è®¡é€‰æ‹©å¯¹ç³»ç»Ÿè¡Œä¸ºçš„å½±å“ã€‚è€Œç›¸ååœ°ï¼Œç½‘ç»œç ”ç©¶ä¸»è¦å…³æ³¨ç³»ç»Ÿä¹‹é—´é€šä¿¡è¡Œä¸ºçš„ç»†èŠ‚ã€å¦‚ä½•æ”¹è¿›ç‰¹å®šé€šä¿¡æœºåˆ¶çš„è¡¨ç°ï¼Œå¸¸å¸¸å¿½è§†äº†ä¸€ä¸ªäº‹å®ï¼Œé‚£å°±æ˜¯æ”¹å˜åº”ç”¨ç¨‹åºçš„äº’åŠ¨é£æ ¼æ¯”æ”¹å˜äº’åŠ¨åè®®ï¼Œå¯¹æ•´ä½“è¡¨ç°æœ‰æ›´å¤§çš„å½±å“ã€‚æˆ‘è¿™ç¯‡æ–‡ç« çš„å†™ä½œç›®çš„ï¼Œå°±æ˜¯æƒ³åœ¨ç¬¦åˆæ¶æ„åŸç†çš„å‰æä¸‹ï¼Œç†è§£å’Œè¯„ä¼°ä»¥ç½‘ç»œä¸ºåŸºç¡€çš„åº”ç”¨è½¯ä»¶çš„æ¶æ„è®¾è®¡ï¼Œå¾—åˆ°ä¸€ä¸ªåŠŸèƒ½å¼ºã€æ€§èƒ½å¥½ã€é€‚å®œé€šä¿¡çš„æ¶æ„ã€‚â€ RESTFieldingå°†ä»–å¯¹äº’è”ç½‘è½¯ä»¶çš„æ¶æ„åŸåˆ™ï¼Œå®šåä¸ºRESTï¼Œå³Representational State Transferï¼ˆè¡¨ç°å±‚çŠ¶æ€è½¬åŒ–ï¼‰çš„ç¼©å†™ã€‚ å¦‚æœä¸€ä¸ªæ¶æ„ç¬¦åˆRESTåŸåˆ™ï¼Œå°±ç§°å®ƒä¸ºRESTfulæ¶æ„ã€‚ èµ„æºï¼ˆResourcesï¼‰RESTçš„åç§°â€è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–â€ä¸­ï¼Œçœç•¥äº†ä¸»è¯­ã€‚â€è¡¨ç°å±‚â€å…¶å®æŒ‡çš„æ˜¯â€èµ„æºâ€ï¼ˆResourcesï¼‰çš„â€è¡¨ç°å±‚â€ã€‚ æ‰€è°“â€èµ„æºâ€ï¼Œå°±æ˜¯ç½‘ç»œä¸Šçš„ä¸€ä¸ªå®ä½“ï¼Œæˆ–è€…è¯´æ˜¯ç½‘ç»œä¸Šçš„ä¸€ä¸ªå…·ä½“ä¿¡æ¯ã€‚å®ƒå¯ä»¥æ˜¯ä¸€æ®µæ–‡æœ¬ã€ä¸€å¼ å›¾ç‰‡ã€ä¸€é¦–æ­Œæ›²ã€ä¸€ç§æœåŠ¡ï¼Œæ€»ä¹‹å°±æ˜¯ä¸€ä¸ªå…·ä½“çš„å®åœ¨ã€‚ä½ å¯ä»¥ç”¨ä¸€ä¸ªURIï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰æŒ‡å‘å®ƒï¼Œæ¯ç§èµ„æºå¯¹åº”ä¸€ä¸ªç‰¹å®šçš„URIã€‚è¦è·å–è¿™ä¸ªèµ„æºï¼Œè®¿é—®å®ƒçš„URIå°±å¯ä»¥ï¼Œå› æ­¤URIå°±æˆäº†æ¯ä¸€ä¸ªèµ„æºçš„åœ°å€æˆ–ç‹¬ä¸€æ— äºŒçš„è¯†åˆ«ç¬¦ã€‚ æ‰€è°“â€ä¸Šç½‘â€ï¼Œå°±æ˜¯ä¸äº’è”ç½‘ä¸Šä¸€ç³»åˆ—çš„â€èµ„æºâ€äº’åŠ¨ï¼Œè°ƒç”¨å®ƒçš„URIã€‚ è¡¨ç°å±‚ï¼ˆRepresentationï¼‰â€œèµ„æºâ€æ˜¯ä¸€ç§ä¿¡æ¯å®ä½“ï¼Œå®ƒå¯ä»¥æœ‰å¤šç§å¤–åœ¨è¡¨ç°å½¢å¼ã€‚æˆ‘ä»¬æŠŠâ€èµ„æºâ€å…·ä½“å‘ˆç°å‡ºæ¥çš„å½¢å¼ï¼Œå«åšå®ƒçš„â€è¡¨ç°å±‚â€ï¼ˆRepresentationï¼‰ã€‚ æ¯”å¦‚ï¼Œæ–‡æœ¬å¯ä»¥ç”¨txtæ ¼å¼è¡¨ç°ï¼Œä¹Ÿå¯ä»¥ç”¨HTMLæ ¼å¼ã€XMLæ ¼å¼ã€JSONæ ¼å¼è¡¨ç°ï¼Œç”šè‡³å¯ä»¥é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼›å›¾ç‰‡å¯ä»¥ç”¨JPGæ ¼å¼è¡¨ç°ï¼Œä¹Ÿå¯ä»¥ç”¨PNGæ ¼å¼è¡¨ç°ã€‚ URIåªä»£è¡¨èµ„æºçš„å®ä½“ï¼Œä¸ä»£è¡¨å®ƒçš„å½¢å¼ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œæœ‰äº›ç½‘å€æœ€åçš„â€.htmlâ€åç¼€åæ˜¯ä¸å¿…è¦çš„ï¼Œå› ä¸ºè¿™ä¸ªåç¼€åè¡¨ç¤ºæ ¼å¼ï¼Œå±äºâ€è¡¨ç°å±‚â€èŒƒç•´ï¼Œè€ŒURIåº”è¯¥åªä»£è¡¨â€èµ„æºâ€çš„ä½ç½®ã€‚å®ƒçš„å…·ä½“è¡¨ç°å½¢å¼ï¼Œåº”è¯¥åœ¨HTTPè¯·æ±‚çš„å¤´ä¿¡æ¯ä¸­ç”¨Acceptå’ŒContent-Typeå­—æ®µæŒ‡å®šï¼Œè¿™ä¸¤ä¸ªå­—æ®µæ‰æ˜¯å¯¹â€è¡¨ç°å±‚â€çš„æè¿°ã€‚ çŠ¶æ€è½¬åŒ–ï¼ˆState Transferï¼‰è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œå°±ä»£è¡¨äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„ä¸€ä¸ªäº’åŠ¨è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒåŠ¿å¿…æ¶‰åŠåˆ°æ•°æ®å’ŒçŠ¶æ€çš„å˜åŒ–ã€‚ äº’è”ç½‘é€šä¿¡åè®®HTTPåè®®ï¼Œæ˜¯ä¸€ä¸ªæ— çŠ¶æ€åè®®ã€‚è¿™æ„å‘³ç€ï¼Œæ‰€æœ‰çš„çŠ¶æ€éƒ½ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚å› æ­¤ï¼Œå¦‚æœå®¢æˆ·ç«¯æƒ³è¦æ“ä½œæœåŠ¡å™¨ï¼Œå¿…é¡»é€šè¿‡æŸç§æ‰‹æ®µï¼Œè®©æœåŠ¡å™¨ç«¯å‘ç”Ÿâ€çŠ¶æ€è½¬åŒ–â€ï¼ˆState Transferï¼‰ã€‚è€Œè¿™ç§è½¬åŒ–æ˜¯å»ºç«‹åœ¨è¡¨ç°å±‚ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥å°±æ˜¯â€è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–â€ã€‚ è¡¥å……HTTPåè®®ï¼Œæ˜¯ä¸€ä¸ªæ— çŠ¶æ€åè®®ï¼Œæ— çŠ¶æ€æ˜¯ä»€ä¹ˆæ„æ€å›ç­”1æœ‰çŠ¶æ€ï¼šAï¼šä½ ä»Šå¤©ä¸­åˆåƒçš„å•¥ï¼ŸBï¼šåƒçš„å¤§ç›˜é¸¡ã€‚Aï¼šå‘³é“æ€ä¹ˆæ ·å‘€ï¼ŸBï¼šè¿˜ä¸é”™ï¼ŒæŒºå¥½åƒçš„ã€‚ æ— çŠ¶æ€ï¼šAï¼šä½ ä»Šå¤©ä¸­åˆåƒçš„å•¥ï¼ŸBï¼šåƒçš„å¤§ç›˜é¸¡ã€‚Aï¼šå‘³é“æ€ä¹ˆæ ·å‘€ï¼ŸBï¼šï¼Ÿï¼Ÿï¼Ÿå•Šï¼Ÿå•¥ï¼Ÿå•¥å‘³é“æ€ä¹ˆæ ·ï¼Ÿ æ‰€ä»¥éœ€è¦cookieè¿™ç§ä¸œè¥¿ï¼šAï¼šä½ ä»Šå¤©ä¸­åˆåƒçš„å•¥ï¼ŸBï¼šåƒçš„å¤§ç›˜é¸¡ã€‚Aï¼šä½ ä»Šå¤©ä¸­åˆåƒçš„å¤§ç›˜é¸¡å‘³é“æ€ä¹ˆæ ·å‘€ï¼ŸBï¼šè¿˜ä¸é”™ï¼ŒæŒºå¥½åƒçš„ã€‚ å›ç­”2 åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ› å¯¹åŒä¸€ä¸ªurlè¯·æ±‚æ²¡æœ‰ä¸Šä¸‹æ–‡å…³ç³» æ¯æ¬¡çš„è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒçš„æ‰§è¡Œæƒ…å†µå’Œç»“æœä¸å‰é¢çš„è¯·æ±‚å’Œä¹‹åçš„è¯·æ±‚æ˜¯æ— ç›´æ¥å…³ç³»çš„ï¼Œå®ƒä¸ä¼šå—å‰é¢çš„è¯·æ±‚åº”ç­”æƒ…å†µç›´æ¥å½±å“ï¼Œä¹Ÿä¸ä¼šç›´æ¥å½±å“åé¢çš„è¯·æ±‚åº”ç­”æƒ…å†µ æœåŠ¡å™¨ä¸­æ²¡æœ‰ä¿å­˜å®¢æˆ·ç«¯çš„çŠ¶æ€ï¼Œå®¢æˆ·ç«¯å¿…é¡»æ¯æ¬¡å¸¦ä¸Šè‡ªå·±çš„çŠ¶æ€å»è¯·æ±‚æœåŠ¡å™¨ äººç”Ÿè‹¥åªå¦‚åˆè§ ã€çŠ¶æ€ã€‘çš„å«ä¹‰å°±æ˜¯ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨æŸæ¬¡ä¼šè¯ä¸­äº§ç”Ÿçš„æ•°æ®ï¼Œä»è€Œã€æ— çŠ¶æ€ã€‘å°±æ„å‘³ç€ï¼Œè¿™äº›æ•°æ®ä¸ä¼šè¢«ä¿ç•™ ä½†æ˜¯ï¼š é€šè¿‡å¢åŠ cookieå’Œsessionæœºåˆ¶ï¼Œç°åœ¨çš„ç½‘ç»œè¯·æ±‚å…¶å®æ˜¯æœ‰çŠ¶æ€çš„ åœ¨æ²¡æœ‰çŠ¶æ€çš„httpåè®®ä¸‹ï¼ŒæœåŠ¡å™¨ä¹Ÿä¸€å®šä¼šä¿ç•™ä½ æ¯æ¬¡ç½‘ç»œè¯·æ±‚å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œä½†è¿™è·Ÿä¿ç•™æ¯æ¬¡è®¿é—®çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¿ç•™çš„åªæ˜¯ä¼šè¯äº§ç”Ÿçš„ç»“æœï¼Œè€Œæ²¡æœ‰ä¿ç•™ä¼šè¯ è·¯å¾„ï¼ˆEndpointï¼‰è·¯å¾„åˆç§°â€ç»ˆç‚¹â€ï¼ˆendpointï¼‰ï¼Œè¡¨ç¤ºAPIçš„å…·ä½“ç½‘å€ã€‚ åœ¨RESTfulæ¶æ„ä¸­ï¼Œæ¯ä¸ªç½‘å€ä»£è¡¨ä¸€ç§èµ„æºï¼ˆresourceï¼‰ï¼Œæ‰€ä»¥ç½‘å€ä¸­ä¸èƒ½æœ‰åŠ¨è¯ï¼Œåªèƒ½æœ‰åè¯ï¼Œè€Œä¸”æ‰€ç”¨çš„åè¯å¾€å¾€ä¸æ•°æ®åº“çš„è¡¨æ ¼åå¯¹åº”ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®åº“ä¸­çš„è¡¨éƒ½æ˜¯åŒç§è®°å½•çš„â€é›†åˆâ€ï¼ˆcollectionï¼‰ï¼Œæ‰€ä»¥APIä¸­çš„åè¯ä¹Ÿåº”è¯¥ä½¿ç”¨å¤æ•°ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªAPIæä¾›åŠ¨ç‰©å›­ï¼ˆzooï¼‰çš„ä¿¡æ¯ï¼Œè¿˜åŒ…æ‹¬å„ç§åŠ¨ç‰©å’Œé›‡å‘˜çš„ä¿¡æ¯ï¼Œåˆ™å®ƒçš„è·¯å¾„åº”è¯¥è®¾è®¡æˆä¸‹é¢è¿™æ ·ã€‚ https://api.example.com/v1/zoos https://api.example.com/v1/animals https://api.example.com/v1/employees HTTPåŠ¨è¯å¯¹äºèµ„æºçš„å…·ä½“æ“ä½œç±»å‹ï¼Œç”±HTTPåŠ¨è¯è¡¨ç¤ºã€‚ å¸¸ç”¨çš„HTTPåŠ¨è¯æœ‰ä¸‹é¢äº”ä¸ªï¼ˆæ‹¬å·é‡Œæ˜¯å¯¹åº”çš„SQLå‘½ä»¤ï¼‰ã€‚ GETï¼ˆSELECTï¼‰ï¼šä»æœåŠ¡å™¨å–å‡ºèµ„æºï¼ˆä¸€é¡¹æˆ–å¤šé¡¹ï¼‰ã€‚ POSTï¼ˆCREATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªèµ„æºã€‚ PUTï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜åçš„å®Œæ•´èµ„æºï¼‰ã€‚ PATCHï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜çš„å±æ€§ï¼‰ã€‚ DELETEï¼ˆDELETEï¼‰ï¼šä»æœåŠ¡å™¨åˆ é™¤èµ„æºã€‚ ä¾‹å­ GET /zoosï¼šåˆ—å‡ºæ‰€æœ‰åŠ¨ç‰©å›­ POST /zoosï¼šæ–°å»ºä¸€ä¸ªåŠ¨ç‰©å›­ GET /zoos/IDï¼šè·å–æŸä¸ªæŒ‡å®šåŠ¨ç‰©å›­çš„ä¿¡æ¯ PUT /zoos/IDï¼šæ›´æ–°æŸä¸ªæŒ‡å®šåŠ¨ç‰©å›­çš„ä¿¡æ¯ï¼ˆæä¾›è¯¥åŠ¨ç‰©å›­çš„å…¨éƒ¨ä¿¡æ¯ï¼‰ PATCH /zoos/IDï¼šæ›´æ–°æŸä¸ªæŒ‡å®šåŠ¨ç‰©å›­çš„ä¿¡æ¯ï¼ˆæä¾›è¯¥åŠ¨ç‰©å›­çš„éƒ¨åˆ†ä¿¡æ¯ï¼‰ DELETE /zoos/IDï¼šåˆ é™¤æŸä¸ªåŠ¨ç‰©å›­ GET /zoos/ID/animalsï¼šåˆ—å‡ºæŸä¸ªæŒ‡å®šåŠ¨ç‰©å›­çš„æ‰€æœ‰åŠ¨ç‰© DELETE /zoos/ID/animals/IDï¼šåˆ é™¤æŸä¸ªæŒ‡å®šåŠ¨ç‰©å›­çš„æŒ‡å®šåŠ¨ç‰© è¿‡æ»¤ä¿¡æ¯ï¼ˆFilteringï¼‰å¦‚æœè®°å½•æ•°é‡å¾ˆå¤šï¼ŒæœåŠ¡å™¨ä¸å¯èƒ½éƒ½å°†å®ƒä»¬è¿”å›ç»™ç”¨æˆ·ã€‚APIåº”è¯¥æä¾›å‚æ•°ï¼Œè¿‡æ»¤è¿”å›ç»“æœã€‚ ?limit=10ï¼šæŒ‡å®šè¿”å›è®°å½•çš„æ•°é‡ ?offset=10ï¼šæŒ‡å®šè¿”å›è®°å½•çš„å¼€å§‹ä½ç½®ã€‚ ?page=2&amp;per_page=100ï¼šæŒ‡å®šç¬¬å‡ é¡µï¼Œä»¥åŠæ¯é¡µçš„è®°å½•æ•°ã€‚ ?sortby=name&amp;order=ascï¼šæŒ‡å®šè¿”å›ç»“æœæŒ‰ç…§å“ªä¸ªå±æ€§æ’åºï¼Œä»¥åŠæ’åºé¡ºåºã€‚ ?animal_type_id=1ï¼šæŒ‡å®šç­›é€‰æ¡ä»¶ çŠ¶æ€ç ï¼ˆStatus Codesï¼‰æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›çš„çŠ¶æ€ç å’Œæç¤ºä¿¡æ¯ï¼Œå¸¸è§çš„æœ‰ä»¥ä¸‹ä¸€äº›ï¼ˆæ–¹æ‹¬å·ä¸­æ˜¯è¯¥çŠ¶æ€ç å¯¹åº”çš„HTTPåŠ¨è¯ï¼‰ã€‚ 200 OK - [GET]ï¼šæœåŠ¡å™¨æˆåŠŸè¿”å›ç”¨æˆ·è¯·æ±‚çš„æ•°æ®ï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼ˆIdempotentï¼‰ã€‚ 201 CREATED - [POST/PUT/PATCH]ï¼šç”¨æˆ·æ–°å»ºæˆ–ä¿®æ”¹æ•°æ®æˆåŠŸã€‚ 202 Accepted - [*]ï¼šè¡¨ç¤ºä¸€ä¸ªè¯·æ±‚å·²ç»è¿›å…¥åå°æ’é˜Ÿï¼ˆå¼‚æ­¥ä»»åŠ¡ï¼‰ 204 NO CONTENT - [DELETE]ï¼šç”¨æˆ·åˆ é™¤æ•°æ®æˆåŠŸã€‚ 400 INVALID REQUEST - [POST/PUT/PATCH]ï¼šç”¨æˆ·å‘å‡ºçš„è¯·æ±‚æœ‰é”™è¯¯ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ–°å»ºæˆ–ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ã€‚ 401 Unauthorized - [*]ï¼šè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰æƒé™ï¼ˆä»¤ç‰Œã€ç”¨æˆ·åã€å¯†ç é”™è¯¯ï¼‰ã€‚ 403 Forbidden - [*] è¡¨ç¤ºç”¨æˆ·å¾—åˆ°æˆæƒï¼ˆä¸401é”™è¯¯ç›¸å¯¹ï¼‰ï¼Œä½†æ˜¯è®¿é—®æ˜¯è¢«ç¦æ­¢çš„ã€‚ 404 NOT FOUND - [*]ï¼šç”¨æˆ·å‘å‡ºçš„è¯·æ±‚é’ˆå¯¹çš„æ˜¯ä¸å­˜åœ¨çš„è®°å½•ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ“ä½œï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ã€‚ 406 Not Acceptable - [GET]ï¼šç”¨æˆ·è¯·æ±‚çš„æ ¼å¼ä¸å¯å¾—ï¼ˆæ¯”å¦‚ç”¨æˆ·è¯·æ±‚JSONæ ¼å¼ï¼Œä½†æ˜¯åªæœ‰XMLæ ¼å¼ï¼‰ã€‚ 410 Gone -[GET]ï¼šç”¨æˆ·è¯·æ±‚çš„èµ„æºè¢«æ°¸ä¹…åˆ é™¤ï¼Œä¸”ä¸ä¼šå†å¾—åˆ°çš„ã€‚ 422 Unprocesable entity - [POST/PUT/PATCH] å½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå‘ç”Ÿä¸€ä¸ªéªŒè¯é”™è¯¯ã€‚ 500 INTERNAL SERVER ERROR - [*]ï¼šæœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œç”¨æˆ·å°†æ— æ³•åˆ¤æ–­å‘å‡ºçš„è¯·æ±‚æ˜¯å¦æˆåŠŸã€‚ è¿”å›ç»“æœé’ˆå¯¹ä¸åŒæ“ä½œï¼ŒæœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›çš„ç»“æœåº”è¯¥ç¬¦åˆä»¥ä¸‹è§„èŒƒã€‚ GET /collectionï¼šè¿”å›èµ„æºå¯¹è±¡çš„åˆ—è¡¨ï¼ˆæ•°ç»„ï¼‰ GET /collection/resourceï¼šè¿”å›å•ä¸ªèµ„æºå¯¹è±¡ POST /collectionï¼šè¿”å›æ–°ç”Ÿæˆçš„èµ„æºå¯¹è±¡ PUT /collection/resourceï¼šè¿”å›å®Œæ•´çš„èµ„æºå¯¹è±¡ PATCH /collection/resourceï¼šè¿”å›å®Œæ•´çš„èµ„æºå¯¹è±¡ DELETE /collection/resourceï¼šè¿”å›ä¸€ä¸ªç©ºæ–‡æ¡£ æ€»ç»“ æ¯ä¸€ä¸ªURIä»£è¡¨ä¸€ç§èµ„æºï¼› å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ï¼Œä¼ é€’è¿™ç§èµ„æºçš„æŸç§è¡¨ç°å±‚ï¼› å®¢æˆ·ç«¯é€šè¿‡HTTPåŠ¨è¯ï¼Œå¯¹æœåŠ¡å™¨ç«¯èµ„æºè¿›è¡Œæ“ä½œï¼Œå®ç°â€è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–â€ã€‚ å‚è€ƒ ç†è§£RESTfulæ¶æ„ HTTPæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„åè®®ã€‚è¿™å¥è¯é‡Œçš„æ— çŠ¶æ€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ httpåè®®æ— çŠ¶æ€ä¸­çš„ â€œçŠ¶æ€â€ åˆ°åº•æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿï¼ RESTful API è®¾è®¡æŒ‡å—","categories":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/categories/HTTP/"}],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/tags/HTTP/"}]},{"title":"åŸºæœ¬æ’åºç®—æ³•","slug":"åŸºæœ¬æ’åºç®—æ³•","date":"2018-04-18T04:27:50.000Z","updated":"2018-04-20T13:21:43.798Z","comments":true,"path":"2018/04/18/åŸºæœ¬æ’åºç®—æ³•/","link":"","permalink":"https://hsb786.github.io/2018/04/18/åŸºæœ¬æ’åºç®—æ³•/","excerpt":"å¿«é€Ÿæ’åºåŸºæœ¬æ€æƒ³ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ï¼Œç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºï¼Œæ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œï¼Œä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—","text":"å¿«é€Ÿæ’åºåŸºæœ¬æ€æƒ³ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ï¼Œç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºï¼Œæ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œï¼Œä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—123456789101112131415161718192021222324252627282930313233static void quickSort(int[] array) &#123; quickSort(array, 0, array.length - 1);&#125;static void quickSort(int[] array, int left, int right) &#123; if (left &gt;= right) &#123; return; &#125; int mid = partion(array, left, right); quickSort(array, left, mid - 1); quickSort(array, mid + 1, right);&#125;static int partion(int[] array, int left, int right) &#123; // å–ç¬¬ä¸€ä¸ªæ•°ä¸ºåŸºå‡†å…ƒç´  int tmp = array[left]; while (left &lt; right) &#123; while (left &lt; right &amp;&amp; array[right] &gt;= tmp) &#123; right--; &#125; // æ¯”åŸºå‡†å…ƒç´ å°çš„ç§»åŠ¨åˆ°ä½ç«¯ array[left] = array[right]; while (left &lt; right &amp;&amp; array[left] &lt;= tmp) &#123; left++; &#125; // æ¯”åŸºå‡†å…ƒç´ å¤§çš„ç§»åŠ¨åˆ°é«˜ç«¯ array[right] = array[left]; &#125; // æ’å…¥åŸºå‡†å…ƒç´  array[left] = tmp; return left;&#125; å½’å¹¶æ’åºåŸºæœ¬æ€æƒ³ï¼šå½’å¹¶æ’åºï¼ˆMERGE-SORTï¼‰æ˜¯å»ºç«‹åœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•,è¯¥ç®—æ³•æ˜¯é‡‡ç”¨åˆ†æ²»æ³•ï¼ˆDivide and Conquerï¼‰çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨ã€‚å°†å·²æœ‰åºçš„å­åºåˆ—åˆå¹¶ï¼Œå¾—åˆ°å®Œå…¨æœ‰åºçš„åºåˆ— 12345678910111213141516171819202122232425262728293031323334353637static void mergeSort(int[] arr) &#123; int[] temp = new int[arr.length]; mergeSort(arr, 0, arr.length - 1, temp);&#125;static void mergeSort(int[] arr, int left, int right, int[] temp) &#123; if (left &lt; right) &#123; int mid = (left + right) / 2; mergeSort(arr, left, mid, temp);// å·¦è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å·¦å­åºåˆ—æœ‰åº mergeSort(arr, mid + 1, right, temp);// å³è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å³å­åºåˆ—æœ‰åº merge(arr, left, mid, right, temp);// å°†ä¸¤ä¸ªæœ‰åºå­æ•°ç»„åˆå¹¶æ“ä½œ &#125;&#125;static void merge(int[] arr, int left, int mid, int right, int[] temp) &#123; int i = left;// å·¦åºåˆ—æŒ‡é’ˆ int j = mid + 1;// å³åºåˆ—æŒ‡é’ˆ int t = 0;// ä¸´æ—¶æ•°ç»„æŒ‡é’ˆ while (i &lt;= mid &amp;&amp; j &lt;= right) &#123; if (arr[i] &lt;= arr[j]) &#123; temp[t++] = arr[i++]; &#125; else &#123; temp[t++] = arr[j++]; &#125; &#125; while (i &lt;= mid) &#123;// å°†å·¦è¾¹å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­ temp[t++] = arr[i++]; &#125; while (j &lt;= right) &#123;// å°†å³åºåˆ—å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­ temp[t++] = arr[j++]; &#125; t = 0; // å°†tempä¸­çš„å…ƒç´ å…¨éƒ¨æ‹·è´åˆ°åŸæ•°ç»„ä¸­ while (left &lt;= right) &#123; arr[left++] = temp[t++]; &#125;&#125;","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/categories/ç®—æ³•/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hsb786.github.io/tags/ç®—æ³•/"}]},{"title":"ä»£ç†æ¨¡å¼","slug":"ä»£ç†æ¨¡å¼","date":"2018-04-17T10:21:28.000Z","updated":"2018-04-20T13:20:26.051Z","comments":true,"path":"2018/04/17/ä»£ç†æ¨¡å¼/","link":"","permalink":"https://hsb786.github.io/2018/04/17/ä»£ç†æ¨¡å¼/","excerpt":"ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®","text":"ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—® ä¼˜ç‚¹ ä»£ç†å¯¹è±¡å¯ä»¥åœ¨ç›®æ ‡å¯¹è±¡å®ç°çš„åŸºç¡€ä¸Š,å¢å¼ºé¢å¤–çš„åŠŸèƒ½æ“ä½œ,å³æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ ä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ï¼Œè¿™æ ·èµ·åˆ°äº†ä¸­ä»‹çš„ä½œç”¨å’Œä¿æŠ¤äº†ç›®æ ‡å¯¹è±¡çš„ä½œç”¨ã€‚ ä»£ç†ç±»åˆ†ç±» é™æ€ä»£ç†:é™æ€å®šä¹‰ä»£ç†ç±»ï¼Œæˆ‘ä»¬è‡ªå·±é™æ€å®šä¹‰çš„ä»£ç†ç±»ã€‚ åŠ¨æ€ä»£ç†:é€šè¿‡ç¨‹åºåŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œè¯¥ä»£ç†ç±»ä¸æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ï¼Œè€Œæ˜¯ç”±ç¨‹åºè‡ªåŠ¨ç”Ÿæˆï¼Œå¸¸ç”¨çš„åŠ¨æ€ä»£ç†æŠ€æœ¯æœ‰JDKè‡ªå¸¦çš„åŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†ã€‚ *å‚è€ƒ ä»£ç†æ¨¡å¼","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/categories/è®¾è®¡æ¨¡å¼/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"ç­–ç•¥æ¨¡å¼","slug":"ç­–ç•¥æ¨¡å¼","date":"2018-04-17T10:07:27.000Z","updated":"2018-04-20T13:20:07.750Z","comments":true,"path":"2018/04/17/ç­–ç•¥æ¨¡å¼/","link":"","permalink":"https://hsb786.github.io/2018/04/17/ç­–ç•¥æ¨¡å¼/","excerpt":"ç­–ç•¥æ¨¡å¼(Strategy Pattern)ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ï¼Œä¹Ÿç§°ä¸ºæ”¿ç­–æ¨¡å¼(Policy)ã€‚ æ ¹æ®æ¡ä»¶çš„ä¸åŒé€‰æ‹©ä¸åŒçš„ç­–ç•¥","text":"ç­–ç•¥æ¨¡å¼(Strategy Pattern)ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ï¼Œä¹Ÿç§°ä¸ºæ”¿ç­–æ¨¡å¼(Policy)ã€‚ æ ¹æ®æ¡ä»¶çš„ä¸åŒé€‰æ‹©ä¸åŒçš„ç­–ç•¥ ä¼˜ç‚¹ ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹â€œå¼€é—­åŸåˆ™â€çš„å®Œç¾æ”¯æŒï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ç³»ç»Ÿçš„åŸºç¡€ä¸Šé€‰æ‹©ç®—æ³•æˆ–è¡Œä¸ºï¼Œä¹Ÿå¯ä»¥çµæ´»åœ°å¢åŠ æ–°çš„ç®—æ³•æˆ–è¡Œä¸ºã€‚ ç­–ç•¥æ¨¡å¼æä¾›äº†ç®¡ç†ç›¸å…³çš„ç®—æ³•æ—çš„åŠæ³•ã€‚ç­–ç•¥ç±»çš„ç­‰çº§ç»“æ„å®šä¹‰äº†ä¸€ä¸ªç®—æ³•æˆ–è¡Œä¸ºæ—ã€‚æ°å½“ä½¿ç”¨ç»§æ‰¿å¯ä»¥æŠŠå…¬å…±çš„ä»£ç ç§»åˆ°çˆ¶ç±»é‡Œé¢ï¼Œä»è€Œé¿å…ä»£ç é‡å¤ã€‚ ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶(if-else)è¯­å¥ã€‚å¤šé‡æ¡ä»¶è¯­å¥ä¸æ˜“ç»´æŠ¤ï¼Œå®ƒæŠŠé‡‡å–å“ªä¸€ç§ç®—æ³•æˆ–é‡‡å–å“ªä¸€ç§è¡Œä¸ºçš„é€»è¾‘ä¸ç®—æ³•æˆ–è¡Œä¸ºçš„é€»è¾‘æ··åˆåœ¨ä¸€èµ·ï¼Œç»Ÿç»Ÿåˆ—åœ¨ä¸€ä¸ªå¤šé‡æ¡ä»¶è¯­å¥é‡Œé¢ï¼Œæ¯”ä½¿ç”¨ç»§æ‰¿çš„åŠæ³•è¿˜è¦åŸå§‹å’Œè½åã€‚ ç¼ºç‚¹ å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»ã€‚è¿™å°±æ„å‘³ç€å®¢æˆ·ç«¯å¿…é¡»ç†è§£è¿™äº›ç®—æ³•çš„åŒºåˆ«ï¼Œä»¥ä¾¿é€‚æ—¶é€‰æ‹©æ°å½“çš„ç®—æ³•ç±»ã€‚ ç”±äºç­–ç•¥æ¨¡å¼æŠŠæ¯ä¸ªå…·ä½“çš„ç­–ç•¥å®ç°éƒ½å•ç‹¬å°è£…æˆä¸ºç±»ï¼Œå¦‚æœå¤‡é€‰çš„ç­–ç•¥å¾ˆå¤šçš„è¯ï¼Œé‚£ä¹ˆå¯¹è±¡çš„æ•°ç›®å°±ä¼šå¾ˆå¯è§‚ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨äº«å…ƒæ¨¡å¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘å¯¹è±¡çš„æ•°é‡ã€‚ å‚è€ƒ è®¾è®¡æ¨¡å¼ï¼ˆåäºŒï¼‰â€”â€”ç­–ç•¥æ¨¡å¼","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/categories/è®¾è®¡æ¨¡å¼/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"æŠ½è±¡å·¥å‚","slug":"æŠ½è±¡å·¥å‚","date":"2018-04-17T09:17:08.000Z","updated":"2018-04-20T13:20:15.747Z","comments":true,"path":"2018/04/17/æŠ½è±¡å·¥å‚/","link":"","permalink":"https://hsb786.github.io/2018/04/17/æŠ½è±¡å·¥å‚/","excerpt":"æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— é¡»æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼åˆç§°ä¸ºKitæ¨¡å¼ï¼Œå±äºå¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚ å°†åŒä¸€äº§å“æ—çš„å•ç‹¬çš„å·¥å‚å°è£…èµ·æ¥ã€‚é€šè¿‡åˆ›å»ºæŠ½è±¡å·¥å‚çš„å…·ä½“å®ç°ï¼Œç„¶åä½¿ç”¨æŠ½è±¡å·¥å‚åšä¸ºæ¥å£æ¥åˆ›å»ºè¿™ä¸€äº§å“æ—çš„å…·ä½“å¯¹è±¡ã€‚","text":"æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— é¡»æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼åˆç§°ä¸ºKitæ¨¡å¼ï¼Œå±äºå¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚ å°†åŒä¸€äº§å“æ—çš„å•ç‹¬çš„å·¥å‚å°è£…èµ·æ¥ã€‚é€šè¿‡åˆ›å»ºæŠ½è±¡å·¥å‚çš„å…·ä½“å®ç°ï¼Œç„¶åä½¿ç”¨æŠ½è±¡å·¥å‚åšä¸ºæ¥å£æ¥åˆ›å»ºè¿™ä¸€äº§å“æ—çš„å…·ä½“å¯¹è±¡ã€‚ äº§å“ç­‰çº§ç»“æ„å’Œäº§å“æ—äº§å“ç­‰çº§ç»“æ„ï¼š äº§å“ç­‰çº§ç»“æ„å³äº§å“çš„ç»§æ‰¿ç»“æ„ï¼ŒåŒä¸€ç±»äº§å“ï¼Œå¦‚ä¸€ä¸ªæŠ½è±¡ç±»æ˜¯ç”µè§†æœºï¼Œå…¶å­ç±»æœ‰æµ·å°”ç”µè§†æœºã€æµ·ä¿¡ç”µè§†æœºã€TCLç”µè§†æœºï¼Œåˆ™æŠ½è±¡ç”µè§†æœºä¸å…·ä½“å“ç‰Œçš„ç”µè§†æœºä¹‹é—´æ„æˆäº†ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼ŒæŠ½è±¡ç”µè§†æœºæ˜¯çˆ¶ç±»ï¼Œè€Œå…·ä½“å“ç‰Œçš„ç”µè§†æœºæ˜¯å…¶å­ç±»ã€‚ äº§å“æ—ï¼šåœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œäº§å“æ—æ˜¯æŒ‡ç”±åŒä¸€ä¸ªå·¥å‚ç”Ÿäº§çš„ï¼ŒåŒä¸€ä¸ªå“ç‰Œäº§å“ï¼Œä½äºä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­çš„ä¸€ç»„äº§å“ï¼Œå¦‚æµ·å°”ç”µå™¨å·¥å‚ç”Ÿäº§çš„æµ·å°”ç”µè§†æœºã€æµ·å°”ç”µå†°ç®±ï¼Œæµ·å°”ç”µè§†æœºä½äºç”µè§†æœºäº§å“ç­‰çº§ç»“æ„ä¸­ï¼Œæµ·å°”ç”µå†°ç®±ä½äºç”µå†°ç®±äº§å“ç­‰çº§ç»“æ„ä¸­ã€‚ æŠ½è±¡å·¥å‚ä¸å·¥å‚æ–¹æ³•æŠ½è±¡å·¥å‚å’Œå·¥å‚æ–¹æ³•æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œå·¥å‚æ–¹æ³•é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼åˆ™éœ€è¦é¢å¯¹å¤šä¸ªäº§å“ç­‰çº§ç»“æ„ã€‚ å·¥å‚æ–¹æ³•ï¼šç”¨æ¥ç”Ÿäº§åŒä¸€ç­‰çº§ç»“æ„ä¸­çš„å›ºå®šäº§å“ï¼ˆæ”¯æŒå¢åŠ ä»»æ„äº§å“ï¼Œæ–°å¢äº§å“æ˜¯ä¸éœ€è¦æ›´æ”¹å·²æœ‰çš„å·¥ç¨‹ï¼Œéœ€è¦å¢åŠ è¯¥äº§å“å¯¹åº”çš„å·¥ç¨‹ã€‚ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€ç¬¦åˆå¼€é—­åŸåˆ™ã€‚ä½†æ˜¯å¼•å…¥äº†å¤æ‚æ€§ï¼‰ æŠ½è±¡å·¥å‚ï¼šç”¨æ¥ç”Ÿäº§ä¸åŒäº§å“æ—çš„å…¨éƒ¨äº§å“ã€‚ï¼ˆå¢åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ä¿®æ”¹å·¥å‚ï¼Œå¢åŠ äº§å“æ—æ—¶ï¼Œéœ€è¦å¢åŠ å·¥å‚ã€‚ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œéƒ¨åˆ†ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œé™ä½äº†å¤æ‚æ€§ï¼‰ ä¼˜ç‚¹æ¯æ¬¡å¯ä»¥é€šè¿‡å…·ä½“å·¥å‚ç±»åˆ›å»ºä¸€ä¸ªäº§å“æ—çš„å¤šä¸ªå¯¹è±¡ï¼Œå¢åŠ æ–°çš„å…·ä½“å·¥å‚å’Œäº§å“æ—å¾ˆæ–¹ä¾¿ã€‚ ç¼ºç‚¹å¢åŠ æ–°çš„äº§å“ç­‰çº§ç»“æ„å¾ˆå¤æ‚ï¼Œéœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚å’Œæ‰€æœ‰çš„å…·ä½“å·¥å‚ç±»ã€‚ å‚è€ƒ å·¥å‚æ¨¡å¼-ä¸‹ è®¾è®¡æ¨¡å¼ï¼ˆå…«ï¼‰â€”â€”å·¥å‚æ¨¡å¼æ€»ç»“è®¾è®¡æ¨¡å¼ï¼ˆä¸ƒï¼‰â€”â€”æŠ½è±¡å·¥å‚æ¨¡å¼","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/categories/è®¾è®¡æ¨¡å¼/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"å·¥å‚æ–¹æ³•","slug":"å·¥å‚æ–¹æ³•","date":"2018-04-17T09:05:30.000Z","updated":"2018-04-20T13:21:25.925Z","comments":true,"path":"2018/04/17/å·¥å‚æ–¹æ³•/","link":"","permalink":"https://hsb786.github.io/2018/04/17/å·¥å‚æ–¹æ³•/","excerpt":"å®šä¹‰äº†ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method Pattern)åˆç§°ä¸ºå·¥å‚æ¨¡å¼ï¼Œä¹Ÿå«è™šæ‹Ÿæ„é€ å™¨(Virtual Constructor)æ¨¡å¼æˆ–è€…å¤šæ€å·¥å‚(Polymorphic Factory)æ¨¡å¼ï¼Œå®ƒå±äºç±»åˆ›å»ºå‹æ¨¡å¼ã€‚","text":"å®šä¹‰äº†ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method Pattern)åˆç§°ä¸ºå·¥å‚æ¨¡å¼ï¼Œä¹Ÿå«è™šæ‹Ÿæ„é€ å™¨(Virtual Constructor)æ¨¡å¼æˆ–è€…å¤šæ€å·¥å‚(Polymorphic Factory)æ¨¡å¼ï¼Œå®ƒå±äºç±»åˆ›å»ºå‹æ¨¡å¼ã€‚ ä¼˜ç‚¹ åœ¨ç³»ç»Ÿä¸­åŠ å…¥æ–°äº§å“æ—¶ï¼Œæ— é¡»ä¿®æ”¹æŠ½è±¡å·¥å‚å’ŒæŠ½è±¡äº§å“æä¾›çš„æ¥å£ï¼Œä¹Ÿæ— é¡»ä¿®æ”¹å…¶ä»–çš„å…·ä½“å·¥å‚å’Œå…·ä½“äº§å“ï¼Œè€Œåªè¦æ·»åŠ ä¸€ä¸ªå…·ä½“å·¥å‚å’Œå…·ä½“äº§å“å°±å¯ä»¥äº†ã€‚è¿™æ ·ï¼Œç³»ç»Ÿçš„å¯æ‰©å±•æ€§ä¹Ÿå°±å˜å¾—éå¸¸å¥½ï¼Œå®Œå…¨ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚ åŸºäºå·¥å‚è§’è‰²å’Œäº§å“è§’è‰²çš„å¤šæ€æ€§è®¾è®¡æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„å…³é”®ã€‚å®ƒèƒ½å¤Ÿä½¿å·¥å‚å¯ä»¥è‡ªä¸»ç¡®å®šåˆ›å»ºä½•ç§äº§å“å¯¹è±¡ï¼Œè€Œå¦‚ä½•åˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„ç»†èŠ‚åˆ™å®Œå…¨å°è£…åœ¨å…·ä½“å·¥å‚å†…éƒ¨ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼ä¹‹æ‰€ä»¥åˆè¢«ç§°ä¸ºå¤šæ€å·¥å‚æ¨¡å¼ï¼Œæ˜¯å› ä¸ºæ‰€æœ‰çš„å…·ä½“å·¥å‚ç±»éƒ½å…·æœ‰åŒä¸€æŠ½è±¡çˆ¶ç±»ã€‚ ç¼ºç‚¹åœ¨æ·»åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ç¼–å†™æ–°çš„å…·ä½“äº§å“ç±»ï¼Œè€Œä¸”è¿˜è¦æä¾›ä¸ä¹‹å¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°å°†æˆå¯¹å¢åŠ ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œæœ‰æ›´å¤šçš„ç±»éœ€è¦ç¼–è¯‘å’Œè¿è¡Œï¼Œä¼šç»™ç³»ç»Ÿå¸¦æ¥ä¸€äº›é¢å¤–çš„å¼€é”€ã€‚ å‚è€ƒ å·¥å‚æ¨¡å¼(ä¸Š) è®¾è®¡æ¨¡å¼ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼ è®¾è®¡æ¨¡å¼ï¼ˆäº”ï¼‰â€”â€”å·¥å‚æ–¹æ³•æ¨¡å¼","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/categories/è®¾è®¡æ¨¡å¼/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"ClassLoader","slug":"ClassLoader","date":"2018-04-16T12:21:34.000Z","updated":"2018-04-24T06:31:55.684Z","comments":true,"path":"2018/04/16/ClassLoader/","link":"","permalink":"https://hsb786.github.io/2018/04/16/ClassLoader/","excerpt":"Javaä¸­çš„æ‰€æœ‰ç±»ï¼Œå¿…é¡»è¢«è£…è½½åˆ°jvmä¸­æ‰èƒ½è¿è¡Œï¼Œè¿™ä¸ªè£…è½½å·¥ä½œæ˜¯ç”±jvmä¸­çš„ç±»è£…è½½å™¨å®Œæˆçš„ï¼Œç±»è£…è½½å™¨æ‰€åšçš„å·¥ä½œå®è´¨æ˜¯æŠŠç±»æ–‡ä»¶ä»ç¡¬ç›˜è¯»å–åˆ°å†…å­˜ä¸­ï¼ŒJVMåœ¨åŠ è½½ç±»çš„æ—¶å€™ï¼Œéƒ½æ˜¯é€šè¿‡ClassLoaderçš„loadClassï¼ˆï¼‰æ–¹æ³•æ¥åŠ è½½classçš„ï¼ŒloadClassä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å¼ã€‚","text":"Javaä¸­çš„æ‰€æœ‰ç±»ï¼Œå¿…é¡»è¢«è£…è½½åˆ°jvmä¸­æ‰èƒ½è¿è¡Œï¼Œè¿™ä¸ªè£…è½½å·¥ä½œæ˜¯ç”±jvmä¸­çš„ç±»è£…è½½å™¨å®Œæˆçš„ï¼Œç±»è£…è½½å™¨æ‰€åšçš„å·¥ä½œå®è´¨æ˜¯æŠŠç±»æ–‡ä»¶ä»ç¡¬ç›˜è¯»å–åˆ°å†…å­˜ä¸­ï¼ŒJVMåœ¨åŠ è½½ç±»çš„æ—¶å€™ï¼Œéƒ½æ˜¯é€šè¿‡ClassLoaderçš„loadClassï¼ˆï¼‰æ–¹æ³•æ¥åŠ è½½classçš„ï¼ŒloadClassä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å¼ã€‚ public abstract class ClassLoader class loaderæ˜¯ä¸€ä¸ªè´Ÿè´£åŠ è½½classesçš„å¯¹è±¡ï¼ŒClassLoaderç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œéœ€è¦ç»™å‡ºç±»çš„äºŒè¿›åˆ¶åç§°ï¼Œclass loaderå°è¯•å®šä½æˆ–è€…äº§ç”Ÿä¸€ä¸ªclassçš„æ•°æ®ï¼Œä¸€ä¸ªå…¸å‹çš„ç­–ç•¥æ˜¯æŠŠäºŒè¿›åˆ¶åå­—è½¬æ¢æˆæ–‡ä»¶åç„¶ååˆ°æ–‡ä»¶ç³»ç»Ÿä¸­æ‰¾åˆ°è¯¥æ–‡ä»¶ã€‚ 12345678910111213141516171819202122232425262728293031323334353637protected Class&lt;?&gt; loadClass(String name, boolean resolve) throws ClassNotFoundException &#123; synchronized (getClassLoadingLock(name)) &#123; // First, check if the class has already been loaded Class&lt;?&gt; c = findLoadedClass(name); if (c == null) &#123; long t0 = System.nanoTime(); try &#123; if (parent != null) &#123; c = parent.loadClass(name, false); &#125; else &#123; c = findBootstrapClassOrNull(name); &#125; &#125; catch (ClassNotFoundException e) &#123; // ClassNotFoundException thrown if class not found // from the non-null parent class loader &#125; if (c == null) &#123; // If still not found, then invoke findClass in order // to find the class. long t1 = System.nanoTime(); c = findClass(name); // this is the defining class loader; record the stats sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0); sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1); sun.misc.PerfCounter.getFindClasses().increment(); &#125; &#125; if (resolve) &#123; resolveClass(c); &#125; return c; &#125; &#125; ä½¿ç”¨æŒ‡å®šçš„äºŒè¿›åˆ¶åç§°æ¥åŠ è½½ç±»ï¼Œè¿™ä¸ªæ–¹æ³•çš„é»˜è®¤å®ç°æŒ‰ç…§ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾ç±»ï¼š è°ƒç”¨findLoadedClass(String)æ–¹æ³•æ£€æŸ¥è¿™ä¸ªç±»æ˜¯å¦è¢«åŠ è½½è¿‡ ä½¿ç”¨çˆ¶åŠ è½½å™¨è°ƒç”¨loadClass(String)æ–¹æ³•ï¼Œå¦‚æœçˆ¶åŠ è½½å™¨ä¸ºNullï¼Œç±»åŠ è½½å™¨è£…è½½è™šæ‹Ÿæœºå†…ç½®çš„åŠ è½½å™¨è°ƒç”¨findClass(String)æ–¹æ³•è£…è½½ç±»ï¼Œ å¦‚æœï¼ŒæŒ‰ç…§ä»¥ä¸Šçš„æ­¥éª¤æˆåŠŸçš„æ‰¾åˆ°å¯¹åº”çš„ç±»ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•æ¥æ”¶çš„resolveå‚æ•°çš„å€¼ä¸ºtrue,é‚£ä¹ˆå°±è°ƒç”¨resolveClass(Class)æ–¹æ³•æ¥å¤„ç†ç±»ã€‚ javaä¸­çš„ç±»å¤§è‡´åˆ†ä¸ºä¸‰ç§: ç³»ç»Ÿç±» æ‰©å±•ç±» ç”±ç¨‹åºå‘˜è‡ªå®šä¹‰çš„ç±» ç±»è£…è½½æ–¹å¼ï¼Œæœ‰ä¸¤ç§ï¼š éšå¼è£…è½½ï¼Œ ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å½“ç¢°åˆ°é€šè¿‡new ç­‰æ–¹å¼ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œéšå¼è°ƒç”¨ç±»è£…è½½å™¨åŠ è½½å¯¹åº”çš„ç±»åˆ°jvmä¸­ã€‚ æ˜¾å¼è£…è½½ï¼Œ é€šè¿‡class.forName()ç­‰æ–¹æ³•ï¼Œæ˜¾å¼åŠ è½½éœ€è¦çš„ç±» ç±»åŠ è½½çš„åŠ¨æ€æ€§ä½“ç°ï¼š ä¸€ä¸ªåº”ç”¨ç¨‹åºæ€»æ˜¯ç”±nå¤šä¸ªç±»ç»„æˆï¼ŒJavaç¨‹åºå¯åŠ¨æ—¶ï¼Œå¹¶ä¸æ˜¯ä¸€æ¬¡æŠŠæ‰€æœ‰çš„ç±»å…¨éƒ¨åŠ è½½åå†è¿è¡Œï¼Œå®ƒæ€»æ˜¯å…ˆæŠŠä¿è¯ç¨‹åºè¿è¡Œçš„åŸºç¡€ç±»ä¸€æ¬¡æ€§åŠ è½½åˆ°jvmä¸­ï¼Œå…¶å®ƒç±»ç­‰åˆ°jvmç”¨åˆ°çš„æ—¶å€™å†åŠ è½½ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯èŠ‚çœäº†å†…å­˜çš„å¼€é”€ï¼Œå› ä¸ºjavaæœ€æ—©å°±æ˜¯ä¸ºåµŒå…¥å¼ç³»ç»Ÿè€Œè®¾è®¡çš„ï¼Œå†…å­˜å®è´µï¼Œè¿™æ˜¯ä¸€ç§å¯ä»¥ç†è§£çš„æœºåˆ¶ï¼Œè€Œç”¨åˆ°æ—¶å†åŠ è½½è¿™ä¹Ÿæ˜¯javaåŠ¨æ€æ€§çš„ä¸€ç§ä½“ç° javaç±»è£…è½½å™¨Javaä¸­çš„ç±»è£…è½½å™¨å®è´¨ä¸Šä¹Ÿæ˜¯ç±»ï¼ŒåŠŸèƒ½æ˜¯æŠŠç±»è½½å…¥jvmä¸­ï¼Œjvmçš„ç±»è£…è½½å™¨æœ‰ä¸‰ä¸ªï¼Œå±‚æ¬¡ç»“æ„å¦‚ä¸‹ï¼š ç±»åŠ è½½å™¨ä¹‹é—´æ˜¯å¦‚ä½•åè°ƒå·¥ä½œçš„javaæ˜¯å¦‚ä½•åŒºåˆ†ä¸€ä¸ªç±»è¯¥ç”±å“ªä¸ªç±»åŠ è½½å™¨æ¥å®Œæˆå‘¢ã€‚ åœ¨è¿™é‡Œjavaé‡‡ç”¨äº†å§”æ‰˜æ¨¡å‹æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶ç®€å•æ¥è®²ï¼Œå°±æ˜¯â€œç±»è£…è½½å™¨æœ‰è½½å…¥ç±»çš„éœ€æ±‚æ—¶ï¼Œä¼šå…ˆè¯·ç¤ºå…¶Parentä½¿ç”¨å…¶æœç´¢è·¯å¾„å¸®å¿™è½½å…¥ï¼Œå¦‚æœParent æ‰¾ä¸åˆ°,é‚£ä¹ˆæ‰ç”±è‡ªå·±ä¾ç…§è‡ªå·±çš„æœç´¢è·¯å¾„æœç´¢ç±»â€ 123456789101112131415Public class Test&#123; Public static void main(String[] arg)&#123; ClassLoader c = Test.class.getClassLoader(); //è·å–Testç±»çš„ç±»åŠ è½½å™¨ System.out.println(c); ClassLoader c1 = c.getParent(); //è·å–cè¿™ä¸ªç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨ System.out.println(c1); ClassLoader c2 = c1.getParent();//è·å–c1è¿™ä¸ªç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨ System.out.println(c2); &#125;&#125;//outputAppClassLoaderExtClassLoaderNull å¯ä»¥çœ‹å‡ºTestæ˜¯ç”±AppClassLoaderåŠ è½½å™¨åŠ è½½çš„ï¼ŒAppClassLoaderçš„Parent åŠ è½½å™¨æ˜¯ ExtClassLoader,ä½†æ˜¯ExtClassLoaderçš„Parentä¸º null æ˜¯æ€ä¹ˆå›äº‹ã€‚Bootstrap Loaderæ˜¯ç”¨C++è¯­è¨€å†™çš„ï¼Œä¾javaçš„è§‚ç‚¹æ¥çœ‹ï¼Œé€»è¾‘ä¸Šå¹¶ä¸å­˜åœ¨Bootstrap Loaderçš„ç±»å®ä½“ï¼Œæ‰€ä»¥åœ¨javaç¨‹åºä»£ç é‡Œè¯•å›¾æ‰“å°å‡ºå…¶å†…å®¹æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°è¾“å‡ºä¸ºnullã€‚ javaç±»åŠ è½½å™¨åŸºäºä¸‰ä¸ªæœºåˆ¶ï¼šå§”æ‰˜ï¼Œå¯è§ï¼Œå•ä¸€ã€‚ å§”æ‰˜æœºåˆ¶ï¼šæŒ‡çš„æ˜¯å°†åŠ è½½ç±»çš„è¯·æ±‚ä¼ é€’ç»™çˆ¶åŠ è½½å™¨ï¼Œå¦‚æœçˆ¶åŠ è½½å™¨æ‰¾ä¸åˆ°æˆ–è€…ä¸èƒ½åŠ è½½è¿™ä¸ªç±»ï¼Œé‚£ä¹ˆå†åŠ è½½ä»–ã€‚ å¯è§æ€§æœºåˆ¶ï¼šæŒ‡çš„æ˜¯çˆ¶åŠ è½½å™¨åŠ è½½çš„ç±»éƒ½èƒ½è¢«å­åŠ è½½å™¨çœ‹è§ï¼Œä½†æ˜¯å­åŠ è½½å™¨åŠ è½½çš„ç±»çˆ¶åŠ è½½å™¨æ˜¯çœ‹ä¸è§çš„ã€‚ å•ä¸€æ€§æœºåˆ¶ï¼šæŒ‡çš„æ˜¯ä¸€ä¸ªç±»åªèƒ½è¢«åŒä¸€ç§åŠ è½½å™¨åŠ è½½ä¸€æ¬¡ã€‚ JVMåŠ è½½classæ–‡ä»¶çš„åŸç†æœºåˆ¶ç±»è£…è½½å™¨å°±æ˜¯å¯»æ‰¾ç±»æˆ–æ¥å£å­—èŠ‚ç æ–‡ä»¶è¿›è¡Œè§£æå¹¶æ„é€ JVMå†…éƒ¨å¯¹è±¡è¡¨ç¤ºçš„ç»„ä»¶ï¼Œåœ¨javaä¸­ç±»è£…è½½å™¨æŠŠä¸€ä¸ªç±»è£…å…¥JVMï¼Œç»è¿‡ä»¥ä¸‹æ­¥éª¤ï¼š è£…è½½ï¼šæŸ¥æ‰¾å’Œå¯¼å…¥Classæ–‡ä»¶ é“¾æ¥ï¼š éªŒè¯ï¼šæ£€æŸ¥è½½å…¥çš„classæ–‡ä»¶æ•°æ®çš„æ­£ç¡®æ€§ å‡†å¤‡ï¼š ç»™ç±»çš„é™æ€å˜é‡åˆ†é…å­˜å‚¨ç©ºé—´ è§£æï¼š å°†ç¬¦å·å¼•ç”¨è½¬æˆç›´æ¥å¼•ç”¨ åˆå§‹åŒ–ï¼šå¯¹é™æ€å˜é‡ï¼Œé™æ€ä»£ç å—æ‰§è¡Œåˆå§‹åŒ–å·¥ä½œ ç±»è£…è½½å·¥ä½œç”±ClassLoderå’Œå…¶å­ç±»è´Ÿè´£ã€‚JVMåœ¨è¿è¡Œæ—¶ä¼šäº§ç”Ÿä¸‰ä¸ªClassLoaderï¼šæ ¹è£…è½½å™¨ï¼ŒExtClassLoader(æ‰©å±•ç±»è£…è½½å™¨)å’ŒAppClassLoaderï¼Œå…¶ä¸­æ ¹è£…è½½å™¨ä¸æ˜¯ClassLoaderçš„å­ç±»ï¼Œç”±C++ç¼–å†™ï¼Œå› æ­¤åœ¨javaä¸­çœ‹ä¸åˆ°ä»–ï¼Œè´Ÿè´£è£…è½½JREçš„æ ¸å¿ƒç±»åº“ï¼Œå¦‚JREç›®å½•ä¸‹çš„rt.jar,charsets.jarç­‰ã€‚ExtClassLoaderæ˜¯ClassLoderçš„å­ç±»ï¼Œè´Ÿè´£è£…è½½JREæ‰©å±•ç›®å½•extä¸‹çš„jarç±»åŒ…ï¼›AppClassLoaderè´Ÿè´£è£…è½½classpathè·¯å¾„ä¸‹çš„ç±»åŒ…ï¼Œè¿™ä¸‰ä¸ªç±»è£…è½½å™¨å­˜åœ¨çˆ¶å­å±‚çº§å…³ç³»ï¼Œå³æ ¹è£…è½½å™¨æ˜¯ExtClassLoaderçš„çˆ¶è£…è½½å™¨ï¼ŒExtClassLoaderæ˜¯AppClassLoaderçš„çˆ¶è£…è½½å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨AppClassLoaderè£…è½½åº”ç”¨ç¨‹åºçš„ç±» Javaè£…è½½ç±»ä½¿ç”¨â€œå…¨ç›˜è´Ÿè´£å§”æ‰˜æœºåˆ¶â€ã€‚â€œå…¨ç›˜è´Ÿè´£â€æ˜¯æŒ‡å½“ä¸€ä¸ªClassLoderè£…è½½ä¸€ä¸ªç±»æ—¶ï¼Œé™¤éæ˜¾ç¤ºçš„ä½¿ç”¨å¦å¤–ä¸€ä¸ªClassLoderï¼Œè¯¥ç±»æ‰€ä¾èµ–åŠå¼•ç”¨çš„ç±»ä¹Ÿç”±è¿™ä¸ªClassLoderè½½å…¥ï¼›â€œå§”æ‰˜æœºåˆ¶â€æ˜¯æŒ‡å…ˆå§”æ‰˜çˆ¶ç±»è£…è½½å™¨å¯»æ‰¾ç›®æ ‡ç±»ï¼Œåªæœ‰åœ¨æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹æ‰ä»è‡ªå·±çš„ç±»è·¯å¾„ä¸­æŸ¥æ‰¾å¹¶è£…è½½ç›®æ ‡ç±»ã€‚è¿™ä¸€ç‚¹æ˜¯ä»å®‰å…¨æ–¹é¢è€ƒè™‘çš„ï¼Œè¯•æƒ³å¦‚æœä¸€ä¸ªäººå†™äº†ä¸€ä¸ªæ¶æ„çš„åŸºç¡€ç±»ï¼ˆå¦‚java.lang.Stringï¼‰å¹¶åŠ è½½åˆ°JVMå°†ä¼šå¼•èµ·ä¸¥é‡çš„åæœï¼Œä½†æœ‰äº†å…¨ç›˜è´Ÿè´£åˆ¶ï¼Œjava.lang.Stringæ°¸è¿œæ˜¯ç”±æ ¹è£…è½½å™¨æ¥è£…è½½ï¼Œé¿å…ä»¥ä¸Šæƒ…å†µå‘ç”Ÿ é™¤äº†JVMé»˜è®¤çš„ä¸‰ä¸ªClassLoderä»¥å¤–ï¼Œç¬¬ä¸‰æ–¹å¯ä»¥ç¼–å†™è‡ªå·±çš„ç±»è£…è½½å™¨ï¼Œä»¥å®ç°ä¸€äº›ç‰¹æ®Šçš„éœ€æ±‚ã€‚ç±»æ–‡ä»¶è¢«è£…è½½è§£æåï¼Œåœ¨JVMä¸­éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„java.lang.Classå¯¹è±¡ï¼Œæä¾›äº†ç±»ç»“æ„ä¿¡æ¯çš„æè¿°ã€‚æ•°ç»„ï¼Œæšä¸¾åŠåŸºæœ¬æ•°æ®ç±»å‹ï¼Œç”šè‡³voidéƒ½æ‹¥æœ‰å¯¹åº”çš„Classå¯¹è±¡ã€‚ è£…è½½è¿‡ç¨‹æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„ç‰¹å¾ï¼šå±‚æ¬¡ç»„ç»‡ç»“æ„å’Œä»£ç†æ¨¡å¼ã€‚å±‚æ¬¡ç»„ç»‡ç»“æ„æŒ‡çš„æ˜¯æ¯ä¸ªç±»åŠ è½½å™¨éƒ½æœ‰ä¸€ä¸ªçˆ¶ç±»åŠ è½½å™¨ï¼Œé€šè¿‡getParent()æ–¹æ³•å¯ä»¥è·å–åˆ°ã€‚ç±»åŠ è½½å™¨é€šè¿‡è¿™ç§çˆ¶äº²-åä»£çš„æ–¹å¼ç»„ç»‡åœ¨ä¸€èµ·ï¼Œå½¢æˆæ ‘çŠ¶å±‚æ¬¡ç»“æ„ã€‚ä»£ç†æ¨¡å¼åˆ™æŒ‡çš„æ˜¯ä¸€ä¸ªç±»åŠ è½½å™¨æ—¢å¯ä»¥è‡ªå·±å®ŒæˆJavaç±»çš„å®šä¹‰å·¥ä½œï¼Œä¹Ÿå¯ä»¥ä»£ç†ç»™å…¶å®ƒçš„ç±»åŠ è½½å™¨æ¥å®Œæˆã€‚ç”±äºä»£ç†æ¨¡å¼çš„å­˜åœ¨ï¼Œå¯åŠ¨ä¸€ä¸ªç±»çš„åŠ è½½è¿‡ç¨‹çš„ç±»åŠ è½½å™¨å’Œæœ€ç»ˆå®šä¹‰è¿™ä¸ªç±»çš„ç±»åŠ è½½å™¨å¯èƒ½å¹¶ä¸æ˜¯ä¸€ä¸ªã€‚ClassLoaderçš„åŠ è½½ç±»è¿‡ç¨‹ä¸»è¦ä½¿ç”¨loadClassæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­å°è£…äº†ä¸­åŠ è½½æœºåˆ¶ï¼šåŒäº²å§”æ´¾æ¨¡å¼ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œçˆ¶ç±»ä¼˜å…ˆçš„ç­–ç•¥å°±è¶³å¤Ÿå¥½äº†ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦é‡‡å–ç›¸åçš„ç­–ç•¥ï¼Œå³å…ˆå°è¯•è‡ªå·±åŠ è½½ï¼Œæ‰¾ä¸åˆ°çš„æ—¶å€™å†ä»£ç†ç»™çˆ¶ç±»åŠ è½½å™¨ã€‚è¿™ç§åšæ³•åœ¨Javaçš„Webå®¹å™¨ä¸­æ¯”è¾ƒå¸¸è§ï¼Œä¹Ÿæ˜¯Servletè§„èŒƒæ¨èçš„åšæ³•ã€‚æ¯”å¦‚ï¼ŒApache Tomcatä¸ºæ¯ä¸ªWebåº”ç”¨éƒ½æä¾›ä¸€ä¸ªç‹¬ç«‹çš„ç±»åŠ è½½å™¨ï¼Œä½¿ç”¨çš„å°±æ˜¯è‡ªå·±ä¼˜å…ˆåŠ è½½çš„ç­–ç•¥ã€‚ ç±»åŠ è½½å™¨çš„ä¸€ä¸ªé‡è¦ç”¨é€”æ˜¯åœ¨JVMä¸­ä¸ºç›¸åŒåç§°çš„Javaç±»åˆ›å»ºéš”ç¦»ç©ºé—´ã€‚åœ¨JVMä¸­ï¼Œåˆ¤æ–­ä¸¤ä¸ªç±»æ˜¯å¦ç›¸åŒï¼Œä¸ä»…æ˜¯æ ¹æ®è¯¥ç±»çš„äºŒè¿›åˆ¶åç§°ï¼Œè¿˜éœ€è¦æ ¹æ®ä¸¤ä¸ªç±»çš„å®šä¹‰ç±»åŠ è½½å™¨ã€‚åªæœ‰ä¸¤è€…å®Œå…¨ä¸€æ ·ï¼Œæ‰è®¤ä¸ºä¸¤ä¸ªç±»çš„æ˜¯ç›¸åŒçš„ã€‚å› æ­¤ï¼Œå³ä¾¿æ˜¯åŒæ ·çš„Javaå­—èŠ‚ä»£ç ï¼Œè¢«ä¸¤ä¸ªä¸åŒçš„ç±»åŠ è½½å™¨å®šä¹‰ä¹‹åï¼Œæ‰€å¾—åˆ°çš„Javaç±»ä¹Ÿæ˜¯ä¸åŒçš„ã€‚å¦‚æœè¯•å›¾åœ¨ä¸¤ä¸ªç±»çš„å¯¹è±¡ä¹‹é—´è¿›è¡Œèµ‹å€¼æ“ä½œï¼Œä¼šæŠ›å‡ºjava.lang.ClassCastExceptionã€‚è¿™ä¸ªç‰¹æ€§ä¸ºåŒæ ·åç§°çš„Javaç±»åœ¨JVMä¸­å…±å­˜åˆ›é€ äº†æ¡ä»¶ã€‚åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œå¯èƒ½ä¼šè¦æ±‚åŒä¸€åç§°çš„Javaç±»çš„ä¸åŒç‰ˆæœ¬åœ¨JVMä¸­å¯ä»¥åŒæ—¶å­˜åœ¨ã€‚é€šè¿‡ç±»åŠ è½½å™¨å°±å¯ä»¥æ»¡è¶³è¿™ç§éœ€æ±‚ã€‚ Javaç±»çš„é“¾æ¥Javaç±»çš„é“¾æ¥æŒ‡çš„æ˜¯å°†Javaç±»çš„äºŒè¿›åˆ¶ä»£ç åˆå¹¶åˆ°JVMçš„è¿è¡ŒçŠ¶æ€ä¹‹ä¸­çš„è¿‡ç¨‹ã€‚åœ¨é“¾æ¥ä¹‹å‰ï¼Œè¿™ä¸ªç±»å¿…é¡»è¢«æˆåŠŸåŠ è½½ã€‚é“¾æ¥çš„è¿‡ç¨‹æ¯”åŠ è½½è¿‡ç¨‹è¦å¤æ‚å¾ˆå¤šï¼Œè¿™æ˜¯å®ç°javaçš„åŠ¨æ€æ€§çš„é‡è¦ä¸€æ­¥ï¼åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šverification ï¼ˆéªŒè¯ï¼‰ï¼Œ preparationï¼ˆå‡†å¤‡ï¼‰ å’Œ resolutionï¼ˆè§£æï¼‰ 1. verificationï¼ˆéªŒè¯ï¼‰ï¼šéªŒè¯æ˜¯ç”¨æ¥ç¡®ä¿Javaç±»çš„äºŒè¿›åˆ¶è¡¨ç¤ºåœ¨ç»“æ„ä¸Šæ˜¯å®Œå…¨æ­£ç¡®çš„ã€‚è¦éªŒè¯æ¯”å¦‚classæ–‡ä»¶æ ¼å¼è§„èŒƒã€è¿™ä¸ªç±»æ˜¯å¦ç»§æ‰¿äº†finalç±»ã€ä¸èƒ½æŠŠä¸€ä¸ªçˆ¶ç±»å¯¹è±¡èµ‹å€¼ç»™å­ç±»æ•°æ®ç±»å‹ç­‰ç­‰ã€‚å¦‚æœéªŒè¯è¿‡ç¨‹å‡ºç°é”™è¯¯çš„è¯ï¼Œä¼šæŠ›å‡ºjava.lang.VerifyErroré”™è¯¯ã€‚ 2.preparationï¼ˆå‡†å¤‡ï¼‰ï¼š å‡†å¤‡é˜¶æ®µä¸ºæ–¹æ³•åŒºä¸­çš„é™æ€å˜é‡åˆ†é…å†…å­˜ç©ºé—´ã€‚å¹¶å°†å…¶èµ‹å€¼ä¸ºåˆå§‹å€¼ï¼Œæ‰€æœ‰åŸå§‹ç±»å‹çš„å€¼éƒ½ä¸º0ã€‚å¦‚floatä¸º0fã€ intä¸º0ã€booleanä¸º0ã€å¼•ç”¨ç±»å‹ä¸ºnullã€‚ 3.resolutionï¼ˆè§£æï¼‰ï¼š è§£æçš„è¿‡ç¨‹å°±æ˜¯ç¡®ä¿è¿™äº›è¢«å¼•ç”¨çš„ç±»èƒ½è¢«æ­£ç¡®çš„æ‰¾åˆ°ã€‚è§£æçš„è¿‡ç¨‹å¯èƒ½ä¼šå¯¼è‡´å…¶å®ƒçš„Javaç±»è¢«åŠ è½½ã€‚ ä¸ºç±»ã€æ¥å£ã€æ–¹æ³•ã€æˆå‘˜å˜é‡çš„ç¬¦å·å¼•ç”¨å®šä½ç›´æ¥å¼•ç”¨ã€‚ ç¬¦å·å¼•ç”¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒå”¯ä¸€æ ‡è¯†ä¸€ä¸ªç±»ã€ä¸€ä¸ªå­—æ®µã€ä¸€ä¸ªæ–¹æ³•ç­‰ç›®æ ‡ã€‚ è€Œç›´æ¥å¼•ç”¨å¯¹äºç±»å˜é‡ã€ç±»æ–¹æ³•æŒ‡çš„æ˜¯æŒ‡å‘æ–¹æ³•åŒºçš„æŒ‡é’ˆï¼Œç„¶åå¯¹äºå®ä¾‹æ–¹æ³•ã€å®ä¾‹å¯¹è±¡æ¥è¯´å°±æ˜¯åç§»é‡ï¼Œæ¯”å¦‚ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œå­ç±»ä¸­æ–¹æ³•è¡¨ä¸­çš„åç§»é‡å’Œçˆ¶ç±»æ˜¯ä¸€è‡´çš„ï¼Œè¿™ä¸ªåç§»é‡å¯ä»¥ç¡®å®šæŸä¸ªæ–¹æ³•çš„ä½ç½®ã€‚ Javaç±»çš„åˆå§‹åŒ–ç±»çš„åˆå§‹åŒ–æ˜¯å»¶è¿Ÿçš„ï¼Œç›´åˆ°ç±»ç¬¬ä¸€æ¬¡è¢«ä¸»åŠ¨ä½¿ç”¨(active use)ï¼ŒJVM æ‰ä¼šåˆå§‹åŒ–ç±»ã€‚å½“ä¸€ä¸ªJavaç±»ç¬¬ä¸€æ¬¡è¢«çœŸæ­£ä½¿ç”¨åˆ°çš„æ—¶å€™ï¼ŒJVMä¼šè¿›è¡Œè¯¥ç±»çš„åˆå§‹åŒ–æ“ä½œã€‚åˆå§‹åŒ–è¿‡ç¨‹çš„ä¸»è¦æ“ä½œæ˜¯æ‰§è¡Œé™æ€ä»£ç å—å’Œåˆå§‹åŒ–é™æ€åŸŸã€‚åœ¨ä¸€ä¸ªç±»è¢«åˆå§‹åŒ–ä¹‹å‰ï¼Œå®ƒçš„ç›´æ¥çˆ¶ç±»ä¹Ÿéœ€è¦è¢«åˆå§‹åŒ–ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªæ¥å£çš„åˆå§‹åŒ–ï¼Œä¸ä¼šå¼•èµ·å…¶çˆ¶æ¥å£çš„åˆå§‹åŒ–ã€‚åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§æºä»£ç ä¸­ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºä¾æ¬¡æ‰§è¡Œé™æ€ä»£ç å—å’Œåˆå§‹åŒ–é™æ€åŸŸã€‚ åˆå§‹åŒ–è¿‡ç¨‹ä¼šè¢«è§¦å‘çš„æ¡ä»¶æ±‡æ€»ï¼š ä½¿ç”¨newå…³é”®å­—å®ä¾‹åŒ–å¯¹è±¡ã€è®¿é—®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µã€é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚ å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ã€‚ å½“åˆå§‹åŒ–å­ç±»æ—¶ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™è¿›è¡Œçˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ å‚è€ƒ æ·±åº¦åˆ†æJavaçš„ClassLoaderæœºåˆ¶ï¼ˆæºç çº§åˆ«ï¼‰ Javaç±»çš„åŠ è½½ã€é“¾æ¥å’Œåˆå§‹åŒ– javaåŸºç¡€å·©å›ºç¬”è®°(3)-ç±»åŠ è½½å™¨ JVMâ€”â€”Javaç±»åŠ è½½æœºåˆ¶æ€»ç»“","categories":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/categories/JVM/"}],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/tags/JVM/"}]},{"title":"TCP/IP","slug":"TCP-IP","date":"2018-04-16T10:43:52.000Z","updated":"2018-05-02T05:49:53.067Z","comments":true,"path":"2018/04/16/TCP-IP/","link":"","permalink":"https://hsb786.github.io/2018/04/16/TCP-IP/","excerpt":"Transmission Control Protocol/Internet Protocolçš„ç®€å†™ï¼Œä¸­è¯‘åä¸ºä¼ è¾“æ§åˆ¶åè®®/å› ç‰¹ç½‘äº’è”åè®®ï¼Œåˆåç½‘ç»œé€šè®¯åè®®ï¼Œæ˜¯Internetæœ€åŸºæœ¬çš„åè®®ã€Internetå›½é™…äº’è”ç½‘ç»œçš„åŸºç¡€ï¼Œç”±ç½‘ç»œå±‚çš„IPåè®®å’Œä¼ è¾“å±‚çš„TCPåè®®ç»„æˆã€‚TCP/IP å®šä¹‰äº†ç”µå­è®¾å¤‡å¦‚ä½•è¿å…¥å› ç‰¹ç½‘ï¼Œä»¥åŠæ•°æ®å¦‚ä½•åœ¨å®ƒä»¬ä¹‹é—´ä¼ è¾“çš„æ ‡å‡†ã€‚åè®®é‡‡ç”¨äº†4å±‚çš„å±‚çº§ç»“æ„ï¼Œæ¯ä¸€å±‚éƒ½å‘¼å«å®ƒçš„ä¸‹ä¸€å±‚æ‰€æä¾›çš„åè®®æ¥å®Œæˆè‡ªå·±çš„éœ€æ±‚ã€‚é€šä¿—è€Œè¨€ï¼šTCPè´Ÿè´£å‘ç°ä¼ è¾“çš„é—®é¢˜ï¼Œä¸€æœ‰é—®é¢˜å°±å‘å‡ºä¿¡å·ï¼Œè¦æ±‚é‡æ–°ä¼ è¾“ï¼Œç›´åˆ°æ‰€æœ‰æ•°æ®å®‰å…¨æ­£ç¡®åœ°ä¼ è¾“åˆ°ç›®çš„åœ°ã€‚è€ŒIPæ˜¯ç»™å› ç‰¹ç½‘çš„æ¯ä¸€å°è”ç½‘è®¾å¤‡è§„å®šä¸€ä¸ªåœ°å€ã€‚","text":"Transmission Control Protocol/Internet Protocolçš„ç®€å†™ï¼Œä¸­è¯‘åä¸ºä¼ è¾“æ§åˆ¶åè®®/å› ç‰¹ç½‘äº’è”åè®®ï¼Œåˆåç½‘ç»œé€šè®¯åè®®ï¼Œæ˜¯Internetæœ€åŸºæœ¬çš„åè®®ã€Internetå›½é™…äº’è”ç½‘ç»œçš„åŸºç¡€ï¼Œç”±ç½‘ç»œå±‚çš„IPåè®®å’Œä¼ è¾“å±‚çš„TCPåè®®ç»„æˆã€‚TCP/IP å®šä¹‰äº†ç”µå­è®¾å¤‡å¦‚ä½•è¿å…¥å› ç‰¹ç½‘ï¼Œä»¥åŠæ•°æ®å¦‚ä½•åœ¨å®ƒä»¬ä¹‹é—´ä¼ è¾“çš„æ ‡å‡†ã€‚åè®®é‡‡ç”¨äº†4å±‚çš„å±‚çº§ç»“æ„ï¼Œæ¯ä¸€å±‚éƒ½å‘¼å«å®ƒçš„ä¸‹ä¸€å±‚æ‰€æä¾›çš„åè®®æ¥å®Œæˆè‡ªå·±çš„éœ€æ±‚ã€‚é€šä¿—è€Œè¨€ï¼šTCPè´Ÿè´£å‘ç°ä¼ è¾“çš„é—®é¢˜ï¼Œä¸€æœ‰é—®é¢˜å°±å‘å‡ºä¿¡å·ï¼Œè¦æ±‚é‡æ–°ä¼ è¾“ï¼Œç›´åˆ°æ‰€æœ‰æ•°æ®å®‰å…¨æ­£ç¡®åœ°ä¼ è¾“åˆ°ç›®çš„åœ°ã€‚è€ŒIPæ˜¯ç»™å› ç‰¹ç½‘çš„æ¯ä¸€å°è”ç½‘è®¾å¤‡è§„å®šä¸€ä¸ªåœ°å€ã€‚ TCP/IPåè®®æ—å°±é‡‡ç”¨äº†åˆ†å±‚çš„æ€æƒ³ï¼Œè‡ªä¸Šè€Œä¸‹åˆ†æˆäº†å››å±‚ï¼š åº”ç”¨å±‚ï¼Œä¼ è¾“å±‚ï¼Œç½‘ç»œå±‚ï¼Œé“¾è·¯å±‚ï¼Œæ¯ä¸€å±‚çš„åè®®åªçº¦å®šäº†ç‰¹å®šçš„åŠŸèƒ½ï¼ŒHTTPå°±ä½äºåº”ç”¨å±‚ã€‚åˆ©ç”¨TCP/IPåè®®æ—è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œä¼šé€šè¿‡åˆ†å±‚é¡ºåºä¸å¯¹æ–¹è¿›è¡Œé€šä¿¡ã€‚å‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹èµ°ï¼Œæ¥æ”¶ç«¯åˆ™å¾€åº”ç”¨å±‚å¾€ä¸Šèµ°ã€‚ä¸€æ¬¡HTTPè¯·æ±‚çš„å…¸å‹è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º URI URIæ˜¯Uniform Resource Identifierçš„ç¼©å†™ï¼Œæ˜¯ç”±æŸä¸ªåè®®æ–¹æ¡ˆè¡¨ç¤ºçš„èµ„æºçš„å®šä½æ ‡è¯†ç¬¦ã€‚åè®®æ–¹æ¡ˆæ˜¯æŒ‡è®¿é—®èµ„æºæ‰€ä½¿ç”¨çš„åè®®ç±»å‹åç§°ã€‚ é‡‡ç”¨HTTPåè®®æ—¶ï¼Œåè®®æ–¹æ¡ˆå°±æ˜¯httpã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ftpã€mailtoã€telnetã€fileç­‰ã€‚ æ¯”å¦‚12http://ftp:// æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„URLï¼ˆUniform Resource Locatorï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰è¡¨ç¤ºèµ„æºåœ¨äº’è”ç½‘ä¸Šçš„åœ°å€ï¼Œå®ƒå…¶å®æ˜¯URIçš„ä¸€ä¸ªå­é›†ï¼Œå› ä¸ºURIä»…ä»…è¡¨ç¤ºã€Œæ ‡è¯†ã€ï¼Œ æ ‡è¯†çš„ç±»å‹æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ISBNå·ç ï¼Œç”µè¯å·ç ï¼Œé‚®ç®±ï¼Œç½‘é¡µé“¾æ¥åœ°å€ç­‰ï¼Œè€ŒURLåˆ™æŠŠæ¦‚å¿µç¼©å°åˆ°äº†ã€Œåœ°å€ã€ã€‚ ç”±äºURIåœ¨ç»å¤§å¤šæ•°åœºæ™¯ä¸‹éƒ½æ˜¯ä»¥URLçš„å½¢å¼å­˜åœ¨ï¼Œå¤§å®¶ä¸€èˆ¬éƒ½è¯´URLå±…å¤šï¼Œè¿™ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯åœ¨å¿ƒé‡Œè¦æ¸…æ¥šURIå’ŒURLè¿˜æ˜¯æœ‰æ‰€åŒºåˆ«çš„ã€‚ HTTPåè®®å†…å®¹æ¥ä¸‹æ¥çš„å†…å®¹åŸºäºHTTP 1.1ç‰ˆæœ¬ã€‚ è¯·æ±‚ &amp; å“åº”æŠ¥æ–‡ç»“æ„ åœ¨ä¸¤å°è®¡ç®—æœºä¹‹é—´ä½¿ç”¨HTTPåè®®é€šä¿¡æ—¶ï¼Œåœ¨ä¸€æ¡é€šä¿¡çº¿è·¯ä¸Šå¿…å®šæœ‰ä¸€ç«¯æ˜¯å®¢æˆ·ç«¯ï¼Œå¦ä¸€ç«¯åˆ™æ˜¯æœåŠ¡å™¨ç«¯ã€‚HTTPåè®®è§„å®šï¼Œè¯·æ±‚ä»å®¢æˆ·ç«¯å‘å‡ºï¼Œ æœ€åæœåŠ¡å™¨ç«¯å“åº”è¯¥è¯·æ±‚å¹¶è¿”å›ã€‚æ¢å¥è¯è¯´ï¼Œè‚¯å®šæ˜¯å…ˆä»å®¢æˆ·ç«¯å¼€å§‹å»ºç«‹é€šä¿¡çš„ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ²¡æœ‰æ¥æ”¶åˆ°è¯·æ±‚ä¹‹å‰ä¸ä¼šå‘é€å“åº”ã€‚ HTTPæŠ¥æ–‡æœ¬èº«æ˜¯ç”±å¤šè¡Œï¼ˆç”¨CR+LFä½œæ¢è¡Œç¬¦ï¼‰æ•°æ®æ„æˆçš„å­—ç¬¦ä¸²æ–‡æœ¬ã€‚è¯·æ±‚ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰çš„HTTPæŠ¥æ–‡å«åšè¯·æ±‚æŠ¥æ–‡ï¼Œå“åº”ç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„å«åšå“åº”æŠ¥æ–‡ã€‚HTTPæŠ¥æ–‡å¤§è‡´å¯åˆ†ä¸ºæŠ¥æ–‡é¦–éƒ¨å’ŒæŠ¥æ–‡ä¸»ä½“ä¸¤å—ã€‚ ä¸¤è€…ç”±æœ€åˆå‡ºç°çš„ç©ºè¡Œï¼ˆCR+LFï¼‰æ¥åˆ’åˆ†ã€‚é€šå¸¸ï¼Œå¹¶ä¸ä¸€å®šè¦æœ‰æŠ¥æ–‡ä¸»ä½“ã€‚ è¯·æ±‚æŠ¥æ–‡æ˜¯ç”±è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URIã€åè®®ç‰ˆæœ¬ã€å¯é€‰çš„è¯·æ±‚é¦–éƒ¨å­—æ®µå’Œå†…å®¹å®ä½“æ„æˆçš„ã€‚å“åº”æŠ¥æ–‡åŸºæœ¬ä¸Šç”±åè®®ç‰ˆæœ¬ã€çŠ¶æ€ç ï¼ˆè¡¨ç¤ºè¯·æ±‚æˆåŠŸæˆ–å¤±è´¥çš„æ•°å­—ä»£ç ï¼‰ã€ç”¨ä»¥è§£é‡ŠçŠ¶æ€ç çš„åŸå› çŸ­è¯­ã€å¯é€‰çš„å“åº”é¦–éƒ¨å­—æ®µä»¥åŠå®ä½“ä¸»ä½“æ„æˆã€‚ å¦‚ä¸‹æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚å’Œå“åº”æŠ¥æ–‡çš„å®ä¾‹ å“åº”çŠ¶æ€ç  çŠ¶æ€ç çš„èŒè´£æ˜¯å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œæè¿°è¿”å›çš„è¯·æ±‚ç»“æœã€‚å€ŸåŠ©çŠ¶æ€ç ï¼Œç”¨æˆ·å¯ä»¥çŸ¥é“æœåŠ¡å™¨ç«¯æ˜¯æ­£å¸¸å¤„ç†äº†è¯·æ±‚ï¼Œè¿˜æ˜¯å‡ºç°äº†é”™è¯¯ã€‚ æ•°å­—ä¸­çš„ç¬¬ä¸€ä½æŒ‡å®šäº†å“åº”ç±»åˆ«ï¼Œåä¸¤ä½æ— åˆ†ç±»ã€‚ çŠ¶æ€ç ä¸»è¦ç±»å‹ä¸€è§ˆï¼š é¦–éƒ¨ &amp; å®ä½“ HTTPé¦–éƒ¨å­—æ®µæ˜¯æ„æˆHTTPæŠ¥æ–‡çš„è¦ç´ ä¹‹ä¸€ã€‚åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä»¥HTTPåè®®è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼Œæ— è®ºæ˜¯è¯·æ±‚è¿˜æ˜¯å“åº”éƒ½ä¼šä½¿ç”¨é¦–éƒ¨å­—æ®µï¼Œå®ƒèƒ½èµ·åˆ°ä¼ é€’é¢å¤–é‡è¦ä¿¡æ¯çš„ä½œç”¨ã€‚ä½¿ç”¨é¦–éƒ¨å­—æ®µæ˜¯ä¸ºäº†ç»™æµè§ˆå™¨å’ŒæœåŠ¡å™¨æä¾›æŠ¥æ–‡ä¸»ä½“å¤§å°ã€æ‰€ä½¿ç”¨çš„è¯­è¨€ã€è®¤è¯ä¿¡æ¯ç­‰å†…å®¹ã€‚ HTTPé¦–éƒ¨å­—æ®µç”±é¦–éƒ¨å­—æ®µåå’Œå­—æ®µå€¼æ„æˆçš„ï¼Œä¸­é—´ç”¨å†’å·â€œ:â€åˆ†éš”ã€‚æ¯”å¦‚ï¼šContent-Type: text/htmlã€‚ HTTPå®ä½“æ˜¯HTTPè¯·æ±‚å’Œå“åº”ä¼ è¾“çš„ä¸»ä½“å†…å®¹ï¼Œæ ¹æ®åœºæ™¯ä¸åŒå¯èƒ½æ˜¯è¡¨å•å‚æ•°ï¼ŒHTMLæ–‡æœ¬ï¼ŒJSONæ–‡æœ¬ï¼ŒäºŒè¿›åˆ¶æµç­‰ã€‚ Cookie HTTPæ˜¯ä¸€ç§ä¸ä¿å­˜çŠ¶æ€ï¼Œå³æ— çŠ¶æ€ï¼ˆstatelessï¼‰åè®®ã€‚HTTPåè®®è‡ªèº«ä¸å¯¹è¯·æ±‚å’Œå“åº”ä¹‹é—´çš„é€šä¿¡çŠ¶æ€è¿›è¡Œä¿å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨HTTPè¿™ä¸ªçº§åˆ«ï¼Œåè®®å¯¹äºå‘é€è¿‡çš„è¯·æ±‚æˆ–å“åº”éƒ½ä¸åšæŒä¹…åŒ–å¤„ç†ã€‚ ä½¿ç”¨HTTPåè®®ï¼Œæ¯å½“æœ‰æ–°çš„è¯·æ±‚å‘é€æ—¶ï¼Œå°±ä¼šæœ‰å¯¹åº”çš„æ–°å“åº”äº§ç”Ÿã€‚åè®®æœ¬èº«å¹¶ä¸ä¿ç•™ä¹‹å‰ä¸€åˆ‡çš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡çš„ä¿¡æ¯ã€‚è¿™æ˜¯ä¸ºäº†æ›´å¿«åœ°å¤„ç†å¤§é‡äº‹åŠ¡ï¼Œç¡®ä¿åè®®çš„å¯ä¼¸ç¼©æ€§ï¼Œè€Œç‰¹æ„æŠŠHTTPåè®®è®¾è®¡æˆå¦‚æ­¤ç®€å•çš„ã€‚ ä¸å¯å¦è®¤ï¼Œæ— çŠ¶æ€åè®®å½“ç„¶ä¹Ÿæœ‰å®ƒçš„ä¼˜ç‚¹ã€‚ç”±äºä¸å¿…ä¿å­˜çŠ¶æ€ï¼Œè‡ªç„¶å¯å‡å°‘æœåŠ¡å™¨çš„CPUåŠå†…å­˜èµ„æºçš„æ¶ˆè€—ã€‚ä»å¦ä¸€ä¾§é¢æ¥è¯´ï¼Œä¹Ÿæ­£æ˜¯å› ä¸ºHTTPåè®®æœ¬èº«æ˜¯éå¸¸ç®€å•çš„ï¼Œæ‰€ä»¥æ‰ä¼šè¢«åº”ç”¨åœ¨å„ç§åœºæ™¯é‡Œã€‚ Cookieä¼šæ ¹æ®ä»æœåŠ¡å™¨ç«¯å‘é€çš„å“åº”æŠ¥æ–‡å†…çš„ä¸€ä¸ªå«åšSet-Cookieçš„é¦–éƒ¨å­—æ®µä¿¡æ¯ï¼Œé€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜Cookieã€‚å½“ä¸‹æ¬¡å®¢æˆ·ç«¯å†å¾€è¯¥æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­åŠ å…¥Cookieå€¼åå‘é€å‡ºå»ã€‚æœåŠ¡å™¨ç«¯å‘ç°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„Cookieåï¼Œä¼šå»æ£€æŸ¥ç©¶ç«Ÿæ˜¯ä»å“ªä¸€ä¸ªå®¢æˆ·ç«¯å‘æ¥çš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå¯¹æ¯”æœåŠ¡å™¨ä¸Šçš„è®°å½•ï¼Œæœ€åå¾—åˆ°ä¹‹å‰çš„çŠ¶æ€ä¿¡æ¯ã€‚ GETå’ŒPOSTçš„åŒºåˆ«GETå’ŒPOSTæœ€ç›´è§‚çš„åŒºåˆ«å°±æ˜¯GETæŠŠå‚æ•°åŒ…å«åœ¨URLä¸­ï¼ŒPOSTé€šè¿‡request bodyä¼ é€’å‚æ•° W3schoolçš„è§£ç­” æ–¹æ³• GET POST åé€€æŒ‰é’®/åˆ·æ–° æ— å®³ æ•°æ®ä¼šè¢«é‡æ–°æäº¤ï¼ˆæµè§ˆå™¨åº”è¯¥å‘ŠçŸ¥ç”¨æˆ·æ•°æ®ä¼šè¢«é‡æ–°æäº¤ï¼‰ã€‚ ä¹¦ç­¾ å¯æ”¶è—ä¸ºä¹¦ç­¾ ä¸å¯æ”¶è—ä¸ºä¹¦ç­¾ ç¼“å­˜ èƒ½è¢«ç¼“å­˜ ä¸èƒ½ç¼“å­˜ ç¼–ç ç±»å‹ application/x-www-form-urlencoded application/x-www-form-urlencoded æˆ– multipart/form-dataã€‚ä¸ºäºŒè¿›åˆ¶æ•°æ®ä½¿ç”¨å¤šé‡ç¼–ç ã€‚ å†å² å‚æ•°ä¿ç•™åœ¨æµè§ˆå™¨å†å²ä¸­ã€‚ å‚æ•°ä¸ä¼šä¿å­˜åœ¨æµè§ˆå™¨å†å²ä¸­ã€‚ å¯¹æ•°æ®é•¿åº¦çš„é™åˆ¶ æ˜¯çš„ã€‚å½“å‘é€æ•°æ®æ—¶ï¼ŒGET æ–¹æ³•å‘ URL æ·»åŠ æ•°æ®ï¼›URL çš„é•¿åº¦æ˜¯å—é™åˆ¶çš„ï¼ˆURL çš„æœ€å¤§é•¿åº¦æ˜¯ 2048 ä¸ªå­—ç¬¦ï¼‰ã€‚ æ— é™åˆ¶ã€‚ å¯¹æ•°æ®ç±»å‹çš„é™åˆ¶ åªå…è®¸ ASCII å­—ç¬¦ã€‚ æ²¡æœ‰é™åˆ¶ã€‚ä¹Ÿå…è®¸äºŒè¿›åˆ¶æ•°æ®ã€‚ å®‰å…¨æ€§ ä¸ POST ç›¸æ¯”ï¼ŒGET çš„å®‰å…¨æ€§è¾ƒå·®ï¼Œå› ä¸ºæ‰€å‘é€çš„æ•°æ®æ˜¯ URL çš„ä¸€éƒ¨åˆ†ã€‚åœ¨å‘é€å¯†ç æˆ–å…¶ä»–æ•æ„Ÿä¿¡æ¯æ—¶ç»ä¸è¦ä½¿ç”¨ GET ï¼ POST æ¯” GET æ›´å®‰å…¨ï¼Œå› ä¸ºå‚æ•°ä¸ä¼šè¢«ä¿å­˜åœ¨æµè§ˆå™¨å†å²æˆ– web æœåŠ¡å™¨æ—¥å¿—ä¸­ã€‚ å¯è§æ€§ æ•°æ®åœ¨ URL ä¸­å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ã€‚ æ•°æ®ä¸ä¼šæ˜¾ç¤ºåœ¨ URL ä¸­ã€‚ è¿™ä¸ªå¯¹æ¯”åªæ˜¯ç»™å‡ºäº†ä¸€äº›ç°è±¡ä¸Šçš„åŒºåˆ« GETå’ŒPOSTæ˜¯ä»€ä¹ˆï¼ŸHTTPåè®®ä¸­çš„ä¸¤ç§å‘é€è¯·æ±‚çš„æ–¹æ³•ã€‚ HTTPæ˜¯ä»€ä¹ˆï¼ŸHTTPæ˜¯åŸºäºTCP/IPçš„å…³äºæ•°æ®å¦‚ä½•åœ¨ä¸‡ç»´ç½‘ä¸­å¦‚ä½•é€šä¿¡çš„åè®® HTTPçš„åº•å±‚æ˜¯TCP/IPã€‚æ‰€ä»¥GETå’ŒPOSTçš„åº•å±‚ä¹Ÿæ˜¯TCP/IPï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGET/POSTéƒ½æ˜¯TCPé“¾æ¥ã€‚GETå’ŒPOSTèƒ½åšçš„äº‹æƒ…æ˜¯ä¸€æ ·çš„ã€‚ä½ è¦ç»™GETåŠ ä¸Šrequest bodyï¼Œç»™POSTå¸¦ä¸Šurlå‚æ•°ï¼ŒæŠ€æœ¯ä¸Šæ˜¯å®Œå…¨è¡Œçš„é€šçš„ã€‚ å¦‚æœä½ ç”¨GETæœåŠ¡ï¼Œåœ¨request bodyä¸­å­˜äº†æ•°æ®ï¼Œä¸åŒæœåŠ¡å™¨çš„å¤„ç†æ–¹å¼æ˜¯ä¸åŒçš„ï¼Œæœ‰äº›æœåŠ¡å™¨ä¼šè¯»å‡ºæ•°æ®ï¼Œæœ‰äº›æœåŠ¡å™¨ç›´æ¥å¿½ç•¥ã€‚æ‰€ä»¥ï¼Œè™½ç„¶GETå¯ä»¥å¸¦request bodyï¼Œä½†ä¸èƒ½ä¿è¯ä¸€å®šèƒ½è¢«æ¥å—åˆ°ã€‚ RFC å¾æ±‚æ„è§ç¨¿ï¼ˆè‹±è¯­ï¼šRequest For Commentsï¼Œç¼©å†™ä¸ºRFCï¼‰ï¼Œæ˜¯ç”±äº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ï¼ˆIETFï¼‰å‘å¸ƒçš„ä¸€ç³»åˆ—å¤‡å¿˜å½•ã€‚æ–‡ä»¶æ”¶é›†äº†æœ‰å…³äº’è”ç½‘ç›¸å…³ä¿¡æ¯ï¼Œä»¥åŠUNIXå’Œäº’è”ç½‘ç¤¾åŒºçš„è½¯ä»¶æ–‡ä»¶ï¼Œä»¥ç¼–å·æ’å®šã€‚ç›®å‰RFCæ–‡ä»¶æ˜¯ç”±äº’è”ç½‘åä¼šï¼ˆISOCï¼‰èµåŠ©å‘è¡Œã€‚ ç®€å•ç†è§£RFCå°±æ˜¯äº’è”ç½‘çš„è§„èŒƒï¼Œæˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„ã€Œåè®®ã€å°±æ˜¯ä»¥RFCçš„å½¢å¼å­˜åœ¨ï¼Œè€Œç°è¡Œçš„HTTP/1.1è§„èŒƒçš„RFCæœ‰å¦‚ä¸‹å‡ ä¸ªï¼š RFC7230ï¼Œ RFC7231ï¼Œ RFC7232ï¼Œ RFC7233ï¼Œ RFC7234ï¼Œ RFC7235ã€‚ å…¶ä¸­RFC7231é‡Œçš„Section 4. Request Methodsæ¶‰åŠåˆ°äº†å‡ ä¸ªHTTPæ–¹æ³•ï¼Œæ¥ä¸‹æ¥ä»”ç»†é˜…è¯»è¿™ä¸€ç« èŠ‚ã€‚ The request method token is the primary source of request semantics; it indicates the purpose for which the client has made this request and what is expected by the client as a successful result. semantic[è¯­ä¹‰]ï¼Œè¯­æ³•ä¸è¯­ä¹‰çš„åŒºåˆ«ï¼š ä¸€ç§è¯­è¨€æ˜¯åˆæ³•å¥å­çš„é›†åˆã€‚ä»€ä¹ˆæ ·çš„å¥å­æ˜¯åˆæ³•çš„å‘¢ï¼Ÿå¯ä»¥ä»ä¸¤æ–¹é¢æ¥åˆ¤æ–­ï¼šè¯­æ³•å’Œè¯­ä¹‰ã€‚è¯­æ³•æ˜¯å’Œæ–‡æ³•ç»“æ„æœ‰å…³ï¼Œç„¶è€Œè¯­ä¹‰æ˜¯å’ŒæŒ‰ç…§è¿™ä¸ªç»“æ„æ‰€ç»„åˆçš„å•è¯ç¬¦å·çš„æ„ä¹‰æœ‰å…³ã€‚åˆç†çš„è¯­æ³•ç»“æ„å¹¶ä¸è¡¨æ˜è¯­ä¹‰æ˜¯åˆæ³•çš„ã€‚ä¾‹å¦‚æˆ‘ä»¬å¸¸è¯´ï¼šæˆ‘ä¸Šå¤§å­¦ï¼Œè¿™ä¸ªå¥å­æ˜¯ç¬¦åˆè¯­æ³•è§„åˆ™çš„ï¼Œä¹Ÿç¬¦åˆè¯­ä¹‰è§„åˆ™ã€‚ä½†æ˜¯å¤§å­¦ä¸Šæˆ‘ï¼Œè™½ç„¶ç¬¦åˆè¯­æ³•è§„åˆ™ï¼Œä½†æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œæ‰€ä»¥è¯´æ˜¯ä¸ç¬¦åˆè¯­ä¹‰çš„ã€‚ å¯¹äºHTTPè¯·æ±‚æ¥è¯´ï¼Œè¯­æ³•æ˜¯æŒ‡è¯·æ±‚å“åº”çš„æ ¼å¼ï¼Œæ¯”å¦‚è¯·æ±‚ç¬¬ä¸€è¡Œå¿…é¡»æ˜¯ æ–¹æ³•å URI åè®®/ç‰ˆæœ¬ è¿™æ ·çš„æ ¼å¼ã€‚ è¯­ä¹‰åˆ™å®šä¹‰äº†è¿™ä¸€ç±»å‹çš„è¯·æ±‚å…·æœ‰ä»€ä¹ˆæ ·çš„æ€§è´¨ã€‚æ¯”å¦‚GETçš„è¯­ä¹‰å°±æ˜¯ã€Œè·å–èµ„æºã€ï¼ŒPOSTçš„è¯­ä¹‰æ˜¯ã€Œå¤„ç†èµ„æºã€ï¼Œé‚£ä¹ˆåœ¨å…·ä½“å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•æ—¶ï¼Œå°±å¿…é¡»è€ƒè™‘å…¶è¯­ä¹‰ï¼Œåšå‡ºç¬¦åˆå…¶è¯­ä¹‰çš„è¡Œä¸ºã€‚ å½“ç„¶åœ¨ç¬¦åˆè¯­æ³•çš„å‰æä¸‹å®ç°è¿èƒŒè¯­ä¹‰çš„è¡Œä¸ºä¹Ÿæ˜¯å¯ä»¥åšåˆ°çš„ï¼Œæ¯”å¦‚ä½¿ç”¨GETæ–¹æ³•ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼ŒPOSTè·å–èµ„æºåˆ—è¡¨ï¼Œè¿™æ ·å°±åªèƒ½è¯´è¿™ä¸ªè¯·æ±‚æ˜¯ã€Œåˆæ³•ã€çš„ï¼Œä½†ä¸æ˜¯ã€Œç¬¦åˆè¯­ä¹‰ã€çš„ã€‚ RFC7231é‡Œç´§æ¥ç€å®šä¹‰äº†HTTPæ–¹æ³•çš„å‡ ä¸ªç‰¹æ€§ï¼š Safe - å®‰å…¨è¿™é‡Œçš„ã€Œå®‰å…¨ã€å’Œé€šå¸¸ç†è§£çš„ã€Œå®‰å…¨ã€æ„ä¹‰ä¸åŒï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•çš„è¯­ä¹‰åœ¨æœ¬è´¨ä¸Šæ˜¯ã€Œåªè¯»ã€çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±æ˜¯å®‰å…¨çš„ã€‚å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯çš„èµ„æºå‘èµ·çš„è¯·æ±‚å¦‚æœä½¿ç”¨äº†æ˜¯å®‰å…¨çš„æ–¹æ³•ï¼Œå°±ä¸åº”è¯¥å¼•èµ·æœåŠ¡ç«¯ä»»ä½•çš„çŠ¶æ€å˜åŒ–ï¼Œå› æ­¤ä¹Ÿæ˜¯æ— å®³çš„ã€‚ æ­¤RFCå®šä¹‰ï¼ŒGET, HEAD, OPTIONS å’Œ TRACE è¿™å‡ ä¸ªæ–¹æ³•æ˜¯å®‰å…¨çš„ã€‚ä½†æ˜¯è¿™ä¸ªå®šä¹‰åªæ˜¯è§„èŒƒï¼Œå¹¶ä¸èƒ½ä¿è¯æ–¹æ³•çš„å®ç°ä¹Ÿæ˜¯å®‰å…¨çš„ï¼ŒæœåŠ¡ç«¯çš„å®ç°å¯èƒ½ä¼šä¸ç¬¦åˆæ–¹æ³•è¯­ä¹‰ï¼Œæ­£å¦‚ä¸Šæ–‡è¯´è¿‡çš„ä½¿ç”¨GETä¿®æ”¹ç”¨æˆ·ä¿¡æ¯çš„æƒ…å†µã€‚å¼•å…¥å®‰å…¨è¿™ä¸ªæ¦‚å¿µçš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç½‘ç»œçˆ¬è™«å’Œç¼“å­˜ï¼Œä»¥å…è°ƒç”¨æˆ–è€…ç¼“å­˜æŸäº›ä¸å®‰å…¨æ–¹æ³•æ—¶å¼•èµ·æŸäº›æ„å¤–çš„åæœã€‚User Agentï¼ˆæµè§ˆå™¨ï¼‰åº”è¯¥åœ¨æ‰§è¡Œå®‰å…¨å’Œä¸å®‰å…¨æ–¹æ³•æ—¶åšå‡ºåŒºåˆ†å¯¹å¾…ï¼Œå¹¶ç»™ç”¨æˆ·ä»¥æç¤ºã€‚ Idempotent - å¹‚ç­‰å¹‚ç­‰çš„æ¦‚å¿µæ˜¯æŒ‡åŒä¸€ä¸ªè¯·æ±‚æ–¹æ³•æ‰§è¡Œå¤šæ¬¡å’Œä»…æ‰§è¡Œä¸€æ¬¡çš„æ•ˆæœå®Œå…¨ç›¸åŒã€‚æŒ‰ç…§RFCè§„èŒƒï¼ŒPUTï¼ŒDELETEå’Œå®‰å…¨æ–¹æ³•éƒ½æ˜¯å¹‚ç­‰çš„ã€‚åŒæ ·ï¼Œè¿™ä¹Ÿä»…ä»…æ˜¯è§„èŒƒï¼ŒæœåŠ¡ç«¯å®ç°æ˜¯å¦å¹‚ç­‰æ˜¯æ— æ³•ç¡®ä¿çš„ã€‚å¼•å…¥å¹‚ç­‰ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†åŒä¸€ä¸ªè¯·æ±‚é‡å¤å‘é€çš„æƒ…å†µï¼Œæ¯”å¦‚åœ¨è¯·æ±‚å“åº”å‰å¤±å»è¿æ¥ï¼Œå¦‚æœæ–¹æ³•æ˜¯å¹‚ç­‰çš„ï¼Œå°±å¯ä»¥æ”¾å¿ƒåœ°é‡å‘ä¸€æ¬¡è¯·æ±‚ã€‚è¿™ä¹Ÿæ˜¯æµè§ˆå™¨åœ¨åé€€/åˆ·æ–°æ—¶é‡åˆ°POSTä¼šç»™ç”¨æˆ·æç¤ºçš„åŸå› ï¼šPOSTè¯­ä¹‰ä¸æ˜¯å¹‚ç­‰çš„ï¼Œé‡å¤è¯·æ±‚å¯èƒ½ä¼šå¸¦æ¥æ„æƒ³ä¸åˆ°çš„åæœã€‚ Cacheable - å¯ç¼“å­˜æ€§é¡¾åæ€ä¹‰å°±æ˜¯ä¸€ä¸ªæ–¹æ³•æ˜¯å¦å¯ä»¥è¢«ç¼“å­˜ï¼Œæ­¤RFCé‡ŒGETï¼ŒHEADå’ŒæŸäº›æƒ…å†µä¸‹çš„POSTéƒ½æ˜¯å¯ç¼“å­˜çš„ï¼Œä½†æ˜¯ç»å¤§å¤šæ•°çš„æµè§ˆå™¨çš„å®ç°é‡Œä»…ä»…æ”¯æŒGETå’ŒHEADã€‚ åœ¨è¿™ä¸‰ä¸ªç‰¹æ€§é‡Œä¸€ç›´åœ¨å¼ºè°ƒåŒä¸€ä¸ªäº‹æƒ…ï¼Œé‚£å°±æ˜¯åè®®ä¸ç­‰äºå®ç°ï¼šåè®®è§„å®šå®‰å…¨åœ¨å®ç°é‡Œä¸ä¸€å®šå®‰å…¨ï¼Œåè®®è§„å®šå¹‚ç­‰åœ¨å®ç°é‡Œä¸ä¸€å®šå¹‚ç­‰ï¼Œåè®®è§„å®šå¯ç¼“å­˜åœ¨å®ç°é‡Œä¸ä¸€å®šå¯ç¼“å­˜ã€‚ è¯­ä¹‰ä¹‹äº‰GETçš„è¯­ä¹‰æ˜¯è¯·æ±‚è·å–æŒ‡å®šçš„èµ„æºã€‚GETæ–¹æ³•æ˜¯å®‰å…¨ã€å¹‚ç­‰ã€å¯ç¼“å­˜çš„ï¼ˆé™¤éæœ‰ Cache-Control Headerçš„çº¦æŸï¼‰,GETæ–¹æ³•çš„æŠ¥æ–‡ä¸»ä½“æ²¡æœ‰ä»»ä½•è¯­ä¹‰ã€‚ POSTçš„è¯­ä¹‰æ˜¯æ ¹æ®è¯·æ±‚è´Ÿè·ï¼ˆæŠ¥æ–‡ä¸»ä½“ï¼‰å¯¹æŒ‡å®šçš„èµ„æºåšå‡ºå¤„ç†ï¼Œå…·ä½“çš„å¤„ç†æ–¹å¼è§†èµ„æºç±»å‹è€Œä¸åŒã€‚POSTä¸å®‰å…¨ï¼Œä¸å¹‚ç­‰ï¼Œï¼ˆå¤§éƒ¨åˆ†å®ç°ï¼‰ä¸å¯ç¼“å­˜ã€‚ TCPä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ TCPä½œä¸ºä¸€ç§å¯é ä¼ è¾“æ§åˆ¶åè®®,å…¶æ ¸å¿ƒæ€æƒ³:æ—¢è¦ä¿è¯æ•°æ®å¯é ä¼ è¾“,åˆè¦æé«˜ä¼ è¾“çš„æ•ˆç‡ ä¸‰æ¬¡æ˜¯ä¿è¯åŒæ–¹äº’ç›¸æ˜ç¡®å¯¹æ–¹èƒ½æ”¶èƒ½å‘çš„æœ€ä½å€¼ å‚è€ƒ TCP/IPåè®® ç™¾åº¦ç™¾ç§‘ 99%çš„äººéƒ½ç†è§£é”™äº†HTTPä¸­GETä¸POSTçš„åŒºåˆ« å›¾è§£HTTP-è¯»ä¹¦ç¬”è®° HTTP æ–¹æ³•ï¼šGET å¯¹æ¯” POST HTTPåè®®ä¸­GETå’ŒPOSTæ–¹æ³•çš„åŒºåˆ« TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ","categories":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/categories/HTTP/"}],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/tags/HTTP/"}]},{"title":"å•ä¾‹æ¨¡å¼","slug":"å•ä¾‹æ¨¡å¼","date":"2018-04-16T05:35:59.000Z","updated":"2018-04-20T13:20:30.545Z","comments":true,"path":"2018/04/16/å•ä¾‹æ¨¡å¼/","link":"","permalink":"https://hsb786.github.io/2018/04/16/å•ä¾‹æ¨¡å¼/","excerpt":"å®šä¹‰ï¼šå•ä¾‹å¯¹è±¡çš„ç±»å¿…é¡»ä¿è¯åªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨åœºæ™¯ï¼šå¸Œæœ›åœ¨æ•´ä¸ªç³»ç»Ÿä¸­åªèƒ½å‡ºç°æŸä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ åˆ†ç±» æ‡’æ±‰å¼ï¼šæŒ‡å…¨å±€çš„å•ä¾‹å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶æ„å»º é¥¿æ±‰å¼ï¼šæŒ‡å…¨å±€çš„å•ä¾‹å®ä¾‹åœ¨ç±»è£…è½½æ—¶æ„å»º æ—¥å¸¸æˆ‘ä»¬ä½¿ç”¨çš„è¾ƒå¤šçš„åº”è¯¥æ˜¯æ‡’æ±‰å¼çš„å•ä¾‹ï¼Œå› ä¸ºæŒ‰éœ€åŠ è½½æ‰èƒ½åšåˆ°èµ„æºçš„æœ€å¤§åŒ–åˆ©ç”¨ã€‚","text":"å®šä¹‰ï¼šå•ä¾‹å¯¹è±¡çš„ç±»å¿…é¡»ä¿è¯åªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨åœºæ™¯ï¼šå¸Œæœ›åœ¨æ•´ä¸ªç³»ç»Ÿä¸­åªèƒ½å‡ºç°æŸä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ åˆ†ç±» æ‡’æ±‰å¼ï¼šæŒ‡å…¨å±€çš„å•ä¾‹å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶æ„å»º é¥¿æ±‰å¼ï¼šæŒ‡å…¨å±€çš„å•ä¾‹å®ä¾‹åœ¨ç±»è£…è½½æ—¶æ„å»º æ—¥å¸¸æˆ‘ä»¬ä½¿ç”¨çš„è¾ƒå¤šçš„åº”è¯¥æ˜¯æ‡’æ±‰å¼çš„å•ä¾‹ï¼Œå› ä¸ºæŒ‰éœ€åŠ è½½æ‰èƒ½åšåˆ°èµ„æºçš„æœ€å¤§åŒ–åˆ©ç”¨ã€‚ å•ä¾‹æ¨¡å¼çš„å®ç°æ‡’æ±‰å¼å•ä¾‹1234567891011121314public class Single &#123; private static volatile Single instance; private Single() &#123;&#125; public static Single getInstance() &#123; if (instance == null) &#123; synchronized (Single.class) &#123; if (instance == null) &#123; instance = new Single(); &#125; &#125; &#125; return instance; &#125;&#125; instance = new Single()ï¼›è¿™ä¸ªè¯­å¥åœ¨JVMä¸­ï¼Œå®é™…æ‰§è¡Œçš„åŸå­è¯­å¥åŒ…æ‹¬ï¼š ç»™Singleåˆ†é…å†…å­˜ è°ƒç”¨Singleçš„æ„é€ å‡½æ•°å®Œæˆåˆå§‹åŒ–ï¼Œè¿”å›ç±»å®ä¾‹ å°†instanceæŒ‡å‘ä¹‹å‰åˆ†é…çš„å®Œæˆåˆå§‹åŒ–çš„å†…å­˜ ç¼–è¯‘å™¨åœ¨ä¸æ”¹å˜å•çº¿ç¨‹ç¨‹åºè¯­ä¹‰çš„å‰æä¸‹ï¼Œå¯ä»¥å¯¹æŒ‡ä»¤é‡æ’åºã€‚1-2-3å¯èƒ½ä¼šå˜æˆ1-3-2 å¯¼è‡´çš„ç»“æœå¯èƒ½å°±æ˜¯ï¼Œçº¿ç¨‹Bæ‰§è¡Œåˆ°1- 3 , å·²ç»å°†instanceå¼•ç”¨æŒ‡å‘äº†åˆ†é…çš„å†…å­˜ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™instanceå¹¶ä¸ç­‰äºnullï¼Œä½†æ˜¯æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚ç„¶åï¼Œçº¿ç¨‹Bè®©å‡ºCPUï¼Œçº¿ç¨‹Aå¼€å§‹æ‰§è¡Œï¼Œåˆ¤æ–­if(instance==null)ï¼Œç”±äºinstanceä¸ç­‰äºnullï¼Œäºæ˜¯çº¿ç¨‹Aå°±ç›´æ¥è¿”å›è¿™ä¸ªinstanceï¼Œä½†æ˜¯è¿™ä¸ªå¯¹è±¡æ˜¯çº¿ç¨‹Bæ²¡æœ‰åˆå§‹åŒ–çš„å¯¹è±¡ã€‚ soï¼ŒåŠ ä¸Švolatileä¿®é¥°åï¼Œå°±å¯ä»¥ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œéµå¾ªhappens-beforeåŸåˆ™ã€‚ä¿è¯Bçº¿ç¨‹å¯¹instanceçš„ä¿®æ”¹happens-beforeäºAçº¿ç¨‹å¯¹instanceçš„è¯»ã€‚ é¥¿æ±‰å¼å•ä¾‹1234567public class Singleton &#123; private static Singleton instance = new Singleton(); private Singleton ()&#123;&#125; public static Singleton getInstance() &#123; return instance; &#125; &#125; é™æ€å†…éƒ¨ç±»å®ç° 123456789public class Singleton &#123; private static class SingletonHolder &#123; private static final Singleton INSTANCE = new Singleton(); &#125; private Singleton ()&#123;&#125; public static final Singleton getInstance() &#123; return SingletonHolder.INSTANCE; &#125;&#125; å‰ä¸€ç§æ–¹æ³•åªè¦Singleç±»è¢«åŠ è½½äº†ï¼Œé‚£ä¹ˆinstanceå°±ä¼šè¢«å®ä¾‹åŒ–ã€‚è€Œè¿™ç§æ–¹å¼æ˜¯Singletonç±»è¢«åŠ è½½äº†ï¼Œinstanceä¸ä¸€å®šè¢«å®ä¾‹åŒ–ã€‚å› ä¸ºSingletonHolerç±»æ²¡æœ‰è¢«ä¸»åŠ¨ä½¿ç”¨ï¼Œåªåœ¨å¤–éƒ¨ç±»çš„Singletonçš„getInstance()ä¸­è¢«è°ƒç”¨æ—¶æ‰åŠ è½½ï¼Œä»è€Œå®ä¾‹åŒ–Instanceï¼Œè¿™æ ·å°±å¯ä»¥å¯åŠ¨å»¶è¿ŸåŠ è½½ã€‚ å‚è€ƒ å•ä¾‹æ¨¡å¼ è®¾è®¡æ¨¡å¼ï¼ˆäºŒï¼‰â€”â€”å•ä¾‹æ¨¡å¼ [è½¬+æ³¨]å•ä¾‹æ¨¡å¼çš„ä¸ƒç§å†™æ³•","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/categories/è®¾è®¡æ¨¡å¼/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://hsb786.github.io/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"Integer","slug":"Integer","date":"2018-04-16T05:09:49.000Z","updated":"2018-04-20T13:16:50.058Z","comments":true,"path":"2018/04/16/Integer/","link":"","permalink":"https://hsb786.github.io/2018/04/16/Integer/","excerpt":"ç±»å®šä¹‰public final class Integer extends Number implements Comparable&lt;Integer&gt; Integerä¸èƒ½è¢«ç»§æ‰¿ Integerå®ç°äº†Comparableæ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ç”¨compareToè¿›è¡Œæ¯”è¾ƒå¹¶ä¸”Integerå¯¹è±¡åªèƒ½å’ŒIntegerç±»å‹çš„å¯¹è±¡è¿›è¡Œæ¯”è¾ƒ Integerç»§æ‰¿äº†Numberç±»ï¼Œæ‰€ä»¥è¯¥ç±»å¯ä»¥è°ƒç”¨longValueã€floatValueã€doubleValueç­‰ç³»åˆ—æ–¹æ³•è¿”å›å¯¹åº”çš„ç±»å‹çš„å€¼","text":"ç±»å®šä¹‰public final class Integer extends Number implements Comparable&lt;Integer&gt; Integerä¸èƒ½è¢«ç»§æ‰¿ Integerå®ç°äº†Comparableæ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ç”¨compareToè¿›è¡Œæ¯”è¾ƒå¹¶ä¸”Integerå¯¹è±¡åªèƒ½å’ŒIntegerç±»å‹çš„å¯¹è±¡è¿›è¡Œæ¯”è¾ƒ Integerç»§æ‰¿äº†Numberç±»ï¼Œæ‰€ä»¥è¯¥ç±»å¯ä»¥è°ƒç”¨longValueã€floatValueã€doubleValueç­‰ç³»åˆ—æ–¹æ³•è¿”å›å¯¹åº”çš„ç±»å‹çš„å€¼ å±æ€§private final int value; valueå±æ€§å°±æ˜¯Integerå¯¹è±¡ä¸­ä¿å­˜çš„intå€¼ æ–¹æ³•12Integer i=new Integer(1);i=2; åç¼–è¯‘ä¹‹åçš„ä»£ç  12Integer i = new Integer(1);i = Integer.valueOf(2); ç¼–è¯‘å™¨ä¼šæŠŠi=2è½¬æ¢æˆi=Integer.valueOf(2)ï¼› 12345public static Integer valueOf(int i) &#123; if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high) return IntegerCache.cache[i + (-IntegerCache.low)]; return new Integer(i);&#125; é€šå¸¸æƒ…å†µä¸‹ï¼ŒIntegerCache.low=-128ï¼ŒIntegerCache.high=127ï¼ˆé™¤éæ˜¾ç¤ºå£°æ˜java.lang.Integer.IntegerCache.highçš„å€¼ï¼‰ï¼ŒIntegerä¸­æœ‰ä¸€æ®µé™æ€ä»£ç å—ï¼Œè¯¥éƒ¨åˆ†å†…å®¹ä¼šåœ¨Integerç±»è¢«åŠ è½½çš„æ—¶å€™å°±æ‰§è¡Œã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * Cache to support the object identity semantics of autoboxing for values between * -128 and 127 (inclusive) as required by JLS. * * The cache is initialized on first usage. The size of the cache * may be controlled by the &#123;@code -XX:AutoBoxCacheMax=&lt;size&gt;&#125; option. * During VM initialization, java.lang.Integer.IntegerCache.high property * may be set and saved in the private system properties in the * sun.misc.VM class. */private static class IntegerCache &#123; static final int low = -128; static final int high; static final Integer cache[]; static &#123; // high value may be configured by property int h = 127; String integerCacheHighPropValue = sun.misc.VM.getSavedProperty(&quot;java.lang.Integer.IntegerCache.high&quot;); if (integerCacheHighPropValue != null) &#123; try &#123; int i = parseInt(integerCacheHighPropValue); i = Math.max(i, 127); // Maximum array size is Integer.MAX_VALUE h = Math.min(i, Integer.MAX_VALUE - (-low) -1); &#125; catch( NumberFormatException nfe) &#123; // If the property cannot be parsed into an int, ignore it. &#125; &#125; high = h; cache = new Integer[(high - low) + 1]; int j = low; for(int k = 0; k &lt; cache.length; k++) cache[k] = new Integer(j++); // range [-128, 127] must be interned (JLS7 5.1.7) assert IntegerCache.high &gt;= 127; &#125; private IntegerCache() &#123;&#125;&#125; ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“Integerè¢«åŠ è½½æ—¶ï¼Œå°±æ–°å»ºäº†-128åˆ°127çš„æ‰€æœ‰æ•°å­—å¹¶å­˜æ”¾åœ¨Integeræ•°ç»„cacheä¸­ã€‚ å†å›åˆ°valueOfä»£ç ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºã€‚å½“è°ƒç”¨valueOfæ–¹æ³•æ—¶ï¼Œå¦‚æœå‚æ•°çš„å€¼åœ¨-127åˆ°128ä¹‹é—´ï¼Œåˆ™ç›´æ¥ä»ç¼“å­˜ä¸­è¿”å›ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡ã€‚å¦‚æœå‚æ•°çš„å€¼ä¸åœ¨è¿™ä¸ªèŒƒå›´å†…ï¼Œåˆ™newä¸€ä¸ªIntegerå¯¹è±¡è¿”å›ã€‚ æ‰€ä»¥ï¼Œå½“æŠŠä¸€ä¸ªintå˜é‡è½¬æˆIntegerçš„æ—¶å€™ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªIntegerçš„æ—¶å€™ï¼‰ï¼Œå»ºè®®ä½¿ç”¨valueOfæ–¹æ³•æ¥ä»£æ›¿æ„é€ å‡½æ•°ã€‚æˆ–è€…ç›´æ¥ä½¿ç”¨Integer i = 100;ç¼–è¯‘å™¨ä¼šè½¬æˆInteger s = Integer.valueOf(100); å‚è€ƒ Java æºç å­¦ä¹ ç³»åˆ—ï¼ˆä¸‰ï¼‰â€”â€”Integer","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"String","slug":"String","date":"2018-04-16T04:35:57.000Z","updated":"2018-04-24T11:27:31.510Z","comments":true,"path":"2018/04/16/String/","link":"","permalink":"https://hsb786.github.io/2018/04/16/String/","excerpt":"Javaè¯­è¨€æä¾›äº†å¯¹å­—ç¬¦ä¸²è¿æ¥å…ƒç´ ç¬¦çš„ç‰¹åˆ«æ”¯æŒï¼ˆ+ï¼‰ï¼Œè¯¥ç¬¦å·ä¹Ÿå¯ç”¨äºå°†å…¶ä»–ç±»å‹è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²çš„è¿æ¥å®é™…ä¸Šæ˜¯é€šè¿‡StringBuilderçš„append()æ–¹æ³•æ¥å®ç°çš„ï¼Œå­—ç¬¦ä¸²çš„è½¬æ¢é€šè¿‡toStringæ–¹æ³•å®ç°ã€‚","text":"Javaè¯­è¨€æä¾›äº†å¯¹å­—ç¬¦ä¸²è¿æ¥å…ƒç´ ç¬¦çš„ç‰¹åˆ«æ”¯æŒï¼ˆ+ï¼‰ï¼Œè¯¥ç¬¦å·ä¹Ÿå¯ç”¨äºå°†å…¶ä»–ç±»å‹è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²çš„è¿æ¥å®é™…ä¸Šæ˜¯é€šè¿‡StringBuilderçš„append()æ–¹æ³•æ¥å®ç°çš„ï¼Œå­—ç¬¦ä¸²çš„è½¬æ¢é€šè¿‡toStringæ–¹æ³•å®ç°ã€‚ å®šä¹‰public final class String implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence{} å±æ€§private final char value[]; è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œå¹¶ä¸”æ˜¯finalç±»å‹ï¼Œå®ƒç”¨äºå­˜å‚¨å­—ç¬¦ä¸²å†…å®¹ï¼Œä»finalè¿™ä¸ªå…³é”®å­—ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒStringçš„å†…å®¹ä¸€æ—¦è¢«åˆå§‹åŒ–äº†æ˜¯ä¸èƒ½è¢«æ”¹å˜çš„ã€‚ private int hash; ç¼“å­˜å­—ç¬¦ä¸²çš„hashCodeï¼Œé»˜è®¤å€¼ä¸º0 intern()java7ä»¥åï¼Œå¸¸é‡æ± è¢«æ”¾å…¥åˆ°å †ç©ºé—´ä¸­ã€‚å¯¼è‡´intern()å‡½æ•°çš„åŠŸèƒ½ä¸åŒã€‚intern()æ£€æŸ¥å¸¸é‡æ± æ˜¯å¦å­˜åœ¨è¯¥å­—ç¬¦ä¸²ï¼Œå­˜åœ¨çš„è¯å°±ç›´æ¥è¿”å›ï¼›å¦åˆ™è¿”å›é¦–æ¬¡åœ¨å †ä¸­å£°æ˜çš„ç›¸åŒå­—ç¬¦ä¸²çš„å¼•ç”¨ +12String str=&quot;11&quot;;System.out.println(&quot;ab&quot; + &quot;c&quot;+str + &quot;e&quot;); ç¼–è¯‘å™¨ä¼˜åŒ–åçš„ç»“æœ12String str = &quot;11&quot;;System.out.println(&quot;abc&quot; + str + &quot;e&quot;); 123456789101112131415Code: 0: ldc #19 // String 11 2: astore_1 3: getstatic #21 // Field java/lang/System.out:Ljava/io/PrintStream; 6: new #27 // class java/lang/StringBuilder 9: dup 10: ldc #29 // String abc 12: invokespecial #31 // Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V 15: aload_1 16: invokevirtual #34 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder; 19: ldc #38 // String e 21: invokevirtual #34 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder; 24: invokevirtual #40 // Method java/lang/StringBuilder.toString:()Ljava/lang/String; 27: invokevirtual #44 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 30: return å®é™…æ‰§è¡Œ12String str = &quot;11&quot;;System.out.println(new StringBuilder(&quot;abc&quot;).apend(str) .addpend(&quot;e&quot;).toString());","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"enum","slug":"enum","date":"2018-04-16T03:47:49.000Z","updated":"2018-05-02T05:47:31.262Z","comments":true,"path":"2018/04/16/enum/","link":"","permalink":"https://hsb786.github.io/2018/04/16/enum/","excerpt":"Enumç±»æ˜¯java.langåŒ…ä¸­çš„ä¸€ä¸ªç±»ï¼Œä»–æ˜¯Javaè¯­è¨€ä¸­æ‰€æœ‰æšä¸¾ç±»å‹çš„å…¬å…±åŸºç±»","text":"Enumç±»æ˜¯java.langåŒ…ä¸­çš„ä¸€ä¸ªç±»ï¼Œä»–æ˜¯Javaè¯­è¨€ä¸­æ‰€æœ‰æšä¸¾ç±»å‹çš„å…¬å…±åŸºç±» public abstract class Enum&lt;E extends Enum&lt;E&gt;&gt; implements Comparable&lt;E&gt;, Serializable Enumç±»æ— æ³•è¢«ç»§æ‰¿ å®šä¹‰ä¸€ä¸ªColoræšä¸¾ enum Color {RED, GREEN, YELLOW} åç¼–è¯‘åçš„ç»“æœ12345678910public final class EnumTest.Color extends java.lang.Enum&lt;EnumTest.Color&gt; &#123; public static final EnumTest.Color RED; public static final EnumTest.Color GREEN; public static final EnumTest.Color YELLOW; private static final EnumTest.Color[] ENUM$VALUES; static &#123;&#125;; private EnumTest.Color(java.lang.String, int); public static EnumTest.Color[] values(); public static EnumTest.Color valueOf(java.lang.String);&#125; ä»åç¼–è¯‘ä¹‹åçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œç¼–è¯‘å™¨ä¸è®©æˆ‘ä»¬ç»§æ‰¿Enumï¼Œä½†æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨enumå…³é”®å­—å®šä¹‰ä¸€ä¸ªæšä¸¾çš„æ—¶å€™ï¼Œä»–ä¼šå¸®æˆ‘ä»¬åœ¨ç¼–è¯‘åé»˜è®¤ç»§æ‰¿java.lang.Enumç±»ï¼Œè€Œä¸åƒå…¶ä»–çš„ç±»ä¸€æ ·é»˜è®¤ç»§æ‰¿Objectç±»ã€‚ä¸”é‡‡ç”¨enumå£°æ˜åï¼Œè¯¥ç±»ä¼šè¢«ç¼–è¯‘å™¨åŠ ä¸Šfinalå£°æ˜ï¼Œæ•…è¯¥ç±»æ˜¯æ— æ³•ç»§æ‰¿çš„ã€‚ Enumå®ç°äº†Serializableå’ŒComparableæ¥å£ï¼Œè¿›è¡Œæ¯”è¾ƒæ—¶åªæœ‰åŒç±»å‹çš„enumæ‰èƒ½è¿›è¡Œæ¯”è¾ƒï¼Œè¦æƒ³å®ç°ä¸åŒç±»å‹çš„enumä¹‹é—´çš„æ¯”è¾ƒï¼Œåªèƒ½é‡å†™compareToæ–¹æ³• Enum&lt;E extends Enum&lt;E>> ä¸€ä¸ªEnumåªæ¥å—ä¸€ä¸ªEnumæˆ–è€…ä»–çš„å­ç±»ä½œä¸ºå‚æ•° compartTo12345678public final int compareTo(E o) &#123; Enum&lt;?&gt; other = (Enum&lt;?&gt;)o; Enum&lt;E&gt; self = this; if (self.getClass() != other.getClass() &amp;&amp; // optimization self.getDeclaringClass() != other.getDeclaringClass()) throw new ClassCastException(); return self.ordinal - other.ordinal; &#125; Javaä½¿ç”¨Enum&lt;E extends Enum&gt;å£°æ˜Enumï¼Œå¹¶ä¸”åœ¨compareToçš„ä¸­ä½¿ç”¨Eä½œä¸ºå‚æ•°ã€‚è¿™ä¸¤ä¸ªæ¡ä»¶é™åˆ¶Color.REDåªèƒ½å’ŒColorå®šä¹‰å‡ºæ¥çš„æšä¸¾è¿›è¡Œæ¯”è¾ƒ æˆå‘˜å˜é‡åœ¨Enumä¸­ï¼Œæœ‰ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼Œä¸€ä¸ªæ˜¯åå­—(name)ï¼Œä¸€ä¸ªæ˜¯åºå·(ordinal)ã€‚åºå·æ˜¯ä¸€ä¸ªæšä¸¾å¸¸é‡ï¼Œè¡¨ç¤ºåœ¨æšä¸¾ä¸­çš„ä½ç½®ï¼Œä»0å¼€å§‹ï¼Œä¾æ¬¡é€’å¢ã€‚ æ„é€ å‡½æ•°Enumæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯ä»–ä¹Ÿæœ‰æ„é€ å‡½æ•°ã€‚1234protected Enum(String nameï¼Œint ordinal)&#123; this.name=name; this.ordinal=ordinal;&#125; å‚è€ƒ Java 7 æºç å­¦ä¹ ç³»åˆ—ï¼ˆäºŒï¼‰â€”â€”Enum","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"javap","slug":"javap","date":"2018-04-15T11:11:13.000Z","updated":"2018-04-20T13:17:12.174Z","comments":true,"path":"2018/04/15/javap/","link":"","permalink":"https://hsb786.github.io/2018/04/15/javap/","excerpt":"javapæ˜¯jdkè‡ªå¸¦çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥å¯¹ä»£ç åç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹javaç¼–è¯‘å™¨ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶","text":"javapæ˜¯jdkè‡ªå¸¦çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥å¯¹ä»£ç åç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹javaç¼–è¯‘å™¨ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ 1234567891011public class T01 &#123; private volatile int n; public void add() &#123; n++; &#125; private void sub() &#123; n--; &#125;&#125; javap T01 è¾“å‡ºT01çš„publicåŸŸåŠæ–¹æ³• javap -c T01 åˆ—å‡ºæ¯ä¸ªæ–¹æ³•æ‰€æ‰§è¡Œçš„JVMæŒ‡ä»¤ï¼Œå¹¶æ˜¾ç¤ºæ¯ä¸ªæ–¹æ³•çš„å­—èŠ‚ç çš„å®é™…ä½œç”¨ javap -p T01 è¾“å‡ºæ‰€æœ‰ç±»å’Œæˆå‘˜ javap -v T01 è¾“å‡ºæ ˆå¤§å°ï¼Œæ–¹æ³•å‚æ•°çš„ä¸ªæ•° è¯­æ³•12345678910-help å¸®åŠ©-l è¾“å‡ºè¡Œå’Œå˜é‡çš„è¡¨-public åªè¾“å‡ºpublicæ–¹æ³•å’ŒåŸŸ-protected åªè¾“å‡ºpublicå’Œprotectedç±»å’Œæˆå‘˜-package åªè¾“å‡ºåŒ…ï¼Œpublicå’Œprotectedç±»å’Œæˆå‘˜ï¼Œè¿™æ˜¯é»˜è®¤çš„-p -private è¾“å‡ºæ‰€æœ‰ç±»å’Œæˆå‘˜-s è¾“å‡ºå†…éƒ¨ç±»å‹ç­¾å-c è¾“å‡ºåˆ†è§£åçš„ä»£ç ï¼Œä¾‹å¦‚ï¼Œç±»ä¸­æ¯ä¸€ä¸ªæ–¹æ³•å†…ï¼ŒåŒ…å«javaå­—èŠ‚ç çš„æŒ‡ä»¤ï¼Œ-verbose è¾“å‡ºæ ˆå¤§å°ï¼Œæ–¹æ³•å‚æ•°çš„ä¸ªæ•°-constants è¾“å‡ºé™æ€finalå¸¸é‡ ç¼–è¯‘ç‰ˆæœ¬ major version javaç‰ˆæœ¬ 46 2 47 3 48 4 49 5 50 6 51 7 52 8","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"LinkedList","slug":"LinkedList","date":"2018-04-15T07:17:54.000Z","updated":"2018-04-21T07:32:36.433Z","comments":true,"path":"2018/04/15/LinkedList/","link":"","permalink":"https://hsb786.github.io/2018/04/15/LinkedList/","excerpt":"LinkedListæ˜¯ç”±åŒå‘é“¾è¡¨å®ç°çš„","text":"LinkedListæ˜¯ç”±åŒå‘é“¾è¡¨å®ç°çš„123456789101112131415161718192021222324public class LinkedList&lt;E&gt; extends AbstractSequentialList&lt;E&gt; implements List&lt;E&gt;, Deque&lt;E&gt;, Cloneable, java.io.Serializable&#123; transient int size = 0; //å¤´èŠ‚ç‚¹ transient Node&lt;E&gt; first; //å°¾èŠ‚ç‚¹ transient Node&lt;E&gt; last; public LinkedList() &#123; &#125; private static class Node&lt;E&gt; &#123; E item; Node&lt;E&gt; next; Node&lt;E&gt; prev; Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123; this.item = element; this.next = next; this.prev = prev; &#125; &#125;&#125; å¯ä»¥çœ‹å‡ºLinkedListå­˜æ”¾äº†Node first,Node lastä¸¤ä¸ªèŠ‚ç‚¹ï¼Œåˆ†åˆ«å¯¹åº”å¤´èŠ‚ç‚¹å’ŒæœªèŠ‚ç‚¹Nodeæ˜¯LinkedListçš„é™æ€å†…éƒ¨ç±»ã€‚é‡Œé¢æœ‰ä¸‰ä¸ªå…ƒç´ ï¼šitemå­˜æ”¾æ•°æ®ï¼Œnextå­˜æ”¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œprevå­˜æ”¾ä¸Šä¸€ä¸ªèŠ‚ç‚¹ public boolean add(E e)1234567891011121314151617public boolean add(E e) &#123; linkLast(e); return true;&#125;//æ·»åŠ eåˆ°é“¾è¡¨å°¾éƒ¨void linkLast(E e) &#123; final Node&lt;E&gt; l = last; final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null); last = newNode; if (l == null) first = newNode; else l.next = newNode; size++; modCount++;&#125; public boolean remove(Object o)1234567891011121314151617181920212223242526272829303132333435363738394041424344public boolean remove(Object o) &#123; if (o == null) &#123; for (Node&lt;E&gt; x = first; x != null; x = x.next) &#123; if (x.item == null) &#123; unlink(x); return true; &#125; &#125; &#125; else &#123; for (Node&lt;E&gt; x = first; x != null; x = x.next) &#123; if (o.equals(x.item)) &#123; unlink(x); return true; &#125; &#125; &#125; return false;&#125;E unlink(Node&lt;E&gt; x) &#123; // assert x != null; final E element = x.item; final Node&lt;E&gt; next = x.next; final Node&lt;E&gt; prev = x.prev; if (prev == null) &#123; first = next; &#125; else &#123; prev.next = next; x.prev = null; &#125; if (next == null) &#123; last = prev; &#125; else &#123; next.prev = prev; x.next = null; &#125; x.item = null; size--; modCount++; return element;&#125;","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"é›†åˆ","slug":"çˆªå“‡/é›†åˆ","permalink":"https://hsb786.github.io/categories/çˆªå“‡/é›†åˆ/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ArrayList","slug":"ArrayList","date":"2018-04-15T06:18:58.000Z","updated":"2018-05-02T05:45:04.495Z","comments":true,"path":"2018/04/15/ArrayList/","link":"","permalink":"https://hsb786.github.io/2018/04/15/ArrayList/","excerpt":"ArrayListåº•å±‚æ˜¯ç”¨æ•°ç»„å®ç°çš„ã€‚","text":"ArrayListåº•å±‚æ˜¯ç”¨æ•°ç»„å®ç°çš„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable&#123; //é»˜è®¤åˆå§‹å®¹é‡ private static final int DEFAULT_CAPACITY = 10; private static final Object[] EMPTY_ELEMENTDATA = &#123;&#125;; //ä¸EMPTY_ELEMENTDATAçš„åŒºåˆ«åœ¨äºå½“ç¬¬ä¸€ä¸ªå…ƒç´ æ·»åŠ æ—¶çŸ¥é“æ€æ ·æ‰©å¼  private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;; //ArrayListå­˜æ”¾å…ƒç´ çš„æ•°ç»„ transient Object[] elementData; //ArrayListå®é™…å…ƒç´ ä¸ªæ•° private int size; public ArrayList(int initialCapacity) &#123; if (initialCapacity &gt; 0) &#123; this.elementData = new Object[initialCapacity]; &#125; else if (initialCapacity == 0) &#123; this.elementData = EMPTY_ELEMENTDATA; &#125; else &#123; throw new IllegalArgumentException(&quot;Illegal Capacity: &quot;+ initialCapacity); &#125; &#125; public ArrayList() &#123; super(); this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA; &#125; public ArrayList(Collection&lt;? extends E&gt; c) &#123; elementData = c.toArray(); if ((size = elementData.length) != 0) &#123; // c.toArray might (incorrectly) not return Object[] (see 6260652) if (elementData.getClass() != Object[].class) elementData = Arrays.copyOf(elementData, size, Object[].class); &#125; else &#123; // replace with empty array. this.elementData = EMPTY_ELEMENTDATA; &#125; &#125;&#125; EMPTY_ELEMENTDATA ä¸ DEFAULTCAPACITY_EMPTY_ELEMENTDATAçœ‹ä¸Šå»æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸¤ä¸ªç›¸ä¼¼çš„å˜é‡å‘¢ï¼Ÿé¦–å…ˆçœ‹addæ–¹æ³•ã€‚ public boolean add(E e)1234567891011121314151617181920212223242526272829303132333435363738394041public boolean add(E e) &#123; //ç¡®å®šå†…éƒ¨å®¹é‡ ensureCapacityInternal(size + 1); elementData[size++] = e; return true;&#125;private void ensureCapacityInternal(int minCapacity) &#123; ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));&#125;private static int calculateCapacity(Object[] elementData, int minCapacity) &#123; if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123; //å¦‚æœæ•°ç»„æŒ‡å‘DEFAULTCAPACITY_EMPTY_ELEMENTDATAï¼Œå°±æ˜¯åˆå§‹åŒ–æ—¶è°ƒç”¨çš„æ˜¯æ— å‚æ„é€ å‡½æ•° //é‚£ä¹ˆminCapacityå°±ç­‰äºDEFAULT_CAPACITY 10 ä¸minCapacityçš„æœ€å¤§å€¼ã€‚ //è¿™æ ·ä¸ç”¨æ¯æ¬¡æ·»åŠ éƒ½æ‰©å®¹ï¼Œä¸€å¼€å§‹å°±åˆ†é…äº†å¤§å°ä¸º10çš„æ•°ç»„ return Math.max(DEFAULT_CAPACITY, minCapacity); &#125; return minCapacity;&#125;private void ensureExplicitCapacity(int minCapacity) &#123; modCount++; //è¶…è¿‡æ•°ç»„å®¹é‡ //æ¯”å¦‚è¯´å½“æ·»åŠ ç¬¬11ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity=11ï¼Œæ­¤æ—¶elementData.lenth=10 //æ‰€ä»¥éœ€è¦å¯¹æ•°ç»„æ‰©å®¹ if (minCapacity - elementData.length &gt; 0) grow(minCapacity);&#125;private void grow(int minCapacity) &#123; int oldCapacity = elementData.length; //å°†æ•°ç»„å®¹é‡æ‰©å®¹ä¸ºåŸæ¥çš„1.5å€ int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); if (newCapacity - minCapacity &lt; 0) newCapacity = minCapacity; if (newCapacity - MAX_ARRAY_SIZE &gt; 0) newCapacity = hugeCapacity(minCapacity); //æ‰©å®¹åï¼Œå°†åŸæ¥çš„æ•°ç»„å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ elementData = Arrays.copyOf(elementData, newCapacity);&#125; private void ensureCapacityInternal(int minCapacity)æ–¹æ³•ä¸­ï¼Œå¦‚æœè°ƒç”¨çš„æ˜¯æ— å‚æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆelementDataå°±æŒ‡å‘DEFAULTCAPACITY_EMPTY_ELEMENTDATAï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œaddæ–¹æ³•æ—¶ï¼Œå°±ä¼šæŠŠemelentDataçš„å®¹é‡åˆå§‹åŒ–ä¸ºMath.max(DEFAULT_CAPACITY, minCapacity) ,ä¹Ÿå°±æ˜¯10ã€‚ å¦‚æœè°ƒç”¨çš„æ˜¯ArrayList(0)æ¥æ„é€ ï¼Œé‚£ä¹ˆelementDateå°±æŒ‡å‘EMPTY_ELEMENTDATAï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œaddæ–¹æ³•æ—¶ï¼Œå¹¶ä¸ä¼šæŠŠemelentDataçš„å®¹é‡åˆå§‹ä¸º10ã€‚è€Œæ˜¯åœ¨growå‡½æ•°ä¸­ï¼ŒnewCapacity=0 &lt; minCapaciey=1 , å®¹é‡ä¸º1 java.util.Arrays12345678910111213141516//å¤åˆ¶originalæ•°ç»„å‰newLengthä½å¹¶è¿”å›public static &lt;T&gt; T[] copyOf(T[] original, int newLength) &#123; return (T[]) copyOf(original, newLength, original.getClass());&#125;public static &lt;T,U&gt; T[] copyOf(U[] original, int newLength, Class&lt;? extends T[]&gt; newType&#123; @SuppressWarnings(&quot;unchecked&quot;) T[] copy = ((Object)newType == (Object)Object[].class) ? (T[]) new Object[newLength] : (T[]) Array.newInstance(newType.getComponentType(), newLength); //å¦‚æœoriginal.length&gt;newLengthï¼Œåˆ™å¤åˆ¶å‰newLengthä½åˆ°copyä¸­ //å¦åˆ™å°†originalå…¨éƒ¨å¤åˆ¶åˆ°copy System.arraycopy(original, 0, copy, 0, Math.min(original.length, newLength)); return copy;&#125; public E remove(int index)1234567891011121314151617public E remove(int index) &#123; //åˆ¤æ–­ä¸‹æ ‡æœ‰æ²¡æœ‰æº¢å‡º rangeCheck(index); modCount++; E oldValue = elementData(index); int numMoved = size - index - 1; if (numMoved &gt; 0) //å°†elementDateä¸­è¦ç§»é™¤å…ƒç´ çš„åé¢å…ƒç´ éƒ½å¾€å‰ç§»ä¸€ä½ System.arraycopy(elementData, index+1, elementData, index, numMoved); //å°†æœ€åä¸€ä¸ªå…ƒç´ è®¾ä¸ºnullï¼Œä»¥ä¾¿è®©GCå›æ”¶ elementData[--size] = null; // clear to let GC do its work return oldValue;&#125; æ€»ç»“ åˆå§‹åŒ–ArrayListæ²¡æœ‰æŒ‡å®šå¤§å°æ—¶ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ åï¼Œå®¹é‡ä¸º10ï¼›è‹¥æŒ‡å®šå¤§å°ä¸º0çš„è¯ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ åï¼Œå®¹é‡ä¸º1ã€‚ ArrayListç”±äºåº•å±‚æ˜¯ç”±æ•°ç»„å®ç°çš„ï¼Œè€Œæ•°ç»„çš„å®¹é‡æ˜¯å›ºå®šçš„ã€‚æ‰€ä»¥æ·»åŠ å…ƒç´ æ—¶ç‰µæ¶‰åˆ°æ•°ç»„çš„æ‰©å®¹ï¼Œæ‰©å®¹æ—¶éœ€è¦æŠŠåŸæ¥çš„æ•°ç»„å¤åˆ¶åˆ°æ‰©å®¹åçš„æ•°ç»„ä¸­ã€‚æ‰©å®¹ä¸ºåŸæ¥çš„1.5å€ã€‚ åˆ é™¤å…ƒç´ æ—¶ï¼Œéœ€è¦æŠŠå¾…åˆ é™¤å…ƒç´ åé¢çš„å…ƒç´ å¾€å‰ç§»ä¸€ä½ï¼Œå¹¶ä¸”å°†æœ€åä¸€ä½ç½®ä¸ºnullã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"é›†åˆ","slug":"çˆªå“‡/é›†åˆ","permalink":"https://hsb786.github.io/categories/çˆªå“‡/é›†åˆ/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"Proxy","slug":"Proxy","date":"2018-04-14T08:14:06.000Z","updated":"2018-04-23T06:17:11.809Z","comments":true,"path":"2018/04/14/Proxy/","link":"","permalink":"https://hsb786.github.io/2018/04/14/Proxy/","excerpt":"JDKåŠ¨æ€ä»£ç†é€šè¿‡java.lang.reflect.Proxyç±»ä»¥åŠjava.lang.reflect.InvocationHandleræ¥å£æ¥å®ç°åŠ¨æ€ä»£ç† InvocationHandlerInvocationHandleræ¥å£çš„å”¯ä¸€æ–¹æ³•ï¼š public Object invoke(Object proxy, Method method, Object[] args) throws Throwable; proxy: ä»£ç†ç±»å®ä¾‹ method: æ–¹æ³• args: æ–¹æ³•å…¥å‚","text":"JDKåŠ¨æ€ä»£ç†é€šè¿‡java.lang.reflect.Proxyç±»ä»¥åŠjava.lang.reflect.InvocationHandleræ¥å£æ¥å®ç°åŠ¨æ€ä»£ç† InvocationHandlerInvocationHandleræ¥å£çš„å”¯ä¸€æ–¹æ³•ï¼š public Object invoke(Object proxy, Method method, Object[] args) throws Throwable; proxy: ä»£ç†ç±»å®ä¾‹ method: æ–¹æ³• args: æ–¹æ³•å…¥å‚ Proxypublic static Object newProxyInstance Proxy.newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces,InvocationHandler h) loaderï¼š ClassLoaderï¼Œå®šä¹‰ç”±å“ªä¸ªClassLoaderå¯¹è±¡ç±»å¯¹ç”Ÿæˆçš„ä»£ç†å¯¹è±¡è¿›è¡ŒåŠ è½½ interfacesï¼šè¯¥å®ç°ç±»çš„æ‰€æœ‰æ¥å£ hï¼šè°ƒç”¨å¤„ç†ç¨‹åºï¼Œè¡¨ç¤ºå½“è¿™ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡åœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šå…³è”åˆ°å“ªä¸€ä¸ªInvocationHandlerå¯¹è±¡ä¸Š 123public interface Hello &#123; void say(String name);&#125; å®šä¹‰è¢«ä»£ç†çš„æ¥å£ 12345678public class HelloImpl implements Hello &#123; @Override public void say(String name) &#123; System.out.println(&quot;Hello &quot; + name); &#125;&#125; æ¥å£çš„å®ç°ç±» 123456789101112131415161718192021222324252627282930313233343536373839404142/** * åœ¨æœ€ç»ˆç”Ÿæˆçš„ä»£ç†ç±»ä¸­åŒ…å«ä¸€ä¸ªInvocationHandlerå®ç°ç±»çš„æˆå‘˜å˜é‡(è¯¥æˆå‘˜å˜é‡ç»§æ‰¿è‡ªProxyç±»)ã€‚ * åœ¨ä»£ç†ç±»å®ä¾‹è°ƒç”¨ä»£ç†çš„æ–¹æ³•æ—¶ï¼Œå°†å¯¹æ–¹æ³•è°ƒç”¨è¿›è¡Œç¼–ç (Methodå˜é‡)å¹¶å°†å…¶æŒ‡æ´¾åˆ°å®ƒçš„è°ƒç”¨å¤„ç†ç¨‹åºçš„invokeæ–¹æ³•ã€‚ * æ‰€ä»¥å¯¹è¢«ä»£ç†æ–¹æ³•çš„è°ƒç”¨éƒ½æ˜¯é€šè¿‡InvocationHadlerçš„invokeæ¥å®ç°çš„ã€‚ */public class DynamicProxy implements InvocationHandler &#123; //ç›®æ ‡å¯¹è±¡ï¼Œè¢«ä»£ç†æ¥å£çš„å®ç°ç±» private Object target; public DynamicProxy(Object target) &#123; this.target = target; &#125; /** * @param proxy ä»£ç†ç±»å®ä¾‹ * @param method æ–¹æ³• * @param args æ–¹æ³•å…¥å‚ */ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; before(); Object result = method.invoke(target, args); after(); return result; &#125; /** * @Description: è·å–ä»£ç†å¯¹è±¡ */ @SuppressWarnings(&quot;unchecked&quot;) public &lt;T&gt; T getProxy() &#123; return (T) Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), this); &#125; private void before() &#123; System.out.println(&quot;Before&quot;); &#125; private void after() &#123; System.out.println(&quot;After&quot;); &#125;&#125; æ‰§è¡Œç¨‹åº12345678910Hello hello = new HelloImpl();DynamicProxy dynamicProxy = new DynamicProxy(hello);Hello helloProxy = dynamicProxy.getProxy();helloProxy.say(&quot;hh&quot;);//output: Before Hello hh After ç”¨DynamicProxyç±»å»åŒ…è£…HelloImplå®ä¾‹ï¼Œç„¶åå†è°ƒç”¨Proxyç±»çš„å·¥å‚æ–¹æ³•newProxyInstance()å»åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªHelloæ¥å£çš„ä»£ç†ç±»ï¼Œè°ƒç”¨è¿™ä¸ªä»£ç†ç±»çš„say()æ–¹æ³•ã€‚ è¢«ä»£ç†æ–¹æ³•çš„è°ƒç”¨éƒ½æ˜¯é€šè¿‡InvocationHadlerçš„invokeæ¥å®ç°çš„ã€‚ Proxy.newProxyInstanceè¿™ä¸ªæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªä»£ç†å¯¹è±¡æä¾›äº†ä¸€ç»„ä»€ä¹ˆæ¥å£ï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ç†å¯¹è±¡å°±ä¼šå®ç°äº†è¿™ç»„æ¥å£ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä»£ç†å¯¹è±¡å¼ºåˆ¶è½¬åŒ–ä¸ºè¿™ç»„æ¥å£ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚ Proxy.newProxyInstance åˆ›å»ºçš„ä»£ç†å¯¹è±¡æ˜¯åœ¨jvmè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆçš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”å‘½åæ–¹å¼éƒ½æ˜¯è¿™æ ·çš„å½¢å¼ï¼Œä»¥$å¼€å¤´ï¼Œproxyä¸ºä¸­ï¼Œæœ€åä¸€ä¸ªæ•°å­—è¡¨ç¤ºå¯¹è±¡çš„æ ‡å·ã€‚ åŠ¨æ€ä»£ç†ï¼Œæ¥å£å˜äº†ï¼Œè¿™ä¸ªåŠ¨æ€ä»£ç†ç±»ä¸ç”¨åŠ¨ã€‚è€Œé™æ€ä»£ç†å°±ä¸ä¸€æ ·äº†ï¼Œæ¥å£å˜äº†ï¼Œä»£ç†ç±»ä¹Ÿè¦å˜ã€‚ä½†æˆ‘ä¹Ÿå‘ç°åŠ¨æ€ä»£ç†å¹¶ä¸æ˜¯â€œä¸‡çµä¸¹â€ï¼Œå®ƒä¹Ÿæœ‰æä¸å®šçš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘è¦ä»£ç†ä¸€ä¸ªæ²¡æœ‰ä»»ä½•æ¥å£çš„ç±»ï¼Œå®ƒå°±æ²¡æœ‰ç”¨æ­¦ä¹‹åœ°äº†ï¼ æ€»ç»“ é€šè¿‡å®ç°InvocationHandleræ¥å£æ¥è‡ªå®šä¹‰è‡ªå·±çš„InvocationHandlerï¼›åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ä¼ å…¥ç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä»£ç†çš„å¯¹è±¡ï¼‰æ¥è¾…åŠ©å®Œæˆinvoke()æ–¹æ³•ï¼ŒåŒæ—¶å¯ä»¥åœ¨invokeæ–¹æ³•ä¸­ç»‡å…¥å¢å¼ºé€»è¾‘ã€‚ é€šè¿‡Proxy.newProxyInstanceæ¥åŠ¨æ€åˆ›å»ºä»£ç†ç±» é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡InvocationHandlerå®ç°ç±»çš„invoke()æ–¹æ³•è°ƒç”¨ èƒ½å¦ä»£ç†æ²¡æœ‰æ¥å£çš„ç±»? CGLib è¿™ä¸ªç±»åº“ã€‚è™½ç„¶å®ƒçœ‹èµ·æ¥ä¸å¤ªèµ·çœ¼ï¼Œä½† Springã€Hibernate è¿™æ ·ç‰›é€¼çš„å¼€æºæ¡†æ¶éƒ½ç”¨åˆ°äº†å®ƒã€‚å®ƒå°±æ˜¯ä¸€ä¸ªåœ¨è¿è¡ŒæœŸé—´åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç çš„å·¥å…·ï¼Œä¹Ÿå°±æ˜¯åŠ¨æ€ç”Ÿæˆä»£ç†ç±»äº†ã€‚ CGLIBåŠ¨æ€ä»£ç†CglibåŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå°è€Œå¿«çš„å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMæ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»ã€‚å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œæ‰€ä»¥è¯¥ç±»æˆ–æ–¹æ³•ä¸èƒ½å£°æ˜ç§°finalçš„ã€‚ 1234567891011121314151617181920212223public class CGLibProxy implements MethodInterceptor &#123; @SuppressWarnings(&quot;unchecked&quot;) public &lt;T&gt; T getProxy(Class&lt;T&gt; cls) &#123; return (T) Enhancer.create(cls, this); &#125; @Override public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable &#123; before(); Object result = proxy.invokeSuper(obj, args); after(); return result; &#125; private void before() &#123; System.out.println(&quot;Before&quot;); &#125; private void after() &#123; System.out.println(&quot;After&quot;); &#125;&#125; éœ€è¦å®ç° CGLib ç»™æˆ‘ä»¬æä¾›çš„ MethodInterceptor å®ç°ç±»ï¼Œå¹¶å¡«å…… intercept() æ–¹æ³•ã€‚æ–¹æ³•ä¸­æœ€åä¸€ä¸ª MethodProxy ç±»å‹çš„å‚æ•° proxyï¼Œå€¼å¾—æ³¨æ„ï¼CGLib ç»™æˆ‘ä»¬æä¾›çš„æ˜¯æ–¹æ³•çº§åˆ«çš„ä»£ç†ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå¯¹æ–¹æ³•çš„æ‹¦æˆªï¼ˆè¿™ä¸å°±æ˜¯ä¼ è¯´ä¸­çš„â€œæ–¹æ³•æ‹¦æˆªå™¨â€å—ï¼Ÿï¼‰ã€‚ ä¸ DynamicProxy ç±»ä¼¼ï¼Œæˆ‘åœ¨ CGlibProxy ä¸­ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªæ³›å‹çš„ getProxy() æ–¹æ³•ï¼Œä¾¿äºæˆ‘ä»¬å¯ä»¥å¿«é€Ÿåœ°è·å–è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ã€‚è¿˜æ˜¯ç”¨ä¸€ä¸ª main() æ–¹æ³•æ¥æè¿°å§ï¼š 123CGLibProxy cgLibProxy = new CGLibProxy();HelloImpl helloProxy2 = cgLibProxy.getProxy(HelloImpl.class);helloProxy2.say(&quot;cg&quot;); ä¸ JDK åŠ¨æ€ä»£ç†ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œä¸éœ€è¦ä»»ä½•çš„æ¥å£ä¿¡æ¯ï¼Œå¯¹è°éƒ½å¯ä»¥ç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†ç”Ÿæˆçš„åŒºåˆ« JDKåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨åå°„æœºåˆ¶ç”Ÿæˆä¸€ä¸ªå®ç°ä»£ç†æ¥å£çš„åŒ¿åç±»ï¼Œåœ¨è°ƒç”¨å…·ä½“æ–¹æ³•å‰è°ƒç”¨InvokeHandleræ¥å¤„ç†ã€‚JDKåŠ¨æ€ä»£ç†åªèƒ½å¯¹å®ç°äº†æ¥å£çš„ç±»ç”Ÿæˆä»£ç†ï¼Œè€Œä¸èƒ½é’ˆå¯¹ç±»ã€‚ CGLIBåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨ASMå¼€æºåŒ…ï¼Œå°†ç›®æ ‡å¯¹è±¡ç±»çš„classæ–‡ä»¶åŠ è½½è¿›æ¥ï¼Œé€šè¿‡ä¿®æ”¹å…¶å­—èŠ‚ç ç”Ÿæˆå­ç±»æ¥å¤„ç†ã€‚CGLIBæ˜¯é’ˆå¯¹ç±»å®ç°ä»£ç†ï¼Œä¸»è¦æ˜¯å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ–¹æ³•ã€‚ JDKåŠ¨æ€ä»£ç†æ˜¯é¢å‘æ¥å£çš„ï¼Œåœ¨åˆ›å»ºä»£ç†å®ç°ç±»æ—¶æ¯”CGLIBè¦å¿«ï¼Œåˆ›å»ºä»£ç†é€Ÿåº¦å¿«ã€‚CGLIBåŠ¨æ€ä»£ç†æ˜¯é€šè¿‡å­—èŠ‚ç åº•å±‚ç»§æ‰¿è¦ä»£ç†ç±»çš„ç›®æ ‡ç±»æ¥å®ç°ï¼Œåˆ›å»ºé€Ÿåº¦æ²¡æœ‰JDKåŠ¨æ€ä»£ç†å¿«ï¼Œä½†æ˜¯è¿è¡Œé€Ÿåº¦æ¯”JDKåŠ¨æ€ä»£ç†å¿«ã€‚ åœ¨Spring AOPä¸­ï¼Œä¸¤ç§ä»£ç†æŠ€æœ¯éƒ½æœ‰ä½¿ç”¨ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡æ˜¯æ¥å£å®ç°ç±»ï¼Œé‚£ä¹ˆSpringé‡‡ç”¨JDKåŠ¨æ€ä»£ç†æ¥å®Œæˆï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸æ˜¯æ¥å£å®ç°ç±»ï¼ŒSpringä¼šä½¿ç”¨CGLIBæ¥å®ç°åŠ¨æ€ä»£ç†ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å¼ºåˆ¶ä½¿ç”¨CGLIBåŠ¨æ€ä»£ç†ã€‚å› ä¸ºåœ¨Springå®¹å™¨ä¸­ï¼Œå¤§å¤šæ•°beanæ˜¯å•ä¾‹çš„ï¼Œæ‰€ä»¥åªåˆ›å»ºä¸€æ¬¡ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨CGLIBæ¥ä»£ç†ã€‚ å‚è€ƒ Proxy é‚£ç‚¹äº‹å„¿ åŠ¨æ€ä»£ç† javaçš„åŠ¨æ€ä»£ç†æœºåˆ¶è¯¦è§£","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ThreadLocal","slug":"ThreadLocal","date":"2018-04-14T07:06:57.000Z","updated":"2018-04-20T13:19:42.824Z","comments":true,"path":"2018/04/14/ThreadLocal/","link":"","permalink":"https://hsb786.github.io/2018/04/14/ThreadLocal/","excerpt":"æ—©åœ¨ JDK 1.2 çš„æ—¶ä»£ï¼Œjava.lang.ThreadLocal å°±è¯ç”Ÿäº†ï¼Œå®ƒæ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜è€Œè®¾è®¡çš„ã€‚ç›¸å½“äºä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºå­˜æ”¾çº¿ç¨‹çš„å±€éƒ¨å˜é‡ï¼Œä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„å‰¯æœ¬ã€‚","text":"æ—©åœ¨ JDK 1.2 çš„æ—¶ä»£ï¼Œjava.lang.ThreadLocal å°±è¯ç”Ÿäº†ï¼Œå®ƒæ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜è€Œè®¾è®¡çš„ã€‚ç›¸å½“äºä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºå­˜æ”¾çº¿ç¨‹çš„å±€éƒ¨å˜é‡ï¼Œä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„å‰¯æœ¬ã€‚ ThreadLocalå¸¸ç”¨æ–¹æ³•ï¼š public void set(T value)ï¼šå°†å€¼æ”¾å…¥çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­ public T get()ï¼šä»çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­è·å–å€¼ public void remove()ï¼šä»çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­ç§»é™¤å€¼ï¼ˆæœ‰åŠ©äº JVM åƒåœ¾å›æ”¶ï¼‰ protected T initialValue()ï¼šè¿”å›çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­çš„åˆå§‹å€¼ï¼ˆé»˜è®¤ä¸º nullï¼‰ ä¸ºä»€ä¹ˆ initialValue() æ–¹æ³•æ˜¯ protected çš„å‘¢ï¼Ÿå°±æ˜¯ä¸ºäº†æé†’ç¨‹åºå‘˜ä»¬ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯è¦ä½ ä»¬æ¥å®ç°çš„ï¼Œè¯·ç»™è¿™ä¸ªçº¿ç¨‹å±€éƒ¨å˜é‡ä¸€ä¸ªåˆå§‹å€¼å§ã€‚ ThreadLocalç®€å•å®ç°1234567891011121314151617181920212223242526public class MyThreadLocal&lt;T&gt; &#123; private Map&lt;Thread, T&gt; container = Collections.synchronizedMap(new HashMap&lt;Thread, T&gt;()); public void set(T value) &#123; container.put(Thread.currentThread(), value); &#125; public T get() &#123; Thread thread = Thread.currentThread(); T value = container.get(thread); if (value == null &amp;&amp; !container.containsKey(thread)) &#123; value = initialValue(); container.put(thread, value); &#125; return value; &#125; public void remove() &#123; container.remove(Thread.currentThread()); &#125; protected T initialValue() &#123; return null; &#125;&#125; ThreadLocal å…·ä½“æœ‰å“ªäº›ä½¿ç”¨æ¡ˆä¾‹å‘¢ï¼Ÿé€šè¿‡ ThreadLocal å­˜æ”¾ JDBC Connectionï¼Œä»¥è¾¾åˆ°äº‹åŠ¡æ§åˆ¶çš„èƒ½åŠ›ã€‚(æ¯ä¸ªçº¿ç¨‹åº”è¯¥æ‹¥æœ‰è‡ªå·±çš„è¿æ¥ï¼Œè€Œä¸æ˜¯å…±äº«åŒä¸€ä¸ªè¿æ¥ï¼Œå¦åˆ™çº¿ç¨‹1æœ‰å¯èƒ½ä¼šå…³é—­çº¿ç¨‹2çš„è¿æ¥) æ³¨æ„ï¼šå½“æ‚¨åœ¨ä¸€ä¸ªç±»ä¸­ä½¿ç”¨äº† static æˆå‘˜å˜é‡çš„æ—¶å€™ï¼Œä¸€å®šè¦å¤šé—®é—®è‡ªå·±ï¼Œè¿™ä¸ª static æˆå‘˜å˜é‡éœ€è¦è€ƒè™‘â€œçº¿ç¨‹å®‰å…¨â€å—ï¼Ÿï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šä¸ªçº¿ç¨‹éœ€è¦ç‹¬äº«è‡ªå·±çš„ static æˆå‘˜å˜é‡å—ï¼Ÿï¼‰å¦‚æœéœ€è¦è€ƒè™‘ï¼Œé‚£å°±è¯·ç”¨ ThreadLocal å§ï¼ å‚è€ƒ ThreadLocal é‚£ç‚¹äº‹å„¿","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/categories/å¤šçº¿ç¨‹/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰","slug":"IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰","date":"2018-04-14T05:22:40.000Z","updated":"2018-04-20T13:16:55.928Z","comments":true,"path":"2018/04/14/IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰/","link":"","permalink":"https://hsb786.github.io/2018/04/14/IOC-å®ç°åŸç†ï¼ˆè½¬è½½ï¼‰/","excerpt":"æœ¬æ¥æƒ³ç ”ç©¶ä¸€ä¸‹Springæºç çš„ï¼Œå¥ˆä½•è‡ªå·±å¤ªæ¸£ï¼Œçœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå‘ç°å±‚æ¬¡å¤ªå¤šï¼Œæ„Ÿè§‰æ— ä»ä¸‹æ‰‹ï¼Œä¹‹åå‘ç°äº†è¿™ç¯‡åšå®¢ï¼Œå¯¥å¯¥å‡ è¡Œä»£ç å°±æŠŠIOCå®ç°äº†ã€‚é“¾æ¥æ”¾åœ¨åº•éƒ¨ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹ é»„äº¿ååˆ†æçš„ï¼ŒåŒæ ·åœ¨åº•éƒ¨ IOC ä¹Ÿå°±æ˜¯â€œæ§åˆ¶åè½¬â€äº†ï¼Œä¸è¿‡æ›´æµè¡Œçš„å«æ³•æ˜¯â€œä¾èµ–æ³¨å…¥â€ï¼ˆDI - Dependency Injectionï¼‰ã€‚å¬èµ·æ¥æŒºé«˜æ·±ï¼Œå…¶å®å®ç°èµ·æ¥å¹¶ä¸å¤æ‚ã€‚ä¸‹é¢å°±çœ‹çœ‹å¦‚ä½•æ¥å®ç°è¿™ä¸ªè½»é‡çº§ IOC æ¡†æ¶ã€‚","text":"æœ¬æ¥æƒ³ç ”ç©¶ä¸€ä¸‹Springæºç çš„ï¼Œå¥ˆä½•è‡ªå·±å¤ªæ¸£ï¼Œçœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå‘ç°å±‚æ¬¡å¤ªå¤šï¼Œæ„Ÿè§‰æ— ä»ä¸‹æ‰‹ï¼Œä¹‹åå‘ç°äº†è¿™ç¯‡åšå®¢ï¼Œå¯¥å¯¥å‡ è¡Œä»£ç å°±æŠŠIOCå®ç°äº†ã€‚é“¾æ¥æ”¾åœ¨åº•éƒ¨ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹ é»„äº¿ååˆ†æçš„ï¼ŒåŒæ ·åœ¨åº•éƒ¨ IOC ä¹Ÿå°±æ˜¯â€œæ§åˆ¶åè½¬â€äº†ï¼Œä¸è¿‡æ›´æµè¡Œçš„å«æ³•æ˜¯â€œä¾èµ–æ³¨å…¥â€ï¼ˆDI - Dependency Injectionï¼‰ã€‚å¬èµ·æ¥æŒºé«˜æ·±ï¼Œå…¶å®å®ç°èµ·æ¥å¹¶ä¸å¤æ‚ã€‚ä¸‹é¢å°±çœ‹çœ‹å¦‚ä½•æ¥å®ç°è¿™ä¸ªè½»é‡çº§ IOC æ¡†æ¶ã€‚ä»å®ä¾‹å‡ºå‘ï¼Œå…ˆçœ‹çœ‹ä»¥ä¸‹ Action ä»£ç ã€‚ 123456789101112131415161718@Beanpublic class ProductAction extends BaseAction &#123; @Inject private ProductService productService; @Request(&quot;GET:/product/&#123;id&#125;&quot;) public Result getProductById(long productId) &#123; if (productId == 0) &#123; return new Result(ERROR_PARAM); &#125; Product product = productService.getProduct(productId); if (product != null) &#123; return new Result(OK, product); &#125; else &#123; return new Result(ERROR_DATA); &#125; &#125;&#125; ä»¥ä¸Šä½¿ç”¨äº†ä¸¤ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼š@Bean ä¸ @Injectã€‚åœ¨ ProductAction ç±»ä¸Šæ ‡æ³¨äº† @Bean æ³¨è§£ï¼Œè¡¨ç¤ºè¯¥ç±»ä¼šäº¤ç»™â€œå®¹å™¨â€å¤„ç†ï¼Œä»¥ä¾¿åŠ å…¥ä¾èµ–æ³¨å…¥æ¡†æ¶ã€‚ åœ¨ produceService å­—æ®µä¸Šæ ‡æ³¨äº† @Inject æ³¨è§£ï¼Œè¡¨ç¤ºè¯¥å­—æ®µå°†ä¼šè¢«æ³¨å…¥è¿›æ¥ï¼Œè€Œæ— éœ€ new ProductServiceImpl()ï¼Œå®é™…ä¸Š new è¿™ä»¶äº‹æƒ…ä¸æ˜¯æˆ‘ä»¬åšçš„ï¼Œè€Œæ˜¯æ¡†æ¶åšçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ§åˆ¶æƒæ­£å¥½åè¿‡æ¥äº†ï¼Œæ‰€ä»¥â€œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰â€ä¹Ÿç§°ä½œâ€œæ§åˆ¶åè½¬ï¼ˆIoCï¼‰â€ã€‚ é‚£ä¹ˆï¼Œåº”è¯¥å¦‚ä½•å®ç°ä¾èµ–æ³¨å…¥æ¡†æ¶å‘¢ï¼Ÿé¦–å…ˆè¿˜æ˜¯çœ‹çœ‹ä¸‹é¢çš„ BeanHelper ç±»å§ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class BeanHelper &#123; private static final Map&lt;Class&lt;?&gt;, Object&gt; beanMap = new HashMap&lt;Class&lt;?&gt;, Object&gt;(); static &#123; try &#123; // è·å–å¹¶éå†æ‰€æœ‰çš„ Beanï¼ˆå¸¦æœ‰ @Bean æ³¨è§£çš„ç±»ï¼‰ List&lt;Class&lt;?&gt;&gt; beanClassList = ClassHelper.getClassListByAnnotation(Bean.class); for (Class&lt;?&gt; beanClass : beanClassList) &#123; // åˆ›å»º Bean å®ä¾‹ Object beanInstance = beanClass.newInstance(); // å°† Bean å®ä¾‹æ”¾å…¥ Bean Map ä¸­ï¼ˆé”®ä¸º Bean ç±»ï¼Œå€¼ä¸º Bean å®ä¾‹ï¼‰ beanMap.put(beanClass, beanInstance); &#125; // éå† Bean Map for (Map.Entry&lt;Class&lt;?&gt;, Object&gt; beanEntry : beanMap.entrySet()) &#123; // è·å– Bean ç±»ä¸ Bean å®ä¾‹ Class&lt;?&gt; beanClass = beanEntry.getKey(); Object beanInstance = beanEntry.getValue(); // è·å– Bean ç±»ä¸­æ‰€æœ‰çš„å­—æ®µï¼ˆä¸åŒ…æ‹¬çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼‰ Field[] beanFields = beanClass.getDeclaredFields(); if (ArrayUtil.isNotEmpty(beanFields)) &#123; // éå†æ‰€æœ‰çš„ Bean å­—æ®µ for (Field beanField : beanFields) &#123; // åˆ¤æ–­å½“å‰ Bean å­—æ®µæ˜¯å¦å¸¦æœ‰ @Inject æ³¨è§£ if (beanField.isAnnotationPresent(Inject.class)) &#123; // è·å– Bean å­—æ®µå¯¹åº”çš„æ¥å£ Class&lt;?&gt; interfaceClass = beanField.getType(); // è·å–è¯¥æ¥å£æ‰€æœ‰çš„å®ç°ç±» List&lt;Class&lt;?&gt;&gt; implementClassList = ClassHelper.getClassListByInterface(interfaceClass); if (CollectionUtil.isNotEmpty(implementClassList)) &#123; // è·å–ç¬¬ä¸€ä¸ªå®ç°ç±» Class&lt;?&gt; implementClass = implementClassList.get(0); // ä» Bean Map ä¸­è·å–è¯¥å®ç°ç±»å¯¹åº”çš„å®ç°ç±»å®ä¾‹ Object implementInstance = beanMap.get(implementClass); // è®¾ç½®è¯¥ Bean å­—æ®µçš„å€¼ beanField.setAccessible(true); // å¿…é¡»ä½¿è¯¥å­—æ®µå¯è®¿é—® beanField.set(beanInstance, implementInstance); &#125; &#125; &#125; &#125; &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static Map&lt;Class&lt;?&gt;, Object&gt; getBeanMap() &#123; return beanMap; &#125; @SuppressWarnings(&quot;unchecked&quot;) public static &lt;T&gt; T getBean(Class&lt;T&gt; cls) &#123; return (T) beanMap.get(cls); &#125;&#125; å…¶å®å¾ˆç®€å•ï¼Œä¾èµ–æ³¨å…¥å…¶å®åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š1. é€šè¿‡åå°„åˆ›å»ºå®ä¾‹ï¼›2. è·å–éœ€è¦æ³¨å…¥çš„æ¥å£å®ç°ç±»å¹¶å°†å…¶èµ‹å€¼ç»™è¯¥æ¥å£ã€‚ä»¥ä¸Šä»£ç ä¸­çš„ä¸¤ä¸ª for å¾ªç¯å°±æ˜¯å¹²è¿™ä¸¤ä»¶äº‹æƒ…çš„ã€‚ ä¾èµ–æ³¨å…¥æ¡†æ¶å®ç°å®Œæ¯•ï¼ å¤§å®¶ä¸Šé¢çœ‹åˆ°çš„ BeanHelper ç±»ï¼Œå…¶å®å…¼ä»»äº†ä¸¤ç§èŒè´£ï¼š1.åˆå§‹åŒ–æ‰€æœ‰çš„ Bean ç±»ï¼›2.å®ç°ä¾èµ–æ³¨å…¥ã€‚ è¿™è¿æ³•äº†è®¾è®¡æ¨¡å¼ä¸­çš„â€œå•ä¸€è´£ä»»åŸåˆ™â€ï¼Œæ‰€æœ‰æœ‰å¿…è¦å°†å…¶é‡æ„ä¸€ä¸‹ï¼Œç°åœ¨çš„ BeanHelper ç±»æ›´åŠ è‹—æ¡äº†ï¼Œåªæ˜¯è´Ÿè´£åˆå§‹åŒ– Bean ç±»è€Œå·²ã€‚ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829public class BeanHelper &#123; // Bean ç±» =&gt; Bean å®ä¾‹ private static final Map&lt;Class&lt;?&gt;, Object&gt; beanMap = new HashMap&lt;Class&lt;?&gt;, Object&gt;(); static &#123; try &#123; // è·å–å¹¶éå†æ‰€æœ‰çš„ Beanï¼ˆå¸¦æœ‰ @Bean æ³¨è§£çš„ç±»ï¼‰ List&lt;Class&lt;?&gt;&gt; beanClassList = ClassHelper.getClassListByAnnotation(Bean.class); for (Class&lt;?&gt; beanClass : beanClassList) &#123; // åˆ›å»º Bean å®ä¾‹ Object beanInstance = beanClass.newInstance(); // å°† Bean å®ä¾‹æ”¾å…¥ Bean Map ä¸­ï¼ˆé”®ä¸º Bean ç±»ï¼Œå€¼ä¸º Bean å®ä¾‹ï¼‰ beanMap.put(beanClass, beanInstance); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static Map&lt;Class&lt;?&gt;, Object&gt; getBeanMap() &#123; return beanMap; &#125; @SuppressWarnings(&quot;unchecked&quot;) public static &lt;T&gt; T getBean(Class&lt;T&gt; cls) &#123; return (T) beanMap.get(cls); &#125;&#125; é‚£ä¹ˆï¼Œä¾èµ–æ³¨å…¥åŠŸèƒ½æ”¾å“ªé‡Œå‘¢ï¼Ÿæˆ‘æäº†ä¸€ä¸ª IOCHelperï¼Œç”¨è¿™ä¸ªç±»æ¥å®ç° IOC åŠŸèƒ½ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public class IOCHelper &#123; static &#123; try &#123; // è·å–å¹¶éå†æ‰€æœ‰çš„ Bean ç±» Map&lt;Class&lt;?&gt;, Object&gt; beanMap = BeanHelper.getBeanMap(); for (Map.Entry&lt;Class&lt;?&gt;, Object&gt; beanEntry : beanMap.entrySet()) &#123; // è·å– Bean ç±»ä¸ Bean å®ä¾‹ Class&lt;?&gt; beanClass = beanEntry.getKey(); Object beanInstance = beanEntry.getValue(); // è·å– Bean ç±»ä¸­æ‰€æœ‰çš„å­—æ®µï¼ˆä¸åŒ…æ‹¬çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼‰ Field[] beanFields = beanClass.getDeclaredFields(); if (ArrayUtil.isNotEmpty(beanFields)) &#123; // éå†æ‰€æœ‰çš„ Bean å­—æ®µ for (Field beanField : beanFields) &#123; // åˆ¤æ–­å½“å‰ Bean å­—æ®µæ˜¯å¦å¸¦æœ‰ @Inject æ³¨è§£ if (beanField.isAnnotationPresent(Inject.class)) &#123; // è·å– Bean å­—æ®µå¯¹åº”çš„æ¥å£ Class&lt;?&gt; interfaceClass = beanField.getType(); // åˆ¤æ–­æ¥å£ä¸Šæ˜¯å¦æ ‡æ³¨äº† @Impl æ³¨è§£ Class&lt;?&gt; implementClass = null; if (interfaceClass.isAnnotationPresent(Impl.class)) &#123; // è·å–å¼ºåˆ¶æŒ‡å®šçš„å®ç°ç±» implementClass = interfaceClass.getAnnotation(Impl.class).value(); &#125; else &#123; // è·å–è¯¥æ¥å£æ‰€æœ‰çš„å®ç°ç±» List&lt;Class&lt;?&gt;&gt; implementClassList = ClassHelper.getClassListByInterface(interfaceClass); if (CollectionUtil.isNotEmpty(implementClassList)) &#123; // è·å–ç¬¬ä¸€ä¸ªå®ç°ç±» implementClass = implementClassList.get(0); &#125; &#125; // è‹¥å­˜åœ¨å®ç°ç±»ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹ä»£ç  if (implementClass != null) &#123; // ä» Bean Map ä¸­è·å–è¯¥å®ç°ç±»å¯¹åº”çš„å®ç°ç±»å®ä¾‹ Object implementInstance = beanMap.get(implementClass); // è®¾ç½®è¯¥ Bean å­—æ®µçš„å€¼ if (implementInstance != null) &#123; beanField.setAccessible(true); // å–æ¶ˆç±»å‹å®‰å…¨æ£€æµ‹ï¼ˆå¯æé«˜åå°„æ€§èƒ½ï¼‰ beanField.set(beanInstance, implementInstance); // beanInstance æ˜¯æ™®é€šå®ä¾‹ï¼Œæˆ– CGLib åŠ¨æ€ä»£ç†å®ä¾‹ï¼ˆä¸èƒ½ä½¿ JDK åŠ¨æ€ä»£ç†å®ä¾‹ï¼‰ &#125; &#125; &#125; &#125; &#125; &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; å¯è§ï¼ŒIOCHelper æ˜¯ä¾èµ–äº BeanHelper çš„ã€‚è¿™æ ·åˆ†ç¦»ï¼Œè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯æ–¹ä¾¿å®ç° ServiceHelper ä¸ AOPHelperã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé¦–å…ˆé€šè¿‡ BeanHelper åˆå§‹åŒ–æ‰€æœ‰çš„ Bean ç±»ï¼Œç„¶åä¾æ¬¡åˆå§‹åŒ– ServiceHelperã€IOCHelperã€AOPHelperï¼Œè¿™ä¸ªé¡ºåºä¸èƒ½æé”™ã€‚å› ä¸ºåœ¨ ServcieHelper ä¸­ï¼Œå¯¹ Servcie å®ç°ç±»è¿›è¡Œäº†åŠ¨æ€ä»£ç†ï¼Œæ‰€æœ‰ä¿è¯äº† IOC æ³¨å…¥è¿›æ¥çš„æ˜¯ä»£ç†ç±»ï¼Œè€Œå¹¶éç›®æ ‡ç±»ã€‚ å‚è€ƒ IOC å®ç°åŸç† 1000è¡Œä»£ç è¯»æ‡‚Springï¼ˆä¸€ï¼‰- å®ç°ä¸€ä¸ªåŸºæœ¬çš„IoCå®¹å™¨","categories":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/categories/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"}]},{"title":"Servlet","slug":"Servlet","date":"2018-04-14T04:35:27.000Z","updated":"2018-04-23T06:28:27.056Z","comments":true,"path":"2018/04/14/Servlet/","link":"","permalink":"https://hsb786.github.io/2018/04/14/Servlet/","excerpt":"Servletæ¦‚è¿°Servletæ˜¯åœ¨Javaä¸­åˆ›å»ºwebåº”ç”¨ç¨‹åºçš„J2ee æœåŠ¡ç«¯æŠ€æœ¯ã€‚javax.servlet å’Œ javax.servlet.httpåŒ…ä¸­æä¾›äº†ç¼–å†™servletçš„æ¥å£å’Œç±»ã€‚æ‰€æœ‰çš„servletéƒ½è¦å®ç°javax.servlet.Servletæ¥å£ã€‚è¯¥æ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªServletç”Ÿå‘½å‘¨æœŸä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚ Servletæ¥å£å®šä¹‰äº†Servletä¸Servletå®¹å™¨ä¹‹é—´çš„å¥‘çº¦ï¼ŒServletå®¹å™¨å°†Servletç±»è½½å…¥å†…å­˜ï¼Œå¹¶åœ¨Servletå®ä¾‹ä¸Šè°ƒç”¨å…·ä½“çš„æ–¹æ³•ã€‚åœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæ¯ç§Servletç±»å‹åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚ ç”¨æˆ·è¯·æ±‚æŒ‡ä½¿Servletå®¹å™¨è°ƒç”¨Servletçš„Serviceæ–¹æ³•ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªServletRequestå®ä¾‹å’Œä¸€ä¸ªServletResponseå®ä¾‹ã€‚","text":"Servletæ¦‚è¿°Servletæ˜¯åœ¨Javaä¸­åˆ›å»ºwebåº”ç”¨ç¨‹åºçš„J2ee æœåŠ¡ç«¯æŠ€æœ¯ã€‚javax.servlet å’Œ javax.servlet.httpåŒ…ä¸­æä¾›äº†ç¼–å†™servletçš„æ¥å£å’Œç±»ã€‚æ‰€æœ‰çš„servletéƒ½è¦å®ç°javax.servlet.Servletæ¥å£ã€‚è¯¥æ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªServletç”Ÿå‘½å‘¨æœŸä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚ Servletæ¥å£å®šä¹‰äº†Servletä¸Servletå®¹å™¨ä¹‹é—´çš„å¥‘çº¦ï¼ŒServletå®¹å™¨å°†Servletç±»è½½å…¥å†…å­˜ï¼Œå¹¶åœ¨Servletå®ä¾‹ä¸Šè°ƒç”¨å…·ä½“çš„æ–¹æ³•ã€‚åœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæ¯ç§Servletç±»å‹åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚ ç”¨æˆ·è¯·æ±‚æŒ‡ä½¿Servletå®¹å™¨è°ƒç”¨Servletçš„Serviceæ–¹æ³•ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªServletRequestå®ä¾‹å’Œä¸€ä¸ªServletResponseå®ä¾‹ã€‚å¯¹äºæ¯ä¸ªåº”ç”¨ç¨‹åºï¼ŒServletå®¹å™¨è¿˜ä¼šåˆ›å»ºä¸€ä¸ªServletContextå®ä¾‹ï¼Œå°è£…äº†ä¸Šä¸‹æ–‡ï¼ˆåº”ç”¨ç¨‹åºçš„ç¯å¢ƒè¯¦æƒ…ï¼‰ã€‚æ¯ä¸ªä¸Šä¸‹æ–‡åªæœ‰ä¸€ä¸ªServletContextï¼Œæ¯ä¸ªServletå®ä¾‹ä¹Ÿéƒ½æœ‰ä¸€ä¸ªå°è£…Servleté…ç½®çš„ServletConfigã€‚ å¤šæ•°æƒ…å†µä¸‹ï¼Œwebåº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨httpåè®®ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¤šæ•°æ—¶å€™éƒ½é€šè¿‡ç»§æ‰¿HttpServletç±»æ¥å®ç°è‡ªå·±çš„Servletã€‚ Servlet APIçš„å±‚æ¬¡ç»“æ„javax.servlet.Servletæ˜¯Servlet Apiçš„æœ€ä¸Šå±‚æ¥å£ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ¥å£å’Œç±»æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨servletçš„æ—¶å€™éœ€è¦å…³æ³¨çš„ã€‚ Servlet æ¥å£javax.servlet.Servlet æ˜¯Servlet Apiçš„æœ€ä¸Šå±‚æ¥å£ï¼ŒServletæ¥å£å®šä¹‰äº†ä¸€ç³»åˆ—servletçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆinitã€serviceã€destoryç­‰ï¼‰ã€‚æ‰€æœ‰çš„Servletç±»éƒ½éœ€è¦ç»§æ‰¿è¿™ä¸ªæ¥å£ã€‚è¯¥æ¥å£ä¸­å®šä¹‰äº†ä»¥ä¸‹æ–¹æ³•ï¼š public abstract void init(ServletConfig paramServletConfig) throws ServletException è¯¥æ–¹æ³•ç”±servletå®¹å™¨è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–servletä»¥åŠservleté…ç½®å‚æ•°ã€‚åœ¨init()æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œservletæ˜¯æ— æ³•å¤„ç†ç”¨æˆ·è¯·æ±‚çš„ã€‚åœ¨servletç”Ÿå‘½å‘¨æœŸä¸­è¯¥æ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œä»–ä¼šä½¿servletç±»ä¸åŒåŒºåˆ«äºæ™®é€šçš„javaå¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥æ‰©å±•è¯¥æ–¹æ³•æ¥åˆå§‹åŒ–èµ„æºï¼Œå¦‚æ•°æ®åº“è¿æ¥ã€socketè¿æ¥ç­‰ã€‚ public abstract void service(ServletRequest req, ServletResponse res) throws ServletException, IOException è¯¥æ–¹æ³•è´Ÿè´£å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚å½“servletå®¹å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶æ‰§è¡Œservice()æ–¹æ³•ï¼Œå¹¶æŠŠrequest å’Œ responseä½œä¸ºå‚æ•°ä¼ é€’ç»™è¯¥æ–¹æ³•ã€‚servleté€šå¸¸è¿è¡Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œæ‰€ä»¥å¼€å‘äººå‘˜åº”è¯¥ä½¿ç”¨åŒæ­¥æ¥ä¿è¯è®¿é—®å…±äº«èµ„æºçš„çº¿ç¨‹å®‰å…¨æ€§é—®é¢˜ã€‚ public abstract void destroy() è¯¥æ–¹æ³•åœ¨æ•´ä¸ªservletç”Ÿå‘½å‘¨æœŸä¸­åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡æ¥å…³é—­æ‰€æœ‰èµ„æºã€‚æœ‰ç‚¹åƒJavaä¸­çš„finalizeæ–¹æ³•ã€‚ public abstract ServletConfig getServletConfig() è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªservleté…ç½®å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«servletä¸­æ‰€æœ‰åˆå§‹åŒ–å‚æ•°å’Œå¯åŠ¨é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥è·å–servletçš„åˆå§‹åŒ–å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¸€èˆ¬è¢«å®šä¹‰åœ¨web.xmlæˆ–servlet 3çš„æ³¨è§£ä¸­ã€‚åé¢ä¼šä»‹ç»ServletConfigæ¥å£ã€‚ public abstract String getServletInfo() è¯¥æ–¹æ³•è¿”å›åŒ…å«servletä¿¡æ¯çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚å®ƒçš„ä½œè€…ã€ç‰ˆæœ¬å’Œç‰ˆæƒã€‚è¿”å›çš„å­—ç¬¦ä¸²åº”è¯¥æ˜¯çº¯æ–‡æœ¬ï¼Œä¸èƒ½æœ‰æ ‡è®°ç¬¦å·ã€‚ ServletConfig æ¥å£javax.servlet.ServletConfigç”¨äºç»™servletä¼ é€’é…ç½®ä¿¡æ¯ã€‚æ¯ä¸ªservletéƒ½æœ‰å±äºå®ƒè‡ªå·±çš„ServletConfigå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”±servletå®¹å™¨è´Ÿè´£å®ä¾‹åŒ–ã€‚ ServletContext æ¥å£javax.servlet.ServletContextæ¥å£ç”¨äºæè¿°åº”ç”¨ç¨‹åºçš„ç›¸å…³ä¿¡æ¯ã€‚ServletContextæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œå¯ç”¨äºwebåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰çš„servletã€‚å½“æˆ‘ä»¬æƒ³è¦ä¸€äº›åˆå§‹åŒ–çš„å‚æ•°å¯ç”¨äºwebåº”ç”¨ç¨‹åºä¸­å¤šä¸ªæˆ–å…¨éƒ¨servletæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ServletContextå¯¹è±¡å¹¶ä¸”åœ¨web.xmlä¸­ä½¿ç”¨&lt; context-param&gt;æ ‡ç­¾å®šä¹‰å‚æ•°ã€‚ ServletRequest æ¥å£ServletRequestæ¥å£æ˜¯ç”¨æ¥å‘servletæä¾›å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾Servletå®¹å™¨çš„æ—¶å€™ï¼Œä»–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªServletRequestå¯¹è±¡ï¼Œå¹¶å°†å…¶ä¼ é€’å¯¹åº”çš„servletçš„service()æ–¹æ³•ã€‚ Object getAttribute(String name) è¿”å›æŒ‡å®šçš„å‚æ•°åå¯¹åº”çš„å±æ€§å€¼ã€‚å¦‚æœå¯¹åº”çš„å‚æ•°ä¸å­˜åœ¨åˆ™è¿”å›nullã€‚ String getParameter(String name) ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›è¯·æ±‚å‚æ•°å€¼ã€‚ attributeå’Œparameterçš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æ¥æºä¸åŒ å‚æ•°ï¼ˆparameterï¼‰æ˜¯ä»å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¸­ç”±ç”¨æˆ·æä¾›çš„ï¼Œè‹¥æ˜¯GETæ–¹æ³•æ˜¯ä»URLä¸­ æä¾›çš„ï¼Œè‹¥æ˜¯POSTæ–¹æ³•æ˜¯ä»è¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰ä¸­æä¾›çš„ï¼› å±æ€§ï¼ˆattributeï¼‰æ˜¯æœåŠ¡å™¨ç«¯çš„ç»„ä»¶ï¼ˆJSPæˆ–è€…Servletï¼‰åˆ©ç”¨requst.setAttributeï¼ˆï¼‰è®¾ç½®çš„. æ“ä½œä¸åŒ å‚æ•°ï¼ˆparameterï¼‰çš„å€¼åªèƒ½è¯»å–ä¸èƒ½ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.getParameter()è¯»å–ï¼› å±æ€§ï¼ˆattributeï¼‰çš„å€¼æ—¢å¯ä»¥è¯»å–äº¦å¯ä»¥ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.setAttribute(),è®¾ç½®å¯ä½¿ç”¨request.getAttribute() æ•°æ®ç±»å‹ä¸åŒ å‚æ•°ï¼ˆparameterï¼‰ä¸ç®¡å‰å°ä¼ æ¥çš„å€¼è¯­ä¹‰æ˜¯ä»€ä¹ˆï¼Œåœ¨æœåŠ¡å™¨è·å–æ—¶éƒ½ä»¥Stringç±»å‹çœ‹å¾…ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯çš„å‚æ•°å€¼åªèƒ½æ˜¯ç®€å•ç±»å‹çš„å€¼ï¼Œä¸èƒ½æ˜¯å¤æ‚ç±»å‹ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯¹è±¡ã€‚ å±æ€§ï¼ˆattributeï¼‰çš„å€¼å¯ä»¥æ˜¯ä»»æ„ä¸€ä¸ªObjectç±»å‹ã€‚ ServletResponse æ¥å£servletä½¿ç”¨ServletResponseå‘å®¢æˆ·ç«¯å‘é€å“åº”ã€‚å’ŒServletRequestç±»ä¼¼ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾Servletå®¹å™¨çš„æ—¶å€™ï¼Œä»–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªServletResponseå¯¹è±¡ï¼Œå¹¶å°†å…¶ä¼ é€’å¯¹åº”çš„servletçš„service()æ–¹æ³•ã€‚æœ€ç»ˆï¼Œè¯¥responseå¯¹è±¡ç”¨äºç»™å®¢æˆ·ç«¯ç”Ÿæˆhtmlå“åº”ã€‚ RequestDispatcher æ¥å£RequestDispatcher æ¥å£ç”¨äºæŠŠä¸€ä¸ªè¯·æ±‚è½¬å‘ç»™åŒä¸€ä¸ªservletä¸Šä¸‹æ–‡ä¸­çš„å…¶ä»–çš„èµ„æºï¼ˆHtmlã€jspã€servletï¼‰æ¥å¤„ç†ã€‚ä¹Ÿå¯ä»¥ç”¨å®ƒæ¥æŠŠå¦ä¸€ä¸ªèµ„æºçš„å†…å®¹åŒ…å«åˆ°å“åº”ä¸­ã€‚æ­¤æ¥å£ç”¨äºåŒä¸€ä¸ªservletä¸Šä¸‹æ–‡ä¸­çš„servletç›¸äº’æ²Ÿé€šã€‚ RequestDispatcher æ¥å£çš„ä¸»è¦æ–¹æ³•:void forward(ServletRequest request, ServletResponse response) æŠŠä¸€ä¸ªservletçš„è¯·æ±‚è½¬å‘åˆ°æœåŠ¡å™¨ä¸Šçš„å…¶ä»–èµ„æºä¸­ï¼ˆHtmlã€jspã€servletï¼‰ã€‚ void include(ServletRequest request, ServletResponse response) æŠŠå¦ä¸€ä¸ªèµ„æºçš„å†…å®¹åŒ…å«åˆ°å½“å‰å“åº”ä¸­ã€‚ forwardå’Œincludeçš„åŒºåˆ«ï¼š å¦‚æœä½¿ç”¨forwardè·³è½¬ï¼Œforwardè¯­å¥åé¢çš„responseè¾“å‡ºåˆ™ä¸ä¼šæ‰§è¡Œï¼Œä¼šè·³è½¬åˆ°forwardæŒ‡å®šçš„servletä¸­å»æ‰§è¡Œã€‚ ç”¨includeæ¥è·³è½¬ï¼Œåˆ™includeçš„servletæ‰§è¡Œå®Œåï¼Œå†è¿”å›åˆ°åŸæ¥çš„servletæ‰§è¡Œforwardè¯­å¥åé¢çš„responseçš„è¾“å‡ºã€‚ åœ¨servletä¸­å¯ä»¥ä½¿ç”¨getRequestDispatcher(String path)æ¥è·å–ä¸€ä¸ªRequestDispatcherã€‚è·¯å¾„å¿…é¡»ä»¥/å¼€å¤´ï¼Œå¹¶ä¸”æ˜¯é’ˆå¯¹äºå½“å‰contextçš„æ ¹è·¯å¾„çš„ç›¸å¯¹åœ°å€ã€‚ HTTPSessionHTTPSessionå¯¹è±¡åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®ç½‘ç«™çš„æ—¶å€™è‡ªåŠ¨åˆ›å»ºï¼Œå¯ä»¥é€šè¿‡HttpServletRequestçš„getSessionæ–¹æ³•è·å–è¯¥å¯¹è±¡ï¼Œä¸€ä¸ªç”¨æˆ·æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªHttpSessionï¼Œæ”¾å…¥åˆ°HttpSessionçš„å€¼ï¼Œæ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨è½¬å‚¨åˆ°äºŒçº§ç¼“å­˜ä¸­ã€‚æ”¾åˆ°HttpSessionçš„å€¼ä¸é™äºStringç±»å‹ï¼Œå¯ä»¥æ˜¯ä»»æ„å®ç°java.io.Serializaleçš„javaå¯¹è±¡ã€‚ æ‰€æœ‰ä¿å­˜åœ¨HttpSessionçš„æ•°æ®ä¸ä¼šè¢«å‘é€åˆ°å®¢æˆ·ç«¯ï¼ŒServletå®¹å™¨ä¸ºæ¯ä¸ªHttpSessionç”Ÿæˆå”¯ä¸€çš„æ ‡è¯†ï¼Œå¹¶å°†è¯¥æ ‡è¯†å‘é€ç»™æµè§ˆå™¨ï¼Œæˆ–åˆ›å»ºä¸€ä¸ªåä¸ºJSESSIONNIDçš„cookieï¼Œæˆ–è€…åœ¨URLåé¢é™„åŠ ä¸€ä¸ªåä¸ºjessionidçš„å‚æ•°ï¼Œåœ¨åç»­çš„è¯·æ±‚ä¸­ï¼Œæµè§ˆå™¨åªéœ€è¦å°†æ ‡è¯†idæ”¾é€ç»™æœåŠ¡å™¨å³å¯ã€‚ å‚è€ƒ [è¯‘]Java Servletåˆçº§çŸ¥è¯† Servletå­¦ä¹ ç¬”è®°","categories":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/categories/HTTP/"}],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/tags/HTTP/"}]},{"title":"ã€è¯‘ã€‘å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList--clear vs removeAll ï¼ˆè½¬è½½ï¼‰","slug":"è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll","date":"2018-04-13T07:55:17.000Z","updated":"2018-04-20T13:23:14.949Z","comments":true,"path":"2018/04/13/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/","link":"","permalink":"https://hsb786.github.io/2018/04/13/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/","excerpt":"å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®clearæˆ–removeAllã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°java.lang.OutOfMemoryError: Java Heap Spaceã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚","text":"å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®clearæˆ–removeAllã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°java.lang.OutOfMemoryError: Java Heap Spaceã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚ Clear() vs RemoveAll(Collection c)ä¸ºäº†æ›´å¥½çš„æ¯”è¾ƒè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œé˜…è¯»ä»–ä»¬æºç æ˜¯å¾ˆé‡è¦çš„ã€‚å¯ä»¥åœ¨java.utils.ArrayListç±»ä¸­æ‰¾åˆ°clear()æ–¹æ³•ï¼Œä¸è¿‡ä¸ºäº†æ–¹ä¾¿æˆ‘å°†å®ƒå¼•å…¥åˆ°äº†è¿™é‡Œã€‚ä¸‹é¢çš„ä»£ç æ¥è‡ªJDK 1.7.0_40ç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³è¦å­¦ä¹ æ›´å¤šçš„æœ‰å…³æ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜çš„çŸ¥è¯†ï¼Œæˆ‘å¼ºçƒˆå»ºè®®é˜…è¯»Scott Oakså†™çš„Java Performance the Definitive Guide,å®ƒåŒ…å«äº†java 7å’Œä¸€ç‚¹java 8ã€‚ä¸‹é¢æ˜¯clear()çš„ä»£ç ç‰‡æ®µ: 12345678910/** * Removes all of the elements from this list.The list will * be empty after this call returns. */ public void clear() &#123; modCount++; // clear to let GC do its work for (int i = 0; i &lt; size; i++) elementData[i] = null; size = 0; &#125; å¤§å®¶å¯ä»¥çœ‹å‡ºï¼Œclear()åœ¨å¾ªç¯éå†ArrayListï¼Œå¹¶ä¸”å°†æ¯ä¸€ä¸ªå…ƒç´ éƒ½ç½®ä¸ºnullï¼Œä½¿å®ƒä»¬åœ¨æ²¡æœ‰è¢«å¤–éƒ¨å¼•ç”¨çš„æƒ…å†µä¸‹å¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚ç›¸ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨java.util.AbstractCollectionç±»ä¸­æŸ¥çœ‹removeAll(Collention c)çš„ä»£ç ï¼Œä¸‹é¢æ˜¯ä»£ç ç‰‡æ®µ: 12345678910111213public boolean removeAll(Collection&lt;?&gt; c) &#123; //åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºnull Objects.requireNonNull(c); boolean modified = false; Iterator&lt;?&gt; it = iterator(); while (it.hasNext()) &#123; if (c.contains(it.next())) &#123; it.remove(); modified = true; &#125; &#125; return modified; &#125; è¿™ä¸ªæ–¹æ³•ä¼šæ£€æŸ¥è¿­ä»£å™¨é¡ºåºè¿”å›çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦åŒ…å«åœ¨ç‰¹å®šçš„é›†åˆä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œè°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•å°†å®ƒä»é›†åˆä¸­ç§»é™¤ã€‚å› ä¸ºä¼šç”¨åˆ°containsæ–¹æ³•ï¼ŒremoveAllçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚æ‰€ä»¥åœ¨æƒ³è¦é‡ç½®ä¸€ä¸ªå¤§çš„ArrayListæ—¶ï¼Œè¿™ç§æ–¹æ³•æ˜¯ç»å¯¹ä¸å¯å–çš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…åœ¨é‡ç½®ä¸€ä¸ªåŒ…å«100Kä¸ªå…ƒç´ æ—¶çš„æ€§èƒ½å·®å¼‚ã€‚ åˆ é™¤ä¸€ä¸ªåŒ…å«100kä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´  æˆ‘æœ¬æ¥æƒ³åœ¨ä¾‹å­ä¸­å°è¯•é‡ç½®ä¸€ä¸ªåŒ…å«10Mä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼Œä¸è¿‡åœ¨è¶…è¿‡åŠä¸ªå°æ—¶ç­‰å¾…removeAll()ç»“æŸåï¼Œæˆ‘å†³å®šå°†å…ƒç´ çš„æ•°é‡é™ä¸º100Kã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªæ–¹æ³•çš„å·®è·ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„ã€‚removeAll()æ¯”clear()å¤šèŠ±è´¹äº†10000å€çš„æ—¶é—´ã€‚äº‹å®ä¸Šï¼Œåœ¨APIä¸­clear()å’ŒremoveAll(Collection c)è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç›®çš„æ˜¯ä¸åŒçš„ã€‚clear()æ–¹æ³•æ˜¯ä¸ºäº†é€šè¿‡åˆ é™¤æ‰€æœ‰å…ƒç´ è€Œé‡ç½®åˆ—è¡¨ï¼Œè€ŒremoveAll(Collection c)æ˜¯ä¸ºäº†ä»é›†åˆä¸­åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€ä¸ªæä¾›çš„é›†åˆä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸æ˜¯ä¸ºäº†ä»é›†åˆä¸­ç§»é™¤æ‰€æœ‰å…ƒç´ ã€‚æ‰€ä»¥å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æ‰€æœ‰å…ƒç´ ï¼Œç”¨clear(),å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€é›†åˆçš„å…ƒç´ ï¼Œé‚£ä¹ˆé€‰æ‹©removeAll(Collection c)æ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435import java.util.ArrayList; /** * Java Program to remove all elements from list in Java and comparing * performance of clearn() and removeAll() method. * * @author Javin Paul */ public class ArrayListResetTest &#123; private static final int SIZE = 100_000; public static void main(String args[]) &#123; // Two ArrayList for clear and removeAll ArrayList numbers = new ArrayList(SIZE); ArrayList integers = new ArrayList(SIZE); // Initialize ArrayList with 10M integers for (int i = 0; i &amp;lt; SIZE; i++) &#123; numbers.add(new Integer(i)); integers.add(new Integer(i)); &#125; // Empty ArrayList using clear method long startTime = System.nanoTime(); numbers.clear(); long elapsed = System.nanoTime() - startTime; System.out.println(&quot;Time taken by clear to empty ArrayList of 1M elements (ns): &quot; + elapsed); // Reset ArrayList using removeAll method startTime = System.nanoTime(); integers.removeAll(integers); long time = System.nanoTime() - startTime; System.out.println(&quot;Time taken by removeAll to reset ArrayList of 1M elements (ns): &quot; + time); &#125; &#125; Output: Time taken by clear to empty ArrayList of 100000 elements (ns): 889619 Time taken by removeAll to reset ArrayList of 100000 elements (ns): 36633112126 ç”±äºç¨‹åºä½¿ç”¨äº†ä¸¤ä¸ªarrayListå­˜å‚¨Integersï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶è¦ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå°¤å…¶æ˜¯ä½ æƒ³æ¯”è¾ƒåœ¨åˆ—è¡¨å­˜æœ‰1Mä¸ªå…ƒç´ æ—¶ï¼Œä¸¤ç§æ–¹æ³•çš„æ€§èƒ½å·®å¼‚ã€‚å¦å¤–ï¼Œç”±äºä½¿ç”¨äº†åœ¨æ•°å­—ä¸­åŠ å…¥ä¸‹åˆ’çº¿çš„ç‰¹æ€§ï¼Œæ‰€ä»¥éœ€è¦java7æ¥è¿è¡Œã€‚å¦‚æœæ²¡æœ‰JDK7ï¼Œä¹Ÿå¯ä»¥ç§»é™¤SIZEå¸¸é‡ä¸­çš„ä¸‹åˆ’çº¿ã€‚ å‚è€ƒ ã€è¯‘ã€‘å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayListâ€“clear vs removeAll","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ã€è¯‘ã€‘ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll ï¼ˆè½¬è½½ï¼‰","slug":"è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll","date":"2018-04-13T07:34:36.000Z","updated":"2018-04-20T13:23:22.479Z","comments":true,"path":"2018/04/13/è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll/","link":"","permalink":"https://hsb786.github.io/2018/04/13/è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll/","excerpt":"åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:Producer(ç”Ÿäº§è€…)å’ŒConsumer(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚","text":"åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:Producer(ç”Ÿäº§è€…)å’ŒConsumer(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚ åœ¨ä»£ç ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨waitå’Œnotifyå°½ç®¡waitå’Œnotifyæ˜¯ç›¸å½“åŸºç¡€çš„æ¦‚å¿µï¼Œå¹¶ä¸”ä»–ä»¬å®šä¹‰åœ¨Objectç±»ä¸­ï¼Œä½†è¦æƒ³åœ¨ä»£ç ä¸­ä½¿ç”¨ä»–ä»¬å¹¶éæ˜“äº‹ã€‚ä½ å¯ä»¥åœ¨é¢è¯•ä¸­è®©é¢è¯•è€…é€šè¿‡æ‰‹å†™ä»£ç è§£å†³Producerè€…å’ŒConsumerè€…é—®é¢˜æ¥éªŒè¯ï¼Œæˆ‘ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ä¼šçŠ¯åœ¨é”™è¯¯çš„åœ°æ–¹åŒæ­¥ï¼Œæ²¡æœ‰åœ¨æ­£ç¡®çš„å¯¹è±¡ä¸Šè°ƒç”¨waitä¹‹ç±»çš„é”™ã€‚è®²çœŸï¼Œè¿™äº›å¸¸å¸¸ä¼šå›°æƒ‘è®¸å¤šç¨‹åºå‘˜ã€‚ç¬¬ä¸€ä¸ªå›°æƒ‘ç‚¹æ¥è‡ªæ€æ ·è°ƒç”¨waitæ–¹æ³•ï¼Œå› ä¸ºwaitæ–¹æ³•å¹¶ä¸æ˜¯å®šä¹‰åœ¨Threadç±»ä¸­ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•çš„Thread.wait()ã€‚è€Œè®¸å¤šJavaå¼€å‘è€…ä¹ æƒ¯äºThread.sleep(),æ‰€ä»¥å¸¸å¸¸é”™è¯¯çš„æƒ³ç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨waitã€‚å®é™…ä¸Šï¼Œwait()æ–¹æ³•éœ€è¦åœ¨ä¸€ä¸ªè¢«ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨ï¼Œä¾‹å¦‚åœ¨Producerè€…å’Œæ¶ˆè´¹Consumerçš„é—®é¢˜ä¸­ï¼Œä¸¤ä¸ªçº¿ç¨‹å…±äº«å¯¹è±¡æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ã€‚ç¬¬äºŒä¸ªå›°æƒ‘ç‚¹æ¥è‡ªwaitæ–¹æ³•åº”è¯¥åœ¨åŒæ­¥å—è¿˜æ˜¯åŒæ­¥æ–¹æ³•ä¸­è°ƒç”¨ï¼Ÿå¦‚æœä½¿ç”¨åŒæ­¥å—ï¼Œé‚£ä¹ˆå“ªä¸ªå¯¹è±¡åº”è¯¥æ”¾åˆ°åŒæ­¥å—ä¸­ï¼Ÿè¿™ä¸ªå¯¹è±¡å’Œä½ æƒ³è¦è·å¾—é”çš„å¯¹è±¡åº”è¯¥æ˜¯åŒä¸€ä¸ªã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„é˜Ÿåˆ—ã€‚ åœ¨å¾ªç¯ä¸­ä½¿ç”¨waitå’Œnotifyï¼Œè€Œä¸æ˜¯Ifä»£ç å—ä¸­åœ¨ä½ å·²ç»äº†è§£éœ€è¦åœ¨ä¸€ä¸ªå…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨waitæ–¹æ³•åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å­¦ä¼šé¿å…è®¸å¤šjavaå¼€å‘è€…çŠ¯çš„é”™â€”åœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitè€Œä¸æ˜¯whileå¾ªç¯ä¸­ã€‚å› ä¸ºéœ€è¦åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹è°ƒç”¨waitï¼Œæ¯”å¦‚Producerçº¿ç¨‹è¦åœ¨é˜Ÿåˆ—æ»¡äº†çš„æƒ…å†µä¸‹è°ƒç”¨waitï¼Œæ‰€ä»¥ç¬¬ä¸€ååº”éƒ½æ˜¯ä½¿ç”¨Ifè¯­å¥ã€‚ä½†æ˜¯ï¼Œåœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitä¼šäº§ç”Ÿbugï¼Œå› ä¸ºçº¿ç¨‹å­˜åœ¨ä¸€å®šçš„å¯èƒ½åœ¨ç­‰å¾…æ¡ä»¶æ²¡æœ‰æ”¹å˜çš„æƒ…å†µä¸‹å‡å”¤é†’(spurious wake up)ã€‚æ‰€ä»¥å¦‚æœæ²¡æœ‰ä½¿ç”¨å¾ªç¯åœ¨çº¿ç¨‹å”¤é†’åæ£€æŸ¥ç­‰å¾…æ¡ä»¶ï¼Œå¯èƒ½ä¼šé€ æˆå°è¯•åœ¨å·²ç»æ»¡äº†çš„é˜Ÿåˆ—ä¸­æ’å…¥å…ƒç´ æˆ–è€…åœ¨ç©ºäº†çš„é˜Ÿåˆ—ä¸­å–å…ƒç´ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åœ¨whileå¾ªç¯ä¸­è°ƒç”¨waitè€Œä¸æ˜¯ifã€‚ Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­ä¸‹é¢æ˜¯åœ¨Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹(PRODUCTORå’ŒCONSUMER)ï¼Œç”¨ç»§æ‰¿äº†Threadç±»çš„Producerå’ŒConsumerç±»å®ç°ã€‚Prodcuerå’ŒConsumerçš„ä¸šåŠ¡é€»è¾‘å†™åœ¨ä»–ä»¬å„è‡ªçš„run()æ–¹æ³•ä¸­ã€‚å¹¶ä¸”å®ç°ä¸€ä¸ªLinkedListï¼Œå½“åšå…±äº«é˜Ÿåˆ—ã€‚Produceråœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ä¸æ–­åœ¨é˜Ÿåˆ—ä¸­æ’å…¥éšæœºæ•°ï¼Œç›´åˆ°é˜Ÿåˆ—æ»¡äº†ã€‚æˆ‘ä»¬ä¼šæ£€æŸ¥while(queue.size == maxSize),éœ€è¦æ³¨æ„çš„æ˜¯åœ¨æ£€æŸ¥ä¹‹å‰éœ€è¦ç»™é˜Ÿåˆ—åŠ ä¸ŠåŒæ­¥é”ä»¥ä¿è¯åœ¨æ£€æŸ¥æ—¶æ²¡æœ‰å¦ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹é˜Ÿåˆ—ã€‚å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼ŒPRODUCERçº¿ç¨‹å°±ä¼šä¼‘çœ ï¼Œç›´åˆ°CONSUMERæ¶ˆè´¹äº†é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¹¶ä¸”è°ƒç”¨notify()æ–¹æ³•é€šçŸ¥PRODUCERçº¿ç¨‹ã€‚waitå’Œnotifyéƒ½æ˜¯åœ¨å…±äº«çš„å¯¹è±¡(æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯é˜Ÿåˆ—)ä¸Šè°ƒç”¨çš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112import java.util.LinkedList;import java.util.Queue;import java.util.Random;/** * Simple Java program to demonstrate How to use wait, notify and notifyAll() * method in Java by solving producer consumer problem. * * @author Javin Paul */public class MultipleThread &#123; public static void main(String args[]) &#123; System.out.println(&quot;How to use wait and notify method in Java&quot;); System.out.println(&quot;Solving Producer Consumper Problem&quot;); Queue&lt;Integer&gt; buffer = new LinkedList&lt;&gt;(); int maxSize = 10; Thread producer = new Producer(buffer, maxSize, &quot;PRODUCER&quot;); Thread consumer = new Consumer(buffer, maxSize, &quot;CONSUMER&quot;); producer.start(); consumer.start(); &#125;&#125;/** * Producer Thread will keep producing values for Consumer * to consumer. It will use wait() method when Queue is full * and use notify() method to send notification to Consumer * Thread. * @author WINDOWS 8 * */class Producer extends Thread &#123; private Queue&lt;Integer&gt; queue; private int maxSize; public Producer(Queue&lt;Integer&gt; queue, int maxSize, String name) &#123; super(name); this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run() &#123; while (true) &#123; synchronized (queue) &#123; while (queue.size() == maxSize) &#123; try &#123; System.out .println(&quot;Queue is full, &quot; + &quot;Producer thread waiting for &quot; + &quot;consumer to take something from queue&quot;); queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; Random random = new Random(); int i = random.nextInt(); System.out.println(&quot;Producing value : &quot; + i); queue.add(i); queue.notifyAll(); &#125; &#125; &#125;&#125;/** * Consumer Thread will consumer values form shared queue. * It will also use wait() method to wait if queue is * empty. It will also use notify method to send * notification to producer thread after consuming values * from queue. * @author WINDOWS 8 **/class Consumer extends Thread &#123; private Queue&lt;Integer&gt; queue; private int maxSize; public Consumer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123; super(name); this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run() &#123; while (true) &#123; synchronized (queue) &#123; while (queue.isEmpty()) &#123; System.out.println(&quot;Queue is empty,&quot; + &quot;Consumer thread is waiting&quot; + &quot; for producer thread to put something in queue&quot;); try &#123; queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; System.out.println(&quot;Consuming value : &quot; + queue.remove()); queue.notifyAll(); &#125; &#125; &#125;&#125;Output How to use wait and notify method in Java Solving Producer Consumper Problem Queue is empty,Consumer thread is waiting for producer thread to put something in queue Producing value : -1692411980 Producing value : 285310787 Producing value : -1045894970 Producing value : 2140997307 Producing value : 1379699468 Producing value : 912077154 Producing value : -1635438928 Producing value : -500696499 Producing value : -1985700664 Producing value : 961945684 Queue is full, Producer thread waiting for consumer to take something from queue Consuming value : -1692411980 Consuming value : 285310787 Consuming value : -1045894970 Consuming value : 2140997307 Consuming value : 1379699468 Consuming value : 912077154 Consuming value : -1635438928 Consuming value : -500696499 Consuming value : -1985700664 Consuming value : 961945684 Queue is empty,Consumer thread is waiting for producer thread to put something in queue ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAlléœ€è¦æ³¨æ„çš„ åœ¨Javaä¸­å¯ä»¥ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllå®Œæˆå¤šçº¿ç¨‹(ä¸ä»…ä»…æ˜¯ä¸¤ä¸ªçº¿ç¨‹)çš„å†…éƒ¨é€šä¿¡ã€‚ åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllï¼Œå¦åˆ™JVMä¼šæŠ›å‡ºIllegalMonitorStateException åœ¨å¾ªç¯ä¸­è°ƒç”¨waitï¼Œnotifyã€‚ åœ¨çº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨wait åå‘é€‰æ‹©notifyAllï¼Œè€Œä¸æ˜¯notify","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/categories/å¤šçº¿ç¨‹/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"ã€è¯‘ã€‘Java8ä¸­çš„æ‰©å±•(default/extension)æ–¹æ³• ï¼ˆè½¬è½½ï¼‰","slug":"Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•","date":"2018-04-13T07:14:18.000Z","updated":"2018-04-20T13:17:08.750Z","comments":true,"path":"2018/04/13/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/","link":"","permalink":"https://hsb786.github.io/2018/04/13/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/","excerpt":"Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨defaultå’Œstaticä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚","text":"Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨defaultå’Œstaticä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚ Defaultæ–¹æ³•çš„ä¾‹å­Java 8è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡defaultå…³é”®å­—ä¸ºæ¥å£æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•ã€‚è¿™ä¸€ç‰¹æ€§ä¹Ÿè¢«ç§°ä½œExtension(æ‰©å±•)æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ç¬¬ä¸€ä¸ªä¾‹å­ï¼š 12345678interface Multiplication&#123; int multiply(int a, int b); default int square(int a)&#123; return multiply(a, a); &#125; &#125; é™¤äº†æŠ½è±¡æ–¹æ³•multiply()ä¹‹å¤–ï¼Œæ¥å£Multiplicationè¿˜åŒ…å«ä¸€ä¸ªdefaultæ–¹æ³•square()ã€‚ä»»ä½•å®ç°Multiplicationæ¥å£çš„ç±»åªéœ€å®ç°æŠ½è±¡æ–¹æ³•multiplyï¼Œdefaultæ–¹æ³•square()å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ 12345678Multiplication product = new Multiplication()&#123; @Override public int multiply(int x, int y)&#123; return x*y; &#125;&#125;; int square = product.square(2); int multiplication = product.multiply(2, 3); productæ˜¯ä¸ªåŒ¿åç±»ã€‚è¿™æ®µä»£ç æœ‰ç‚¹å•°å—¦äº†ï¼Œç”¨äº†6è¡Œå®ç°ä¸€ä¸ªç®€å•åœ°ä¹˜æ³•çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨lambdaè¡¨è¾¾å¼æ¥ç®€åŒ–ä¸€ä¸‹ä»£ç ï¼Œlambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯Java 8ä¸­æ–°å¼•å…¥çš„ã€‚å› ä¸ºæˆ‘ä»¬çš„æ¥å£åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œè€Œä¸”lambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯SAM(Single Abstract methodå•ä¸€æŠ½è±¡æ–¹æ³•)ç±»å‹çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨lambdaè¡¨è¾¾å¼æ¥æ›¿ä»£åŒ¿åç±»å°†ä»£ç ç®€åŒ–æˆä¸‹é¢çš„æ ·å­ã€‚123Multiplication lambda = (x, y) -&gt; x*y; int product = lambda.multiply(3, 4); int square = lambda.square(4); ä»¥ä¸Šå°±æ˜¯åœ¨æ¥å£ä¸­ä½¿ç”¨defaultæ–¹æ³•çš„ä¾‹å­ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ¯«æ— é¡¾è™‘çš„åœ¨æ—§çš„æ¥å£ä¸­æ‰©å±•æ–°çš„æ–¹æ³•ï¼Œåªè¦è¿™äº›æ–¹æ³•æ˜¯defaultæˆ–staticçš„å°±ä¸ç”¨æ‹…å¿ƒä¼šç ´åæ¥å£çš„å®ç°ç±»ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142/**Java Program to demonstrate use of default method in Java 8. * You can define non-abstract method by using default keyword, and more * than one default method is permitted, which allows you to ship default skeletal * implementation on interface itself. * @author Javin Paul */ public class Java8DefaultMethodDemo&#123; public static void main(String args[]) &#123; // Implementing interface using Anonymous class Multiplication product = new Multiplication()&#123; @Override public int multiply(int x, int y)&#123; return x*y; &#125; &#125;; int squareOfTwo = product.square(2); int cubeOfTwo = product.cube(2); System.out.println(&quot;Square of Two : &quot; + squareOfTwo); System.out.println(&quot;Cube of Two : &quot; + cubeOfTwo); // Since Multiplication has only one abstract method, it can // also be implemented using lambda expression in Java 8 Multiplication lambda = (x, y) -&gt; x*y; int squareOfThree = lambda.square(3); int cubeOfThree = lambda.cube(3); System.out.println(&quot;Square of Three : &quot; + squareOfThree); System.out.println(&quot;Cube of Three : &quot; + cubeOfThree); &#125; &#125; interface Multiplication&#123; int multiply(int a, int b); default int square(int a)&#123; return multiply(a, a); &#125; default int cube(int a)&#123; return multiply(multiply(a, a), a); &#125; &#125; Output : Square of Two : 4 Cube of Two : 8 Square of Three : 9 Cube of Three : 27 è¿™æ˜¯ä¸ªå¾ˆå¥½çš„å…³äºå¦‚ä½•ä½¿ç”¨defaultæ–¹æ³•åœ¨æ¥å£ä¸­æ–¹ä¾¿çš„æ·»åŠ æ–¹æ³•çš„ä¾‹å­ã€‚ä¹Ÿå±•ç¤ºäº†å¦‚ä½•é¿å…ä¸€ä¸ªé¢å¤–çš„å¸®åŠ©ç±»ï¼Œæ¯”å¦‚Collectionsç±»ã€‚å®ƒä»…ä»…æä¾›äº†ä¸€äº›ç”¨äºCollectionçš„å·¥å…·æ–¹æ³•ï¼Œè€Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨Collectionä¸­å®šä¹‰è¿™äº›æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•multiply(a,b)çš„æ¥å£Multiplicationï¼Œæ¥å£è¿˜åŒ…æ‹¬ä¸¤ä¸ªä¾èµ–äºmultiply(a,b)æ–¹æ³•çš„éæŠ½è±¡æ–¹æ³•square(a)å’Œcube(b)ã€‚æ¥å£çš„å®ç°ç±»åªéœ€è¦å®ç°multiply(a,b)æ–¹æ³•ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨square(a)å’Œcube(b)æ–¹æ³•äº†ã€‚ defaultæ–¹æ³•çš„å…³é”®ç‚¹ åœ¨Java8ä¸­ä½ å¯ä»¥åœ¨æ¥å£ä¸­æ·»åŠ defaultæ–¹æ³• defaultæ–¹æ³•çš„å‡ºç°ä½¿å¾—æ¥å£å’ŒæŠ½è±¡ç±»çš„ä¸åŒå˜å¾—æ¨¡ç³Šã€‚æ‰€ä»¥ï¼Œå½“åœ¨é¢è¯•ä¸­è¢«é—®åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåˆ«å¿˜äº†æä¸€ä¸‹ï¼Œä»¥å‰åªèƒ½é€šè¿‡æŠ½è±¡ç±»å®ç°çš„äº‹æƒ…ï¼Œç°åœ¨ä¹Ÿå¯ä»¥é€šè¿‡defaultæ–¹æ³•å®ç°äº†ã€‚ defaultå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å…³é”®å­—ï¼Œåœ¨JDK1.1ä¸­å°±æ˜¯ä¿ç•™å…³é”®å­— æ¥å£ä¸­defaultæ–¹æ³•çš„æ•°é‡æ²¡æœ‰é™åˆ¶ å¦‚æœæ¥å£Cç»§æ‰¿äº†æ¥å£Aå’ŒBï¼Œå¦‚æœAå’ŒBä¸­æ‹¥æœ‰ä¸€æ ·çš„defaultæ–¹æ³•ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ã€‚ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œè¿™åœ¨Java 8ä¸­æ˜¯ä¸å…è®¸çš„ã€‚æ‰€ä»¥å½“defaultæ–¹æ³•æœ‰å†²çªæ—¶ï¼Œæ˜¯ä¸å¯ä»¥å¤šç»§æ‰¿çš„ åœ¨JDK1.8ä¸­æœ‰è®¸å¤šå…³äºdefaultæ–¹æ³•çš„ä¾‹å­ï¼Œæ¯”å¦‚forEachæ–¹æ³•ã€‚ä¹Ÿå¯ä»¥æŸ¥çœ‹java.util.Mapä¸­æ–°æ·»çš„putIfAbsentæ–¹æ³•ï¼Œåœ¨JDK1.8ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½ConcurrentMapæ¥ä½¿ç”¨å®ƒã€‚ ä»¥ä¸Šå°±æ˜¯defaultæ–¹æ³•ã€‚ä¸å¾—ä¸è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„çªç ´ï¼Œä½¿æˆ‘ä»¬å¯ä»¥æ›´å¥½æ›´æ–¹ä¾¿çš„ä½¿ç”¨æ¥å£ã€‚äº†è§£CurrentMapçš„putIfAbsentæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„è®°ä½defaultæ–¹æ³•ã€‚åœ¨JDK1.7ä¸­ï¼ŒputIfAbsentæ–¹æ³•å¹¶ä¸å­˜åœ¨äºMapæ¥å£ä¸­ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿ç”¨putIfAbsentæ–¹æ³•ï¼Œå¿…é¡»å°†Mapæ¥å£æŒ‡å‘çš„ConcurrentMapå¯¹è±¡å¼ºåˆ¶è½¬æ¢æˆConcurrentMapã€‚ä½†Java 8å¼•å…¥æ‰©å±•æ–¹æ³•ä¹‹åï¼ŒMapæ¥å£ä¸­ä¹Ÿæœ‰äº†putIfAbsentæ–¹æ³•ã€‚ å‚è€ƒ ã€è¯‘ã€‘Java8ä¸­çš„æ‰©å±•(default/extension)æ–¹æ³•","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMapï¼ˆè½¬è½½ï¼‰","slug":"ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap","date":"2018-04-13T06:41:41.000Z","updated":"2018-04-20T13:14:54.280Z","comments":true,"path":"2018/04/13/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/","link":"","permalink":"https://hsb786.github.io/2018/04/13/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/","excerpt":"ConcurrentHashMap(ç®€ç§°CHM)æ˜¯åœ¨Java 1.5ä½œä¸ºHashtableçš„æ›¿ä»£é€‰æ‹©æ–°å¼•å…¥çš„ï¼Œæ˜¯concurrentåŒ…çš„é‡è¦æˆå‘˜ã€‚åœ¨Java 1.5ä¹‹å‰ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¯ä»¥åœ¨å¤šçº¿ç¨‹å’Œå¹¶å‘çš„ç¨‹åºä¸­å®‰å…¨ä½¿ç”¨çš„Map,åªèƒ½åœ¨HashTableå’Œsynchronized Mapä¸­é€‰æ‹©ï¼Œå› ä¸ºHashMapå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†å†å¼•å…¥äº†CHMä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¥½çš„é€‰æ‹©ã€‚CHMä¸ä½†æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”æ¯”HashTableå’ŒsynchronizedMapçš„æ€§èƒ½è¦å¥½ã€‚ç›¸å¯¹äºHashTableå’ŒsynchronizedMapé”ä½äº†æ•´ä¸ªMapï¼ŒCHMåªé”ä½éƒ¨åˆ†Mapã€‚CHMå…è®¸å¹¶å‘çš„è¯»æ“ä½œï¼ŒåŒæ—¶é€šè¿‡åŒæ­¥é”åœ¨å†™æ“ä½œæ—¶ä¿æŒæ•°æ®å®Œæ•´æ€§ã€‚","text":"ConcurrentHashMap(ç®€ç§°CHM)æ˜¯åœ¨Java 1.5ä½œä¸ºHashtableçš„æ›¿ä»£é€‰æ‹©æ–°å¼•å…¥çš„ï¼Œæ˜¯concurrentåŒ…çš„é‡è¦æˆå‘˜ã€‚åœ¨Java 1.5ä¹‹å‰ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¯ä»¥åœ¨å¤šçº¿ç¨‹å’Œå¹¶å‘çš„ç¨‹åºä¸­å®‰å…¨ä½¿ç”¨çš„Map,åªèƒ½åœ¨HashTableå’Œsynchronized Mapä¸­é€‰æ‹©ï¼Œå› ä¸ºHashMapå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†å†å¼•å…¥äº†CHMä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¥½çš„é€‰æ‹©ã€‚CHMä¸ä½†æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”æ¯”HashTableå’ŒsynchronizedMapçš„æ€§èƒ½è¦å¥½ã€‚ç›¸å¯¹äºHashTableå’ŒsynchronizedMapé”ä½äº†æ•´ä¸ªMapï¼ŒCHMåªé”ä½éƒ¨åˆ†Mapã€‚CHMå…è®¸å¹¶å‘çš„è¯»æ“ä½œï¼ŒåŒæ—¶é€šè¿‡åŒæ­¥é”åœ¨å†™æ“ä½œæ—¶ä¿æŒæ•°æ®å®Œæ•´æ€§ã€‚ Javaä¸­ConcurrentHashMapçš„å®ç°CHMå¼•å…¥äº†åˆ†å‰²ï¼Œå¹¶æä¾›äº†HashTableæ”¯æŒçš„æ‰€æœ‰çš„åŠŸèƒ½ã€‚åœ¨CHMä¸­ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¯¹Mapåšè¯»æ“ä½œï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•çš„blockingã€‚è¿™å¾—ç›ŠäºCHMå°†Mapåˆ†å‰²æˆäº†ä¸åŒçš„éƒ¨åˆ†ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶åªé”ä½ä¸€éƒ¨åˆ†ã€‚æ ¹æ®é»˜è®¤çš„å¹¶å‘çº§åˆ«(concurrency level)ï¼ŒMapè¢«åˆ†å‰²æˆ16ä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”ç”±ä¸åŒçš„é”æ§åˆ¶ã€‚è¿™æ„å‘³ç€ï¼ŒåŒæ—¶æœ€å¤šå¯ä»¥æœ‰16ä¸ªå†™çº¿ç¨‹æ“ä½œMapã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œç”±åªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥å˜æˆåŒæ—¶å¯ç”±16ä¸ªå†™çº¿ç¨‹åŒæ—¶è¿›å…¥(è¯»çº¿ç¨‹å‡ ä¹ä¸å—é™åˆ¶)ï¼Œæ€§èƒ½çš„æå‡æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†ç”±äºä¸€äº›æ›´æ–°æ“ä½œï¼Œå¦‚put(),remove(),putAll(),clear()åªé”ä½æ“ä½œçš„éƒ¨åˆ†ï¼Œæ‰€ä»¥åœ¨æ£€ç´¢æ“ä½œä¸èƒ½ä¿è¯è¿”å›çš„æ˜¯æœ€æ–°çš„ç»“æœã€‚ å¦ä¸€ä¸ªé‡è¦ç‚¹æ˜¯åœ¨è¿­ä»£éå†CHMæ—¶ï¼ŒkeySetè¿”å›çš„iteratoræ˜¯å¼±ä¸€è‡´å’Œfail-safeçš„ï¼Œå¯èƒ½ä¸ä¼šè¿”å›æŸäº›æœ€è¿‘çš„æ”¹å˜ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå·²ç»éå†çš„æ•°ç»„ä¸Šçš„å†…å®¹å˜åŒ–äº†ï¼Œä¸ä¼šæŠ›å‡ºConcurrentModificationExceptoinçš„å¼‚å¸¸ã€‚ CHMé»˜è®¤çš„å¹¶å‘çº§åˆ«æ˜¯16ï¼Œä½†å¯ä»¥åœ¨åˆ›å»ºCHMæ—¶é€šè¿‡æ„é€ å‡½æ•°æ”¹å˜ã€‚æ¯«æ— ç–‘é—®ï¼Œå¹¶å‘çº§åˆ«ä»£è¡¨ç€å¹¶å‘æ‰§è¡Œæ›´æ–°æ“ä½œçš„æ•°ç›®ï¼Œæ‰€ä»¥å¦‚æœåªæœ‰å¾ˆå°‘çš„çº¿ç¨‹ä¼šæ›´æ–°Mapï¼Œé‚£ä¹ˆå»ºè®®è®¾ç½®ä¸€ä¸ªä½çš„å¹¶å‘çº§åˆ«ã€‚å¦å¤–ï¼ŒCHMè¿˜ä½¿ç”¨äº†ReentrantLockæ¥å¯¹segmentsåŠ é”ã€‚ Javaä¸­ConcurrentHashMap putifAbsentæ–¹æ³•çš„ä¾‹å­å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨å…ƒç´ ä¸å­˜åœ¨æ—¶æ’å…¥å…ƒç´ ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåƒä¸‹é¢é‚£æ ·å†™ä»£ç  1234567synchronized(map)&#123; if (map.get(key) == null)&#123; return map.put(key, value); &#125; else&#123; return map.get(key); &#125;&#125; ä¸Šé¢è¿™æ®µä»£ç åœ¨HashMapå’ŒHashTableä¸­æ˜¯å¥½ç”¨çš„ï¼Œä½†åœ¨CHMä¸­æ˜¯æœ‰å‡ºé”™çš„é£é™©çš„ã€‚è¿™æ˜¯å› ä¸ºCHMåœ¨putæ“ä½œæ—¶å¹¶æ²¡æœ‰å¯¹æ•´ä¸ªMapåŠ é”ï¼Œæ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨put(k,v)çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨get(k)ä¼šå¾—åˆ°nullï¼Œè¿™å°±ä¼šé€ æˆä¸€ä¸ªçº¿ç¨‹putçš„å€¼ä¼šè¢«å¦ä¸€ä¸ªçº¿ç¨‹putçš„å€¼æ‰€è¦†ç›–ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥å°†ä»£ç å°è£…åˆ°synchronizedä»£ç å—ä¸­ï¼Œè¿™æ ·è™½ç„¶çº¿ç¨‹å®‰å…¨äº†ï¼Œä½†ä¼šä½¿ä½ çš„ä»£ç å˜æˆäº†å•çº¿ç¨‹ã€‚CHMæä¾›çš„putIfAbsent(key,value)æ–¹æ³•åŸå­æ€§çš„å®ç°äº†åŒæ ·çš„åŠŸèƒ½ï¼ŒåŒæ—¶é¿å…äº†ä¸Šé¢çš„çº¿ç¨‹ç«äº‰çš„é£é™©ã€‚ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMapCHMé€‚ç”¨äºè¯»è€…æ•°é‡è¶…è¿‡å†™è€…æ—¶ï¼Œå½“å†™è€…æ•°é‡å¤§äºç­‰äºè¯»è€…æ—¶ï¼ŒCHMçš„æ€§èƒ½æ˜¯ä½äºHashtableå’Œsynchronized Mapçš„ã€‚è¿™æ˜¯å› ä¸ºå½“é”ä½äº†æ•´ä¸ªMapæ—¶ï¼Œè¯»æ“ä½œè¦ç­‰å¾…å¯¹åŒä¸€éƒ¨åˆ†æ‰§è¡Œå†™æ“ä½œçš„çº¿ç¨‹ç»“æŸã€‚CHMé€‚ç”¨äºåšcache,åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œä¹‹åå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚çº¿ç¨‹è®¿é—®ã€‚æ­£å¦‚Javadocè¯´æ˜çš„é‚£æ ·ï¼ŒCHMæ˜¯HashTableä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£ï¼Œä½†è¦è®°ä½ï¼ŒCHMçš„æ¯”HashTableçš„åŒæ­¥æ€§ç¨å¼±ã€‚ æ€»ç»“ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯ConcurrentHashMapå’Œä»€ä¹ˆæ—¶å€™è¯¥ç”¨ConcurrentHashMapï¼Œä¸‹é¢æˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹CHMçš„ä¸€äº›å…³é”®ç‚¹ã€‚ CHMå…è®¸å¹¶å‘çš„è¯»å’Œçº¿ç¨‹å®‰å…¨çš„æ›´æ–°æ“ä½œ åœ¨æ‰§è¡Œå†™æ“ä½œæ—¶ï¼ŒCHMåªé”ä½éƒ¨åˆ†çš„Map å¹¶å‘çš„æ›´æ–°æ˜¯é€šè¿‡å†…éƒ¨æ ¹æ®å¹¶å‘çº§åˆ«å°†Mapåˆ†å‰²æˆå°éƒ¨åˆ†å®ç°çš„ é«˜çš„å¹¶å‘çº§åˆ«ä¼šé€ æˆæ—¶é—´å’Œç©ºé—´çš„æµªè´¹ï¼Œä½çš„å¹¶å‘çº§åˆ«åœ¨å†™çº¿ç¨‹å¤šæ—¶ä¼šå¼•èµ·çº¿ç¨‹é—´çš„ç«äº‰ CHMçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨ CHMè¿”å›çš„è¿­ä»£å™¨æ˜¯å¼±ä¸€è‡´æ€§ï¼Œfail-safeå¹¶ä¸”ä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ CHMä¸å…è®¸nullçš„é”®å€¼ å¯ä»¥ä½¿ç”¨CHMä»£æ›¿HashTableï¼Œä½†è¦è®°ä½CHMä¸ä¼šé”ä½æ•´ä¸ªMap å‚è€ƒ ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"ã€è¯‘ã€‘Executor, ExecutorService å’Œ Executors é—´çš„ä¸åŒ ï¼ˆè½¬è½½ï¼‰","slug":"difference-between-executor-executorService","date":"2018-04-13T05:21:41.000Z","updated":"2018-04-20T13:15:24.474Z","comments":true,"path":"2018/04/13/difference-between-executor-executorService/","link":"","permalink":"https://hsb786.github.io/2018/04/13/difference-between-executor-executorService/","excerpt":"java.util.concurrent.Executor, java.util.concurrent.ExecutorService, java.util.concurrent. Executors è¿™ä¸‰è€…å‡æ˜¯ Java Executor æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ± çš„åŠŸèƒ½ã€‚å› ä¸ºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹éå¸¸å¿ƒç´¯ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿé€šå¸¸å¯¹çº¿ç¨‹æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨çº¿ç¨‹æ± ä¸ä»…å¯ä»¥æé«˜åº”ç”¨çš„å“åº”æ—¶é—´ï¼Œè¿˜å¯ä»¥é¿å…â€java.lang.OutOfMemoryError: unable to create new native threadâ€ ä¹‹ç±»çš„é”™è¯¯ã€‚","text":"java.util.concurrent.Executor, java.util.concurrent.ExecutorService, java.util.concurrent. Executors è¿™ä¸‰è€…å‡æ˜¯ Java Executor æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ± çš„åŠŸèƒ½ã€‚å› ä¸ºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹éå¸¸å¿ƒç´¯ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿé€šå¸¸å¯¹çº¿ç¨‹æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨çº¿ç¨‹æ± ä¸ä»…å¯ä»¥æé«˜åº”ç”¨çš„å“åº”æ—¶é—´ï¼Œè¿˜å¯ä»¥é¿å…â€java.lang.OutOfMemoryError: unable to create new native threadâ€ ä¹‹ç±»çš„é”™è¯¯ã€‚åœ¨ Java 1.5 æ—¶ï¼Œå¼€å‘è€…éœ€è¦å…³å¿ƒçº¿ç¨‹æ± çš„åˆ›å»ºå’Œç®¡ç†ï¼Œä½†åœ¨ Java 1.5 ä¹‹å Executor æ¡†æ¶æä¾›äº†å¤šç§å†…ç½®çš„çº¿ç¨‹æ± ,ä¾‹å¦‚ï¼šFixedThreadPool(åŒ…å«å›ºå®šæ•°ç›®çš„çº¿ç¨‹)ï¼ŒCachedThreadPool(å¯æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹)ç­‰ç­‰ã€‚ ExecutorExecutor, ExecutorService, å’Œ Executors æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯ Executor æ˜¯ä¸€ä¸ªæŠ½è±¡å±‚é¢çš„æ ¸å¿ƒæ¥å£(å¤§è‡´ä»£ç å¦‚ä¸‹)ã€‚ 123public interface Executor &#123; void execute(Runnable command);&#125; ä¸åŒäº java.lang.Thread ç±»å°†ä»»åŠ¡å’Œæ‰§è¡Œè€¦åˆåœ¨ä¸€èµ·ï¼Œ Executor å°†ä»»åŠ¡æœ¬èº«å’Œæ‰§è¡Œä»»åŠ¡åˆ†ç¦»ï¼Œå¯ä»¥é˜…è¯» difference between Thread and Executor æ¥äº†è§£ Thread å’Œ Executor é—´æ›´å¤šçš„ä¸åŒã€‚ ExecutorServiceExecutorService æ¥å£ å¯¹ Executor æ¥å£è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†è¿”å› Future å¯¹è±¡ï¼Œç»ˆæ­¢ï¼Œå…³é—­çº¿ç¨‹æ± ç­‰æ–¹æ³•ã€‚å½“è°ƒç”¨ shutDown æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåœæ­¢æ¥å—æ–°çš„ä»»åŠ¡ï¼Œä½†ä¼šå®Œæˆæ­£åœ¨ pending ä¸­çš„ä»»åŠ¡ã€‚ Future å¯¹è±¡æä¾›äº†å¼‚æ­¥æ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ— éœ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œçš„å®Œæˆï¼Œåªè¦æäº¤éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶ååœ¨éœ€è¦æ—¶æ£€æŸ¥ Future æ˜¯å¦å·²ç»æœ‰äº†ç»“æœï¼Œå¦‚æœä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡ Future.get() æ–¹æ³•è·å¾—æ‰§è¡Œç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒFuture.get() æ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡å¼çš„æ–¹æ³•ï¼Œå¦‚æœè°ƒç”¨æ—¶ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œä¼šç­‰å¾…ç›´åˆ°ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚ é€šè¿‡ ExecutorService.submit() æ–¹æ³•è¿”å›çš„ Future å¯¹è±¡ï¼Œè¿˜å¯ä»¥å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œã€‚Future æä¾›äº† cancel() æ–¹æ³•ç”¨æ¥å–æ¶ˆæ‰§è¡Œ pending ä¸­çš„ä»»åŠ¡ã€‚ ExecutorService éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š 123456public interface ExecutorService extends Executor &#123; void shutdown(); &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task); &lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result); &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException;&#125; ExecutorsExecutors æ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œç±»ä¼¼äº Collectionsã€‚æä¾›å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ï¼Œæ¯”å¦‚ FixedThreadPool æˆ– CachedThreadPoolã€‚ Executors éƒ¨åˆ†ä»£ç ï¼š 123456789public class Executors &#123; public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS,new LinkedBlockingQueue&lt;Runnable&gt;()); &#125; public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;()); &#125;&#125; ä¸‹é¢è¯¦ç»†çœ‹ä¸€ä¸‹ä¸‰è€…çš„åŒºåˆ«ï¼š Executor vs ExecutorService vs Executorsæ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œè¿™ä¸‰è€…å‡æ˜¯ Executor æ¡†æ¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚Java å¼€å‘è€…å¾ˆæœ‰å¿…è¦å­¦ä¹ å’Œç†è§£ä»–ä»¬ï¼Œä»¥ä¾¿æ›´é«˜æ•ˆçš„ä½¿ç”¨ Java æä¾›çš„ä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ€»ç»“ä¸€ä¸‹è¿™ä¸‰è€…é—´çš„åŒºåˆ«ï¼Œä»¥ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£ï¼š Executor å’Œ ExecutorService è¿™ä¸¤ä¸ªæ¥å£ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼šExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£ï¼Œæ˜¯ Executor çš„å­æ¥å£ Executor å’Œ ExecutorService ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ï¼šExecutor æ¥å£å®šä¹‰äº† execute()æ–¹æ³•ç”¨æ¥æ¥æ”¶ä¸€ä¸ªRunnableæ¥å£çš„å¯¹è±¡ï¼Œè€Œ ExecutorService æ¥å£ä¸­çš„ submit()æ–¹æ³•å¯ä»¥æ¥å—Runnableå’ŒCallableæ¥å£çš„å¯¹è±¡ã€‚ Executor å’Œ ExecutorService æ¥å£ç¬¬ä¸‰ä¸ªåŒºåˆ«æ˜¯ Executor ä¸­çš„ execute() æ–¹æ³•ä¸è¿”å›ä»»ä½•ç»“æœï¼Œè€Œ ExecutorService ä¸­çš„ submit()æ–¹æ³•å¯ä»¥é€šè¿‡ä¸€ä¸ª Future å¯¹è±¡è¿”å›è¿ç®—ç»“æœã€‚ Executor å’Œ ExecutorService æ¥å£ç¬¬å››ä¸ªåŒºåˆ«æ˜¯é™¤äº†å…è®¸å®¢æˆ·ç«¯æäº¤ä¸€ä¸ªä»»åŠ¡ï¼ŒExecutorService è¿˜æä¾›ç”¨æ¥æ§åˆ¶çº¿ç¨‹æ± çš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼šè°ƒç”¨ shutDown() æ–¹æ³•ç»ˆæ­¢çº¿ç¨‹æ± ã€‚å¯ä»¥é€šè¿‡ ã€ŠJava Concurrency in Practiceã€‹ ä¸€ä¹¦äº†è§£æ›´å¤šå…³äºå…³é—­çº¿ç¨‹æ± å’Œå¦‚ä½•å¤„ç† pending çš„ä»»åŠ¡çš„çŸ¥è¯†ã€‚ Executors ç±»æä¾›å·¥å‚æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ¯”å¦‚: newSingleThreadExecutor() åˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼ŒnewFixedThreadPool(int numOfThreads)æ¥åˆ›å»ºå›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼ŒnewCachedThreadPool()å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œä½†å¦‚æœå·²æœ‰çº¿ç¨‹æ˜¯ç©ºé—²çš„ä¼šé‡ç”¨å·²æœ‰çº¿ç¨‹ã€‚ æ€»ç»“ä¸‹è¡¨åˆ—å‡ºäº† Executor å’Œ ExecutorService çš„åŒºåˆ«ï¼š Executor ExecutorService Executor æ˜¯ Java çº¿ç¨‹æ± çš„æ ¸å¿ƒæ¥å£ï¼Œç”¨æ¥å¹¶å‘æ‰§è¡Œæäº¤çš„ä»»åŠ¡ ExecutorService æ˜¯ Executor æ¥å£çš„æ‰©å±•ï¼Œæä¾›äº†å¼‚æ­¥æ‰§è¡Œå’Œå…³é—­çº¿ç¨‹æ± çš„æ–¹æ³• æä¾›execute()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡ æä¾›submit()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡ execute()æ–¹æ³•æ— è¿”å›å€¼ submit()æ–¹æ³•è¿”å›Futureå¯¹è±¡ï¼Œå¯ç”¨æ¥è·å–ä»»åŠ¡æ‰§è¡Œç»“æœ ä¸èƒ½å–æ¶ˆä»»åŠ¡ å¯ä»¥é€šè¿‡Future.cancel()å–æ¶ˆpendingä¸­çš„ä»»åŠ¡ æ²¡æœ‰æä¾›å’Œå…³é—­çº¿ç¨‹æ± æœ‰å…³çš„æ–¹æ³• æä¾›äº†å…³é—­çº¿ç¨‹æ± çš„æ–¹æ³• å‚è€ƒ ã€è¯‘ã€‘Executor, ExecutorService å’Œ Executors é—´çš„ä¸åŒ","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/categories/å¤šçº¿ç¨‹/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"vscode-database","slug":"vscode-database","date":"2018-04-13T03:55:59.000Z","updated":"2018-04-20T13:19:53.435Z","comments":true,"path":"2018/04/13/vscode-database/","link":"","permalink":"https://hsb786.github.io/2018/04/13/vscode-database/","excerpt":"æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„vscodeæ’ä»¶, vscode-database è¿·ä¸Šäº†vscode","text":"æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„vscodeæ’ä»¶, vscode-database è¿·ä¸Šäº†vscode å¿«æ·é”® å‘½ä»¤ è¯­ä¹‰ ctrl q querySQL ctrl shift e Run selected text as SQL query","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/categories/å·¥å…·/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"è§¦å‘å™¨","slug":"è§¦å‘å™¨","date":"2018-04-13T03:43:11.000Z","updated":"2018-04-20T13:20:20.879Z","comments":true,"path":"2018/04/13/è§¦å‘å™¨/","link":"","permalink":"https://hsb786.github.io/2018/04/13/è§¦å‘å™¨/","excerpt":"å¯¹æŸä¸€ä¸ªè¡¨çš„æŸç§æ“ä½œï¼Œè§¦å‘æŸç§æ¡ä»¶ï¼Œä»è€Œæ‰§è¡Œçš„ä¸€æ®µç¨‹åº new: æ–°æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæ²¡æœ‰ï¼Œå°†è¦æœ‰çš„æ•°æ®ã€‚ä¾‹å¦‚å°†è¦æ›´æ–°çš„æ•°æ®æˆ–è€…æ˜¯æ–°å¢çš„æ•°æ®ã€‚ oldï¼šæ—§æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæœ‰çš„æ•°æ®","text":"å¯¹æŸä¸€ä¸ªè¡¨çš„æŸç§æ“ä½œï¼Œè§¦å‘æŸç§æ¡ä»¶ï¼Œä»è€Œæ‰§è¡Œçš„ä¸€æ®µç¨‹åº new: æ–°æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæ²¡æœ‰ï¼Œå°†è¦æœ‰çš„æ•°æ®ã€‚ä¾‹å¦‚å°†è¦æ›´æ–°çš„æ•°æ®æˆ–è€…æ˜¯æ–°å¢çš„æ•°æ®ã€‚ oldï¼šæ—§æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæœ‰çš„æ•°æ® è¯´æ˜ï¼šåœ¨æŠŠuserjob(ç”¨æˆ·å²—ä½å…³è”è¡¨)ä¸­çš„success(å®¡æ‰¹çŠ¶æ€)æ›´æ–°ä¸ºtrueæ—¶ï¼Œè‡ªåŠ¨åœ¨æˆç»©è¡¨ä¸­å‡ºå…¥æ•°æ®ï¼›å¦åˆ™è¯´æ˜æ²¡æœ‰å®¡æ‰¹æ²¡æœ‰é€šè¿‡ï¼ŒæŠŠæˆç»©è¡¨ä¸­å¯¹åº”çš„æ•°æ®åˆ é™¤1234CREATE TRIGGER `insertScore` AFTER UPDATE ON `userjob` FOR EACH ROW if new.success=true theninsert into score(id) values(new.id);else delete from score where id=new.id;end if è¯´æ˜ï¼šåœ¨åˆ é™¤userjob(ç”¨æˆ·å²—ä½å…³è”è¡¨)çš„æ•°æ®æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æˆç»©è¡¨å¯¹åº”ä¸­çš„æ•°æ®123CREATE TRIGGER `deleteScore` BEFORE DELETE ON `userjob` FOR EACH ROW if old.success=true thendelete from score where id=old.id;end if","categories":[{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/categories/sql/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/tags/sql/"}]},{"title":"ç´¢å¼•","slug":"ç´¢å¼•","date":"2018-04-12T12:56:19.000Z","updated":"2018-04-20T13:22:39.072Z","comments":true,"path":"2018/04/12/ç´¢å¼•/","link":"","permalink":"https://hsb786.github.io/2018/04/12/ç´¢å¼•/","excerpt":"ç´¢å¼•ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„ åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå¿«é€Ÿå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚","text":"ç´¢å¼•ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„ åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå¿«é€Ÿå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚ ä¼˜åŠ¿ æé«˜æ•°æ®æ£€ç´¢æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬ é€šè¿‡ç´¢å¼•å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½äº†æ¶ˆè€— åŠ£åŠ¿ å®é™…ä¸Šç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“è¡¨çš„è®°å½•ï¼Œç´¢å¼•åˆ—ä¹Ÿæ˜¯è¦å ç©ºé—´çš„ è™½ç„¶ç´¢å¼•åˆ—å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ã€‚å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶æ¯æ¬¡æ›´æ–°æ·»åŠ äº†ç´¢å¼•åˆ—çš„å­—æ®µ å“ªäº›æƒ…å†µéœ€è¦åˆ›å»ºç´¢å¼• ä¸»é”®è‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼• ï¼ˆä¸éœ€è¦è‡ªå·±å»ºï¼‰ é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œå¤–é”®å…³ç³»å»ºç«‹ç´¢å¼• ï¼ˆè‡ªåŠ¨å»ºç«‹ï¼‰ æŸ¥è¯¢ä¸­æ’åºçš„å­—æ®µï¼Œæ’åºçš„å­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦ æŸ¥è¯¢ä¸­ç»Ÿè®¡æˆ–è€…åˆ†ç»„çš„å­—æ®µ å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼• è¡¨è®°å½•å¤ªå° ç»å¸¸å¢åˆ æ”¹çš„è¡¨ æŸä¸ªæ•°æ®åˆ—åŒ…å«è®¸å¤šé‡å¤çš„å†…å®¹ï¼Œä¸ºå®ƒå»ºç«‹ç´¢å¼•å°±æ²¡æœ‰å¤ªå¤§çš„å®é™…æ•ˆæœ","categories":[{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/categories/sql/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/tags/sql/"}]},{"title":"Javaè™šæ‹ŸæœºåŸºç¡€","slug":"Javaè™šæ‹ŸæœºåŸºç¡€","date":"2018-04-12T12:01:50.000Z","updated":"2018-04-21T04:19:49.302Z","comments":true,"path":"2018/04/12/Javaè™šæ‹ŸæœºåŸºç¡€/","link":"","permalink":"https://hsb786.github.io/2018/04/12/Javaè™šæ‹ŸæœºåŸºç¡€/","excerpt":"å†…å­˜åŒºåŸŸJavaè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠä»–æ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚Javaè™šæ‹Ÿæœºè§„èŒƒå°†JVMæ‰€ç®¡ç†çš„å†…å­˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿è¡Œæ—¶æ•°æ®åŒºï¼šç¨‹åºè®¡æ•°å™¨ã€Javaè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€Javaå †ã€æ–¹æ³•åŒºã€‚ä¸‹é¢è¯¦ç»†é˜è¿°å„æ•°æ®åŒºæ‰€å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚","text":"å†…å­˜åŒºåŸŸJavaè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠä»–æ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚Javaè™šæ‹Ÿæœºè§„èŒƒå°†JVMæ‰€ç®¡ç†çš„å†…å­˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿è¡Œæ—¶æ•°æ®åŒºï¼šç¨‹åºè®¡æ•°å™¨ã€Javaè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€Javaå †ã€æ–¹æ³•åŒºã€‚ä¸‹é¢è¯¦ç»†é˜è¿°å„æ•°æ®åŒºæ‰€å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚ JVM(Java Virtual Machine)JVMå¹¶ä¸æ˜¯ä¸“ä¸ºJavaæ‰€å®ç°çš„ã€‚å®é™…ä¸Šåªè¦æœ‰å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘å™¨èƒ½ç”Ÿæˆæ­£ç¡®Java bytecodeæ–‡ä»¶ï¼Œåˆ™è¿™ä¸ªè¯­è¨€ä¹Ÿèƒ½å®ç°åœ¨JVMä¸Šè¿è¡Œã€‚ JVMé€šè¿‡æ‰§è¡ŒJava bytecodeå¯ä»¥ä½¿javaä»£ç åœ¨ä¸æ”¹å˜çš„æƒ…å†µä¸‹è¿è¡Œåœ¨å„ç§ç¡¬ä»¶ä¹‹ä¸Šï¼Œå› æ­¤å®ç°Javaå¹³å°æ— å…³æ€§ JVM = ç±»åŠ è½½å™¨ Class Loader + æ‰§è¡Œå¼•æ“ Execution Engine + è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ Runtime Data Area é¦–å…ˆJavaæºä»£ç æ–‡ä»¶è¢«Javaç¼–è¯‘å™¨ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶ï¼Œç„¶åJVMä¸­çš„ç±»åŠ è½½å™¨åŠ è½½å®Œæ¯•ä¹‹åï¼Œäº¤ç”±JVMæ‰§è¡Œå¼•æ“æ‰§è¡Œã€‚åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒJVMä¸­çš„è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆå†…å­˜ï¼‰ä¼šç”¨æ¥å­˜å‚¨ç¨‹åºæ‰§è¡ŒæœŸé—´éœ€è¦ç”¨åˆ°çš„æ•°æ®å’Œç›¸å…³ä¿¡æ¯ã€‚ Class LoaderClassLoaderæŠŠç¡¬ç›˜ä¸Šçš„classæ–‡ä»¶åŠ è½½åˆ°JVMä¸­çš„è¿è¡Œæ—¶æ•°æ®åŒºåŸŸï¼Œä½†æ˜¯å®ƒå¹¶ä¸è´Ÿè´£è¿™ä¸ªç±»æ–‡ä»¶èƒ½å¦æ‰§è¡Œï¼Œè€Œè¿™ä¸ªæ˜¯æ‰§è¡Œå¼•æ“è´Ÿè´£çš„ã€‚ Execution Engineæ‰§è¡Œå­—èŠ‚ç ï¼Œæˆ–è€…æ‰§è¡Œæœ¬åœ°æ–¹æ³• Runtime DataAreaæŒ‡JVMåœ¨è¿è¡ŒæœŸé—´ï¼Œå…¶å¯¹JVMå†…å­˜ç©ºé—´çš„åˆ’åˆ†å’Œåˆ†é…ã€‚ ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶é€šè¿‡æ”¹å˜è¯¥è®¡æ•°å™¨çš„å€¼æ¥é€‰æ‹©ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€è·³è½¬ã€å¾ªç¯ç­‰åŸºç¡€åŠŸèƒ½éƒ½è¦ä¾èµ–å®ƒæ¥å®ç°ã€‚æ¯æ¡çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„çº¿ç¨‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œå› æ­¤è¯¥åŒºåŸŸæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚ å½“çº¿ç¨‹åœ¨æ‰§è¡Œä¸€ä¸ªJavaæ–¹æ³•æ—¶ï¼Œè¯¥è®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œå½“çº¿ç¨‹åœ¨æ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•ï¼ˆè°ƒç”¨æœ¬åœ°æ“ä½œç³»ç»Ÿæ–¹æ³•ï¼‰æ—¶ï¼Œè¯¥è®¡æ•°å™¨çš„å€¼ä¸ºç©ºã€‚å¦å¤–ï¼Œè¯¥å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OOMï¼ˆå†…å­˜æº¢å‡ºï¼šOutOfMemoryErrorï¼‰æƒ…å†µçš„åŒºåŸŸã€‚ Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰è¯¥åŒºåŸŸä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸çº¿ç¨‹ç›¸åŒã€‚è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œæ ˆå®ƒæ˜¯ç”¨äºæ”¯æŒç»­è™šæ‹Ÿæœºè¿›è¡Œæ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œçš„æ•°æ®ç»“æ„ã€‚å¯¹äºæ‰§è¡Œå¼•æ“æ¥è®²ï¼Œæ´»åŠ¨çº¿ç¨‹ä¸­ï¼Œåªæœ‰æ ˆé¡¶çš„æ ˆå¸§æ˜¯æœ‰æ•ˆçš„ï¼Œç§°ä¸ºå½“å‰æ ˆå¸§ï¼Œè¿™ä¸ªæ ˆå¸§æ‰€å…³è”çš„æ–¹æ³•ç§°ä¸ºå½“å‰æ–¹æ³•ï¼Œæ‰§è¡Œå¼•æ“æ‰€è¿è¡Œçš„æ‰€æœ‰å­—èŠ‚ç æŒ‡ä»¤éƒ½åªé’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œã€‚æ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•è¿”å›åœ°å€å’Œä¸€äº›é¢å¤–çš„é™„åŠ ä¿¡æ¯ã€‚åœ¨ç¼–è¯‘ç¨‹åºä»£ç æ—¶ï¼Œæ ˆå¸§ä¸­éœ€è¦å¤šå¤§çš„å±€éƒ¨å˜é‡è¡¨ã€å¤šæ·±çš„æ“ä½œæ•°æ ˆéƒ½å·²ç»å®Œå…¨ç¡®å®šäº†ï¼Œå¹¶ä¸”å†™å…¥äº†æ–¹æ³•è¡¨çš„Codeå±æ€§ä¹‹ä¸­ã€‚å› æ­¤ï¼Œä¸€ä¸ªæ ˆå¸§éœ€è¦åˆ†é…å¤šå°‘å†…å­˜ï¼Œä¸ä¼šå—åˆ°ç¨‹åºè¿è¡ŒæœŸå˜é‡æ•°æ®çš„å½±å“ï¼Œè€Œä»…ä»…å–å†³äºå…·ä½“çš„è™šæ‹Ÿæœºå®ç°ã€‚ åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­ï¼Œå¯¹è¿™ä¸ªåŒºåŸŸè§„å®šäº†ä¸¤ç§å¼‚å¸¸æƒ…å†µï¼š å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚ å¦‚æœè™šæ‹Ÿæœºåœ¨åŠ¨æ€æ‰©å±•æ ˆæ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ï¼Œåˆ™æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰è¯¥åŒºåŸŸä¸è™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡ŒJavaæ–¹æ³•æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºä½¿ç”¨åˆ°çš„æœ¬åœ°æ“ä½œç³»ç»Ÿï¼ˆNativeï¼‰æ–¹æ³•æœåŠ¡ã€‚ å’ŒJVMæ ˆä¸€æ ·ï¼Œä¹Ÿä¼šæŠ›å‡ºStackOverflowErrorå’ŒOutOfMemoryErrorå¼‚å¸¸ Javaå †ï¼ˆJava Heapï¼‰Java Heapæ˜¯Javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œå®ƒæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½åœ¨è¿™ç±»åˆ†é…å†…å­˜ã€‚Java Heapæ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™ä¹Ÿè¢«ç§°ä¸ºâ€œGCå †â€ã€‚ æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼ŒJavaå †å¯ä»¥å¤„åœ¨ç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ã€‚å¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜å¯åˆ†é…æ—¶ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•æ‰©å±•æ—¶ï¼Œå°†ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰æ–¹æ³•åŒºä¹Ÿæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚æ–¹æ³•åŒºåŸŸåˆè¢«ç§°ä¸ºâ€œæ°¸ä¹…ä»£â€ã€‚ ç”±äºä½¿ç”¨åå°„æœºåˆ¶çš„åŸå› ï¼Œè™šæ‹Ÿæœºå¾ˆéš¾æ¨æµ‹å“ªä¸ªç±»ä¿¡æ¯ä¸å†ä½¿ç”¨ï¼Œå› æ­¤è¿™å—åŒºåŸŸçš„å›æ”¶å¾ˆéš¾ã€‚å¦å¤–ï¼Œå¯¹è¿™å—åŒºåŸŸä¸»è¦æ˜¯é’ˆå¯¹å¸¸é‡æ± å›æ”¶ï¼Œä½†java7å·²ç»æŠŠå¸¸é‡æ± è½¬ç§»åˆ°å †é‡Œé¢äº†ã€‚ æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼Œå½“æ–¹æ³•åŒºæ— æ³•æ»¡è¶³å†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œå°†æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ åœ¨JDK1.7åŠä»¥å‰çš„HotSpot JVMä¸­ï¼Œæ–¹æ³•åŒºä½äºæ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼ŒPermGenï¼‰ä¸­ã€‚ç”±äºæ°¸ä¹…ä»£å†…å¯èƒ½ä¼šå‘ç”Ÿå†…å­˜æ³„éœ²æˆ–æº¢å‡ºç­‰é—®é¢˜è€Œå¯¼è‡´çš„java.lang.OutOfMemoryError: PermGen ï¼ŒJEPå°ç»„ä»JDK1.7å¼€å§‹å°±ç­¹åˆ’ç§»é™¤æ°¸ä¹…ä»£ï¼ˆJEP 122: Remove the Permanent Generationï¼‰ï¼Œå¹¶ä¸”åœ¨JDK 1.7ä¸­æŠŠå­—ç¬¦ä¸²å¸¸é‡ï¼Œç¬¦å·å¼•ç”¨ç­‰ç§»å‡ºäº†æ°¸ä¹…ä»£ã€‚åˆ°äº†Java 8ï¼Œæ°¸ä¹…ä»£è¢«å½»åº•åœ°ç§»å‡ºäº†JVMï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ è¿è¡Œæ—¶å¸¸é‡æ±  ï¼ˆruntime constant poolï¼‰)è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯classæ–‡ä»¶ä¸­æ¯ä¸€ä¸ªç±»æˆ–æ¥å£çš„å¸¸é‡æ± è¡¨çš„è¿è¡Œæ—¶è¡¨ç¤ºå½¢å¼ï¼Œæ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚å®ƒåŒ…æ‹¬äº†è‹¥å¹²ç§ä¸åŒçš„å¸¸é‡ã€‚å¸¸é‡æ± è¡¨å­˜æ”¾ç¼–è¯‘å™¨ç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åè¿›å…¥æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­å­˜æ”¾ã€‚è¿è¡Œæ—¶å¸¸é‡æ± å…·æœ‰åŠ¨æ€æ€§ï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯ä»¥å°†æ–°çš„é‡æ”¾åˆ°è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ï¼Œå…¸å‹çš„åº”ç”¨æ˜¯Stringç±»çš„internæ–¹æ³•: public native String intern() JDK 1.7å¼€å§‹ï¼Œå­—ç¬¦ä¸²å¸¸é‡å’Œç¬¦å·å¼•ç”¨ç­‰å°±è¢«ç§»å‡ºæ°¸ä¹…ä»£ï¼š ç¬¦å·å¼•ç”¨è¿ç§»è‡³ç³»ç»Ÿå †å†…å­˜(Native Heap) å­—ç¬¦ä¸²å­—é¢é‡è¿ç§»è‡³Javaå †(Java Heap) å‚è€ƒ ã€æ·±å…¥Javaè™šæ‹Ÿæœºã€‘ä¹‹ä¸€ï¼šJavaå†…å­˜åŒºåŸŸä¸å†…å­˜æº¢å‡º è¯»ä¹¦ç¬”è®°-æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1","categories":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/categories/JVM/"}],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/tags/JVM/"}]},{"title":"MyBatis","slug":"MyBatis","date":"2018-04-12T05:39:35.000Z","updated":"2018-04-20T13:18:58.913Z","comments":true,"path":"2018/04/12/MyBatis/","link":"","permalink":"https://hsb786.github.io/2018/04/12/MyBatis/","excerpt":"MyBatisç®€ä»‹ MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚ Mybatisä¸Hibernateéƒ½æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œè¿™ç±»æ¡†æ¶çš„ä½œç”¨å°±æ˜¯å°†æ•°æ®åº“ä¸­çš„è¡¨å’ŒPOJOæ˜ å°„èµ·æ¥ï¼Œå®ƒä»¬çš„æœ¬è´¨å°±æ˜¯Javaå¯¹æ•°æ®åº“çš„æ“ä½œçš„æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†è¿™ç§æ¡†æ¶ç§°ä¸ºå¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶(ORM,Object Relational Mapping)ã€‚å®ƒä»¬çš„åŒºåˆ«ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒHibernateåŸºæœ¬ä¸éœ€è¦ç¼–å†™SQLï¼Œå®ƒå¯ä»¥æ ¹æ®æ˜ å°„è§„åˆ™è‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼Œæ˜¯ä¸€ç§å…¨è¡¨æ˜ å°„ã€‚è€ŒMyBatisä¸å±è”½SQLï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šåˆ¶SQLï¼Œè¿™æ ·å°±æä¾›ç»™äº†æˆ‘ä»¬è¶³å¤Ÿçš„çµæ´»æ€§ä¸ä¼˜åŒ–çš„å¯èƒ½ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒMyBatisç›¸å¯¹äºHibernateæ¥è¯´å…·æœ‰æ€§èƒ½é«˜ï¼Œå“åº”å¿«ï¼Œå¼€å‘çµæ´»çš„ç‰¹ç‚¹ã€‚","text":"MyBatisç®€ä»‹ MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚ Mybatisä¸Hibernateéƒ½æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œè¿™ç±»æ¡†æ¶çš„ä½œç”¨å°±æ˜¯å°†æ•°æ®åº“ä¸­çš„è¡¨å’ŒPOJOæ˜ å°„èµ·æ¥ï¼Œå®ƒä»¬çš„æœ¬è´¨å°±æ˜¯Javaå¯¹æ•°æ®åº“çš„æ“ä½œçš„æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†è¿™ç§æ¡†æ¶ç§°ä¸ºå¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶(ORM,Object Relational Mapping)ã€‚å®ƒä»¬çš„åŒºåˆ«ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒHibernateåŸºæœ¬ä¸éœ€è¦ç¼–å†™SQLï¼Œå®ƒå¯ä»¥æ ¹æ®æ˜ å°„è§„åˆ™è‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼Œæ˜¯ä¸€ç§å…¨è¡¨æ˜ å°„ã€‚è€ŒMyBatisä¸å±è”½SQLï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šåˆ¶SQLï¼Œè¿™æ ·å°±æä¾›ç»™äº†æˆ‘ä»¬è¶³å¤Ÿçš„çµæ´»æ€§ä¸ä¼˜åŒ–çš„å¯èƒ½ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒMyBatisç›¸å¯¹äºHibernateæ¥è¯´å…·æœ‰æ€§èƒ½é«˜ï¼Œå“åº”å¿«ï¼Œå¼€å‘çµæ´»çš„ç‰¹ç‚¹ã€‚ MyBatisç»„ä»¶MyBatisçš„æ ¸å¿ƒç»„ä»¶åˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼š SqlSessionFactoryBuilder(æ„é€ å™¨)ï¼šå®ƒä¼šæ ¹æ®mybatisçš„é…ç½®æ–‡ä»¶(Configurationé…ç½®ç±»)æ¥ç”ŸæˆSqlSessionFactoryï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯åˆ†æ­¥æ„å»ºçš„Builderæ¨¡å¼ SqlSessionFactory(å·¥å‚)ï¼šç”¨äºç”ŸæˆSqlSessionï¼Œå¯ä»¥è¢«è®¤ä¸ºæ˜¯æ•°æ®åº“è¿æ¥æ±  SqlSession(ä¼šè¯)ï¼šæ—¢å¯ä»¥ç›´æ¥å‘é€SQLæ‰§è¡Œå¹¶è¿”å›ç»“æœï¼Œä¹Ÿå¯ä»¥è·å–æ˜ å°„å™¨Mapperæ¥å£(åŠ¨æ€ä»£ç†çš„ç±»)æ‰§è¡ŒSQLå¾—åˆ°è¿”å›ç»“æœï¼Œç›¸å½“äºæ•°æ®åº“è¿æ¥(Connectionå¯¹è±¡) Mapper(æ˜ å°„å™¨)ï¼šç”±ä¸€ä¸ªJavaæ¥å£å’ŒXMLæ–‡ä»¶æ„æˆï¼šæ¥å£ç”¨äºç»™å‡ºæ–¹æ³•çš„å…¥å‚ä»¥åŠè¿”å›å€¼ï¼ŒXMLç»™å‡ºSQLè¯­å¥å’Œæ˜ å°„è§„åˆ™ã€‚æ˜ å°„å™¨çš„ä¸»è¦ä½œç”¨å°±æ˜¯å°†SQLæŸ¥è¯¢åˆ°çš„ç»“æœæ˜ å°„ä¸ºä¸€ä¸ªPOJOï¼Œæˆ–è€…å°†POJOçš„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“ä¸­ æ³¨æ„ï¼Œæ— è®ºæ˜¯æ˜ å°„å™¨è¿˜æ˜¯SqlSessionéƒ½å¯ä»¥å‘é€SQLåˆ°æ•°æ®åº“æ‰§è¡Œï¼Œä½†æ˜¯ä¸ºäº†ä¿è¯ä»£ç çš„å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ï¼Œæ¨èä½¿ç”¨Mapperæ¥å£ç¼–ç¨‹æ¥å®Œæˆè¯¥æ“ä½œã€‚ SqlSession : ä»£è¡¨å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯ï¼Œå‘ç”¨æˆ·æä¾›äº†æ“ä½œæ•°æ®åº“çš„æ–¹æ³•ã€‚ MappedStatement: ä»£è¡¨è¦å‘å¾€æ•°æ®åº“æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯Sqlçš„æŠ½è±¡è¡¨ç¤ºã€‚ Executor: å…·ä½“ç”¨æ¥å’Œæ•°æ®åº“äº¤äº’çš„æ‰§è¡Œå™¨ï¼Œæ¥å—MappedStatementä½œä¸ºå‚æ•°ã€‚ æ˜ å°„æ¥å£: åœ¨æ¥å£ä¸­ä¼šè¦æ‰§è¡Œçš„Sqlç”¨ä¸€ä¸ªæ–¹æ³•æ¥è¡¨ç¤ºï¼Œå…·ä½“çš„Sqlå†™åœ¨æ˜ å°„æ–‡ä»¶ä¸­ã€‚ æ˜ å°„æ–‡ä»¶: å¯ä»¥ç†è§£ä¸ºæ˜¯Mybatisç¼–å†™Sqlçš„åœ°æ–¹ï¼Œé€šå¸¸æ¥è¯´æ¯ä¸€å¼ å•è¡¨éƒ½ä¼šå¯¹åº”ç€ä¸€ä¸ªæ˜ å°„æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ä¼šå®šä¹‰Sqlè¯­å¥å…¥å‚å’Œå‡ºå‚çš„å½¢å¼ã€‚ ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸSqlSessionFactoryBuilderè¿™ä¸ªç±»å¯ä»¥è¢«å®ä¾‹åŒ–ã€ä½¿ç”¨å’Œä¸¢å¼ƒï¼Œä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚å› æ­¤ SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯å±€éƒ¨æ–¹æ³•å˜é‡ï¼‰ã€‚ä½ å¯ä»¥é‡ç”¨ SqlSessionFactoryBuilder æ¥åˆ›å»ºå¤šä¸ª SqlSessionFactory å®ä¾‹ï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯ä¸è¦è®©å…¶ä¸€ç›´å­˜åœ¨ä»¥ä¿è¯æ‰€æœ‰çš„ XML è§£æèµ„æºå¼€æ”¾ç»™æ›´é‡è¦çš„äº‹æƒ…ã€‚ SqlSessionFactorySqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±å¯¹å®ƒè¿›è¡Œæ¸…é™¤æˆ–é‡å»ºã€‚ä½¿ç”¨ SqlSessionFactory çš„æœ€ä½³å®è·µæ˜¯åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸è¦é‡å¤åˆ›å»ºå¤šæ¬¡ï¼Œå¤šæ¬¡é‡å»º SqlSessionFactory è¢«è§†ä¸ºä¸€ç§ä»£ç â€œåå‘³é“ï¼ˆbad smellï¼‰â€ã€‚å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚ SqlSessionæ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚ç»å¯¹ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä¸€ä¸ªç±»çš„é™æ€åŸŸï¼Œç”šè‡³ä¸€ä¸ªç±»çš„å®ä¾‹å˜é‡ä¹Ÿä¸è¡Œã€‚ä¹Ÿç»ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä»»ä½•ç±»å‹çš„ç®¡ç†ä½œç”¨åŸŸä¸­ï¼Œæ¯”å¦‚ Servlet æ¶æ„ä¸­çš„ HttpSessionã€‚å¦‚æœä½ ç°åœ¨æ­£åœ¨ä½¿ç”¨ä¸€ç§ Web æ¡†æ¶ï¼Œè¦è€ƒè™‘ SqlSession æ”¾åœ¨ä¸€ä¸ªå’Œ HTTP è¯·æ±‚å¯¹è±¡ç›¸ä¼¼çš„ä½œç”¨åŸŸä¸­ã€‚æ¢å¥è¯è¯´ï¼Œæ¯æ¬¡æ”¶åˆ°çš„ HTTP è¯·æ±‚ï¼Œå°±å¯ä»¥æ‰“å¼€ä¸€ä¸ª SqlSessionï¼Œè¿”å›ä¸€ä¸ªå“åº”ï¼Œå°±å…³é—­å®ƒã€‚è¿™ä¸ªå…³é—­æ“ä½œæ˜¯å¾ˆé‡è¦çš„ï¼Œä½ åº”è¯¥æŠŠè¿™ä¸ªå…³é—­æ“ä½œæ”¾åˆ° finally å—ä¸­ä»¥ç¡®ä¿æ¯æ¬¡éƒ½èƒ½æ‰§è¡Œå…³é—­ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°±æ˜¯ä¸€ä¸ªç¡®ä¿ SqlSession å…³é—­çš„æ ‡å‡†æ¨¡å¼ï¼š 123456SqlSession session = sqlSessionFactory.openSession();try &#123; // do work&#125; finally &#123; session.close();&#125; æ˜ å°„å™¨å®ä¾‹ï¼ˆMapper Instancesï¼‰æ˜ å°„å™¨æ˜¯ä¸€ä¸ªä½ åˆ›å»ºæ¥ç»‘å®šä½ æ˜ å°„çš„è¯­å¥çš„æ¥å£ã€‚æ˜ å°„å™¨æ¥å£çš„å®ä¾‹æ˜¯ä» SqlSession ä¸­è·å¾—çš„ã€‚å› æ­¤ä»æŠ€æœ¯å±‚é¢è®²ï¼Œä»»ä½•æ˜ å°„å™¨å®ä¾‹çš„æœ€å¤§ä½œç”¨åŸŸæ˜¯å’Œè¯·æ±‚å®ƒä»¬çš„ SqlSession ç›¸åŒçš„ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæ˜ å°„å™¨å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜ å°„å™¨å®ä¾‹åº”è¯¥åœ¨è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•ä¸­è¢«è¯·æ±‚ï¼Œç”¨è¿‡ä¹‹åå³å¯åºŸå¼ƒã€‚å¹¶ä¸éœ€è¦æ˜¾å¼åœ°å…³é—­æ˜ å°„å™¨å®ä¾‹ï¼Œå°½ç®¡åœ¨æ•´ä¸ªè¯·æ±‚ä½œç”¨åŸŸï¼ˆrequest scopeï¼‰ä¿æŒæ˜ å°„å™¨å®ä¾‹ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¾ˆå¿«ä½ ä¼šå‘ç°ï¼Œåƒ SqlSession ä¸€æ ·ï¼Œåœ¨è¿™ä¸ªä½œç”¨åŸŸä¸Šç®¡ç†å¤ªå¤šçš„èµ„æºçš„è¯ä¼šéš¾äºæ§åˆ¶ã€‚æ‰€ä»¥è¦ä¿æŒç®€å•ï¼Œæœ€å¥½æŠŠæ˜ å°„å™¨æ”¾åœ¨æ–¹æ³•ä½œç”¨åŸŸï¼ˆmethod scopeï¼‰å†…ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°±å±•ç¤ºäº†è¿™ä¸ªå®è·µï¼š1234567SqlSession session = sqlSessionFactory.openSession();try &#123; BlogMapper mapper = session.getMapper(BlogMapper.class); // do work&#125; finally &#123; session.close();&#125; å¦‚ä½•ä½¿ç”¨MyBatisé¦–å…ˆï¼Œåœ¨MyBatisä¸­æœ‰ä¸¤ç§XMLé…ç½®æ–‡ä»¶ï¼Œä¸€ç§æ˜¯åŸºç¡€é…ç½®æ–‡ä»¶ï¼Œå®ƒåªæœ‰ä¸€ä¸ªï¼Œç”¨äºé…ç½®ä¸€äº›MyBatisçš„ä¸Šä¸‹æ–‡å‚æ•°å’Œè¿è¡Œç¯å¢ƒï¼›å¦ä¸€ç§æ˜¯æ˜ å°„å™¨çš„XMLæ˜ å°„æ–‡ä»¶ï¼Œå®ƒå¯ä»¥é…ç½®æ˜ å°„å…³ç³»ï¼ŒSQLç­‰ç­‰ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨ä½¿ç”¨MyBatisçš„æ—¶å€™ï¼Œå…ˆç»™å‡ºMyBatisçš„é…ç½®æ–‡ä»¶ç”¨äºç”ŸæˆSqlSessionï¼Œç„¶åå†ç»™å‡ºæ˜ å°„å™¨Mapperçš„æ¥å£ä¸ç›¸åº”çš„æ˜ å°„XMLæ–‡ä»¶ï¼Œæœ€åå°±å¯ä»¥ç”ŸæˆMapperæ¥å£çš„åŠ¨æ€ä»£ç†ç±»æ¥å‘é€SQLè·å–ç»“æœäº†ã€‚ æ˜ å°„å™¨æ˜ å°„å™¨æ˜¯mybatisæœ€æ ¸å¿ƒçš„ç»„ä»¶ï¼Œå®ƒç”±ä¸€ä¸ªæ¥å£åŠ ä¸Šxmlæ–‡ä»¶ç»„æˆã€‚åœ¨æ˜ å°„å™¨ä¸­å¯ä»¥é…ç½®å‚æ•°ï¼Œå„ç±»çš„SQLè¯­å¥ï¼Œç¼“å­˜ï¼Œçº§è”ç­‰å†…å®¹ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡æ˜ å°„è§„åˆ™æ˜ å°„åˆ°æŒ‡å®šçš„POJOä¸Šã€‚æ˜ å°„å™¨çš„æ¥å£ä¸æ˜ å°„xmlæ–‡ä»¶é…ç½®ä½¿ç”¨ï¼Œå¯ä»¥æœ‰æ•ˆçš„æ¶ˆé™¤jdbcåº•å±‚ä»£ç ã€‚ æ˜ å°„å™¨çš„æ˜ å°„xmlæ–‡ä»¶æœ‰ä»¥ä¸‹å‡ ä¸ªå…ƒç´ ï¼š cache â€“ ç»™å®šå‘½åç©ºé—´çš„ç¼“å­˜é…ç½® cache-ref â€“ å…¶ä»–å‘½åç©ºé—´ç¼“å­˜é…ç½®çš„å¼•ç”¨ resultMap â€“ æè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­æ¥åŠ è½½å¯¹è±¡ï¼Œå®ƒå°†æä¾›æ˜ å°„è§„åˆ™ sql â€“ å¯è¢«å…¶ä»–è¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯­å¥å—ï¼Œå¯ä»¥å®šä¹‰ä¸€éƒ¨åˆ†SQLï¼Œç„¶ååœ¨å…¶ä»–åœ°æ–¹å¼•ç”¨ insert â€“ æ˜ å°„æ’å…¥è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ’å…¥çš„æ¡æ•° update â€“ æ˜ å°„æ›´æ–°è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ›´æ–°çš„æ¡æ•° delete â€“ æ˜ å°„åˆ é™¤è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨åˆ é™¤çš„æ¡æ•° select â€“ æ˜ å°„æŸ¥è¯¢è¯­å¥ï¼Œè¿”å›æŸ¥è¯¢ç»“æœ selectå…ƒç´ æ˜ å°„å™¨ä¸­çš„selectå…ƒç´ ä»£è¡¨SQLçš„selectè¯­å¥ï¼Œç”¨äºæŸ¥è¯¢ã€‚selectå…ƒç´ ä¸­æœ‰ä»¥ä¸‹å¸¸ç”¨çš„å±æ€§ï¼š id:åœ¨Mapperçš„å‘½åç©ºé—´ä¸­å”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚Mapperçš„å‘½åç©ºé—´ä¸selectå…ƒç´ çš„idå°†å”¯ä¸€å®šä½å¯¹åº”çš„æ˜ å°„å™¨æ¥å£çš„æŸä¸ªæ–¹æ³•ã€‚ parameterTypeï¼šå°†ä¼šä¼ å…¥è¿™æ¡è¯­å¥çš„å‚æ•°ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åï¼Œå¯ä»¥é€‰æ‹©Java Beanï¼ŒMapç­‰å‚æ•°ç±»å‹ä¼ é€’ç»™SQLã€‚è¿™ä¸ªå±æ€§æ˜¯å¯é€‰çš„ï¼Œmybatiså¯ä»¥é€šè¿‡TypeHandleræ¨æ–­å‡ºå…·ä½“ä¼ å…¥è¯­å¥çš„å‚æ•°ã€‚ resultTypeï¼šä»è¿™æ¡è¯­å¥ä¸­è¿”å›çš„æœŸæœ›ç±»å‹çš„ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åã€‚æ³¨æ„å¦‚æœæ˜¯é›†åˆæƒ…å½¢ï¼Œé‚£åº”è¯¥æ˜¯é›†åˆå¯ä»¥åŒ…å«çš„ç±»å‹ï¼Œè€Œä¸èƒ½æ˜¯é›†åˆæœ¬èº«ã€‚ resultMapï¼šæ˜ å°„é›†çš„å¼•ç”¨ï¼Œç”¨äºç»“æœé›†çš„æ˜ å°„ï¼Œå®Œæˆç»“æœçš„æ˜ å°„åŠŸèƒ½ã€‚æ³¨æ„resultTypeå’ŒresultMapä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ flushCacheï¼šå°†å…¶è®¾ç½®ä¸ºtrueï¼Œä»»ä½•æ—¶å€™åªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºï¼Œé»˜è®¤å€¼ï¼šfalseã€‚ useCacheï¼šå°†å…¶è®¾ç½®ä¸ºtrueï¼Œå°†ä¼šå¯¼è‡´æœ¬æ¡è¯­å¥çš„ç»“æœè¢«äºŒçº§ç¼“å­˜ï¼Œé»˜è®¤å€¼ï¼šå¯¹selectå…ƒç´ ä¸ºtrueã€‚ 123&lt;select id=&quot;getPerson&quot; parameterType=&quot;int&quot; resultType=&quot;mybatis.spring.test.pojo.Person&quot;&gt; SELECT name,age,tel,id from t_person WHERE id = #&#123;id&#125;&lt;/select&gt; 1public Person getPerson(@Param(&quot;id&quot;) int id); mybatisæä¾›çš„è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼Œåªè¦SQLçš„åˆ—åä¸POJOçš„å±æ€§åä¿æŒä¸€è‡´ï¼ŒåŒæ—¶åœ¨mybatisçš„é…ç½®æ–‡ä»¶ä¸­settingså…ƒç´ çš„autoMappingBehavioræ˜¯å¼€å¯çš„(é»˜è®¤æ˜¯å¼€å¯)å³å¯å®Œæˆè‡ªåŠ¨æ˜ å°„ã€‚å¦‚æœåˆ—åä¸å±æ€§åä¸ä¸€è‡´çš„è¯ï¼Œè¿˜å¯ä»¥é€šè¿‡SQLçš„åˆ«åæœºåˆ¶æ¥å¤„ç†ã€‚æ¯”å¦‚è¯´ï¼Œå‡å¦‚åŸæ¥åˆ—åä¸ºperson_nameï¼Œå±æ€§åä¸ºpersonNameï¼Œé‚£ä¹ˆåœ¨SQLä¸­å°±å¯ä»¥è¿™ä¹ˆå†™ï¼šselect person_name as personName â€¦ è¿™æ ·åŒæ ·å¯ä»¥å®Œæˆè‡ªåŠ¨æ˜ å°„ã€‚ è¿™é‡Œç‰¹åˆ«è¯´æ˜å…³äºselectå…ƒç´ è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–è€…å¯¹è±¡é›†åˆçš„é—®é¢˜ï¼š è¿”å›æ•°æ®ç±»å‹ç”±DAOä¸­çš„æ¥å£å’Œæ˜ å°„xmlæ–‡ä»¶å…±åŒå†³å®šã€‚å¦å¤–ï¼Œä¸è®ºæ˜¯è¿”å›å•ä¸€å¯¹è±¡è¿˜æ˜¯å¯¹è±¡åˆ—è¡¨ï¼Œæ˜ å°„xmlä¸­çš„é…ç½®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯resultType=â€œ . .â€ç±»å‹æˆ–resultMap=â€resultMap-refâ€*ã€‚ æ¯ä¸€æ¬¡mybatisä»æ•°æ®åº“ä¸­selectæ•°æ®ä¹‹åï¼Œéƒ½ä¼šæ£€æŸ¥æ•°æ®æ¡æ•°å’ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯å¦åŒ¹é…ã€‚ è‹¥è¿”å›ä¸€æ¡æ•°æ®ï¼ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å¯¹è±¡çš„Liståˆ—è¡¨ï¼Œåˆ™å¯ä»¥æ­£å¸¸åŒ¹é…ï¼Œå°†æŸ¥è¯¢çš„æ•°æ®æŒ‰ç…§DAOä¸­å®šä¹‰çš„è¿”å›å€¼å­˜æ”¾ã€‚ è‹¥è¿”å›å¤šæ¡æ•°æ®ï¼ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™æ— æ³•å°†å¤šæ¡æ•°æ®æ˜ å°„ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶mybatisæŠ¥é”™ã€‚ resultMapå…ƒç´ é€šè¿‡resultTypeåŠ ä¸Šmybatisçš„è‡ªåŠ¨æ˜ å°„å¯ä»¥åº”å¯¹å¤§å¤šæ•°çš„ç»“æœé›†çš„æ˜ å°„éœ€æ±‚ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æ— æ³•å®šä¹‰æ›´å¤šçš„å±æ€§ï¼Œæ¯”å¦‚typeHandlerï¼Œçº§è”ç­‰ã€‚ä¸ºäº†æ”¯æŒæ›´åŠ å¤æ‚çš„æ˜ å°„ï¼Œmybatisæä¾›äº†resultMapå±æ€§æ¥å®ŒæˆSQLåˆ°Java Beançš„æ˜ å°„å…³ç³»å®šä¹‰ã€‚æ¥ä¸‹æ¥ï¼Œç”¨resulyMapæ”¹å†™ä¹‹å‰ä½¿ç”¨è‡ªåŠ¨æ˜ å°„çš„selectå…ƒç´ ã€‚ 123456789&lt;resultMap id = &quot;Map&quot; type = &quot;mybatis.spring.test.pojo.Person&quot;&gt; &lt;id property=&quot;id&quot; column=&quot;id&quot;&gt; &lt;result property=&quot;name&quot; column=&quot;name&quot;&gt; &lt;result property=&quot;age&quot; column=&quot;age&quot;&gt; &lt;result property=&quot;tel&quot; column=&quot;tel&quot;&gt;&lt;/resultMap&gt; &lt;select id=&quot;getPerson&quot; parameterType=&quot;int&quot; resultMap=&quot;Map&quot;&gt; SELECT name,age,tel,id from t_person WHERE id = #&#123;id&#125; &lt;/select&gt; å­å…ƒç´ idä»£è¡¨ä¸»é”®ï¼Œresultä»£è¡¨å±æ€§ï¼Œidå’Œresultå…ƒç´ çš„propertyå±æ€§ä»£è¡¨POJOçš„å±æ€§åç§°ï¼Œcolumnä»£è¡¨SQLçš„åˆ—åï¼Œè¿™æ ·å°±å°†POJOçš„å±æ€§å’ŒSQLçš„åˆ—åè¿›è¡Œä¸€ä¸€å¯¹åº”äº†ã€‚ ä¸€ä¸ªå®Œæ•´çš„resultMapå…ƒç´ çš„æ„æˆæœ‰å“ªäº›ï¼Ÿ constructorï¼šç±»åœ¨å®ä¾‹åŒ–æ—¶,ç”¨æ¥æ³¨å…¥ç»“æœåˆ°æ„é€ æ–¹æ³•ä¸­ idï¼šè¡¨ç¤ºå“ªä¸ªåˆ—æ˜¯ä¸»é”® resultï¼šæ³¨å…¥åˆ°JavaBeanå±æ€§çš„æ™®é€šç»“æœï¼Œé…ç½®POJOåˆ°SQLåˆ—åçš„æ˜ å°„å…³ç³» associationï¼šä¸€ä¸ªå¤æ‚çš„ç±»å‹å…³è”;è®¸å¤šç»“æœå°†åŒ…æˆè¿™ç§ç±»å‹ collectionï¼šå¤æ‚ç±»å‹çš„é›† discriminatorï¼šä½¿ç”¨ç»“æœå€¼æ¥å†³å®šä½¿ç”¨å“ªä¸ªç»“æœæ˜ å°„ constructorå…ƒç´ ç”¨äºé…ç½®æ„é€ æ–¹æ³•ï¼Œä¸€ä¸ªPOJOå¯èƒ½ä¸å­˜åœ¨æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œå°±è¦ä½¿ç”¨construtorå…ƒç´ æ¥é…ç½®äº†ã€‚ idå…ƒç´ ï¼Œresultå…ƒç´ ä¸»è¦æ¥å®šä¹‰POJOä¸SQLåˆ—åçš„æ˜ å°„è§„åˆ™ï¼Œå®ƒä»¬æœ‰å¦‚ä¸‹å±æ€§ï¼š property:æ˜ å°„è§„åˆ™ä¸­çš„POJOçš„å±æ€§åï¼Œå¯ä»¥ç”¨å¯¼èˆªå¼å­—æ®µï¼Œä¾‹å¦‚éœ€è¦è®¿é—®Personç±»çš„Addresså±æ€§çš„idï¼Œå°±å¯ä»¥å†™æˆAddress . id columnï¼šå¯¹åº”çš„SQLçš„åˆ—å javaTypeï¼šJavaç±»å‹ jdbcTypeï¼šæ•°æ®åº“ç±»å‹ typeHandlerï¼šç±»å‹å¤„ç†å™¨ï¼Œå…è®¸ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨ å…¶ä¸­associationï¼Œcollectionå’Œdiscriminatorè¿™äº›å…ƒç´ æ˜¯ä¸ç»“æœæ˜ å°„çš„çº§è”ç›¸å…³çš„ã€‚Mybatisæ”¯æŒçº§è”æ˜ å°„ï¼Œç®€å•æ¥è¯´ï¼Œå‡å¦‚æˆ‘ä»¬selectä¸€ä¸ªpersonç±»ï¼Œpersonç±»æœ‰ä¸€ä¸ªå±æ€§ä¸ºaddressï¼Œaddressä¹Ÿæ˜¯ä¸€ä¸ªPOJOï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦å†è¿›è¡Œä¸€æ¬¡selectæ‰èƒ½æŸ¥è¯¢åˆ°addressç±»çš„ä¿¡æ¯ã€‚è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œçº§è”ä¸æ˜¯å¿…é¡»çš„ï¼Œçº§è”å¯ä»¥ä¾¿æ·çš„è·å–å…³è”æ•°æ®ï¼Œä½†æ˜¯å¦‚æœçº§è”å¤ªå¤šçš„è¯ä¼šå½±å“æ‰§è¡Œæ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯è‘—åçš„N+1é—®é¢˜(å¦‚æœæœ‰Nä¸ªå…³è”å…³ç³»å®Œæˆäº†çº§è”ï¼Œé‚£ä¹ˆåªè¦å†åŠ å…¥ä¸€ä¸ªå…³è”å…³ç³»ï¼Œå°±å˜æˆäº†N+1ä¸ªï¼Œæ‰€æœ‰çš„çº§è”SQLéƒ½ä¼šè¢«æ‰§è¡Œï¼Œæ˜¾ç„¶ä¸æ˜¯æ‰€æœ‰æ•°æ®æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„ï¼Œé€ æˆäº†èµ„æºçš„æµªè´¹ä¸æ€§èƒ½çš„æµªè´¹)ã€‚ä¸ºäº†åº”å¯¹çº§è”ä¸­çš„N+1é—®é¢˜ï¼Œmybatisæ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œåœ¨selectçš„æ—¶å€™å¹¶ä¸æ˜¯ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰çš„SQLç»“æœæ¥æ˜ å°„ï¼Œå¯¹äºé‚£äº›ä¸å¸¸ç”¨çš„çº§è”æ•°æ®ç­‰åˆ°éœ€è¦çš„æ—¶å€™å†å–å‡ºã€‚åœ¨mybatisçš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¯ä»¥è®¾å®šå»¶è¿ŸåŠ è½½å±æ€§ï¼ŒåŒæ—¶åœ¨çº§è”å…ƒç´ associationå’Œcollectionä¸­çš„fetchTypeå±æ€§ä¹Ÿå¯ä»¥å®šä¹‰å»¶è¿ŸåŠ è½½ã€‚ insert,update,deleteç›¸æ¯”äºselectæ¥è¯´ï¼Œinsert,update,deleteå°±å¾ˆç®€å•äº†ï¼Œå®ƒä»¬æ‰§è¡Œçš„ç»“æœè¿”å›çš„æ˜¯æ•´æ•°ï¼Œç”¨ä»¥æ ‡è¯†è¯¥SQLè¯­å¥å½±å“äº†æ•°æ®åº“çš„è®°å½•è¡Œæ•°ï¼Œä¸éœ€è¦è¿›è¡Œç»“æœé›†çš„æ˜ å°„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œinsertå…ƒç´ æ˜¯æ”¯æŒä¸»é”®å›å¡«çš„ï¼Œåœ¨inserè¯­å¥ä¸­æœ‰ä¸€ä¸ªå±æ€§useGeneratedKeysï¼Œç”¨æ¥æ§åˆ¶æ˜¯å¦ä½¿ç”¨æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®æ¥å›å¡«åˆ°POJOï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚å½“æ‰“å¼€äº†ä¸»é”®å›å¡«ä¹‹åï¼Œè¿˜è¦é…ç½®keyPropertyæˆ–è€…keyColumnï¼Œå‘Šè¯‰mybatisæŠŠç”Ÿæˆçš„ä¸»é”®æ”¾å…¥å“ªä¸ªå±æ€§ä¸­ã€‚è‡³äºåœ¨å®é™…ä¸­ç”¨ä¸ç”¨å¾—åˆ°æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®ï¼Œæˆ‘ä¹Ÿä¸èƒ½å®Œå…¨è‚¯å®šï¼Œè¿™é‡Œåªè¦çŸ¥é“mybatisæ˜¯æ”¯æŒä¸»é”®å›å¡«çš„å³å¯ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆå®¹æ˜“ã€‚ sqlå…ƒç´ è¿™ä¸ªå…ƒç´ å¯ä»¥è¢«ç”¨æ¥å®šä¹‰å¯é‡ç”¨çš„SQLä»£ç æ®µï¼Œå¯ä»¥åŒ…å«åœ¨å…¶ä»–è¯­å¥ä¸­ 12345678&lt;sql id=&quot;userColumns&quot;&gt; $&#123;alias&#125;.id,$&#123;alias&#125;.username,$&#123;alias&#125;.password &lt;/sql&gt;&lt;select id=&quot;selectUsers&quot; resultType=&quot;map&quot;&gt; select &lt;include refid=&quot;userColumns&quot;&gt;&lt;property name=&quot;alias&quot; value=&quot;t1&quot;/&gt;&lt;/include&gt;, &lt;include refid=&quot;userColumns&quot;&gt;&lt;property name=&quot;alias&quot; value=&quot;t2&quot;/&gt;&lt;/include&gt; from some_table t1 cross join some_table t2&lt;/select&gt; åŠ¨æ€SQLmybatisæä¾›äº†å¯¹SQLè¯­å¥åŠ¨æ€çš„ç»„è£…èƒ½åŠ›ï¼Œå¤§é‡çš„åˆ¤æ–­éƒ½å¯ä»¥åœ¨mybatisçš„æ˜ å°„xmlé‡Œé¢é…ç½®ï¼Œå¤§å¤§å‡å°‘äº†ä»£ç é‡ï¼Œæä¾›äº†çµæ´»æ€§ã€‚ ififå…ƒç´ ä½¿ç”¨çš„åœºæ™¯é€‚ç”¨äºåœ¨SQLè¯­å¥çš„whereå­å¥ä¸­åŠ¨æ€åœ°é€‰æ‹©æŸå‡ ä¸ªåˆ¤æ–­æ¡ä»¶ä½œä¸ºSQLè¯­å¥çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‹¼æ¥ã€‚ 12345678&lt;select id=&quot;findActiveBlogWithTitleLike&quot; resultType=&quot;Blog&quot;&gt; SELECT * FROM BLOG WHERE state = â€˜ACTIVEâ€™ &lt;if test=&quot;title != null&quot;&gt; AND title like #&#123;title&#125; &lt;/if&gt;&lt;/select&gt; å¦‚æœä¼ å…¥çš„å‚æ•°titleä¸æ˜¯nullï¼Œé‚£ä¹ˆå°±å°† AND title like #{title} è¿™å­å¥æ‹¼æ¥åœ¨whereä¹‹åï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ¡ä»¶åœ°åŒ…å«whereå­å¥çš„ä¸€éƒ¨åˆ†ã€‚ choose(when,otherwise)ifå…ƒç´ æ˜¯å•æ¡ä»¶çš„ï¼Œchooseå…ƒç´ å°±æ˜¯å¤šæ¡ä»¶çš„é€‰æ‹©ç±»ä¼¼javaé‡Œçš„switchè¯­å¥ï¼ŒåŸç†ä¸€æ ·ï¼Œè¿˜æ˜¯æ¥ç€ä¸Šé¢çš„ä¾‹å­æ¥ä¸¾ä¾‹ï¼š 123456789101112131415&lt;select id=&quot;findActiveBlogLike&quot; resultType=&quot;Blog&quot;&gt; SELECT * FROM BLOG WHERE state = â€˜ACTIVEâ€™ &lt;choose&gt; &lt;when test=&quot;title != null&quot;&gt; AND title like #&#123;title&#125; &lt;/when&gt; &lt;when test=&quot;author != null and author.name != null&quot;&gt; AND author_name like #&#123;author.name&#125; &lt;/when&gt; &lt;otherwise&gt; AND featured = 1 &lt;/otherwise&gt; &lt;/choose&gt;&lt;/select&gt; ä¸Šè¿°å‚è€ƒæ–‡æ¡£ä¸­çš„ä¾‹å­otherwiseå…ƒç´ å†™çš„æ˜¯ AND featured = 1 æ˜¯ä¸ºäº†è§£å†³å‰é¢çš„æ‰€æœ‰caseéƒ½ä¸æ»¡è¶³çš„æƒ…å†µï¼Œæˆ‘å»ºè®®å†™æˆ AND 1 = 1 æ›´å¥½ç†è§£ã€‚è¯¥åŠ¨æ€SQLè¯­å¥çš„åŠŸèƒ½ï¼šå¦‚æœå‚æ•°æä¾›äº†â€œtitleâ€å°±æŒ‰â€œtitleâ€æŸ¥æ‰¾ï¼Œæä¾›äº†â€œauthorâ€å°±æŒ‰â€œauthorâ€æŸ¥æ‰¾ï¼Œè‹¥ä¸¤è€…éƒ½æ²¡æœ‰æä¾›ï¼Œå°±è¿”å›æ‰€æœ‰ç¬¦åˆé»˜è®¤æ¡ä»¶çš„æŸ¥è¯¢ç»“æœé›†ã€‚ trim(where,set)å‰é¢çš„ä¾‹å­ä¸­çš„whereå­å¥æ€»ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æŸ¥è¯¢æ¡ä»¶ä¹Ÿå°±æ˜¯ä¾‹å­ä¸­çš„ state = â€˜ACTIVEâ€™ ï¼Œå¦‚æœstateä¹Ÿè®¾ç½®æˆåŠ¨æ€çš„å‘¢ï¼Ÿå¯ä»¥é€šè¿‡where,setå…ƒç´ æ¥è¾¾åˆ°è¿™ä¸ªéœ€æ±‚ã€‚ 123456789101112131415&lt;select id=&quot;findActiveBlogLike&quot; resultType=&quot;Blog&quot;&gt; SELECT * FROM BLOG &lt;where&gt; &lt;if test=&quot;state != null&quot;&gt; state = #&#123;state&#125; &lt;/if&gt; &lt;if test=&quot;title != null&quot;&gt; AND title like #&#123;title&#125; &lt;/if&gt; &lt;if test=&quot;author != null and author.name != null&quot;&gt; AND author_name like #&#123;author.name&#125; &lt;/if&gt; &lt;/where&gt;&lt;/select&gt; åŒæ ·å¦‚æœæ˜¯updateå­å¥ï¼Œé‚£ä¹ˆä¹Ÿå°±ç›¸åº”çš„setå…ƒç´ ï¼Œå¦‚ä¸‹ï¼š 12345678910&lt;update id=&quot;updateAuthorIfNecessary&quot;&gt; update Author &lt;set&gt; &lt;if test=&quot;username != null&quot;&gt;username=#&#123;username&#125;,&lt;/if&gt; &lt;if test=&quot;password != null&quot;&gt;password=#&#123;password&#125;,&lt;/if&gt; &lt;if test=&quot;email != null&quot;&gt;email=#&#123;email&#125;,&lt;/if&gt; &lt;if test=&quot;bio != null&quot;&gt;bio=#&#123;bio&#125;&lt;/if&gt; &lt;/set&gt; where id=#&#123;id&#125;&lt;/update&gt; å¦‚æœwhere,setéƒ½æ— æ³•æ»¡è¶³åŠ¨æ€æ‹¼æ¥SQLçš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨trimæ¥è‡ªå®šä¹‰å¦‚ä½•æ‹¼æ¥SQLå­å¥ï¼Œwhereå’Œsetåªæ˜¯mybatiså®šä¹‰å¥½çš„æ‹¼æ¥SQLçš„æ–¹æ³•è€Œå·²ï¼Œä½†è¿™ä¹Ÿå·²ç»å¯ä»¥æ»¡è¶³å¤§å¤šæ•°éœ€æ±‚äº†ã€‚ foreachåŠ¨æ€ SQL çš„å¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„å¿…è¦æ“ä½œæ˜¯éœ€è¦å¯¹ä¸€ä¸ªé›†åˆè¿›è¡Œéå†ï¼Œé€šå¸¸æ˜¯åœ¨æ„å»º IN æ¡ä»¶è¯­å¥çš„æ—¶å€™ã€‚è¿˜æ˜¯å‚è€ƒæ–‡æ¡£é‡Œä¹°çš„ä¾‹å­ï¼š 123456789&lt;select id=&quot;selectPostIn&quot; resultType=&quot;domain.blog.Post&quot;&gt; SELECT * FROM POST P WHERE ID in &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;list&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt; #&#123;item&#125; &lt;/foreach&gt;&lt;/select&gt; foreachå…ƒç´ å…è®¸æŒ‡å®šä¸€ä¸ªé›†åˆï¼Œå£°æ˜å¯ä»¥ç”¨åœ¨å…ƒç´ ä½“å†…çš„é›†åˆé¡¹å’Œç´¢å¼•å˜é‡ï¼Œä¹Ÿå…è®¸ä½ æŒ‡å®šå¼€é—­åŒ¹é…çš„å­—ç¬¦ä¸²ä»¥åŠåœ¨è¿­ä»£ä¸­é—´æ”¾ç½®åˆ†éš”ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€é›†åˆç­‰ï¼‰å’Œä»»ä½•çš„å­—å…¸æˆ–è€…æ•°ç»„å¯¹è±¡ä¼ é€’ç»™foreachä½œä¸ºé›†åˆå‚æ•°ã€‚å½“ä½¿ç”¨å¯è¿­ä»£å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œindexæ˜¯å½“å‰è¿­ä»£çš„æ¬¡æ•°ï¼Œitemçš„å€¼æ˜¯æœ¬æ¬¡è¿­ä»£è·å–çš„å…ƒç´ ã€‚å½“ä½¿ç”¨å­—å…¸ï¼ˆæˆ–è€…Map.Entryå¯¹è±¡çš„é›†åˆï¼‰æ—¶ï¼Œindexæ˜¯é”®ï¼Œitemæ˜¯å€¼ã€‚ #{}å’Œ${}#{}è¡¨ç¤ºä¸€ä¸ªå ä½ç¬¦å·ï¼Œç”¨æ¥ä¼ å…¥å‚æ•°ï¼Œsqlåœ¨è§£æçš„æ—¶å€™ä¼šåŠ ä¸Šâ€ â€œ,å½“æˆå­—ç¬¦ä¸²æ¥è§£æï¼Œå¯ä»¥é˜²æ­¢sqlæ³¨å…¥ ${}è¡¨ç¤ºä¸€ä¸ªæ‹¼æ¥ç¬¦å·, ä¼ å…¥æ•°æ®ç›´æ¥æ˜¾ç¤ºåœ¨ç”Ÿæˆçš„sqlä¸­ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´sqlæ³¨å…¥ MyBatisç¼“å­˜MyBatisæä¾›ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ å¦‚æœç¼“å­˜ä¸­æœ‰æ•°æ®å°±ä¸ç”¨ä»æ•°æ®åº“ä¸­è·å–ï¼Œå‡å°‘äº†å’Œæ•°æ®ä¹‹é—´çš„äº¤äº’æ¬¡æ•°ï¼Œå¤§å¤§æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚ ä¸€çº§ç¼“å­˜æ˜¯sqlSessionçº§åˆ«çš„ç¼“å­˜ã€‚åœ¨æ“ä½œæ•°æ®åº“æ—¶éœ€è¦æ„é€ sqlSessionå¯¹è±¡ï¼Œåœ¨å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ•°æ®ç»“æ„(HashMap)ï¼Œç”¨äºå­˜å‚¨ç¼“å­˜æ•°æ®ã€‚ä¸åŒçš„sqlSessionä¹‹é—´çš„ç¼“å­˜åŒºåŸŸ(HashMap)æ˜¯äº’ä¸å½±å“çš„ã€‚ äºŒçº§ç¼“å­˜æ˜¯mapperçº§åˆ«çš„ç¼“å­˜ï¼Œå¤šä¸ªsqlSessionå»æ“ä½œåŒä¸€ä¸ªMapperçš„sqlè¯­å¥ï¼Œå¤šä¸ªSqlSessionå¯ä»¥å…¬ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨sqlSessionçš„ã€‚ ä¸€çº§ç¼“å­˜çš„å·¥ä½œåŸç† æ¯ä¸€ä¸ªSqlSessionä¸­æŒæœ‰äº†è‡ªå·±çš„Executorï¼Œæ¯ä¸€ä¸ªExecutorä¸­æœ‰ä¸€ä¸ªLocal Cacheã€‚å½“ç”¨æˆ·å‘èµ·æŸ¥è¯¢æ—¶ï¼ŒMyBatisä¼šæ ¹æ®å½“å‰æ‰§è¡Œçš„MapperStatementç”Ÿæˆä¸€ä¸ªkeyï¼Œå»Local Cacheä¸­æŸ¥è¯¢ï¼Œå¦‚æœç¼“å­˜å‘½ä¸­çš„è¯ï¼Œè¿”å›ã€‚å¦‚æœç¼“å­˜æ²¡æœ‰å‘½ä¸­çš„è¯ï¼Œåˆ™å†™å…¥Local Cacheï¼Œæœ€åè¿”å›ç»“æœç»™ç”¨æˆ·ã€‚ äºŒçº§ç¼“å­˜çš„å·¥ä½œåŸç† å‚è€ƒ MyBatiså®˜æ–¹æ–‡æ¡£ MyBatiså…¥é—¨ MyBatisè¿›é˜¶ Mybatiså­¦ä¹ æ€»ç»“ï¼ˆä¹ï¼‰â€”â€”æŸ¥è¯¢ç¼“å­˜ Mybatisç¼“å­˜ä½¿ç”¨åŠæºç åˆ†æ","categories":[{"name":"MyBatis","slug":"MyBatis","permalink":"https://hsb786.github.io/categories/MyBatis/"}],"tags":[{"name":"MyBatis","slug":"MyBatis","permalink":"https://hsb786.github.io/tags/MyBatis/"}]},{"title":"HashMap","slug":"HashMap","date":"2018-04-12T03:29:30.000Z","updated":"2018-04-21T13:24:39.728Z","comments":true,"path":"2018/04/12/HashMap/","link":"","permalink":"https://hsb786.github.io/2018/04/12/HashMap/","excerpt":"HashMapå†…éƒ¨å­˜å‚¨ç»“æ„ HashMapå†…éƒ¨å­˜å‚¨ä½¿ç”¨äº†ä¸€ä¸ªNodeæ•°ç»„ï¼ˆé»˜è®¤å¤§å°æ˜¯16ï¼‰ï¼Œè€ŒNodeç±»åŒ…å«ä¸€ä¸ªç±»å‹ä¸ºNodeçš„nextå˜é‡ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·çš„keyä¼šå­˜å‚¨åˆ°åŒä¸€ä¸ªé“¾è¡¨é‡Œï¼ˆå³äº§ç”Ÿäº†å†²çªï¼‰ã€‚","text":"HashMapå†…éƒ¨å­˜å‚¨ç»“æ„ HashMapå†…éƒ¨å­˜å‚¨ä½¿ç”¨äº†ä¸€ä¸ªNodeæ•°ç»„ï¼ˆé»˜è®¤å¤§å°æ˜¯16ï¼‰ï¼Œè€ŒNodeç±»åŒ…å«ä¸€ä¸ªç±»å‹ä¸ºNodeçš„nextå˜é‡ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·çš„keyä¼šå­˜å‚¨åˆ°åŒä¸€ä¸ªé“¾è¡¨é‡Œï¼ˆå³äº§ç”Ÿäº†å†²çªï¼‰ã€‚ 123456789101112131415161718192021222324252627public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable &#123; transient Node&lt;K,V&gt;[] table; transient int size; transient int modCount; static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16 static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30; static final float DEFAULT_LOAD_FACTOR = 0.75f; static final int TREEIFY_THRESHOLD = 8; static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123; final int hash; final K key; V value; Node&lt;K,V&gt; next; ..... &#125; .....&#125; tableï¼Œä¸€ä¸ªå­˜æ”¾èŠ‚ç‚¹(Node[])çš„æ•°ç»„ï¼Œæ˜¯Hashmapçš„åŸºç¡€è®¾æ–½ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å­˜æ”¾äºæ­¤ã€‚ sizeï¼ŒHashmapå­˜æ”¾çš„é”®å€¼å¯¹çš„æ•°ç›®ï¼Œå¹¶ä¸ç­‰äºtableæ•°ç»„çš„é•¿åº¦ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨é“¾è¡¨å’Œçº¢é»‘æ ‘ç»“æ„ã€‚ modCountï¼ŒHashmapçš„ä¿®æ”¹æ¬¡æ•°ï¼Œæ˜¯å®ç°fail-fastæœºåˆ¶çš„å…³é”® DEFAULT_INITIAL_CAPACITYï¼Œè¡¨ç¤ºé»˜è®¤HashMapæ•°ç»„åˆå§‹å¤§å°ä¸º16ï¼Œå¹¶ä¸”ä¸ºäº†åç»­çš„rehashæ“ä½œçš„æ–¹ä¾¿ï¼ŒHashmapçš„æ•°ç»„å¤§å°å§‹ç»ˆä¸º2çš„æ•´æ•°æ¬¡å¹‚ï¼Œå³ä½¿ä½ è¾“å…¥ä¸€ä¸ªä¸æ˜¯2çš„æ•´æ•°æ¬¡å¹‚çš„å€¼ï¼Œä¹Ÿä¼šå˜æˆæœ€å°çš„å¤§äºè¯¥å€¼çš„2çš„æ•´æ•°æ¬¡å¹‚ã€‚ MAXIMUM_CAPACITYï¼Œè¡¨ç¤ºHashmapæ•°ç»„çš„æœ€å¤§å®¹é‡ï¼Œåˆå§‹å€¼ä¸º2^30ã€‚ DEFAULT_LOAD_FACTORï¼Œè¡¨ç¤ºè´Ÿè½½å› å­ï¼Œå½“Hashmapçš„å®é™…å®¹é‡è¶…è¿‡äº†(è®¾å®šå®¹é‡ä¹˜è´Ÿè½½å› å­)ï¼Œå°±è§¦å‘rehashæ“ä½œï¼Œé»˜è®¤å€¼ä¸º0.75ã€‚ TREEIFY_THRESHOLDï¼Œjkd1.8æ–°å¢çš„ï¼Œå¦‚æœHashmapæ•°ç»„å…ƒç´ çš„é“¾è¡¨é•¿åº¦è¶…è¿‡è¿™ä¸ªå€¼ï¼Œå°±ä½¿ç”¨çº¢é»‘æ ‘ç»“æ„ä»£æ›¿é“¾è¡¨æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œé»˜è®¤å€¼ä¸º8ã€‚ æ•°ç»„å†…çš„å…ƒç´ çš„æ•°æ®ç»“æ„ç»§æ‰¿äº†Map.Entryï¼Œç”¨äºå­˜æ”¾é”®å€¼å¯¹ï¼Œå¦å¤–è¿˜åŒ…å«äº†hashå€¼å’ŒnextèŠ‚ç‚¹ï¼Œå…¶ä¸­hashå€¼å¯ç”¨äºå­˜å–èŠ‚ç‚¹æ—¶æ¥å¯»å€çš„ä½œç”¨ï¼ŒnextèŠ‚ç‚¹æ˜¯å®ç°Hashmapçš„æ•°ç»„+é“¾è¡¨(çº¢é»‘æ ‘)ç»“æ„çš„å…³é”®ã€‚ åœ¨ç»§ç»­çœ‹Hashmapçš„å†…éƒ¨æ–¹æ³•ä¹‹å‰ï¼Œåšä¸ªå¤§è‡´çš„æ€»ç»“ï¼š Hashmapæ˜¯ç”¨äºå­˜æ”¾é”®å€¼å¯¹çš„å®¹å™¨ï¼Œå†…éƒ¨å®ç°æ˜¯åŸºäºæ•°ç»„çš„ï¼Œæ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯é”®å€¼å¯¹NodeèŠ‚ç‚¹ï¼Œä¸€ä¸ªNodeèŠ‚ç‚¹ä¿å­˜äº†ä¸€ä¸ªé”®å€¼å¯¹ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜ä¿å­˜äº†nextèŠ‚ç‚¹ï¼Œå¯ä»¥å½¢æˆé“¾è¡¨ç»“æ„(åœ¨å‘ç”Ÿhashå†²çªçš„æ—¶å€™)ã€‚å¦‚æœé“¾è¡¨é•¿åº¦å¤ªé•¿ï¼Œè¶…è¿‡äº†é˜€å€¼(é»˜è®¤ä¸º8)ï¼Œé‚£ä¹ˆå°±è‡ªåŠ¨å‡çº§ä¸ºçº¢é»‘æ ‘ç»“æ„(é«˜æ•ˆçš„å¹³è¡¡æŸ¥æ‰¾æ ‘)ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ•°ç»„å…ƒç´ çš„èŠ‚ç‚¹å°±æˆä¸ºäº†çº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹äº†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨java8ä¸­å¦‚æœhashå€¼ç›¸åŒçš„keyæ•°é‡å¤§äºæŒ‡å®šå€¼ï¼ˆé»˜è®¤æ˜¯8ï¼‰æ—¶ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚ HashMapçš„è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ HashMapå†…éƒ¨çš„Nodeæ•°ç»„é»˜è®¤çš„å¤§å°æ˜¯16ï¼Œå‡è®¾æœ‰100ä¸‡ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆæœ€å¥½çš„æƒ…å†µä¸‹æ¯ä¸ªhashæ¡¶éƒ½æœ‰62500ä¸ªå…ƒç´ ï¼Œè¿™æ—¶get()ï¼Œput()ï¼Œremove()ç­‰æ–¹æ³•æ•ˆç‡éƒ½ä¼šé™ä½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHashMapæä¾›äº†è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Œå½“å…ƒç´ ä¸ªæ•°è¾¾åˆ°æ•°ç»„å¤§å°*loadFactor(åŠ è½½å› å­)åä¼šæ‰©å¤§æ•°ç»„çš„å¤§å°ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º16ï¼ŒloadFactorä¸º0.75ï¼Œä¹Ÿå°±æ˜¯è¯´å½“HashMapä¸­çš„å…ƒç´ è¶…è¿‡16*0.75=12æ—¶ï¼Œä¼šæŠŠæ•°ç»„å¤§å°æ‰©å±•ä¸º2*16=32ï¼Œå¹¶ä¸”é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ã€‚ æ²¡æ‰©å®¹å‰ï¼Œè·å–EntryEéœ€è¦éå†5ä¸ªå…ƒç´ ï¼Œæ‰©å®¹ä¹‹ååªéœ€è¦2æ¬¡ã€‚ put() å¯¹keyçš„hashCode()åšhashï¼Œç„¶åè®¡ç®—index; å¦‚æœæ²¡ç¢°æ’ç›´æ¥æ”¾åˆ°bucketé‡Œï¼› å¦‚æœç¢°æ’äº†ï¼Œä»¥é“¾è¡¨çš„å½¢å¼å­˜åœ¨bucketsåï¼› å¦‚æœç¢°æ’å¯¼è‡´é“¾è¡¨è¿‡é•¿ï¼ˆå¤§äºç­‰äºTREEIFY_THRESHOLDï¼‰ï¼Œå°±æŠŠé“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ï¼› å¦‚æœèŠ‚ç‚¹å·²ç»å­˜åœ¨å°±æ›¿æ¢old value(ä¿è¯keyçš„å”¯ä¸€æ€§)ï¼› å¦‚æœbucketæ»¡äº†(è¶…è¿‡load factor*current capacity)ï¼Œå°±è¦resizeã€‚ 123public V put(K key, V value) &#123; return putVal(hash(key), key, value, false, true);&#125; å¦‚æœput()æ–¹æ³•æ·»åŠ çš„é”®å€¼å¯¹çš„é”®å·²ç»å­˜åœ¨äºHashmapä¸­ï¼Œé‚£ä¹ˆå°±ç”¨æ–°çš„é”®å€¼çš„å€¼æ›¿ä»£æ—§å€¼ã€‚å†çœ‹æºç put()è°ƒç”¨äº†hash()æ–¹æ³•ä»¥åŠputVal()æ–¹æ³• 1234static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);&#125; å½“è¾“å…¥çš„keyä¸ºnullæ—¶ï¼Œhashå€¼ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´Hashmapçš„keyæ˜¯å¯ä»¥ä¸ºnullçš„ã€‚å¯¹æ¯”HashTableï¼ŒHashTableçš„keyç›´æ¥è¿›è¡Œäº†hashCodeï¼Œå¦‚æœkeyä¸ºnullæ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥HashTableçš„keyä¸å¯ä»¥æ˜¯nullã€‚å…·ä½“å¦‚ä½•å¾—åˆ°keyçš„hashå€¼å‘¢ï¼Ÿé¦–å…ˆè°ƒç”¨keyè‡ªèº«çš„hashcode()å¾—åˆ°ä¸€ä¸ªhashå€¼h(32ä½intç±»å‹)ï¼Œç„¶åå°†hä¸hå³ç§»16ä½ä¹‹åçš„æ•°è¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°æœ€ç»ˆçš„hashå€¼ã€‚è‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œè¿™æ˜¯å‰äººæ€»ç»“å‡ºæ¥çš„ç®—æ³•å¯ä»¥ä½¿å¾—hashå€¼åˆ†å¸ƒæ›´åŠ å‡åŒ€,å°½é‡å‡å°‘å†²çª 123456789101112131415161718192021222324252627282930313233343536373839404142final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); else &#123; Node&lt;K,V&gt; e; K k; if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123; for (int binCount = 0; ; ++binCount) &#123; if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; &#125; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; &#125; &#125; ++modCount; if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null;&#125; é€šè¿‡æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å…¥å‚éƒ½ä»£è¡¨äº†ä»€ä¹ˆï¼š hashï¼šè¡¨ç¤ºkeyçš„hashå€¼ keyï¼šå¾…å­˜å‚¨çš„keyå€¼ valueï¼šå¾…å­˜å‚¨çš„valueå€¼ onlyIfAbsentï¼šæ˜¯å¦éœ€è¦æ›¿æ¢ç›¸åŒçš„valueå€¼ã€‚å¦‚æœä¸ºtrueï¼Œè¡¨ç¤ºä¸æ›¿æ¢å·²ç»å­˜åœ¨çš„value evictï¼šå¦‚æœä¸ºfalseï¼Œè¡¨ç¤ºæ•°ç»„æ˜¯æ–°å¢æ¨¡å¼(æš‚æ—¶ä¸çŸ¥é“å•¥æ„æ€,åªåœ¨æ–¹æ³•çš„æœ€åå‡ºç°,ä½†ä¸å½±å“å…¶ä»–é€»è¾‘) é¦–å…ˆåˆ¤æ–­å½“å‰HashMapçš„æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œå°±è°ƒç”¨resize()æ–¹æ³•åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º16çš„æ•°ç»„ï¼Œå¹¶ä¸”è·å–åˆ°æ•°ç»„çš„é•¿åº¦nï¼Œä»£ç å¦‚ä¸‹ï¼š 12if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; ç„¶åï¼Œæ ¹æ®æ•°ç»„çš„é•¿åº¦n-1çš„å€¼ä¸å…¥å‚keyçš„hashå€¼æŒ‰ä½ä¸è¿ç®—ï¼Œç®—å‡ºhashå€¼å¯¹åº”äºæ•°ç»„ä¸­çš„ä½ç½®ï¼Œä»tabä¸­å°†è¿™ä¸ªä½ç½®ä¸Šé¢çš„å†…å®¹å–å‡ºï¼Œåˆ¤æ–­ä¸ºnullæ—¶ï¼Œåœ¨è¿™ä¸ªä½ç½®æ–°å¢ä¸€ä¸ªNodeã€‚ä½†æ˜¯ï¼Œå¦‚æœå–åˆ°äº†æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªhashå€¼å¯¹åº”æ•°ç»„çš„ä½ç½®ä¸Šé¢å·²ç»æœ‰äº†é”®å€¼å¯¹å­˜åœ¨ã€‚é‚£ä¹ˆï¼Œå°±åˆ¤æ–­è¿™ä¸ªNode,ä¹Ÿå°±æ˜¯pçš„hashå€¼æ˜¯å¦ä¸ä¼ å…¥çš„hashç›¸ç­‰ï¼Œç„¶åæ¥ç€åˆ¤æ–­keyæ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœåˆ¤æ–­é€šè¿‡ï¼Œè¡¨ç¤ºè¦ä¼ å…¥çš„key-valé”®å€¼å¯¹å°±æ˜¯tab[i]ä½ç½®ä¸Šé¢çš„é”®å€¼å¯¹ï¼Œç›´æ¥æ›¿æ¢å³å¯ï¼Œä¸ç”¨ç®¡åé¢æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ã€‚å¦‚æœä¸æ˜¯çš„è¯ï¼Œå°±å°†è¿™ä¸ªæ–°çš„é”®å€¼å¯¹æ’å…¥é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ç§å³å¯ã€‚æ’å…¥é”®å€¼å¯¹åˆ†ä¸¤ç§æƒ…å†µï¼šå¦‚æœæ•°ç»„å…ƒç´ æ˜¯é“¾è¡¨æ—¶ï¼Œå°±å°†èŠ‚ç‚¹æ–°å¢åˆ°åˆ—è¡¨å°¾éƒ¨ã€‚å¦‚æœé“¾è¡¨çš„é•¿åº¦å¤§äºç­‰äºçº¢é»‘æ ‘åŒ–çš„é˜€å€¼-1ï¼Œå°±å°†é“¾è¡¨è½¬æˆçº¢é»‘æ ‘ã€‚å¦‚æœæ•°ç»„å…ƒç´ æ˜¯çº¢é»‘æ ‘çš„è¯ï¼Œå°±æ’å…¥é”®å€¼åˆ°å¯¹åº”çš„Nodeã€‚ æ³¨æ„ï¼Œjava8å¼€å§‹ç”¨çš„æ˜¯å°¾æ’æ³•12345678910111213141516171819202122232425262728293031if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null);else &#123; Node&lt;K,V&gt; e; K k; if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123; for (int binCount = 0; ; ++binCount) &#123; if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; &#125; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; &#125;&#125; æœ€åï¼Œå°†ä¿®æ”¹æ¬¡æ•°åŠ ä¸€ï¼ŒåŒæ—¶åˆ¤æ–­å½“å‰çš„é”®å€¼å¯¹æ•°é‡æ˜¯å¦å³å°†è¶…è¿‡é˜€å€¼ï¼Œå¦‚æœå³å°†è¶…è¿‡ï¼Œéœ€è¦è¿›è¡Œresizeæ“ä½œã€‚12345++modCount; if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null; get() bucketé‡Œçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥å‘½ä¸­ï¼› å¦‚æœæœ‰å†²çªï¼Œåˆ™é€šè¿‡key.equals(k)å»æŸ¥æ‰¾å¯¹åº”çš„entry; è‹¥ä¸ºæ ‘ï¼Œåˆ™åœ¨æ•°ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(logn); è‹¥ä¸ºé“¾è¡¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(n)ã€‚ 1234public V get(Object key) &#123; Node&lt;K,V&gt; e; return (e = getNode(hash(key), key)) == null ? null : e.value;&#125; æ ¹æ®å…¥å‚çš„keyå¯¹è±¡è®¡ç®—å‡ºkeyçš„hashå€¼ï¼Œè°ƒç”¨getNode()æ–¹æ³•ï¼Œå†æ¥çœ‹çœ‹getNode()æ–¹æ³•ã€‚12345678910111213141516171819final Node&lt;K,V&gt; getNode(int hash, Object key) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k; if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) &#123; if (first.hash == hash &amp;&amp; // always check first node ((k = first.key) == key || (key != null &amp;&amp; key.equals(k)))) return first; if ((e = first.next) != null) &#123; if (first instanceof TreeNode) return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key); do &#123; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) return e; &#125; while ((e = e.next) != null); &#125; &#125; return null;&#125; é€šè¿‡keyçš„hashå€¼ä¸keyå¯¹è±¡ï¼Œæ¥æŸ¥æ‰¾keyå¯¹åº”çš„é”®å€¼å¯¹çš„å€¼ï¼Œå¦‚æœæŸ¥æ‰¾å¤±è´¥åˆ™è¿”å›nullã€‚å¦‚ä½•æŸ¥æ‰¾çš„å‘¢ï¼Ÿé¦–å…ˆï¼Œé€šè¿‡keyçš„hashå€¼è®¡ç®—å‡ºå¯¹åº”æ•°ç»„çš„ç´¢å¼•ï¼Œå¦‚æœç´¢å¼•åˆ°çš„ç¬¬ä¸€ä¸ªNodeèŠ‚ç‚¹çš„keyå’Œhashå€¼ä¸å…¥å‚ç›¸ç­‰ï¼Œç›´æ¥è¿”å›è¯¥Nodeã€‚å¦åˆ™ï¼Œå¾ªç¯éå†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(å¯èƒ½æ˜¯é“¾è¡¨ä¹Ÿæœ‰å¯èƒ½æ˜¯çº¢é»‘æ ‘)ã€‚ ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨putæ–¹æ³•æ·»åŠ å…ƒç´ ï¼Œè€Œä¸”å‡è®¾æ­£å¥½å­˜åœ¨ä¸¤ä¸ªputçš„keyå‘ç”Ÿäº†ç¢°æ’(æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·)ï¼Œé‚£ä¹ˆæ ¹æ®HashMapçš„å®ç°ï¼Œè¿™ä¸¤ä¸ªkeyä¼šæ·»åŠ åˆ°æ•°ç»„çš„åŒä¸€ä¸ªä½ç½®ï¼Œè¿™æ ·æœ€ç»ˆå°±ä¼šå‘ç”Ÿå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹çš„putçš„æ•°æ®è¢«è¦†ç›–ã€‚ å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ£€æµ‹åˆ°å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å°*loadFactorï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹Nodeæ•°ç»„è¿›è¡Œæ‰©å®¹ï¼Œéƒ½åœ¨é‡æ–°è®¡ç®—å…ƒç´ ä½ç½®ä»¥åŠå¤åˆ¶æ•°æ®ï¼Œä½†æ˜¯æœ€ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰©å®¹åçš„æ•°ç»„ä¼šèµ‹ç»™tableï¼Œä¹Ÿå°±æ˜¯è¯´å…¶ä»–çº¿ç¨‹çš„éƒ½ä¼šä¸¢å¤±ï¼Œå¹¶ä¸”å„è‡ªçº¿ç¨‹putçš„æ•°æ®ä¹Ÿä¸¢å¤±ã€‚ æ‰©å®¹æ—¶éœ€è¦rehashï¼Œå¯èƒ½ä¼šé€ æˆæ­»å¾ªç¯(java8å·²ä¿®å¤) å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨HashMap Hashtable123456public synchronized V get(Object key) &#123; .....&#125;public synchronized V put(K key, V value) &#123; ......&#125; æ•ˆç‡ä½ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨putæ–¹æ³•æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸ä½†ä¸å¯ä»¥ä½¿ç”¨putæ–¹æ³•ï¼Œè¿getæ–¹æ³•éƒ½ä¸å¯ä»¥ã€‚ ConcurrentHashMap ï¼ˆæ•ˆç‡é«˜ï¼‰JUCåŒ…ä¸­çš„ä¸€ä¸ªç±»ã€‚ConcurrentHashMap ä¸ä»…çº¿ç¨‹å®‰å…¨è€Œä¸”æ•ˆç‡é«˜ï¼Œå› ä¸ºå®ƒåŒ…å«ä¸€ä¸ª segment æ•°ç»„ï¼Œå°†æ•°æ®åˆ†æ®µå­˜å‚¨ï¼Œç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„é”åˆ†æ®µæŠ€æœ¯ã€‚ SynchronizedMapè°ƒç”¨synchronizedMap()æ–¹æ³•åè¿”å›ä¸€ä¸ªSynchronizedMapç±»çš„å¯¹è±¡ï¼Œè€Œåœ¨SynchronizedMapç±»ä¸­ä½¿ç”¨äº†synchronizedåŒæ­¥å…³é”®å­—æ¥ä¿è¯å¯¹Mapçš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ 1234567891011121314151617181920212223242526272829303132333435363738394041// synchronizedMapæ–¹æ³•public static &lt;K,V&gt; Map&lt;K,V&gt; synchronizedMap(Map&lt;K,V&gt; m) &#123; return new SynchronizedMap&lt;&gt;(m); &#125;// SynchronizedMapç±»private static class SynchronizedMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Serializable &#123; private static final long serialVersionUID = 1978198479659022715L; private final Map&lt;K,V&gt; m; // Backing Map final Object mutex; // Object on which to synchronize SynchronizedMap(Map&lt;K,V&gt; m) &#123; this.m = Objects.requireNonNull(m); mutex = this; &#125; SynchronizedMap(Map&lt;K,V&gt; m, Object mutex) &#123; this.m = m; this.mutex = mutex; &#125; public int size() &#123; synchronized (mutex) &#123;return m.size();&#125; &#125; public boolean isEmpty() &#123; synchronized (mutex) &#123;return m.isEmpty();&#125; &#125; public boolean containsKey(Object key) &#123; synchronized (mutex) &#123;return m.containsKey(key);&#125; &#125; public boolean containsValue(Object value) &#123; synchronized (mutex) &#123;return m.containsValue(value);&#125; &#125; public V get(Object key) &#123; synchronized (mutex) &#123;return m.get(key);&#125; &#125; public V put(K key, V value) &#123; synchronized (mutex) &#123;return m.put(key, value);&#125; &#125; public V remove(Object key) &#123; synchronized (mutex) &#123;return m.remove(key);&#125; &#125; // çœç•¥å…¶ä»–æ–¹æ³• &#125; ä»æºç ä¸­å¯ä»¥çœ‹å‡ºè°ƒç”¨ synchronizedMap() æ–¹æ³•åä¼šè¿”å›ä¸€ä¸ª SynchronizedMap ç±»çš„å¯¹è±¡ï¼Œè€Œåœ¨ SynchronizedMap ç±»ä¸­ä½¿ç”¨äº† synchronized åŒæ­¥å…³é”®å­—æ¥ä¿è¯å¯¹ Map çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ æ€»ç»“ HashMapåœ¨å¤„ç†å†²çªæ—¶ä½¿ç”¨é“¾è¡¨å­˜å‚¨ç›¸åŒç´¢å¼•çš„å…ƒç´ ã€‚ ä»Java 8å¼€å§‹ï¼ŒHashMapï¼ŒConcurrentHashMapå’ŒLinkedHashMapåœ¨å¤„ç†é¢‘ç¹å†²çªæ—¶å°†ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œå½“åŒä¸€hashæ¡¶ä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡ç‰¹å®šçš„å€¼ä¾¿ä¼šç”±é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚ å½“ä»é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘æ—¶ï¼ŒHashMapè¿­ä»£çš„é¡ºåºå°†ä¼šæ”¹å˜ã€‚ä¸è¿‡è¿™å¹¶ä¸ä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºHashMapå¹¶æ²¡æœ‰å¯¹è¿­ä»£çš„é¡ºåºæä¾›ä»»ä½•ä¿è¯ã€‚ ä»Java 1ä¸­å°±å­˜åœ¨çš„Hashtableç±»ä¸ºäº†ä¿è¯è¿­ä»£é¡ºåºä¸å˜ï¼Œå³ä¾¿åœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä½¿ç”¨å¹³è¡¡æ ‘ã€‚è¿™ä¸€å†³å®šæ˜¯ä¸ºäº†ä¸ç ´åæŸäº›è¾ƒè€çš„éœ€è¦ä¾èµ–äºHashtableè¿­ä»£é¡ºåºçš„Javaåº”ç”¨ã€‚ é™¤äº†Hashtableä¹‹å¤–ï¼ŒWeakHashMapå’ŒIdentityHashMapä¹Ÿä¸ä¼šåœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä½¿ç”¨å¹³è¡¡æ ‘ã€‚ ä½¿ç”¨HashMapä¹‹æ‰€ä»¥ä¼šäº§ç”Ÿå†²çªæ˜¯å› ä¸ºä½¿ç”¨äº†é”®å¯¹è±¡çš„hashCode()æ–¹æ³•ï¼Œè€Œequals()å’ŒhashCode()æ–¹æ³•ä¸ä¿è¯ä¸åŒå¯¹è±¡çš„hashCodeæ˜¯ä¸åŒçš„ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œç›¸åŒå¯¹è±¡çš„hashCodeä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œä½†ç›¸åŒçš„hashCodeä¸ä¸€å®šæ˜¯ç›¸åŒçš„å¯¹è±¡ã€‚ åœ¨HashTableå’ŒHashMapä¸­ï¼Œå†²çªçš„äº§ç”Ÿæ˜¯ç”±äºä¸åŒå¯¹è±¡çš„hashCode()æ–¹æ³•è¿”å›äº†ä¸€æ ·çš„å€¼ã€‚ Java7åœ¨å¤šçº¿ç¨‹æ“ä½œhashmapæ—¶å¯èƒ½å¼•èµ·æ­»å¾ªç¯ï¼ŒåŸå› æ˜¯æ‰©å®¹è½¬ç§»åå‰åé“¾è¡¨é¡ºåºå€’ç½®ï¼Œåœ¨è½¬ç§»è¿‡ç¨‹ä¸­ä¿®æ”¹äº†åŸæ¥é“¾è¡¨ä¸­èŠ‚ç‚¹çš„å¼•ç”¨å…³ç³»ï¼›Java8åœ¨åŒæ ·çš„å‰æä¸‹å¹¶ä¸ä¼šå¼•èµ·æ­»å¾ªç¯ï¼ŒåŸå› æ˜¯æ‰©å®¹è½¬ç§»åå‰åé“¾è¡¨é¡ºåºä¸å˜ï¼Œä¿æŒä¹‹å‰èŠ‚ç‚¹çš„å¼•ç”¨å…³ç³»ã€‚ å‚è€ƒ Java 8ä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨ HashMap çœ‹çœ‹HashMapæºç ","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"},{"name":"é›†åˆ","slug":"çˆªå“‡/é›†åˆ","permalink":"https://hsb786.github.io/categories/çˆªå“‡/é›†åˆ/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"å·¥å…·ç½‘ç«™","slug":"å·¥å…·ç½‘ç«™","date":"2018-04-11T04:22:11.000Z","updated":"2018-05-04T06:08:04.528Z","comments":true,"path":"2018/04/11/å·¥å…·ç½‘ç«™/","link":"","permalink":"https://hsb786.github.io/2018/04/11/å·¥å…·ç½‘ç«™/","excerpt":"","text":"å›¾æ ‡ ç”»å›¾ åœ¨çº¿ç¼–ç è½¬æ¢ HTTPçŠ¶æ€ç  Sqlè½¬Class","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/categories/å·¥å…·/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"EasyUI","slug":"EasyUI","date":"2018-04-11T03:28:06.000Z","updated":"2018-04-20T13:15:35.744Z","comments":true,"path":"2018/04/11/EasyUI/","link":"","permalink":"https://hsb786.github.io/2018/04/11/EasyUI/","excerpt":"","text":"å½“è¯·æ±‚è¿œç¨‹æ•°æ®æ—¶ï¼Œå‘é€çš„é¢å¤–å‚æ•°ã€‚ åœ¨datagridæ„é€ ä¸­åŠ å…¥queryParamså‚æ•°12345678dataGrid = $(&apos;#dg&apos;).datagrid(&#123; url : &apos;$&#123;pageContext.request.contextPath&#125;/companys/datagrid&apos;, method : &apos;GET&apos;, ......................... queryParams : &#123; //ä¼ å…¥å½“å‰æ—¥æœŸæŸ¥è¯¢ startTime : getNowFormatDate() &#125;, é‡æ–°åŠ è½½è¡Œï¼Œä¿æŒåœ¨å½“å‰é¡µ1$(&apos;#dg&apos;).datagrid(&apos;reload&apos;); åŠ è½½å¹¶æ˜¾ç¤ºç¬¬ä¸€é¡µçš„è¡Œ,é€šè¿‡ä¼ é€’ä¸€äº›ä»å‚æ•°è¿›è¡ŒæŸ¥è¯¢ï¼Œè¯¥æ–¹æ³•è¢«è°ƒç”¨æ¥ä»æœåŠ¡å™¨åŠ è½½æ–°æ•°æ®ã€‚ 1234$(&quot;#dg&quot;).datagrid(&apos;load&apos;, &#123; &quot;job.name&quot; : $(&quot;#jobname&quot;).val(), &quot;user.realname&quot; : $(&quot;#realname&quot;).val() &#125;);","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/categories/å‰ç«¯/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/tags/å‰ç«¯/"}]},{"title":"KingEditor","slug":"KingEditor","date":"2018-04-11T03:22:23.000Z","updated":"2018-04-20T13:18:26.611Z","comments":true,"path":"2018/04/11/KingEditor/","link":"","permalink":"https://hsb786.github.io/2018/04/11/KingEditor/","excerpt":"","text":"å®˜æ–¹æ–‡æ¡£ç¤ºä¾‹ åˆå§‹åŒ–ï¼›å±äºå¼‚æ­¥åŠ è½½123KindEditor.ready(function(K) &#123; window.editor = K.create(&apos;#editor_id&apos;); &#125;); åŒæ­¥åŠ è½½ï¼›ç›´æ¥è°ƒç”¨KindEditoråˆ›å»ºï¼Œè€Œä¸æ˜¯ç­‰KindEditor.readyåå†åˆ›å»º1234567891011about = KindEditor.create(&apos;textarea[id=&quot;about&quot;]&apos;, &#123; items : [ &apos;cut&apos;, &apos;copy&apos;, &apos;paste&apos;, &apos;justifyleft&apos;, &apos;justifycenter&apos;, &apos;justifyright&apos;, &apos;justifyfull&apos;, &apos;insertorderedlist&apos;, &apos;insertunorderedlist&apos;, &apos;indent&apos;, &apos;outdent&apos;, &apos;subscript&apos;, &apos;superscript&apos;, &apos;clearhtml&apos;, &apos;quickformat&apos;, &apos;selectall&apos;, &apos;|&apos;, &apos;fullscreen&apos;, &apos;/&apos;, &apos;formatblock&apos;, &apos;fontname&apos;, &apos;fontsize&apos;, &apos;|&apos;, &apos;forecolor&apos;, &apos;hilitecolor&apos;, &apos;bold&apos;, &apos;italic&apos;, &apos;underline&apos;, &apos;strikethrough&apos;, &apos;lineheight&apos;, &apos;removeformat&apos;, &apos;|&apos;, &apos;table&apos;, &apos;hr&apos;, &apos;emoticons&apos;, &apos;pagebreak&apos; ] &#125;);","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/categories/å‰ç«¯/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/tags/å‰ç«¯/"}]},{"title":"HTTPçŠ¶æ€ç ","slug":"HTTPçŠ¶æ€ç ","date":"2018-04-10T12:27:44.000Z","updated":"2018-04-20T13:16:34.511Z","comments":true,"path":"2018/04/10/HTTPçŠ¶æ€ç /","link":"","permalink":"https://hsb786.github.io/2018/04/10/HTTPçŠ¶æ€ç /","excerpt":"HTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚å®ƒç”± RFC 2616 è§„èŒƒå®šä¹‰çš„ï¼Œå¹¶å¾—åˆ°RFC 2518ã€RFC 2817ã€RFC 2295ã€RFC 2774ã€RFC 4918ç­‰è§„èŒƒæ‰©å±•ã€‚","text":"HTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚å®ƒç”± RFC 2616 è§„èŒƒå®šä¹‰çš„ï¼Œå¹¶å¾—åˆ°RFC 2518ã€RFC 2817ã€RFC 2295ã€RFC 2774ã€RFC 4918ç­‰è§„èŒƒæ‰©å±•ã€‚ status å«ä¹‰ 100 å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚ã€‚è¿™ä¸ªä¸´æ—¶å“åº”æ˜¯ç”¨æ¥é€šçŸ¥å®¢æˆ·ç«¯å®ƒçš„éƒ¨åˆ†è¯·æ±‚å·²ç»è¢«æœåŠ¡å™¨æ¥æ”¶ï¼Œä¸”ä»æœªè¢«æ‹’ç»ã€‚å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ–è€…å¦‚æœè¯·æ±‚å·²ç»å®Œæˆï¼Œå¿½ç•¥è¿™ä¸ªå“åº”ã€‚æœåŠ¡å™¨å¿…é¡»åœ¨è¯·æ±‚å®Œæˆåå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæœ€ç»ˆå“åº”ã€‚ 101 æœåŠ¡å™¨å·²ç»ç†è§£äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†é€šè¿‡Upgrade æ¶ˆæ¯å¤´é€šçŸ¥å®¢æˆ·ç«¯é‡‡ç”¨ä¸åŒçš„åè®®æ¥å®Œæˆè¿™ä¸ªè¯·æ±‚ã€‚åœ¨å‘é€å®Œè¿™ä¸ªå“åº”æœ€åçš„ç©ºè¡Œåï¼ŒæœåŠ¡å™¨å°†ä¼šåˆ‡æ¢åˆ°åœ¨Upgrade æ¶ˆæ¯å¤´ä¸­å®šä¹‰çš„é‚£äº›åè®®ã€‚ åªæœ‰åœ¨åˆ‡æ¢æ–°çš„åè®®æ›´æœ‰å¥½å¤„çš„æ—¶å€™æ‰åº”è¯¥é‡‡å–ç±»ä¼¼æªæ–½ã€‚ä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°æ–°çš„HTTP ç‰ˆæœ¬æ¯”æ—§ç‰ˆæœ¬æ›´æœ‰ä¼˜åŠ¿ï¼Œæˆ–è€…åˆ‡æ¢åˆ°ä¸€ä¸ªå®æ—¶ä¸”åŒæ­¥çš„åè®®ä»¥ä¼ é€åˆ©ç”¨æ­¤ç±»ç‰¹æ€§çš„èµ„æºã€‚ 102 ç”±WebDAVï¼ˆRFC 2518ï¼‰æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨å¤„ç†å°†è¢«ç»§ç»­æ‰§è¡Œã€‚ 200 è¯·æ±‚å·²æˆåŠŸï¼Œè¯·æ±‚æ‰€å¸Œæœ›çš„å“åº”å¤´æˆ–æ•°æ®ä½“å°†éšæ­¤å“åº”è¿”å›ã€‚ 201 è¯·æ±‚å·²ç»è¢«å®ç°ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªæ–°çš„èµ„æºå·²ç»ä¾æ®è¯·æ±‚çš„éœ€è¦è€Œå»ºç«‹ï¼Œä¸”å…¶ URI å·²ç»éšLocation å¤´ä¿¡æ¯è¿”å›ã€‚å‡å¦‚éœ€è¦çš„èµ„æºæ— æ³•åŠæ—¶å»ºç«‹çš„è¯ï¼Œåº”å½“è¿”å› â€˜202 Acceptedâ€™ã€‚ 202 æœåŠ¡å™¨å·²æ¥å—è¯·æ±‚ï¼Œä½†å°šæœªå¤„ç†ã€‚æ­£å¦‚å®ƒå¯èƒ½è¢«æ‹’ç»ä¸€æ ·ï¼Œæœ€ç»ˆè¯¥è¯·æ±‚å¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚åœ¨å¼‚æ­¥æ“ä½œçš„åœºåˆä¸‹ï¼Œæ²¡æœ‰æ¯”å‘é€è¿™ä¸ªçŠ¶æ€ç æ›´æ–¹ä¾¿çš„åšæ³•äº†ã€‚ è¿”å›202çŠ¶æ€ç çš„å“åº”çš„ç›®çš„æ˜¯å…è®¸æœåŠ¡å™¨æ¥å—å…¶ä»–è¿‡ç¨‹çš„è¯·æ±‚ï¼ˆä¾‹å¦‚æŸä¸ªæ¯å¤©åªæ‰§è¡Œä¸€æ¬¡çš„åŸºäºæ‰¹å¤„ç†çš„æ“ä½œï¼‰ï¼Œè€Œä¸å¿…è®©å®¢æˆ·ç«¯ä¸€ç›´ä¿æŒä¸æœåŠ¡å™¨çš„è¿æ¥ç›´åˆ°æ‰¹å¤„ç†æ“ä½œå…¨éƒ¨å®Œæˆã€‚åœ¨æ¥å—è¯·æ±‚å¤„ç†å¹¶è¿”å›202çŠ¶æ€ç çš„å“åº”åº”å½“åœ¨è¿”å›çš„å®ä½“ä¸­åŒ…å«ä¸€äº›æŒ‡ç¤ºå¤„ç†å½“å‰çŠ¶æ€çš„ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘å¤„ç†çŠ¶æ€ç›‘è§†å™¨æˆ–çŠ¶æ€é¢„æµ‹çš„æŒ‡é’ˆï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿä¼°è®¡æ“ä½œæ˜¯å¦å·²ç»å®Œæˆã€‚ 203 æœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†è¿”å›çš„å®ä½“å¤´éƒ¨å…ƒä¿¡æ¯ä¸æ˜¯åœ¨åŸå§‹æœåŠ¡å™¨ä¸Šæœ‰æ•ˆçš„ç¡®å®šé›†åˆï¼Œè€Œæ˜¯æ¥è‡ªæœ¬åœ°æˆ–è€…ç¬¬ä¸‰æ–¹çš„æ‹·è´ã€‚å½“å‰çš„ä¿¡æ¯å¯èƒ½æ˜¯åŸå§‹ç‰ˆæœ¬çš„å­é›†æˆ–è€…è¶…é›†ã€‚ä¾‹å¦‚ï¼ŒåŒ…å«èµ„æºçš„å…ƒæ•°æ®å¯èƒ½å¯¼è‡´åŸå§‹æœåŠ¡å™¨çŸ¥é“å…ƒä¿¡æ¯çš„è¶…çº§ã€‚ä½¿ç”¨æ­¤çŠ¶æ€ç ä¸æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”åªæœ‰åœ¨å“åº”ä¸ä½¿ç”¨æ­¤çŠ¶æ€ç ä¾¿ä¼šè¿”å›200 OKçš„æƒ…å†µä¸‹æ‰æ˜¯åˆé€‚çš„ã€‚ 204 æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†ä¸éœ€è¦è¿”å›ä»»ä½•å®ä½“å†…å®¹ï¼Œå¹¶ä¸”å¸Œæœ›è¿”å›æ›´æ–°äº†çš„å…ƒä¿¡æ¯ã€‚å“åº”å¯èƒ½é€šè¿‡å®ä½“å¤´éƒ¨çš„å½¢å¼ï¼Œè¿”å›æ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯ã€‚å¦‚æœå­˜åœ¨è¿™äº›å¤´éƒ¨ä¿¡æ¯ï¼Œåˆ™åº”å½“ä¸æ‰€è¯·æ±‚çš„å˜é‡ç›¸å‘¼åº”ã€‚ å¦‚æœå®¢æˆ·ç«¯æ˜¯æµè§ˆå™¨çš„è¯ï¼Œé‚£ä¹ˆç”¨æˆ·æµè§ˆå™¨åº”ä¿ç•™å‘é€äº†è¯¥è¯·æ±‚çš„é¡µé¢ï¼Œè€Œä¸äº§ç”Ÿä»»ä½•æ–‡æ¡£è§†å›¾ä¸Šçš„å˜åŒ–ï¼Œå³ä½¿æŒ‰ç…§è§„èŒƒæ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯åº”å½“è¢«åº”ç”¨åˆ°ç”¨æˆ·æµè§ˆå™¨æ´»åŠ¨è§†å›¾ä¸­çš„æ–‡æ¡£ã€‚ ç”±äº204å“åº”è¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œå› æ­¤å®ƒå§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚ 205 æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä¸”æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ä½†æ˜¯ä¸204å“åº”ä¸åŒï¼Œè¿”å›æ­¤çŠ¶æ€ç çš„å“åº”è¦æ±‚è¯·æ±‚è€…é‡ç½®æ–‡æ¡£è§†å›¾ã€‚è¯¥å“åº”ä¸»è¦æ˜¯è¢«ç”¨äºæ¥å—ç”¨æˆ·è¾“å…¥åï¼Œç«‹å³é‡ç½®è¡¨å•ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°å¼€å§‹å¦ä¸€æ¬¡è¾“å…¥ã€‚ ä¸204å“åº”ä¸€æ ·ï¼Œè¯¥å“åº”ä¹Ÿè¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œä¸”ä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“æŸã€‚ 206 æœåŠ¡å™¨å·²ç»æˆåŠŸå¤„ç†äº†éƒ¨åˆ† GET è¯·æ±‚ã€‚ç±»ä¼¼äº FlashGet æˆ–è€…è¿…é›·è¿™ç±»çš„ HTTP ä¸‹è½½å·¥å…·éƒ½æ˜¯ä½¿ç”¨æ­¤ç±»å“åº”å®ç°æ–­ç‚¹ç»­ä¼ æˆ–è€…å°†ä¸€ä¸ªå¤§æ–‡æ¡£åˆ†è§£ä¸ºå¤šä¸ªä¸‹è½½æ®µåŒæ—¶ä¸‹è½½ã€‚ è¯¥è¯·æ±‚å¿…é¡»åŒ…å« Range å¤´ä¿¡æ¯æ¥æŒ‡ç¤ºå®¢æˆ·ç«¯å¸Œæœ›å¾—åˆ°çš„å†…å®¹èŒƒå›´ï¼Œå¹¶ä¸”å¯èƒ½åŒ…å« If-Range æ¥ä½œä¸ºè¯·æ±‚æ¡ä»¶ã€‚ å“åº”å¿…é¡»åŒ…å«å¦‚ä¸‹çš„å¤´éƒ¨åŸŸï¼š Content-Range ç”¨ä»¥æŒ‡ç¤ºæœ¬æ¬¡å“åº”ä¸­è¿”å›çš„å†…å®¹çš„èŒƒå›´ï¼›å¦‚æœæ˜¯ Content-Type ä¸º multipart/byteranges çš„å¤šæ®µä¸‹è½½ï¼Œåˆ™æ¯ä¸€ multipart æ®µä¸­éƒ½åº”åŒ…å« Content-Range åŸŸç”¨ä»¥æŒ‡ç¤ºæœ¬æ®µçš„å†…å®¹èŒƒå›´ã€‚å‡å¦‚å“åº”ä¸­åŒ…å« Content-Lengthï¼Œé‚£ä¹ˆå®ƒçš„æ•°å€¼å¿…é¡»åŒ¹é…å®ƒè¿”å›çš„å†…å®¹èŒƒå›´çš„çœŸå®å­—èŠ‚æ•°ã€‚ Date ETag å’Œ/æˆ– Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¯¥è¿”å›200å“åº”ã€‚ Expires, Cache-Controlï¼Œå’Œ/æˆ– Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚ å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº† If-Range å¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å‡å¦‚æœ¬å“åº”çš„è¯·æ±‚ä½¿ç”¨äº† If-Range å¼±ç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚å¦åˆ™ï¼Œæœ¬å“åº”å°±åº”å½“åŒ…å«æ‰€æœ‰æœ¬åº”è¯¥è¿”å›200å“åº”ä¸­åº”å½“è¿”å›çš„æ‰€æœ‰å®ä½“å¤´éƒ¨åŸŸã€‚ å‡å¦‚ ETag æˆ– Last-Modified å¤´éƒ¨ä¸èƒ½ç²¾ç¡®åŒ¹é…çš„è¯ï¼Œåˆ™å®¢æˆ·ç«¯ç¼“å­˜åº”ç¦æ­¢å°†206å“åº”è¿”å›çš„å†…å®¹ä¸ä¹‹å‰ä»»ä½•ç¼“å­˜è¿‡çš„å†…å®¹ç»„åˆåœ¨ä¸€èµ·ã€‚ ä»»ä½•ä¸æ”¯æŒ Range ä»¥åŠ Content-Range å¤´çš„ç¼“å­˜éƒ½ç¦æ­¢ç¼“å­˜206å“åº”è¿”å›çš„å†…å®¹ã€‚ 207 ç”±WebDAV(RFC 2518)æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨ä¹‹åçš„æ¶ˆæ¯ä½“å°†æ˜¯ä¸€ä¸ªXMLæ¶ˆæ¯ï¼Œå¹¶ä¸”å¯èƒ½ä¾ç…§ä¹‹å‰å­è¯·æ±‚æ•°é‡çš„ä¸åŒï¼ŒåŒ…å«ä¸€ç³»åˆ—ç‹¬ç«‹çš„å“åº”ä»£ç ã€‚ 300 è¢«è¯·æ±‚çš„èµ„æºæœ‰ä¸€ç³»åˆ—å¯ä¾›é€‰æ‹©çš„å›é¦ˆä¿¡æ¯ï¼Œæ¯ä¸ªéƒ½æœ‰è‡ªå·±ç‰¹å®šçš„åœ°å€å’Œæµè§ˆå™¨é©±åŠ¨çš„å•†è®®ä¿¡æ¯ã€‚ç”¨æˆ·æˆ–æµè§ˆå™¨èƒ½å¤Ÿè‡ªè¡Œé€‰æ‹©ä¸€ä¸ªé¦–é€‰çš„åœ°å€è¿›è¡Œé‡å®šå‘ã€‚ é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”åº”å½“åŒ…æ‹¬ä¸€ä¸ªèµ„æºç‰¹æ€§åŠåœ°å€çš„åˆ—è¡¨çš„å®ä½“ï¼Œä»¥ä¾¿ç”¨æˆ·æˆ–æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„é‡å®šå‘åœ°å€ã€‚è¿™ä¸ªå®ä½“çš„æ ¼å¼ç”± Content-Type å®šä¹‰çš„æ ¼å¼æ‰€å†³å®šã€‚æµè§ˆå™¨å¯èƒ½æ ¹æ®å“åº”çš„æ ¼å¼ä»¥åŠæµè§ˆå™¨è‡ªèº«èƒ½åŠ›ï¼Œè‡ªåŠ¨ä½œå‡ºæœ€åˆé€‚çš„é€‰æ‹©ã€‚å½“ç„¶ï¼ŒRFC 2616è§„èŒƒå¹¶æ²¡æœ‰è§„å®šè¿™æ ·çš„è‡ªåŠ¨é€‰æ‹©è¯¥å¦‚ä½•è¿›è¡Œã€‚ å¦‚æœæœåŠ¡å™¨æœ¬èº«å·²ç»æœ‰äº†é¦–é€‰çš„å›é¦ˆé€‰æ‹©ï¼Œé‚£ä¹ˆåœ¨ Location ä¸­åº”å½“æŒ‡æ˜è¿™ä¸ªå›é¦ˆçš„ URIï¼›æµè§ˆå™¨å¯èƒ½ä¼šå°†è¿™ä¸ª Location å€¼ä½œä¸ºè‡ªåŠ¨é‡å®šå‘çš„åœ°å€ã€‚æ­¤å¤–ï¼Œé™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚ 301 è¢«è¯·æ±‚çš„èµ„æºå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼Œå¹¶ä¸”å°†æ¥ä»»ä½•å¯¹æ­¤èµ„æºçš„å¼•ç”¨éƒ½åº”è¯¥ä½¿ç”¨æœ¬å“åº”è¿”å›çš„è‹¥å¹²ä¸ª URI ä¹‹ä¸€ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“è‡ªåŠ¨æŠŠè¯·æ±‚çš„åœ°å€ä¿®æ”¹ä¸ºä»æœåŠ¡å™¨åé¦ˆå›æ¥çš„åœ°å€ã€‚é™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚ æ–°çš„æ°¸ä¹…æ€§çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª GET æˆ–è€… HEAD è¯·æ±‚ï¼Œå› æ­¤æµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ æ³¨æ„ï¼šå¯¹äºæŸäº›ä½¿ç”¨ HTTP/1.0 åè®®çš„æµè§ˆå™¨ï¼Œå½“å®ƒä»¬å‘é€çš„ POST è¯·æ±‚å¾—åˆ°äº†ä¸€ä¸ª301å“åº”çš„è¯ï¼Œæ¥ä¸‹æ¥çš„é‡å®šå‘è¯·æ±‚å°†ä¼šå˜æˆ GET æ–¹å¼ã€‚ 302 è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„ URI å“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚ æ–°çš„ä¸´æ—¶æ€§çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª GET æˆ–è€… HEAD è¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ æ³¨æ„ï¼šè™½ç„¶RFC 1945å’ŒRFC 2068è§„èŒƒä¸å…è®¸å®¢æˆ·ç«¯åœ¨é‡å®šå‘æ—¶æ”¹å˜è¯·æ±‚çš„æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå¤šç°å­˜çš„æµè§ˆå™¨å°†302å“åº”è§†ä½œä¸º303å“åº”ï¼Œå¹¶ä¸”ä½¿ç”¨ GET æ–¹å¼è®¿é—®åœ¨ Location ä¸­è§„å®šçš„ URIï¼Œè€Œæ— è§†åŸå…ˆè¯·æ±‚çš„æ–¹æ³•ã€‚çŠ¶æ€ç 303å’Œ307è¢«æ·»åŠ äº†è¿›æ¥ï¼Œç”¨ä»¥æ˜ç¡®æœåŠ¡å™¨æœŸå¾…å®¢æˆ·ç«¯è¿›è¡Œä½•ç§ååº”ã€‚ 303 å¯¹åº”å½“å‰è¯·æ±‚çš„å“åº”å¯ä»¥åœ¨å¦ä¸€ä¸ª URI ä¸Šè¢«æ‰¾åˆ°ï¼Œè€Œä¸”å®¢æˆ·ç«¯åº”å½“é‡‡ç”¨ GET çš„æ–¹å¼è®¿é—®é‚£ä¸ªèµ„æºã€‚è¿™ä¸ªæ–¹æ³•çš„å­˜åœ¨ä¸»è¦æ˜¯ä¸ºäº†å…è®¸ç”±è„šæœ¬æ¿€æ´»çš„POSTè¯·æ±‚è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–°çš„èµ„æºã€‚è¿™ä¸ªæ–°çš„ URI ä¸æ˜¯åŸå§‹èµ„æºçš„æ›¿ä»£å¼•ç”¨ã€‚åŒæ—¶ï¼Œ303å“åº”ç¦æ­¢è¢«ç¼“å­˜ã€‚å½“ç„¶ï¼Œç¬¬äºŒä¸ªè¯·æ±‚ï¼ˆé‡å®šå‘ï¼‰å¯èƒ½è¢«ç¼“å­˜ã€‚ æ–°çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ æ³¨æ„ï¼šè®¸å¤š HTTP/1.1 ç‰ˆä»¥å‰çš„ æµè§ˆå™¨ä¸èƒ½æ­£ç¡®ç†è§£303çŠ¶æ€ã€‚å¦‚æœéœ€è¦è€ƒè™‘ä¸è¿™äº›æµè§ˆå™¨ä¹‹é—´çš„äº’åŠ¨ï¼Œ302çŠ¶æ€ç åº”è¯¥å¯ä»¥èƒœä»»ï¼Œå› ä¸ºå¤§å¤šæ•°çš„æµè§ˆå™¨å¤„ç†302å“åº”æ—¶çš„æ–¹å¼æ°æ°å°±æ˜¯ä¸Šè¿°è§„èŒƒè¦æ±‚å®¢æˆ·ç«¯å¤„ç†303å“åº”æ—¶åº”å½“åšçš„ã€‚ 304 å¦‚æœå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªå¸¦æ¡ä»¶çš„ GET è¯·æ±‚ä¸”è¯¥è¯·æ±‚å·²è¢«å…è®¸ï¼Œè€Œæ–‡æ¡£çš„å†…å®¹ï¼ˆè‡ªä¸Šæ¬¡è®¿é—®ä»¥æ¥æˆ–è€…æ ¹æ®è¯·æ±‚çš„æ¡ä»¶ï¼‰å¹¶æ²¡æœ‰æ”¹å˜ï¼Œåˆ™æœåŠ¡å™¨åº”å½“è¿”å›è¿™ä¸ªçŠ¶æ€ç ã€‚304å“åº”ç¦æ­¢åŒ…å«æ¶ˆæ¯ä½“ï¼Œå› æ­¤å§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚ è¯¥å“åº”å¿…é¡»åŒ…å«ä»¥ä¸‹çš„å¤´ä¿¡æ¯ï¼š Dateï¼Œé™¤éè¿™ä¸ªæœåŠ¡å™¨æ²¡æœ‰æ—¶é’Ÿã€‚å‡å¦‚æ²¡æœ‰æ—¶é’Ÿçš„æœåŠ¡å™¨ä¹Ÿéµå®ˆè¿™äº›è§„åˆ™ï¼Œé‚£ä¹ˆä»£ç†æœåŠ¡å™¨ä»¥åŠå®¢æˆ·ç«¯å¯ä»¥è‡ªè¡Œå°† Date å­—æ®µæ·»åŠ åˆ°æ¥æ”¶åˆ°çš„å“åº”å¤´ä¸­å»ï¼ˆæ­£å¦‚RFC 2068ä¸­è§„å®šçš„ä¸€æ ·ï¼‰ï¼Œç¼“å­˜æœºåˆ¶å°†ä¼šæ­£å¸¸å·¥ä½œã€‚ ETag å’Œ/æˆ– Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¿”å›200å“åº”ã€‚ Expires, Cache-Controlï¼Œå’Œ/æˆ–Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚ å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº†å¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å¦åˆ™ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ªå¸¦æ¡ä»¶çš„ GET è¯·æ±‚ä½¿ç”¨äº†å¼±ç¼“å­˜éªŒè¯ï¼‰ï¼Œæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜äº†çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚ å‡å¦‚æŸä¸ª304å“åº”æŒ‡æ˜äº†å½“å‰æŸä¸ªå®ä½“æ²¡æœ‰ç¼“å­˜ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»å¿½è§†è¿™ä¸ªå“åº”ï¼Œå¹¶ä¸”é‡å¤å‘é€ä¸åŒ…å«é™åˆ¶æ¡ä»¶çš„è¯·æ±‚ã€‚ å‡å¦‚æ¥æ”¶åˆ°ä¸€ä¸ªè¦æ±‚æ›´æ–°æŸä¸ªç¼“å­˜æ¡ç›®çš„304å“åº”ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»æ›´æ–°æ•´ä¸ªæ¡ç›®ä»¥åæ˜ æ‰€æœ‰åœ¨å“åº”ä¸­è¢«æ›´æ–°çš„å­—æ®µçš„å€¼ã€‚ 305 è¢«è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡æŒ‡å®šçš„ä»£ç†æ‰èƒ½è¢«è®¿é—®ã€‚Location åŸŸä¸­å°†ç»™å‡ºæŒ‡å®šçš„ä»£ç†æ‰€åœ¨çš„ URI ä¿¡æ¯ï¼Œæ¥æ”¶è€…éœ€è¦é‡å¤å‘é€ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œé€šè¿‡è¿™ä¸ªä»£ç†æ‰èƒ½è®¿é—®ç›¸åº”èµ„æºã€‚åªæœ‰åŸå§‹æœåŠ¡å™¨æ‰èƒ½å»ºç«‹305å“åº”ã€‚ æ³¨æ„ï¼šRFC 2068ä¸­æ²¡æœ‰æ˜ç¡®305å“åº”æ˜¯ä¸ºäº†é‡å®šå‘ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œè€Œä¸”åªèƒ½è¢«åŸå§‹æœåŠ¡å™¨å»ºç«‹ã€‚å¿½è§†è¿™äº›é™åˆ¶å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å®‰å…¨åæœã€‚ 306 åœ¨æœ€æ–°ç‰ˆçš„è§„èŒƒä¸­ï¼Œ306çŠ¶æ€ç å·²ç»ä¸å†è¢«ä½¿ç”¨ã€‚ 307 è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„URI å“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚ æ–°çš„ä¸´æ—¶æ€§çš„URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚å› ä¸ºéƒ¨åˆ†æµè§ˆå™¨ä¸èƒ½è¯†åˆ«307å“åº”ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä¸Šè¿°å¿…è¦ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿç†è§£å¹¶å‘æ–°çš„ URI å‘å‡ºè®¿é—®è¯·æ±‚ã€‚ å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ªGET æˆ–è€… HEAD è¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ 400 1ã€è¯­ä¹‰æœ‰è¯¯ï¼Œå½“å‰è¯·æ±‚æ— æ³•è¢«æœåŠ¡å™¨ç†è§£ã€‚é™¤éè¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¸åº”è¯¥é‡å¤æäº¤è¿™ä¸ªè¯·æ±‚ã€‚ 2ã€è¯·æ±‚å‚æ•°æœ‰è¯¯ã€‚ 401 å½“å‰è¯·æ±‚éœ€è¦ç”¨æˆ·éªŒè¯ã€‚è¯¥å“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªé€‚ç”¨äºè¢«è¯·æ±‚èµ„æºçš„ WWW-Authenticate ä¿¡æ¯å¤´ç”¨ä»¥è¯¢é—®ç”¨æˆ·ä¿¡æ¯ã€‚å®¢æˆ·ç«¯å¯ä»¥é‡å¤æäº¤ä¸€ä¸ªåŒ…å«æ°å½“çš„ Authorization å¤´ä¿¡æ¯çš„è¯·æ±‚ã€‚å¦‚æœå½“å‰è¯·æ±‚å·²ç»åŒ…å«äº† Authorization è¯ä¹¦ï¼Œé‚£ä¹ˆ401å“åº”ä»£è¡¨ç€æœåŠ¡å™¨éªŒè¯å·²ç»æ‹’ç»äº†é‚£äº›è¯ä¹¦ã€‚å¦‚æœ401å“åº”åŒ…å«äº†ä¸å‰ä¸€ä¸ªå“åº”ç›¸åŒçš„èº«ä»½éªŒè¯è¯¢é—®ï¼Œä¸”æµè§ˆå™¨å·²ç»è‡³å°‘å°è¯•äº†ä¸€æ¬¡éªŒè¯ï¼Œé‚£ä¹ˆæµè§ˆå™¨åº”å½“å‘ç”¨æˆ·å±•ç¤ºå“åº”ä¸­åŒ…å«çš„å®ä½“ä¿¡æ¯ï¼Œå› ä¸ºè¿™ä¸ªå®ä½“ä¿¡æ¯ä¸­å¯èƒ½åŒ…å«äº†ç›¸å…³è¯Šæ–­ä¿¡æ¯ã€‚å‚è§RFC 2617ã€‚ 402 è¯¥çŠ¶æ€ç æ˜¯ä¸ºäº†å°†æ¥å¯èƒ½çš„éœ€æ±‚è€Œé¢„ç•™çš„ã€‚ 403 æœåŠ¡å™¨å·²ç»ç†è§£è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œå®ƒã€‚ä¸401å“åº”ä¸åŒçš„æ˜¯ï¼Œèº«ä»½éªŒè¯å¹¶ä¸èƒ½æä¾›ä»»ä½•å¸®åŠ©ï¼Œè€Œä¸”è¿™ä¸ªè¯·æ±‚ä¹Ÿä¸åº”è¯¥è¢«é‡å¤æäº¤ã€‚å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œè€Œä¸”æœåŠ¡å™¨å¸Œæœ›èƒ½å¤Ÿè®²æ¸…æ¥šä¸ºä½•è¯·æ±‚ä¸èƒ½è¢«æ‰§è¡Œï¼Œé‚£ä¹ˆå°±åº”è¯¥åœ¨å®ä½“å†…æè¿°æ‹’ç»çš„åŸå› ã€‚å½“ç„¶æœåŠ¡å™¨ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª404å“åº”ï¼Œå‡å¦‚å®ƒä¸å¸Œæœ›è®©å®¢æˆ·ç«¯è·å¾—ä»»ä½•ä¿¡æ¯ã€‚ 404 è¯·æ±‚å¤±è´¥ï¼Œè¯·æ±‚æ‰€å¸Œæœ›å¾—åˆ°çš„èµ„æºæœªè¢«åœ¨æœåŠ¡å™¨ä¸Šå‘ç°ã€‚æ²¡æœ‰ä¿¡æ¯èƒ½å¤Ÿå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªçŠ¶å†µåˆ°åº•æ˜¯æš‚æ—¶çš„è¿˜æ˜¯æ°¸ä¹…çš„ã€‚å‡å¦‚æœåŠ¡å™¨çŸ¥é“æƒ…å†µçš„è¯ï¼Œåº”å½“ä½¿ç”¨410çŠ¶æ€ç æ¥å‘ŠçŸ¥æ—§èµ„æºå› ä¸ºæŸäº›å†…éƒ¨çš„é…ç½®æœºåˆ¶é—®é¢˜ï¼Œå·²ç»æ°¸ä¹…çš„ä¸å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å¯ä»¥è·³è½¬çš„åœ°å€ã€‚404è¿™ä¸ªçŠ¶æ€ç è¢«å¹¿æ³›åº”ç”¨äºå½“æœåŠ¡å™¨ä¸æƒ³æ­ç¤ºåˆ°åº•ä¸ºä½•è¯·æ±‚è¢«æ‹’ç»æˆ–è€…æ²¡æœ‰å…¶ä»–é€‚åˆçš„å“åº”å¯ç”¨çš„æƒ…å†µä¸‹ã€‚ 405 è¯·æ±‚è¡Œä¸­æŒ‡å®šçš„è¯·æ±‚æ–¹æ³•ä¸èƒ½è¢«ç”¨äºè¯·æ±‚ç›¸åº”çš„èµ„æºã€‚è¯¥å“åº”å¿…é¡»è¿”å›ä¸€ä¸ªAllow å¤´ä¿¡æ¯ç”¨ä»¥è¡¨ç¤ºå‡ºå½“å‰èµ„æºèƒ½å¤Ÿæ¥å—çš„è¯·æ±‚æ–¹æ³•çš„åˆ—è¡¨ã€‚ é‰´äº PUTï¼ŒDELETE æ–¹æ³•ä¼šå¯¹æœåŠ¡å™¨ä¸Šçš„èµ„æºè¿›è¡Œå†™æ“ä½œï¼Œå› è€Œç»å¤§éƒ¨åˆ†çš„ç½‘é¡µæœåŠ¡å™¨éƒ½ä¸æ”¯æŒæˆ–è€…åœ¨é»˜è®¤é…ç½®ä¸‹ä¸å…è®¸ä¸Šè¿°è¯·æ±‚æ–¹æ³•ï¼Œå¯¹äºæ­¤ç±»è¯·æ±‚å‡ä¼šè¿”å›405é”™è¯¯ã€‚ 406 è¯·æ±‚çš„èµ„æºçš„å†…å®¹ç‰¹æ€§æ— æ³•æ»¡è¶³è¯·æ±‚å¤´ä¸­çš„æ¡ä»¶ï¼Œå› è€Œæ— æ³•ç”Ÿæˆå“åº”å®ä½“ã€‚ é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”å°±åº”å½“è¿”å›ä¸€ä¸ªåŒ…å«å¯ä»¥è®©ç”¨æˆ·æˆ–è€…æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„å®ä½“ç‰¹æ€§ä»¥åŠåœ°å€åˆ—è¡¨çš„å®ä½“ã€‚å®ä½“çš„æ ¼å¼ç”± Content-Type å¤´ä¸­å®šä¹‰çš„åª’ä½“ç±»å‹å†³å®šã€‚æµè§ˆå™¨å¯ä»¥æ ¹æ®æ ¼å¼åŠè‡ªèº«èƒ½åŠ›è‡ªè¡Œä½œå‡ºæœ€ä½³é€‰æ‹©ã€‚ä½†æ˜¯ï¼Œè§„èŒƒä¸­å¹¶æ²¡æœ‰å®šä¹‰ä»»ä½•ä½œå‡ºæ­¤ç±»è‡ªåŠ¨é€‰æ‹©çš„æ ‡å‡†ã€‚ 407 ä¸401å“åº”ç±»ä¼¼ï¼Œåªä¸è¿‡å®¢æˆ·ç«¯å¿…é¡»åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè¿›è¡Œèº«ä»½éªŒè¯ã€‚ä»£ç†æœåŠ¡å™¨å¿…é¡»è¿”å›ä¸€ä¸ª Proxy-Authenticate ç”¨ä»¥è¿›è¡Œèº«ä»½è¯¢é—®ã€‚å®¢æˆ·ç«¯å¯ä»¥è¿”å›ä¸€ä¸ª Proxy-Authorization ä¿¡æ¯å¤´ç”¨ä»¥éªŒè¯ã€‚å‚è§RFC 2617ã€‚ 408 è¯·æ±‚è¶…æ—¶ã€‚å®¢æˆ·ç«¯æ²¡æœ‰åœ¨æœåŠ¡å™¨é¢„å¤‡ç­‰å¾…çš„æ—¶é—´å†…å®Œæˆä¸€ä¸ªè¯·æ±‚çš„å‘é€ã€‚å®¢æˆ·ç«¯å¯ä»¥éšæ—¶å†æ¬¡æäº¤è¿™ä¸€è¯·æ±‚è€Œæ— éœ€è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚ 409 ç”±äºå’Œè¢«è¯·æ±‚çš„èµ„æºçš„å½“å‰çŠ¶æ€ä¹‹é—´å­˜åœ¨å†²çªï¼Œè¯·æ±‚æ— æ³•å®Œæˆã€‚è¿™ä¸ªä»£ç åªå…è®¸ç”¨åœ¨è¿™æ ·çš„æƒ…å†µä¸‹æ‰èƒ½è¢«ä½¿ç”¨ï¼šç”¨æˆ·è¢«è®¤ä¸ºèƒ½å¤Ÿè§£å†³å†²çªï¼Œå¹¶ä¸”ä¼šé‡æ–°æäº¤æ–°çš„è¯·æ±‚ã€‚è¯¥å“åº”åº”å½“åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·å‘ç°å†²çªçš„æºå¤´ã€‚ å†²çªé€šå¸¸å‘ç”Ÿäºå¯¹ PUT è¯·æ±‚çš„å¤„ç†ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨é‡‡ç”¨ç‰ˆæœ¬æ£€æŸ¥çš„ç¯å¢ƒä¸‹ï¼ŒæŸæ¬¡ PUT æäº¤çš„å¯¹ç‰¹å®šèµ„æºçš„ä¿®æ”¹è¯·æ±‚æ‰€é™„å¸¦çš„ç‰ˆæœ¬ä¿¡æ¯ä¸ä¹‹å‰çš„æŸä¸ªï¼ˆç¬¬ä¸‰æ–¹ï¼‰è¯·æ±‚å‘å†²çªï¼Œé‚£ä¹ˆæ­¤æ—¶æœåŠ¡å™¨å°±åº”è¯¥è¿”å›ä¸€ä¸ª409é”™è¯¯ï¼Œå‘ŠçŸ¥ç”¨æˆ·è¯·æ±‚æ— æ³•å®Œæˆã€‚æ­¤æ—¶ï¼Œå“åº”å®ä½“ä¸­å¾ˆå¯èƒ½ä¼šåŒ…å«ä¸¤ä¸ªå†²çªç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚æ¯”è¾ƒï¼Œä»¥ä¾¿ç”¨æˆ·é‡æ–°æäº¤å½’å¹¶ä»¥åçš„æ–°ç‰ˆæœ¬ã€‚ 410 è¢«è¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šå·²ç»ä¸å†å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å·²çŸ¥çš„è½¬å‘åœ°å€ã€‚è¿™æ ·çš„çŠ¶å†µåº”å½“è¢«è®¤ä¸ºæ˜¯æ°¸ä¹…æ€§çš„ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“åœ¨è·å¾—ç”¨æˆ·è®¸å¯ååˆ é™¤æ‰€æœ‰æŒ‡å‘è¿™ä¸ªåœ°å€çš„å¼•ç”¨ã€‚å¦‚æœæœåŠ¡å™¨ä¸çŸ¥é“æˆ–è€…æ— æ³•ç¡®å®šè¿™ä¸ªçŠ¶å†µæ˜¯å¦æ˜¯æ°¸ä¹…çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨404çŠ¶æ€ç ã€‚é™¤éé¢å¤–è¯´æ˜ï¼Œå¦åˆ™è¿™ä¸ªå“åº”æ˜¯å¯ç¼“å­˜çš„ã€‚ 410å“åº”çš„ç›®çš„ä¸»è¦æ˜¯å¸®åŠ©ç½‘ç«™ç®¡ç†å‘˜ç»´æŠ¤ç½‘ç«™ï¼Œé€šçŸ¥ç”¨æˆ·è¯¥èµ„æºå·²ç»ä¸å†å¯ç”¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ‹¥æœ‰è€…å¸Œæœ›æ‰€æœ‰æŒ‡å‘è¿™ä¸ªèµ„æºçš„è¿œç«¯è¿æ¥ä¹Ÿè¢«åˆ é™¤ã€‚è¿™ç±»äº‹ä»¶åœ¨é™æ—¶ã€å¢å€¼æœåŠ¡ä¸­å¾ˆæ™®éã€‚åŒæ ·ï¼Œ410å“åº”ä¹Ÿè¢«ç”¨äºé€šçŸ¥å®¢æˆ·ç«¯åœ¨å½“å‰æœåŠ¡å™¨ç«™ç‚¹ä¸Šï¼ŒåŸæœ¬å±äºæŸä¸ªä¸ªäººçš„èµ„æºå·²ç»ä¸å†å¯ç”¨ã€‚å½“ç„¶ï¼Œæ˜¯å¦éœ€è¦æŠŠæ‰€æœ‰æ°¸ä¹…ä¸å¯ç”¨çš„èµ„æºæ ‡è®°ä¸ºâ€™410 Goneâ€™ï¼Œä»¥åŠæ˜¯å¦éœ€è¦ä¿æŒæ­¤æ ‡è®°å¤šé•¿æ—¶é—´ï¼Œå®Œå…¨å–å†³äºæœåŠ¡å™¨æ‹¥æœ‰è€…ã€‚ 411 æœåŠ¡å™¨æ‹’ç»åœ¨æ²¡æœ‰å®šä¹‰ Content-Length å¤´çš„æƒ…å†µä¸‹æ¥å—è¯·æ±‚ã€‚åœ¨æ·»åŠ äº†è¡¨æ˜è¯·æ±‚æ¶ˆæ¯ä½“é•¿åº¦çš„æœ‰æ•ˆ Content-Length å¤´ä¹‹åï¼Œå®¢æˆ·ç«¯å¯ä»¥å†æ¬¡æäº¤è¯¥è¯·æ±‚ã€‚ 412 æœåŠ¡å™¨åœ¨éªŒè¯åœ¨è¯·æ±‚çš„å¤´å­—æ®µä¸­ç»™å‡ºå…ˆå†³æ¡ä»¶æ—¶ï¼Œæ²¡èƒ½æ»¡è¶³å…¶ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªã€‚è¿™ä¸ªçŠ¶æ€ç å…è®¸å®¢æˆ·ç«¯åœ¨è·å–èµ„æºæ—¶åœ¨è¯·æ±‚çš„å…ƒä¿¡æ¯ï¼ˆè¯·æ±‚å¤´å­—æ®µæ•°æ®ï¼‰ä¸­è®¾ç½®å…ˆå†³æ¡ä»¶ï¼Œä»¥æ­¤é¿å…è¯¥è¯·æ±‚æ–¹æ³•è¢«åº”ç”¨åˆ°å…¶å¸Œæœ›çš„å†…å®¹ä»¥å¤–çš„èµ„æºä¸Šã€‚ 413 æœåŠ¡å™¨æ‹’ç»å¤„ç†å½“å‰è¯·æ±‚ï¼Œå› ä¸ºè¯¥è¯·æ±‚æäº¤çš„å®ä½“æ•°æ®å¤§å°è¶…è¿‡äº†æœåŠ¡å™¨æ„¿æ„æˆ–è€…èƒ½å¤Ÿå¤„ç†çš„èŒƒå›´ã€‚æ­¤ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯ä»¥å…³é—­è¿æ¥ä»¥å…å®¢æˆ·ç«¯ç»§ç»­å‘é€æ­¤è¯·æ±‚ã€‚ å¦‚æœè¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼ŒæœåŠ¡å™¨åº”å½“è¿”å›ä¸€ä¸ª Retry-After çš„å“åº”å¤´ï¼Œä»¥å‘ŠçŸ¥å®¢æˆ·ç«¯å¯ä»¥åœ¨å¤šå°‘æ—¶é—´ä»¥åé‡æ–°å°è¯•ã€‚ 414 è¯·æ±‚çš„URI é•¿åº¦è¶…è¿‡äº†æœåŠ¡å™¨èƒ½å¤Ÿè§£é‡Šçš„é•¿åº¦ï¼Œå› æ­¤æœåŠ¡å™¨æ‹’ç»å¯¹è¯¥è¯·æ±‚æä¾›æœåŠ¡ã€‚è¿™æ¯”è¾ƒå°‘è§ï¼Œé€šå¸¸çš„æƒ…å†µåŒ…æ‹¬ï¼š æœ¬åº”ä½¿ç”¨POSTæ–¹æ³•çš„è¡¨å•æäº¤å˜æˆäº†GETæ–¹æ³•ï¼Œå¯¼è‡´æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆQuery Stringï¼‰è¿‡é•¿ã€‚ é‡å®šå‘URI â€œé»‘æ´â€ï¼Œä¾‹å¦‚æ¯æ¬¡é‡å®šå‘æŠŠæ—§çš„ URI ä½œä¸ºæ–°çš„ URI çš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´åœ¨è‹¥å¹²æ¬¡é‡å®šå‘å URI è¶…é•¿ã€‚ å®¢æˆ·ç«¯æ­£åœ¨å°è¯•åˆ©ç”¨æŸäº›æœåŠ¡å™¨ä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´æ”»å‡»æœåŠ¡å™¨ã€‚è¿™ç±»æœåŠ¡å™¨ä½¿ç”¨å›ºå®šé•¿åº¦çš„ç¼“å†²è¯»å–æˆ–æ“ä½œè¯·æ±‚çš„ URIï¼Œå½“ GET åçš„å‚æ•°è¶…è¿‡æŸä¸ªæ•°å€¼åï¼Œå¯èƒ½ä¼šäº§ç”Ÿç¼“å†²åŒºæº¢å‡ºï¼Œå¯¼è‡´ä»»æ„ä»£ç è¢«æ‰§è¡Œ[1]ã€‚æ²¡æœ‰æ­¤ç±»æ¼æ´çš„æœåŠ¡å™¨ï¼Œåº”å½“è¿”å›414çŠ¶æ€ç ã€‚ 415 å¯¹äºå½“å‰è¯·æ±‚çš„æ–¹æ³•å’Œæ‰€è¯·æ±‚çš„èµ„æºï¼Œè¯·æ±‚ä¸­æäº¤çš„å®ä½“å¹¶ä¸æ˜¯æœåŠ¡å™¨ä¸­æ‰€æ”¯æŒçš„æ ¼å¼ï¼Œå› æ­¤è¯·æ±‚è¢«æ‹’ç»ã€‚ 416 å¦‚æœè¯·æ±‚ä¸­åŒ…å«äº† Range è¯·æ±‚å¤´ï¼Œå¹¶ä¸” Range ä¸­æŒ‡å®šçš„ä»»ä½•æ•°æ®èŒƒå›´éƒ½ä¸å½“å‰èµ„æºçš„å¯ç”¨èŒƒå›´ä¸é‡åˆï¼ŒåŒæ—¶è¯·æ±‚ä¸­åˆæ²¡æœ‰å®šä¹‰ If-Range è¯·æ±‚å¤´ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±åº”å½“è¿”å›416çŠ¶æ€ç ã€‚ å‡å¦‚ Range ä½¿ç”¨çš„æ˜¯å­—èŠ‚èŒƒå›´ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µå°±æ˜¯æŒ‡è¯·æ±‚æŒ‡å®šçš„æ‰€æœ‰æ•°æ®èŒƒå›´çš„é¦–å­—èŠ‚ä½ç½®éƒ½è¶…è¿‡äº†å½“å‰èµ„æºçš„é•¿åº¦ã€‚æœåŠ¡å™¨ä¹Ÿåº”å½“åœ¨è¿”å›416çŠ¶æ€ç çš„åŒæ—¶ï¼ŒåŒ…å«ä¸€ä¸ª Content-Range å®ä½“å¤´ï¼Œç”¨ä»¥æŒ‡æ˜å½“å‰èµ„æºçš„é•¿åº¦ã€‚è¿™ä¸ªå“åº”ä¹Ÿè¢«ç¦æ­¢ä½¿ç”¨ multipart/byteranges ä½œä¸ºå…¶ Content-Typeã€‚ 417 åœ¨è¯·æ±‚å¤´ Expect ä¸­æŒ‡å®šçš„é¢„æœŸå†…å®¹æ— æ³•è¢«æœåŠ¡å™¨æ»¡è¶³ï¼Œæˆ–è€…è¿™ä¸ªæœåŠ¡å™¨æ˜¯ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå®ƒæœ‰æ˜æ˜¾çš„è¯æ®è¯æ˜åœ¨å½“å‰è·¯ç”±çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒExpect çš„å†…å®¹æ— æ³•è¢«æ»¡è¶³ã€‚ 421 ä»å½“å‰å®¢æˆ·ç«¯æ‰€åœ¨çš„IPåœ°å€åˆ°æœåŠ¡å™¨çš„è¿æ¥æ•°è¶…è¿‡äº†æœåŠ¡å™¨è®¸å¯çš„æœ€å¤§èŒƒå›´ã€‚é€šå¸¸ï¼Œè¿™é‡Œçš„IPåœ°å€æŒ‡çš„æ˜¯ä»æœåŠ¡å™¨ä¸Šçœ‹åˆ°çš„å®¢æˆ·ç«¯åœ°å€ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ç½‘å…³æˆ–è€…ä»£ç†æœåŠ¡å™¨åœ°å€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥æ•°çš„è®¡ç®—å¯èƒ½æ¶‰åŠåˆ°ä¸æ­¢ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·ã€‚ 422 ä»å½“å‰å®¢æˆ·ç«¯æ‰€åœ¨çš„IPåœ°å€åˆ°æœåŠ¡å™¨çš„è¿æ¥æ•°è¶…è¿‡äº†æœåŠ¡å™¨è®¸å¯çš„æœ€å¤§èŒƒå›´ã€‚é€šå¸¸ï¼Œè¿™é‡Œçš„IPåœ°å€æŒ‡çš„æ˜¯ä»æœåŠ¡å™¨ä¸Šçœ‹åˆ°çš„å®¢æˆ·ç«¯åœ°å€ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ç½‘å…³æˆ–è€…ä»£ç†æœåŠ¡å™¨åœ°å€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥æ•°çš„è®¡ç®—å¯èƒ½æ¶‰åŠåˆ°ä¸æ­¢ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·ã€‚ 422 è¯·æ±‚æ ¼å¼æ­£ç¡®ï¼Œä½†æ˜¯ç”±äºå«æœ‰è¯­ä¹‰é”™è¯¯ï¼Œæ— æ³•å“åº”ã€‚ï¼ˆRFC 4918 WebDAVï¼‰423 Locked å½“å‰èµ„æºè¢«é”å®šã€‚ï¼ˆRFC 4918 WebDAVï¼‰ 424 ç”±äºä¹‹å‰çš„æŸä¸ªè¯·æ±‚å‘ç”Ÿçš„é”™è¯¯ï¼Œå¯¼è‡´å½“å‰è¯·æ±‚å¤±è´¥ï¼Œä¾‹å¦‚ PROPPATCHã€‚ï¼ˆRFC 4918 WebDAVï¼‰ 425 åœ¨WebDav Advanced Collections è‰æ¡ˆä¸­å®šä¹‰ï¼Œä½†æ˜¯æœªå‡ºç°åœ¨ã€ŠWebDAV é¡ºåºé›†åè®®ã€‹ï¼ˆRFC 3658ï¼‰ä¸­ã€‚ 426 å®¢æˆ·ç«¯åº”å½“åˆ‡æ¢åˆ°TLS/1.0ã€‚ï¼ˆRFC 2817ï¼‰ 449 ç”±å¾®è½¯æ‰©å±•ï¼Œä»£è¡¨è¯·æ±‚åº”å½“åœ¨æ‰§è¡Œå®Œé€‚å½“çš„æ“ä½œåè¿›è¡Œé‡è¯•ã€‚ 500 æœåŠ¡å™¨é‡åˆ°äº†ä¸€ä¸ªæœªæ›¾é¢„æ–™çš„çŠ¶å†µï¼Œå¯¼è‡´äº†å®ƒæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜éƒ½ä¼šåœ¨æœåŠ¡å™¨çš„ç¨‹åºç å‡ºé”™æ—¶å‡ºç°ã€‚ 501 æœåŠ¡å™¨ä¸æ”¯æŒå½“å‰è¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½ã€‚å½“æœåŠ¡å™¨æ— æ³•è¯†åˆ«è¯·æ±‚çš„æ–¹æ³•ï¼Œå¹¶ä¸”æ— æ³•æ”¯æŒå…¶å¯¹ä»»ä½•èµ„æºçš„è¯·æ±‚ã€‚ 502 ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°æ— æ•ˆçš„å“åº”ã€‚ 503 ç”±äºä¸´æ—¶çš„æœåŠ¡å™¨ç»´æŠ¤æˆ–è€…è¿‡è½½ï¼ŒæœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†è¯·æ±‚ã€‚è¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ä¸”å°†åœ¨ä¸€æ®µæ—¶é—´ä»¥åæ¢å¤ã€‚å¦‚æœèƒ½å¤Ÿé¢„è®¡å»¶è¿Ÿæ—¶é—´ï¼Œé‚£ä¹ˆå“åº”ä¸­å¯ä»¥åŒ…å«ä¸€ä¸ª Retry-After å¤´ç”¨ä»¥æ ‡æ˜è¿™ä¸ªå»¶è¿Ÿæ—¶é—´ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºè¿™ä¸ª Retry-After ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åº”å½“ä»¥å¤„ç†500å“åº”çš„æ–¹å¼å¤„ç†å®ƒã€‚ æ³¨æ„ï¼š503çŠ¶æ€ç çš„å­˜åœ¨å¹¶ä¸æ„å‘³ç€æœåŠ¡å™¨åœ¨è¿‡è½½çš„æ—¶å€™å¿…é¡»ä½¿ç”¨å®ƒã€‚æŸäº›æœåŠ¡å™¨åªä¸è¿‡æ˜¯å¸Œæœ›æ‹’ç»å®¢æˆ·ç«¯çš„è¿æ¥ã€‚ 504 ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨ï¼ˆURIæ ‡è¯†å‡ºçš„æœåŠ¡å™¨ï¼Œä¾‹å¦‚HTTPã€FTPã€LDAPï¼‰æˆ–è€…è¾…åŠ©æœåŠ¡å™¨ï¼ˆä¾‹å¦‚DNSï¼‰æ”¶åˆ°å“åº”ã€‚ æ³¨æ„ï¼šæŸäº›ä»£ç†æœåŠ¡å™¨åœ¨DNSæŸ¥è¯¢è¶…æ—¶æ—¶ä¼šè¿”å›400æˆ–è€…500é”™è¯¯ 505 æœåŠ¡å™¨ä¸æ”¯æŒï¼Œæˆ–è€…æ‹’ç»æ”¯æŒåœ¨è¯·æ±‚ä¸­ä½¿ç”¨çš„ HTTP ç‰ˆæœ¬ã€‚è¿™æš—ç¤ºç€æœåŠ¡å™¨ä¸èƒ½æˆ–ä¸æ„¿ä½¿ç”¨ä¸å®¢æˆ·ç«¯ç›¸åŒçš„ç‰ˆæœ¬ã€‚å“åº”ä¸­åº”å½“åŒ…å«ä¸€ä¸ªæè¿°äº†ä¸ºä½•ç‰ˆæœ¬ä¸è¢«æ”¯æŒä»¥åŠæœåŠ¡å™¨æ”¯æŒå“ªäº›åè®®çš„å®ä½“ã€‚ 506 ç”±ã€Šé€æ˜å†…å®¹åå•†åè®®ã€‹ï¼ˆRFC 2295ï¼‰æ‰©å±•ï¼Œä»£è¡¨æœåŠ¡å™¨å­˜åœ¨å†…éƒ¨é…ç½®é”™è¯¯ï¼šè¢«è¯·æ±‚çš„åå•†å˜å…ƒèµ„æºè¢«é…ç½®ä¸ºåœ¨é€æ˜å†…å®¹åå•†ä¸­ä½¿ç”¨è‡ªå·±ï¼Œå› æ­¤åœ¨ä¸€ä¸ªåå•†å¤„ç†ä¸­ä¸æ˜¯ä¸€ä¸ªåˆé€‚çš„é‡ç‚¹ã€‚ 507 æœåŠ¡å™¨æ— æ³•å­˜å‚¨å®Œæˆè¯·æ±‚æ‰€å¿…é¡»çš„å†…å®¹ã€‚è¿™ä¸ªçŠ¶å†µè¢«è®¤ä¸ºæ˜¯ä¸´æ—¶çš„ã€‚WebDAV (RFC 4918) 509 æœåŠ¡å™¨è¾¾åˆ°å¸¦å®½é™åˆ¶ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªå®˜æ–¹çš„çŠ¶æ€ç ï¼Œä½†æ˜¯ä»è¢«å¹¿æ³›ä½¿ç”¨ã€‚ 510 è·å–èµ„æºæ‰€éœ€è¦çš„ç­–ç•¥å¹¶æ²¡æœ‰æ²¡æ»¡è¶³ã€‚ï¼ˆRFC 2774ï¼‰","categories":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/categories/HTTP/"}],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://hsb786.github.io/tags/HTTP/"}]},{"title":"Eclipseå¿«æ·é”®","slug":"Eclipseå¿«æ·é”®","date":"2018-04-10T12:02:48.000Z","updated":"2018-04-20T13:15:55.002Z","comments":true,"path":"2018/04/10/Eclipseå¿«æ·é”®/","link":"","permalink":"https://hsb786.github.io/2018/04/10/Eclipseå¿«æ·é”®/","excerpt":"","text":"å‘½ä»¤ è¯­ä¹‰ Ctrl W å…³é—­å½“å‰Editor Ctrl E å½“å‰Editorä¸‹æ‹‰åˆ—è¡¨ Ctrl T æ˜¾ç¤ºå½“å‰ç±»çš„ç»“æ„ Ctrl G æœç´¢å·¥ä½œåŒºä¸­çš„å£°æ˜ Ctrl N æ–°å»º Ctrl K æŸ¥æ‰¾é€‰ä¸­çš„æ–‡æœ¬ä¸‹ä¸€ä¸ª Ctrl Shift X æŠŠå½“å‰é€‰ä¸­çš„æ–‡æœ¬å…¨éƒ¨å˜ä¸ºå¤§å†™ Ctrl Shift Y æŠŠå½“å‰é€‰ä¸­çš„æ–‡æœ¬å…¨éƒ¨å˜ä¸ºå°å†™ Ctrl Shift K æŸ¥æ‰¾é€‰ä¸­çš„æ–‡æœ¬ä¸Šä¸€ä¸ª Ctrl+Shift+H åœ¨å±‚æ¬¡ç»“æ„ä¸­æ‰“å¼€ç±»å‹ Ctrl+Shift+â†‘ è½¬è‡³ä¸Šä¸€ä¸ªæˆå‘˜ Ctrl+Shift+â†“ è½¬è‡³ä¸‹ä¸€ä¸ªæˆå‘˜","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/categories/å·¥å…·/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"Spring","slug":"Spring","date":"2018-04-10T09:58:41.000Z","updated":"2018-04-25T05:22:58.164Z","comments":true,"path":"2018/04/10/Spring/","link":"","permalink":"https://hsb786.github.io/2018/04/10/Spring/","excerpt":"Springç»“æ„Springæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶åªæœ‰ä¸‰ä¸ªï¼šBeanï¼ŒContextï¼ŒCore","text":"Springç»“æ„Springæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶åªæœ‰ä¸‰ä¸ªï¼šBeanï¼ŒContextï¼ŒCore Springæ˜¯é¢å‘Beanç¼–ç¨‹ï¼Œè‡ªç„¶Beanç»„ä»¶å°±æ˜¯Springå¯¹Javaå¯¹è±¡Objectçš„å°è£…ï¼Œåœ¨Springå®¹å™¨ä¸­ç®¡ç†çš„å°±æ˜¯è¢«Beanå°è£…äº†çš„Javaå¯¹è±¡ã€‚ Contextç»„ä»¶å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„IOCå®¹å™¨ï¼Œä¹Ÿå°±æ˜¯Springå®¹å™¨ã€‚Contextç»„ä»¶å¯ä»¥å‘ç°æ¯ä¸ªBeanä¹‹é—´çš„å…³ç³»ï¼Œä¸ºå®ƒä»¬å»ºç«‹å¥½Beanä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¸ºBeanæä¾›ç”Ÿå­˜ç¯å¢ƒã€‚ Coreç»„ä»¶ï¼Œå®ƒæ˜¯Contextç»„ä»¶ä¸Beanç»„ä»¶çš„å·¥å…·åŒ…ï¼Œå¯ä»¥æŠŠCoreç»„ä»¶ç†è§£ä¸ºUtilå·¥å…·åŒ… æ€»ç»“æ¥è¯´ï¼ŒBeanç»„ä»¶è§£å†³Beançš„å®šä¹‰ï¼ŒBeançš„åˆ›å»ºä»¥åŠBeançš„è§£æï¼Œä¾‹å¦‚åœ¨Springé…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„èŠ‚ç‚¹ï¼ŒSpringä¼šè§£æå¾—åˆ°å¯¹åº”çš„BeanDefinitionå¯¹è±¡ã€‚Contextç»„ä»¶æä¾›äº†è¿™äº›Beançš„ç”Ÿå­˜ç¯å¢ƒï¼Œä¿å­˜å„ä¸ªBeançš„çŠ¶æ€ã€‚å®é™…ä¸ŠContextç»„ä»¶ç»“åˆBeanç»„ä»¶ï¼ŒCoreç»„ä»¶å…±åŒå»ºç«‹äº†ä¸€ä¸ªBeançš„å®¹å™¨ï¼Œå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦ä»‹ç»çš„IOCå®¹å™¨ã€‚ Springå®¹å™¨Springå®¹å™¨æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºIOCå®¹å™¨ã€‚IOC: Inverse of Controlï¼Œæ§åˆ¶åè½¬ã€‚æ§åˆ¶ï¼šæ§åˆ¶å°±æ˜¯è°ƒç”¨ç±»å¯¹æŸä¸€ä¸ªæ¥å£å…·ä½“å®ç°ç±»çš„é€‰æ‹©æ§åˆ¶æƒåè½¬ï¼šé€‰æ‹©æ§åˆ¶æƒäº¤ç»™ç¬¬ä¸‰æ–¹å†³å®šï¼Œç”±Springå®¹å™¨æ¥ç»Ÿä¸€é…ç½®ç®¡ç†Beanã€‚ ä¸ºäº†æ›´å¥½ç†è§£IOCï¼Œå¤§å®¶ç»å¸¸ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¥ä»£æ›¿æ§åˆ¶åè½¬è¿™ä¸ªæ¦‚å¿µï¼Œå³è®©è°ƒç”¨ç±»å¯¹æŸä¸€æ¥å£çš„å®ç°ç±»çš„ä¾èµ–å…³ç³»ç”±ç¬¬ä¸‰æ–¹å®¹å™¨æ³¨å…¥ï¼Œä»¥ç§»é™¤è°ƒç”¨ç±»å¯¹æŸä¸€æ¥å£å®ç°ç±»çš„ä¾èµ–ã€‚é‚£ä¹ˆIOCå®¹å™¨çš„å·¥ä½œå°±æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶å’Œæ³¨è§£æ¥æè¿°ç±»å’Œç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚åˆ©ç”¨åå°„æœºåˆ¶å®Œæˆç±»çš„åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥ã€‚ BeanFactoryå’ŒApplicationContextBeanFactoryæ˜¯Springæ¡†æ¶æ ¸å¿ƒæ¥å£ï¼Œæä¾›äº†IOCçš„é…ç½®æœºåˆ¶ï¼Œæ˜¯Springçš„åŸºç¡€è®¾æ–½ï¼Œé¢å‘Springæœ¬èº« ApplicationContextæ˜¯å»ºç«‹åœ¨BeanFactoryä¹‹ä¸Šï¼Œæä¾›äº†æ›´å¤šçš„é¢å‘åº”ç”¨çš„åŠŸèƒ½ï¼Œæ˜¯Springç»™å¼€å‘è€…æé«˜äº†IOCå®¹å™¨æ¥å£ BeanFactroyé‡‡ç”¨çš„æ˜¯å»¶è¿ŸåŠ è½½å½¢å¼æ¥æ³¨å…¥Beançš„ï¼Œå³åªæœ‰åœ¨ä½¿ç”¨åˆ°æŸä¸ªBeanæ—¶(è°ƒç”¨getBean())ï¼Œæ‰å¯¹è¯¥Beanè¿›è¡ŒåŠ è½½å®ä¾‹åŒ–ï¼›è€ŒApplicationContextåˆ™ç›¸åï¼Œå®ƒæ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€æ¬¡æ€§åˆ›å»ºäº†æ‰€æœ‰çš„Beanã€‚ Beançš„ç”Ÿå‘½å‘¨æœŸ å¦‚æœåœ¨é…ç½®æ–‡ä»¶ä¸­å£°æ˜äº†å·¥å‚åå¤„ç†å™¨æ¥å£BeanFactoryPostProcessorçš„å®ç°ç±»ï¼Œé‚£ä¹ˆåœ¨Springå®¹å™¨è£…è½½é…ç½®æ–‡ä»¶ä¹‹åï¼Œåˆå§‹åŒ–Beanå®ä¾‹ä¹‹å‰å°†è°ƒç”¨è¿™äº›BeanFactoryPostProcessorå¯¹é…ç½®ä¿¡æ¯è¿›è¡ŒåŠ å·¥å¤„ç†ã€‚ä¹Ÿå°±æ˜¯è¯´å·¥å‚åå¤„ç†å™¨æ˜¯å®¹å™¨çº§åˆ«çš„ï¼Œä»…åœ¨å®¹å™¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œå¯¹é…ç½®æ–‡ä»¶è¿›è¡ŒåŠ å·¥ å½“æˆ‘ä»¬é€šè¿‡getBean(String beanName)æ–¹æ³•å‘å®¹å™¨è¯·æ±‚æŸä¸ªBeanå®ä¾‹çš„æ—¶å€™ï¼Œå¦‚æœå®¹å™¨æ³¨å†Œäº†InstantiationAwareBeanPostProcessoræ¥å£çš„å®ç°ç±»ï¼Œé‚£ä¹ˆåœ¨å®ä¾‹åŒ–Beanä¹‹å‰ï¼Œå°†è°ƒç”¨è¯¥æ¥å£çš„postProcessBeforeInstantiation()æ–¹æ³• å®ä¾‹åŒ–Bean å¦‚æœå®¹å™¨æ³¨å†Œäº†InstantiationAwareBeanPostProcessoræ¥å£çš„å®ç°ç±»ï¼Œé‚£ä¹ˆåœ¨å®ä¾‹åŒ–Beanä¹‹åï¼Œå°†è°ƒç”¨è¯¥æ¥å£çš„postProcessAfterInstantiation()æ–¹æ³• å¦‚æœBeané…ç½®äº†å±æ€§ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¹å™¨åœ¨å°†å±æ€§å€¼é…ç½®åˆ°Beanä¸­ä¹‹å‰ï¼Œå°†è°ƒç”¨InstantiationAwareBeanPostProcessoræ¥å£çš„postProcessPropertyValues()æ–¹æ³• ä¸ºBeanè®¾ç½®å±æ€§å€¼ å¦‚æœBeanå®ç°äº†BeanNameAwareæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„setBeanName()æ–¹æ³•ï¼Œå°†é…ç½®æ–‡ä»¶ä¸­è¯¥Beanå¯¹åº”çš„åç§°è®¾ç½®åˆ°Beanä¸­ å¦‚æœBeanå®ç°äº†BeanFactoryAwareæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„setBeanFactory()æ–¹æ³•ï¼Œå°†BeanFactoryå®¹å™¨å®ä¾‹è®¾ç½®åˆ°Beanä¸­ å¦‚æœBeanå®ç°äº†ApplicationContextAwareæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„setApplicationContext()æ–¹æ³•ï¼Œå°†ApplicationContextå®¹å™¨å®ä¾‹è®¾ç½®åˆ°Beanä¸­ å¦‚æœBeanFactoryè£…é…äº†BeanPostProcessoræ¥å£çš„å®ç°ç±»ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥åå¤„ç†å™¨çš„postProcessBeforeInitialization(Object bean , String beanName)æ–¹æ³•å¯¹Beanè¿›è¡ŒåŠ å·¥ã€‚å…¶ä¸­ï¼Œå…¥å‚beanæ˜¯å½“å‰æ­£åœ¨å¤„ç†çš„Beanï¼Œè€ŒbeanNameæ˜¯å½“å‰Beançš„é…ç½®åã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡æ”¹æ–¹æ³•å¯¹Beanè¿›è¡Œç‰¹æ®Šçš„æ”¹é€ ï¼Œä¾‹å¦‚Springæä¾›çš„AOPåŠŸèƒ½å°±åˆ©ç”¨BeanPostPrecessoræ¥å®ç° å¦‚æœBeanå®ç°äº†InitializingBeanæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„afterPropertiesSet()æ–¹æ³• å¦‚æœåœ¨ä¸­é€šè¿‡init-methodå±æ€§å®šä¹‰äº†åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œè¿™ä¸ªæ–¹æ³• è¿™æ˜¯å·¥å‚åå¤„ç†å™¨BeanPostProcessoræ¥å£å®šä¹‰çš„ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•åœ¨ç¬¬10æ­¥æ‰§è¡Œäº†ï¼Œè¯¥æ¥å£çš„postProcessAfterInitialization(Object bean , String beanName)æ–¹æ³•ç»™å®¹å™¨æä¾›äº†å†æ¬¡å¯¹Beanè¿›è¡ŒåŠ å·¥çš„æœºä¼š å¦‚æœåœ¨ä¸­é…ç½®çš„Beançš„ä½œç”¨èŒƒå›´æ˜¯scope=â€œprototypeâ€ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†è¯¥Beanå®ä¾‹è¿”å›ç»™è°ƒç”¨è€…ï¼Œè¿™äº›Beanå®ä¾‹ä¸å†ç”±Springå®¹å™¨ç®¡ç†ã€‚å¦‚æœscope=â€œsingletonâ€ï¼Œé‚£ä¹ˆå°±ç¼“å­˜è¯¥Beanå®ä¾‹ï¼Œå†è¿”å›ç»™è°ƒç”¨è€…ï¼ŒåŒæ—¶Springå®¹å™¨å°†ç»§ç»­ç®¡ç†ç¼“å­˜æ± ä¸­çš„Beanå®ä¾‹ å¯¹äºscope=â€œsingletonâ€(é»˜è®¤æƒ…å†µ)çš„Beanï¼Œå½“å®¹å™¨å…³é—­çš„æ—¶å€™ï¼Œå¦‚æœBeanå®ç°äº†DisposableBeanæ¥å£ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ¥å£çš„destroy()æ–¹æ³• å¯¹äºscope=â€œsingletonâ€(é»˜è®¤æƒ…å†µ)çš„Beanï¼Œå¦‚æœé€šè¿‡destroy-methodå±æ€§é…ç½®çš„é”€æ¯æ–¹æ³•ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥æ–¹æ³• ä¸Šè¿°16æ­¥æè¿°äº†ApplicationContextç®¡ç†çš„Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œå…¶ä¸­çš„æ¯ä¸€æ­¥éƒ½è°ƒç”¨äº†ç›¸å…³çš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ï¼š Beanè‡ªèº«çš„æ–¹æ³•ï¼šBeançš„æ„é€ å‡½æ•°ï¼ŒBeançš„Setteræ–¹æ³•ï¼Œä»¥åŠinit-methodå’Œdestroy-methodæ–¹æ³• Beançº§ç”Ÿå‘½å‘¨æœŸæ¥å£æ–¹æ³•ï¼šè¿™äº›æ–¹æ³•æ˜¯Springå®¹å™¨è§„å®šçš„ï¼Œç”±Beanå®ç°çš„æ–¹æ³•ï¼Œä¾‹å¦‚BeanNameAwareæ¥å£ï¼ŒBeanFactoryAwareæ¥å£ï¼ŒApplicationContextAwareæ¥å£ï¼ŒInitializingBeanæ¥å£ï¼ŒDisposableBeanæ¥å£ å®¹å™¨çº§ç”Ÿå‘½å‘¨æœŸæ¥å£æ–¹æ³•ï¼šè¿™äº›æ–¹æ³•æ˜¯å®¹å™¨æ¥é…ç½®å®ç°ç±»çš„ï¼Œæ— éœ€Beanæ¥å®ç°ï¼Œåœ¨æµç¨‹å›¾ä¸­ç”¨é»‘ç‚¹æ ‡è¯†çš„æ–¹æ³•ã€‚ç”±äºæ˜¯å®¹å™¨çº§åˆ«çš„åå¤„ç†å™¨ï¼Œè¿™äº›æ–¹æ³•å¯¹å®¹å™¨ä¸­æ‰€æœ‰çš„Beanéƒ½èµ·ä½œç”¨ã€‚ åœ¨ApplicationContextä¸­ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é€šè¿‡å®šä¹‰å·¥å‚åå¤„ç†å™¨å’ŒBeanåå¤„ç†å™¨ï¼Œå®¹å™¨å°±ä¼šæŒ‰ç…§é¢„å®šçš„æœºåˆ¶è¿è¡Œã€‚ä»¥ä¸Šå°±æ˜¯Springå®¹å™¨ä¸­ç®¡ç†çš„Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸æ˜¯æ¯ä¸€æ­¥éƒ½åœ¨å®é™…ä¸­ç”¨åˆ°ï¼Œä½†æ˜¯è¿™äº›ç”Ÿå‘½å‘¨æœŸä½“ç°äº†Springå®¹å™¨å¯¹Beançš„ç®¡ç†ç†å¿µï¼Œæä¾›ç»™å¼€å‘è€…è¶³å¤Ÿçš„ç©ºé—´æ¥è‡ªå·±æ§åˆ¶Beanã€‚ BeanFactoryå¦‚æœæŸäº›Beançš„å®ä¾‹åŒ–è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœæŒ‰ç…§XMLæˆ–è€…æ³¨è§£æ¥é…ç½®çš„è¯éœ€è¦å¤§é‡çš„é…ç½®ä¿¡æ¯ï¼Œå¹¶ä¸”çµæ´»æ€§ä¹Ÿå—é™åˆ¶ã€‚Springä¸ºäº†è§£å†³è¿™ä¸€æƒ…å†µï¼Œæä¾›äº†BeanFactoryï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°è¯¥å·¥å‚æ¥å£æ¥å®šåˆ¶å®ä¾‹åŒ–Beançš„é€»è¾‘ã€‚BeanFactoryæ¥å£å®šä¹‰äº†3ä¸ªæ–¹æ³•ï¼š T getObject(): è¿”å›ç”±BeanFactoryåˆ›å»ºçš„Beançš„å®ä¾‹ã€‚ boolean isSingleton(): ç”±BeanFactoryåˆ›å»ºçš„Beanæ˜¯Singletonè¿˜æ˜¯prototype Class&lt;?&gt; getObjectType(): è¿”å›BeanFactoryåˆ›å»ºçš„Beançš„ç±»å‹ å½“é…ç½®æ–‡ä»¶ä¸­çš„ç±»å‹æ˜¯BeanFactoryæ—¶ï¼Œå®¹å™¨é€šè¿‡getBean()æ–¹æ³•è¿”å›çš„ä¸æ˜¯BeanFactoryæœ¬èº«ï¼Œè€Œæ˜¯BeanFactory.getObject()æ–¹æ³•æ‰€è¿”å›çš„å¯¹è±¡ã€‚Springæä¾›äº†æ–¹æ³•è¿”å›çš„ä¸æ˜¯BeanFactoryæœ¬èº«ï¼Œè€Œæ˜¯BeanFactoryæ¥å£ç»™æˆ‘ä»¬æä¾›äº†è‡ªå®šä¹‰å®ä¾‹åŒ–Beançš„æ–¹æ³•ï¼Œåœ¨æŸäº›å¤æ‚çš„æƒ…å†µä¸‹å¾ˆæœ‰ç”¨å¤„ã€‚ Springä¸­ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼ å·¥å‚æ¨¡å¼:IOCå®¹å™¨ ä»£ç†æ¨¡å¼:AOP ç­–ç•¥æ¨¡å¼:åœ¨springé‡‡å–åŠ¨æ€ä»£ç†æ—¶ï¼Œæ ¹æ®ä»£ç†çš„ç±»æœ‰æ— å®ç°æ¥å£æœ‰JDKå’ŒCGLIBä¸¤ç§ä»£ç†æ–¹å¼ï¼Œå°±æ˜¯é‡‡ç”¨ç­–ç•¥æ¨¡å¼å®ç°çš„ å•ä¾‹æ¨¡å¼:é»˜è®¤æƒ…å†µä¸‹springä¸­çš„beanåªå­˜åœ¨ä¸€ä¸ªå®ä¾‹ Spring IoCå’ŒAOPIoCçš„æ ¸å¿ƒæ˜¯ä¾èµ–åè½¬ï¼Œå°†åˆ›å»ºå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„ä¾èµ–ç®¡ç†äº¤ç»™IoCå®¹å™¨æ¥åšï¼Œå®Œæˆå¯¹è±¡ä¹‹é—´çš„è§£è€¦ã€‚ AOPä¸»è¦æ˜¯åˆ©ç”¨ä»£ç†æ¨¡å¼ï¼ŒæŠŠè®¸å¤šæ¥å£éƒ½è¦ç”¨çš„åˆå’Œæ¥å£æœ¬èº«ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘æ— å…³çš„éƒ¨åˆ†æŠ½å‡ºæ¥ï¼Œå†™æˆä¸€ä¸ªåˆ‡é¢ï¼Œå•ç‹¬ç»´æŠ¤ï¼Œæ¯”å¦‚æƒé™éªŒè¯ã€‚è¿™æ ·å¯ä»¥ä½¿æ¥å£ç¬¦åˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œåªå…³æ³¨ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿæé«˜äº†ä»£ç çš„é‡ç”¨æ€§ã€‚ å‚è€ƒ Springå®¹å™¨â€”â€”é¢å‘Beanç¼–ç¨‹ é¢è¯•æ€»ç»“","categories":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/categories/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"}]},{"title":"çº¿ç¨‹æ± ","slug":"çº¿ç¨‹æ± ","date":"2018-04-10T02:13:01.000Z","updated":"2018-04-20T13:22:44.687Z","comments":true,"path":"2018/04/10/çº¿ç¨‹æ± /","link":"","permalink":"https://hsb786.github.io/2018/04/10/çº¿ç¨‹æ± /","excerpt":"ThreadPoolExecutor å‚æ•° è¯´æ˜ corePoolSize çº¿ç¨‹æ± ä¸­æ ¸å¿ƒçº¿ç¨‹æ•°é‡ maximumPoolSize çº¿ç¨‹æ± ä¸­æœ€å¤§çº¿ç¨‹æ•°é‡ keepAliveTime éæ ¸å¿ƒçº¿ç¨‹å­˜æ´»æ—¶é—´ unit keepAliveTimeçš„æ—¶é—´å•ä½ workQueue å­˜æ”¾ä»»åŠ¡çš„é˜Ÿåˆ— threadFactory ç”¨æ¥ç”Ÿäº§çº¿ç¨‹çš„å·¥å‚ handler å½“çº¿ç¨‹æ± ä¸­ä¸èƒ½å†æ”¾å…¥ä»»åŠ¡æ—¶æ‰§è¡Œçš„handler","text":"ThreadPoolExecutor å‚æ•° è¯´æ˜ corePoolSize çº¿ç¨‹æ± ä¸­æ ¸å¿ƒçº¿ç¨‹æ•°é‡ maximumPoolSize çº¿ç¨‹æ± ä¸­æœ€å¤§çº¿ç¨‹æ•°é‡ keepAliveTime éæ ¸å¿ƒçº¿ç¨‹å­˜æ´»æ—¶é—´ unit keepAliveTimeçš„æ—¶é—´å•ä½ workQueue å­˜æ”¾ä»»åŠ¡çš„é˜Ÿåˆ— threadFactory ç”¨æ¥ç”Ÿäº§çº¿ç¨‹çš„å·¥å‚ handler å½“çº¿ç¨‹æ± ä¸­ä¸èƒ½å†æ”¾å…¥ä»»åŠ¡æ—¶æ‰§è¡Œçš„handler çº¿ç¨‹æ± çŠ¶æ€12345volatile int runState;static final int RUNNING = 0;static final int SHUTDOWN = 1;static final int STOP = 2;static final int TERMINATED = 3; å½“åˆ›å»ºçº¿ç¨‹æ± åï¼Œåˆå§‹æ—¶ï¼Œçº¿ç¨‹å¤„äºRUNNINGçŠ¶æ€ è°ƒç”¨shutdown()ï¼Œçº¿ç¨‹æ± å¤„äºSHUTDOWNçŠ¶æ€ï¼Œæ­¤æ—¶çº¿ç¨‹æ± ä¸èƒ½å¤Ÿæ¥å—æ–°çš„ä»»åŠ¡ï¼Œå®ƒä¼šç­‰å¾…æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯• è°ƒç”¨shutdownNow()ï¼Œçº¿ç¨‹æ± å¤„äºSTOPçŠ¶æ€ï¼Œæ­¤æ—¶çº¿ç¨‹æ± ä¸èƒ½æ¥å—æ–°çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¼šå»å°è¯•ç»ˆæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ å½“çº¿ç¨‹æ± å¤„äºSHUTDOWNæˆ–STOPçŠ¶æ€ï¼Œå¹¶ä¸”æ‰€æœ‰å·¥ä½œçº¿ç¨‹å·²ç»é”€æ¯ï¼Œä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å·²ç»æ¸…ç©ºæˆ–æ‰§è¡Œç»“æŸåï¼Œçº¿ç¨‹æ± è¢«è®¾ç½®ä¸ºTERMINATEDçŠ¶æ€ã€‚ ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± ä¹‹åçš„å¤„ç†ç­–ç•¥ å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®å°äºcorePoolSizeï¼Œåˆ™æ¯æ¥ä¸€ä¸ªä»»åŠ¡ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼› å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®&gt;=corePoolSizeï¼Œåˆ™æ¯æ¥ä¸€ä¸ªä»»åŠ¡ï¼Œå°è¯•å°†å…¶æ·»åŠ åˆ°ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å½“ä¸­ï¼Œè‹¥æ·»åŠ æˆåŠŸï¼Œåˆ™è¯¥ä»»åŠ¡ä¼šç­‰å¾…ç©ºé—²çº¿ç¨‹å°†å…¶å–å‡ºæ¥æ‰§è¡Œï¼›è‹¥æ·»åŠ å¤±è´¥ï¼ˆä¸€èˆ¬æ¥è¯´æ˜¯ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å·²æ»¡ï¼‰ï¼Œåˆ™ä¼šå°è¯•åˆ›å»ºæ–°çš„çº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ°maximumPoolSizeï¼Œåˆ™ä¼šé‡‡å–ä»»åŠ¡æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ï¼› å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äºcorePoolSizeæ—¶ï¼Œå¦‚æœæŸçº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡keepAliveTimeï¼Œçº¿ç¨‹å°†è¢«ç»ˆæ­¢ï¼Œç›´è‡³çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®ä¸å¤§äºcorePoolSizeï¼›å¦‚æœå…è®¸ä¸ºæ ¸å¿ƒæ± ä¸­çš„çº¿ç¨‹è®¾ç½®å­˜æ´»æ—¶é—´ï¼Œé‚£ä¹ˆæ ¸å¿ƒæ± ä¸­çš„çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡KeepAliveTimeï¼Œçº¿ç¨‹ä¹Ÿä¼šè¢«ç»ˆæ­¢ é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºçº¿ç¨‹æ± ä¹‹åï¼Œçº¿ç¨‹æ± ä¸­æ˜¯æ²¡æœ‰çº¿ç¨‹çš„ï¼Œéœ€è¦æäº¤ä»»åŠ¡ä¹‹åæ‰ä¼šåˆ›å»ºçº¿ç¨‹ã€‚åœ¨å®é™…ä¸­å¦‚æœéœ€è¦çº¿ç¨‹æ± åˆ›å»ºä¹‹åç«‹å³åˆ›å»ºçº¿ç¨‹ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•åŠåˆ°ï¼š prestartCoreThread()ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼› prestartAllCoreThreads()ï¼šåˆå§‹åŒ–æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹ ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—åŠæ’é˜Ÿç­–ç•¥workQueueï¼Œå®ƒç”¨æ¥å­˜æ”¾ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚workQueueçš„ç±»å‹ä¸ºBlockingQueueï¼Œé€šå¸¸å¯ä»¥å–ä¸‹é¢ä¸‰ç§ç±»å‹ï¼š ArrayBlockingQueueï¼šåŸºäºæ•°ç»„çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—åˆ›å»ºæ—¶å¿…é¡»æŒ‡å®šå¤§å° LinkedBlockingQueueï¼šåŸºäºé“¾è¡¨çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼Œå¦‚æœåˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šæ­¤é˜Ÿåˆ—å¤§å°ï¼Œåˆ™é»˜è®¤ä¸ºInteger.MAX_VALUE synchronousQueueï¼šè¿™ä¸ªé˜Ÿåˆ—æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä¸ä¼šä¿å­˜æäº¤çš„ä»»åŠ¡ï¼Œè€Œæ˜¯å°†ç›´æ¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æ¥çš„ä»»åŠ¡ ä»»åŠ¡æ‹’ç»ç­–ç•¥å½“çº¿ç¨‹æ± çš„ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å·²æ»¡å¹¶ä¸”çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ°maximumPoolSizeï¼Œå¦‚æœè¿˜æœ‰ä»»åŠ¡åˆ°æ¥å°±ä¼šé‡‡å–ä»»åŠ¡æ‹’ç»ç­–ç•¥ã€‚ ThreadPoolExecutor.AbortPolicy:ä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ã€‚ ThreadPoolExecutor.DiscardPolicyï¼šä¹Ÿæ˜¯ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä¸æŠ›å‡ºå¼‚å¸¸ã€‚ ThreadPoolExecutor.DiscardOldestPolicyï¼šä¸¢å¼ƒé˜Ÿåˆ—æœ€å‰é¢çš„ä»»åŠ¡ï¼Œç„¶åé‡æ–°å°è¯•æ‰§è¡Œä»»åŠ¡ï¼ˆé‡å¤æ­¤è¿‡ç¨‹ï¼‰ ThreadPoolExecutor.CallerRunsPolicyï¼šç”±è°ƒç”¨çº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡ çº¿ç¨‹æ± çš„å…³é—­ shutdown()ï¼šä¸ä¼šç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œè€Œæ˜¯è¦ç­‰æ‰€æœ‰ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œåæ‰ç»ˆæ­¢ï¼Œä½†å†ä¹Ÿä¸ä¼šæ¥å—æ–°çš„ä»»åŠ¡ã€‚ shutdownNown()ï¼šç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œå¹¶å°è¯•æ‰“æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶ä¸”æ¸…ç©ºä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ï¼Œè¿”å›å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚ Executorsç±»æä¾›çš„ä¸‰ç§çº¿ç¨‹æ± Executors.newCachedThreadPool(); //åˆ›å»ºä¸€ä¸ªç¼“å†²æ± ï¼Œç¼“å†²æ± å®¹é‡å¤§å°ä¸ºInteger.MAX_VALUEExecutors.newSingleThreadExecutor(); //åˆ›å»ºå®¹é‡ä¸º1çš„ç¼“å†²æ± Executors.newFixedThreadPool(int); //åˆ›å»ºå›ºå®šå®¹é‡å¤§å°çš„ç¼“å†²æ±  newCachedThreadPoolå°†corePoolSizeè®¾ç½®ä¸º0ï¼Œå°†maximumPoolSizeè®¾ç½®ä¸ºInteger.MAX_VALUEï¼Œä½¿ç”¨çš„SynchronousQueueï¼Œä¹Ÿå°±æ˜¯è¯´æ¥äº†ä»»åŠ¡å°±åˆ›å»ºçº¿ç¨‹è¿è¡Œï¼Œå½“çº¿ç¨‹ç©ºé—²è¶…è¿‡60ç§’ï¼Œå°±é”€æ¯çº¿ç¨‹ã€‚ newSingleThreadExecutorå°†corePoolSizeå’ŒmaximumPoolSizeéƒ½è®¾ç½®ä¸º1ï¼Œä¹Ÿä½¿ç”¨çš„LinkedBlockingQueueï¼› newFixedThreadPoolåˆ›å»ºçš„çº¿ç¨‹æ± corePoolSizeå’ŒmaximumPoolSizeå€¼æ˜¯ç›¸ç­‰çš„ï¼Œå®ƒä½¿ç”¨çš„LinkedBlockingQueueï¼› ç±»å‹ æ ¸å¿ƒçº¿ç¨‹æ•° æœ€å¤§çº¿ç¨‹æ•° Keep Alive æ—¶é—´ ä»»åŠ¡é˜Ÿåˆ— ä»»åŠ¡å¤„ç†ç­–ç•¥ CachedThreadPool 0 Integer.MAX_VALUE ä¸€åˆ†é’Ÿ SynchronousQueue çº¿ç¨‹å¯åŠ¨æ•°é‡æ— é™å¤§ï¼Œæ–°ä»»åŠ¡ä¼šç›´æ¥åˆ†é…æˆ–è€…åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ SingleThreadExecutor 1 1 0 LinkedBlockingQueue çº¿ç¨‹æ± çš„å¤§å°ä¸º1ï¼Œé€‚ç”¨äºä¸šåŠ¡é€»è¾‘ä¸Šåªå…è®¸1ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†çš„åœºæ™¯ FixedThreadPool å›ºå®šå¤§å° å›ºå®šå¤§å°ï¼ˆä¸æ ¸å¿ƒçº¿ç¨‹æ•°ç›¸åŒï¼‰ 0 LinkedBlockingQueue çº¿ç¨‹æ± å¤§å°å›ºå®šï¼Œæ²¡æœ‰å¯ç”¨çº¿ç¨‹çš„æ—¶å€™ä»»åŠ¡ä¼šæ”¾å…¥é˜Ÿåˆ—ç­‰å¾…ï¼Œé˜Ÿåˆ—é•¿åº¦æ— é™åˆ¶ åœ¨ThreadPoolExecutorä¸­æä¾›äº†ä¸‰ä¸ªä¸“é—¨ä¾›å­ç±»è¦†ç›–/é‡å†™çš„æ–¹æ³•ï¼šbeforeExecute(Thread t, Runnable r)ã€afterExecute(Runnable r, Throwable t)å’Œterminated()ã€‚ beforeExecuteï¼šå½“çº¿ç¨‹æ± æ­£è¦å¼€å§‹æ‰§è¡ŒæŸä¸ªä»»åŠ¡çš„æ—¶å€™ï¼ˆæ³¨æ„ä¸æ˜¯ä»»åŠ¡è¿›å…¥ç­‰å¾…é˜Ÿåˆ—çš„æ—¶å€™ï¼Œæ˜¯å°†è¦å¼€å§‹æ­£å¼åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„æ—¶å€™ï¼‰ï¼Œçº¿ç¨‹æ± ä¼šè§¦å‘è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨ã€‚ afterExecuteï¼šå½“çº¿ç¨‹æ± å®Œæˆäº†æŸä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œåï¼Œçº¿ç¨‹æ± å°±ä¼šè§¦å‘è¿™ä¸ªæ–¹æ³•ã€‚ terminatedï¼šå½“çº¿ç¨‹æ± æœ¬èº«åœæ­¢æ‰§è¡Œçš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ã€‚ ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚ æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ å‚è€ƒ Javaå¹¶å‘ç¼–ç¨‹ï¼šçº¿ç¨‹æ± çš„ä½¿ç”¨ Javaå¤šçº¿ç¨‹ä¹‹Callableæ¥å£åŠçº¿ç¨‹æ±  äººäººéƒ½èƒ½æŒæ¡çš„JavaæœåŠ¡ç«¯æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ javaé”ä¼˜åŒ–çš„æ–¹æ³•ä¸æ€è·¯-å‡å°‘é”æŒæœ‰æ—¶é—´ã€å‡å°é”ç²’åº¦ã€é”åˆ†ç¦»ã€é”ç²—åŒ–ã€é”æ¶ˆé™¤","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/categories/å¤šçº¿ç¨‹/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"javaåŸºç¡€æ€»ç»“","slug":"javaåŸºç¡€æ€»ç»“","date":"2018-04-09T13:28:54.000Z","updated":"2018-05-02T04:32:48.586Z","comments":true,"path":"2018/04/09/javaåŸºç¡€æ€»ç»“/","link":"","permalink":"https://hsb786.github.io/2018/04/09/javaåŸºç¡€æ€»ç»“/","excerpt":"åˆå§‹åŒ–é¡ºåº çˆ¶ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ å­ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆæ„é€ æ–¹æ³•ï¼‰ å­ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ å­ç±»ï¼ˆæ„é€ æ–¹æ³•ï¼‰","text":"åˆå§‹åŒ–é¡ºåº çˆ¶ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ å­ç±»ï¼ˆé™æ€å˜é‡ï¼Œé™æ€è¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ çˆ¶ç±»ï¼ˆæ„é€ æ–¹æ³•ï¼‰ å­ç±»ï¼ˆå®ä¾‹å˜é‡ï¼Œæ™®é€šè¯­å¥å—ï¼‰ å­ç±»ï¼ˆæ„é€ æ–¹æ³•ï¼‰ Object123456789101112131415161718192021public final native Class&lt;?&gt; getClass()public native int hashCode()public boolean equals(Object obj)protected native Object clone() throws CloneNotSupportedExceptionpublic String toString()public final native void notify()public final native void notifyAll()public final native void wait(long timeout) throws InterruptedExceptionpublic final void wait(long timeout, int nanos) throws InterruptedExceptionpublic final void wait() throws InterruptedExceptionprotected void finalize() throws Throwable &#123;&#125; åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ ç›´æ¥new åå°„ ä½¿ç”¨Classç±»çš„newInstance åªèƒ½è°ƒç”¨æ— å‚æ„é€ å‡½æ•° ä½¿ç”¨Constructorçš„newInstance å¯ä»¥è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•° clone ä¸ä¼šè°ƒç”¨ä»»ä½•æ„é€ å‡½æ•° ååºåˆ—åŒ– ä¸ä¼šè°ƒç”¨ä»»ä½•æ„é€ å‡½æ•° åŠ¨æ€è·å–ç±»çš„æ–¹å¼ ç±»å.class å¯¹è±¡å.getClass Class.forName(â€œç±»åâ€) æ³›å‹(generics)å…è®¸åœ¨å®šä¹‰ç±»å’Œæ¥å£çš„æ—¶å€™ä½¿ç”¨ç±»å‹å‚æ•°E(type parameter)ã€‚å£°æ˜çš„ç±»å‹å‚æ•°åœ¨ä½¿ç”¨æ—¶ç”¨å…·ä½“çš„ç±»å‹æ¥æ›¿æ¢ã€‚ javaé›†åˆæœ‰ä¸€ä¸ªç¼ºç‚¹æ˜¯å½“æŠŠä¸€ä¸ªå¯¹è±¡æ”¾å…¥é›†åˆé‡Œé¢ä¹‹åï¼Œé›†åˆå°±ä¼šâ€å¿˜è®°â€è¿™ä¸ªå¯¹è±¡çš„æ•°æ®ç±»å‹ï¼Œå½“å†æ¬¡å–å‡ºè¯¥å¯¹è±¡çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡çš„ç¼–è¯‘ç±»å‹å°±å˜æˆäº†Objectç±»å‹(è¯¥å¯¹è±¡çš„è¿è¡Œæ—¶ç±»å‹æ²¡å˜)ã€‚ é€ æˆçš„é—®é¢˜ï¼š é›†åˆå¯¹å…ƒç´ ç±»å‹æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œè¿™æ ·ä¼šå¼•å‘ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæƒ³åˆ›å»ºä¸€ä¸ªä¿å­˜Dogå¯¹è±¡çš„é›†åˆï¼Œä½†æ˜¯ç¨‹åºä¹Ÿå¯ä»¥è½»æ˜“çš„æŠŠCatå¯¹è±¡ä¿å­˜è¿›å»ï¼Œæ‰€ä»¥ä¼šå¼•å‘å¼‚å¸¸ã€‚ ç”±äºæŠŠå¯¹è±¡ä¿å­˜åˆ°é›†åˆé‡Œé¢æ—¶ï¼Œé›†åˆä¸¢å¤±äº†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œé›†åˆåªçŸ¥é“å®ƒç››è£…çš„æ˜¯Objectï¼Œå› æ­¤å–å‡ºé›†åˆå…ƒç´ ä¹‹åé€šå¸¸è¿˜éœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚è¿™ç§å¼ºåˆ¶ç±»å‹è½¬æ¢å³å¢åŠ äº†ç¼–ç¨‹çš„å¤æ‚åº¦ï¼Œä¹Ÿå¯èƒ½å¼•å‘ç±»å‹è½¬æ¢ClassCastExceptionå¼‚å¸¸ã€‚ åœ¨Java7ä»¥å‰ï¼Œå¦‚æœä½¿ç”¨å¸¦æœ‰æ³›å‹çš„æ¥å£ï¼Œç±»å®šä¹‰å¸¸é‡ï¼Œé‚£ä¹ˆè°ƒç”¨æ„é€ å™¨åˆ›å»ºå¯¹è±¡æ—¶æ„é€ å™¨çš„åé¢ä¹Ÿå¿…é¡»å¸¦æ³›å‹ï¼Œè¿™æ˜¾å¾—æœ‰äº›å¤šä½™äº†ã€‚ ä»java7å¼€å§‹ï¼Œjavaå…è®¸åœ¨æ„é€ å™¨åä¸éœ€è¦å¸¦å®Œæ•´çš„æ³›å‹ä¿¡æ¯ï¼Œåªè¦ç»™å‡ºä¸€å¯¹å°–æ‹¬å·(&lt;&gt;)å³å¯ï¼ŒJavaå¯ä»¥æ¨æ–­æ‹¬å·é‡Œé¢åº”è¯¥æ˜¯ä»€ä¹ˆæ³›å‹ä¿¡æ¯ã€‚ 12List&lt;String&gt; strList=new ArrayList&lt;&gt;();Map&lt;String,Integer&gt; scores=new HashMap&lt;&gt;(); - æœ¯è¯­ ArrayList&lt;E> æ³›å‹ç±»å‹ ArrayList åŸå§‹ç±»å‹ E å‚æ•°ç±»å‹ &lt;&gt; è¯»ä½œâ€typeofâ€ ArrayList å‚æ•°åŒ–çš„ç±»å‹ Integer å®é™…ç±»å‹å‚æ•° â€œ?â€ é€šé…ç¬¦ï¼Ÿè¡¨ç¤ºä»»æ„ç±»å‹ï¼Œä½¿ç”¨ï¼Ÿé€šé…ç¬¦å¯ä»¥å¼•ç”¨å„ç§å‚æ•°åŒ–çš„ç±»å‹ é™å®šé€šé…ç¬¦çš„ä¸Šè¾¹ç•ŒArrayList&lt;? extends Number&gt; collection=new ArrayList(); é™å®šé€šé…ç¬¦çš„ä¸‹è¾¹ç•ŒArrayList&lt;? super Integer&gt; collection=new ArrayList(); â€œæ“¦é™¤â€æ³›å‹æ˜¯æä¾›ç»™javacç¼–è¯‘å™¨ä½¿ç”¨çš„ï¼Œé™å®šé›†åˆçš„è¾“å…¥ç±»å‹ï¼Œç¼–è¯‘å™¨ç¼–è¯‘å¸¦ç±»å‹è¯´æ˜çš„é›†åˆæ—¶ä¼šå»æ‰â€œç±»å‹â€ä¿¡æ¯ã€‚ å¤šæ€å­˜åœ¨çš„ä¸‰ä¸ªæ¡ä»¶ æœ‰ç»§æ‰¿å…³ç³» å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³• çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ ä»¥ä¸‹ä¸‰ç§ç±»å‹çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼š staticæ–¹æ³•ã€‚è¢«staticä¿®é¥°çš„æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œè€Œä¸æ˜¯å±äºå®ä¾‹çš„ finalæ–¹æ³•ã€‚è¢«finalä¿®é¥°çš„æ–¹æ³•æ˜¯æ— æ³•è¢«å­ç±»é‡å†™ privateæ–¹æ³•ã€‚è¢«privateä¿®é¥°çš„æ–¹æ³•å¯¹å­ç±»ä¸å¯è§ï¼Œ å¤šæ€çš„åˆ†ç±» ç¼–è¯‘æ—¶å¤šæ€ï¼Œå³æ–¹æ³•çš„é‡è½½ è¿è¡Œæ—¶å¤šæ€ï¼Œå³æ–¹æ³•çš„é‡å†™ throwå’Œthrowsthrow: è¡¨ç¤ºæŠ›å‡ºä¸€ä¸ªç±»çš„å®ä¾‹ã€‚throwå…³é”®å­—å¯ä»¥å†™åœ¨ä»»ä½•åœ°æ–¹ï¼Œå¹¶ä¸å¼ºåˆ¶å¿…é¡»å†™åœ¨catchå—ä¸­ï¼Œè¿è¡Œåˆ°throwæ‰€åœ¨çš„è¡Œï¼Œæ‰“å°å¼‚å¸¸å¹¶ç«‹å³é€€å‡ºå½“å‰æ–¹æ³•ã€‚ throws: ç”¨äºæ–¹æ³•å£°æ˜ï¼ŒæŒ‡æ˜å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ã€‚ tryèƒ½å•ç‹¬å’Œfinallyä¸€èµ·ä½¿ç”¨å¼‚å¸¸Throwableå¯ä»¥ç”¨æ¥è¡¨ç¤ºä»»ä½•å¯ä»¥ä½œä¸ºå¼‚å¸¸æŠ›å‡ºçš„ç±»ï¼Œåˆ†ä¸ºä¸¤ç§ï¼šErrorå’ŒExceptionã€‚å…¶ä¸­Errorç”¨æ¥è¡¨ç¤ºJVMæ— æ³•å¤„ç†çš„é”™è¯¯ï¼ŒExceptionåˆ†ä¸ºä¸¤ç§ï¼š å—æ£€å¼‚å¸¸ï¼ˆchecked exceptionï¼‰ï¼šéœ€è¦tryâ€¦catchâ€¦è¯­å¥æ•è·å¹¶è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸”å¯ä»¥ä»å¼‚å¸¸æ¢å¤ éå—æ£€å¼‚å¸¸ï¼ˆunchecked exceptionï¼‰ï¼šæ˜¯ç¨‹åºè¿è¡Œæ—¶é”™è¯¯ï¼Œä¾‹å¦‚é™¤0ä¼šå¼•å‘Arithmetic Exceptinoï¼Œæ­¤æ—¶ç¨‹åºå´©æºƒå¹¶ä¸”æ— æ³•æ¢å¤ Stringç±»çš„equalsæ–¹æ³•ï¼Œä¸å…¶å®ƒç±»å‹æ¯”è¾ƒè¿”å›falseã€‚å…¶ä»–åŒ…è£…ç±»ä¹Ÿä¸€æ ·ã€‚ public boolean equals(Object anObject) public static native void arraycopy(Object src, int srcPos,Object dest, int destPos, int length); int[] arr={0,1,2,3,4,5,6,7};System.arraycopy(arr,0,arr,1,2); //ç»“æœarr={0,0,1,3,4,5,6,7}; 1&lt;&lt;2=4 äºŒè¿›åˆ¶å‘å·¦ç§»4&gt;&gt;&gt;1=2 äºŒè¿›åˆ¶å‘å³ç§»","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"é•¿æœŸæ›´æ–°","slug":"é•¿æœŸæ›´æ–°","permalink":"https://hsb786.github.io/tags/é•¿æœŸæ›´æ–°/"}]},{"title":"å¤šçº¿ç¨‹åŸºç¡€","slug":"å¤šçº¿ç¨‹åŸºç¡€","date":"2018-04-09T13:03:41.000Z","updated":"2018-04-24T08:17:51.478Z","comments":true,"path":"2018/04/09/å¤šçº¿ç¨‹åŸºç¡€/","link":"","permalink":"https://hsb786.github.io/2018/04/09/å¤šçº¿ç¨‹åŸºç¡€/","excerpt":"çº¿ç¨‹é—´é€šä¿¡çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­ç‹¬ç«‹çš„ä¸ªä½“ï¼Œä½†è¿™äº›ä¸ªä½“å¦‚æœä¸ç»è¿‡ç‰¹æ®Šå¤„ç†å°±ä¸èƒ½æˆä¸ºä¸€ä¸ªæ•´ä½“ã€‚åœ¨çº¿ç¨‹é—´è¿›è¡Œé€šä¿¡åï¼Œç³»ç»Ÿä¹‹é—´çš„äº¤äº’æ€§ä¼šæ›´åŠ å¼ºå¤§ï¼Œåœ¨å¤§å¤§æé«˜CPUåˆ©ç”¨ç‡çš„åŒæ—¶è¿˜ä¼šä½¿ç¨‹åºå‘˜å¯¹å„çº¿ç¨‹ä»»åŠ¡åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­è¿›è¡Œæœ‰æ•ˆçš„æŠŠæ§ä¸ç›‘ç£ã€‚","text":"çº¿ç¨‹é—´é€šä¿¡çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­ç‹¬ç«‹çš„ä¸ªä½“ï¼Œä½†è¿™äº›ä¸ªä½“å¦‚æœä¸ç»è¿‡ç‰¹æ®Šå¤„ç†å°±ä¸èƒ½æˆä¸ºä¸€ä¸ªæ•´ä½“ã€‚åœ¨çº¿ç¨‹é—´è¿›è¡Œé€šä¿¡åï¼Œç³»ç»Ÿä¹‹é—´çš„äº¤äº’æ€§ä¼šæ›´åŠ å¼ºå¤§ï¼Œåœ¨å¤§å¤§æé«˜CPUåˆ©ç”¨ç‡çš„åŒæ—¶è¿˜ä¼šä½¿ç¨‹åºå‘˜å¯¹å„çº¿ç¨‹ä»»åŠ¡åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­è¿›è¡Œæœ‰æ•ˆçš„æŠŠæ§ä¸ç›‘ç£ã€‚ é”é˜Ÿåˆ—æ¯ä¸ªé”å¯¹è±¡éƒ½æœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯å°±ç»ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯é˜»å¡é˜Ÿåˆ—ã€‚å°±ç»ªé˜Ÿåˆ—å­˜å‚¨äº†å°†è¦è·å¾—é”çš„çº¿ç¨‹ï¼Œé˜»å¡é˜Ÿåˆ—å­˜å‚¨äº†è¢«é˜»å¡çš„çº¿ç¨‹ã€‚ä¸€ä¸ªçº¿ç¨‹è¢«å”¤é†’åï¼Œæ‰ä¼šè¿›å…¥å°±ç»ªé˜Ÿåˆ—ï¼Œç­‰å¾…CPUçš„è°ƒåº¦ï¼›åä¹‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¢«waitåï¼Œå°±ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¢«å”¤é†’ã€‚ å¤šçº¿ç¨‹å¯¹è±¡çš„å¸¸ç”¨å‡½æ•° Thread.currentThread()æ–¹æ³•è¿”å›ä»£ç æ®µæ­£åœ¨è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„ä¿¡æ¯ Threadå¯¹è±¡å®ä¾‹.isAlive()æ–¹æ³•çš„åŠŸèƒ½æ˜¯åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦å¤„äºæ´»è·ƒçŠ¶æ€(æ­£åœ¨è¿è¡ŒçŠ¶æ€æˆ–è€…å‡†å¤‡å¼€å§‹è¿è¡ŒçŠ¶æ€) Thread.sleep()æ–¹æ³•çš„ä½œç”¨æ˜¯åœ¨æŒ‡å®šçš„æ¯«ç§’æ•°å†…è®©â€å½“å‰æ‰§è¡Œçš„çº¿ç¨‹â€ä¼‘çœ (æš‚åœæ‰§è¡Œ) getId()æ–¹æ³•å¯ä»¥è·å–çº¿ç¨‹çš„å”¯ä¸€æ ‡è¯† yield()æ–¹æ³•çš„ä½œç”¨æ˜¯æ”¾å¼ƒå½“å‰çš„CPUèµ„æºï¼Œå°†å®ƒè®©ç»™å…¶ä»–çš„ä»»åŠ¡å»å ç”¨CPUæ‰§è¡Œæ—¶é—´ã€‚å½“æ”¾å¼ƒçš„æ—¶é—´ä¸ç¡®å®šï¼Œæœ‰å¯èƒ½åˆšåˆšæ”¾å¼ƒï¼Œé©¬ä¸Šåˆè·å–CPUæ—¶é—´ç‰‡ã€‚ å¯¹è±¡é”ä½•æ—¶ä¼šè¢«é‡Šæ”¾ æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å— åœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¼‚å¸¸è€Œå¯¼è‡´çº¿ç¨‹ç»ˆæ­¢ åœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å—çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†é”æ‰€å±å¯¹è±¡çš„wait()æ–¹æ³•ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šé‡Šæ”¾é”ï¼Œè¿›è¡Œå¯¹è±¡çš„ç­‰å¾…æ±  å¦‚ä½•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¤„äºåœæ­¢çŠ¶æ€ Thread.interrupted():æµ‹è¯•å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»ä¸­æ–­ï¼Œstaticæ–¹æ³•ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•åçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€è¢«æ¸…é™¤ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœè¿ç»­ï¼’æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™ç¬¬äºŒæ¬¡è°ƒç”¨å°†è¿”å›falseã€‚ this.isInterrupted():æµ‹è¯•çº¿ç¨‹Threadå¯¹è±¡å®ä¾‹æ˜¯å¦å·²ç»ä¸­æ–­ï¼Œéstaticæ–¹æ³•ï¼Œä¸æ¸…é™¤çŠ¶æ€æ ‡è¯† è°ƒç”¨interrupt()æ–¹æ³•ä¸ä¼šçœŸçš„åœæ­¢çº¿ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰“äº†ä¸€ä¸ªåœæ­¢çš„æ ‡è®°ï¼Œè¿˜éœ€è¦é…åˆå…¶ä»–çš„ä»£ç æ¥åœæ­¢çº¿ç¨‹ã€‚ å…³äºCallableå’ŒFutureCallableæ¥å£ä½¿ç”¨æ³›å‹å»å®šä¹‰å®ƒçš„è¿”å›ç±»å‹ã€‚Executorsç±»æä¾›äº†ä¸€äº›æœ‰ç”¨çš„æ–¹æ³•å»åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡ŒCallableå†…çš„ä»»åŠ¡ã€‚ç”±äºCallableä»»åŠ¡æ˜¯å¹¶è¡Œçš„ï¼Œæˆ‘ä»¬å¿…é¡»ç­‰å¾…å®ƒè¿”å›çš„ç»“æœã€‚java.util.concurrent.Futureå¯¹è±¡ä¸ºæˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åœ¨çº¿ç¨‹æ± æäº¤Callableä»»åŠ¡åè¿”å›äº†ä¸€ä¸ªFutureå¯¹è±¡ï¼Œä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»¥çŸ¥é“Callableä»»åŠ¡çš„çŠ¶æ€å’Œå¾—åˆ°Callableè¿”å›çš„æ‰§è¡Œç»“æœã€‚Futureæä¾›äº†get()æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥ç­‰å¾…Callableç»“æŸå¹¶è·å–å®ƒçš„æ‰§è¡Œç»“æœã€‚ Futureæä¾›äº†ä¸‰ç§åŠŸèƒ½ï¼š åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å®Œæˆ èƒ½å¤Ÿä¸­æ–­ä»»åŠ¡ èƒ½å¤Ÿè·å–æ‰§è¡Œç»“æœ Futureå¯¹è±¡æä¾›äº†å¼‚æ­¥æ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ— éœ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œçš„å®Œæˆï¼Œåªè¦æäº¤éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶åå†éœ€è¦æ—¶æ£€æŸ¥Futureæ˜¯å¦å·²ç»æœ‰äº†ç»“æœï¼Œå¦‚æœä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡Future.get()æ–¹æ³•è·å¾—æ‰§è¡Œç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒFuture.get()æ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡å¼çš„æ–¹æ³•ï¼Œå¦‚æœè°ƒç”¨æ—¶ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œä¼šç­‰å¾…ç›´åˆ°ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚ FutureTask123456789public class FutureTask&lt;V&gt; implements RunnableFuture&lt;V&gt; public interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; &#123; /** * Sets this Future to the result of its computation * unless it has been cancelled. */ void run();&#125; FutureTaskæ—¢å¯ä»¥åšä¸ºRunnableè¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸ºFutureå¾—åˆ°Callableçš„è¿”å›å€¼ å®ˆæŠ¤çº¿ç¨‹å®ˆæŠ¤çº¿ç¨‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿ç¨‹ï¼Œå½“è¿›ç¨‹ä¸­ä¸å­˜åœ¨éå®ˆæŠ¤çº¿ç¨‹äº†ï¼Œå®ˆæŠ¤çº¿ç¨‹å°±è‡ªåŠ¨é”€æ¯ã€‚å…¸å‹çš„å®ˆæŠ¤çº¿ç¨‹å°±æ˜¯åƒåœ¾å›æ”¶çº¿ç¨‹ï¼Œå½“è¿›ç¨‹ä¸­æ²¡æœ‰éå®ˆæŠ¤çº¿ç¨‹äº†ï¼Œåˆ™åƒåœ¾å›æ”¶çº¿ç¨‹ä¹Ÿå°±æ²¡æœ‰å­˜åœ¨çš„å¿…è¦äº†ï¼Œè‡ªåŠ¨é”€æ¯ã€‚Deamonçš„ä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯GC(åƒåœ¾å›æ”¶å™¨)ã€‚ å¯¹è±¡åŠå˜é‡çš„å¹¶å‘è®¿é—®â€œéçº¿ç¨‹å®‰å…¨â€å…¶å®ä¼šåœ¨å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå¯¹è±¡ä¸­çš„å®ä¾‹å˜é‡è¿›è¡Œå¹¶å‘è®¿é—®æ—¶å‘ç”Ÿï¼Œäº§ç”Ÿçš„åæœå°±æ˜¯â€è„è¯»â€ï¼Œä¹Ÿå°±æ˜¯å–åˆ°çš„æ•°æ®å…¶å®æ˜¯è¢«æ›´æ”¹è¿‡çš„ã€‚è€Œâ€çº¿ç¨‹å®‰å…¨â€è·å¾—çš„å®ä¾‹å˜é‡çš„å€¼æ˜¯ç»è¿‡åŒæ­¥å¤„ç†çš„ï¼Œä¸ä¼šå‡ºç°â€è„è¯»â€çš„ç°è±¡ã€‚ æ–¹æ³•å†…çš„ç§æœ‰å˜é‡â€œéçº¿ç¨‹å®‰å…¨â€é—®é¢˜å­˜åœ¨äºâ€å®ä¾‹å˜é‡â€ï¼Œå¦‚æœæ˜¯æ–¹æ³•å†…éƒ¨çš„ç§æœ‰å˜é‡ï¼Œåˆ™ä¸å­˜åœ¨â€éçº¿ç¨‹å®‰å…¨â€é—®é¢˜ï¼Œæ°¸è¿œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ˜¯æ–¹æ³•å†…éƒ¨çš„å˜é‡æ˜¯ç§æœ‰(ä½œç”¨åŸŸ)çš„ç‰¹æ€§é€ æˆçš„ã€‚ é”å…³é”®å­—synchronizedå–å¾—çš„é”éƒ½æ˜¯å¯¹è±¡é”ï¼Œè€Œä¸æ˜¯æŠŠä¸€æ®µä»£ç æˆ–è€…æ–¹æ³•(å‡½æ•°)å½“ä½œé”ï¼Œå“ªä¸ªçº¿ç¨‹å…ˆæ‰§è¡Œå¸¦synchronizedå…³é”®å­—çš„æ–¹æ³•ï¼Œå“ªä¸ªçº¿ç¨‹å°±æŒæœ‰è¯¥æ–¹æ³•æ‰€å±å¯¹è±¡çš„é”Lockï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹åªèƒ½å‘ˆç°ç­‰å¾…çŠ¶æ€ï¼Œå‰ææ˜¯å¤šä¸ªçº¿ç¨‹è®¿é—®çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹è®¿é—®å¤šä¸ªå¯¹è±¡ï¼Œåˆ™JVMä¼šåˆ›å»ºå¤šä¸ªé”ã€‚ â€œå¯é‡å…¥é”â€:å½“æœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡æƒ³è¦è·å¾—è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ã€‚ç‰¹åˆ«çš„è¯´æ˜ï¼Œå½“å­˜åœ¨çˆ¶å­ç±»ç»§æ‰¿å…³ç³»æ—¶ï¼Œå­ç±»æ˜¯å®Œå…¨å¯ä»¥é€šè¿‡â€å¯é‡å…¥é”â€è°ƒç”¨çˆ¶ç±»çš„åŒæ­¥æ–¹æ³•çš„ã€‚ é™æ€åŒæ­¥synchronizedæ–¹æ³•ä¸synchronized(class)ä»£ç å—å…³é”®å­—synchronizedè¿˜å¯ä»¥åº”ç”¨åœ¨staticé™æ€æ–¹æ³•ä¸Šï¼Œå¦‚æœè¿™æ ·å†™ï¼Œé‚£æ˜¯å¯¹å½“å‰çš„.javaæ–‡ä»¶å¯¹åº”çš„Classç±»è¿›è¡ŒæŒé”ã€‚synchronizedå…³é”®å­—åŠ åˆ°staticé™æ€æ–¹æ³•ä¸Šæ˜¯ç»™Classç±»ä¸Šé”ï¼Œå¯ä»¥å¯¹ç±»çš„æ‰€æœ‰å¯¹è±¡å®ä¾‹èµ·ä½œç”¨ï¼Œè€Œsynchronizedå…³é”®å­—åŠ åˆ°éstaticé™æ€æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡ä¸Šé”ï¼Œè¿™2ä¸ªé”ä¸æ˜¯åŒä¸€ä¸ªé”ã€‚synchronized(class)ä»£ç å—çš„ä½œç”¨å…¶å®å’Œsynchronized staticæ–¹æ³•çš„ä½œç”¨ä¸€æ ·ã€‚æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsynchronized(ClassName)ä¸synchronized(ClassNameçš„å®ä¾‹)ï¼Œçº¿ç¨‹å„è‡ªè·å–å„è‡ªçš„é”ï¼Œä¸ä¼šæœ‰ç­‰å¾…ã€‚ æ³¨æ„:æˆ‘ä»¬åœ¨å°†ä»»ä½•æ•°æ®ç±»å‹ä½œä¸ºåŒæ­¥é”æ—¶ï¼Œéœ€è¦è§‚å¯Ÿï¼Œæ˜¯å¦æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶æŒæœ‰é”å¯¹è±¡ï¼Œå¦‚æœåŒæ—¶æŒæœ‰ç›¸åŒçš„é”å¯¹è±¡ï¼Œåˆ™è¿™äº›çº¿ç¨‹ä¹‹é—´å°±æ˜¯åŒæ­¥çš„ï¼›å¦‚æœåˆ†åˆ«è·å¾—é”å¯¹è±¡ï¼Œå°±æ˜¯å¼‚æ­¥çš„ã€‚ volatileå…³é”®å­—volatileçš„ä¸»è¦ä½œç”¨æ˜¯ä½¿å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹é—´å¯è§ã€‚ç®€å•åœ°è¯´å°±æ˜¯å½“çº¿ç¨‹Aå¯¹å˜é‡Xè¿›è¡Œäº†ä¿®æ”¹åï¼Œåœ¨çº¿ç¨‹Aåé¢æ‰§è¡Œçš„å…¶ä»–çº¿ç¨‹èƒ½çœ‹åˆ°å˜é‡Xçš„å˜åŠ¨ã€‚åŒæ—¶å…³é”®å­—synchronizedä¹Ÿå¯ä»¥åŒæ ·çš„å®Œæˆvolatileå…³é”®å­—å¯è§æ€§çš„åŠŸèƒ½ã€‚(happens-before) ThreadLocalç±»ThreadLocalä¸»è¦è§£å†³çš„å°±æ˜¯æ¯ä¸ªçº¿ç¨‹ç»‘å®šè‡ªå·±çš„å€¼ï¼Œå¯ä»¥å°†ThreadLocalç±»æ¯”å–»æˆå…¨å±€å­˜æ”¾æ•°æ®çš„ç›’å­ï¼Œç›’å­ä¸­å¯ä»¥å­˜å‚¨æ¯ä¸ªçº¿ç¨‹çš„ç§æœ‰æ•°æ®ã€‚ ç±»Threadlocalè§£å†³çš„æ˜¯å˜é‡åœ¨ä¸åŒçº¿ç¨‹é—´çš„éš”ç¦»æ€§ï¼Œä¹Ÿå°±æ˜¯ä¸åŒçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„å€¼ï¼Œä¸åŒçº¿ç¨‹ä¸­çš„å€¼æ˜¯å¯ä»¥æ”¾å…¥Threadlocalç±»ä¸­è¿›è¡Œä¿å­˜çš„ã€‚ å…¬å¹³é”ä¸éå…¬å¹³é”å…¬å¹³ä¸éå…¬å¹³é”ï¼šé”Lockåˆ†ä¸ºâ€å…¬å¹³é”â€å’Œâ€éå…¬å¹³é”â€ï¼Œå…¬å¹³é”è¡¨ç¤ºçº¿ç¨‹è·å–é”çš„é¡ºåºæ˜¯æŒ‰ç…§çº¿ç¨‹åŠ é”çš„é¡ºåºæ¥åˆ†é…çš„ï¼Œå³å…ˆæ¥å…ˆå¾—çš„FIFOå…ˆè¿›å…ˆå‡ºé¡ºåºã€‚è€Œéå…¬å¹³é”å°±æ˜¯ä¸€ç§è·å–é”çš„æŠ¢å æœºåˆ¶ï¼Œæ˜¯éšæœºè·å¾—é”çš„ï¼Œå’Œå…¬å¹³é”ä¸ä¸€æ ·çš„å°±æ˜¯å…ˆæ¥çš„ä¸ä¸€å®šå…ˆå¾—åˆ°é”ï¼Œè¿™ä¸ªæ–¹å¼å¯èƒ½é€ æˆæŸäº›çº¿ç¨‹ä¸€ç›´æ‹¿ä¸åˆ°é”ï¼Œç»“æœå°±æ˜¯ä¸å…¬å¹³çš„äº†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReentrantLockç±»ä½¿ç”¨çš„æ˜¯éå…¬å¹³é”ã€‚ ReentrantReadWriteLockç±»ReentrantLockå…·æœ‰å®Œå…¨äº’æ–¥æ’ä»–çš„æ•ˆæœï¼Œå³åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡ŒReentrantLock.lock()æ–¹æ³•åé¢çš„ä»»åŠ¡ã€‚è¿™æ ·åšè™½ç„¶ä¿è¯äº†å®ä¾‹å˜é‡çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œä½†æ•ˆç‡å´æ˜¯éå¸¸ä½ä¸‹çš„ã€‚æ‰€ä»¥åœ¨JDKä¸­æä¾›äº†ä¸€ç§è¯»å†™é”ReentrantReadWriteLockç±»ï¼Œä½¿ç”¨å®ƒå¯ä»¥åŠ å¿«è¿è¡Œæ•ˆç‡ã€‚ è¯»å†™é”è¡¨ç¤ºä¹Ÿæœ‰ä¸¤ä¸ªé”ï¼Œä¸€ä¸ªæ˜¯è¯»æ“ä½œç›¸å…³çš„é”ï¼Œä¹Ÿç§°ä¸ºå…±äº«é”ï¼›å¦ä¸€ä¸ªæ˜¯å†™æ“ä½œç›¸å…³çš„é”ï¼Œä¹Ÿå«æ’ä»–é”ã€‚ä¹Ÿå°±æ˜¯å¤šä¸ªè¯»é”ä¹‹é—´ä¸äº’æ–¥ï¼Œè¯»é”ä¸å†™é”äº’æ–¥ï¼Œå†™é”ä¸å†™é”äº’æ–¥ã€‚åœ¨æ²¡æœ‰çº¿ç¨‹Threadè¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œè¿›è¡Œè¯»å–æ“ä½œçš„å¤šä¸ªThreadéƒ½å¯ä»¥è·å–è¯»é”ï¼Œè€Œè¿›è¡Œå†™å…¥æ“ä½œçš„çº¿ç¨‹Threadåªæœ‰åœ¨è·å–å†™é”åæ‰èƒ½è¿›è¡Œå†™å…¥æ“ä½œã€‚å³å¤šä¸ªThreadå¯ä»¥åŒæ—¶è¿›è¡Œè¯»å–æ“ä½œï¼Œä½†æ˜¯åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªThreadè¿›è¡Œå†™å…¥æ“ä½œã€‚ ç®€å•å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354public class ReadWriteLock &#123; private int readThreadCounter = 0; // æ­£åœ¨è¯»å–çš„çº¿ç¨‹æ•°ï¼ˆ0ä¸ªæˆ–å¤šä¸ªï¼‰ private int waitingWriteCounter = 0; // ç­‰å¾…å†™å…¥çš„çº¿ç¨‹æ•°ï¼ˆ0ä¸ªæˆ–å¤šä¸ªï¼‰ private int writeThreadCounter = 0; // æ­£åœ¨å†™å…¥çš„çº¿ç¨‹æ•°ï¼ˆ0ä¸ªæˆ–1ä¸ªï¼‰ private boolean writeFlag = true; // æ˜¯å¦å¯¹å†™å…¥ä¼˜å…ˆï¼ˆé»˜è®¤ä¸ºæ˜¯ï¼‰ // è¯»å–åŠ é” public synchronized void readLock() throws InterruptedException &#123; // è‹¥å­˜åœ¨æ­£åœ¨å†™å…¥çš„çº¿ç¨‹ï¼Œæˆ–å½“å†™å…¥ä¼˜å…ˆæ—¶å­˜åœ¨ç­‰å¾…å†™å…¥çš„çº¿ç¨‹ï¼Œåˆ™å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºç­‰å¾…çŠ¶æ€ while (writeThreadCounter &gt; 0 || (writeFlag &amp;&amp; waitingWriteCounter &gt; 0)) &#123; wait(); &#125; // ä½¿æ­£åœ¨è¯»å–çš„çº¿ç¨‹æ•°åŠ ä¸€ readThreadCounter++; &#125; // è¯»å–è§£é” public synchronized void readUnlock() &#123; // ä½¿æ­£åœ¨è¯»å–çš„çº¿ç¨‹æ•°å‡ä¸€ readThreadCounter--; // è¯»å–ç»“æŸï¼Œå¯¹å†™å…¥ä¼˜å…ˆ writeFlag = true; // é€šçŸ¥æ‰€æœ‰å¤„äº wait çŠ¶æ€çš„çº¿ç¨‹ notifyAll(); &#125; // å†™å…¥åŠ é” public synchronized void writeLock() throws InterruptedException &#123; // ä½¿ç­‰å¾…å†™å…¥çš„çº¿ç¨‹æ•°åŠ ä¸€ waitingWriteCounter++; try &#123; // è‹¥å­˜åœ¨æ­£åœ¨è¯»å–çš„çº¿ç¨‹ï¼Œæˆ–å­˜åœ¨æ­£åœ¨å†™å…¥çš„çº¿ç¨‹ï¼Œåˆ™å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºç­‰å¾…çŠ¶æ€ while (readThreadCounter &gt; 0 || writeThreadCounter &gt; 0) &#123; wait(); &#125; &#125; finally &#123; // ä½¿ç­‰å¾…å†™å…¥çš„çº¿ç¨‹æ•°å‡ä¸€ waitingWriteCounter--; &#125; // ä½¿æ­£åœ¨å†™å…¥çš„çº¿ç¨‹æ•°åŠ ä¸€ writeThreadCounter++; &#125; // å†™å…¥è§£é” public synchronized void writeUnlock() &#123; // ä½¿æ­£åœ¨å†™å…¥çš„çº¿ç¨‹æ•°å‡ä¸€ writeThreadCounter--; // å†™å…¥ç»“æŸï¼Œå¯¹è¯»å–ä¼˜å…ˆ writeFlag = false; // é€šçŸ¥æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ notifyAll(); &#125;&#125; é”ä¼˜åŒ– å‡å°‘é”æŒæœ‰æ—¶é—´ å¯ä»¥ä½¿ç”¨åŒæ­¥ä»£ç å—æ¥ä»£æ›¿åŒæ­¥æ–¹æ³•ã€‚è¿™æ ·æ—¢å¯ä»¥å‡å°‘é”æŒæœ‰çš„æ—¶é—´ã€‚ å‡å°‘é”ç²’åº¦ è¦åœ¨å¹¶å‘åœºæ™¯ä¸­ä½¿ç”¨Mapçš„æ—¶å€™ï¼Œè®°å¾—ä½¿ç”¨ConcurrentHashMapæ¥ä»£æ›¿HashTableå’ŒHashMapã€‚ é”åˆ†ç¦» æ™®é€šé”ï¼ˆå¦‚syncronizedï¼‰ä¼šå¯¼è‡´è¯»é˜»å¡å†™ã€å†™ä¹Ÿä¼šé˜»å¡è¯»ï¼ŒåŒæ—¶è¯»è¯»ä¸å†™å†™ä¹‹é—´ä¹Ÿä¼šè¿›è¡Œé˜»å¡ï¼Œå¯ä»¥æƒ³åŠæ³•å°†è¯»æ“ä½œå’Œå†™æ“ä½œåˆ†ç¦»å¼€ã€‚ é”ç²—åŒ– æœ‰äº›æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›æŠŠå¾ˆå¤šæ¬¡é”çš„è¯·æ±‚åˆå¹¶æˆä¸€ä¸ªè¯·æ±‚ï¼Œä»¥é™ä½çŸ­æ—¶é—´å†…å¤§é‡é”è¯·æ±‚ã€åŒæ­¥ã€é‡Šæ”¾å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ é”æ¶ˆé™¤ é”æ¶ˆé™¤æ˜¯Javaè™šæ‹Ÿæœºåœ¨JITç¼–è¯‘æ˜¯ï¼Œé€šè¿‡å¯¹è¿è¡Œä¸Šä¸‹æ–‡çš„æ‰«æï¼Œå»é™¤ä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„é”ï¼Œé€šè¿‡é”æ¶ˆé™¤ï¼Œå¯ä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”æ—¶é—´ã€‚","categories":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/categories/å¤šçº¿ç¨‹/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"æœ¯è¯­","slug":"æœ¯è¯­","date":"2018-04-09T05:53:41.000Z","updated":"2018-05-05T04:10:19.084Z","comments":true,"path":"2018/04/09/æœ¯è¯­/","link":"","permalink":"https://hsb786.github.io/2018/04/09/æœ¯è¯­/","excerpt":"happens-beforeåœ¨JMMä¸­ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæ‰§è¡Œçš„ç»“æœéœ€è¦å¯¹å¦ä¸€ä¸ªæ“ä½œå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å¿…é¡»è¦å­˜åœ¨happens-beforeå…³ç³» éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢æåˆ°çš„ä¸¤ä¸ªæ“ä½œå¯ä»¥æ˜¯åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´çš„ï¼Œè€Œä¸”å¹¶ä¸æ„å‘³ç€å‰ä¸€ä¸ªæ“ä½œå¿…é¡»è¦åœ¨åä¸€ä¸ªæ“ä½œä¹‹å‰æ‰§è¡Œï¼Œä»…ä»…è¦æ±‚å‰ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æœå¯¹åä¸€ä¸ªæ“ä½œå¯è§","text":"happens-beforeåœ¨JMMä¸­ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæ‰§è¡Œçš„ç»“æœéœ€è¦å¯¹å¦ä¸€ä¸ªæ“ä½œå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å¿…é¡»è¦å­˜åœ¨happens-beforeå…³ç³» éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢æåˆ°çš„ä¸¤ä¸ªæ“ä½œå¯ä»¥æ˜¯åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´çš„ï¼Œè€Œä¸”å¹¶ä¸æ„å‘³ç€å‰ä¸€ä¸ªæ“ä½œå¿…é¡»è¦åœ¨åä¸€ä¸ªæ“ä½œä¹‹å‰æ‰§è¡Œï¼Œä»…ä»…è¦æ±‚å‰ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æœå¯¹åä¸€ä¸ªæ“ä½œå¯è§ happends-beforeè§„åˆ™ ç¨‹åºé¡ºåºè§„åˆ™ï¼š å•ä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸ªæ“ä½œï¼Œhappens-beforeäºè¯¥çº¿ç¨‹ä¸­çš„ä»»æ„åç»­æ“ä½œ ç›‘è§†å™¨é”è§„åˆ™ï¼š å¯¹ä¸€ä¸ªé”çš„è§£é”ï¼Œhappens-beforeäºéšåå¯¹è¿™ä¸ªé”çš„åŠ é” volatileå˜é‡è§„åˆ™ï¼š å¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™ï¼Œhappends-beforeäºä»»æ„åç»­å¯¹è¿™ä¸ªvolatileå˜é‡çš„è¯» ä¼ é€’æ€§ï¼š å¦‚æœA happeens-before Bï¼Œä¸” B happeend-before Cï¼Œé‚£ä¹ˆA happeens-before C joinè§„åˆ™ï¼š å¦‚æœçº¿ç¨‹Aæ‰§è¡Œæ“ä½œThreadB.join()æˆåŠŸè¿”å›ï¼Œé‚£ä¹ˆçº¿ç¨‹Bä¸­çš„ä»»æ„æ“ä½œhappeens-beforeä¸çº¿ç¨‹Aä»ThreadB.join()æ“ä½œæˆåŠŸè¿”å› fail-fastfail-fastæœºåˆ¶æ˜¯javaé›†åˆ(Collection)ä¸­çš„ä¸€ç§é”™è¯¯æœºåˆ¶ã€‚å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€é›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿfail-fastäº‹ä»¶ã€‚ ä¾‹å¦‚ï¼šå½“æŸä¸€ä¸ªçº¿ç¨‹Aé€šè¿‡iteratorå»éå†æŸé›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œè‹¥è¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜äº†ï¼›é‚£ä¹ˆçº¿ç¨‹Aè®¿é—®é›†åˆæ—¶ï¼Œå°±ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ è¦äº†è§£fail-fastæœºåˆ¶ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¯¹ConcurrentModificationException å¼‚å¸¸æœ‰æ‰€äº†è§£ã€‚å½“æ–¹æ³•æ£€æµ‹åˆ°å¯¹è±¡çš„å¹¶å‘ä¿®æ”¹ï¼Œä½†ä¸å…è®¸è¿™ç§ä¿®æ”¹æ—¶å°±æŠ›å‡ºè¯¥å¼‚å¸¸ã€‚åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥å¼‚å¸¸ä¸ä¼šå§‹ç»ˆæŒ‡å‡ºå¯¹è±¡å·²ç»ç”±ä¸åŒçº¿ç¨‹å¹¶å‘ä¿®æ”¹ï¼Œå¦‚æœå•çº¿ç¨‹è¿åäº†è§„åˆ™ï¼ŒåŒæ ·ä¹Ÿæœ‰å¯èƒ½ä¼šæŠ›å‡ºæ”¹å¼‚å¸¸ã€‚è¯šç„¶ï¼Œè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºæ— æ³•å¾—åˆ°ä¿è¯ï¼Œå®ƒä¸èƒ½ä¿è¯ä¸€å®šä¼šå‡ºç°è¯¥é”™è¯¯ï¼Œä½†æ˜¯å¿«é€Ÿå¤±è´¥æ“ä½œä¼šå°½æœ€å¤§åŠªåŠ›æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ å½“ä½¿ç”¨fail-fast iteratorå¯¹Collectionæˆ–å¯¹Mapè¿›è¡Œæ“ä½œè¿‡ç¨‹ä¸­å°è¯•ç›´æ¥ä¿®æ”¹Collection/Mapçš„å†…å®¹æ—¶ï¼Œå³ä½¿æ˜¯åœ¨å•çº¿ç¨‹ä¸‹è¿è¡Œï¼Œjava.util.ConcurrentModificationExceptionå¼‚å¸¸ä¹Ÿå°†æŠ›å‡º Iteratoræ˜¯å·¥ä½œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¸€ä¸ªmutexé”ã€‚Iteratorè¢«åˆ›å»ºä¹‹åä¼šå»ºç«‹ä¸€ä¸ªæŒ‡å‘åŸæ¥å¯¹è±¡çš„å•é“¾ç´¢å¼•è¡¨ï¼Œå½“åŸæ¥å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™ä¸ªç´¢å¼•è¡¨çš„å†…å®¹ä¸ä¼šåŒæ­¥è¯¥è¡¨ï¼Œæ‰€ä»¥å½“ç´¢å¼•æŒ‡é’ˆå¾€åç§»åŠ¨çš„æ—¶å€™å°±æ‰¾ä¸åˆ°è¦è¿­ä»£çš„å¯¹è±¡ï¼Œæ‰€ä»¥æŒ‰ç…§fail-faståŸåˆ™Iteratorä¼šé©¬ä¸ŠæŠ›å‡ºConsurrentModificationExceptionå¼‚å¸¸ã€‚ æ‰€ä»¥Iteratoråœ¨å·¥ä½œçš„æ—¶å€™æ˜¯ä¸å…è®¸è¢«è¿­ä»£çš„å¯¹è±¡è¢«æ”¹å˜çš„ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨Iteratoræœ¬èº«çš„æ–¹æ³•remove()æ¥åˆ é™¤å¯¹è±¡ï¼ŒIteraror.remove()æ–¹æ³•ä¼šåœ¨åˆ é™¤å½“å‰è¿­ä»£å¯¹è±¡çš„åŒæ—¶ç»´æŠ¤ç´¢å¼•çš„ä¸€è‡´æ€§ã€‚ fail-safe é‡‡ç”¨å®‰å…¨å¤±è´¥æœºåˆ¶çš„é›†åˆå®¹å™¨ï¼Œåœ¨éå†æ—¶ä¸æ˜¯ç›´æ¥åœ¨é›†åˆå†…å®¹ä¸Šè®¿é—®çš„ï¼Œè€Œæ˜¯å…ˆå¤åˆ¶åŸæœ‰é›†åˆå†…å®¹ï¼Œåœ¨æ‹·è´çš„é›†åˆä¸Šè¿›è¡Œéå†ã€‚ åŸç†ï¼šç”±äºè¿­ä»£æ—¶æ˜¯å¯¹åŸé›†åˆçš„æ‹·è´è¿›è¡Œéå†ï¼Œæ‰€ä»¥åœ¨éå†è¿‡ç¨‹ä¸­å¯¹åŸé›†åˆæ‰€ä½œçš„ä¿®æ”¹å¹¶ä¸èƒ½è¢«è¿­ä»£å™¨æ£€æµ‹åˆ°ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘Concurrent Modification Exceptionã€‚ ç¼ºç‚¹ï¼šåŸºäºæ‹·è´å†…å®¹çš„ä¼˜ç‚¹æ˜¯é¿å…äº†Concurrent Modification Exceptionï¼Œä½†åŒæ ·åœ°ï¼Œè¿­ä»£å™¨å¹¶ä¸èƒ½è®¿é—®åˆ°ä¿®æ”¹åçš„å†…å®¹ï¼Œå³ï¼šè¿­ä»£å™¨éå†çš„æ˜¯å¼€å§‹éå†é‚£ä¸€åˆ»æ‹¿åˆ°çš„é›†åˆæ‹·è´ï¼Œåœ¨éå†æœŸé—´åŸé›†åˆå‘ç”Ÿçš„ä¿®æ”¹è¿­ä»£å™¨æ˜¯ä¸çŸ¥é“çš„ã€‚ åœºæ™¯ï¼šjava.util.concurrentåŒ…ä¸‹çš„å®¹å™¨éƒ½æ˜¯å®‰å…¨å¤±è´¥ï¼Œå¯ä»¥åœ¨å¤šçº¿ç¨‹ä¸‹å¹¶å‘ä½¿ç”¨ï¼Œå¹¶å‘ä¿®æ”¹ã€‚ CAS(Compare and Swap)CASæœ‰3ä¸ªæ“ä½œæ•°â€”â€”å†…å­˜åœ°å€Vï¼Œæ—§çš„é¢„æœŸå€¼Aï¼Œè¦ä¿®æ”¹çš„æ–°å€¼Bã€‚å½“ä¸”ä»…å½“é¢„æœŸå€¼Aå’Œå†…å­˜åœ°å€Vä¸Šçš„å€¼ç›¸åŒæ—¶ï¼Œå°†å†…å­˜åœ°å€Vä¸Šçš„å€¼ä¿®æ”¹ä¸ºBï¼Œå¦åˆ™ä»€ä¹ˆéƒ½ä¸åšã€‚ ABAé—®é¢˜æ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹oneä»å†…å­˜åœ°å€Vä¸­å–å‡ºAï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹twoä¹Ÿä»å†…å­˜ä¸­å–å‡ºAï¼Œå¹¶ä¸”twoè¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº†Bï¼Œç„¶åtwoåˆå°†Vä½ç½®çš„æ•°æ®å˜æˆAï¼Œè¿™æ—¶å€™çº¿ç¨‹oneè¿›è¡ŒCASæ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯Aï¼Œç„¶åoneæ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹oneçš„CASæ“ä½œæˆåŠŸï¼Œä½†æ˜¯ä¸ä»£è¡¨è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ é€šè¿‡åŠ ç‰ˆæœ¬å·versionå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ as-if-serialAs-if-serialè¯­ä¹‰çš„æ„æ€æ˜¯ï¼Œæ‰€æœ‰çš„åŠ¨ä½œ(Action)éƒ½å¯ä»¥ä¸ºäº†ä¼˜åŒ–è€Œè¢«é‡æ’åºï¼Œä½†æ˜¯å¿…é¡»ä¿è¯å®ƒä»¬é‡æ’åºåçš„ç»“æœå’Œç¨‹åºä»£ç æœ¬èº«çš„åº”æœ‰ç»“æœæ˜¯ä¸€è‡´çš„ã€‚Javaç¼–è¯‘å™¨å’Œå¤„ç†å™¨éƒ½ä¼šä¿è¯å•çº¿ç¨‹ä¸‹çš„as-if-serialè¯­ä¹‰ã€‚ JITç¼–è¯‘å™¨ï¼ˆJust-In-Time Compilerï¼‰JITæ˜¯ä¸€ç§æé«˜ç¨‹åºè¿è¡Œæ•ˆç‡çš„æ–¹æ³•ã€‚é€šå¸¸ï¼Œç¨‹åºæœ‰ä¸¤ç§è¿è¡Œæ–¹å¼ï¼šé™æ€ç¼–è¯‘ä¸åŠ¨æ€è§£é‡Šã€‚é™æ€ç¼–è¯‘çš„ç¨‹åºåœ¨æ‰§è¡Œå‰å…¨éƒ¨è¢«ç¿»è¯‘ä¸ºæœºå™¨ç ï¼Œè€Œè§£é‡Šæ‰§è¡Œçš„åˆ™æ˜¯ä¸€å¥ä¸€å¥è¾¹è¿è¡Œè¾¹ç¿»è¯‘ã€‚ åœ¨Javaç¼–ç¨‹è¯­è¨€å’Œç¯å¢ƒä¸­ï¼Œå³æ—¶ç¼–è¯‘å™¨ï¼ˆJIT compilerï¼Œjust-in-time compilerï¼‰æ˜¯ä¸€ä¸ªæŠŠJavaçš„å­—èŠ‚ç ï¼ˆåŒ…æ‹¬éœ€è¦è¢«è§£é‡Šçš„æŒ‡ä»¤çš„ç¨‹åºï¼‰è½¬æ¢æˆå¯ä»¥ç›´æ¥å‘é€ç»™å¤„ç†å™¨çš„æŒ‡ä»¤çš„ç¨‹åºã€‚ å†…å­˜å±éšœå†…å­˜å±éšœï¼ˆMemory Barrierï¼Œæˆ–æœ‰æ—¶å«åšå†…å­˜æ …æ ï¼ŒMemory Fenceï¼‰æ˜¯ä¸€ç§CPUæŒ‡ä»¤ï¼Œç”¨äºæ§åˆ¶ç‰¹å®šæ¡ä»¶ä¸‹çš„é‡æ’åºå’Œå†…å­˜å¯è§æ€§é—®é¢˜ã€‚Javaç¼–è¯‘å™¨ä¹Ÿä¼šæ ¹æ®å†…å­˜å±éšœçš„è§„åˆ™ç¦æ­¢é‡æ’åºã€‚ ç¼©å†™JMM Java Memory Model ï¼ŒJavaå†…å­˜æ¨¡å‹ JUC java.util.concurrent ï¼ŒåŒæ­¥åŒ… CHM ConcurrentHashMap DRY Donâ€™t repeat yourself DBMS Database Management Systemï¼Œæ•°æ®åº“ç®¡ç†ç³»ç»Ÿ TPS Transaction Per Second ï¼Œæ¯ç§’äº‹åŠ¡å¤„ç†æ•° è°“è¯ï¼ˆpredicateï¼‰åœ¨æ•°å­¦ä¸Šå¸¸å¸¸ç”¨æ¥ä»£è¡¨ä¸€ä¸ªç±»ä¼¼å‡½æ•°çš„ä¸œè¥¿ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°å€¼ï¼Œå¹¶è¿”å›trueæˆ–false æ•°æ®åº“ä¸‰å¤§èŒƒå¼ 1NFï¼šå­—æ®µä¸å¯å†åˆ† 2NFï¼šä¸»é”®ä¾èµ–ï¼Œä¸€å¼ è¡¨é‡Œçš„æ•°æ®ï¼Œå¿…é¡»æ˜¯è·Ÿä¸»é”®ç›¸å…³çš„ 3NFï¼šä»»æ„ä¸¤ä¸ªè¡¨ä¸èƒ½å‡ºç°é‡å¤çš„éä¸»é”®å­—æ®µ è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™å•ä¸€èŒè´£(Single Responsibility Principle)ï¼šä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£ å¼€é—­(Open-Closed Principle)ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ é‡Œæ°æ›¿æ¢(Liskov Subsitution Principle)ï¼šå­ç±»èƒ½å‡ºç°åœ¨åŸºç±»å‡ºç°çš„åœ°æ–¹ ä¾èµ–å€’ç½®(Dependency Inversion Principle)ï¼šé’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç±»ç¼–ç¨‹ æ¥å£éš”ç¦»(Interface Segregation Principle)ï¼šä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£ è¿ªç±³ç‰¹(Law of Demeter)ï¼šä¸€ä¸ªç±»å°½å¯èƒ½å°‘çš„ä¸å…¶å®ƒç±»å‘ç”Ÿç›¸äº’ä½œç”¨ åˆ†å¸ƒå¼é¢†åŸŸCAPç†è®ºConsistency(ä¸€è‡´æ€§)ï¼šæ•°æ®ä¸€è‡´æ›´æ–°ï¼Œæ‰€æœ‰æ•°æ®å˜åŠ¨éƒ½æ˜¯åŒæ­¥çš„ Availability(å¯ç”¨æ€§)ï¼šå¥½çš„å“åº”æ€§èƒ½ Partition tolerance(åˆ†åŒºå®¹å¿æ€§)ï¼šå¯é æ€§ å®šç†ï¼šä»»ä½•åˆ†å¸ƒå¼ç³»ç»Ÿåªå¯åŒæ—¶æ»¡è¶³äºŒç‚¹ï¼Œæ²¡æ³•ä¸‰è€…å…¼é¡¾ã€‚ å¿ å‘Šï¼šæ¶æ„å¸ˆä¸è¦å°†ç²¾åŠ›æµªè´¹åœ¨å¦‚ä½•è®¾è®¡èƒ½æ»¡è¶³ä¸‰è€…çš„å®Œç¾åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè€Œæ˜¯åº”è¯¥è¿›è¡Œå–èˆã€‚ å¼ºä¸€è‡´æ€§,å¼±ä¸€è‡´æ€§,æœ€ç»ˆä¸€è‡´æ€§å¼ºä¸€è‡´æ€§ å½“æ›´æ–°æ“ä½œå®Œæˆä¹‹åï¼Œä»»ä½•å¤šä¸ªåç»­è¿›ç¨‹æˆ–è€…çº¿ç¨‹çš„è®¿é—®éƒ½ä¼šè¿”å›æœ€æ–°çš„æ›´æ–°è¿‡çš„å€¼ã€‚è¿™ç§æ˜¯å¯¹ç”¨æˆ·æœ€å‹å¥½çš„ï¼Œå°±æ˜¯ç”¨æˆ·ä¸Šä¸€æ¬¡å†™ä»€ä¹ˆï¼Œä¸‹ä¸€æ¬¡å°±ä¿è¯èƒ½è¯»åˆ°ä»€ä¹ˆã€‚æ ¹æ® CAP ç†è®ºï¼Œè¿™ç§å®ç°éœ€è¦ç‰ºç‰²å¯ç”¨æ€§ã€‚ å¼±ä¸€è‡´æ€§ ç³»ç»Ÿå¹¶ä¸ä¿è¯ç»­è¿›ç¨‹æˆ–è€…çº¿ç¨‹çš„è®¿é—®éƒ½ä¼šè¿”å›æœ€æ–°çš„æ›´æ–°è¿‡çš„å€¼ã€‚ç³»ç»Ÿåœ¨æ•°æ®å†™å…¥æˆåŠŸä¹‹åï¼Œä¸æ‰¿è¯ºç«‹å³å¯ä»¥è¯»åˆ°æœ€æ–°å†™å…¥çš„å€¼ï¼Œä¹Ÿä¸ä¼šå…·ä½“çš„æ‰¿è¯ºå¤šä¹…ä¹‹åå¯ä»¥è¯»åˆ°ã€‚ æœ€ç»ˆä¸€è‡´æ€§ å¼±ä¸€è‡´æ€§çš„ç‰¹å®šå½¢å¼ã€‚ç³»ç»Ÿä¿è¯åœ¨æ²¡æœ‰åç»­æ›´æ–°çš„å‰æä¸‹ï¼Œç³»ç»Ÿæœ€ç»ˆè¿”å›ä¸Šä¸€æ¬¡æ›´æ–°æ“ä½œçš„å€¼ã€‚åœ¨æ²¡æœ‰æ•…éšœå‘ç”Ÿçš„å‰æä¸‹ï¼Œä¸ä¸€è‡´çª—å£çš„æ—¶é—´ä¸»è¦å—é€šä¿¡å»¶è¿Ÿï¼Œç³»ç»Ÿè´Ÿè½½å’Œå¤åˆ¶å‰¯æœ¬çš„ä¸ªæ•°å½±å“ã€‚DNS æ˜¯ä¸€ä¸ªå…¸å‹çš„æœ€ç»ˆä¸€è‡´æ€§ç³»ç»Ÿã€‚ å‡å”¤é†’(spurious wake up)Linuxä¸­å¸®åŠ©ä¸­æåˆ°çš„ï¼šåœ¨å¤šæ ¸å¤„ç†å™¨ä¸‹ï¼Œpthread_cond_signalå¯èƒ½ä¼šæ¿€æ´»å¤šäºä¸€ä¸ªçº¿ç¨‹ï¼ˆé˜»å¡åœ¨æ¡ä»¶å˜é‡ä¸Šçš„çº¿ç¨‹ï¼‰ã€‚ ç»“æœæ˜¯ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨pthread_cond_signal()åï¼Œå¤šä¸ªè°ƒç”¨pthread_cond_wait()æˆ–pthread_cond_timedwait()çš„çº¿ç¨‹è¿”å›ã€‚è¿™ç§æ•ˆåº”æˆä¸ºâ€è™šå‡å”¤é†’â€(spurious wakeup) è™½ç„¶è™šå‡å”¤é†’åœ¨pthread_cond_waitå‡½æ•°ä¸­å¯ä»¥è§£å†³ï¼Œä¸ºäº†å‘ç”Ÿæ¦‚ç‡å¾ˆä½çš„æƒ…å†µè€Œé™ä½è¾¹ç¼˜æ¡ä»¶ï¼ˆfringe conditionï¼‰æ•ˆç‡æ˜¯ä¸å€¼å¾—çš„ï¼Œçº æ­£è¿™ä¸ªé—®é¢˜ä¼šé™ä½å¯¹æ‰€æœ‰åŸºäºå®ƒçš„æ‰€æœ‰æ›´é«˜çº§çš„åŒæ­¥æ“ä½œçš„å¹¶å‘åº¦ã€‚æ‰€ä»¥pthread_cond_waitçš„å®ç°ä¸Šæ²¡æœ‰å»è§£å†³å®ƒã€‚ æ‰€ä»¥é€šå¸¸çš„æ ‡å‡†è§£å†³åŠæ³•æ˜¯è¿™æ ·çš„ï¼šå°†æ¡ä»¶çš„åˆ¤æ–­ä»if æ”¹ä¸ºwhile pthread_cond_waitä¸­çš„while()ä¸ä»…ä»…åœ¨ç­‰å¾…æ¡ä»¶å˜é‡å‰æ£€æŸ¥æ¡ä»¶å˜é‡ï¼Œå®é™…ä¸Šåœ¨ç­‰å¾…æ¡ä»¶å˜é‡åä¹Ÿæ£€æŸ¥æ¡ä»¶å˜é‡ã€‚ è¿™æ ·å¯¹conditionè¿›è¡Œå¤šåšä¸€æ¬¡åˆ¤æ–­ï¼Œå³å¯é¿å…â€œè™šå‡å”¤é†’â€. è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨pthread_cond_wait()å‰è¦åŠ ä¸€ä¸ªwhileå¾ªç¯æ¥åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºå‡çš„åŸå› ã€‚ PO(persistant object) æŒä¹…å¯¹è±¡åœ¨ o/r æ˜ å°„çš„æ—¶å€™å‡ºç°çš„æ¦‚å¿µï¼Œå¦‚æœæ²¡æœ‰ o/r æ˜ å°„ï¼Œæ²¡æœ‰è¿™ä¸ªæ¦‚å¿µå­˜åœ¨äº†ã€‚é€šå¸¸å¯¹åº”æ•°æ®æ¨¡å‹ ( æ•°æ®åº“ ), æœ¬èº«è¿˜æœ‰éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ã€‚å¯ä»¥çœ‹æˆæ˜¯ä¸æ•°æ®åº“ä¸­çš„è¡¨ç›¸æ˜ å°„çš„ java å¯¹è±¡ã€‚æœ€ç®€å•çš„ PO å°±æ˜¯å¯¹åº”æ•°æ®åº“ä¸­æŸä¸ªè¡¨ä¸­çš„ä¸€æ¡è®°å½•ï¼Œå¤šä¸ªè®°å½•å¯ä»¥ç”¨ PO çš„é›†åˆã€‚ PO ä¸­åº”è¯¥ä¸åŒ…å«ä»»ä½•å¯¹æ•°æ®åº“çš„æ“ä½œã€‚ DOï¼ˆDomain Objectï¼‰é¢†åŸŸå¯¹è±¡å°±æ˜¯ä»ç°å®ä¸–ç•Œä¸­æŠ½è±¡å‡ºæ¥çš„æœ‰å½¢æˆ–æ— å½¢çš„ä¸šåŠ¡å®ä½“ã€‚ä¸€èˆ¬å’Œæ•°æ®ä¸­çš„è¡¨ç»“æ„å¯¹åº”ã€‚ TO(Transfer Object) ï¼Œæ•°æ®ä¼ è¾“å¯¹è±¡åœ¨åº”ç”¨ç¨‹åºä¸åŒ tie( å…³ç³» ) ä¹‹é—´ä¼ è¾“çš„å¯¹è±¡ DTOï¼ˆData Transfer Objectï¼‰æ•°æ®ä¼ è¾“å¯¹è±¡è¿™ä¸ªæ¦‚å¿µæ¥æºäºJ2EEçš„è®¾è®¡æ¨¡å¼ï¼ŒåŸæ¥çš„ç›®çš„æ˜¯ä¸ºäº†EJBçš„åˆ†å¸ƒå¼åº”ç”¨æä¾›ç²—ç²’åº¦çš„æ•°æ®å®ä½“ï¼Œä»¥å‡å°‘åˆ†å¸ƒå¼è°ƒç”¨çš„æ¬¡æ•°ï¼Œä»è€Œæé«˜åˆ†å¸ƒå¼è°ƒç”¨çš„æ€§èƒ½å’Œé™ä½ç½‘ç»œè´Ÿè½½ï¼Œä½†åœ¨è¿™é‡Œï¼Œæˆ‘æ³›æŒ‡ç”¨äºå±•ç¤ºå±‚ä¸æœåŠ¡å±‚ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚ VO(view object) å€¼å¯¹è±¡è§†å›¾å¯¹è±¡ï¼Œç”¨äºå±•ç¤ºå±‚ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠæŸä¸ªæŒ‡å®šé¡µé¢ï¼ˆæˆ–ç»„ä»¶ï¼‰çš„æ‰€æœ‰æ•°æ®å°è£…èµ·æ¥ã€‚ BO(business object) ä¸šåŠ¡å¯¹è±¡ä»ä¸šåŠ¡æ¨¡å‹çš„è§’åº¦çœ‹ , è§ UML å…ƒä»¶é¢†åŸŸæ¨¡å‹ä¸­çš„é¢†åŸŸå¯¹è±¡ã€‚å°è£…ä¸šåŠ¡é€»è¾‘çš„ java å¯¹è±¡ , é€šè¿‡è°ƒç”¨ DAO æ–¹æ³• , ç»“åˆ PO,VO è¿›è¡Œä¸šåŠ¡æ“ä½œã€‚ business object: ä¸šåŠ¡å¯¹è±¡ ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸šåŠ¡é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒçš„å¯¹è±¡ã€‚ æ¯”å¦‚ä¸€ä¸ªç®€å†ï¼Œæœ‰æ•™è‚²ç»å†ã€å·¥ä½œç»å†ã€ç¤¾ä¼šå…³ç³»ç­‰ç­‰ã€‚ æˆ‘ä»¬å¯ä»¥æŠŠæ•™è‚²ç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œå·¥ä½œç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œç¤¾ä¼šå…³ç³»å¯¹åº”ä¸€ä¸ª PO ã€‚ å»ºç«‹ä¸€ä¸ªå¯¹åº”ç®€å†çš„ BO å¯¹è±¡å¤„ç†ç®€å†ï¼Œæ¯ä¸ª BO åŒ…å«è¿™äº› PO ã€‚ è¿™æ ·å¤„ç†ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹ BO å»å¤„ç†ã€‚ POJO(plain ordinary java object) ç®€å•æ— è§„åˆ™ java å¯¹è±¡çº¯çš„ä¼ ç»Ÿæ„ä¹‰çš„ java å¯¹è±¡ã€‚å°±æ˜¯è¯´åœ¨ä¸€äº› Object/Relation Mapping å·¥å…·ä¸­ï¼Œèƒ½å¤Ÿåšåˆ°ç»´æŠ¤æ•°æ®åº“è¡¨è®°å½•çš„ persisent object å®Œå…¨æ˜¯ä¸€ä¸ªç¬¦åˆ Java Bean è§„èŒƒçš„çº¯ Java å¯¹è±¡ï¼Œæ²¡æœ‰å¢åŠ åˆ«çš„å±æ€§å’Œæ–¹æ³•ã€‚æˆ‘çš„ç†è§£å°±æ˜¯æœ€åŸºæœ¬çš„ Java Bean ï¼Œåªæœ‰å±æ€§å­—æ®µåŠ setter å’Œ getter æ–¹æ³•ï¼ã€‚ DAO(data access object) æ•°æ®è®¿é—®å¯¹è±¡æ˜¯ä¸€ä¸ª sun çš„ä¸€ä¸ªæ ‡å‡† j2ee è®¾è®¡æ¨¡å¼ï¼Œ è¿™ä¸ªæ¨¡å¼ä¸­æœ‰ä¸ªæ¥å£å°±æ˜¯ DAO ï¼Œå®ƒè´ŸæŒä¹…å±‚çš„æ“ä½œã€‚ä¸ºä¸šåŠ¡å±‚æä¾›æ¥å£ã€‚æ­¤å¯¹è±¡ç”¨äºè®¿é—®æ•°æ®åº“ã€‚é€šå¸¸å’Œ PO ç»“åˆä½¿ç”¨ï¼Œ DAO ä¸­åŒ…å«äº†å„ç§æ•°æ®åº“çš„æ“ä½œæ–¹æ³•ã€‚é€šè¿‡å®ƒçš„æ–¹æ³• , ç»“åˆ PO å¯¹æ•°æ®åº“è¿›è¡Œç›¸å…³çš„æ“ä½œã€‚å¤¹åœ¨ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®åº“èµ„æºä¸­é—´ã€‚é…åˆ VO, æä¾›æ•°æ®åº“çš„ CRUD æ“ä½œ è®¾è®¡æ¨¡å¼åˆ†ç±»è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼Œå…±23ç§ã€‚ åˆ›å»ºå‹æ¨¡å¼ï¼šå•ä¾‹æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€‚ ç»“æ„å‹æ¨¡å¼ï¼šé€‚é…å™¨æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€‚ è¡Œä¸ºå‹æ¨¡å¼ï¼šæ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreteræ¨¡å¼ï¼‰ã€çŠ¶æ€æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€èŒè´£é“¾æ¨¡å¼(è´£ä»»é“¾æ¨¡å¼)ã€è®¿é—®è€…æ¨¡å¼ã€‚ 23ç§è®¾è®¡æ¨¡å¼ç®€å•ä»‹ç»Abstract Factoryï¼ˆæŠ½è±¡å·¥å‚æ¨¡å¼ï¼‰ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚ Adapterï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚Adapteræ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ Bridgeï¼ˆæ¡¥æ¥æ¨¡å¼ï¼‰ï¼šå°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚ Builderï¼ˆå»ºé€ è€…æ¨¡å¼ï¼‰ï¼šå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚ Chain of Responsibilityï¼ˆè´£ä»»é“¾æ¨¡å¼ï¼‰ï¼šä¸ºè§£é™¤è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´è€¦åˆï¼Œè€Œä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒã€‚ Commandï¼ˆå‘½ä»¤æ¨¡å¼ï¼‰ï¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯å–æ¶ˆçš„æ“ä½œã€‚ Compositeï¼ˆç»„åˆæ¨¡å¼ï¼‰ï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚å®ƒä½¿å¾—å®¢æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œå¤åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚ Decoratorï¼ˆè£…é¥°æ¨¡å¼ï¼‰ï¼šåŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±æ‰©å±•åŠŸèƒ½è€Œè¨€ï¼Œ å®ƒæ¯”ç”Ÿæˆå­ç±»æ–¹å¼æ›´ä¸ºçµæ´»ã€‚ Facadeï¼ˆå¤–è§‚æ¨¡å¼ï¼‰ï¼šä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼ŒFacadeæ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚ Factory Methodï¼ˆå·¥å‚æ¨¡å¼ï¼‰ï¼šå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå°†å“ªä¸€ä¸ªç±»å®ä¾‹åŒ–ã€‚Factory Methodä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚ Flyweightï¼ˆäº«å…ƒæ¨¡å¼ï¼‰ï¼šè¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚ Interpreterï¼ˆè§£æå™¨æ¨¡å¼ï¼‰ï¼šç»™å®šä¸€ä¸ªè¯­è¨€, å®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨, è¯¥è§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚ Iteratorï¼ˆè¿­ä»£å™¨æ¨¡å¼ï¼‰ï¼šæä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ Mediatorï¼ˆä¸­ä»‹æ¨¡å¼ï¼‰ï¼šç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ Mementoï¼ˆå¤‡å¿˜å½•æ¨¡å¼ï¼‰ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯å°†è¯¥å¯¹è±¡æ¢å¤åˆ°ä¿å­˜çš„çŠ¶æ€ã€‚ Observerï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰ï¼šå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»,ä»¥ä¾¿å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶,æ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨åˆ·æ–°ã€‚ Prototypeï¼ˆåŸå‹æ¨¡å¼ï¼‰ï¼šç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™ä¸ªåŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ Proxyï¼ˆä»£ç†æ¨¡å¼ï¼‰ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ Singletonï¼ˆå•ä¾‹æ¨¡å¼ï¼‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚ å•ä¾‹æ¨¡å¼æ˜¯æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œä½†æ˜¯å¯¹äºJavaçš„å¼€å‘è€…æ¥è¯´ï¼Œå®ƒå´æœ‰å¾ˆå¤šç¼ºé™·ã€‚åœ¨ä¹æœˆçš„ä¸“æ ä¸­ï¼ŒDavid Gearyæ¢è®¨äº†å•ä¾‹æ¨¡å¼ä»¥åŠåœ¨é¢å¯¹å¤šçº¿ç¨‹ï¼ˆmulti-threadingï¼‰ã€ç±»è£…è½½å™¨ï¼ˆclass loadersï¼‰å’Œåºåˆ—åŒ–ï¼ˆserializationï¼‰æ—¶å¦‚ä½•å¤„ç†è¿™äº›ç¼ºé™·ã€‚ Stateï¼ˆçŠ¶æ€æ¨¡å¼ï¼‰ï¼šå…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒæ‰€å±çš„ç±»ã€‚ Strategyï¼ˆç­–ç•¥æ¨¡å¼ï¼‰ï¼šå®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚æœ¬æ¨¡å¼ä½¿å¾—ç®—æ³•çš„å˜åŒ–å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ã€‚ Template Methodï¼ˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼‰ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚Template Methodä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚ Visitorï¼ˆè®¿é—®è€…æ¨¡å¼ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œã€‚å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚ åˆ›å»ºå‹æ¨¡å¼åˆ›å»ºå‹æ¨¡å¼(Creational Pattern)å¯¹ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹è¿›è¡Œäº†æŠ½è±¡ï¼Œèƒ½å¤Ÿå°†è½¯ä»¶æ¨¡å—ä¸­å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡çš„ä½¿ç”¨åˆ†ç¦»ã€‚ä¸ºäº†ä½¿è½¯ä»¶çš„ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œå¤–ç•Œå¯¹äºè¿™äº›å¯¹è±¡åªéœ€è¦çŸ¥é“å®ƒä»¬å…±åŒçš„æ¥å£ï¼Œè€Œä¸æ¸…æ¥šå…¶å…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œä½¿æ•´ä¸ªç³»ç»Ÿçš„è®¾è®¡æ›´åŠ ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚","categories":[{"name":"æœ¯è¯­","slug":"æœ¯è¯­","permalink":"https://hsb786.github.io/categories/æœ¯è¯­/"}],"tags":[{"name":"é•¿æœŸæ›´æ–°","slug":"é•¿æœŸæ›´æ–°","permalink":"https://hsb786.github.io/tags/é•¿æœŸæ›´æ–°/"},{"name":"æœ¯è¯­","slug":"æœ¯è¯­","permalink":"https://hsb786.github.io/tags/æœ¯è¯­/"}]},{"title":"è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿","slug":"è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿","date":"2018-04-09T00:42:41.000Z","updated":"2018-05-08T13:11:34.148Z","comments":true,"path":"2018/04/09/è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿/","link":"","permalink":"https://hsb786.github.io/2018/04/09/è®°å½•ä¸€äº›å®¹æ˜“å¿˜è®°çš„ä¸œè¥¿/","excerpt":"æ¥å£ä¸å¯ä»¥å®ç°æ¥å£ï¼Œå¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£ æŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿å…·ä½“ç±» staticä¸èƒ½è¢«é‡å†™ï¼Œé‡å†™æ˜¯è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ staticå˜é‡å‘ç”Ÿåœ¨é™æ€è§£æé˜¶æ®µï¼Œæ­¤æ—¶å·²ç»å°†å­—æ®µçš„ç¬¦å·å¼•ç”¨è½¬æ¢æˆäº†å†…å­˜å¼•ç”¨ï¼Œå°†å®ƒä¸å¯¹åº”çš„ç±»å…³è”åœ¨äº†ä¸€èµ·","text":"æ¥å£ä¸å¯ä»¥å®ç°æ¥å£ï¼Œå¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£ æŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿å…·ä½“ç±» staticä¸èƒ½è¢«é‡å†™ï¼Œé‡å†™æ˜¯è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ staticå˜é‡å‘ç”Ÿåœ¨é™æ€è§£æé˜¶æ®µï¼Œæ­¤æ—¶å·²ç»å°†å­—æ®µçš„ç¬¦å·å¼•ç”¨è½¬æ¢æˆäº†å†…å­˜å¼•ç”¨ï¼Œå°†å®ƒä¸å¯¹åº”çš„ç±»å…³è”åœ¨äº†ä¸€èµ·å­ç±»æ„é€ æ–¹æ³•é»˜è®¤ä¼šå¯»æ‰¾çˆ¶ç±»æ— å‚æ„é€ æ–¹æ³•ï¼Œè‹¥æ²¡æœ‰ï¼Œç¼–è¯‘ä¸é€šè¿‡ å…³äºæŠ½è±¡ç±»JDK 1.8ä»¥å‰ï¼ŒæŠ½è±¡ç±»çš„æ–¹æ³•é»˜è®¤è®¿é—®æƒé™ä¸ºprotectedJDK 1.8æ—¶ï¼ŒæŠ½è±¡ç±»çš„æ–¹æ³•é»˜è®¤è®¿é—®æƒé™å˜ä¸ºæ— ä¿®é¥°ç¬¦ å…³äºæ¥å£JDK 1.8ä»¥å‰ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å¿…é¡»æ˜¯publicçš„JDK 1.8æ—¶ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯defaultï¼Œè¿˜å¯ä»¥æ˜¯staticJDK 1.9æ—¶ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯privateçš„ volatile ç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼š æ·»åŠ å†…å­˜å±éšœï¼Œä¿è¯å‰é¢å·²ç»å®Œæˆï¼Œåé¢éƒ½æ²¡å¼€å§‹ï¼ˆhappens-beforeï¼‰ å†…éƒ¨ç±»è®¿é—®å¤–éƒ¨ç±» å¤–éƒ¨ç±».this.æˆå‘˜XX é‡è½½é™æ€ç»‘å®šï¼Œæ ¹æ®å‚æ•°çš„é™æ€ç±»å‹è€Œä¸æ˜¯å®é™…ç±»å‹ä½œä¸ºåˆ¤æ–­ä¾æ®çš„ javaçš„8ä¸­åŸºæœ¬ç±»å‹ï¼Œé™¤äº†floatå’Œdoubleä¹‹å¤–ï¼Œå…¶å®ƒ6ç§éƒ½å®ç°äº†å¸¸é‡æ±  booleanç±»å‹ä¸å…è®¸è¿›è¡Œä»»ä½•ç±»å‹çš„è½¬æ¢å¤„ç† java7ä»¥åï¼Œå¸¸é‡æ± è¢«æ”¾å…¥åˆ°å †ç©ºé—´ä¸­ã€‚String#internæ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨å †ä¸­çš„å¯¹è±¡ï¼Œä¼šç›´æ¥ä¿å­˜å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œä¸ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡ newInstance ä½æ•ˆç‡ï¼Œåªèƒ½è°ƒç”¨æ— å‚æ„é€ ã€‚å°†newè¿™ä¸ªæ–¹å¼åˆ†è§£ä¸ºä¸¤æ­¥ï¼š é¦–å…ˆè°ƒç”¨classçš„åŠ è½½æ–¹å¼åŠ è½½æŸä¸ªç±»ï¼Œç„¶åå®ä¾‹åŒ– å­—ç¬¦åªæœ‰åœ¨å†…å­˜ä¸­æ‰ä¼šå½¢æˆï¼Œå…¶å®ƒéƒ½æ˜¯ä»¥å­—èŠ‚çš„æ–¹å¼è¿›è¡Œçš„ å¼ºå¼•ç”¨ï¼š Object obj=new Object()ï¼Œåªè¦å¼•ç”¨è¿˜åœ¨ï¼Œå°±ä¸ä¼šè¢«å›æ”¶è½¯å¼•ç”¨ï¼š å†…å­˜ä¸å¤Ÿæ‰ä¼šè¢«å›æ”¶å¼±å¼•ç”¨ï¼š ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ä¼šè¢«å›æ”¶ã€‚è™šå¼•ç”¨ï¼š éšæ—¶å¯èƒ½è¢«å›æ”¶ï¼Œç›®çš„æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ å†…åŠ è½½å™¨ï¼š JVMåŠ¨æ€åŠ è½½æ‰€éœ€çš„ç±»ã€‚ å§”æ‰˜ã€å¯è§ã€å•ä¸€ã€‚åŒäº²å§”æ´¾ï¼Œäº¤ç»™çˆ¶åŠ è½½å™¨ï¼›çˆ¶åŠ è½½å™¨åŠ è½½çš„ç±»å­åŠ è½½å™¨éƒ½èƒ½çœ‹åˆ°ï¼›ä¸€ä¸ªç±»åªèƒ½è¢«ä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½ä¸€æ¬¡ æ¯ä¸ªå¯¹è±¡æœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼š å°±ç»ªé˜Ÿåˆ—ã€é˜»å¡é˜Ÿåˆ— ReentrantLockç»“åˆConditionå¯ä»¥æœ‰é€‰æ‹©æ€§åœ°è¿›è¡Œé€šçŸ¥ï¼Œåœ¨è°ƒåº¦ä¸Šæ›´åŠ çµæ´» æŒ‡ä»¤é‡æ’åºï¼š ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¸ºäº†ä¼˜åŒ–ç¨‹åºæ€§èƒ½è€Œå¯¹æŒ‡ä»¤åºåˆ—è¿›è¡Œé‡æ–°æ’åºçš„ä¸€ç§æ‰‹æ®µ nullå¯ä»¥å¼ºåˆ¶è½¬æ¢ä¸ºä»»ä½•javaç±»ç±»å‹ï¼›å…¶è¿”å›å€¼è¿˜æ˜¯nullï¼Œå¯ä»¥è°ƒç”¨staticæ–¹æ³• åŸºæœ¬ç±»å‹ä¸åŒ…è£…ç±»æ¯”è¾ƒï¼›åŒ…è£…ç±»æ‹†ç®±ï¼Œè¿›è¡Œå€¼æ¯”è¾ƒ å­ç±»ï¼Œä¹Ÿå«å¯¼å‡ºç±»ã€æ´¾ç”Ÿç±» Math.round() +0.5Math.ceil() å‘ä¸Šå–æ•´Math.floor() å‘ä¸‹å–æ•´ ç±»å˜é‡æœ‰é»˜è®¤å€¼ï¼Œå±€éƒ¨å˜é‡æ˜¯æ²¡æœ‰é»˜è®¤å€¼çš„ waitï¼Œsleepéƒ½å¿…é¡»è¿›è¡Œå¼‚å¸¸æ•è· IllegalMonitorStateExceptionæŠ›å‡ºè¯¥å¼‚å¸¸è¡¨æ˜æŸä¸€çº¿ç¨‹å·²ç»è¯•å›¾ç­‰å¾…å¯¹è±¡çš„ç›‘è§†å™¨ï¼Œæˆ–è€…è¯•å›¾é€šçŸ¥å…¶ä»–æ­£åœ¨ç­‰å¾…å¯¹è±¡çš„ç›‘è§†å™¨ï¼Œç„¶è€Œæœ¬èº«æ²¡æœ‰æŒ‡å®šçš„ç›‘è§†å™¨çš„çº¿ç¨‹ã€‚ä¹Ÿå°±æ˜¯å½“å‰çš„çº¿ç¨‹ä¸æ˜¯æ­¤å¯¹è±¡ç›‘è§†å™¨çš„æ‰€æœ‰è€…ã€‚å½“å‰çº¿ç¨‹è¦é”å®šè¯¥å¯¹è±¡ä¹‹åï¼Œæ‰èƒ½ç”¨é”å®šçš„å¯¹è±¡æ‰§è¡Œè¿™äº›æ–¹æ³•ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°synchronizedå…³é”®å­—ï¼Œé”å®šå“ªä¸ªå¯¹è±¡å°±ç”¨å“ªä¸ªå¯¹è±¡æ¥æ‰§è¡Œnotify(), notifyAll(),wait(), wait(long), wait(long, int)æ“ä½œï¼Œå¦åˆ™å°±ä¼šæŠ¥IllegalMonitorStateExceptionå¼‚å¸¸ã€‚ Javaçš„è·¨å¹³å°ç‰¹æ€§æ˜¯æŒ‡å®ƒçš„å­—èŠ‚ç å¯ä»¥åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œ getMethods è¿”å›Methodå¯¹è±¡æ•°ç»„ï¼ŒåŒ…æ‹¬å½“å‰ç±»åŠçˆ¶ç±»æ‰€æœ‰publicæ–¹æ³•getDeclaredMethod æ–¹æ³•Methodå¯¹è±¡æ•°ç»„ï¼ŒåŒ…æ‹¬å½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚ä¸åŒ…æ‹¬çˆ¶ç±»ã€‚ javaç”¨æ¥è¿è¡Œä¸€ä¸ª.classæ–‡ä»¶ javadocç”¨æ¥ç”Ÿæˆapiæ–‡æ¡£ jarç”¨æ¥ç”ŸæˆjaråŒ… javacç”¨æ¥æŠŠ.javaæ–‡ä»¶ç¼–è¯‘ä¸º.classæ–‡ä»¶ notifyè°ƒç”¨åï¼Œè¦ç­‰åŒæ­¥è¯­å¥å—æ‰§è¡Œå®Œæ‰é‡Šæ”¾é”ï¼›waitä¸æ˜¯ã€‚ getClass() è¿”å›çš„æ˜¯å®é™…ç±» å…³äºtryå’Œfinally é¦–å…ˆæ‰§è¡Œtryé‡Œçš„returnï¼Œä½†æ˜¯æœ‰finallyè¯­å¥è¿˜è¦æ‰§è¡Œï¼Œäºæ˜¯å…ˆæ‰§è¡Œreturnåé¢çš„è¯­å¥ï¼ŒæŠŠè¦è¿”å›çš„å€¼ä¿å­˜åˆ°å±€éƒ¨å˜é‡ã€‚ æ‰§è¡Œfinallyè¯­å¥çš„å†…å®¹ï¼Œå…¶ä¸­æœ‰returnè¯­å¥ï¼Œè¿™æ—¶å°±ä¼šå¿½ç•¥tryä¸­çš„returnï¼Œç›´æ¥è¿”å›ã€‚ è¿”å›å€¼é—®é¢˜ï¼Œå¯ä»¥è®¤ä¸ºtryï¼ˆæˆ–è€…catchï¼‰ä¸­çš„returnè¯­å¥çš„è¿”å›å€¼æ”¾å…¥çº¿ç¨‹æ ˆçš„é¡¶éƒ¨ï¼šå¦‚æœè¿”å›å€¼æ˜¯åŸºæœ¬ç±»å‹åˆ™é¡¶éƒ¨å­˜æ”¾çš„å°±æ˜¯å€¼ï¼Œå¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™é¡¶éƒ¨å­˜æ”¾çš„æ˜¯å¼•ç”¨ã€‚finallyä¸­çš„returnè¯­å¥å¯ä»¥ä¿®æ”¹å¼•ç”¨æ‰€å¯¹åº”çš„å¯¹è±¡ï¼Œæ— æ³•ä¿®æ”¹åŸºæœ¬ç±»å‹ã€‚ trueã€falseå’Œnullå¹¶ä¸æ˜¯å…³é”®å­—ï¼Œè€Œæ˜¯â€œå­—é¢å¸¸é‡â€ï¼Œå°±å’ŒStringç±»å‹çš„abcä¸€æ · äºŒè¿›åˆ¶é—®é¢˜ è®¡ç®—æœºå°†æ‰€æœ‰æ•°æ®ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨è®¡ç®—æœºç”¨æœ‰é™çš„å¤§å°æ¥å­˜å‚¨æ•°æ® äºŒè¿›åˆ¶èƒ½ç”¨æœ‰é™çš„ä½æ•°è¡¨ç¤ºçš„æœ‰ï¼š0.5ã€0.25ã€0.125ç­‰ æ‰€ä»¥0.1+0.2!=0.3 sleepå’Œyieldéƒ½æ˜¯public static native voidæ–¹æ³•","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"},{"name":"é•¿æœŸæ›´æ–°","slug":"é•¿æœŸæ›´æ–°","permalink":"https://hsb786.github.io/tags/é•¿æœŸæ›´æ–°/"}]},{"title":"åŒºåˆ«","slug":"åŒºåˆ«","date":"2018-04-08T23:48:41.000Z","updated":"2018-04-27T10:53:07.334Z","comments":true,"path":"2018/04/09/åŒºåˆ«/","link":"","permalink":"https://hsb786.github.io/2018/04/09/åŒºåˆ«/","excerpt":"sleepå’ŒwaitåŒºåˆ« sleepæ˜¯Threadç±»çš„staticæ–¹æ³•ï¼› waitæ˜¯Objectç±»çš„æ–¹æ³• sleepç¡çœ æ—¶ä¿æŒå¯¹è±¡é”ï¼› waité‡Šæ”¾é” sleepå¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼› waitå¿…é¡»æ”¾åœ¨synchronized blockä¸­ï¼Œå¦åˆ™ä¼šåœ¨runtimeæ—¶æ‰”å‡ºIllegalMonitorStateExcetionå¼‚å¸¸","text":"sleepå’ŒwaitåŒºåˆ« sleepæ˜¯Threadç±»çš„staticæ–¹æ³•ï¼› waitæ˜¯Objectç±»çš„æ–¹æ³• sleepç¡çœ æ—¶ä¿æŒå¯¹è±¡é”ï¼› waité‡Šæ”¾é” sleepå¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼› waitå¿…é¡»æ”¾åœ¨synchronized blockä¸­ï¼Œå¦åˆ™ä¼šåœ¨runtimeæ—¶æ‰”å‡ºIllegalMonitorStateExcetionå¼‚å¸¸ synchronizedå’ŒvolatileåŒºåˆ« volatileæ˜¯çº¿ç¨‹åŒæ­¥çš„è½»é‡çº§å®ç°ï¼Œæ€§èƒ½æ¯”synchronizedå¥½ volatileåªèƒ½ä¿®é¥°å˜é‡ï¼› synchronizedå¯ä¿®é¥°æ–¹æ³•å’Œä»£ç å— volatileèƒ½ä¿è¯æ•°æ®å¯è§æ€§ï¼Œä¸ä¿è¯åŸå­æ€§ï¼› synchronizedå¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥é—´æ¥ä¿è¯å¯è§æ€§ã€‚synchronizedä¼šå°†ç§æœ‰å†…å­˜å’Œå…¬å…±å†…å­˜ä¸­çš„æ•°æ®è¿›è¡ŒåŒæ­¥ volatileè§£å†³çš„æ˜¯å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹é—´çš„å¯è§æ€§ï¼› synchronizedè§£å†³çš„æ˜¯å¤šä¸ªçº¿ç¨‹è®¿é—®èµ„æºçš„åŒæ­¥æ€§ å†…éƒ¨ç±»åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªç±»(ç§æœ‰å†…éƒ¨ç±»ï¼Œé™æ€å†…éƒ¨ç±»)åœ¨æ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç±»(å±€éƒ¨å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±») æˆå‘˜å†…éƒ¨ç±»ç¼–è¯‘å™¨åšçš„æ‰‹è„š åœ¨å†…éƒ¨ç±»ä¸­åˆ›å»ºäº†åŒ…å¯è§æ„é€ å™¨ï¼Œä»è€Œä½¿å¤–éƒ¨ç±»è·å¾—äº†åˆ›å»ºæƒé™ åœ¨å¤–éƒ¨ç±»ä¸­åˆ›å»ºäº†è®¿é—®ç§æœ‰å˜é‡çš„é™æ€æ–¹æ³•ï¼Œä»è€Œä½¿å†…éƒ¨ç±»è·å¾—äº†èŒƒå›´æƒé™å¿…é¡»é€šè¿‡å¤–éƒ¨ç±»æ‰èƒ½è·å–å†…éƒ¨ç±» é™æ€å†…éƒ¨ç±»åªèƒ½è®¿é—®å…¶å¤–éƒ¨ç±»çš„é™æ€æˆå‘˜ å±€éƒ¨å†…éƒ¨ç±»æ²¡æœ‰ä¿®é¥°ç¬¦ï¼Œå±€éƒ¨å†…éƒ¨ç±»åªèƒ½èŒƒå›´è¯¥æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”è¿™äº›å±€éƒ¨å˜é‡ä¸€å®šè¦æ˜¯finalä¿®é¥°çš„å¸¸é‡æˆ–è€…éšå«æ˜¯finalçš„(java8) åŒ¿åå†…éƒ¨ç±»ä¸èƒ½æŠ½è±¡ï¼›ä»…èƒ½è¢«ä½¿ç”¨ä¸€æ¬¡ï¼›ä¸èƒ½å­˜åœ¨é™æ€æˆå‘˜å˜é‡å’Œæ–¹æ³• ï¼›æ˜¯å”¯ä¸€ä¸€ç§æ²¡æœ‰æ„é€ å™¨çš„ç±»ã€‚ Sessionå’ŒCookieçš„åŒºåˆ« Sessionæ˜¯åœ¨æœåŠ¡ç«¯ä¿å­˜çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨æ¥è·Ÿè¸ªç”¨æˆ·çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ•°æ®å¯ä»¥ä¿å­˜åœ¨é›†ç¾¤ã€æ•°æ®åº“ã€æ–‡ä»¶ä¸­ã€‚ Cookieæ˜¯å®¢æˆ·ç«¯ä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨æ¥è®°å½•ç”¨æˆ·çš„ä¸€äº›ä¿¡æ¯ï¼Œä¹Ÿæ˜¯å®ç°Sessionçš„ä¸€ç§æ–¹å¼ã€‚ å®¢æˆ·ç«¯ä¼ JSESSIONIDï¼ŒæœåŠ¡ç«¯å°±å¯ä»¥é€šè¿‡è¿™ä¸ªIDï¼Œæ¥å°†å­˜å‚¨åˆ°æœåŠ¡ç«¯çš„æ•°æ®å–å‡º Servletå’ŒFilterçš„åŒºåˆ« Filterå¯¹ç”¨æˆ·è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ï¼Œæ¥ç€å°†è¯·æ±‚äº¤ç»™Servletè¿›è¡Œå¤„ç†å¹¶ç”Ÿæˆå“åº”ï¼Œæœ€åFilterå†å¯¹å“åº”çš„æ•°æ®è¿›è¡Œåå¤„ç†ã€‚ å¼ºã€è½¯ã€å¼±ã€è™šå¼•ç”¨å¼ºå¼•ç”¨ Object obj=new Object()ï¼Œåªè¦å¼•ç”¨è¿˜åœ¨ï¼Œå°±ä¸ä¼šè¢«å›æ”¶è½¯å¼•ç”¨ å†…å­˜ä¸å¤Ÿæ‰ä¼šè¢«å›æ”¶å¼±å¼•ç”¨ ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ä¼šè¢«å›æ”¶ã€‚è™šå¼•ç”¨ éšæ—¶å¯èƒ½è¢«å›æ”¶ï¼Œç›®çš„æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚ åƒåœ¾å›æ”¶æœŸæ˜¯ä¸€ä¸ªä¼˜å…ˆçº§è¾ƒä½çš„çº¿ç¨‹ï¼Œå¹¶ä¸ä¸€å®šèƒ½è¿…é€Ÿå‘ç°å¼±å¼•ç”¨å¯¹è±¡ HashMapå’ŒHashtableçš„åŒºåˆ«å…ˆåæ§½ä¸€ä¸‹Hashtableçš„å‘½åï¼Œä¸ºå•¥tè¦å°å†™ Hashtableæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼› HashMapä¸æ˜¯ Hashtableä¸å…è®¸æœ‰nullçš„KVï¼› HashMapå…è®¸ Hashtableç»§æ‰¿Dictionaryç±»ï¼› HashMapç»§æ‰¿AbstractMap HashMapæœ‰ä¸€ä¸ªå­ç±»LinkedHashMapï¼Œå¯¹è¿™ä¸ªç±»å¯¹è±¡è¿›è¡Œè¿­ä»£æ—¶ï¼Œå®ƒçš„é¡ºåºæ˜¯æœ‰åºçš„ã€‚å¯ä»¥è½»æ˜“çš„å°†LinkedHashMapè½¬æ¢æˆHashMapï¼› Hashtableä¸å¥½å®ç° ç›¸åŒç‚¹ï¼šéƒ½å®ç°äº†Mapæ¥å£ joinå’Œsynchronizedçš„åŒºåˆ«joinåœ¨å†…éƒ¨ä½¿ç”¨wait()æ–¹æ³•è¿›è¡Œç­‰å¾…ï¼›synchronizedä½¿ç”¨çš„æ˜¯å¯¹è±¡ç›‘è§†å™¨åŸç†ä½œä¸ºåŒæ­¥ joinå’Œsleepçš„åŒºåˆ«joinåº•å±‚è°ƒç”¨waitæ–¹æ³•ï¼Œæ‰§è¡Œåˆ°waité‡Šæ”¾é”sleepåœ¨ç¡çœ æ—¶ä¸é‡Šæ”¾é” JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†çš„åŒºåˆ« JDKåŠ¨æ€åŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨åå°„æœºåˆ¶ç”Ÿå­˜ä¸€ä¸ªå®ç°ä»£ç†æ¥å£çš„åŒ¿åç±»ï¼Œåœ¨è°ƒç”¨å…·ä½“æ–¹æ³•å‰è°ƒç”¨InvokeHandleræ¥å¤„ç†ã€‚JDKåŠ¨æ€ä»£ç†åªèƒ½å¯¹å®ç°äº†æ¥å£çš„ç±»ç”Ÿæˆä»£ç†ï¼Œè€Œä¸èƒ½é’ˆå¯¹ç±» CGLIBåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨ASMå¼€æºåŒ…ï¼Œå°†ç›®æ ‡å¯¹è±¡ç±»çš„classæ–‡ä»¶åŠ è½½è¿›æ¥ï¼Œé€šè¿‡ä¿®æ”¹å…¶å­—èŠ‚ç ç”Ÿæˆå­ç±»æ¥å¤„ç†ã€‚CGLIBæ˜¯é’ˆå¯¹ç±»å®ç°ä»£ç†ï¼Œä¸»è¦æ˜¯å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ–¹æ³•ã€‚ JDKåŠ¨æ€ä»£ç†æ˜¯é¢å‘æ¥å£çš„ï¼Œåœ¨åˆ›å»ºä»£ç†å®ç°ç±»æ—¶æ¯”CGLIBè¦å¿«ï¼Œåˆ›å»ºä»£ç†é€Ÿåº¦å¿«ã€‚CGLIBåŠ¨æ€ä»£ç†æ˜¯é€šè¿‡å­—èŠ‚ç åº•å±‚ç»§æ‰¿è¦ä»£ç†ç±»çš„ç›®æ ‡ç±»æ¥å®ç°ï¼Œåˆ›å»ºé€Ÿåº¦æ²¡æœ‰JDKåŠ¨æ€ä»£ç†å¿«ï¼Œä½†æ˜¯è¿è¡Œé€Ÿåº¦æ¯”JDKåŠ¨æ€ä»£ç†å¿«ã€‚ é‡è½½å’Œé‡å†™çš„åŒºåˆ«é‡è½½ï¼š æ–¹æ³•æœ‰åŒæ ·çš„åç§°ï¼Œä½†æ˜¯å‚æ•°åˆ—è¡¨ä¸åŒ é‡å†™ï¼šåœ¨javaçš„å­ç±»ä¸çˆ¶ç±»ä¸­æœ‰ä¸¤ä¸ªåç§°ã€å‚æ•°åˆ—è¡¨éƒ½ç›¸åŒçš„æ–¹æ³•çš„æƒ…å†µã€‚ç”±äºå®ƒä»¬å…·æœ‰ç›¸åŒçš„æ–¹æ³•ç­¾åï¼Œæ‰€ä»¥å­ç±»ä¸­çš„æ–°æ–¹æ³•å°†è¦†ç›–çˆ¶ç±»ä¸­åŸæœ‰çš„æ–¹æ³• åŒºåˆ« é‡è½½ é‡å†™ ç¼–è¯‘æœŸæ¦‚å¿µï¼Œéµå¾ªâ€œç¼–è¯‘æœŸç»‘å®šâ€ï¼Œå³åœ¨ç¼–è¯‘æ—¶æ ¹æ®å‚æ•°å˜é‡çš„ç±»å‹åˆ¤æ–­åº”è¯¥è°ƒç”¨å“ªä¸ªæ–¹æ³• è¿è¡ŒæœŸæ¦‚å¿µï¼Œéµå¾ªâ€œè¿è¡ŒæœŸç»‘å®šâ€ï¼Œå³åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œæ ¹æ®å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å®é™…å¯¹è±¡çš„ç±»å‹æ¥è°ƒç”¨æ–¹æ³• æ–¹æ³•ç­¾åå¿…é¡»ä¸åŒ æ–¹æ³•ç­¾åå¿…é¡»ä¸€æ · è¿”å›ç±»å‹å¯ä»¥ä¸åŒ è¿”å›ç±»å‹å¿…é¡»ç›¸åŒ æ— é™åˆ¶ æ›´å¥½çš„è®¿é—®ï¼Œä¸èƒ½æŠ›å‡ºæ›´å¹¿æ³›çš„å¼‚å¸¸ï¼ˆéµå¾ªé‡Œå¼æ›¿æ¢åŸåˆ™ï¼‰ ç»„åˆä¸ç»§æ‰¿çš„åŒºåˆ«å’Œè”ç³»åœ¨ç»§æ‰¿ç»“æ„ä¸­ï¼Œçˆ¶ç±»çš„å†…éƒ¨ç»†èŠ‚å¯¹äºå­ç±»æ˜¯å¯è§çš„ã€‚æ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¹Ÿå¯ä»¥è¯´é€šè¿‡ç»§æ‰¿çš„ä»£ç å¤ç”¨æ˜¯ä¸€ç§ç™½ç›’å¼ä»£ç å¤ç”¨ã€‚ï¼ˆå¦‚æœåŸºç±»çš„å®ç°å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»çš„å®ç°ä¹Ÿå°†éšä¹‹æ”¹å˜ã€‚è¿™æ ·å°±å¯¼è‡´äº†å­ç±»è¡Œä¸ºçš„ä¸å¯é¢„çŸ¥æ€§ï¼›) ç»„åˆæ˜¯é€šè¿‡å¯¹ç°æœ‰çš„å¯¹è±¡è¿›è¡Œæ‹¼è£…ï¼ˆç»„åˆï¼‰äº§ç”Ÿæ–°çš„ã€æ›´å¤æ‚çš„åŠŸèƒ½ã€‚å› ä¸ºåœ¨å¯¹è±¡ä¹‹é—´ï¼Œå„è‡ªçš„å†…éƒ¨ç»†èŠ‚æ˜¯ä¸å¯è§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¯´è¿™ç§æ–¹å¼çš„ä»£ç å¤ç”¨æ˜¯é»‘ç›’å¼ä»£ç å¤ç”¨ã€‚ï¼ˆå› ä¸ºç»„åˆä¸­ä¸€èˆ¬éƒ½å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘æœŸæ ¹æœ¬ä¸çŸ¥é“å…·ä½“ä¼šè°ƒç”¨å“ªä¸ªå®ç°ç±»çš„æ–¹æ³•ï¼‰ ç»§æ‰¿ï¼Œåœ¨å†™ä»£ç çš„æ—¶å€™å°±è¦æŒ‡åå…·ä½“ç»§æ‰¿å“ªä¸ªç±»ï¼Œæ‰€ä»¥ï¼Œåœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº†å…³ç³»ã€‚ï¼ˆä»åŸºç±»ç»§æ‰¿æ¥çš„å®ç°æ˜¯æ— æ³•åœ¨è¿è¡ŒæœŸåŠ¨æ€æ”¹å˜çš„ï¼Œå› æ­¤é™ä½äº†åº”ç”¨çš„çµæ´»æ€§ã€‚ï¼‰ ç»„åˆï¼Œåœ¨å†™ä»£ç çš„æ—¶å€™å¯ä»¥é‡‡ç”¨é¢å‘æ¥å£ç¼–ç¨‹ã€‚æ‰€ä»¥ï¼Œç±»çš„ç»„åˆå…³ç³»ä¸€èˆ¬åœ¨è¿è¡ŒæœŸç¡®å®šã€‚ ä¼˜ç¼ºç‚¹å¯¹æ¯” ç»„ åˆ å…³ ç³» ç»§ æ‰¿ å…³ ç³» ä¼˜ç‚¹ï¼šä¸ç ´åå°è£…ï¼Œæ•´ä½“ç±»ä¸å±€éƒ¨ç±»ä¹‹é—´æ¾è€¦åˆï¼Œå½¼æ­¤ç›¸å¯¹ç‹¬ç«‹ ç¼ºç‚¹ï¼šç ´åå°è£…ï¼Œå­ç±»ä¸çˆ¶ç±»ä¹‹é—´ç´§å¯†è€¦åˆï¼Œå­ç±»ä¾èµ–äºçˆ¶ç±»çš„å®ç°ï¼Œå­ç±»ç¼ºä¹ç‹¬ç«‹æ€§ ä¼˜ç‚¹ï¼šå…·æœ‰è¾ƒå¥½çš„å¯æ‰©å±•æ€§ ç¼ºç‚¹ï¼šæ”¯æŒæ‰©å±•ï¼Œä½†æ˜¯å¾€å¾€ä»¥å¢åŠ ç³»ç»Ÿç»“æ„çš„å¤æ‚åº¦ä¸ºä»£ä»· ä¼˜ç‚¹ï¼šæ”¯æŒåŠ¨æ€ç»„åˆã€‚åœ¨è¿è¡Œæ—¶ï¼Œæ•´ä½“å¯¹è±¡å¯ä»¥é€‰æ‹©ä¸åŒç±»å‹çš„å±€éƒ¨å¯¹è±¡ ç¼ºç‚¹ï¼šä¸æ”¯æŒåŠ¨æ€ç»§æ‰¿ã€‚åœ¨è¿è¡Œæ—¶ï¼Œå­ç±»æ— æ³•é€‰æ‹©ä¸åŒçš„çˆ¶ç±» ä¼˜ç‚¹ï¼šæ•´ä½“ç±»å¯ä»¥å¯¹å±€éƒ¨ç±»è¿›è¡ŒåŒ…è£…ï¼Œå°è£…å±€éƒ¨ç±»çš„æ¥å£ï¼Œæä¾›æ–°çš„æ¥å£ ç¼ºç‚¹ï¼šå­ç±»ä¸èƒ½æ”¹å˜çˆ¶ç±»çš„æ¥å£ ç¼ºç‚¹ï¼šæ•´ä½“ç±»ä¸èƒ½è‡ªåŠ¨è·å¾—å’Œå±€éƒ¨ç±»åŒæ ·çš„æ¥å£ ä¼˜ç‚¹ï¼šå­ç±»èƒ½è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„æ¥å£ ç¼ºç‚¹ï¼šåˆ›å»ºæ•´ä½“ç±»çš„å¯¹è±¡æ—¶ï¼Œéœ€è¦åˆ›å»ºæ‰€æœ‰å±€éƒ¨ç±»çš„å¯¹è±¡ ä¼˜ç‚¹ï¼šåˆ›å»ºå­ç±»çš„å¯¹è±¡æ—¶ï¼Œæ— é¡»åˆ›å»ºçˆ¶ç±»çš„å¯¹è±¡ å¦‚ä½•é€‰æ‹© ç»§æ‰¿è¦æ…ç”¨ï¼Œå…¶ä½¿ç”¨åœºåˆä»…é™äºä½ ç¡®ä¿¡ä½¿ç”¨è¯¥æŠ€æœ¯æœ‰æ•ˆçš„æƒ…å†µã€‚ä¸€ä¸ªåˆ¤æ–­æ–¹æ³•æ˜¯ï¼Œé—®ä¸€é—®è‡ªå·±æ˜¯å¦éœ€è¦ä»æ–°ç±»å‘åŸºç±»è¿›è¡Œå‘ä¸Šè½¬å‹ã€‚å¦‚æœæ˜¯å¿…é¡»çš„ï¼Œåˆ™ç»§æ‰¿æ˜¯å¿…è¦çš„ã€‚åä¹‹åˆ™åº”è¯¥å¥½å¥½è€ƒè™‘æ˜¯å¦éœ€è¦ç»§æ‰¿ã€‚&lt;&lt;javaç¼–ç¨‹æ€æƒ³&gt;&gt; åªæœ‰å½“å­ç±»çœŸæ­£æ˜¯è¶…ç±»çš„å­ç±»å‹æ—¶ï¼Œæ‰é€‚åˆç”¨ç»§æ‰¿ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºä¸¤ä¸ªç±»Aå’ŒBï¼Œåªæœ‰å½“ä¸¤è€…ä¹‹é—´ç¡®å®å­˜åœ¨is-aå…³ç³»çš„æ—¶å€™ï¼Œç±»Bæ‰åº”è¯¥ç»§æ‰¿ç±»Aã€‚&lt;> Compareableå’ŒComparatorComparableï¼šä¸€ä¸ªå®ç°äº†Comparableæ¥å£çš„ç±»ï¼Œå¯ä»¥è®©å…¶è‡ªèº«çš„å¯¹è±¡å’Œå…¶å®ƒå¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªç±»çš„å¯¹è±¡ä¹‹é—´è¦æƒ³æ¯”è¾ƒï¼Œå¯¹åº”çš„ç±»å°±è¦å®ç°Compareableæ¥å£ï¼Œå¹¶å®ç°compareTo()æ–¹æ³•ã€‚ Comparatorï¼šä¸æ”¹å˜åŸæœ‰çš„ç±»ã€‚é€šè¿‡å®šä¹‰ä¸€ä¸ªç±»å®ç°Comparatoræ¥å£ï¼Œé‡å†™compare()æ–¹æ³•ã€‚ Comparatoré€šå¸¸ç”¨äºæ’åºã€‚Javaä¸­çš„Collectinoså’ŒArrayséƒ½åŒ…æ‹¬æ’åºçš„sortæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªComparatorçš„å®ä¾‹(æ¯”è¾ƒå™¨)æ¥è¿›è¡Œæ’åºï¼›new TreeSet&lt;&gt;(new Comparator()) getAttributeå’ŒgetParameterçš„åŒºåˆ«ServletRequestæ¥å£ä¸­æä¾›äº†getAttributeå’ŒgetParameterä¸¤ä¸ªæ–¹æ³•ï¼Œéƒ½æ˜¯ç”¨äºè·å–å‚æ•°ï¼ˆå±æ€§ï¼‰å€¼çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæˆ–è€…è¯´Attributeå’ŒParameterçš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æ¥æºä¸åŒ å‚æ•°ï¼ˆparameterï¼‰æ˜¯ä»å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¸­ç”±ç”¨æˆ·æä¾›çš„ï¼Œè‹¥æ˜¯GETæ–¹æ³•æ˜¯ä»URLä¸­ æä¾›çš„ï¼Œè‹¥æ˜¯POSTæ–¹æ³•æ˜¯ä»è¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰ä¸­æä¾›çš„ï¼› å±æ€§ï¼ˆattributeï¼‰æ˜¯æœåŠ¡å™¨ç«¯çš„ç»„ä»¶ï¼ˆJSPæˆ–è€…Servletï¼‰åˆ©ç”¨requst.setAttributeï¼ˆï¼‰è®¾ç½®çš„. æ“ä½œä¸åŒ å‚æ•°ï¼ˆparameterï¼‰çš„å€¼åªèƒ½è¯»å–ä¸èƒ½ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.getParameter()è¯»å–ï¼› å±æ€§ï¼ˆattributeï¼‰çš„å€¼æ—¢å¯ä»¥è¯»å–äº¦å¯ä»¥ä¿®æ”¹ï¼Œè¯»å–å¯ä»¥ä½¿ç”¨request.setAttribute(),è®¾ç½®å¯ä½¿ç”¨request.getAttribute() æ•°æ®ç±»å‹ä¸åŒ å‚æ•°ï¼ˆparameterï¼‰ä¸ç®¡å‰å°ä¼ æ¥çš„å€¼è¯­ä¹‰æ˜¯ä»€ä¹ˆï¼Œåœ¨æœåŠ¡å™¨è·å–æ—¶éƒ½ä»¥Stringç±»å‹çœ‹å¾…ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯çš„å‚æ•°å€¼åªèƒ½æ˜¯ç®€å•ç±»å‹çš„å€¼ï¼Œä¸èƒ½æ˜¯å¤æ‚ç±»å‹ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯¹è±¡ã€‚ å±æ€§ï¼ˆattributeï¼‰çš„å€¼å¯ä»¥æ˜¯ä»»æ„ä¸€ä¸ªObjectç±»å‹ã€‚ forwardå’Œincludeçš„åŒºåˆ«void forward(ServletRequest request, ServletResponse response) â€“ æŠŠä¸€ä¸ªservletçš„è¯·æ±‚è½¬å‘åˆ°æœåŠ¡å™¨ä¸Šçš„å…¶ä»–èµ„æºä¸­ï¼ˆHtmlã€jspã€servletï¼‰ã€‚ void include(ServletRequest request, ServletResponse response) â€“ æŠŠå¦ä¸€ä¸ªèµ„æºçš„å†…å®¹åŒ…å«åˆ°å½“å‰å“åº”ä¸­ã€‚ å¦‚æœä½¿ç”¨forwardè·³è½¬ï¼Œforwardè¯­å¥åé¢çš„responseè¾“å‡ºåˆ™ä¸ä¼šæ‰§è¡Œï¼Œä¼šè·³è½¬åˆ°forwardæŒ‡å®šçš„servletä¸­å»æ‰§è¡Œã€‚ ç”¨includeæ¥è·³è½¬ï¼Œåˆ™includeçš„servletæ‰§è¡Œå®Œåï¼Œå†è¿”å›åˆ°åŸæ¥çš„servletæ‰§è¡Œforwardè¯­å¥åé¢çš„responseçš„è¾“å‡ºã€‚ å¹¶å‘ä¸å¹¶è¡Œå¹¶å‘ï¼šåŒä¸€æ—¶é—´æ®µå†…çš„å¤šä¸ªäº‹ä»¶å¹¶è¡Œï¼šåŒä¸€æ—¶åˆ»çš„å¤šä¸ªäº‹ä»¶","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"hash","slug":"hash","date":"2018-04-08T13:23:41.000Z","updated":"2018-04-20T13:16:15.814Z","comments":true,"path":"2018/04/08/hash/","link":"","permalink":"https://hsb786.github.io/2018/04/08/hash/","excerpt":"Hashï¼Œä¸€èˆ¬ç¿»è¯‘åšâ€œæ•£åˆ—â€ï¼Œä¹Ÿæœ‰ç›´æ¥éŸ³è¯‘ä¸ºâ€œå“ˆå¸Œâ€çš„ï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œé€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ã€‚è¿™ç§è½¬æ¢æ˜¯ä¸€ç§å‹ç¼©æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ•£åˆ—å€¼çš„ç©ºé—´é€šå¸¸è¿œå°äºè¾“å…¥çš„ç©ºé—´ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šæ•£åˆ—æˆç›¸åŒçš„è¾“å‡ºï¼Œæ‰€ä»¥ä¸å¯èƒ½ä»æ•£åˆ—å€¼æ¥å”¯ä¸€çš„ç¡®å®šè¾“å…¥å€¼ã€‚ç®€å•çš„è¯´å°±æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯æ‘˜è¦çš„å‡½æ•°ã€‚","text":"Hashï¼Œä¸€èˆ¬ç¿»è¯‘åšâ€œæ•£åˆ—â€ï¼Œä¹Ÿæœ‰ç›´æ¥éŸ³è¯‘ä¸ºâ€œå“ˆå¸Œâ€çš„ï¼Œå°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œé€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ã€‚è¿™ç§è½¬æ¢æ˜¯ä¸€ç§å‹ç¼©æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ•£åˆ—å€¼çš„ç©ºé—´é€šå¸¸è¿œå°äºè¾“å…¥çš„ç©ºé—´ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šæ•£åˆ—æˆç›¸åŒçš„è¾“å‡ºï¼Œæ‰€ä»¥ä¸å¯èƒ½ä»æ•£åˆ—å€¼æ¥å”¯ä¸€çš„ç¡®å®šè¾“å…¥å€¼ã€‚ç®€å•çš„è¯´å°±æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯æ‘˜è¦çš„å‡½æ•°ã€‚ æ‰€æœ‰æ•£åˆ—å‡½æ•°éƒ½æœ‰å¦‚ä¸‹ä¸€ä¸ªåŸºæœ¬ç‰¹æ€§ï¼šæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„æ•£åˆ—å€¼å¦‚æœä¸åŒï¼Œé‚£ä¹ˆè¾“å…¥å€¼è‚¯å®šä¹Ÿä¸åŒã€‚ä½†æ˜¯ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„æ•£åˆ—å€¼å¦‚æœç›¸åŒï¼Œè¾“å…¥å€¼ä¸ä¸€å®šç›¸åŒã€‚ ä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„æ•£åˆ—å€¼ç›¸åŒçš„ç°è±¡å«åšç¢°æ’ã€‚ å¸¸è§çš„Hashå‡½æ•°æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š ç›´æ¥å®šå€æ³•ï¼šç›´æ¥ä»¥å…³é”®å­—kæˆ–è€…kåŠ ä¸ŠæŸä¸ªå¸¸æ•°ï¼ˆk+cï¼‰ä½œä¸ºå“ˆå¸Œåœ°å€ã€‚ æ•°å­—åˆ†ææ³•ï¼šæå–å…³é”®å­—ä¸­å–å€¼æ¯”è¾ƒå‡åŒ€çš„æ•°å­—ä½œä¸ºå“ˆå¸Œåœ°å€ã€‚ é™¤ç•™ä½™æ•°æ³•ï¼šç”¨å…³é”®å­—ké™¤ä»¥æŸä¸ªä¸å¤§äºå“ˆå¸Œè¡¨é•¿åº¦mçš„æ•°pï¼Œå°†æ‰€å¾—ä½™æ•°ä½œä¸ºå“ˆå¸Œè¡¨åœ°å€ã€‚ åˆ†æ®µå åŠ æ³•ï¼šæŒ‰ç…§å“ˆå¸Œè¡¨åœ°å€ä½æ•°å°†å…³é”®å­—åˆ†æˆä½æ•°ç›¸ç­‰çš„å‡ éƒ¨åˆ†ï¼Œå…¶ä¸­æœ€åä¸€éƒ¨åˆ†å¯ä»¥æ¯”è¾ƒçŸ­ã€‚ç„¶åå°†è¿™å‡ éƒ¨åˆ†ç›¸åŠ ï¼Œèˆå¼ƒæœ€é«˜è¿›ä½åçš„ç»“æœå°±æ˜¯è¯¥å…³é”®å­—çš„å“ˆå¸Œåœ°å€ã€‚ å¹³æ–¹å–ä¸­æ³•ï¼šå¦‚æœå…³é”®å­—å„ä¸ªéƒ¨åˆ†åˆ†å¸ƒéƒ½ä¸å‡åŒ€çš„è¯ï¼Œå¯ä»¥å…ˆæ±‚å‡ºå®ƒçš„å¹³æ–¹å€¼ï¼Œç„¶åæŒ‰ç…§éœ€æ±‚å–ä¸­é—´çš„å‡ ä½ä½œä¸ºå“ˆå¸Œåœ°å€ã€‚ ä¼ªéšæœºæ•°æ³•ï¼šé‡‡ç”¨ä¸€ä¸ªä¼ªéšæœºæ•°å½“ä½œå“ˆå¸Œå‡½æ•°ã€‚ ä¸Šé¢ä»‹ç»è¿‡ç¢°æ’ã€‚è¡¡é‡ä¸€ä¸ªå“ˆå¸Œå‡½æ•°çš„å¥½åçš„é‡è¦æŒ‡æ ‡å°±æ˜¯å‘ç”Ÿç¢°æ’çš„æ¦‚ç‡ä»¥åŠå‘ç”Ÿç¢°æ’çš„è§£å†³æ–¹æ¡ˆã€‚ä»»ä½•å“ˆå¸Œå‡½æ•°åŸºæœ¬éƒ½æ— æ³•å½»åº•é¿å…ç¢°æ’ï¼Œå¸¸è§çš„è§£å†³ç¢°æ’çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š å¼€æ”¾å®šå€æ³•ï¼š å¼€æ”¾å®šå€æ³•å°±æ˜¯ä¸€æ—¦å‘ç”Ÿäº†å†²çªï¼Œå°±å»å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºçš„æ•£åˆ—åœ°å€ï¼Œåªè¦æ•£åˆ—è¡¨è¶³å¤Ÿå¤§ï¼Œç©ºçš„æ•£åˆ—åœ°å€æ€»èƒ½æ‰¾åˆ°ï¼Œå¹¶å°†è®°å½•å­˜å…¥ã€‚ é“¾åœ°å€æ³• å°†å“ˆå¸Œè¡¨çš„æ¯ä¸ªå•å…ƒä½œä¸ºé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œæ‰€æœ‰å“ˆå¸Œåœ°å€ä¸ºiçš„å…ƒç´ æ„æˆä¸€ä¸ªåŒä¹‰è¯é“¾è¡¨ã€‚å³å‘ç”Ÿå†²çªæ—¶å°±æŠŠè¯¥å…³é”®å­—é“¾åœ¨ä»¥è¯¥å•å…ƒä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨çš„å°¾éƒ¨ã€‚ å†å“ˆå¸Œæ³• å½“å“ˆå¸Œåœ°å€å‘ç”Ÿå†²çªç”¨å…¶ä»–çš„å‡½æ•°è®¡ç®—å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°åœ°å€ï¼Œç›´åˆ°å†²çªä¸å†äº§ç”Ÿä¸ºæ­¢ã€‚ å»ºç«‹å…¬å…±æº¢å‡ºåŒº å°†å“ˆå¸Œè¡¨åˆ†ä¸ºåŸºæœ¬è¡¨å’Œæº¢å‡ºè¡¨ä¸¤éƒ¨åˆ†ï¼Œå‘ç”Ÿå†²çªçš„å…ƒç´ éƒ½æ”¾å…¥æº¢å‡ºè¡¨ä¸­ã€‚ å‚è€ƒ å…¨ç½‘æŠŠMapä¸­çš„hash()åˆ†æçš„æœ€é€å½»çš„æ–‡ç« ï¼Œåˆ«æ— äºŒå®¶ã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"SpringMVC","slug":"SpringMVC","date":"2018-04-08T09:58:41.000Z","updated":"2018-05-08T12:52:25.141Z","comments":true,"path":"2018/04/08/SpringMVC/","link":"","permalink":"https://hsb786.github.io/2018/04/08/SpringMVC/","excerpt":"SpringMVCå·¥ä½œæµç¨‹SpringMVCæ˜¯ä¸€ç§åŸºäºServeltçš„æŠ€æœ¯ï¼Œå®ƒæä¾›äº†æ§åˆ¶å™¨DispatchServletå’Œç›¸å…³ç»„ä»¶ï¼Œè¿™äº›SpringMVCçš„ç»„ä»¶ä¸€èµ·åè°ƒå·¥ä½œï¼Œå®Œæˆå¯¹webè¯·æ±‚çš„ç›¸åº”ã€‚","text":"SpringMVCå·¥ä½œæµç¨‹SpringMVCæ˜¯ä¸€ç§åŸºäºServeltçš„æŠ€æœ¯ï¼Œå®ƒæä¾›äº†æ§åˆ¶å™¨DispatchServletå’Œç›¸å…³ç»„ä»¶ï¼Œè¿™äº›SpringMVCçš„ç»„ä»¶ä¸€èµ·åè°ƒå·¥ä½œï¼Œå®Œæˆå¯¹webè¯·æ±‚çš„ç›¸åº”ã€‚ å®¢æˆ·ç«¯å‘å‡ºä¸€ä¸ªHTTPè¯·æ±‚ï¼ŒWebæœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨æ£€æŸ¥HTTPè¯·æ±‚çš„è·¯å¾„ï¼Œå¦‚æœåŒ¹é…DispatchServeltçš„è¯·æ±‚æ˜ å°„è·¯å¾„(web.xmlä¸­æŒ‡å®š)ï¼Œåˆ™Webå®¹å™¨å°†è¯¥è¯·æ±‚è½¬äº¤ç»™å¯¹åº”çš„DispatchServletå¤„ç† DispatchServletæ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åï¼Œå°†æ ¹æ®è¯·æ±‚çš„ä¿¡æ¯ä»¥åŠHandlerMappingé…ç½®æ‰¾åˆ°å¤„ç†è¯·æ±‚çš„å¤„ç†å™¨ï¼ˆHandlerï¼‰ã€‚HandlerMappingå¯ä»¥ç®€å•ç†è§£ä¸ºç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦URLåŸŸä¸å¤„ç†å™¨Handlerä¹‹é—´çš„å…³ç³»ã€‚ æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å™¨ä¹‹åï¼Œé€šè¿‡HandlerAdapterå¯¹Handlerè¿›è¡Œå°è£…ï¼Œå†ä»¥åŒä¸€çš„é€‚é…å™¨æ¥å£è°ƒç”¨Handlerã€‚å› ä¸ºä¸ºäº†æ›´åŠ çµæ´»çš„ç¼–ç å’ŒAOPå¢å¼ºåŠŸèƒ½ï¼ŒSpringMVCä¼šç»™å¤„ç†å™¨åŠ å…¥æ‹¦æˆªå™¨ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å¤„ç†å™¨æ‰§è¡Œå‰ååŠ å…¥æ‰§è¡Œå‰ååŠ å…¥è‡ªå·±çš„ä»£ç ï¼Œäºæ˜¯å°±æ„æˆäº†ä¸€ä¸ªå¤„ç†å™¨çš„æ‰§è¡Œé“¾ï¼Œæ‰€ä»¥SpringMVCæä¾›äº†å¤„ç†å™¨é€‚é…å™¨HandlerAdapterï¼Œå¸®åŠ©æˆ‘ä»¬è¿è¡Œç›¸åº”çš„å¤„ç†å™¨ä»¥åŠæˆ‘ä»¬æ·»åŠ è¿›å»çš„æ‹¦æˆªå™¨ã€‚ å¤„ç†å™¨å®Œæˆäº†è¯·æ±‚çš„ä¸šåŠ¡é€»è¾‘ä¹‹åå°†è¿”å›ä¸€ä¸ªModelAndViewå¯¹è±¡ç»™DIspatcherServletï¼Œè¿™é‡ŒModelAndViewåŒ…å«äº†è§†å›¾çš„é€»è¾‘åå’Œæ¨¡å‹æ•°æ®ä¿¡æ¯ã€‚ å¾—åˆ°äº†ModelAndViewä¹‹åï¼ŒDispatchServletå€ŸåŠ©ViewResolverè§†å›¾è§£æå™¨å°†é€»è¾‘è¯•å›¾è½¬æ¢ä¸ºçœŸå®è§†å›¾ã€‚ é€šè¿‡ViewResolverè§†å›¾è§£æå™¨å¾—åˆ°äº†çœŸå®è§†å›¾åï¼ŒDispatServletä½¿ç”¨è¿™ä¸ªçœŸå®è§†å›¾å¯¹è±¡å¯¹ModelAndViewä¸­çš„æ¨¡å‹æ•°æ®è¿›è¡Œæ¸²æŸ“ã€‚ æœ€ç»ˆDispatchServletå°†æ¸²æŸ“è¿‡åçš„è§†å›¾å¯¹è±¡è¿”å›ç»™è¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å¾—åˆ°çš„å“åº”å¯èƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„HTMLé¡µé¢ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªJSONä¸²ï¼Œç”šè‡³æ˜¯ä¸€å¼ å›¾ç‰‡ç­‰ç­‰ä¸åŒçš„è§†å›¾æ¨¡å‹ã€‚ å¦ä¸€ä¸ªè¯´æ³• DispatcherServletæ˜¯ä»€ä¹ˆå®ƒæ˜¯Spring MVCçš„æ ¸å¿ƒã€‚æ¯ä¸ªç”±Spring MVCå¤„ç†çš„è¯·æ±‚éƒ½è¦ç»è¿‡DispatcherServletã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå®ƒæ˜¯å‰ç«¯æ§åˆ¶å™¨æ¨¡å¼çš„å®ç°ï¼Œä¸ºåº”ç”¨æä¾›ä¸€ä¸ªç»Ÿä¸€å…¥å£ã€‚DispatcherServletæ˜¯è¿æ¥Javaä¸Springçš„æ¡¥æ¢ï¼Œå¤„ç†æ‰€æœ‰ä¼ å…¥çš„è¯·æ±‚ã€‚å¹¶ä¸”ä¸å…¶ä»–å£°æ˜åœ¨web.xmlä¸­çš„Servletä¸€æ ·ï¼Œä¹Ÿæ˜¯é€šè¿‡ä¸€ä¸ªURL patternå°†æ¯ä¸ªè¯·æ±‚æ˜ å°„åˆ°DispatcherServletã€‚DispatcherServletè´Ÿè´£å°†è¯·æ±‚å§”æ´¾ç»™Spring MVCä¸­å…¶ä»–çš„ç»„å¤„ä»¶ç†ï¼Œæ¯”å¦‚æ³¨æœ‰@Controlleræˆ–@RestControllerçš„Controllerç±»ï¼ŒHandlerMappersï¼ˆå¤„ç†æ˜ å°„ï¼‰ï¼ŒView Resolvers(è§†å›¾è§£æå™¨)ç­‰ç­‰ã€‚ å°½ç®¡ï¼Œè¯·æ±‚æ˜ å°„æ˜¯ç”± @ResquestMapping æ³¨è§£å®Œæˆçš„ï¼Œä½†å®é™…ä¸Šæ˜¯ç”± DispatcherServlet å°†è¯·æ±‚å§”æ´¾ç»™ç›¸åº”çš„ Controller æ¥å¤„ç†çš„ã€‚ DispatcherServletå¦‚ä½•å¤„ç†è¯·æ±‚æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼ŒDispatcherServlet è¢«ç”¨æ¥å¤„ç†æ‰€æœ‰ä¼ å…¥çš„è¯·æ±‚ï¼Œå¹¶å°†å®ƒä»¬è·¯ç”±åˆ°ä¸åŒçš„ Controller æ¥è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ã€‚å®ƒå†³å®šäº†ç”±å“ªä¸ª Controller å¤„ç†è¯·æ±‚ã€‚ DispatcherServlet ä½¿ç”¨å¤„ç†å™¨æ˜ å°„æ¥å°†ä¼ å…¥çš„è¯·æ±‚è·¯ç”±åˆ°å¤„ç†å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨ BeanNameUrlHandlerMapping å’Œ ç”± @RequestMapping æ³¨è§£é©±åŠ¨çš„DefaultAnnotationHandlerMappingã€‚ ä¸ºäº†æ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ï¼Œå®ƒä¼šæ‰«ææ‰€æœ‰å£°æ˜äº† @Controller æ³¨è§£çš„ç±»ï¼Œå¹¶ä¸”é€šè¿‡ @RequestMapping æ³¨è§£æ‰¾åˆ°è´Ÿè´£å¤„ç†è¯¥è¯·æ±‚çš„æ–¹æ³•ã€‚@RequestMapping æ³¨è§£å¯ä»¥é€šè¿‡è·¯å¾„æ¥æ˜ å°„è¯·æ±‚(æ¯”å¦‚: @RequestMapping(â€œpathâ€)), ä¹Ÿå¯ä»¥é€šè¿‡ HTTP æ–¹æ³•(æ¯”å¦‚: @RequestMapping(â€œpathâ€, method=RequestMethod.GET)), ä¹Ÿå¯ä»¥é€šè¿‡è¯·æ±‚å‚æ•°(æ¯”å¦‚: @RequestMapping(â€œpathâ€â€, method=RequestMethod.POST, params=â€param1â€)),è¿˜å¯ä»¥é€šè¿‡ HTTP è¯·æ±‚å¤´(æ¯”å¦‚: @RequestMapping(â€œpathâ€, header=â€content-type=text/*â€))ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç±»çº§åˆ«å£°æ˜ @RequestMapping æ³¨è§£æ¥è¿‡æ»¤ä¼ å…¥çš„è¯·æ±‚ã€‚ åœ¨è¯·æ±‚å¤„ç†ä¹‹åï¼ŒController ä¼šå°†é€»è¾‘è§†å›¾çš„åå­—å’Œ model è¿”å›ç»™ DispatcherServletã€‚ä¹‹ååˆ©ç”¨è§†å›¾è§£æå™¨å®šä½åˆ°çœŸæ­£çš„ View ä»¥ä¾¿æ¸²æŸ“ç»“æœã€‚æˆ‘ä»¬å¯ä»¥æŒ‡å®šä½¿ç”¨çš„è§†å›¾è§£æå™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒDispatcherServlet ä½¿ç”¨ InternalResourceViewResolveræ¥å°†é€»è¾‘è§†å›¾çš„åå­—è½¬æ¢æˆçœŸæ­£çš„è§†å›¾ï¼Œæ¯”å¦‚ JSPã€‚ é€‰å®šè§†å›¾ä¹‹åï¼ŒDispatcherServlet ä¼šå°†æ•°æ®æ¨¡å‹ä¸è§†å›¾ç›¸ç»“åˆï¼Œå¹¶å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¹¶ä¸æ˜¯ä»»ä½•æ—¶å€™éƒ½éœ€è¦è§†å›¾ï¼Œæ¯”å¦‚ä¸€ä¸ª RESTful çš„ web æœåŠ¡å°±ä¸éœ€è¦ï¼Œå®ƒä»¬çš„å¤„ç†æ–¹æ³•ä¼šåˆ©ç”¨ @ResponseBody æ³¨è§£ç›´æ¥å°†è¯·æ±‚ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¯ä»¥çœ‹REST with Spring courseäº†è§£æ›´å¤šå…³äºå¦‚ä½•ä½¿ç”¨ Spring MVC å¼€å‘å’Œæµ‹è¯• RESTful æœåŠ¡çš„çŸ¥è¯†ã€‚ æ€»ç»“ DispatcherServlet æ˜¯ Spring MVC åº”ç”¨ä¸­ä¸»è¦çš„æ§åˆ¶å™¨ã€‚æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šå…ˆç»ç”± DispatcherServlet å¤„ç†ï¼Œå†ç”± Controller (å£°æ˜æœ‰ @Controller æ³¨è§£çš„ç±») å¤„ç†ã€‚ DispatcherServlet æ˜¯å‰ç«¯æ§åˆ¶å™¨æ¨¡å¼çš„å®ç°ã€‚å‰ç«¯æ§åˆ¶å™¨å°±æ˜¯ä¸ªç”¨æ¥å¤„ç†ç½‘ç«™æ‰€æœ‰è¯·æ±‚çš„æ§åˆ¶å™¨ã€‚ å°±åƒå…¶ä»–çš„ Servletï¼Œ DispatcherServlet ä¹Ÿæ˜¯å£°æ˜å’Œé…ç½®åœ¨ web.xml æ–‡ä»¶ä¸­çš„ï¼š 1234567891011&lt;web-app&gt; &lt;servlet&gt; &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt; &lt;url-pattern&gt;*&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;/web-app&gt; DispatcherServlet ç»§æ‰¿è‡ª HttpServlet åŸºç±»ã€‚Servlet å¼•æ“(æ¯”å¦‚ Tomcat) åˆ›å»ºè¯¥ç±»çš„å®ä¾‹ï¼Œå¹¶ä¸”è°ƒç”¨å®ƒä¸åŒçš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šinit(), service(), destroy()ã€‚ DispatcherServlet ä¸º Spring MVC åº”ç”¨æä¾›ç»Ÿä¸€å…¥å£ï¼Œå¤„ç†æ‰€æœ‰çš„è¯·æ±‚ã€‚ DispatcherServlet ä¹Ÿå®Œå…¨ä¸ Spring IoC å®¹å™¨é›†æˆï¼Œå¯ä»¥ä½¿ç”¨ Spring æ¡†æ¶çš„æ¯ä¸€ä¸ªç‰¹æ€§ï¼Œæ¯”å¦‚ä¾èµ–æ³¨å…¥ã€‚ å½“ DispatcherServlet è¢«é…ç½®ä¸º load-on-startup = 1,æ„å‘³ç€è¯¥ servlet ä¼šåœ¨å¯åŠ¨æ—¶ç”±å®¹å™¨åˆ›å»ºï¼Œè€Œä¸æ˜¯åœ¨è¯·æ±‚åˆ°è¾¾æ—¶ã€‚è¿™æ ·åšä¼šé™ä½ç¬¬ä¸€æ¬¡è¯·æ±‚çš„å“åº”æ—¶é—´ï¼Œå› ä¸ºDispatcherServlet ä¼šåœ¨å¯åŠ¨æ—¶åšå¤§é‡å·¥ä½œï¼ŒåŒ…æ‹¬æ‰«æå’ŒæŸ¥æ‰¾æ‰€æœ‰çš„ Controller å’Œ RequestMappingã€‚ åœ¨ DispatcherServlet åˆå§‹åŒ–æœŸé—´ï¼ŒSpring æ¡†æ¶ä¼šåœ¨ WEB-INF æ–‡ä»¶å¤¹ä¸­æŸ¥æ‰¾åä¸º [servlet-name]-servlet.xml çš„æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºç›¸åº”çš„ beanã€‚æ¯”å¦‚ï¼Œå¦‚æœ servlet åƒä¸Šé¢ web.xml æ–‡ä»¶ä¸­é…ç½®çš„ä¸€æ ·ï¼Œåä¸º â€œSpringMVCâ€ï¼Œé‚£ä¹ˆä¼šæŸ¥æ‰¾ â€œSpringMVC-Servlet.xmlâ€çš„æ–‡ä»¶ã€‚å¦‚æœå…¨å±€ä½œç”¨åŸŸä¸­æœ‰ç›¸åŒåå­—çš„beanï¼Œä¼šè¢«è¦†ç›–ã€‚å¯ä»¥ç”¨ servlet åˆå§‹åŒ–å‚æ•° contextConfigLocationæ›´æ”¹é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚ åœ¨ Spring MVC æ¡†æ¶ä¸­ï¼Œæ¯ä¸ª DispatcherServlet éƒ½æœ‰å®ƒè‡ªå·±çš„ WebApplicationContext ï¼Œå¹¶ä¸”ç»§æ‰¿äº†æ ¹ WebApplicationContext ä¸­å®šä¹‰çš„æ‰€æœ‰ beanã€‚è¿™äº›ç»§æ‰¿çš„ bean åœ¨ servlet æŒ‡å®šçš„ä½œç”¨åŸŸä¸­å¯ä»¥è¢«é‡è½½ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶æŒ‡å®šä½œç”¨åŸŸä¸­å®šä¹‰æ–°çš„ beanã€‚ Spring MVC ä¸­çš„ DispatcherServletä¹Ÿå…è®¸è¿”å› Servlet API å®šä¹‰çš„ last-modification-dateã€‚ä¸ºäº†å†³å®šè¯·æ±‚æœ€åä¿®æ”¹æ—¶é—´ï¼ŒDispatcherServletä¼šå…ˆæŸ¥æ‰¾åˆé€‚çš„ handler mappingï¼Œç„¶åæ£€æµ‹å¤„ç†å™¨æ˜¯å¦å®ç°äº† LastModified æ¥å£ã€‚å¦‚æœå®ç°äº†ï¼Œå°±è°ƒç”¨æ¥å£çš„ getLastModified(request) æ–¹æ³•ï¼Œå¹¶å°†è¯¥å€¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ ä»¥ä¸Šå°±æ˜¯å…³äº DispatcherSerlvet çš„å†…å®¹ã€‚æ­£å¦‚ä¸Šé¢æ‰€è®²ï¼ŒDispacherServlet æ˜¯ Spring MVC çš„éª¨å¹²ï¼Œæ˜¯ä¸»è¦çš„æ§åˆ¶å™¨ï¼Œç”¨æ¥å°†ä¸åŒçš„ HTTP è¯·æ±‚è·¯ç”±å½“ç›¸åº”çš„ Controllerã€‚å®ƒæ˜¯å‰ç«¯æ§åˆ¶å™¨è®¾è®¡æ¨¡å¼çš„å®ç°ï¼Œå¹¶ä¸”ä¸ºåº”ç”¨æä¾›å•ä¸€å…¥å£ã€‚å¯ä»¥åœ¨ web.xml ä¸­é…ç½® DispatcherServletï¼Œä½†å»ºè®®å°† load-on-startup è®¾ç½®ä¸º 1ã€‚è¿™æ ·å®¹å™¨ä¼šåœ¨å¯åŠ¨æ—¶åŠ è½½è¯¥ Serlvet è€Œä¸æ˜¯è¯·æ±‚åˆ°è¾¾æ—¶ã€‚è¿™æ ·èƒ½å‡å°‘ç¬¬ä¸€ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´ã€‚ å‚è€ƒ Spring-MVCæ¡†æ¶å…¥é—¨ ã€è¯‘ã€‘Spring MVC ä¸­çš„ DispatcherServlet","categories":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/categories/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"}]},{"title":"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’","slug":"å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’","date":"2018-04-08T09:58:41.000Z","updated":"2018-05-08T12:48:27.514Z","comments":true,"path":"2018/04/08/å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’/","link":"","permalink":"https://hsb786.github.io/2018/04/08/å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’/","excerpt":"å€¼ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°å¤åˆ¶ä¸€ä»½ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†ä¸ä¼šå½±å“åˆ°å®é™…å‚æ•°ã€‚ å¼•ç”¨ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°çš„åœ°å€ç›´æ¥ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†å½±å“åˆ°å®é™…å‚æ•°ã€‚","text":"å€¼ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°å¤åˆ¶ä¸€ä»½ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†ä¸ä¼šå½±å“åˆ°å®é™…å‚æ•°ã€‚ å¼•ç”¨ä¼ é€’ æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°çš„åœ°å€ç›´æ¥ä¼ é€’åˆ°å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†å½±å“åˆ°å®é™…å‚æ•°ã€‚ æ±‚å€¼ç­–ç•¥ æ±‚å€¼æ—¶é—´ æ±‚å€¼æ–¹å¼ æ ¹æœ¬åŒºåˆ« å€¼ä¼ é€’ è°ƒç”¨å‰ å€¼çš„ç»“æœï¼ˆåŸå€¼çš„å‰¯æœ¬ï¼‰ ä¼šåˆ›å»ºå‰¯æœ¬ å¼•ç”¨ä¼ é€’ è°ƒç”¨å‰ åŸå€¼ï¼ˆåŸå§‹å¯¹è±¡ï¼Œæ— å‰¯æœ¬ï¼‰ ä¸åˆ›å»ºå‰¯æœ¬ å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ«å¹¶ä¸æ˜¯ä¼ é€’çš„å†…å®¹ï¼Œè€Œæ˜¯å®å‚åˆ°åº•æœ‰æ²¡æœ‰è¢«å¤åˆ¶ä¸€ä»½åˆ°å½¢å‚ javaåªæœ‰å€¼ä¼ é€’ï¼Œä¸å­˜åœ¨å¼•ç”¨ä¼ é€’ javaåœ¨ä¼ é€’å¼•ç”¨ç±»å‹æ•°æ®æ—¶ï¼ŒæŠŠå®é™…å‚æ•°çš„å†…å­˜åœ°å€å¤åˆ¶äº†ä¸€ä»½ï¼Œä¼ é€’ç»™äº†å½¢å‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"äº‹åŠ¡","slug":"äº‹åŠ¡","date":"2018-04-08T09:58:41.000Z","updated":"2018-05-02T03:44:32.033Z","comments":true,"path":"2018/04/08/äº‹åŠ¡/","link":"","permalink":"https://hsb786.github.io/2018/04/08/äº‹åŠ¡/","excerpt":"äº‹åŠ¡ï¼ˆTransactionï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¦åšçš„æˆ–æ‰€åšçš„äº‹æƒ…ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­æ˜¯æŒ‡è®¿é—®å¹¶å¯èƒ½æ›´æ–°æ•°æ®åº“ä¸­å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒï¼ˆunitï¼‰ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­ï¼Œäº‹åŠ¡é€šå¸¸å°±æ˜¯æŒ‡æ•°æ®åº“äº‹åŠ¡ã€‚","text":"äº‹åŠ¡ï¼ˆTransactionï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¦åšçš„æˆ–æ‰€åšçš„äº‹æƒ…ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­æ˜¯æŒ‡è®¿é—®å¹¶å¯èƒ½æ›´æ–°æ•°æ®åº“ä¸­å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒï¼ˆunitï¼‰ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­ï¼Œäº‹åŠ¡é€šå¸¸å°±æ˜¯æŒ‡æ•°æ®åº“äº‹åŠ¡ã€‚ æ¦‚å¿µä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡é€šå¸¸åŒ…å«å¯¹æ•°æ®åº“è¿›è¡Œè¯»æˆ–å†™çš„ä¸€ä¸ªæ“ä½œåºåˆ—ã€‚å®ƒçš„å­˜åœ¨åŒ…æ‹¬æœ‰ä»¥ä¸‹ä¸¤ä¸ªç›®çš„ ä¸ºæ•°æ®åº“æä¾›äº†ä¸€ä¸ªä»å¤±è´¥ä¸­æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€çš„æ–¹æ³•ï¼ŒåŒæ—¶æä¾›äº†æ•°æ®åº“å³ä½¿åœ¨å¼‚å¸¸çŠ¶æ€ä¸‹ä»èƒ½ä¿æŒä¸€è‡´æ€§çš„æ–¹æ³•ã€‚ å½“å¤šä¸ªåº”ç”¨ç¨‹åºåœ¨å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œå¯ä»¥åœ¨è¿™äº›åº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¸€ä¸ªéš”ç¦»çš„æ–¹æ³•ï¼Œä»¥é˜²æ­¢å½¼æ­¤çš„æ“ä½œäº’ç›¸å¹²æ‰°ã€‚ å½“ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ç»™äº†DBMSï¼ˆæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰ï¼Œåˆ™DBMSéœ€è¦ç¡®ä¿è¯¥äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸå®Œæˆä¸”å…¶ç»“æœè¢«æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå¦‚æœäº‹åŠ¡ä¸­æœ‰çš„æ“ä½œæ²¡æœ‰æˆåŠŸå®Œæˆï¼Œåˆ™äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½éœ€è¦è¢«å›æ»šï¼Œå›åˆ°äº‹åŠ¡æ‰§è¡Œå‰çš„çŠ¶æ€ï¼ˆè¦ä¹ˆå…¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ½ä¸æ‰§è¡Œï¼‰;åŒæ—¶ï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æˆ–è€…å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œæ— å½±å“ï¼Œæ‰€æœ‰çš„äº‹åŠ¡éƒ½å¥½åƒåœ¨ç‹¬ç«‹çš„è¿è¡Œã€‚ ä½†åœ¨ç°å®æƒ…å†µä¸‹ï¼Œå¤±è´¥çš„é£é™©å¾ˆé«˜ã€‚åœ¨ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰å¯èƒ½ä¼šé‡ä¸Šäº‹åŠ¡æ“ä½œå¤±è´¥ã€æ•°æ®åº“ç³»ç»Ÿ/æ“ä½œç³»ç»Ÿå¤±è´¥ï¼Œç”šè‡³æ˜¯å­˜å‚¨ä»‹è´¨å¤±è´¥ç­‰æƒ…å†µã€‚è¿™ä¾¿éœ€è¦DBMSå¯¹ä¸€ä¸ªæ‰§è¡Œå¤±è´¥çš„äº‹åŠ¡æ‰§è¡Œæ¢å¤æ“ä½œï¼Œå°†å…¶æ•°æ®åº“çŠ¶æ€æ¢å¤åˆ°ä¸€è‡´çŠ¶æ€ï¼ˆæ•°æ®çš„ä¸€è‡´æ€§å¾—åˆ°ä¿è¯çš„çŠ¶æ€ï¼‰ã€‚ä¸ºäº†å®ç°å°†æ•°æ®åº“çŠ¶æ€æ¢å¤åˆ°ä¸€è‡´çŠ¶æ€çš„åŠŸèƒ½ï¼ŒDBMSé€šå¸¸éœ€è¦ç»´æŠ¤äº‹åŠ¡æ—¥å¿—ä»¥è¿½è¸ªäº‹åŠ¡ä¸­æ‰€æœ‰å½±å“æ•°æ®åº“æ•°æ®çš„æ“ä½œã€‚ ç‰¹æ€§å¹¶éä»»æ„çš„å¯¹æ•°æ®åº“çš„æ“ä½œåºåˆ—éƒ½æ˜¯æ•°æ®åº“äº‹åŠ¡ã€‚äº‹åŠ¡åº”è¯¥å…·æœ‰4ä¸ªå±æ€§ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ã€‚è¿™å››ä¸ªå±æ€§é€šå¸¸ç§°ä¸ºACIDç‰¹æ€§ã€‚ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œï¼ŒåŒ…å«åœ¨å…¶ä¸­çš„å¯¹æ•°æ®åº“çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡åº”ç¡®ä¿æ•°æ®åº“çš„çŠ¶æ€ä»ä¸€ä¸ªä¸€è‡´çŠ¶æ€è½¬å˜ä¸ºå¦ä¸€ä¸ªä¸€è‡´çŠ¶æ€ã€‚ä¸€è‡´çŠ¶æ€çš„å«ä¹‰æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®åº”æ»¡è¶³å®Œæ•´æ€§çº¦æŸã€‚éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸åº”å½±å“å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œã€‚æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œä»–å¯¹æ•°æ®åº“çš„ä¿®æ”¹åº”è¯¥æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚ åŸå­æ€§æ˜¯åŸºç¡€ï¼Œéš”ç¦»æ€§æ˜¯æ‰‹æ®µï¼ŒæŒä¹…æ€§æ˜¯ç›®çš„ï¼Œæœ€é‡è¦çš„æ˜¯ä¸€è‡´æ€§ è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»Dirty Readï¼ˆè„è¯»ï¼‰ï¼šåˆç§°æ— æ•ˆæ•°æ®çš„è¯»å‡ºã€‚æŒ‡ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“ä¸­ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡è®¿é—®å¹¶ä½¿ç”¨äº†è¯¥æ•°æ®ã€‚ç”±äºè¿™ä¸ªæ•°æ®è¿˜æ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥å¦å¤–ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°çš„è¿™ä¸ªæ•°æ®æ˜¯è„æ•°æ®ã€‚ æ—¶é—´ äº‹åŠ¡Aï¼ˆå­˜æ¬¾ï¼‰ äº‹ç‰©Bï¼ˆå–æ¬¾ï¼‰ T1 å¼€å§‹äº‹åŠ¡ T2 å¼€å§‹äº‹åŠ¡ T3 æŸ¥è¯¢ä½™é¢ï¼ˆ1000 å…ƒï¼‰ T4 å–å‡º 1000 å…ƒï¼ˆä½™é¢ 0 å…ƒï¼‰ T5 æŸ¥è¯¢ä½™é¢ï¼ˆ0 å…ƒï¼‰ T6 æ’¤é”€äº‹åŠ¡ï¼ˆä½™é¢æ¢å¤ä¸º 1000 å…ƒï¼‰ T7 å­˜å…¥ 500 å…ƒï¼ˆä½™é¢ 500 å…ƒï¼‰ T8 æäº¤äº‹åŠ¡ Unrepeatable Readï¼ˆä¸å¯é‡å¤è¯»ï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…å¯¹ä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢å´è¿”å›äº†ä¸åŒæ•°æ®ã€‚è¿™æ˜¯å› ä¸ºå…¶å®ƒäº‹åŠ¡ä¿®æ”¹çš„æäº¤è€Œå¼•èµ·çš„ã€‚ æ—¶é—´ äº‹åŠ¡Aï¼ˆå­˜æ¬¾ï¼‰ äº‹ç‰©Bï¼ˆå–æ¬¾ï¼‰ T1 å¼€å§‹äº‹åŠ¡ T2 å¼€å§‹äº‹åŠ¡ T3 æŸ¥è¯¢ä½™é¢ï¼ˆ1000 å…ƒï¼‰ T4 æŸ¥è¯¢ä½™é¢ï¼ˆ1000 å…ƒï¼‰ T5 å–å‡º 1000 å…ƒï¼ˆä½™é¢ 0 å…ƒ) T6 æäº¤äº‹åŠ¡ T7 æŸ¥è¯¢ä½™é¢ï¼ˆ0 å…ƒ) Phantom Readï¼ˆå¹»è¯»ï¼‰ï¼šæŒ‡å½“äº‹åŠ¡ä¸æ˜¯ç‹¬ç«‹æ‰§è¡Œæ—¶å‘ç”Ÿçš„ä¸€ç§ç°è±¡ã€‚ä¾‹å¦‚ç¬¬ä¸€ä¸ªäº‹åŠ¡æ¶‰åŠåˆ°è¡¨ä¸­å…¨éƒ¨æ•°æ®è¡Œçš„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ·»åŠ äº†ä¸€è¡Œæ–°æ•°æ®ï¼Œé‚£ä¹ˆæ‰§è¡Œç¬¬ä¸€ä¸ªäº‹åŠ¡åï¼Œå‘ç°è¡¨ä¸­è¿˜æœ‰æ²¡æœ‰è¢«ä¿®æ”¹çš„æ•°æ®è¡Œã€‚ æ—¶é—´ äº‹åŠ¡ Aï¼ˆç»Ÿè®¡æ€»å­˜æ¬¾ï¼‰ äº‹ç‰©Bï¼ˆå–æ¬¾ï¼‰ T1 å¼€å§‹äº‹åŠ¡ T2 å¼€å§‹äº‹åŠ¡ T3 ç»Ÿè®¡æ€»å­˜æ¬¾ï¼ˆ10000 å…ƒï¼‰ T4 å­˜å…¥ 100 å…ƒ T5 æäº¤äº‹åŠ¡ T6 ç»Ÿè®¡æ€»å­˜æ¬¾ï¼ˆ10100 å…ƒï¼‰ é“¶è¡Œå·¥ä½œäººå‘˜ï¼Œæ¯æ¬¡ç»Ÿè®¡æ€»å­˜æ¬¾ï¼Œéƒ½çœ‹åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚ä¸è¿‡è¿™ä¹Ÿç¡®å®ä¹ŸæŒºæ­£å¸¸çš„ï¼Œæ€»å­˜æ¬¾å¢å¤šäº†ï¼Œè‚¯å®šæ˜¯è¿™ä¸ªæ—¶å€™æœ‰äººåœ¨å­˜é’±ã€‚ä½†æ˜¯å¦‚æœé“¶è¡Œç³»ç»ŸçœŸçš„è¿™æ ·è®¾è®¡ï¼Œé‚£ç®—æ˜¯ç©å®Œäº†ã€‚è¿™åŒæ ·ä¹Ÿæ˜¯äº‹åŠ¡æ²¡æœ‰éš”ç¦»æ‰€é€ æˆçš„ï¼Œä½†å¯¹äºå¤§å¤šæ•°åº”ç”¨ç³»ç»Ÿè€Œè¨€ï¼Œè¿™ä¼¼ä¹ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œå¯ä»¥ç†è§£ï¼Œä¹Ÿæ˜¯å…è®¸çš„ã€‚é“¶è¡Œé‡Œé‚£äº›æ¶å¿ƒçš„é‚£äº›ç³»ç»Ÿï¼Œè¦æ±‚éå¸¸ä¸¥å¯†ï¼Œç»Ÿè®¡çš„æ—¶å€™ï¼Œç”šè‡³ä¼šå°†æ‰€æœ‰çš„å…¶ä»–æ“ä½œç»™éš”ç¦»å¼€ï¼Œè¿™ç§éš”ç¦»çº§åˆ«å°±ç®—éå¸¸é«˜äº†ï¼ˆä¼°è®¡è¦åˆ° SERIALIZABLE çº§åˆ«äº†ï¼‰ã€‚ å½’çº³ è„è¯»ï¼šäº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B æœªæäº¤çš„æ•°æ®ï¼Œå¹¶åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåˆåšäº†å…¶ä»–æ“ä½œã€‚ ä¸å¯é‡å¤è¯»ï¼šäº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B å·²æäº¤çš„æ›´æ”¹æ•°æ®ã€‚ å¹»è¯»ï¼šäº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B å·²æäº¤çš„æ–°å¢æ•°æ®ã€‚ ç¬¬ä¸€æ¡æ˜¯åšå†³æŠµåˆ¶çš„ï¼Œåä¸¤æ¡åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä¸ä½œè€ƒè™‘ã€‚ éš”ç¦»çº§åˆ« æœªæäº¤è¯»(Read uncommitted)ï¼šä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ® æäº¤è¯»(Read committed)ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹æ•°æ®è¿‡ç¨‹ä¸­ï¼Œå…¶å®ƒäº‹åŠ¡ä¸èƒ½è¯»è¯¥æ•°æ® æ•°æ®åº“é”æƒ…å†µ äº‹åŠ¡å¯¹å½“å‰è¯»å–çš„æ•°æ®åŠ è¡Œçº§å…±äº«é”ï¼ˆå½“è¯»åˆ°æ—¶æ‰åŠ é”ï¼‰ï¼Œä¸€æ—¦è¯»å®Œè¯¥è¡Œï¼Œç«‹å³é‡Šæ”¾è¯¥è¡Œçº§å…±äº«é” äº‹åŠ¡åœ¨æ›´æ–°æŸæ•°æ®çš„ç¬é—´ï¼ˆå°±æ˜¯å‘ç”Ÿæ›´æ–°çš„ç¬é—´ï¼‰ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡Œçº§æ’ä»–é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ã€‚ å¯é‡å¤è¯»(Repeatable reads)ï¼šè§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ æ•°æ®åº“é”æƒ…å†µ äº‹åŠ¡åœ¨è¯»å–æŸæ•°æ®çš„ç¬é—´ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡Œçº§å…±äº«é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ äº‹åŠ¡åœ¨æ›´æ–°æŸæ•°æ®çš„ç¬é—´ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡Œçº§æ’ä»–é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ åºåˆ—åŒ–(Serializable)ï¼šæœ€é«˜çš„éš”ç¦»çº§åˆ« æ•°æ®åº“é”æƒ…å†µ äº‹åŠ¡åœ¨è¯»å–æ•°æ®æ—¶ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡¨çº§å…±äº«é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ äº‹åŠ¡åœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œå¿…é¡»å…ˆå¯¹å…¶åŠ è¡¨çº§æ’ä»–é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ äº‹åŠ¡éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯» READ_UNCOMMITTED å…è®¸ å…è®¸ å…è®¸ READ_COMMITTED ç¦æ­¢ å…è®¸ å…è®¸ REPEATABLE_READ ç¦æ­¢ ç¦æ­¢ å…è®¸ SERIALIZABLE ç¦æ­¢ ç¦æ­¢ ç¦æ­¢ éš”ç¦»çº§åˆ«è¶Šé«˜ï¼ŒåŒæ—¶åœ¨å¹¶å‘æ€§ä¸Šä¹Ÿè¶Šä½ æˆ‘ä»¬çŸ¥é“ JDBC åªæ˜¯è¿æ¥ Java ç¨‹åºä¸æ•°æ®åº“çš„æ¡¥æ¢è€Œå·²ï¼Œé‚£ä¹ˆæ•°æ®åº“åˆæ˜¯æ€æ ·éš”ç¦»äº‹åŠ¡çš„å‘¢ï¼Ÿå…¶å®å®ƒå°±æ˜¯â€œé”â€è¿™ä¸ªä¸œè¥¿ã€‚å½“æ’å…¥æ•°æ®æ—¶ï¼Œå°±é”å®šè¡¨ï¼Œè¿™å«â€œé”è¡¨â€ï¼›å½“æ›´æ–°æ•°æ®æ—¶ï¼Œå°±é”å®šè¡Œï¼Œè¿™å«â€œé”è¡Œâ€ã€‚ é™¤äº† JDBC ç»™æˆ‘ä»¬æä¾›çš„äº‹åŠ¡éš”ç¦»çº§åˆ«è¿™ç§è§£å†³æ–¹æ¡ˆä»¥å¤–ï¼Œè¿˜æœ‰å“ªäº›è§£å†³æ–¹æ¡ˆå¯ä»¥å®Œå–„äº‹åŠ¡ç®¡ç†åŠŸèƒ½å‘¢ï¼Ÿ ä¸å¦¨çœ‹çœ‹Spring çš„è§£å†³æ–¹æ¡ˆå§ï¼Œå…¶å®å®ƒæ˜¯å¯¹ JDBC çš„ä¸€ä¸ªè¡¥å……æˆ–æ‰©å±•ã€‚å®ƒæä¾›äº†ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œå°±æ˜¯ï¼šäº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆTransaction Propagation Behaviorï¼‰ã€‚ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼ˆTransaction Propagation Behaviorï¼‰ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç±»å‹ è¯´æ˜ PROPAGATION_REQUIRED æœ‰å°±åŠ å…¥åˆ°å½“å‰äº‹åŠ¡ï¼›æ²¡æœ‰å°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ã€‚Springæä¾›çš„é»˜è®¤äº‹åŠ¡ä¼ æ’­è¡Œä¸º RROPAGATION_REQUIRES_NEW æ–°å»ºäº‹åŠ¡ï¼Œå°†åŸæ¥çš„äº‹åŠ¡æŒ‚èµ·ï¼Œå’ŒåŸæ¥äº‹åŠ¡æ²¡æœ‰å…³ç³»ã€‚ PROPAGATION_SUPPORTS æœ‰å°±ä½¿ç”¨å½“å‰äº‹åŠ¡ï¼›æ²¡æœ‰å°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚æ²¡æœ‰å°±æ²¡æœ‰ï¼Œæœ‰å°±æœ‰ï¼Œæœ‰ç‚¹æ— æ‰€è°“çš„æ€åº¦ï¼Œåæ­£æˆ‘æ˜¯æ”¯æŒä½ çš„ã€‚ PROPAGATION_NOT_SUPPORTED æœ‰å°±æŒ‚èµ·å½“å‰äº‹åŠ¡ï¼›æ²¡æœ‰å°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚è¿™ç§æ–¹å¼éå¸¸å¼ºç¡¬ï¼Œæ²¡æœ‰å°±æ²¡æœ‰ï¼Œæœ‰æˆ‘ä¹Ÿä¸æ”¯æŒä½ ï¼ŒæŠŠä½ æŒ‚èµ·æ¥ï¼Œä¸é¸Ÿä½ ã€‚ PROPAGATION_NEVER å¦‚æœæœ‰ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚ PROPAGATION_MANDATORY å¦‚æœæœ‰ï¼Œå°±ä½¿ç”¨å½“å‰äº‹åŠ¡ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚ PROPAGATION_NESTED å¦‚æœæ²¡æœ‰ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼›å¦‚æœæœ‰ï¼Œå°±åœ¨å½“å‰äº‹åŠ¡ä¸­åµŒå¥—å…¶ä»–äº‹åŠ¡ã€‚æ‰€åµŒå¥—çš„å­äº‹åŠ¡ä¸ä¸»äº‹åŠ¡ä¹‹é—´æ˜¯æœ‰å…³è”çš„ï¼ˆå½“ä¸»äº‹åŠ¡æäº¤æˆ–å›æ»šï¼Œå­äº‹åŠ¡ä¹Ÿä¼šæäº¤æˆ–å›æ»šï¼‰ã€‚ é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼Œäº‹åŠ¡æ˜¯ä»å“ªé‡Œæ¥ï¼Ÿä¼ æ’­åˆ°å“ªé‡Œå»ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œä»æ–¹æ³• A ä¼ æ’­åˆ°æ–¹æ³• Bã€‚Spring è§£å†³çš„åªæ˜¯æ–¹æ³•ä¹‹é—´çš„äº‹åŠ¡ä¼ æ’­ï¼Œé‚£æƒ…å†µå°±å¤šäº†ï¼Œæ¯”å¦‚: æ–¹æ³• A æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B ä¹Ÿæœ‰äº‹åŠ¡ã€‚ æ–¹æ³• A æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B æ²¡æœ‰äº‹åŠ¡ã€‚ æ–¹æ³• A æ²¡æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B æœ‰äº‹åŠ¡ã€‚ æ–¹æ³• A æ²¡æœ‰äº‹åŠ¡ï¼Œæ–¹æ³• B ä¹Ÿæ²¡æœ‰äº‹åŠ¡ã€‚ Spring ç»™æˆ‘ä»¬å¸¦æ¥äº†äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§è€Œåˆå®ç”¨çš„åŠŸèƒ½ã€‚é™¤æ­¤ä»¥å¤–ï¼Œä¹Ÿæä¾›äº†ä¸€äº›å°çš„é™„åŠ åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š äº‹åŠ¡è¶…æ—¶ï¼ˆTransaction Timeoutï¼‰ï¼šä¸ºäº†è§£å†³äº‹åŠ¡æ—¶é—´å¤ªé•¿ï¼Œæ¶ˆè€—å¤ªå¤šçš„èµ„æºï¼Œæ‰€ä»¥æ•…æ„ç»™äº‹åŠ¡è®¾ç½®ä¸€ä¸ªæœ€å¤§æ—¶å¸¸ï¼Œå¦‚æœè¶…è¿‡äº†ï¼Œå°±å›æ»šäº‹åŠ¡ã€‚ åªè¯»äº‹åŠ¡ï¼ˆReadonly Transactionï¼‰ï¼šä¸ºäº†å¿½ç•¥é‚£äº›ä¸éœ€è¦äº‹åŠ¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å–æ•°æ®ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°æé«˜ä¸€äº›æ€§èƒ½ã€‚ é”çš„åˆ†ç±»æŒ‰é”çº§åˆ«åˆ’åˆ†ï¼šå…±äº«é”(Share Lock) åˆç§°è¯»é”ï¼Œæ˜¯è¯»å–æ“ä½œåˆ›å»ºçš„é”ã€‚å…¶å®ƒç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œç›´åˆ°å·²é‡Šæ”¾æ‰€æœ‰å…±äº«é” å¦‚æœäº‹åŠ¡Tå¯¹æ•°æ®AåŠ ä¸Šå…±äº«é”åï¼Œåˆ™å…¶å®ƒäº‹åŠ¡åªèƒ½å¯¹Aå†åŠ å…±äº«é”ï¼Œä¸èƒ½åŠ æ’ä»–é”ã€‚è·å–å…±äº«é”çš„äº‹åŠ¡åªèƒ½è¯»æ•°æ®ï¼Œä¸èƒ½ä¿®æ”¹æ•°æ® ç”¨æ³• select â€¦ LOCK IN SHARE MODEï¼Œ å½“æ²¡æœ‰å…¶å®ƒçº¿ç¨‹å¯¹æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä»»ä½•ä¸€è¡Œä½¿ç”¨æ’ä»–é”æ—¶ï¼Œå¯ä»¥æˆåŠŸç”³è¯·å…±äº«é”ï¼Œå¦åˆ™ä¼šè¢«é˜»å¡ã€‚å…¶å®ƒçº¿ç¨‹ä¹Ÿå¯ä»¥è¯»å–ä½¿ç”¨äº†å…±äº«é”çš„è¡¨ï¼Œè€Œä¸”è¿™äº›çº¿ç¨‹è¯»å–çš„æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„æ•°æ® æ’ä»–é”(eXclusive Lock) åˆç§°å†™é”ï¼Œå¦‚æœäº‹åŠ¡Tå¯¹æ•°æ®AåŠ ä¸Šæ’ä»–é”åï¼Œåˆ™å…¶ä»–äº‹åŠ¡ä¸èƒ½å†å¯¹AåŠ ä»»ä½•ç±»å‹çš„é”ã€‚è·å–æ’ä»–é”çš„äº‹åŠ¡æ—¢èƒ½è¯»æ•°æ®ï¼Œåˆèƒ½ä¿®æ”¹æ•°æ® ç”¨æ³• select â€¦ FOR UPDATE å½“æ²¡æœ‰å…¶å®ƒçº¿ç¨‹å¯¹æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä»»ä½•ä¸€è¡Œä½¿ç”¨æ’ä»–é”æ—¶ï¼Œå¯ä»¥æˆåŠŸç”³è¯·æ’ä»–é”ï¼Œå¦åˆ™ä¼šè¢«é˜»å¡ æŒ‰é”çš„ç²’åº¦åˆ’åˆ†è¡Œçº§é” å¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚åŠ é”ç²’åº¦æœ€å°ï¼Œä½†åŠ é”çš„å¼€é”€æœ€å¤§ã€‚è¡Œçº§é”åˆ†ä¸ºå…±äº«é”å’Œæ’ä»–é” ç‰¹ç‚¹ å¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šåŠ›åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚ è¡¨çº§é” å¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ƒå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—è¾ƒå°‘ï¼Œè¢«å¤§éƒ¨åˆ†MySQLå¼•æ“æ”¯æŒã€‚æœ€å¸¸ä½¿ç”¨çš„MYISAMä¸INNODBéƒ½æ”¯æŒè¡¨çº§é”å®šã€‚è¡¨çº§é”å®šåˆ†ä¸ºè¡¨å…±äº«è¯»é”ï¼ˆå…±äº«é”ï¼‰ä¸è¡¨ç‹¬å å†™é”ï¼ˆæ’ä»–é”ï¼‰ã€‚ ç‰¹ç‚¹ å¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘å‡ºé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ã€‚ é¡µçº§é” é¡µçº§é”æ˜¯MySQLä¸­é”å®šç²’åº¦ä»‹äºè¡Œçº§é”å’Œè¡¨çº§é”ä¸­é—´çš„ä¸€ç§é”ã€‚è¡¨çº§é”é€Ÿåº¦å¿«ï¼Œä½†å†²çªå¤šï¼Œè¡Œçº§å†²çªå°‘ï¼Œä½†é€Ÿåº¦æ…¢ã€‚æ‰€ä»¥å–äº†æŠ˜è¡·çš„é¡µçº§ï¼Œä¸€æ¬¡é”å®šç›¸é‚»çš„ä¸€ç»„è®°å½•ã€‚BDBæ”¯æŒé¡µçº§é” ç‰¹ç‚¹ å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œå¹¶å‘åº¦ä¸€èˆ¬ Innodbä¸­çš„è¡Œé”ä¸è¡¨é” InnoDBè¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ã€‚InnoDBè¿™ç§è¡Œé”å®ç°ç‰¹ç‚¹æ„å‘³ç€ï¼šåªæœ‰é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼ŒInnoDBæ‰ä½¿ç”¨è¡Œçº§é”ï¼Œå¦åˆ™ï¼ŒInnoDBå°†ä½¿ç”¨è¡¨é”ï¼ è¡Œçº§é”ä¸æ­»é” åœ¨MySQLä¸­ï¼Œè¡Œçº§é”å¹¶ä¸æ˜¯ç›´æ¥é”è®°å½•ï¼Œè€Œæ˜¯é”ç´¢å¼•ã€‚ç´¢å¼•åˆ†ä¸ºä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ä¸¤ç§ï¼Œå¦‚æœä¸€æ¡sqlè¯­å¥æ“ä½œäº†ä¸»é”®ç´¢å¼•ï¼ŒMySQLå°±ä¼šé”å®šè¿™æ¡ä¸»é”®ç´¢å¼•ï¼›å¦‚æœä¸€æ¡è¯­å¥æ“ä½œäº†éä¸»é”®ç´¢å¼•ï¼ŒMySQLä¼šå…ˆé”å®šè¯¥éä¸»é”®ç´¢å¼•ï¼Œå†é”å®šç›¸å…³çš„ä¸»é”®ç´¢å¼•ã€‚ åœ¨UPDATEã€DELETEæ“ä½œæ—¶ï¼ŒMySQLä¸ä»…é”å®šWHEREæ¡ä»¶æ‰«æè¿‡çš„æ‰€æœ‰ç´¢å¼•è®°å½•ï¼Œè€Œä¸”ä¼šé”å®šç›¸é‚»çš„é”®å€¼ï¼Œå³æ‰€è°“çš„next-key lockingã€‚ å½“ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œï¼Œä¸€ä¸ªé”ä½äº†ä¸»é”®ç´¢å¼•ï¼Œåœ¨ç­‰å¾…å…¶ä»–ç›¸å…³ç´¢å¼•ã€‚å¦ä¸€ä¸ªé”å®šäº†éä¸»é”®ç´¢å¼•ï¼Œåœ¨ç­‰å¾…ä¸»é”®ç´¢å¼•ã€‚è¿™æ ·å°±ä¼šå‘ç”Ÿæ­»é”ã€‚ å‘ç”Ÿæ­»é”åï¼ŒInnoDBä¸€èˆ¬éƒ½å¯ä»¥æ£€æµ‹åˆ°ï¼Œå¹¶ä½¿ä¸€ä¸ªäº‹åŠ¡é‡Šæ”¾é”å›é€€ï¼Œå¦ä¸€ä¸ªè·å–é”å®Œæˆäº‹åŠ¡ã€‚ å¸¸è§çš„ä¸‰ç§è§£å†³æ­»é”çš„æ–¹æ³• å¦‚æœä¸åŒç¨‹åºä¼šå¹¶å‘å­˜å–å¤šä¸ªè¡¨ï¼Œå°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®è¡¨ï¼Œå¯ä»¥å¤§å¤§é™ä½æ­»é”æœºä¼š åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå°½å¯èƒ½åšåˆ°ä¸€æ¬¡é”å®šæ‰€éœ€è¦çš„æ‰€æœ‰èµ„æºï¼Œå‡å°‘æ­»é”äº§ç”Ÿæ¦‚ç‡ å¯¹äºéå¸¸å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä¸šåŠ¡éƒ¨åˆ†ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å‡çº§é”å®šé¢—ç²’åº¦ï¼Œé€šè¿‡è¡¨çº§é”å®šæ¥å‡å°‘æ­»é”äº§ç”Ÿçš„æ¦‚ç‡ æŒ‰ä½¿ç”¨æ–¹å¼åˆ’åˆ†æ‚²è§‚é” åœ¨å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿé‡Œï¼Œæ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆåˆåâ€œæ‚²è§‚é”â€ï¼ŒPessimistic Concurrency Controlï¼Œç¼©å†™â€œPCCâ€ï¼‰æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ã€‚å®ƒå¯ä»¥é˜»æ­¢ä¸€ä¸ªäº‹åŠ¡ä»¥å½±å“å…¶ä»–ç”¨æˆ·çš„æ–¹å¼æ¥ä¿®æ”¹æ•°æ®ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œçš„æ“ä½œéƒ½æŸè¡Œæ•°æ®åº”ç”¨äº†é”ï¼Œé‚£åªæœ‰å½“è¿™ä¸ªäº‹åŠ¡æŠŠé”é‡Šæ”¾ï¼Œå…¶ä»–äº‹åŠ¡æ‰èƒ½å¤Ÿæ‰§è¡Œä¸è¯¥é”å†²çªçš„æ“ä½œã€‚ æ‚²è§‚å¹¶å‘æ§åˆ¶ä¸»è¦ç”¨äºæ•°æ®äº‰ç”¨æ¿€çƒˆçš„ç¯å¢ƒï¼Œä»¥åŠå‘ç”Ÿå¹¶å‘å†²çªæ—¶ä½¿ç”¨é”ä¿æŠ¤æ•°æ®çš„æˆæœ¬è¦ä½äºå›æ»šäº‹åŠ¡çš„æˆæœ¬çš„ç¯å¢ƒä¸­ã€‚ åœ¨æ•°æ®åº“ä¸­ï¼Œæ‚²è§‚é”çš„æµç¨‹å¦‚ä¸‹ï¼š åœ¨å¯¹ä»»æ„è®°å½•è¿›è¡Œä¿®æ”¹å‰ï¼Œå…ˆå°è¯•ä¸ºè¯¥è®°å½•åŠ ä¸Šæ’ä»–é”ï¼ˆexclusive lockingï¼‰ã€‚ å¦‚æœåŠ é”å¤±è´¥ï¼Œè¯´æ˜è¯¥è®°å½•æ­£åœ¨è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“å‰æŸ¥è¯¢å¯èƒ½è¦ç­‰å¾…æˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚ å…·ä½“å“åº”æ–¹å¼ç”±å¼€å‘è€…æ ¹æ®å®é™…éœ€è¦å†³å®šã€‚ å¦‚æœæˆåŠŸåŠ é”ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¯¹è®°å½•åšä¿®æ”¹ï¼Œäº‹åŠ¡å®Œæˆåå°±ä¼šè§£é”äº†ã€‚ å…¶é—´å¦‚æœæœ‰å…¶ä»–å¯¹è¯¥è®°å½•åšä¿®æ”¹æˆ–åŠ æ’ä»–é”çš„æ“ä½œï¼Œéƒ½ä¼šç­‰å¾…æˆ‘ä»¬è§£é”æˆ–ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ ä½¿ç”¨selectâ€¦for updateä¼šæŠŠæ•°æ®ç»™é”ä½ï¼Œä¸è¿‡æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€äº›é”çš„çº§åˆ«ï¼ŒMySQL InnoDBé»˜è®¤è¡Œçº§é”ã€‚è¡Œçº§é”éƒ½æ˜¯åŸºäºç´¢å¼•çš„ï¼Œå¦‚æœä¸€æ¡SQLè¯­å¥ç”¨ä¸åˆ°ç´¢å¼•æ˜¯ä¸ä¼šä½¿ç”¨è¡Œçº§é”çš„ï¼Œä¼šä½¿ç”¨è¡¨çº§é”æŠŠæ•´å¼ è¡¨é”ä½ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ã€‚ ä¼˜ç‚¹ä¸ä¸è¶³ æ‚²è§‚å¹¶å‘æ§åˆ¶å®é™…ä¸Šæ˜¯â€œå…ˆå–é”å†è®¿é—®â€çš„ä¿å®ˆç­–ç•¥ï¼Œä¸ºæ•°æ®å¤„ç†çš„å®‰å…¨æä¾›äº†ä¿è¯ã€‚ä½†æ˜¯åœ¨æ•ˆç‡æ–¹é¢ï¼Œå¤„ç†åŠ é”çš„æœºåˆ¶ä¼šè®©æ•°æ®åº“äº§ç”Ÿé¢å¤–çš„å¼€é”€ï¼Œè¿˜æœ‰å¢åŠ äº§ç”Ÿæ­»é”çš„æœºä¼šï¼›å¦å¤–ï¼Œåœ¨åªè¯»å‹äº‹åŠ¡å¤„ç†ä¸­ç”±äºä¸ä¼šäº§ç”Ÿå†²çªï¼Œä¹Ÿæ²¡å¿…è¦ä½¿ç”¨é”ï¼Œè¿™æ ·åšåªèƒ½å¢åŠ ç³»ç»Ÿè´Ÿè½½ï¼›è¿˜æœ‰ä¼šé™ä½äº†å¹¶è¡Œæ€§ï¼Œä¸€ä¸ªäº‹åŠ¡å¦‚æœé”å®šäº†æŸè¡Œæ•°æ®ï¼Œå…¶ä»–äº‹åŠ¡å°±å¿…é¡»ç­‰å¾…è¯¥äº‹åŠ¡å¤„ç†å®Œæ‰å¯ä»¥å¤„ç†é‚£è¡Œæ•° ä¹è§‚é” åœ¨å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿé‡Œï¼Œä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆåˆåâ€œä¹è§‚é”â€ï¼ŒOptimistic Concurrency Controlï¼Œç¼©å†™â€œOCCâ€ï¼‰æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ã€‚å®ƒå‡è®¾å¤šç”¨æˆ·å¹¶å‘çš„äº‹åŠ¡åœ¨å¤„ç†æ—¶ä¸ä¼šå½¼æ­¤äº’ç›¸å½±å“ï¼Œå„äº‹åŠ¡èƒ½å¤Ÿåœ¨ä¸äº§ç”Ÿé”çš„æƒ…å†µä¸‹å¤„ç†å„è‡ªå½±å“çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚åœ¨æäº¤æ•°æ®æ›´æ–°ä¹‹å‰ï¼Œæ¯ä¸ªäº‹åŠ¡ä¼šå…ˆæ£€æŸ¥åœ¨è¯¥äº‹åŠ¡è¯»å–æ•°æ®åï¼Œæœ‰æ²¡æœ‰å…¶ä»–äº‹åŠ¡åˆä¿®æ”¹äº†è¯¥æ•°æ®ã€‚å¦‚æœå…¶ä»–äº‹åŠ¡æœ‰æ›´æ–°çš„è¯ï¼Œæ­£åœ¨æäº¤çš„äº‹åŠ¡ä¼šè¿›è¡Œå›æ»šã€‚ä¹è§‚äº‹åŠ¡æ§åˆ¶æœ€æ—©æ˜¯ç”±å­”ç¥¥é‡ï¼ˆH.T.Kungï¼‰æ•™æˆæå‡ºã€‚ ä¹è§‚é”ï¼ˆ Optimistic Locking ï¼‰ ç›¸å¯¹æ‚²è§‚é”è€Œè¨€ï¼Œä¹è§‚é”å‡è®¾è®¤ä¸ºæ•°æ®ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šé€ æˆå†²çªï¼Œæ‰€ä»¥åœ¨æ•°æ®è¿›è¡Œæäº¤æ›´æ–°çš„æ—¶å€™ï¼Œæ‰ä¼šæ­£å¼å¯¹æ•°æ®çš„å†²çªä¸å¦è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå‘ç°å†²çªäº†ï¼Œåˆ™è®©è¿”å›ç”¨æˆ·é”™è¯¯çš„ä¿¡æ¯ï¼Œè®©ç”¨æˆ·å†³å®šå¦‚ä½•å»åšã€‚ ç›¸å¯¹äºæ‚²è§‚é”ï¼Œåœ¨å¯¹æ•°æ®åº“è¿›è¡Œå¤„ç†çš„æ—¶å€™ï¼Œä¹è§‚é”å¹¶ä¸ä¼šä½¿ç”¨æ•°æ®åº“æä¾›çš„é”æœºåˆ¶ã€‚ä¸€èˆ¬çš„å®ç°ä¹è§‚é”çš„æ–¹å¼å°±æ˜¯è®°å½•æ•°æ®ç‰ˆæœ¬ã€‚ æ•°æ®ç‰ˆæœ¬,ä¸ºæ•°æ®å¢åŠ çš„ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°†ç‰ˆæœ¬æ ‡è¯†çš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼ŒåŒæ—¶å¯¹ç‰ˆæœ¬æ ‡è¯†è¿›è¡Œæ›´æ–°ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ç‰ˆæœ¬æ ‡è¯†è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„ç‰ˆæœ¬æ ‡è¯†å€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚ ä¼˜ç‚¹ä¸ä¸è¶³ ä¹è§‚å¹¶å‘æ§åˆ¶ç›¸ä¿¡äº‹åŠ¡ä¹‹é—´çš„æ•°æ®ç«äº‰(data race)çš„æ¦‚ç‡æ˜¯æ¯”è¾ƒå°çš„ï¼Œå› æ­¤å°½å¯èƒ½ç›´æ¥åšä¸‹å»ï¼Œç›´åˆ°æäº¤çš„æ—¶å€™æ‰å»é”å®šï¼Œæ‰€ä»¥ä¸ä¼šäº§ç”Ÿä»»ä½•é”å’Œæ­»é”ã€‚ä½†å¦‚æœç›´æ¥ç®€å•è¿™ä¹ˆåšï¼Œè¿˜æ˜¯æœ‰å¯èƒ½ä¼šé‡åˆ°ä¸å¯é¢„æœŸçš„ç»“æœï¼Œä¾‹å¦‚ä¸¤ä¸ªäº‹åŠ¡éƒ½è¯»å–äº†æ•°æ®åº“çš„æŸä¸€è¡Œï¼Œç»è¿‡ä¿®æ”¹ä»¥åå†™å›æ•°æ®åº“ï¼Œè¿™æ—¶å°±é‡åˆ°äº†é—®é¢˜ã€‚ æ‚²è§‚é”ï¼Œå°±æ˜¯æ€»è§‰å¾—æœ‰åˆæ°‘æƒ³å®³æœ•ï¼Œæ¯æ¬¡è®¿é—®æ•°æ®çš„æ—¶å€™éƒ½è§‰å¾—ä¼šæœ‰åˆ«äººä¿®æ”¹å®ƒï¼Œæ‰€ä»¥æ¯æ¬¡æ‹¿æ•°æ®æ—¶éƒ½ä¼šä¸Šé”ï¼Œç¡®ä¿åœ¨è‡ªå·±ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¢«ä»–äººè®¿é—®ã€‚ä¹è§‚é”å°±æ˜¯å¾ˆå•çº¯ï¼Œå¿ƒæ€å¥½ï¼Œæ‰€ä»¥æ¯æ¬¡æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¸ä¼šä¸Šé”ï¼Œåªæ˜¯åœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™å»åˆ¤æ–­è¯¥æ•°æ®æ˜¯å¦è¢«åˆ«äººä¿®æ”¹è¿‡ã€‚ å¤§å¤šæ•°çš„å…³ç³»æ•°æ®åº“å†™å…¥æ“ä½œéƒ½æ˜¯åŸºäºæ‚²è§‚é”ï¼Œç¼ºç‚¹åœ¨äºå¦‚æœæŒæœ‰é”çš„å®¢æˆ·ç«¯è¿è¡Œçš„å¾ˆæ…¢ï¼Œé‚£ä¹ˆç­‰å¾…è§£é”çš„å®¢æˆ·ç«¯è¢«é˜»å¡çš„æ—¶é—´å°±è¶Šé•¿ã€‚Redisçš„äº‹åŠ¡æ˜¯åŸºäºä¹è§‚é”çš„æœºåˆ¶ï¼Œä¸ä¼šåœ¨æ‰§è¡ŒWATCHå‘½ä»¤æ—¶å¯¹æ•°æ®è¿›è¡ŒåŠ é”ï¼Œåªæ˜¯ä¼šåœ¨æ•°æ®å·²ç»è¢«å…¶ä»–å®¢æˆ·ç«¯æŠ¢å…ˆä¿®æ”¹äº†çš„æƒ…å†µä¸‹ï¼Œé€šçŸ¥æ‰§è¡ŒWATCHå‘½ä»¤çš„å®¢æˆ·ç«¯ã€‚ä¹è§‚é”é€‚ç”¨äºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå› ä¸ºåœ¨å†™æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„æ—¶å€™ï¼Œä¼šä¸æ–­åœ°retryï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚ å‚è€ƒ æ•°æ®åº“ é¢è¯•æ€»ç»“ Transaction é‚£ç‚¹äº‹å„¿","categories":[{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/categories/sql/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://hsb786.github.io/tags/Spring/"},{"name":"sql","slug":"sql","permalink":"https://hsb786.github.io/tags/sql/"}]},{"title":"ä¸€äº›å°æŠ€å·§","slug":"ä¸€äº›å°æŠ€å·§","date":"2018-04-08T09:58:41.000Z","updated":"2018-04-22T08:18:58.001Z","comments":true,"path":"2018/04/08/ä¸€äº›å°æŠ€å·§/","link":"","permalink":"https://hsb786.github.io/2018/04/08/ä¸€äº›å°æŠ€å·§/","excerpt":"ä½è¿ç®—ç›´æ¥å¯¹å†…å­˜æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦è½¬æˆåè¿›åˆ¶ï¼Œå› æ­¤å¤„ç†é€Ÿåº¦éå¸¸å¿« X % 2^n = (2^n-1) &amp; X","text":"ä½è¿ç®—ç›´æ¥å¯¹å†…å­˜æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦è½¬æˆåè¿›åˆ¶ï¼Œå› æ­¤å¤„ç†é€Ÿåº¦éå¸¸å¿« X % 2^n = (2^n-1) &amp; X åˆ¤æ®µä¸€ä¸ªæ•°ç»„æ˜¯å¦åŒ…å«æŸä¸ªå€¼12Set&lt;String&gt; set=new HashSet&lt;String&gt;(Arrays.asList(arr)); return set.contains(targetValue); æ•ˆç‡æ…¢ï¼Œè¦å°†æ•°ç»„å‹å…¥Collectionç±»å‹ä¸­ï¼Œé¦–å…ˆè¦å°†æ•°ç»„å…ƒç´ éå†ä¸€éï¼Œç„¶åå†ä½¿ç”¨é›†åˆç±»åšå…¶å®ƒæ“ä½œã€‚ å¯ä»¥ä½¿ç”¨Apache Commonsç±»åº“ä¸­æä¾›çš„ArrayUtilsç±»çš„containsæ–¹æ³•containså†…éƒ¨è°ƒç”¨indexOfæ–¹æ³• 123456789101112131415161718192021222324252627282930public static boolean contains(Object[] array, Object objectToFind) &#123; return indexOf(array, objectToFind) != INDEX_NOT_FOUND;&#125;public static int indexOf(Object[] array, Object objectToFind) &#123; return indexOf(array, objectToFind, 0);&#125;public static int indexOf(Object[] array, Object objectToFind, int startIndex) &#123; if (array == null) &#123; return INDEX_NOT_FOUND; &#125; if (startIndex &lt; 0) &#123; startIndex = 0; &#125; if (objectToFind == null) &#123; for (int i = startIndex; i &lt; array.length; i++) &#123; if (array[i] == null) &#123; return i; &#125; &#125; &#125; else if (array.getClass().getComponentType().isInstance(objectToFind)) &#123; for (int i = startIndex; i &lt; array.length; i++) &#123; if (objectToFind.equals(array[i])) &#123; return i; &#125; &#125; &#125; return INDEX_NOT_FOUND;&#125; æ•´æ•°äºŒè¿›åˆ¶è¡¨ç¤ºä¸­1çš„ä¸ªæ•° 123456int count=0;while(n!=0) &#123; //å°†äºŒè¿›åˆ¶è¡¨ç¤ºä¸­çš„æœ€ä½ä½çš„1å˜ä¸º0 n=n&amp;(n-1); count++;&#125; NaN A constant holding a Not-a-Number (NaN) value of type public static final double NaN = 0.0d /0.0; Javaä¸­çš„Doubleå’ŒFloatéƒ½æœ‰isNaNã€‚åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯NaNï¼Œé€šè¿‡v!=vçš„æ–¹å¼ã€‚ NaNæ˜¯å”¯ä¸€ä¸è‡ªå·±ä¸ç›¸ç­‰çš„å€¼ï¼ŒNaNä¸ä»»ä½•å€¼éƒ½ä¸ç›¸ç­‰ã€‚","categories":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/categories/çˆªå“‡/"}],"tags":[{"name":"çˆªå“‡","slug":"çˆªå“‡","permalink":"https://hsb786.github.io/tags/çˆªå“‡/"}]},{"title":"é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ","slug":"é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ","date":"2018-04-08T09:58:41.000Z","updated":"2018-04-20T13:21:17.374Z","comments":true,"path":"2018/04/08/é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ/","link":"","permalink":"https://hsb786.github.io/2018/04/08/é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ/","excerpt":"è¿ç»­ç‚¹å‡»å¤šä¸ªæŒ‰é’®ï¼Œå¯èƒ½å¯¼è‡´å…ˆè¯·æ±‚çš„æ•°æ®åæ˜¾ç¤ºå‡ºæ¥ã€‚ è§£å†³æ–¹æ¡ˆ 1. å°†ajaxè¯·æ±‚çš„asyncè®¾ç½®ä¸ºfalse 2. åˆ©ç”¨jquery ajaxPrefilterä¸­æ–­è¯·æ±‚ 3. åŠ é®ç½©æ¡†","text":"è¿ç»­ç‚¹å‡»å¤šä¸ªæŒ‰é’®ï¼Œå¯èƒ½å¯¼è‡´å…ˆè¯·æ±‚çš„æ•°æ®åæ˜¾ç¤ºå‡ºæ¥ã€‚ è§£å†³æ–¹æ¡ˆ 1. å°†ajaxè¯·æ±‚çš„asyncè®¾ç½®ä¸ºfalse 2. åˆ©ç”¨jquery ajaxPrefilterä¸­æ–­è¯·æ±‚ 3. åŠ é®ç½©æ¡†12345678910111213141516171819var pendingRequests = &#123;&#125;;$.ajaxPrefilter(function( options, originalOptions, jqXHR ) &#123; var key = options.url; console.log(key); if (!pendingRequests[key]) &#123; pendingRequests[key] = jqXHR; &#125;else&#123; //jqXHR.abort(); //æ”¾å¼ƒåè§¦å‘çš„æäº¤ pendingRequests[key].abort(); // æ”¾å¼ƒå…ˆè§¦å‘çš„æäº¤ &#125; var complete = options.complete; options.complete = function(jqXHR, textStatus) &#123; pendingRequests[key] = null; if ($.isFunction(complete)) &#123; complete.apply(this, arguments); &#125; &#125;;&#125;); æ ¸å¿ƒæ€æƒ³æ˜¯ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå‘é€è¯·æ±‚æ—¶ï¼Œå°†è¯·æ±‚åŠ å…¥é˜Ÿåˆ—ï¼Œè¯·æ±‚å“åº”åï¼Œä»é˜Ÿåˆ—ä¸­æ¸…æ¥šï¼Œè¿™å°±ä¿è¯äº†åœ¨ä»»ä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªåŒæ ·çš„è¯·æ±‚å‘é€ å±€é™æ€§ï¼šä»…å¯¹jqueryçš„ajaxæœ‰ä½œç”¨ å‚è€ƒ é˜²æ­¢é‡å¤å‘é€ Ajax è¯·æ±‚çš„è§£å†³æ–¹æ¡ˆ","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/categories/å‰ç«¯/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://hsb786.github.io/tags/å‰ç«¯/"}]},{"title":"Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„","slug":"Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„","date":"2018-04-08T09:48:41.000Z","updated":"2018-04-20T13:24:46.656Z","comments":true,"path":"2018/04/08/Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„/","link":"","permalink":"https://hsb786.github.io/2018/04/08/Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„/","excerpt":"çº¿ç¨‹å’Œå…±äº«æ•°æ® åœ¨JVMä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹ç‹¬äº«ä¸€å—æ ˆå†…å­˜ï¼Œå…¶ä¸­åŒ…æ‹¬å±€éƒ¨å˜é‡ã€çº¿ç¨‹è°ƒç”¨çš„æ¯ä¸ªæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ã€‚å…¶å®ƒçº¿ç¨‹æ— æ³•è¯»å–åˆ°è¯¥æ ˆå†…å­˜å—ä¸­çš„æ•°æ®ã€‚æ ˆä¸­çš„æ•°æ®ä»…é™äºåŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚ åœ¨JVMä¸­ï¼Œå †å†…å­˜æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ã€‚å¯¹è±¡åœ¨å †ä¸­ã€‚ è¿˜æœ‰ä¸€éƒ¨åˆ†æ•°æ®ä¿å­˜JVMä¸­çš„æ–¹æ³•åŒºä¸­ï¼Œæ¯”å¦‚ç±»çš„é™æ€å˜é‡ã€‚æ–¹æ³•åŒºå’Œæ ˆç±»ä¼¼ï¼Œå…¶ä¸­åªåŒ…å«åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚å’Œæ ˆä¸åŒçš„æ˜¯ï¼Œæ–¹æ³•åŒºä¸­çš„é™æ€å˜é‡å¯ä»¥è¢«æ‰€æœ‰çº¿ç¨‹è®¿é—®åˆ°ã€‚","text":"çº¿ç¨‹å’Œå…±äº«æ•°æ® åœ¨JVMä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹ç‹¬äº«ä¸€å—æ ˆå†…å­˜ï¼Œå…¶ä¸­åŒ…æ‹¬å±€éƒ¨å˜é‡ã€çº¿ç¨‹è°ƒç”¨çš„æ¯ä¸ªæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ã€‚å…¶å®ƒçº¿ç¨‹æ— æ³•è¯»å–åˆ°è¯¥æ ˆå†…å­˜å—ä¸­çš„æ•°æ®ã€‚æ ˆä¸­çš„æ•°æ®ä»…é™äºåŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚ åœ¨JVMä¸­ï¼Œå †å†…å­˜æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ã€‚å¯¹è±¡åœ¨å †ä¸­ã€‚ è¿˜æœ‰ä¸€éƒ¨åˆ†æ•°æ®ä¿å­˜JVMä¸­çš„æ–¹æ³•åŒºä¸­ï¼Œæ¯”å¦‚ç±»çš„é™æ€å˜é‡ã€‚æ–¹æ³•åŒºå’Œæ ˆç±»ä¼¼ï¼Œå…¶ä¸­åªåŒ…å«åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚å’Œæ ˆä¸åŒçš„æ˜¯ï¼Œæ–¹æ³•åŒºä¸­çš„é™æ€å˜é‡å¯ä»¥è¢«æ‰€æœ‰çº¿ç¨‹è®¿é—®åˆ°ã€‚ å¯¹è±¡å’Œç±»çš„é” JMMä¸­æœ‰ä¸¤å—åŒºåŸŸå¯ä»¥è¢«æ‰€æœ‰çº¿ç¨‹å…±äº« å †ï¼Œå­˜æ”¾ç€æ‰€æœ‰å¯¹è±¡æ–¹æ³•åŒºï¼Œå­˜æ”¾ç€é™æ€å˜é‡ é‚£ä¹ˆï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹æƒ³è¦åŒæ—¶è®¿é—®åŒä¸€ä¸ªå¯¹è±¡æˆ–è€…é™æ€å˜é‡ï¼Œå°±éœ€è¦è¢«ç®¡æ§ï¼Œå¦åˆ™å¯èƒ½å‡ºç°ä¸å¯é¢„æœŸçš„ç»“æœ ä¸ºäº†åè°ƒå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å…±äº«æ•°æ®è®¿é—®ï¼Œè™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å’Œç±»éƒ½åˆ†é…äº†ä¸€ä¸ªé”ã€‚è¿™ä¸ªé”å°±åƒä¸€ä¸ªç‰¹æƒï¼Œåœ¨åŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥â€œæ‹¥æœ‰â€è¿™ä¸ªç±»æˆ–è€…å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹æƒ³è¦è·å¾—æŸä¸ªç±»æˆ–è€…å¯¹è±¡çš„é”ï¼Œéœ€è¦è¯¢é—®è™šæ‹Ÿæœºã€‚å½“ä¸€ä¸ªçº¿ç¨‹å‘è™šæ‹Ÿæœºç”³è¯·æŸä¸ªç±»æˆ–è€…å¯¹è±¡çš„é”ä¹‹åï¼Œä¹Ÿè®¸å¾ˆå¿«æˆ–è€…å¾ˆæ…¢è™šæ‹Ÿæœºå¯ä»¥æŠŠé”åˆ†é…ç»™è¿™ä¸ªçº¿ç¨‹ï¼ŒåŒæ—¶è¿™ä¸ªçº¿ç¨‹ä¹Ÿè®¸æ°¸è¿œä¹Ÿæ— æ³•è·å¾—é”ã€‚ä½†çº¿ç¨‹ä¸å†éœ€è¦é”çš„æ—¶å€™ï¼Œä»–å†æŠŠé”è¿˜ç»™è™šæ‹Ÿæœºã€‚è¿™æ—¶è™šæ‹Ÿæœºå°±å¯ä»¥å†æŠŠé”åˆ†é…ç»™å…¶å®ƒç”³è¯·é”çš„çº¿ç¨‹ã€‚ ç±»é”å…¶å®é€šè¿‡å¯¹è±¡é”å®ç°çš„ã€‚å› ä¸ºå½“è™šæ‹ŸæœºåŠ è½½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œä¼šä¸ºè¿™ä¸ªç±»å®ä¾‹åŒ–ä¸€ä¸ªjava.lang.Classå¯¹è±¡ï¼Œå½“ä½ é”ä½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå…¶å®é”ä½çš„æ˜¯å…¶å¯¹åº”çš„Classå¯¹è±¡ ç›‘è§†å™¨ï¼ˆMonitorsï¼‰ é”å…¶å®æ˜¯é€šè¿‡ç›‘è§†å™¨å®ç°çš„ï¼Œç›‘è§†å™¨ä¸»è¦åŠŸèƒ½æ˜¯ç›‘æ§ä¸€æ®µä»£ç ï¼Œç¡®ä¿åœ¨åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œã€‚ æ¯ä¸ªç›‘è§†å™¨éƒ½ä¸ä¸€ä¸ªå¯¹è±¡ç›¸å…³è”ã€‚å½“çº¿ç¨‹æ‰§è¡Œåˆ°ç›‘è§†å™¨ç›‘è§†ä¸‹çš„ä»£ç å—ä¸­çš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ—¶ï¼Œçº¿ç¨‹å¿…é¡»è·å–å¯¹è¢«å¼•ç”¨å¯¹è±¡çš„é”å®šã€‚åœ¨çº¿ç¨‹è·å–é”ä¹‹å‰ï¼Œå®ƒæ˜¯æ— æ³•æ‰§è¡Œè¿™æ®µä»£ç çš„ï¼Œä¸€æ—¦è·å¾—é”ï¼Œçº¿ç¨‹ä¾¿å¯ä»¥è¿›å…¥â€œè¢«ä¿æŠ¤â€çš„ä»£ç å¼€å§‹æ‰§è¡Œã€‚ å½“çº¿ç¨‹ç¦»å¼€ä»£ç å—æ—¶ï¼Œæ— è®ºå¦‚ä½•ç¦»å¼€ï¼Œéƒ½ä¼šé‡Šæ”¾æ‰€å…³è”å¯¹è±¡çš„é” å¤šæ¬¡åŠ é” åŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯¹åŒä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¤šæ¬¡åŠ é”ã€‚æ¯ä¸ªå¯¹è±¡ç»´æŠ¤ç€ä¸€ä¸ªè®°å½•ç€è¢«é”æ¬¡æ•°çš„è®¡æ•°å™¨ã€‚æœªè¢«é”å®šçš„å¯¹è±¡çš„è¯¥è®¡æ•°å™¨ä¸º0ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å¾—é”åï¼Œè¯¥è®¡æ•°å™¨è‡ªå¢å˜ä¸º1ï¼Œå½“åŒä¸€ä¸ªçº¿ç¨‹å†æ¬¡è·å¾—è¯¥å¯¹è±¡çš„é”çš„æ—¶å€™ï¼Œè®¡æ•°å™¨å†æ¬¡è‡ªå¢ã€‚å½“åŒä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”çš„æ—¶å€™ï¼Œè®¡æ•°å™¨å†è‡ªå‡ã€‚å½“è®¡æ•°å™¨ä¸º0çš„æ—¶å€™ã€‚é”å°†è¢«é‡Šæ”¾ï¼Œå…¶å®ƒçº¿ç¨‹ä¾¿å¯ä»¥è·å¾—é”ã€‚ åŒæ­¥ åœ¨Javaä¸­ï¼Œå½“æœ‰å¤šä¸ªçº¿ç¨‹éƒ½å¿…é¡»è¦å¯¹åŒä¸€ä¸ªå…±äº«æ•°æ®è¿›è¡Œè®¿é—®æ—¶ï¼Œæœ‰ä¸€ç§åè°ƒæ–¹å¼å«åšåŒæ­¥ã€‚Javaè¯­è¨€æä¾›äº†ä¸¤ç§å†…ç½®æ–¹å¼æ¥ä½¿çº¿ç¨‹åŒæ­¥çš„è®¿é—®æ•°æ®ï¼šåŒæ­¥ä»£ç å—å’ŒåŒæ­¥æ–¹æ³•ã€‚ å‚è€ƒ Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œçº¿ç¨‹åŒæ­¥çš„","categories":[{"name":"JVM","slug":"JVM","permalink":"https://hsb786.github.io/categories/JVM/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"https://hsb786.github.io/tags/å¤šçº¿ç¨‹/"}]},{"title":"lombok","slug":"lombok","date":"2018-04-08T08:23:41.000Z","updated":"2018-04-20T13:18:36.359Z","comments":true,"path":"2018/04/08/lombok/","link":"","permalink":"https://hsb786.github.io/2018/04/08/lombok/","excerpt":"é€šè¿‡ä½¿ç”¨@Dataæ³¨è§£è‡ªåŠ¨å¸®ä½ ç”Ÿæˆgetters,setters,toString(),equals(),hashCode()æ–¹æ³• @AllArgsConstructor å…¨å‚æ„é€ å‡½æ•° @NoArgsConstructor æ— å‚æ„é€ å‡½æ•°","text":"é€šè¿‡ä½¿ç”¨@Dataæ³¨è§£è‡ªåŠ¨å¸®ä½ ç”Ÿæˆgetters,setters,toString(),equals(),hashCode()æ–¹æ³• @AllArgsConstructor å…¨å‚æ„é€ å‡½æ•° @NoArgsConstructor æ— å‚æ„é€ å‡½æ•°","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/categories/å·¥å…·/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"VSCodeå¿«æ·é”®","slug":"VSCodeå¿«æ·é”®","date":"2018-04-08T07:58:41.000Z","updated":"2018-04-20T13:20:01.055Z","comments":true,"path":"2018/04/08/VSCodeå¿«æ·é”®/","link":"","permalink":"https://hsb786.github.io/2018/04/08/VSCodeå¿«æ·é”®/","excerpt":"","text":"å‘½ä»¤ è¯­ä¹‰ ctrl B ä¾§è¾¹æ æ˜¾/éš ctrl shift E èµ„æºç®¡ç†å™¨ ctrl tab æ–‡ä»¶åˆ‡æ¢ F1æˆ–ctrl shift p å‘½ä»¤çª—å£ ctrl , ç”¨æˆ·è®¾ç½®","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/categories/å·¥å…·/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"gitå‘½ä»¤","slug":"gitCommand","date":"2018-04-08T07:42:41.000Z","updated":"2018-04-20T13:16:09.817Z","comments":true,"path":"2018/04/08/gitCommand/","link":"","permalink":"https://hsb786.github.io/2018/04/08/gitCommand/","excerpt":"","text":"","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/categories/å·¥å…·/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]},{"title":"markdown","slug":"markdown","date":"2018-04-08T04:31:41.000Z","updated":"2018-04-20T13:18:44.008Z","comments":true,"path":"2018/04/08/markdown/","link":"","permalink":"https://hsb786.github.io/2018/04/08/markdown/","excerpt":"Cmd Markdown ç®€æ˜è¯­æ³•æ‰‹å†Œæ ‡ç­¾ï¼š Cmd-Markdown","text":"Cmd Markdown ç®€æ˜è¯­æ³•æ‰‹å†Œæ ‡ç­¾ï¼š Cmd-Markdown 1. æ–œä½“å’Œç²—ä½“ä½¿ç”¨ * å’Œ ** è¡¨ç¤ºæ–œä½“å’Œç²—ä½“ã€‚ ç¤ºä¾‹ï¼š è¿™æ˜¯ æ–œä½“ï¼Œè¿™æ˜¯ ç²—ä½“ã€‚ 2. åˆ†çº§æ ‡é¢˜ä½¿ç”¨ === è¡¨ç¤ºä¸€çº§æ ‡é¢˜ï¼Œä½¿ç”¨ â€” è¡¨ç¤ºäºŒçº§æ ‡é¢˜ã€‚ ç¤ºä¾‹ï¼š 1234567è¿™æ˜¯ä¸€ä¸ªä¸€çº§æ ‡é¢˜============================è¿™æ˜¯ä¸€ä¸ªäºŒçº§æ ‡é¢˜--------------------------------------------------### è¿™æ˜¯ä¸€ä¸ªä¸‰çº§æ ‡é¢˜ ä½ ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨è¡Œé¦–åŠ äº•å·è¡¨ç¤ºä¸åŒçº§åˆ«çš„æ ‡é¢˜ (H1-H6)ï¼Œä¾‹å¦‚ï¼š# H1, ## H2, ### H3ï¼Œ#### H4ã€‚ 3. å¤–é“¾æ¥ä½¿ç”¨ [æè¿°](é“¾æ¥åœ°å€) ä¸ºæ–‡å­—å¢åŠ å¤–é“¾æ¥ã€‚ ç¤ºä¾‹ï¼š è¿™æ˜¯å»å¾€ æœ¬äººåšå®¢ çš„é“¾æ¥ã€‚ 4. æ— åºåˆ—è¡¨ä½¿ç”¨ *ï¼Œ+ï¼Œ- è¡¨ç¤ºæ— åºåˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š æ— åºåˆ—è¡¨é¡¹ ä¸€ æ— åºåˆ—è¡¨é¡¹ äºŒ æ— åºåˆ—è¡¨é¡¹ ä¸‰ 5. æœ‰åºåˆ—è¡¨ä½¿ç”¨æ•°å­—å’Œç‚¹è¡¨ç¤ºæœ‰åºåˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š æœ‰åºåˆ—è¡¨é¡¹ ä¸€ æœ‰åºåˆ—è¡¨é¡¹ äºŒ æœ‰åºåˆ—è¡¨é¡¹ ä¸‰ 6. æ–‡å­—å¼•ç”¨ä½¿ç”¨ &gt; è¡¨ç¤ºæ–‡å­—å¼•ç”¨ã€‚ ç¤ºä¾‹ï¼š é‡ç«çƒ§ä¸å°½ï¼Œæ˜¥é£å¹åˆç”Ÿã€‚ 7. è¡Œå†…ä»£ç å—ä½¿ç”¨ `ä»£ç ` è¡¨ç¤ºè¡Œå†…ä»£ç å—ã€‚ ç¤ºä¾‹ï¼š è®©æˆ‘ä»¬èŠèŠ htmlã€‚ 8. ä»£ç å—ä½¿ç”¨ å››ä¸ªç¼©è¿›ç©ºæ ¼ è¡¨ç¤ºä»£ç å—ã€‚ ç¤ºä¾‹ï¼š è¿™æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œæ­¤è¡Œå·¦ä¾§æœ‰å››ä¸ªä¸å¯è§çš„ç©ºæ ¼ã€‚ 9. æ’å…¥å›¾åƒä½¿ç”¨ ![æè¿°](å›¾ç‰‡é“¾æ¥åœ°å€) æ’å…¥å›¾åƒã€‚ ç¤ºä¾‹ï¼š Cmd Markdown é«˜é˜¶è¯­æ³•æ‰‹å†Œ1. å†…å®¹ç›®å½•åœ¨æ®µè½ä¸­å¡«å†™ [TOC] ä»¥æ˜¾ç¤ºå…¨æ–‡å†…å®¹çš„ç›®å½•ç»“æ„ã€‚ [TOC] 2. æ ‡ç­¾åˆ†ç±»åœ¨ç¼–è¾‘åŒºä»»æ„è¡Œçš„åˆ—é¦–ä½ç½®è¾“å…¥ä»¥ä¸‹ä»£ç ç»™æ–‡ç¨¿æ ‡ç­¾ï¼š æ ‡ç­¾ï¼š æ•°å­¦ è‹±è¯­ Markdown æˆ–è€… Tagsï¼š æ•°å­¦ è‹±è¯­ Markdown 3. åˆ é™¤çº¿ä½¿ç”¨ ~~ è¡¨ç¤ºåˆ é™¤çº¿ã€‚ è¿™æ˜¯ä¸€æ®µé”™è¯¯çš„æ–‡æœ¬ã€‚ 4. æ³¨è„šä½¿ç”¨ [^keyword] è¡¨ç¤ºæ³¨è„šã€‚ è¿™æ˜¯ä¸€ä¸ªæ³¨è„š[^footnote]çš„æ ·ä¾‹ã€‚ è¿™æ˜¯ç¬¬äºŒä¸ªæ³¨è„š[^footnote2]çš„æ ·ä¾‹ã€‚ 5. LaTeX å…¬å¼$ è¡¨ç¤ºè¡Œå†…å…¬å¼ï¼š è´¨èƒ½å®ˆæ’æ–¹ç¨‹å¯ä»¥ç”¨ä¸€ä¸ªå¾ˆç®€æ´çš„æ–¹ç¨‹å¼ $E=mc^2$ æ¥è¡¨è¾¾ã€‚ $$ è¡¨ç¤ºæ•´è¡Œå…¬å¼ï¼š $$\\sum_{i=1}^n a_i=0$$ $$f(x_1,x_x,\\ldots,x_n) = x_1^2 + x_2^2 + \\cdots + x_n^2 $$ $$\\sum^{j-1}{k=0}{\\widehat{\\gamma}{kj} z_k}$$ è®¿é—® MathJax å‚è€ƒæ›´å¤šä½¿ç”¨æ–¹æ³•ã€‚ 6. åŠ å¼ºçš„ä»£ç å—æ”¯æŒå››åä¸€ç§ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•é«˜äº®çš„æ˜¾ç¤ºï¼Œè¡Œå·æ˜¾ç¤ºã€‚ éä»£ç ç¤ºä¾‹ï¼š 1$ sudo apt-get install vim-gnome Python ç¤ºä¾‹ï¼š 123456789101112@requires_authorizationdef somefunc(param1='', param2=0): '''A docstring''' if param1 &gt; param2: # interesting print 'Greater' return (param2 - param1 + 1) or Noneclass SomeClass: pass&gt;&gt;&gt; message = '''interpreter... prompt''' JavaScript ç¤ºä¾‹ï¼š 1234567891011121314151617/*** nth element in the fibonacci series.* @param n &gt;= 0* @return the nth element, &gt;= 0.*/function fib(n) &#123; var a = 1, b = 1; var tmp; while (--n &gt;= 0) &#123; tmp = a; a += b; b = tmp; &#125; return a;&#125;document.write(fib(10)); 7. æµç¨‹å›¾ç¤ºä¾‹12345678910st=&gt;start: Start:&gt;https://www.zybuluo.comio=&gt;inputoutput: verificationop=&gt;operation: Your Operationcond=&gt;condition: Yes or No?sub=&gt;subroutine: Your Subroutinee=&gt;endst-&gt;io-&gt;op-&gt;condcond(yes)-&gt;econd(no)-&gt;sub-&gt;io æ›´å¤šè¯­æ³•å‚è€ƒï¼šæµç¨‹å›¾è¯­æ³•å‚è€ƒ8. åºåˆ—å›¾ç¤ºä¾‹ 1123Alice-&gt;Bob: Hello Bob, how are you?Note right of Bob: Bob thinksBob--&gt;Alice: I am good thanks! ç¤ºä¾‹ 212345Title: Here is a titleA-&gt;B: Normal lineB--&gt;C: Dashed lineC-&gt;&gt;D: Open arrowD--&gt;&gt;A: Dashed open arrow æ›´å¤šè¯­æ³•å‚è€ƒï¼šåºåˆ—å›¾è¯­æ³•å‚è€ƒ9. ç”˜ç‰¹å›¾ç”˜ç‰¹å›¾å†…åœ¨æ€æƒ³ç®€å•ã€‚åŸºæœ¬æ˜¯ä¸€æ¡çº¿æ¡å›¾ï¼Œæ¨ªè½´è¡¨ç¤ºæ—¶é—´ï¼Œçºµè½´è¡¨ç¤ºæ´»åŠ¨ï¼ˆé¡¹ç›®ï¼‰ï¼Œçº¿æ¡è¡¨ç¤ºåœ¨æ•´ä¸ªæœŸé—´ä¸Šè®¡åˆ’å’Œå®é™…çš„æ´»åŠ¨å®Œæˆæƒ…å†µã€‚å®ƒç›´è§‚åœ°è¡¨æ˜ä»»åŠ¡è®¡åˆ’åœ¨ä»€ä¹ˆæ—¶å€™è¿›è¡Œï¼ŒåŠå®é™…è¿›å±•ä¸è®¡åˆ’è¦æ±‚çš„å¯¹æ¯”ã€‚ 12345678910111213title é¡¹ç›®å¼€å‘æµç¨‹section é¡¹ç›®ç¡®å®š éœ€æ±‚åˆ†æ :a1, 2016-06-22, 3d å¯è¡Œæ€§æŠ¥å‘Š :after a1, 5d æ¦‚å¿µéªŒè¯ : 5dsection é¡¹ç›®å®æ–½ æ¦‚è¦è®¾è®¡ :2016-07-05 , 5d è¯¦ç»†è®¾è®¡ :2016-07-08, 10d ç¼–ç  :2016-07-15, 10d æµ‹è¯• :2016-07-22, 5dsection å‘å¸ƒéªŒæ”¶ å‘å¸ƒ: 2d éªŒæ”¶: 3d æ›´å¤šè¯­æ³•å‚è€ƒï¼šç”˜ç‰¹å›¾è¯­æ³•å‚è€ƒ10. Mermaid æµç¨‹å›¾1234A[Hard edge] --&gt;|Link text| B(Round edge)B --&gt; C&#123;Decision&#125;C --&gt;|One| D[Result one]C --&gt;|Two| E[Result two] æ›´å¤šè¯­æ³•å‚è€ƒï¼šMermaid æµç¨‹å›¾è¯­æ³•å‚è€ƒ11. Mermaid åºåˆ—å›¾1234Alice-&gt;John: Hello John, how are you?loop every minute John--&gt;Alice: Great!end æ›´å¤šè¯­æ³•å‚è€ƒï¼šMermaid åºåˆ—å›¾è¯­æ³•å‚è€ƒ12. è¡¨æ ¼æ”¯æŒ é¡¹ç›® ä»·æ ¼ æ•°é‡ è®¡ç®—æœº \\$1600 5 æ‰‹æœº \\$12 12 ç®¡çº¿ \\$1 234 13. å®šä¹‰å‹åˆ—è¡¨åè¯ 1: å®šä¹‰ 1ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å— 2: è¿™æ˜¯ä»£ç å—çš„å®šä¹‰ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å—ï¼ˆå·¦ä¾§æœ‰å…«ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ 14. Html æ ‡ç­¾æœ¬ç«™æ”¯æŒåœ¨ Markdown è¯­æ³•ä¸­åµŒå¥— Html æ ‡ç­¾ï¼Œè­¬å¦‚ï¼Œä½ å¯ä»¥ç”¨ Html å†™ä¸€ä¸ªçºµè·¨ä¸¤è¡Œçš„è¡¨æ ¼ï¼š &lt;table&gt; &lt;tr&gt; &lt;th rowspan=&quot;2&quot;&gt;å€¼ç­äººå‘˜&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸä¸€&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸäºŒ&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸä¸‰&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;æå¼º&lt;/td&gt; &lt;td&gt;å¼ æ˜&lt;/td&gt; &lt;td&gt;ç‹å¹³&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; å€¼ç­äººå‘˜ æ˜ŸæœŸä¸€ æ˜ŸæœŸäºŒ æ˜ŸæœŸä¸‰ æå¼º å¼ æ˜ ç‹å¹³ 15. å†…åµŒå›¾æ ‡æœ¬ç«™çš„å›¾æ ‡ç³»ç»Ÿå¯¹å¤–å¼€æ”¾ï¼Œåœ¨æ–‡æ¡£ä¸­è¾“å…¥ &lt;i class=&quot;icon-weibo&quot;&gt;&lt;/i&gt; å³æ˜¾ç¤ºå¾®åšçš„å›¾æ ‡ï¼š æ›¿æ¢ ä¸Šè¿° i æ ‡ç­¾ å†…çš„ icon-weibo ä»¥æ˜¾ç¤ºä¸åŒçš„å›¾æ ‡ï¼Œä¾‹å¦‚ï¼š &lt;i class=&quot;icon-renren&quot;&gt;&lt;/i&gt; å³æ˜¾ç¤ºäººäººçš„å›¾æ ‡ï¼š æ›´å¤šçš„å›¾æ ‡å’Œç©æ³•å¯ä»¥å‚çœ‹ font-awesome å®˜æ–¹ç½‘ç«™ã€‚ 16. å¾…åŠäº‹å®œ Todo åˆ—è¡¨ä½¿ç”¨å¸¦æœ‰ [ ] æˆ– [x] ï¼ˆæœªå®Œæˆæˆ–å·²å®Œæˆï¼‰é¡¹çš„åˆ—è¡¨è¯­æ³•æ’°å†™ä¸€ä¸ªå¾…åŠäº‹å®œåˆ—è¡¨ï¼Œå¹¶ä¸”æ”¯æŒå­åˆ—è¡¨åµŒå¥—ä»¥åŠæ··ç”¨Markdownè¯­æ³•ï¼Œä¾‹å¦‚ï¼š - [ ] **Cmd Markdown å¼€å‘** - [ ] æ”¹è¿› Cmd æ¸²æŸ“ç®—æ³•ï¼Œä½¿ç”¨å±€éƒ¨æ¸²æŸ“æŠ€æœ¯æé«˜æ¸²æŸ“æ•ˆç‡ - [ ] æ”¯æŒä»¥ PDF æ ¼å¼å¯¼å‡ºæ–‡ç¨¿ - [x] æ–°å¢Todoåˆ—è¡¨åŠŸèƒ½ [è¯­æ³•å‚è€ƒ](https://github.com/blog/1375-task-lists-in-gfm-issues-pulls-comments) - [x] æ”¹è¿› LaTex åŠŸèƒ½ - [x] ä¿®å¤ LaTex å…¬å¼æ¸²æŸ“é—®é¢˜ - [x] æ–°å¢ LaTex å…¬å¼ç¼–å·åŠŸèƒ½ [è¯­æ³•å‚è€ƒ](http://docs.mathjax.org/en/latest/tex.html#tex-eq-numbers) - [ ] **ä¸ƒæœˆæ—…è¡Œå‡†å¤‡** - [ ] å‡†å¤‡é‚®è½®ä¸Šéœ€è¦æºå¸¦çš„ç‰©å“ - [ ] æµè§ˆæ—¥æœ¬å…ç¨åº—çš„ç‰©å“ - [x] è´­ä¹°è“å®çŸ³å…¬ä¸»å·ä¸ƒæœˆä¸€æ—¥çš„èˆ¹ç¥¨ å¯¹åº”æ˜¾ç¤ºå¦‚ä¸‹å¾…åŠäº‹å®œ Todo åˆ—è¡¨ï¼š Cmd Markdown å¼€å‘ æ”¹è¿› Cmd æ¸²æŸ“ç®—æ³•ï¼Œä½¿ç”¨å±€éƒ¨æ¸²æŸ“æŠ€æœ¯æé«˜æ¸²æŸ“æ•ˆç‡ æ”¯æŒä»¥ PDF æ ¼å¼å¯¼å‡ºæ–‡ç¨¿ æ–°å¢Todoåˆ—è¡¨åŠŸèƒ½ è¯­æ³•å‚è€ƒ æ”¹è¿› LaTex åŠŸèƒ½ ä¿®å¤ LaTex å…¬å¼æ¸²æŸ“é—®é¢˜ æ–°å¢ LaTex å…¬å¼ç¼–å·åŠŸèƒ½ è¯­æ³•å‚è€ƒ ä¸ƒæœˆæ—…è¡Œå‡†å¤‡ å‡†å¤‡é‚®è½®ä¸Šéœ€è¦æºå¸¦çš„ç‰©å“ æµè§ˆæ—¥æœ¬å…ç¨åº—çš„ç‰©å“ è´­ä¹°è“å®çŸ³å…¬ä¸»å·ä¸ƒæœˆä¸€æ—¥çš„èˆ¹ç¥¨","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/categories/å·¥å…·/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://hsb786.github.io/tags/å·¥å…·/"}]}]}
<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HuShengBinâ€™s blog</title>
  
  <subtitle>ç æ¸£çš„ä¸ªäººåšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://hsb786.github.io/"/>
  <updated>2018-04-13T08:01:13.361Z</updated>
  <id>https://hsb786.github.io/</id>
  
  <author>
    <name>HuShengBin</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€è¯‘ã€‘å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList--clear vs removeAll ï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/13/%E8%AF%91-%E5%A6%82%E4%BD%95%E9%87%8D%E7%BD%AE%E4%B8%80%E4%B8%AAArrayList-clear-vs-removeAll/"/>
    <id>https://hsb786.github.io/2018/04/13/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/</id>
    <published>2018-04-13T07:55:17.000Z</published>
    <updated>2018-04-13T08:01:13.361Z</updated>
    
    <content type="html"><![CDATA[<p>å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®<code>clear</code>æˆ–<code>removeAll</code>ã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°<code>java.lang.OutOfMemoryError: Java Heap Space</code>ã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚<br><a id="more"></a></p><h2 id="Clear-vs-RemoveAll-Collection-c"><a href="#Clear-vs-RemoveAll-Collection-c" class="headerlink" title="Clear() vs RemoveAll(Collection c)"></a>Clear() vs RemoveAll(Collection c)</h2><p>ä¸ºäº†æ›´å¥½çš„æ¯”è¾ƒè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œé˜…è¯»ä»–ä»¬æºç æ˜¯å¾ˆé‡è¦çš„ã€‚å¯ä»¥åœ¨<code>java.utils.ArrayList</code>ç±»ä¸­æ‰¾åˆ°clear()æ–¹æ³•ï¼Œä¸è¿‡ä¸ºäº†æ–¹ä¾¿æˆ‘å°†å®ƒå¼•å…¥åˆ°äº†è¿™é‡Œã€‚ä¸‹é¢çš„ä»£ç æ¥è‡ªJDK 1.7.0_40ç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³è¦å­¦ä¹ æ›´å¤šçš„æœ‰å…³æ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜çš„çŸ¥è¯†ï¼Œæˆ‘å¼ºçƒˆå»ºè®®é˜…è¯»Scott Oakså†™çš„Java Performance the Definitive Guide,å®ƒåŒ…å«äº†java 7å’Œä¸€ç‚¹java 8ã€‚ä¸‹é¢æ˜¯clear()çš„ä»£ç ç‰‡æ®µ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/** </span><br><span class="line"> * Removes all of the elements from this list.The list will </span><br><span class="line"> * be empty after this call returns. </span><br><span class="line"> */ </span><br><span class="line"> public void clear() &#123; </span><br><span class="line"> modCount++; // clear to let GC do its work </span><br><span class="line"> for (int i = 0; i &lt; size; i++) </span><br><span class="line"> elementData[i] = null; </span><br><span class="line"> size = 0; </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>å¤§å®¶å¯ä»¥çœ‹å‡ºï¼Œclear()åœ¨å¾ªç¯éå†ArrayListï¼Œå¹¶ä¸”å°†æ¯ä¸€ä¸ªå…ƒç´ éƒ½ç½®ä¸ºnullï¼Œä½¿å®ƒä»¬åœ¨æ²¡æœ‰è¢«å¤–éƒ¨å¼•ç”¨çš„æƒ…å†µä¸‹å¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚ç›¸ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>java.util.AbstractCollection</code>ç±»ä¸­æŸ¥çœ‹removeAll(Collention c)çš„ä»£ç ï¼Œä¸‹é¢æ˜¯ä»£ç ç‰‡æ®µ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public boolean removeAll(Collection&lt;?&gt; c) &#123;</span><br><span class="line">//åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºnull</span><br><span class="line">      Objects.requireNonNull(c);</span><br><span class="line">      boolean modified = false;</span><br><span class="line">      Iterator&lt;?&gt; it = iterator();</span><br><span class="line">      while (it.hasNext()) &#123;</span><br><span class="line">          if (c.contains(it.next())) &#123;</span><br><span class="line">              it.remove();</span><br><span class="line">              modified = true;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return modified;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>  è¿™ä¸ªæ–¹æ³•ä¼šæ£€æŸ¥è¿­ä»£å™¨é¡ºåºè¿”å›çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦åŒ…å«åœ¨ç‰¹å®šçš„é›†åˆä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œè°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•å°†å®ƒä»é›†åˆä¸­ç§»é™¤ã€‚å› ä¸ºä¼šç”¨åˆ°containsæ–¹æ³•ï¼ŒremoveAllçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚æ‰€ä»¥åœ¨æƒ³è¦é‡ç½®ä¸€ä¸ªå¤§çš„ArrayListæ—¶ï¼Œè¿™ç§æ–¹æ³•æ˜¯ç»å¯¹ä¸å¯å–çš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…åœ¨é‡ç½®ä¸€ä¸ªåŒ…å«100Kä¸ªå…ƒç´ æ—¶çš„æ€§èƒ½å·®å¼‚ã€‚</p><h2 id="åˆ é™¤ä¸€ä¸ªåŒ…å«100kä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ "><a href="#åˆ é™¤ä¸€ä¸ªåŒ…å«100kä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ " class="headerlink" title="åˆ é™¤ä¸€ä¸ªåŒ…å«100kä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ "></a>åˆ é™¤ä¸€ä¸ªåŒ…å«100kä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ </h2><p>  æˆ‘æœ¬æ¥æƒ³åœ¨ä¾‹å­ä¸­å°è¯•é‡ç½®ä¸€ä¸ªåŒ…å«10Mä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼Œä¸è¿‡åœ¨è¶…è¿‡åŠä¸ªå°æ—¶ç­‰å¾…removeAll()ç»“æŸåï¼Œæˆ‘å†³å®šå°†å…ƒç´ çš„æ•°é‡é™ä¸º100Kã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªæ–¹æ³•çš„å·®è·ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„ã€‚removeAll()æ¯”clear()å¤šèŠ±è´¹äº†10000å€çš„æ—¶é—´ã€‚äº‹å®ä¸Šï¼Œåœ¨APIä¸­clear()å’ŒremoveAll(Collection c)è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç›®çš„æ˜¯ä¸åŒçš„ã€‚clear()æ–¹æ³•æ˜¯ä¸ºäº†é€šè¿‡åˆ é™¤æ‰€æœ‰å…ƒç´ è€Œé‡ç½®åˆ—è¡¨ï¼Œè€ŒremoveAll(Collection c)æ˜¯ä¸ºäº†ä»é›†åˆä¸­åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€ä¸ªæä¾›çš„é›†åˆä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸æ˜¯ä¸ºäº†ä»é›†åˆä¸­ç§»é™¤æ‰€æœ‰å…ƒç´ ã€‚æ‰€ä»¥å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æ‰€æœ‰å…ƒç´ ï¼Œç”¨clear(),å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€é›†åˆçš„å…ƒç´ ï¼Œé‚£ä¹ˆé€‰æ‹©removeAll(Collection c)æ–¹æ³•ã€‚</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import java.util.ArrayList; </span><br><span class="line">/**</span><br><span class="line"> * Java Program to remove all elements from list in Java and comparing </span><br><span class="line"> * performance of clearn() and removeAll() method. </span><br><span class="line"> * * @author Javin Paul </span><br><span class="line"> */ </span><br><span class="line"> public class ArrayListResetTest &#123; </span><br><span class="line"> </span><br><span class="line"> private static final int SIZE = 100_000; </span><br><span class="line"> public static void main(String args[]) &#123; </span><br><span class="line"> </span><br><span class="line"> // Two ArrayList for clear and removeAll </span><br><span class="line"> ArrayList numbers = new ArrayList(SIZE); </span><br><span class="line"> ArrayList integers = new ArrayList(SIZE); </span><br><span class="line"> // Initialize ArrayList with 10M integers </span><br><span class="line"> for (int i = 0; i &amp;lt; SIZE; i++) &#123; </span><br><span class="line"> numbers.add(new Integer(i)); </span><br><span class="line"> integers.add(new Integer(i)); </span><br><span class="line"> &#125; </span><br><span class="line"> // Empty ArrayList using clear method </span><br><span class="line"> long startTime = System.nanoTime(); </span><br><span class="line"> numbers.clear(); </span><br><span class="line"> long elapsed = System.nanoTime() - startTime; </span><br><span class="line"> System.out.println(&quot;Time taken by clear to empty ArrayList of 1M elements (ns): &quot; + elapsed); </span><br><span class="line"> // Reset ArrayList using removeAll method </span><br><span class="line"> startTime = System.nanoTime(); </span><br><span class="line"> integers.removeAll(integers); </span><br><span class="line"> long time = System.nanoTime() - startTime; </span><br><span class="line"> System.out.println(&quot;Time taken by removeAll to reset ArrayList of 1M elements (ns): &quot; + time); </span><br><span class="line"> &#125; </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> Output: </span><br><span class="line"> Time taken by clear to empty ArrayList of 100000 elements (ns): 889619 </span><br><span class="line"> Time taken by removeAll to reset ArrayList of 100000 elements (ns): 36633112126</span><br></pre></td></tr></table></figure><p>  ç”±äºç¨‹åºä½¿ç”¨äº†ä¸¤ä¸ªarrayListå­˜å‚¨Integersï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶è¦ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå°¤å…¶æ˜¯ä½ æƒ³æ¯”è¾ƒåœ¨åˆ—è¡¨å­˜æœ‰1Mä¸ªå…ƒç´ æ—¶ï¼Œä¸¤ç§æ–¹æ³•çš„æ€§èƒ½å·®å¼‚ã€‚å¦å¤–ï¼Œç”±äºä½¿ç”¨äº†åœ¨æ•°å­—ä¸­åŠ å…¥ä¸‹åˆ’çº¿çš„ç‰¹æ€§ï¼Œæ‰€ä»¥éœ€è¦java7æ¥è¿è¡Œã€‚å¦‚æœæ²¡æœ‰JDK7ï¼Œä¹Ÿå¯ä»¥ç§»é™¤SIZEå¸¸é‡ä¸­çš„ä¸‹åˆ’çº¿ã€‚</p><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://yemengying.com/2015/10/26/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/" target="_blank" rel="noopener"> ã€è¯‘ã€‘å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayListâ€“clear vs removeAll </a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®&lt;code&gt;clear&lt;/code&gt;æˆ–&lt;code&gt;removeAll&lt;/code&gt;ã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°&lt;code&gt;java.lang.OutOfMemoryError: Java Heap Space&lt;/code&gt;ã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>ã€è¯‘ã€‘ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll ï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/13/%E8%AF%91-%E4%BB%A5%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E4%B8%BA%E4%BE%8B%E9%98%90%E8%BF%B0%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8wait%EF%BC%8Cnotify%E5%92%8CnotifyAll/"/>
    <id>https://hsb786.github.io/2018/04/13/è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll/</id>
    <published>2018-04-13T07:34:36.000Z</published>
    <updated>2018-04-13T07:49:23.236Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:<code>Producer</code>(ç”Ÿäº§è€…)å’Œ<code>Consumer</code>(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚<br><a id="more"></a></p><h2 id="åœ¨ä»£ç ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨waitå’Œnotify"><a href="#åœ¨ä»£ç ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨waitå’Œnotify" class="headerlink" title="åœ¨ä»£ç ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨waitå’Œnotify"></a>åœ¨ä»£ç ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨waitå’Œnotify</h2><p>å°½ç®¡waitå’Œnotifyæ˜¯ç›¸å½“åŸºç¡€çš„æ¦‚å¿µï¼Œå¹¶ä¸”ä»–ä»¬å®šä¹‰åœ¨<code>Object</code>ç±»ä¸­ï¼Œä½†è¦æƒ³åœ¨ä»£ç ä¸­ä½¿ç”¨ä»–ä»¬å¹¶éæ˜“äº‹ã€‚ä½ å¯ä»¥åœ¨é¢è¯•ä¸­è®©é¢è¯•è€…é€šè¿‡æ‰‹å†™ä»£ç è§£å†³Producerè€…å’ŒConsumerè€…é—®é¢˜æ¥éªŒè¯ï¼Œæˆ‘ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ä¼šçŠ¯åœ¨é”™è¯¯çš„åœ°æ–¹åŒæ­¥ï¼Œæ²¡æœ‰åœ¨æ­£ç¡®çš„å¯¹è±¡ä¸Šè°ƒç”¨waitä¹‹ç±»çš„é”™ã€‚è®²çœŸï¼Œè¿™äº›å¸¸å¸¸ä¼šå›°æƒ‘è®¸å¤šç¨‹åºå‘˜ã€‚ç¬¬ä¸€ä¸ªå›°æƒ‘ç‚¹æ¥è‡ªæ€æ ·è°ƒç”¨waitæ–¹æ³•ï¼Œå› ä¸ºwaitæ–¹æ³•å¹¶ä¸æ˜¯å®šä¹‰åœ¨Threadç±»ä¸­ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•çš„Thread.wait()ã€‚è€Œè®¸å¤šJavaå¼€å‘è€…ä¹ æƒ¯äºThread.sleep(),æ‰€ä»¥å¸¸å¸¸é”™è¯¯çš„æƒ³ç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨waitã€‚å®é™…ä¸Šï¼Œwait()æ–¹æ³•éœ€è¦åœ¨ä¸€ä¸ªè¢«ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨ï¼Œä¾‹å¦‚åœ¨Producerè€…å’Œæ¶ˆè´¹Consumerçš„é—®é¢˜ä¸­ï¼Œä¸¤ä¸ªçº¿ç¨‹å…±äº«å¯¹è±¡æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ã€‚ç¬¬äºŒä¸ªå›°æƒ‘ç‚¹æ¥è‡ªwaitæ–¹æ³•åº”è¯¥åœ¨åŒæ­¥å—è¿˜æ˜¯åŒæ­¥æ–¹æ³•ä¸­è°ƒç”¨ï¼Ÿå¦‚æœä½¿ç”¨åŒæ­¥å—ï¼Œé‚£ä¹ˆå“ªä¸ªå¯¹è±¡åº”è¯¥æ”¾åˆ°åŒæ­¥å—ä¸­ï¼Ÿè¿™ä¸ªå¯¹è±¡å’Œä½ æƒ³è¦è·å¾—é”çš„å¯¹è±¡åº”è¯¥æ˜¯åŒä¸€ä¸ªã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„é˜Ÿåˆ—ã€‚</p><h2 id="åœ¨å¾ªç¯ä¸­ä½¿ç”¨waitå’Œnotifyï¼Œè€Œä¸æ˜¯Ifä»£ç å—ä¸­"><a href="#åœ¨å¾ªç¯ä¸­ä½¿ç”¨waitå’Œnotifyï¼Œè€Œä¸æ˜¯Ifä»£ç å—ä¸­" class="headerlink" title="åœ¨å¾ªç¯ä¸­ä½¿ç”¨waitå’Œnotifyï¼Œè€Œä¸æ˜¯Ifä»£ç å—ä¸­"></a>åœ¨å¾ªç¯ä¸­ä½¿ç”¨waitå’Œnotifyï¼Œè€Œä¸æ˜¯Ifä»£ç å—ä¸­</h2><p>åœ¨ä½ å·²ç»äº†è§£éœ€è¦åœ¨ä¸€ä¸ªå…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨waitæ–¹æ³•åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å­¦ä¼šé¿å…è®¸å¤šjavaå¼€å‘è€…çŠ¯çš„é”™â€”åœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitè€Œä¸æ˜¯whileå¾ªç¯ä¸­ã€‚å› ä¸ºéœ€è¦åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹è°ƒç”¨waitï¼Œæ¯”å¦‚Producerçº¿ç¨‹è¦åœ¨é˜Ÿåˆ—æ»¡äº†çš„æƒ…å†µä¸‹è°ƒç”¨waitï¼Œæ‰€ä»¥ç¬¬ä¸€ååº”éƒ½æ˜¯ä½¿ç”¨Ifè¯­å¥ã€‚ä½†æ˜¯ï¼Œåœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitä¼šäº§ç”Ÿ<code>bug</code>ï¼Œå› ä¸ºçº¿ç¨‹å­˜åœ¨ä¸€å®šçš„å¯èƒ½åœ¨ç­‰å¾…æ¡ä»¶æ²¡æœ‰æ”¹å˜çš„æƒ…å†µä¸‹<a href="https://hsb786.github.io/2018/04/09/æœ¯è¯­/">å‡å”¤é†’(spurious wake up)</a>ã€‚æ‰€ä»¥å¦‚æœæ²¡æœ‰ä½¿ç”¨å¾ªç¯åœ¨çº¿ç¨‹å”¤é†’åæ£€æŸ¥ç­‰å¾…æ¡ä»¶ï¼Œå¯èƒ½ä¼šé€ æˆå°è¯•åœ¨å·²ç»æ»¡äº†çš„é˜Ÿåˆ—ä¸­æ’å…¥å…ƒç´ æˆ–è€…åœ¨ç©ºäº†çš„é˜Ÿåˆ—ä¸­å–å…ƒç´ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åœ¨whileå¾ªç¯ä¸­è°ƒç”¨waitè€Œä¸æ˜¯ifã€‚</p><h2 id="Javaä¸­ä½¿ç”¨wait-notify-notifyAll-çš„ä¾‹å­"><a href="#Javaä¸­ä½¿ç”¨wait-notify-notifyAll-çš„ä¾‹å­" class="headerlink" title="Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­"></a>Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­</h2><p>ä¸‹é¢æ˜¯åœ¨Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹(PRODUCTORå’ŒCONSUMER)ï¼Œç”¨ç»§æ‰¿äº†Threadç±»çš„Producerå’ŒConsumerç±»å®ç°ã€‚Prodcuerå’ŒConsumerçš„ä¸šåŠ¡é€»è¾‘å†™åœ¨ä»–ä»¬å„è‡ªçš„run()æ–¹æ³•ä¸­ã€‚å¹¶ä¸”å®ç°ä¸€ä¸ªLinkedListï¼Œå½“åšå…±äº«é˜Ÿåˆ—ã€‚Produceråœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ä¸æ–­åœ¨é˜Ÿåˆ—ä¸­æ’å…¥éšæœºæ•°ï¼Œç›´åˆ°é˜Ÿåˆ—æ»¡äº†ã€‚æˆ‘ä»¬ä¼šæ£€æŸ¥while(queue.size == maxSize),éœ€è¦æ³¨æ„çš„æ˜¯åœ¨æ£€æŸ¥ä¹‹å‰éœ€è¦ç»™é˜Ÿåˆ—åŠ ä¸ŠåŒæ­¥é”ä»¥ä¿è¯åœ¨æ£€æŸ¥æ—¶æ²¡æœ‰å¦ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹é˜Ÿåˆ—ã€‚å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼ŒPRODUCERçº¿ç¨‹å°±ä¼šä¼‘çœ ï¼Œç›´åˆ°CONSUMERæ¶ˆè´¹äº†é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¹¶ä¸”è°ƒç”¨notify()æ–¹æ³•é€šçŸ¥PRODUCERçº¿ç¨‹ã€‚<code>waitå’Œnotifyéƒ½æ˜¯åœ¨å…±äº«çš„å¯¹è±¡(æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯é˜Ÿåˆ—)ä¸Šè°ƒç”¨çš„</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">import java.util.LinkedList;</span><br><span class="line">import java.util.Queue;</span><br><span class="line">import java.util.Random;</span><br><span class="line">/**</span><br><span class="line"> * Simple Java program to demonstrate How to use wait, notify and notifyAll()</span><br><span class="line"> * method in Java by solving producer consumer problem.</span><br><span class="line"> *</span><br><span class="line"> * @author Javin Paul</span><br><span class="line"> */</span><br><span class="line">public class MultipleThread &#123;</span><br><span class="line">    public static void main(String args[]) &#123;</span><br><span class="line">        System.out.println(&quot;How to use wait and notify method in Java&quot;);</span><br><span class="line">        System.out.println(&quot;Solving Producer Consumper Problem&quot;);</span><br><span class="line">        Queue&lt;Integer&gt; buffer = new LinkedList&lt;&gt;();</span><br><span class="line">        int maxSize = 10;</span><br><span class="line">        Thread producer = new Producer(buffer, maxSize, &quot;PRODUCER&quot;);</span><br><span class="line">        Thread consumer = new Consumer(buffer, maxSize, &quot;CONSUMER&quot;);</span><br><span class="line">        producer.start();</span><br><span class="line">        consumer.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line"> * Producer Thread will keep producing values for Consumer</span><br><span class="line"> * to consumer. It will use wait() method when Queue is full</span><br><span class="line"> * and use notify() method to send notification to Consumer</span><br><span class="line"> * Thread.</span><br><span class="line"> * @author WINDOWS 8</span><br><span class="line"> * */</span><br><span class="line">class Producer extends Thread &#123;</span><br><span class="line">    private Queue&lt;Integer&gt; queue;</span><br><span class="line">    private int maxSize;</span><br><span class="line">    public Producer(Queue&lt;Integer&gt; queue, int maxSize, String name) &#123;</span><br><span class="line">        super(name);</span><br><span class="line">        this.queue = queue;</span><br><span class="line">        this.maxSize = maxSize;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override public void run() &#123;</span><br><span class="line">        while (true) &#123;</span><br><span class="line">            synchronized (queue) &#123;</span><br><span class="line">                while (queue.size() == maxSize) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        System.out .println(&quot;Queue is full, &quot; + &quot;Producer thread waiting for &quot; + &quot;consumer to take something from queue&quot;);</span><br><span class="line">                        queue.wait();</span><br><span class="line">                    &#125; catch (Exception ex) &#123;</span><br><span class="line">                        ex.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                Random random = new Random();</span><br><span class="line">                int i = random.nextInt();</span><br><span class="line">                System.out.println(&quot;Producing value : &quot; + i);</span><br><span class="line">                queue.add(i);</span><br><span class="line">                queue.notifyAll();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line"> * Consumer Thread will consumer values form shared queue.</span><br><span class="line"> * It will also use wait() method to wait if queue is</span><br><span class="line"> * empty. It will also use notify method to send * notification to producer thread after consuming values</span><br><span class="line"> * from queue.</span><br><span class="line"> * @author WINDOWS 8</span><br><span class="line"> **/</span><br><span class="line">class Consumer extends Thread &#123;</span><br><span class="line">    private Queue&lt;Integer&gt; queue;</span><br><span class="line">    private int maxSize;</span><br><span class="line">    public Consumer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123;</span><br><span class="line">        super(name);</span><br><span class="line">        this.queue = queue;</span><br><span class="line">        this.maxSize = maxSize;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override public void run() &#123;</span><br><span class="line">        while (true) &#123;</span><br><span class="line">            synchronized (queue) &#123;</span><br><span class="line">                while (queue.isEmpty()) &#123;</span><br><span class="line">                    System.out.println(&quot;Queue is empty,&quot; + &quot;Consumer thread is waiting&quot; + &quot; for producer thread to put something in queue&quot;);</span><br><span class="line">                    try &#123;</span><br><span class="line">                        queue.wait();</span><br><span class="line">                    &#125; catch (Exception ex) &#123;</span><br><span class="line">                        ex.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; System.out.println(&quot;Consuming value : &quot; + queue.remove());</span><br><span class="line">                queue.notifyAll();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Output </span><br><span class="line">How to use wait and notify method in Java </span><br><span class="line">Solving Producer Consumper Problem </span><br><span class="line">Queue is empty,Consumer thread is waiting for producer thread to put something in queue </span><br><span class="line">Producing value : -1692411980 </span><br><span class="line">Producing value : 285310787 </span><br><span class="line">Producing value : -1045894970 </span><br><span class="line">Producing value : 2140997307 </span><br><span class="line">Producing value : 1379699468 </span><br><span class="line">Producing value : 912077154 </span><br><span class="line">Producing value : -1635438928 </span><br><span class="line">Producing value : -500696499 </span><br><span class="line">Producing value : -1985700664 </span><br><span class="line">Producing value : 961945684 </span><br><span class="line">Queue is full, Producer thread waiting for consumer to take something from queue Consuming value : -1692411980 </span><br><span class="line">Consuming value : 285310787 </span><br><span class="line">Consuming value : -1045894970 </span><br><span class="line">Consuming value : 2140997307 </span><br><span class="line">Consuming value : 1379699468 </span><br><span class="line">Consuming value : 912077154 </span><br><span class="line">Consuming value : -1635438928 </span><br><span class="line">Consuming value : -500696499 </span><br><span class="line">Consuming value : -1985700664 </span><br><span class="line">Consuming value : 961945684 </span><br><span class="line">Queue is empty,Consumer thread is waiting for producer thread to put something in queue</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAlléœ€è¦æ³¨æ„çš„"><a href="#ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAlléœ€è¦æ³¨æ„çš„" class="headerlink" title="ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAlléœ€è¦æ³¨æ„çš„"></a>ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAlléœ€è¦æ³¨æ„çš„</h2><ul><li>åœ¨Javaä¸­å¯ä»¥ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllå®Œæˆå¤šçº¿ç¨‹(ä¸ä»…ä»…æ˜¯ä¸¤ä¸ªçº¿ç¨‹)çš„å†…éƒ¨é€šä¿¡ã€‚</li><li>åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllï¼Œå¦åˆ™JVMä¼šæŠ›å‡ºIllegalMonitorStateException</li><li>åœ¨å¾ªç¯ä¸­è°ƒç”¨waitï¼Œnotifyã€‚</li><li>åœ¨çº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨wait</li><li>åå‘é€‰æ‹©notifyAllï¼Œè€Œä¸æ˜¯notify</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:&lt;code&gt;Producer&lt;/code&gt;(ç”Ÿäº§è€…)å’Œ&lt;code&gt;Consumer&lt;/code&gt;(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
      <category term="å¤šçº¿ç¨‹" scheme="https://hsb786.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ã€è¯‘ã€‘Java8ä¸­çš„æ‰©å±•(default/extension)æ–¹æ³• ï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/13/Java-8%E4%B8%AD%E7%9A%84%E6%89%A9%E5%B1%95-Default-Defender-Extension-%E6%96%B9%E6%B3%95/"/>
    <id>https://hsb786.github.io/2018/04/13/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/</id>
    <published>2018-04-13T07:14:18.000Z</published>
    <updated>2018-04-13T07:24:37.104Z</updated>
    
    <content type="html"><![CDATA[<p>Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨<code>default</code>å’Œ<code>static</code>ä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚<br><a id="more"></a></p><h2 id="Defaultæ–¹æ³•çš„ä¾‹å­"><a href="#Defaultæ–¹æ³•çš„ä¾‹å­" class="headerlink" title="Defaultæ–¹æ³•çš„ä¾‹å­"></a>Defaultæ–¹æ³•çš„ä¾‹å­</h2><p>Java 8è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡defaultå…³é”®å­—ä¸ºæ¥å£æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•ã€‚è¿™ä¸€ç‰¹æ€§ä¹Ÿè¢«ç§°ä½œExtension(æ‰©å±•)æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ç¬¬ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface Multiplication&#123; </span><br><span class="line">    </span><br><span class="line">    int multiply(int a, int b); </span><br><span class="line">    </span><br><span class="line">    default int square(int a)&#123; </span><br><span class="line">        return multiply(a, a); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº†æŠ½è±¡æ–¹æ³•multiply()ä¹‹å¤–ï¼Œæ¥å£Multiplicationè¿˜åŒ…å«ä¸€ä¸ªdefaultæ–¹æ³•square()ã€‚ä»»ä½•å®ç°Multiplicationæ¥å£çš„ç±»åªéœ€å®ç°æŠ½è±¡æ–¹æ³•multiplyï¼Œdefaultæ–¹æ³•square()å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Multiplication product = new Multiplication()&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public int multiply(int x, int y)&#123;</span><br><span class="line">        return x*y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">    int square = product.square(2);</span><br><span class="line">    int multiplication = product.multiply(2, 3);</span><br></pre></td></tr></table></figure><p>productæ˜¯ä¸ªåŒ¿åç±»ã€‚è¿™æ®µä»£ç æœ‰ç‚¹å•°å—¦äº†ï¼Œç”¨äº†6è¡Œå®ç°ä¸€ä¸ªç®€å•åœ°ä¹˜æ³•çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨lambdaè¡¨è¾¾å¼æ¥ç®€åŒ–ä¸€ä¸‹ä»£ç ï¼Œlambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯Java 8ä¸­æ–°å¼•å…¥çš„ã€‚å› ä¸ºæˆ‘ä»¬çš„æ¥å£åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œè€Œä¸”lambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯SAM(Single Abstract methodå•ä¸€æŠ½è±¡æ–¹æ³•)ç±»å‹çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨lambdaè¡¨è¾¾å¼æ¥æ›¿ä»£åŒ¿åç±»å°†ä»£ç ç®€åŒ–æˆä¸‹é¢çš„æ ·å­ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Multiplication lambda = (x, y) -&gt; x*y; </span><br><span class="line">int product = lambda.multiply(3, 4); </span><br><span class="line">int square = lambda.square(4);</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸Šå°±æ˜¯åœ¨æ¥å£ä¸­ä½¿ç”¨defaultæ–¹æ³•çš„ä¾‹å­ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ¯«æ— é¡¾è™‘çš„åœ¨æ—§çš„æ¥å£ä¸­æ‰©å±•æ–°çš„æ–¹æ³•ï¼Œåªè¦è¿™äº›æ–¹æ³•æ˜¯defaultæˆ–staticçš„å°±ä¸ç”¨æ‹…å¿ƒä¼šç ´åæ¥å£çš„å®ç°ç±»ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">/**Java Program to demonstrate use of default method in Java 8. </span><br><span class="line"> * You can define non-abstract method by using default keyword, and more </span><br><span class="line"> * than one default method is permitted, which allows you to ship default skeletal </span><br><span class="line"> * implementation on interface itself. </span><br><span class="line"> * @author Javin Paul</span><br><span class="line"> */ </span><br><span class="line"> public class Java8DefaultMethodDemo&#123;</span><br><span class="line"> </span><br><span class="line">    public static void main(String args[]) &#123; </span><br><span class="line">    // Implementing interface using Anonymous class </span><br><span class="line">    Multiplication product = new Multiplication()&#123; </span><br><span class="line">        @Override public int multiply(int x, int y)&#123; </span><br><span class="line">            return x*y; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;; </span><br><span class="line">        int squareOfTwo = product.square(2); </span><br><span class="line">        int cubeOfTwo = product.cube(2); </span><br><span class="line">        System.out.println(&quot;Square of Two : &quot; + squareOfTwo); </span><br><span class="line">        System.out.println(&quot;Cube of Two : &quot; + cubeOfTwo); </span><br><span class="line">        // Since Multiplication has only one abstract method, it can </span><br><span class="line">        // also be implemented using lambda expression in Java 8 </span><br><span class="line">        Multiplication lambda = (x, y) -&gt; x*y; </span><br><span class="line">        int squareOfThree = lambda.square(3); </span><br><span class="line">        int cubeOfThree = lambda.cube(3); </span><br><span class="line">        System.out.println(&quot;Square of Three : &quot; + squareOfThree); </span><br><span class="line">        System.out.println(&quot;Cube of Three : &quot; + cubeOfThree);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line"> </span><br><span class="line">   interface Multiplication&#123; </span><br><span class="line">        int multiply(int a, int b);</span><br><span class="line">        default int square(int a)&#123; </span><br><span class="line">            return multiply(a, a); </span><br><span class="line">        &#125; </span><br><span class="line">        default int cube(int a)&#123; </span><br><span class="line">            return multiply(multiply(a, a), a); </span><br><span class="line">        &#125; </span><br><span class="line">       &#125; </span><br><span class="line">       Output :  Square of Two : 4 </span><br><span class="line">                 Cube of Two : 8 </span><br><span class="line">                 Square of Three : 9 </span><br><span class="line">                 Cube of Three : 27</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸ªå¾ˆå¥½çš„å…³äºå¦‚ä½•ä½¿ç”¨defaultæ–¹æ³•åœ¨æ¥å£ä¸­æ–¹ä¾¿çš„æ·»åŠ æ–¹æ³•çš„ä¾‹å­ã€‚ä¹Ÿå±•ç¤ºäº†å¦‚ä½•é¿å…ä¸€ä¸ªé¢å¤–çš„å¸®åŠ©ç±»ï¼Œæ¯”å¦‚Collectionsç±»ã€‚å®ƒä»…ä»…æä¾›äº†ä¸€äº›ç”¨äºCollectionçš„å·¥å…·æ–¹æ³•ï¼Œè€Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨Collectionä¸­å®šä¹‰è¿™äº›æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•multiply(a,b)çš„æ¥å£Multiplicationï¼Œæ¥å£è¿˜åŒ…æ‹¬ä¸¤ä¸ªä¾èµ–äºmultiply(a,b)æ–¹æ³•çš„éæŠ½è±¡æ–¹æ³•square(a)å’Œcube(b)ã€‚æ¥å£çš„å®ç°ç±»åªéœ€è¦å®ç°multiply(a,b)æ–¹æ³•ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨square(a)å’Œcube(b)æ–¹æ³•äº†ã€‚</p><h2 id="defaultæ–¹æ³•çš„å…³é”®ç‚¹"><a href="#defaultæ–¹æ³•çš„å…³é”®ç‚¹" class="headerlink" title="defaultæ–¹æ³•çš„å…³é”®ç‚¹"></a>defaultæ–¹æ³•çš„å…³é”®ç‚¹</h2><ul><li>åœ¨Java8ä¸­ä½ å¯ä»¥åœ¨æ¥å£ä¸­æ·»åŠ defaultæ–¹æ³•</li><li>defaultæ–¹æ³•çš„å‡ºç°ä½¿å¾—æ¥å£å’ŒæŠ½è±¡ç±»çš„ä¸åŒå˜å¾—æ¨¡ç³Šã€‚æ‰€ä»¥ï¼Œå½“åœ¨é¢è¯•ä¸­è¢«é—®åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåˆ«å¿˜äº†æä¸€ä¸‹ï¼Œä»¥å‰åªèƒ½é€šè¿‡æŠ½è±¡ç±»å®ç°çš„äº‹æƒ…ï¼Œç°åœ¨ä¹Ÿå¯ä»¥é€šè¿‡defaultæ–¹æ³•å®ç°äº†ã€‚</li><li>defaultå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å…³é”®å­—ï¼Œåœ¨JDK1.1ä¸­å°±æ˜¯ä¿ç•™å…³é”®å­—</li><li>æ¥å£ä¸­defaultæ–¹æ³•çš„æ•°é‡æ²¡æœ‰é™åˆ¶</li><li>å¦‚æœæ¥å£Cç»§æ‰¿äº†æ¥å£Aå’ŒBï¼Œå¦‚æœAå’ŒBä¸­æ‹¥æœ‰ä¸€æ ·çš„defaultæ–¹æ³•ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ã€‚ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œè¿™åœ¨Java 8ä¸­æ˜¯ä¸å…è®¸çš„ã€‚æ‰€ä»¥å½“defaultæ–¹æ³•æœ‰å†²çªæ—¶ï¼Œæ˜¯ä¸å¯ä»¥å¤šç»§æ‰¿çš„</li><li>åœ¨JDK1.8ä¸­æœ‰è®¸å¤šå…³äºdefaultæ–¹æ³•çš„ä¾‹å­ï¼Œæ¯”å¦‚forEachæ–¹æ³•ã€‚ä¹Ÿå¯ä»¥æŸ¥çœ‹java.util.Mapä¸­æ–°æ·»çš„putIfAbsentæ–¹æ³•ï¼Œåœ¨JDK1.8ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½ConcurrentMapæ¥ä½¿ç”¨å®ƒã€‚</li></ul><p>ä»¥ä¸Šå°±æ˜¯defaultæ–¹æ³•ã€‚ä¸å¾—ä¸è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„çªç ´ï¼Œä½¿æˆ‘ä»¬å¯ä»¥æ›´å¥½æ›´æ–¹ä¾¿çš„ä½¿ç”¨æ¥å£ã€‚äº†è§£CurrentMapçš„putIfAbsentæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„è®°ä½defaultæ–¹æ³•ã€‚åœ¨JDK1.7ä¸­ï¼ŒputIfAbsentæ–¹æ³•å¹¶ä¸å­˜åœ¨äºMapæ¥å£ä¸­ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿ç”¨putIfAbsentæ–¹æ³•ï¼Œå¿…é¡»å°†Mapæ¥å£æŒ‡å‘çš„ConcurrentMapå¯¹è±¡å¼ºåˆ¶è½¬æ¢æˆConcurrentMapã€‚ä½†Java 8å¼•å…¥æ‰©å±•æ–¹æ³•ä¹‹åï¼ŒMapæ¥å£ä¸­ä¹Ÿæœ‰äº†putIfAbsentæ–¹æ³•ã€‚</p><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://yemengying.com/2015/11/01/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/" target="_blank" rel="noopener">ã€è¯‘ã€‘Java8ä¸­çš„æ‰©å±•(default/extension)æ–¹æ³• </a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨&lt;code&gt;default&lt;/code&gt;å’Œ&lt;code&gt;static&lt;/code&gt;ä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMapï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/13/%E3%80%90%E8%AF%91%E3%80%91%E5%A6%82%E4%BD%95%E5%9C%A8java%E4%B8%AD%E4%BD%BF%E7%94%A8ConcurrentHashMap/"/>
    <id>https://hsb786.github.io/2018/04/13/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/</id>
    <published>2018-04-13T06:41:41.000Z</published>
    <updated>2018-04-13T07:26:36.082Z</updated>
    
    <content type="html"><![CDATA[<p>ConcurrentHashMap(ç®€ç§°<code>CHM</code>)æ˜¯åœ¨Java 1.5ä½œä¸º<code>Hashtable</code>çš„æ›¿ä»£é€‰æ‹©æ–°å¼•å…¥çš„ï¼Œæ˜¯concurrentåŒ…çš„é‡è¦æˆå‘˜ã€‚åœ¨Java 1.5ä¹‹å‰ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¯ä»¥åœ¨å¤šçº¿ç¨‹å’Œå¹¶å‘çš„ç¨‹åºä¸­å®‰å…¨ä½¿ç”¨çš„Map,åªèƒ½åœ¨HashTableå’Œsynchronized Mapä¸­é€‰æ‹©ï¼Œå› ä¸ºHashMapå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†å†å¼•å…¥äº†CHMä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¥½çš„é€‰æ‹©ã€‚CHMä¸ä½†æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”æ¯”HashTableå’ŒsynchronizedMapçš„æ€§èƒ½è¦å¥½ã€‚ç›¸å¯¹äºHashTableå’ŒsynchronizedMapé”ä½äº†æ•´ä¸ªMapï¼ŒCHMåªé”ä½éƒ¨åˆ†Mapã€‚CHMå…è®¸å¹¶å‘çš„è¯»æ“ä½œï¼ŒåŒæ—¶é€šè¿‡åŒæ­¥é”åœ¨å†™æ“ä½œæ—¶ä¿æŒæ•°æ®å®Œæ•´æ€§ã€‚<br><a id="more"></a></p><h2 id="Javaä¸­ConcurrentHashMapçš„å®ç°"><a href="#Javaä¸­ConcurrentHashMapçš„å®ç°" class="headerlink" title="Javaä¸­ConcurrentHashMapçš„å®ç°"></a>Javaä¸­ConcurrentHashMapçš„å®ç°</h2><p>CHMå¼•å…¥äº†åˆ†å‰²ï¼Œå¹¶æä¾›äº†HashTableæ”¯æŒçš„æ‰€æœ‰çš„åŠŸèƒ½ã€‚åœ¨CHMä¸­ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¯¹Mapåšè¯»æ“ä½œï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•çš„blockingã€‚è¿™å¾—ç›ŠäºCHMå°†Mapåˆ†å‰²æˆäº†ä¸åŒçš„éƒ¨åˆ†ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶åªé”ä½ä¸€éƒ¨åˆ†ã€‚æ ¹æ®é»˜è®¤çš„å¹¶å‘çº§åˆ«(<code>concurrency level</code>)ï¼ŒMapè¢«åˆ†å‰²æˆ16ä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”ç”±ä¸åŒçš„é”æ§åˆ¶ã€‚è¿™æ„å‘³ç€ï¼ŒåŒæ—¶æœ€å¤šå¯ä»¥æœ‰16ä¸ªå†™çº¿ç¨‹æ“ä½œMapã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œç”±åªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥å˜æˆåŒæ—¶å¯ç”±16ä¸ªå†™çº¿ç¨‹åŒæ—¶è¿›å…¥(è¯»çº¿ç¨‹å‡ ä¹ä¸å—é™åˆ¶)ï¼Œæ€§èƒ½çš„æå‡æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†ç”±äºä¸€äº›æ›´æ–°æ“ä½œï¼Œå¦‚put(),remove(),putAll(),clear()åªé”ä½æ“ä½œçš„éƒ¨åˆ†ï¼Œæ‰€ä»¥åœ¨æ£€ç´¢æ“ä½œä¸èƒ½ä¿è¯è¿”å›çš„æ˜¯æœ€æ–°çš„ç»“æœã€‚</p><p>å¦ä¸€ä¸ªé‡è¦ç‚¹æ˜¯åœ¨è¿­ä»£éå†CHMæ—¶ï¼ŒkeySetè¿”å›çš„iteratoræ˜¯<a href="https://hsb786.github.io/2018/04/09/æœ¯è¯­/">å¼±ä¸€è‡´</a>å’Œ<a href="(https://hsb786.github.io/2018/04/09/æœ¯è¯­/">fail-safe</a>çš„ï¼Œå¯èƒ½ä¸ä¼šè¿”å›æŸäº›æœ€è¿‘çš„æ”¹å˜ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå·²ç»éå†çš„æ•°ç»„ä¸Šçš„å†…å®¹å˜åŒ–äº†ï¼Œä¸ä¼šæŠ›å‡ºConcurrentModificationExceptoinçš„å¼‚å¸¸ã€‚</p><p>CHMé»˜è®¤çš„å¹¶å‘çº§åˆ«æ˜¯16ï¼Œä½†å¯ä»¥åœ¨åˆ›å»ºCHMæ—¶é€šè¿‡æ„é€ å‡½æ•°æ”¹å˜ã€‚æ¯«æ— ç–‘é—®ï¼Œå¹¶å‘çº§åˆ«ä»£è¡¨ç€å¹¶å‘æ‰§è¡Œæ›´æ–°æ“ä½œçš„æ•°ç›®ï¼Œæ‰€ä»¥å¦‚æœåªæœ‰å¾ˆå°‘çš„çº¿ç¨‹ä¼šæ›´æ–°Mapï¼Œé‚£ä¹ˆå»ºè®®è®¾ç½®ä¸€ä¸ªä½çš„å¹¶å‘çº§åˆ«ã€‚å¦å¤–ï¼ŒCHMè¿˜ä½¿ç”¨äº†ReentrantLockæ¥å¯¹segmentsåŠ é”ã€‚</p><h2 id="Javaä¸­ConcurrentHashMap-putifAbsentæ–¹æ³•çš„ä¾‹å­"><a href="#Javaä¸­ConcurrentHashMap-putifAbsentæ–¹æ³•çš„ä¾‹å­" class="headerlink" title="Javaä¸­ConcurrentHashMap putifAbsentæ–¹æ³•çš„ä¾‹å­"></a>Javaä¸­ConcurrentHashMap putifAbsentæ–¹æ³•çš„ä¾‹å­</h2><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨å…ƒç´ ä¸å­˜åœ¨æ—¶æ’å…¥å…ƒç´ ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåƒä¸‹é¢é‚£æ ·å†™ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">synchronized(map)&#123;</span><br><span class="line">  if (map.get(key) == null)&#123;</span><br><span class="line">      return map.put(key, value);</span><br><span class="line">  &#125; else&#123;</span><br><span class="line">      return map.get(key);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç åœ¨HashMapå’ŒHashTableä¸­æ˜¯å¥½ç”¨çš„ï¼Œä½†åœ¨CHMä¸­æ˜¯æœ‰å‡ºé”™çš„é£é™©çš„ã€‚è¿™æ˜¯å› ä¸ºCHMåœ¨putæ“ä½œæ—¶å¹¶æ²¡æœ‰å¯¹æ•´ä¸ªMapåŠ é”ï¼Œæ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨put(k,v)çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨get(k)ä¼šå¾—åˆ°nullï¼Œè¿™å°±ä¼šé€ æˆä¸€ä¸ªçº¿ç¨‹putçš„å€¼ä¼šè¢«å¦ä¸€ä¸ªçº¿ç¨‹putçš„å€¼æ‰€è¦†ç›–ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥å°†ä»£ç å°è£…åˆ°synchronizedä»£ç å—ä¸­ï¼Œè¿™æ ·è™½ç„¶çº¿ç¨‹å®‰å…¨äº†ï¼Œä½†ä¼šä½¿ä½ çš„ä»£ç å˜æˆäº†å•çº¿ç¨‹ã€‚CHMæä¾›çš„putIfAbsent(key,value)æ–¹æ³•åŸå­æ€§çš„å®ç°äº†åŒæ ·çš„åŠŸèƒ½ï¼ŒåŒæ—¶é¿å…äº†ä¸Šé¢çš„çº¿ç¨‹ç«äº‰çš„é£é™©ã€‚</p><h2 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMap</h2><p>CHMé€‚ç”¨äºè¯»è€…æ•°é‡è¶…è¿‡å†™è€…æ—¶ï¼Œå½“å†™è€…æ•°é‡å¤§äºç­‰äºè¯»è€…æ—¶ï¼ŒCHMçš„æ€§èƒ½æ˜¯ä½äºHashtableå’Œsynchronized Mapçš„ã€‚è¿™æ˜¯å› ä¸ºå½“é”ä½äº†æ•´ä¸ªMapæ—¶ï¼Œè¯»æ“ä½œè¦ç­‰å¾…å¯¹åŒä¸€éƒ¨åˆ†æ‰§è¡Œå†™æ“ä½œçš„çº¿ç¨‹ç»“æŸã€‚CHMé€‚ç”¨äºåšcache,åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œä¹‹åå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚çº¿ç¨‹è®¿é—®ã€‚æ­£å¦‚Javadocè¯´æ˜çš„é‚£æ ·ï¼ŒCHMæ˜¯HashTableä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£ï¼Œä½†è¦è®°ä½ï¼ŒCHMçš„æ¯”HashTableçš„åŒæ­¥æ€§ç¨å¼±ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯ConcurrentHashMapå’Œä»€ä¹ˆæ—¶å€™è¯¥ç”¨ConcurrentHashMapï¼Œä¸‹é¢æˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹CHMçš„ä¸€äº›å…³é”®ç‚¹ã€‚</p><ul><li>CHMå…è®¸å¹¶å‘çš„è¯»å’Œçº¿ç¨‹å®‰å…¨çš„æ›´æ–°æ“ä½œ</li><li>åœ¨æ‰§è¡Œå†™æ“ä½œæ—¶ï¼ŒCHMåªé”ä½éƒ¨åˆ†çš„Map</li><li>å¹¶å‘çš„æ›´æ–°æ˜¯é€šè¿‡å†…éƒ¨æ ¹æ®å¹¶å‘çº§åˆ«å°†Mapåˆ†å‰²æˆå°éƒ¨åˆ†å®ç°çš„</li><li>é«˜çš„å¹¶å‘çº§åˆ«ä¼šé€ æˆæ—¶é—´å’Œç©ºé—´çš„æµªè´¹ï¼Œä½çš„å¹¶å‘çº§åˆ«åœ¨å†™çº¿ç¨‹å¤šæ—¶ä¼šå¼•èµ·çº¿ç¨‹é—´çš„ç«äº‰</li><li>CHMçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨</li><li>CHMè¿”å›çš„è¿­ä»£å™¨æ˜¯å¼±ä¸€è‡´æ€§ï¼Œfail-safeå¹¶ä¸”ä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸</li><li>CHMä¸å…è®¸nullçš„é”®å€¼</li><li>å¯ä»¥ä½¿ç”¨CHMä»£æ›¿HashTableï¼Œä½†è¦è®°ä½CHMä¸ä¼šé”ä½æ•´ä¸ªMap</li></ul><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://yemengying.com/2015/11/06/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/" target="_blank" rel="noopener">ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ConcurrentHashMap(ç®€ç§°&lt;code&gt;CHM&lt;/code&gt;)æ˜¯åœ¨Java 1.5ä½œä¸º&lt;code&gt;Hashtable&lt;/code&gt;çš„æ›¿ä»£é€‰æ‹©æ–°å¼•å…¥çš„ï¼Œæ˜¯concurrentåŒ…çš„é‡è¦æˆå‘˜ã€‚åœ¨Java 1.5ä¹‹å‰ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¯ä»¥åœ¨å¤šçº¿ç¨‹å’Œå¹¶å‘çš„ç¨‹åºä¸­å®‰å…¨ä½¿ç”¨çš„Map,åªèƒ½åœ¨HashTableå’Œsynchronized Mapä¸­é€‰æ‹©ï¼Œå› ä¸ºHashMapå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†å†å¼•å…¥äº†CHMä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¥½çš„é€‰æ‹©ã€‚CHMä¸ä½†æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”æ¯”HashTableå’ŒsynchronizedMapçš„æ€§èƒ½è¦å¥½ã€‚ç›¸å¯¹äºHashTableå’ŒsynchronizedMapé”ä½äº†æ•´ä¸ªMapï¼ŒCHMåªé”ä½éƒ¨åˆ†Mapã€‚CHMå…è®¸å¹¶å‘çš„è¯»æ“ä½œï¼ŒåŒæ—¶é€šè¿‡åŒæ­¥é”åœ¨å†™æ“ä½œæ—¶ä¿æŒæ•°æ®å®Œæ•´æ€§ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>jvm-GCï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/13/jvm-GC/"/>
    <id>https://hsb786.github.io/2018/04/13/jvm-GC/</id>
    <published>2018-04-13T06:10:31.000Z</published>
    <updated>2018-04-13T06:42:42.575Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å…³é”®å­—çº¦å®š"><a href="#å…³é”®å­—çº¦å®š" class="headerlink" title="å…³é”®å­—çº¦å®š"></a>å…³é”®å­—çº¦å®š</h2><ul><li>Young generation â€“&gt;æ–°ç”Ÿä»£</li><li>Tenured / Old Generation â€“&gt;è€å¹´ä»£</li><li>Perm Area â€“&gt;æ°¸ä¹…ä»£</li></ul><h2 id="é‡è¦çš„ä¸œä¸œ"><a href="#é‡è¦çš„ä¸œä¸œ" class="headerlink" title="é‡è¦çš„ä¸œä¸œ"></a>é‡è¦çš„ä¸œä¸œ</h2><ul><li>åœ¨Javaä¸­ï¼Œå¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸€äº›ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ç­‰å­˜å‚¨åœ¨æ–¹æ³•åŒºã€‚å †å’Œæ–¹æ³•åŒºéƒ½æ˜¯çº¿ç¨‹å…±äº«çš„ã€‚</li><li>GCæœºåˆ¶æ˜¯ç”±JVMæä¾›ï¼Œç”¨æ¥æ¸…ç†éœ€è¦æ¸…é™¤çš„å¯¹è±¡ï¼Œå›æ”¶å †å†…å­˜ã€‚</li><li>GCæœºåˆ¶å°†Javaç¨‹åºå‘˜ä»å†…å­˜ç®¡ç†ä¸­è§£æ”¾äº†å‡ºæ¥ï¼Œå¯ä»¥æ›´å…³æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚</li><li>åœ¨Javaä¸­ï¼ŒGCæ˜¯ç”±ä¸€ä¸ªè¢«ç§°ä¸ºåƒåœ¾å›æ”¶å™¨çš„å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œçš„ã€‚</li><li>åœ¨ä»å†…å­˜å›æ”¶ä¸€ä¸ªå¯¹è±¡ä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„finalize()æ–¹æ³•ã€‚</li><li>ä½œä¸ºä¸€ä¸ªJavaå¼€å‘è€…ä¸èƒ½å¼ºåˆ¶JVMæ‰§è¡ŒGCï¼›GCçš„è§¦å‘ç”±JVMä¾æ®å †å†…å­˜çš„å¤§å°æ¥å†³å®šã€‚</li><li>System.gc()å’ŒRuntime.gc()ä¼šå‘JVMå‘é€æ‰§è¡ŒGCçš„è¯·æ±‚ï¼Œä½†æ˜¯JVMä¸ä¿è¯ä¸€å®šä¼šæ‰§è¡ŒGCã€‚</li><li>å¦‚æœå †æ²¡æœ‰å†…å­˜åˆ›å»ºæ–°çš„å¯¹è±¡äº†ï¼Œä¼šæŠ›å‡º<code>OutOfMemoryError</code>ã€‚<a id="more"></a><h2 id="GCé’ˆå¯¹ä»€ä¹ˆå¯¹è±¡ï¼Ÿ"><a href="#GCé’ˆå¯¹ä»€ä¹ˆå¯¹è±¡ï¼Ÿ" class="headerlink" title="GCé’ˆå¯¹ä»€ä¹ˆå¯¹è±¡ï¼Ÿ"></a>GCé’ˆå¯¹ä»€ä¹ˆå¯¹è±¡ï¼Ÿ</h2></li></ul><p>äº†è§£GCæœºåˆ¶çš„ç¬¬ä¸€æ­¥å°±æ˜¯ç†è§£ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«å›æ”¶ã€‚å½“ä¸€ä¸ªå¯¹è±¡é€šè¿‡ä¸€ç³»åˆ—æ ¹å¯¹è±¡(æ¯”å¦‚ï¼šé™æ€å±æ€§å¼•ç”¨çš„å¸¸é‡)éƒ½ä¸å¯è¾¾æ—¶å°±ä¼šè¢«å›æ”¶ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½ä¸ºnullã€‚å¾ªç¯ä¾èµ–ä¸ç®—åšå¼•ç”¨ï¼Œå¦‚æœå¯¹è±¡Aæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Bçš„å¼•ç”¨ï¼Œå¯¹è±¡Bä¹Ÿæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Açš„å¼•ç”¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä»¬æ²¡æœ‰å…¶ä»–å¼•ç”¨ï¼Œé‚£ä¹ˆå¯¹è±¡Aå’Œå¯¹è±¡Béƒ½ã€éœ€è¦è¢«å›æ”¶(å¦‚ä¸‹å›¾,ObjAå’ŒObjBéœ€è¦è¢«å›æ”¶)ã€‚</p><p><img src="/images/GC-Object.png" alt="GCå›æ”¶å¯¹è±¡"></p><h2 id="å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼Ÿ"><a href="#å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼Ÿ" class="headerlink" title="å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼Ÿ"></a>å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼Ÿ</h2><p>Javaä¸­å¯¹è±¡éƒ½åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸ºäº†GCï¼Œå †å†…å­˜åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥è¯´ä¸‰ä»£ï¼Œåˆ†åˆ«ç§°ä¸ºæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£ã€‚å…¶ä¸­æ–°ç”Ÿä»£åˆè¿›ä¸€æ­¥åˆ†ä¸ºEdenåŒºï¼ŒSurvivor 1åŒºå’ŒSurvivor 2åŒº(å¦‚ä¸‹å›¾)ã€‚æ–°åˆ›å»ºçš„å¯¹è±¡ä¼šåˆ†é…åœ¨EdenåŒº,åœ¨ç»å†ä¸€æ¬¡Minor GCåä¼šè¢«ç§»åˆ°Survivor 1åŒºï¼Œå†ç»å†ä¸€æ¬¡Minor GCåä¼šè¢«ç§»åˆ°Survivor 2åŒºï¼Œç›´åˆ°å‡è‡³è€å¹´ä»£,éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€äº›å¤§å¯¹è±¡(é•¿å­—ç¬¦ä¸²æˆ–æ•°ç»„)å¯èƒ½ä¼šç›´æ¥å­˜æ”¾åˆ°è€å¹´ä»£ã€‚</p><p><img src="/images/å †å†…å­˜.png" alt="å †å†…å­˜"></p><p>æ°¸ä¹…ä»£æœ‰ä¸€äº›ç‰¹æ®Šï¼Œå®ƒç”¨æ¥å­˜å‚¨ç±»çš„å…ƒä¿¡æ¯ã€‚å¯¹äºGCæ˜¯å¦å‘ç”Ÿåœ¨æ°¸ä¹…ä»£æœ‰è®¸å¤šä¸åŒçš„çœ‹æ³•ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™å–å†³äºé‡‡ç”¨çš„JVMã€‚å¤§å®¶å¯ä»¥é€šè¿‡åˆ›å»ºå¤§é‡çš„å­—ç¬¦ä¸²æ¥è§‚å¯Ÿæ˜¯å‘ç”Ÿäº†GCè¿˜æ˜¯æŠ›å‡ºäº†OutOfMemoryErrorã€‚</p><h2 id="GCç®—æ³•"><a href="#GCç®—æ³•" class="headerlink" title="GCç®—æ³•"></a>GCç®—æ³•</h2><ol><li>æ ‡è®°æ¸…é™¤ç®—æ³•<br> åˆ†ä¸ºæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚è¯¥ç®—æ³•çš„ç¼ºç‚¹æ˜¯æ•ˆç‡ä¸é«˜å¹¶ä¸”ä¼šäº§ç”Ÿä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚<br><img src="/images/sweep.jpg" alt=""></li><li>å¤åˆ¶ç®—æ³•<br> æŠŠå†…å­˜ç©ºé—´åˆ’ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåŒºåŸŸã€‚åƒåœ¾å›æ”¶æ—¶ï¼Œéå†å½“å‰ä½¿ç”¨åŒºåŸŸï¼ŒæŠŠæ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªåŒºåŸŸä¸­ã€‚æ­¤ç®—æ³•æ¯æ¬¡åªå¤„ç†æ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡ï¼Œå› æ­¤å¤åˆ¶æˆæœ¬æ¯”è¾ƒå°ï¼ŒåŒæ—¶å¤åˆ¶è¿‡å»ä»¥åè¿˜èƒ½è¿›è¡Œç›¸åº”çš„å†…å­˜æ•´ç†ï¼Œä¸ä¼šå‡ºç°â€œç¢ç‰‡â€é—®é¢˜ã€‚ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚ç¼ºç‚¹ï¼šä¼šæµªè´¹ä¸€å®šçš„å†…å­˜ã€‚ä¸€èˆ¬æ–°ç”Ÿä»£é‡‡ç”¨è¿™ç§ç®—æ³•ã€‚<br><img src="/images/copy.jpg" alt=""></li><li>æ ‡è®°æ•´ç†ç®—æ³•<br> æ ‡è®°é˜¶æ®µä¸æ ‡è®°æ¸…é™¤ç®—æ³•ä¸€æ ·ã€‚ä½†åç»­å¹¶ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶çš„å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½æƒ³ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åæ¸…ç†ã€‚ä¼˜ç‚¹æ˜¯ä¸ä¼šé€ æˆå†…å­˜ç¢ç‰‡ã€‚<br><img src="/images/compact.jpg" alt=""></li></ol><h2 id="Javaä¸­åƒåœ¾å›æ”¶å™¨çš„ç±»å‹"><a href="#Javaä¸­åƒåœ¾å›æ”¶å™¨çš„ç±»å‹" class="headerlink" title="Javaä¸­åƒåœ¾å›æ”¶å™¨çš„ç±»å‹"></a>Javaä¸­åƒåœ¾å›æ”¶å™¨çš„ç±»å‹</h2><p>Javaæä¾›å¤šç§ç±»å‹çš„åƒåœ¾å›æ”¶å™¨ã€‚JVMä¸­çš„åƒåœ¾æ”¶é›†ä¸€èˆ¬éƒ½é‡‡ç”¨â€œåˆ†ä»£æ”¶é›†â€ï¼Œä¸åŒçš„å †å†…å­˜åŒºåŸŸé‡‡ç”¨ä¸åŒçš„æ”¶é›†ç®—æ³•ï¼Œä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å¢åŠ ååé‡æˆ–é™ä½åœé¡¿æ—¶é—´ã€‚</p><ul><li>Serialæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œä¸²è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚</li><li>ParNewæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼ŒSerialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆï¼Œç”¨å¤šä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œå¹¶è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ä½¿ç”¨-XX:+UseParNewGCå¼€å…³æ¥æ§åˆ¶ä½¿ç”¨ParNew+Serial Oldæ”¶é›†å™¨ç»„åˆæ”¶é›†å†…å­˜ï¼›ä½¿ç”¨-XX:ParallelGCThreadsæ¥è®¾ç½®æ‰§è¡Œå†…å­˜å›æ”¶çš„çº¿ç¨‹æ•°ã€‚</li><li>Parallel Scavenge æ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨æ–°ç”Ÿä»£ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œå…³æ³¨CPUååé‡ï¼Œå³è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´/æ€»æ—¶é—´ã€‚ä½¿ç”¨-XX:+UseParallelGCå¼€å…³æ§åˆ¶ä½¿ç”¨Parallel Scavenge+Serial Oldæ”¶é›†å™¨ç»„åˆå›æ”¶åƒåœ¾ã€‚</li><li>Serial Oldæ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä¸²è¡Œï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œä½¿ç”¨å•çº¿ç¨‹è¿›è¡ŒGCï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚</li><li>Parallel Oldæ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨è€å¹´ä»£ï¼Œå¤šçº¿ç¨‹ï¼Œå¹¶è¡Œï¼Œå¤šçº¿ç¨‹æœºåˆ¶ä¸Parallel Scavengeå·®ä¸é”™ï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œåœ¨Parallel Oldæ‰§è¡Œæ—¶ï¼Œä»ç„¶éœ€è¦æš‚åœå…¶å®ƒçº¿ç¨‹ã€‚</li><li>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œè‡´åŠ›äºè·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ï¼ˆå³ç¼©çŸ­åƒåœ¾å›æ”¶çš„æ—¶é—´ï¼‰ï¼Œä½¿ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå¤šçº¿ç¨‹ï¼Œä¼˜ç‚¹æ˜¯å¹¶å‘æ”¶é›†ï¼ˆç”¨æˆ·çº¿ç¨‹å¯ä»¥å’ŒGCçº¿ç¨‹åŒæ—¶å·¥ä½œï¼‰ï¼Œåœé¡¿å°ã€‚ä½¿ç”¨-XX:+UseConcMarkSweepGCè¿›è¡ŒParNew+CMS+Serial Oldè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¼˜å…ˆä½¿ç”¨ParNew+CMSï¼ˆåŸå› è§Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶ä¸€èŠ‚ï¼‰ï¼Œå½“ç”¨æˆ·çº¿ç¨‹å†…å­˜ä¸è¶³æ—¶ï¼Œé‡‡ç”¨å¤‡ç”¨æ–¹æ¡ˆSerial Oldæ”¶é›†ã€‚</li></ul><h2 id="ä¸GCæœ‰å…³çš„JVMå‚æ•°"><a href="#ä¸GCæœ‰å…³çš„JVMå‚æ•°" class="headerlink" title="ä¸GCæœ‰å…³çš„JVMå‚æ•°"></a>ä¸GCæœ‰å…³çš„JVMå‚æ•°</h2><p>åœ¨å¼€å‘ä¸­æˆ‘ä»¬éœ€è¦é€šè¿‡åˆ†æé€ æˆFull GCçš„åŸå› æ¥æé«˜ç³»ç»Ÿæ€§èƒ½ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘å‘ç°åšGCçš„è°ƒä¼˜å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºå¯¹ç³»ç»Ÿçš„åˆ†æï¼Œç³»ç»Ÿæ‹¥æœ‰æ€æ ·çš„å¯¹è±¡ä»¥åŠä»–ä»¬çš„å¹³å‡ç”Ÿå‘½å‘¨æœŸã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨å¤§å¤šæ˜¯çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåº”è¯¥ç¡®ä¿EdenåŒºè¶³å¤Ÿå¤§ï¼Œè¿™æ ·å¯ä»¥å‡å°‘Minor GCçš„æ¬¡æ•°ã€‚å¯ä»¥é€šè¿‡-XX:NewRatioæ¥æ§åˆ¶æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹ï¼Œæ¯”å¦‚-XX:NewRatio=3ä»£è¡¨æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹ä¸º1ï¼š3ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰©å¤§æ–°ç”Ÿä»£çš„å¤§å°ä¼šå‡å°‘è€å¹´ä»£çš„å¤§å°ï¼Œè¿™ä¼šå¯¼è‡´Major GCæ‰§è¡Œçš„æ›´é¢‘ç¹ï¼Œè€ŒMajor GCå¯èƒ½ä¼šé€ æˆç”¨æˆ·çº¿ç¨‹çš„åœé¡¿ä»è€Œé™ä½ç³»ç»Ÿååé‡ã€‚JVMä¸­å¯ä»¥ç”¨NewSizeå’ŒMaxNewSizeå‚æ•°æ¥æŒ‡å®šæ–°ç”Ÿä»£å†…å­˜æœ€å°å’Œæœ€å¤§å€¼ï¼Œå¦‚æœä¸¤ä¸ªå‚æ•°å€¼ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºå›ºå®šäº†æ–°ç”Ÿä»£çš„å¤§å°<br><img src="/images/jvm-parameter.png" alt="jvmå‚æ•°"></p><h2 id="Full-GCå’Œå¹¶å‘åƒåœ¾å›æ”¶"><a href="#Full-GCå’Œå¹¶å‘åƒåœ¾å›æ”¶" class="headerlink" title="Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶"></a>Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶</h2><p>å¹¶å‘åƒåœ¾å›æ”¶å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¹¶å‘åƒåœ¾å›æ”¶å™¨å¯ä»¥åœ¨ç”¨æˆ·çº¿ç¨‹è¿è¡Œçš„æƒ…å†µä¸‹å®Œæˆå¤§éƒ¨åˆ†çš„å›æ”¶å·¥ä½œï¼Œæ‰€ä»¥åº”ç”¨åœé¡¿æ—¶é—´å¾ˆçŸ­ã€‚</p><p>ä½†ç”±äºå¹¶å‘åƒåœ¾å›æ”¶æ—¶ç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œï¼Œæ‰€ä»¥ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿã€‚ä½œä¸ºæ‹…ä¿ï¼Œå¦‚æœåœ¨è€å¹´ä»£å†…å­˜éƒ½è¢«å ç”¨ä¹‹å‰ï¼Œå¦‚æœå¹¶å‘åƒåœ¾å›æ”¶å™¨è¿˜æ²¡ç»“æŸå·¥ä½œï¼Œé‚£ä¹ˆåº”ç”¨ä¼šæš‚åœï¼Œåœ¨æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹åœæ­¢çš„æƒ…å†µä¸‹å®Œæˆå›æ”¶ã€‚è¿™ç§æƒ…å†µç§°ä½œFull GCï¼Œè¿™æ„å‘³ç€éœ€è¦è°ƒæ•´æœ‰å…³å¹¶å‘å›æ”¶çš„å‚æ•°äº†ã€‚</p><p>ç”±äºFull GCå¾ˆå½±å“åº”ç”¨çš„æ€§èƒ½ï¼Œè¦å°½é‡é¿å…æˆ–å‡å°‘ã€‚ç‰¹åˆ«æ˜¯å¦‚æœå¯¹äºé«˜å®¹é‡ä½å»¶è¿Ÿçš„ç”µå•†ç³»ç»Ÿï¼Œè¦å°½é‡é¿å…åœ¨äº¤æ˜“æ—¶é—´æ®µå‘ç”ŸFull GCã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>ä¸ºäº†åˆ†ä»£åƒåœ¾å›æ”¶ï¼ŒJavaå †å†…å­˜åˆ†ä¸º3ä»£ï¼šæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£ã€‚</li><li>æ–°çš„å¯¹è±¡å®ä¾‹ä¼šä¼˜å…ˆåˆ†é…åœ¨æ–°ç”Ÿä»£ï¼Œåœ¨ç»å†å‡ æ¬¡Minor GCå(é»˜è®¤15æ¬¡)ï¼Œè¿˜å­˜æ´»çš„ä¼šè¢«ç§»è‡³è€å¹´ä»£(æŸäº›å¤§å¯¹è±¡ä¼šç›´æ¥åœ¨è€å¹´ä»£åˆ†é…)ã€‚</li><li>æ°¸ä¹…ä»£æ˜¯å¦æ‰§è¡ŒGCï¼Œå–å†³äºé‡‡ç”¨çš„JVMã€‚</li><li>Minor GCå‘ç”Ÿåœ¨æ–°ç”Ÿä»£ï¼Œå½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶ï¼Œä¼šå‘èµ·ä¸€æ¬¡Minor GCï¼Œå°†EdenåŒºä¸­çš„å­˜æ´»å¯¹è±¡ç§»è‡³SurvivoråŒºã€‚Major GCå‘ç”Ÿåœ¨è€å¹´ä»£ï¼Œå½“å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¤§äºè€å¹´ä»£å‰©ä½™ç©ºé—´æ—¶ä¼šå‘ç”ŸMajor GCã€‚</li><li>å‘ç”ŸMajor GCæ—¶ç”¨æˆ·çº¿ç¨‹ä¼šæš‚åœï¼Œä¼šé™ä½ç³»ç»Ÿæ€§èƒ½å’Œååé‡ã€‚</li><li>JVMçš„å‚æ•°-Xmxå’Œ-Xmsç”¨æ¥è®¾ç½®Javaå †å†…å­˜çš„åˆå§‹å¤§å°å’Œæœ€å¤§å€¼ã€‚ä¾æ®ä¸ªäººç»éªŒè¿™ä¸ªå€¼çš„æ¯”ä¾‹æœ€å¥½æ˜¯1:1æˆ–è€…1:1.5ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥å°†-Xmxå’Œ-Xmséƒ½è®¾ä¸º1GBï¼Œæˆ–è€…-Xmxå’Œ-Xmsè®¾ä¸º1.2GBå’Œ1.8GBã€‚</li><li>Javaä¸­ä¸èƒ½æ‰‹åŠ¨è§¦å‘GCï¼Œä½†å¯ä»¥ç”¨ä¸åŒçš„å¼•ç”¨ç±»æ¥è¾…åŠ©åƒåœ¾å›æ”¶å™¨å·¥ä½œ(æ¯”å¦‚ï¼šå¼±å¼•ç”¨æˆ–è½¯å¼•ç”¨)ã€‚</li></ul><p>ä»¥ä¸Šå°±æ˜¯å…³äºJavaä¸­GCçš„ä¸€äº›å†…å®¹ã€‚é€šè¿‡è¿™ç¯‡åšå®¢ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼›ä¸€ä¸ªå¯¹è±¡åœ¨æ²¡æœ‰ä»»ä½•å¼ºå¼•ç”¨æŒ‡å‘ä»–æˆ–è¯¥å¯¹è±¡é€šè¿‡æ ¹èŠ‚ç‚¹ä¸å¯è¾¾æ—¶éœ€è¦è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼›å½“åƒåœ¾æ”¶é›†å™¨æ„è¯†åˆ°éœ€è¦è¿›è¡ŒGCæ—¶ä¼šè§¦å‘Minor GCæˆ–Major GCï¼Œæ˜¯è‡ªåŠ¨çš„ï¼Œæ— æ³•å¼ºåˆ¶æ‰§è¡Œã€‚</p><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://yemengying.com/2016/05/13/jvm-GC/" target="_blank" rel="noopener">ã€è¯‘ã€‘Javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶ </a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å…³é”®å­—çº¦å®š&quot;&gt;&lt;a href=&quot;#å…³é”®å­—çº¦å®š&quot; class=&quot;headerlink&quot; title=&quot;å…³é”®å­—çº¦å®š&quot;&gt;&lt;/a&gt;å…³é”®å­—çº¦å®š&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Young generation â€“&amp;gt;æ–°ç”Ÿä»£&lt;/li&gt;
&lt;li&gt;Tenured / Old Generation â€“&amp;gt;è€å¹´ä»£&lt;/li&gt;
&lt;li&gt;Perm Area â€“&amp;gt;æ°¸ä¹…ä»£&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;é‡è¦çš„ä¸œä¸œ&quot;&gt;&lt;a href=&quot;#é‡è¦çš„ä¸œä¸œ&quot; class=&quot;headerlink&quot; title=&quot;é‡è¦çš„ä¸œä¸œ&quot;&gt;&lt;/a&gt;é‡è¦çš„ä¸œä¸œ&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;åœ¨Javaä¸­ï¼Œå¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸€äº›ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ç­‰å­˜å‚¨åœ¨æ–¹æ³•åŒºã€‚å †å’Œæ–¹æ³•åŒºéƒ½æ˜¯çº¿ç¨‹å…±äº«çš„ã€‚&lt;/li&gt;
&lt;li&gt;GCæœºåˆ¶æ˜¯ç”±JVMæä¾›ï¼Œç”¨æ¥æ¸…ç†éœ€è¦æ¸…é™¤çš„å¯¹è±¡ï¼Œå›æ”¶å †å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;GCæœºåˆ¶å°†Javaç¨‹åºå‘˜ä»å†…å­˜ç®¡ç†ä¸­è§£æ”¾äº†å‡ºæ¥ï¼Œå¯ä»¥æ›´å…³æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨Javaä¸­ï¼ŒGCæ˜¯ç”±ä¸€ä¸ªè¢«ç§°ä¸ºåƒåœ¾å›æ”¶å™¨çš„å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œçš„ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä»å†…å­˜å›æ”¶ä¸€ä¸ªå¯¹è±¡ä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„finalize()æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;ä½œä¸ºä¸€ä¸ªJavaå¼€å‘è€…ä¸èƒ½å¼ºåˆ¶JVMæ‰§è¡ŒGCï¼›GCçš„è§¦å‘ç”±JVMä¾æ®å †å†…å­˜çš„å¤§å°æ¥å†³å®šã€‚&lt;/li&gt;
&lt;li&gt;System.gc()å’ŒRuntime.gc()ä¼šå‘JVMå‘é€æ‰§è¡ŒGCçš„è¯·æ±‚ï¼Œä½†æ˜¯JVMä¸ä¿è¯ä¸€å®šä¼šæ‰§è¡ŒGCã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå †æ²¡æœ‰å†…å­˜åˆ›å»ºæ–°çš„å¯¹è±¡äº†ï¼Œä¼šæŠ›å‡º&lt;code&gt;OutOfMemoryError&lt;/code&gt;ã€‚
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
      <category term="JVM" scheme="https://hsb786.github.io/tags/JVM/"/>
    
  </entry>
  
  <entry>
    <title>Executor, ExecutorService å’Œ Executors é—´çš„ä¸åŒ ï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/13/difference-between-executor-executorService/"/>
    <id>https://hsb786.github.io/2018/04/13/difference-between-executor-executorService/</id>
    <published>2018-04-13T05:21:41.000Z</published>
    <updated>2018-04-13T05:59:24.142Z</updated>
    
    <content type="html"><![CDATA[<p>java.util.concurrent.Executor, java.util.concurrent.ExecutorService, java.util.concurrent. Executors è¿™ä¸‰è€…å‡æ˜¯ Java Executor æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ± çš„åŠŸèƒ½ã€‚å› ä¸ºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹éå¸¸å¿ƒç´¯ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿé€šå¸¸å¯¹çº¿ç¨‹æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨çº¿ç¨‹æ± ä¸ä»…å¯ä»¥æé«˜åº”ç”¨çš„å“åº”æ—¶é—´ï¼Œè¿˜å¯ä»¥é¿å…â€java.lang.OutOfMemoryError: unable to create new native threadâ€ ä¹‹ç±»çš„é”™è¯¯ã€‚<br><a id="more"></a><br>åœ¨ Java 1.5 æ—¶ï¼Œå¼€å‘è€…éœ€è¦å…³å¿ƒçº¿ç¨‹æ± çš„åˆ›å»ºå’Œç®¡ç†ï¼Œä½†åœ¨ Java 1.5 ä¹‹å Executor æ¡†æ¶æä¾›äº†å¤šç§å†…ç½®çš„çº¿ç¨‹æ± ,ä¾‹å¦‚ï¼šFixedThreadPool(åŒ…å«å›ºå®šæ•°ç›®çš„çº¿ç¨‹)ï¼ŒCachedThreadPool(å¯æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹)ç­‰ç­‰ã€‚</p><h2 id="Executor"><a href="#Executor" class="headerlink" title="Executor"></a>Executor</h2><p>Executor, ExecutorService, å’Œ Executors æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯ Executor æ˜¯ä¸€ä¸ªæŠ½è±¡å±‚é¢çš„æ ¸å¿ƒæ¥å£(å¤§è‡´ä»£ç å¦‚ä¸‹)ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface Executor &#123;</span><br><span class="line">    void execute(Runnable command);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸åŒäº java.lang.Thread ç±»å°†ä»»åŠ¡å’Œæ‰§è¡Œè€¦åˆåœ¨ä¸€èµ·ï¼Œ Executor å°†ä»»åŠ¡æœ¬èº«å’Œæ‰§è¡Œä»»åŠ¡åˆ†ç¦»ï¼Œå¯ä»¥é˜…è¯» difference between Thread and Executor æ¥äº†è§£ Thread å’Œ Executor é—´æ›´å¤šçš„ä¸åŒã€‚</p><h2 id="ExecutorService"><a href="#ExecutorService" class="headerlink" title="ExecutorService"></a>ExecutorService</h2><p>ExecutorService æ¥å£ å¯¹ Executor æ¥å£è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†è¿”å› Future å¯¹è±¡ï¼Œç»ˆæ­¢ï¼Œå…³é—­çº¿ç¨‹æ± ç­‰æ–¹æ³•ã€‚å½“è°ƒç”¨ shutDown æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåœæ­¢æ¥å—æ–°çš„ä»»åŠ¡ï¼Œä½†ä¼šå®Œæˆæ­£åœ¨ pending ä¸­çš„ä»»åŠ¡ã€‚</p><p>Future å¯¹è±¡æä¾›äº†å¼‚æ­¥æ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ— éœ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œçš„å®Œæˆï¼Œåªè¦æäº¤éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶ååœ¨éœ€è¦æ—¶æ£€æŸ¥ Future æ˜¯å¦å·²ç»æœ‰äº†ç»“æœï¼Œå¦‚æœä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡ Future.get() æ–¹æ³•è·å¾—æ‰§è¡Œç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒFuture.get() æ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡å¼çš„æ–¹æ³•ï¼Œå¦‚æœè°ƒç”¨æ—¶ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œä¼šç­‰å¾…ç›´åˆ°ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚</p><p>é€šè¿‡ ExecutorService.submit() æ–¹æ³•è¿”å›çš„ Future å¯¹è±¡ï¼Œè¿˜å¯ä»¥å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œã€‚Future æä¾›äº† cancel() æ–¹æ³•ç”¨æ¥å–æ¶ˆæ‰§è¡Œ pending ä¸­çš„ä»»åŠ¡ã€‚</p><p>ExecutorService éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface ExecutorService extends Executor &#123;</span><br><span class="line">void shutdown();</span><br><span class="line">&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task);</span><br><span class="line">&lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result);</span><br><span class="line">&lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Executors"><a href="#Executors" class="headerlink" title="Executors"></a>Executors</h2><p>Executors æ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œç±»ä¼¼äº Collectionsã€‚æä¾›å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ï¼Œæ¯”å¦‚ FixedThreadPool æˆ– CachedThreadPoolã€‚</p><p>Executors éƒ¨åˆ†ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class Executors &#123;</span><br><span class="line">    public static ExecutorService newFixedThreadPool(int nThreads) &#123;</span><br><span class="line">        return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS,new LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">     public static ExecutorService newCachedThreadPool() &#123;</span><br><span class="line">        return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¯¦ç»†çœ‹ä¸€ä¸‹ä¸‰è€…çš„åŒºåˆ«ï¼š</p><h2 id="Executor-vs-ExecutorService-vs-Executors"><a href="#Executor-vs-ExecutorService-vs-Executors" class="headerlink" title="Executor vs ExecutorService vs Executors"></a>Executor vs ExecutorService vs Executors</h2><p>æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œè¿™ä¸‰è€…å‡æ˜¯ Executor æ¡†æ¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚Java å¼€å‘è€…å¾ˆæœ‰å¿…è¦å­¦ä¹ å’Œç†è§£ä»–ä»¬ï¼Œä»¥ä¾¿æ›´é«˜æ•ˆçš„ä½¿ç”¨ Java æä¾›çš„ä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ€»ç»“ä¸€ä¸‹è¿™ä¸‰è€…é—´çš„åŒºåˆ«ï¼Œä»¥ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£ï¼š</p><ul><li>Executor å’Œ ExecutorService è¿™ä¸¤ä¸ªæ¥å£ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼šExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£ï¼Œæ˜¯ Executor çš„å­æ¥å£</li><li>Executor å’Œ ExecutorService ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ï¼šExecutor æ¥å£å®šä¹‰äº† execute()æ–¹æ³•ç”¨æ¥æ¥æ”¶ä¸€ä¸ªRunnableæ¥å£çš„å¯¹è±¡ï¼Œè€Œ ExecutorService æ¥å£ä¸­çš„ submit()æ–¹æ³•å¯ä»¥æ¥å—Runnableå’ŒCallableæ¥å£çš„å¯¹è±¡ã€‚</li><li>Executor å’Œ ExecutorService æ¥å£ç¬¬ä¸‰ä¸ªåŒºåˆ«æ˜¯ Executor ä¸­çš„ execute() æ–¹æ³•ä¸è¿”å›ä»»ä½•ç»“æœï¼Œè€Œ ExecutorService ä¸­çš„ submit()æ–¹æ³•å¯ä»¥é€šè¿‡ä¸€ä¸ª Future å¯¹è±¡è¿”å›è¿ç®—ç»“æœã€‚</li><li>Executor å’Œ ExecutorService æ¥å£ç¬¬å››ä¸ªåŒºåˆ«æ˜¯é™¤äº†å…è®¸å®¢æˆ·ç«¯æäº¤ä¸€ä¸ªä»»åŠ¡ï¼ŒExecutorService è¿˜æä¾›ç”¨æ¥æ§åˆ¶çº¿ç¨‹æ± çš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼šè°ƒç”¨ shutDown() æ–¹æ³•ç»ˆæ­¢çº¿ç¨‹æ± ã€‚å¯ä»¥é€šè¿‡ ã€ŠJava Concurrency in Practiceã€‹ ä¸€ä¹¦äº†è§£æ›´å¤šå…³äºå…³é—­çº¿ç¨‹æ± å’Œå¦‚ä½•å¤„ç† pending çš„ä»»åŠ¡çš„çŸ¥è¯†ã€‚</li><li>Executors ç±»æä¾›å·¥å‚æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ¯”å¦‚: newSingleThreadExecutor() åˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼ŒnewFixedThreadPool(int numOfThreads)æ¥åˆ›å»ºå›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼ŒnewCachedThreadPool()å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œä½†å¦‚æœå·²æœ‰çº¿ç¨‹æ˜¯ç©ºé—²çš„ä¼šé‡ç”¨å·²æœ‰çº¿ç¨‹ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸‹è¡¨åˆ—å‡ºäº† Executor å’Œ ExecutorService çš„åŒºåˆ«ï¼š</p><table><thead><tr><th>Executor</th><th>ExecutorService</th></tr></thead><tbody><tr><td>Executor æ˜¯ Java çº¿ç¨‹æ± çš„æ ¸å¿ƒæ¥å£ï¼Œç”¨æ¥å¹¶å‘æ‰§è¡Œæäº¤çš„ä»»åŠ¡</td><td>ExecutorService æ˜¯ Executor æ¥å£çš„æ‰©å±•ï¼Œæä¾›äº†å¼‚æ­¥æ‰§è¡Œå’Œå…³é—­çº¿ç¨‹æ± çš„æ–¹æ³•</td></tr><tr><td>æä¾›execute()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡</td><td>æä¾›submit()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡</td></tr><tr><td>execute()æ–¹æ³•æ— è¿”å›å€¼</td><td>submit()æ–¹æ³•è¿”å›Futureå¯¹è±¡ï¼Œå¯ç”¨æ¥è·å–ä»»åŠ¡æ‰§è¡Œç»“æœ</td></tr><tr><td>ä¸èƒ½å–æ¶ˆä»»åŠ¡</td><td>å¯ä»¥é€šè¿‡Future.cancel()å–æ¶ˆpendingä¸­çš„ä»»åŠ¡</td></tr><tr><td>æ²¡æœ‰æä¾›å’Œå…³é—­çº¿ç¨‹æ± æœ‰å…³çš„æ–¹æ³•</td><td>æä¾›äº†å…³é—­çº¿ç¨‹æ± çš„æ–¹æ³•</td></tr></tbody></table><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://yemengying.com/2017/03/17/difference-between-executor-executorService/" target="_blank" rel="noopener">ã€è¯‘ã€‘Executor, ExecutorService å’Œ Executors é—´çš„ä¸åŒ </a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;java.util.concurrent.Executor, java.util.concurrent.ExecutorService, java.util.concurrent. Executors è¿™ä¸‰è€…å‡æ˜¯ Java Executor æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ± çš„åŠŸèƒ½ã€‚å› ä¸ºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹éå¸¸å¿ƒç´¯ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿé€šå¸¸å¯¹çº¿ç¨‹æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨çº¿ç¨‹æ± ä¸ä»…å¯ä»¥æé«˜åº”ç”¨çš„å“åº”æ—¶é—´ï¼Œè¿˜å¯ä»¥é¿å…â€java.lang.OutOfMemoryError: unable to create new native threadâ€ ä¹‹ç±»çš„é”™è¯¯ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
      <category term="å¤šçº¿ç¨‹" scheme="https://hsb786.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>vscode-database</title>
    <link href="https://hsb786.github.io/2018/04/13/vscode-database/"/>
    <id>https://hsb786.github.io/2018/04/13/vscode-database/</id>
    <published>2018-04-13T03:55:59.000Z</published>
    <updated>2018-04-13T04:23:59.089Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„vscodeæ’ä»¶, vscode-database</strong></p><p>è¿·ä¸Šäº†vscode</p><p><img src="/images/vscode-database.png" alt=""><br><a id="more"></a><br><img src="/images/vscode_mysql.png" alt=""></p><p><strong>å¿«æ·é”®</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>è¯­ä¹‰</th></tr></thead><tbody><tr><td>ctrl q</td><td>querySQL</td></tr><tr><td>ctrl shift e</td><td>Run selected text as SQL query    </td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„vscodeæ’ä»¶, vscode-database&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿·ä¸Šäº†vscode&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/vscode-database.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="å·¥å…·" scheme="https://hsb786.github.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>è§¦å‘å™¨</title>
    <link href="https://hsb786.github.io/2018/04/13/%E8%A7%A6%E5%8F%91%E5%99%A8/"/>
    <id>https://hsb786.github.io/2018/04/13/è§¦å‘å™¨/</id>
    <published>2018-04-13T03:43:11.000Z</published>
    <updated>2018-04-13T04:38:27.314Z</updated>
    
    <content type="html"><![CDATA[<p>å¯¹æŸä¸€ä¸ªè¡¨çš„æŸç§æ“ä½œï¼Œè§¦å‘æŸç§æ¡ä»¶ï¼Œä»è€Œæ‰§è¡Œçš„ä¸€æ®µç¨‹åº</p><p>new: æ–°æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæ²¡æœ‰ï¼Œå°†è¦æœ‰çš„æ•°æ®ã€‚ä¾‹å¦‚å°†è¦æ›´æ–°çš„æ•°æ®æˆ–è€…æ˜¯æ–°å¢çš„æ•°æ®ã€‚</p><p>oldï¼šæ—§æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæœ‰çš„æ•°æ®<br><a id="more"></a></p><p>è¯´æ˜ï¼šåœ¨æŠŠuserjob(ç”¨æˆ·å²—ä½å…³è”è¡¨)ä¸­çš„success(å®¡æ‰¹çŠ¶æ€)æ›´æ–°ä¸ºtrueæ—¶ï¼Œè‡ªåŠ¨åœ¨æˆç»©è¡¨ä¸­å‡ºå…¥æ•°æ®ï¼›å¦åˆ™è¯´æ˜æ²¡æœ‰å®¡æ‰¹æ²¡æœ‰é€šè¿‡ï¼ŒæŠŠæˆç»©è¡¨ä¸­å¯¹åº”çš„æ•°æ®åˆ é™¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER `insertScore` AFTER UPDATE ON `userjob` FOR EACH ROW if new.success=true then</span><br><span class="line">insert into score(id) values(new.id);</span><br><span class="line">else delete from score where id=new.id;</span><br><span class="line">end if</span><br></pre></td></tr></table></figure></p><p>è¯´æ˜ï¼šåœ¨åˆ é™¤userjob(ç”¨æˆ·å²—ä½å…³è”è¡¨)çš„æ•°æ®æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æˆç»©è¡¨å¯¹åº”ä¸­çš„æ•°æ®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER `deleteScore` BEFORE DELETE ON `userjob` FOR EACH ROW if old.success=true then</span><br><span class="line">delete from score where id=old.id;</span><br><span class="line">end if</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯¹æŸä¸€ä¸ªè¡¨çš„æŸç§æ“ä½œï¼Œè§¦å‘æŸç§æ¡ä»¶ï¼Œä»è€Œæ‰§è¡Œçš„ä¸€æ®µç¨‹åº&lt;/p&gt;
&lt;p&gt;new: æ–°æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæ²¡æœ‰ï¼Œå°†è¦æœ‰çš„æ•°æ®ã€‚ä¾‹å¦‚å°†è¦æ›´æ–°çš„æ•°æ®æˆ–è€…æ˜¯æ–°å¢çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;oldï¼šæ—§æ•°æ®ï¼Œæ•°æ®åº“é‡ŒåŸå…ˆæœ‰çš„æ•°æ®&lt;br&gt;
    
    </summary>
    
    
      <category term="sql" scheme="https://hsb786.github.io/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>sql</title>
    <link href="https://hsb786.github.io/2018/04/12/sql/"/>
    <id>https://hsb786.github.io/2018/04/12/sql/</id>
    <published>2018-04-12T12:56:19.000Z</published>
    <updated>2018-04-12T13:27:14.338Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h2><p>ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„</p><p>æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„</p><p>åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå¿«é€Ÿå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚<br><a id="more"></a></p><h3 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h3><ul><li>æé«˜æ•°æ®æ£€ç´¢æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬</li><li>é€šè¿‡ç´¢å¼•å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½äº†æ¶ˆè€—</li></ul><h3 id="åŠ£åŠ¿"><a href="#åŠ£åŠ¿" class="headerlink" title="åŠ£åŠ¿"></a>åŠ£åŠ¿</h3><ul><li>å®é™…ä¸Šç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“è¡¨çš„è®°å½•ï¼Œç´¢å¼•åˆ—ä¹Ÿæ˜¯è¦å ç©ºé—´çš„</li><li>è™½ç„¶ç´¢å¼•åˆ—å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ã€‚å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶æ¯æ¬¡æ›´æ–°æ·»åŠ äº†ç´¢å¼•åˆ—çš„å­—æ®µ</li></ul><h3 id="å“ªäº›æƒ…å†µéœ€è¦åˆ›å»ºç´¢å¼•"><a href="#å“ªäº›æƒ…å†µéœ€è¦åˆ›å»ºç´¢å¼•" class="headerlink" title="å“ªäº›æƒ…å†µéœ€è¦åˆ›å»ºç´¢å¼•"></a>å“ªäº›æƒ…å†µéœ€è¦åˆ›å»ºç´¢å¼•</h3><ul><li>ä¸»é”®è‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼•            ï¼ˆä¸éœ€è¦è‡ªå·±å»ºï¼‰</li><li>é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼•</li><li>æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œå¤–é”®å…³ç³»å»ºç«‹ç´¢å¼•    ï¼ˆè‡ªåŠ¨å»ºç«‹ï¼‰</li><li>æŸ¥è¯¢ä¸­æ’åºçš„å­—æ®µï¼Œæ’åºçš„å­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦</li><li>æŸ¥è¯¢ä¸­ç»Ÿè®¡æˆ–è€…åˆ†ç»„çš„å­—æ®µ</li></ul><h3 id="å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•"><a href="#å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•" class="headerlink" title="å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•"></a>å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•</h3><ul><li>è¡¨è®°å½•å¤ªå°</li><li>ç»å¸¸å¢åˆ æ”¹çš„è¡¨</li><li>æŸä¸ªæ•°æ®åˆ—åŒ…å«è®¸å¤šé‡å¤çš„å†…å®¹ï¼Œä¸ºå®ƒå»ºç«‹ç´¢å¼•å°±æ²¡æœ‰å¤ªå¤§çš„å®é™…æ•ˆæœ</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç´¢å¼•&quot;&gt;&lt;a href=&quot;#ç´¢å¼•&quot; class=&quot;headerlink&quot; title=&quot;ç´¢å¼•&quot;&gt;&lt;/a&gt;ç´¢å¼•&lt;/h2&gt;&lt;p&gt;ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„&lt;/p&gt;
&lt;p&gt;æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„&lt;/p&gt;
&lt;p&gt;åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå¿«é€Ÿå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="sql" scheme="https://hsb786.github.io/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>Javaè™šæ‹Ÿæœº</title>
    <link href="https://hsb786.github.io/2018/04/12/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    <id>https://hsb786.github.io/2018/04/12/Javaè™šæ‹Ÿæœº/</id>
    <published>2018-04-12T12:01:50.000Z</published>
    <updated>2018-04-12T12:18:28.268Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å†…å­˜åŒºåŸŸ"><a href="#å†…å­˜åŒºåŸŸ" class="headerlink" title="å†…å­˜åŒºåŸŸ"></a>å†…å­˜åŒºåŸŸ</h2><p>Javaè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠä»–æ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚Javaè™šæ‹Ÿæœºè§„èŒƒå°†JVMæ‰€ç®¡ç†çš„å†…å­˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿è¡Œæ—¶æ•°æ®åŒºï¼šç¨‹åºè®¡æ•°å™¨ã€Javaè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€Javaå †ã€æ–¹æ³•åŒºã€‚ä¸‹é¢è¯¦ç»†é˜è¿°å„æ•°æ®åŒºæ‰€å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚<br><a id="more"></a><br><img src="/images/javaè™šæ‹Ÿæœº.png" alt=""></p><h3 id="ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰"><a href="#ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰" class="headerlink" title="ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰"></a>ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰</h3><p>ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶é€šè¿‡æ”¹å˜è¯¥è®¡æ•°å™¨çš„å€¼æ¥é€‰æ‹©ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€è·³è½¬ã€å¾ªç¯ç­‰åŸºç¡€åŠŸèƒ½éƒ½è¦ä¾èµ–å®ƒæ¥å®ç°ã€‚æ¯æ¡çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„çº¿ç¨‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œå› æ­¤è¯¥åŒºåŸŸæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚</p><p>å½“çº¿ç¨‹åœ¨æ‰§è¡Œä¸€ä¸ªJavaæ–¹æ³•æ—¶ï¼Œè¯¥è®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œå½“çº¿ç¨‹åœ¨æ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•ï¼ˆè°ƒç”¨æœ¬åœ°æ“ä½œç³»ç»Ÿæ–¹æ³•ï¼‰æ—¶ï¼Œè¯¥è®¡æ•°å™¨çš„å€¼ä¸ºç©ºã€‚å¦å¤–ï¼Œè¯¥å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OOMï¼ˆå†…å­˜æº¢å‡ºï¼šOutOfMemoryErrorï¼‰æƒ…å†µçš„åŒºåŸŸã€‚</p><h3 id="Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava-Virtual-Machine-Stacksï¼‰"><a href="#Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava-Virtual-Machine-Stacksï¼‰" class="headerlink" title="Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰"></a>Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰</h3><p>è¯¥åŒºåŸŸä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸çº¿ç¨‹ç›¸åŒã€‚è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œæ ˆå®ƒæ˜¯ç”¨äºæ”¯æŒç»­è™šæ‹Ÿæœºè¿›è¡Œæ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œçš„æ•°æ®ç»“æ„ã€‚å¯¹äºæ‰§è¡Œå¼•æ“æ¥è®²ï¼Œæ´»åŠ¨çº¿ç¨‹ä¸­ï¼Œåªæœ‰æ ˆé¡¶çš„æ ˆå¸§æ˜¯æœ‰æ•ˆçš„ï¼Œç§°ä¸ºå½“å‰æ ˆå¸§ï¼Œè¿™ä¸ªæ ˆå¸§æ‰€å…³è”çš„æ–¹æ³•ç§°ä¸ºå½“å‰æ–¹æ³•ï¼Œæ‰§è¡Œå¼•æ“æ‰€è¿è¡Œçš„æ‰€æœ‰å­—èŠ‚ç æŒ‡ä»¤éƒ½åªé’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œã€‚æ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•è¿”å›åœ°å€å’Œä¸€äº›é¢å¤–çš„é™„åŠ ä¿¡æ¯ã€‚åœ¨ç¼–è¯‘ç¨‹åºä»£ç æ—¶ï¼Œæ ˆå¸§ä¸­éœ€è¦å¤šå¤§çš„å±€éƒ¨å˜é‡è¡¨ã€å¤šæ·±çš„æ“ä½œæ•°æ ˆéƒ½å·²ç»å®Œå…¨ç¡®å®šäº†ï¼Œå¹¶ä¸”å†™å…¥äº†æ–¹æ³•è¡¨çš„Codeå±æ€§ä¹‹ä¸­ã€‚å› æ­¤ï¼Œä¸€ä¸ªæ ˆå¸§éœ€è¦åˆ†é…å¤šå°‘å†…å­˜ï¼Œä¸ä¼šå—åˆ°ç¨‹åºè¿è¡ŒæœŸå˜é‡æ•°æ®çš„å½±å“ï¼Œè€Œä»…ä»…å–å†³äºå…·ä½“çš„è™šæ‹Ÿæœºå®ç°ã€‚</p><p>åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­ï¼Œå¯¹è¿™ä¸ªåŒºåŸŸè§„å®šäº†ä¸¤ç§å¼‚å¸¸æƒ…å†µï¼š</p><ol><li>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚</li><li>å¦‚æœè™šæ‹Ÿæœºåœ¨åŠ¨æ€æ‰©å±•æ ˆæ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ï¼Œåˆ™æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚</li></ol><h3 id="æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stacksï¼‰"><a href="#æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stacksï¼‰" class="headerlink" title="æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰"></a>æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰</h3><p>è¯¥åŒºåŸŸä¸è™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡ŒJavaæ–¹æ³•æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºä½¿ç”¨åˆ°çš„æœ¬åœ°æ“ä½œç³»ç»Ÿï¼ˆNativeï¼‰æ–¹æ³•æœåŠ¡ã€‚</p><h3 id="Javaå †ï¼ˆJava-Heapï¼‰"><a href="#Javaå †ï¼ˆJava-Heapï¼‰" class="headerlink" title="Javaå †ï¼ˆJava Heapï¼‰"></a>Javaå †ï¼ˆJava Heapï¼‰</h3><p>Java Heapæ˜¯Javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œå®ƒæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½åœ¨è¿™ç±»åˆ†é…å†…å­˜ã€‚Java Heapæ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™ä¹Ÿè¢«ç§°ä¸ºâ€œGCå †â€ã€‚</p><p>æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼ŒJavaå †å¯ä»¥å¤„åœ¨ç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ã€‚å¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜å¯åˆ†é…æ—¶ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•æ‰©å±•æ—¶ï¼Œå°†ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚   </p><h3 id="æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰"><a href="#æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰" class="headerlink" title="æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰"></a>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</h3><p>æ–¹æ³•åŒºä¹Ÿæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚æ–¹æ³•åŒºåŸŸåˆè¢«ç§°ä¸ºâ€œæ°¸ä¹…ä»£â€ã€‚</p><p>æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼Œå½“æ–¹æ³•åŒºæ— æ³•æ»¡è¶³å†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œå°†æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚</p><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://blog.csdn.net/ns_code/article/details/17565503" target="_blank" rel="noopener">ã€æ·±å…¥Javaè™šæ‹Ÿæœºã€‘ä¹‹ä¸€ï¼šJavaå†…å­˜åŒºåŸŸä¸å†…å­˜æº¢å‡º</a></p><p><a href="https://yemengying.com/2015/11/12/è¯»ä¹¦ç¬”è®°-æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1/" target="_blank" rel="noopener">è¯»ä¹¦ç¬”è®°-æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å†…å­˜åŒºåŸŸ&quot;&gt;&lt;a href=&quot;#å†…å­˜åŒºåŸŸ&quot; class=&quot;headerlink&quot; title=&quot;å†…å­˜åŒºåŸŸ&quot;&gt;&lt;/a&gt;å†…å­˜åŒºåŸŸ&lt;/h2&gt;&lt;p&gt;Javaè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠä»–æ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚Javaè™šæ‹Ÿæœºè§„èŒƒå°†JVMæ‰€ç®¡ç†çš„å†…å­˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿è¡Œæ—¶æ•°æ®åŒºï¼šç¨‹åºè®¡æ•°å™¨ã€Javaè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€Javaå †ã€æ–¹æ³•åŒºã€‚ä¸‹é¢è¯¦ç»†é˜è¿°å„æ•°æ®åŒºæ‰€å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/12/java8%E6%96%B0%E7%89%B9%E6%80%A7%EF%BC%88%E8%BD%AC%E8%BD%BD%EF%BC%89/"/>
    <id>https://hsb786.github.io/2018/04/12/java8æ–°ç‰¹æ€§ï¼ˆè½¬è½½ï¼‰/</id>
    <published>2018-04-12T07:56:55.000Z</published>
    <updated>2018-04-13T04:39:49.093Z</updated>
    
    <content type="html"><![CDATA[<p>Java 8å¸¦æ¥äº†å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬Lambda è¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ã€æµ(Stream API)ã€é»˜è®¤æ–¹æ³•ã€Optionalã€ç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹ã€æ–°çš„æ—¶é—´ APIï¼Œç­‰ç­‰å„ä¸ªæ–¹é¢ã€‚<br><img src="/images/java8.jpg" alt=""><br><a id="more"></a></p><h2 id="Default-Methods-for-Interfaces"><a href="#Default-Methods-for-Interfaces" class="headerlink" title="Default Methods for Interfaces"></a>Default Methods for Interfaces</h2><p>Java 8 å…è®¸æˆ‘ä»¬ä½¿ç”¨defaultå…³é”®å­—ï¼Œä¸ºæ¥å£å£°æ˜æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•å®ç°ã€‚è¿™ä¸ªç‰¹æ€§åˆè¢«ç§°ä¸ºæ‰©å±•æ–¹æ³•ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface Formula &#123;</span><br><span class="line">    double calculate(int a);</span><br><span class="line"></span><br><span class="line">    default double sqrt(int a) &#123;</span><br><span class="line">        return Math.sqrt(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ¥å£Formulaä¸­ï¼Œé™¤äº†æŠ½è±¡æ–¹æ³•caculateä»¥å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•sqrt.Formulaçš„å®ç°ç±»åªéœ€è¦å®ç°æŠ½è±¡æ–¹æ³•caculateå°±å¯ä»¥äº†ã€‚é»˜è®¤æ–¹æ³•sqrtå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Formula formula = new Formula() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public double calculate(int a) &#123;</span><br><span class="line">        return sqrt(a * 100);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">formula.calculate(100);     // 100.0</span><br><span class="line">formula.sqrt(16);           // 4.0</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¸ªæ–°ç‰¹å¾æœ‰å•¥ç”¨å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¾€å¾€ä¼šç¢°åˆ°è¿™æ ·ä¸€ä¸ªæƒ…å†µæˆ‘ä»¬å®šä¹‰çš„æ¥å£æ ¹æ®ä¸åŒçš„åœºæ™¯å®šä¹‰äº†å‡ ä¸ªä¸åŒçš„å®ç°ç±»ï¼Œé‚£ä¹ˆå¦‚æœéœ€è¦è¿™å‡ ä¸ªå®ç°ç±»è°ƒç”¨çš„æ–¹æ³•éƒ½å¾—åˆ°åŒä¸€ä¸ªç»“æœæˆ–è€…åªæœ‰ä¸€ä¸ªå®ç°ç±»éœ€è¦è¿™ä¸ªæ¥å£æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å»é‡å†™æ¯ä¸ªå®ç°äº†è¿™ä¸ªæ¥å£çš„ç±»ï¼Œè€Œè¿™å¤§å¤§å¢åŠ äº†æˆ‘ä»¬çš„å®ç°éœ€æ±‚çš„è´Ÿæ‹…ã€‚</p><p>æ­£æ˜¯ä¸ºäº†è§£å†³Javaæ¥å£ä¸­åªèƒ½å®šä¹‰æŠ½è±¡æ–¹æ³•çš„é—®é¢˜ã€‚Java8æ–°å¢åŠ äº†é»˜è®¤æ–¹æ³•çš„ç‰¹æ€§ã€‚é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿æ¥å£é‡å†™æˆæŠ½è±¡æ–¹æ³•æˆ–è€…é‡æ–°å®šä¹‰æˆé»˜è®¤æ–¹æ³•ã€‚é™¤äº†é»˜è®¤æ–¹æ³•ï¼Œæ¥å£é‡Œè¿˜å¯ä»¥å£°æ˜é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥å®ç°ã€‚ä¾‹å­å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private interface DefaulableFactory &#123;</span><br><span class="line">    // Interfaces now allow static methods</span><br><span class="line">    static Defaulable create( Supplier&lt; Defaulable &gt; supplier ) &#123;</span><br><span class="line">        return supplier.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h2 id="Conflict"><a href="#Conflict" class="headerlink" title="Conflict"></a>Conflict</h2><p>å› ä¸ºä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªç±»å®ç°äº†å¤šä¸ªæ¥å£ï¼Œè€Œè¿™äº›æ¥å£ä¸­å­˜åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šæ–¹æ³•ç­¾åç›¸åŒçš„é»˜è®¤æ–¹æ³•æ—¶å°±ä¼šäº§ç”Ÿå†²çªï¼Œjava8å®šä¹‰å¦‚ä¸‹ä¸‰æ¡åŸåˆ™æ¥è§£å†³å†²çªï¼š</p><ol><li>ç±»æˆ–çˆ¶ç±»ä¸­æ˜¾å¼å£°æ˜çš„æ–¹æ³•ï¼Œå…¶ä¼˜å…ˆçº§é«˜äºæ‰€æœ‰çš„é»˜è®¤æ–¹æ³•ï¼›</li><li>å¦‚æœ1è§„åˆ™å¤±æ•ˆï¼Œåˆ™é€‰æ‹©ä¸å½“å‰ç±»è·ç¦»æœ€è¿‘çš„å…·æœ‰å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•ï¼›</li><li>å¦‚æœ2è§„åˆ™ä¹Ÿå¤±æ•ˆï¼Œåˆ™éœ€è¦æ˜¾å¼æŒ‡å®šæ¥å£ã€‚</li></ol><hr><h2 id="Lambda-Expressions"><a href="#Lambda-Expressions" class="headerlink" title="Lambda Expressions"></a>Lambda Expressions</h2><p>Lambdaè¡¨è¾¾å¼ï¼ˆåˆè¢«æˆä¸ºâ€œé—­åŒ…â€æˆ–â€œåŒ¿åæ–¹æ³•â€ï¼‰æ˜¯ç®€æ´åœ°è¡¨ç¤ºå¯ä¼ é€’çš„åŒ¿åå‡½æ•°çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒæä¾›äº†è½»é‡çº§çš„è¯­æ³•</p><p>é‡ç‚¹ç•™æ„è¿™å››ä¸ªå…³é”®è¯ï¼šåŒ¿åã€å‡½æ•°ã€ä¼ é€’ã€ç®€æ´</p><p>Lambdaçš„ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>å‚æ•°åˆ—è¡¨</li><li>ç®­å¤´</li><li>Lambda ä¸»ä½“</li></ul><p>Lambdaçš„åŸºæœ¬è¯­æ³•å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™æ ·å­çš„äº†ï¼š</p><ul><li>(parameters) -&gt; expression</li><li>(parameters) -&gt; { statements; }</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Collections.sort(names, (String a, String b) -&gt; &#123;</span><br><span class="line">    return b.compareTo(a);</span><br><span class="line">&#125;);</span><br><span class="line">æˆ–è€…æ˜¯</span><br><span class="line">Collections.sort(names, (String a, String b) -&gt; b.compareTo(a));</span><br><span class="line">äº¦æˆ–æ˜¯</span><br><span class="line">Collections.sort(names, (a, b) -&gt; b.compareTo(a));</span><br></pre></td></tr></table></figure><hr><h2 id="Lexiacal-Scope"><a href="#Lexiacal-Scope" class="headerlink" title="Lexiacal Scope"></a>Lexiacal Scope</h2><h3 id="è®¿é—®å±€éƒ¨å˜é‡"><a href="#è®¿é—®å±€éƒ¨å˜é‡" class="headerlink" title="è®¿é—®å±€éƒ¨å˜é‡"></a>è®¿é—®å±€éƒ¨å˜é‡</h3><p>å¯ä»¥ç›´æ¥åœ¨Lambdaè¡¨è¾¾å¼ä¸­è®¿é—®å¤–å±‚çš„å±€éƒ¨å˜é‡ï¼Œä½†æ˜¯å’ŒåŒ¿åå¯¹è±¡ä¸åŒçš„æ˜¯ï¼ŒLambdaè¡¨è¾¾å¼çš„å±€éƒ¨å˜é‡å¯ä»¥ä¸ç”¨å£°æ˜ä¸ºfinalï¼Œä¸è¿‡å±€éƒ¨å˜é‡å¿…é¡»ä¸å¯è¢«åé¢çš„ä»£ç ä¿®æ”¹ï¼ˆå³éšæ€§çš„å…·æœ‰finalçš„è¯­ä¹‰ï¼‰ã€‚</p><p>egï¼šä¸‹é¢ä»£ç æ— æ³•ç¼–è¯‘<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int num = 1; </span><br><span class="line">Converter&lt;Integer, String&gt; s =  </span><br><span class="line">(param) -&gt; String.valueOf(param + num);  </span><br><span class="line">num = 5;</span><br></pre></td></tr></table></figure></p><p>åœ¨Lambdaè¡¨è¾¾å¼ä¸­è¯•å›¾ä¿®æ”¹å±€éƒ¨å˜é‡æ˜¯ä¸å…è®¸çš„ï¼</p><ol><li>åœ¨ Lambda è¡¨è¾¾å¼å½“ä¸­è¢«å¼•ç”¨çš„å˜é‡çš„å€¼ä¸å¯ä»¥è¢«æ›´æ”¹ã€‚</li><li>åœ¨ Lambda è¡¨è¾¾å¼å½“ä¸­ä¸å…è®¸å£°æ˜ä¸€ä¸ªä¸å±€éƒ¨å˜é‡åŒåçš„å‚æ•°æˆ–è€…å±€éƒ¨å˜é‡ã€‚</li><li>å’Œå±€éƒ¨å˜é‡ä¸åŒçš„æ˜¯ï¼ŒLambdaå†…éƒ¨å¯¹äºå®ä¾‹çš„å­—æ®µï¼ˆå³ï¼šæˆå‘˜å˜é‡ï¼‰ä»¥åŠé™æ€å˜é‡æ˜¯å³å¯è¯»åˆå¯å†™ã€‚</li></ol><h3 id="ä¸èƒ½è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•"><a href="#ä¸èƒ½è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•" class="headerlink" title="ä¸èƒ½è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•"></a>ä¸èƒ½è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•</h3><p>Lambdaè¡¨è¾¾å¼ä¸­æ˜¯æ— æ³•è®¿é—®åˆ°é»˜è®¤æ–¹æ³•çš„ã€‚</p><p>è¡¥å……ï¼šLambdaè¡¨è¾¾å¼å¯¹å€¼å°é—­ï¼Œå¯¹å˜é‡å¼€æ”¾çš„åŸæ–‡æ˜¯ï¼šlambda expressions close over values, not variablesï¼Œåœ¨è¿™é‡Œå¢åŠ ä¸€ä¸ªä¾‹å­ä»¥è¯´æ˜è¿™ä¸ªç‰¹æ€§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int sum = 0;</span><br><span class="line">list.forEach(e -&gt; &#123; sum += e.size(); &#125;); // Illegal, close over values</span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; aList = new List&lt;&gt;();</span><br><span class="line">list.forEach(e -&gt; &#123; aList.add(e); &#125;); // Legal, open over variables</span><br></pre></td></tr></table></figure><h3 id="åŒ¿åå†…éƒ¨ç±»çš„ç®€å†™ï¼Ÿ"><a href="#åŒ¿åå†…éƒ¨ç±»çš„ç®€å†™ï¼Ÿ" class="headerlink" title="åŒ¿åå†…éƒ¨ç±»çš„ç®€å†™ï¼Ÿ"></a>åŒ¿åå†…éƒ¨ç±»çš„ç®€å†™ï¼Ÿ</h3><p>Lambdaè¡¨è¾¾å¼é€šè¿‡invokedynamicæŒ‡ä»¤å®ç°ï¼Œä¹¦å†™Lambdaè¡¨è¾¾å¼ä¸ä¼šäº§ç”Ÿæ–°çš„ç±»ã€‚å¦‚æœæœ‰å¦‚ä¸‹ä»£ç ï¼Œç¼–è¯‘ä¹‹ååªæœ‰ä¸€ä¸ªclassæ–‡ä»¶</p><h3 id="Lambdaè¡¨è¾¾å¼ä¸­çš„this"><a href="#Lambdaè¡¨è¾¾å¼ä¸­çš„this" class="headerlink" title="Lambdaè¡¨è¾¾å¼ä¸­çš„this"></a>Lambdaè¡¨è¾¾å¼ä¸­çš„this</h3><p>æ—¢ç„¶Lambdaè¡¨è¾¾å¼ä¸æ˜¯å†…éƒ¨ç±»çš„ç®€å†™ï¼Œé‚£ä¹ˆLambdaå†…éƒ¨çš„thiså¼•ç”¨ä¹Ÿå°±è·Ÿå†…éƒ¨ç±»å¯¹è±¡æ²¡ä»€ä¹ˆå…³ç³»äº†ã€‚åœ¨Lambdaè¡¨è¾¾å¼ä¸­thisçš„æ„ä¹‰è·Ÿåœ¨è¡¨è¾¾å¼å¤–éƒ¨å®Œå…¨ä¸€æ ·ã€‚</p><hr><h2 id="Functional-Interfaces"><a href="#Functional-Interfaces" class="headerlink" title="Functional Interfaces"></a>Functional Interfaces</h2><p>ä»»æ„åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨æ¥åšæˆLambdaè¡¨è¾¾å¼ã€‚ä¸ºäº†è®©ä½ å®šä¹‰çš„æ¥å£æ»¡è¶³è¦æ±‚ï¼Œä½ åº”å½“åœ¨æ¥å£å‰åŠ ä¸Š@FunctionalInterface æ ‡æ³¨ã€‚ç¼–è¯‘å™¨ä¼šæ³¨æ„åˆ°è¿™ä¸ªæ ‡æ³¨ï¼Œå¦‚æœä½ çš„æ¥å£ä¸­å®šä¹‰äº†ç¬¬äºŒä¸ªæŠ½è±¡æ–¹æ³•çš„è¯ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@FunctionalInterface</span><br><span class="line">interface Converter&lt;F, T&gt; &#123;</span><br><span class="line">    T convert(F from);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Converter&lt;String, Integer&gt; converter = (from) -&gt; Integer.valueOf(from);</span><br><span class="line">Integer converted = converter.convert(&quot;123&quot;);</span><br><span class="line">System.out.println(converted);    // 123</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œå¦‚æœä½ ä¸å†™@FunctionalInterface æ ‡æ³¨ï¼Œç¨‹åºä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</p><p>ä¸‹é¢æ˜¯Java SE 7ä¸­å·²ç»å­˜åœ¨çš„å‡½æ•°å¼æ¥å£ï¼š</p><ul><li>java.lang.Runnable</li><li>java.util.concurrent.Callable</li><li>java.security.PrivilegedAction</li><li>java.util.Comparator</li><li>java.io.FileFilter</li><li>java.beans.PropertyChangeListener</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼ŒJava SE 8ä¸­å¢åŠ äº†ä¸€ä¸ªæ–°çš„åŒ…ï¼šjava.util.functionï¼Œå®ƒé‡Œé¢åŒ…å«äº†å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚ï¼š</p><ul><li>Predicate<t>â€”â€”æ¥æ”¶Tå¯¹è±¡å¹¶è¿”å›boolean</t></li><li>Consumer<t>â€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œä¸è¿”å›å€¼</t></li><li>Function&lt;T, R&gt;â€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œè¿”å›Rå¯¹è±¡</li><li>Supplier<t>â€”â€”æä¾›Tå¯¹è±¡ï¼ˆä¾‹å¦‚å·¥å‚ï¼‰ï¼Œä¸æ¥æ”¶å€¼</t></li><li>UnaryOperator<t>â€”â€”æ¥æ”¶Tå¯¹è±¡ï¼Œè¿”å›Tå¯¹è±¡</t></li><li>BinaryOperator<t>â€”â€”æ¥æ”¶ä¸¤ä¸ªTå¯¹è±¡ï¼Œè¿”å›Tå¯¹è±¡</t></li></ul><p>é™¤äº†ä¸Šé¢çš„è¿™äº›åŸºæœ¬çš„å‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€äº›é’ˆå¯¹åŸå§‹ç±»å‹ï¼ˆPrimitive typeï¼‰çš„ç‰¹åŒ–ï¼ˆSpecializationï¼‰å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚IntSupplierå’ŒLongBinaryOperatorã€‚ï¼ˆæˆ‘ä»¬åªä¸ºintã€longå’Œdoubleæä¾›äº†ç‰¹åŒ–å‡½æ•°å¼æ¥å£ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å…¶å®ƒåŸå§‹ç±»å‹åˆ™éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢ï¼‰åŒæ ·çš„æˆ‘ä»¬ä¹Ÿæä¾›äº†ä¸€äº›é’ˆå¯¹å¤šä¸ªå‚æ•°çš„å‡½æ•°å¼æ¥å£ï¼Œä¾‹å¦‚BiFunction&lt;T, U, R&gt;ï¼Œå®ƒæ¥æ”¶Tå¯¹è±¡å’ŒUå¯¹è±¡ï¼Œè¿”å›Rå¯¹è±¡ã€‚</p><hr><h2 id="Method-and-Constructor-References"><a href="#Method-and-Constructor-References" class="headerlink" title="Method and Constructor References"></a>Method and Constructor References</h2><p>Lambdaè¡¨è¾¾å¼å…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œå¹¶å…è®¸æˆ‘ä»¬ä»¥å‡½æ•°å¼æ¥å£çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿåœ¨å·²æœ‰çš„æ–¹æ³•ä¸Šå®ç°åŒæ ·çš„ç‰¹æ€§ã€‚</p><p>æ–¹æ³•å¼•ç”¨å’ŒLambdaè¡¨è¾¾å¼æ‹¥æœ‰ç›¸åŒçš„ç‰¹æ€§ï¼ˆä¾‹å¦‚ï¼Œå®ƒä»¬éƒ½éœ€è¦ä¸€ä¸ªç›®æ ‡ç±»å‹ï¼Œå¹¶éœ€è¦è¢«è½¬åŒ–ä¸ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹ï¼‰ï¼Œä¸è¿‡æˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸ºæ–¹æ³•å¼•ç”¨æä¾›æ–¹æ³•ä½“ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ–¹æ³•åç§°å¼•ç”¨å·²æœ‰æ–¹æ³•ã€‚</p><p>æ–¹æ³•å¼•ç”¨å°±æ˜¯æ›¿ä»£é‚£äº›è½¬å‘å‚æ•°çš„ Lambda è¡¨è¾¾å¼çš„è¯­æ³•ç³–ã€‚<br>æ–¹æ³•å¼•ç”¨æœ‰å¾ˆå¤šç§ï¼Œå®ƒä»¬çš„è¯­æ³•å¦‚ä¸‹ï¼š</p><ul><li>é™æ€æ–¹æ³•å¼•ç”¨ï¼šClassName::methodName</li><li>å®é™…ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šinstanceReference::methodName</li><li>è¶…ç±»ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šsuper::methodName</li><li>ç±»å‹ä¸Šçš„å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šClassName::methodName</li><li>æ„é€ æ–¹æ³•å¼•ç”¨ï¼šClass::new</li><li>æ•°ç»„æ„é€ æ–¹æ³•å¼•ç”¨ï¼šTypeName[]::new</li></ul><p>å¯¹äºé™æ€æ–¹æ³•å¼•ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç±»åå’Œæ–¹æ³•åä¹‹é—´åŠ å…¥::åˆ†éš”ç¬¦ï¼Œä¾‹å¦‚Integer::sumã€‚</p><p>ç»“åˆLambdaå¯ä»¥ä½¿æˆ‘ä»¬çš„ä»£ç æ›´åŠ ç®€æ´ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(&quot;a&quot;, &quot;b&quot;);</span><br><span class="line">strings.stream().map(String::toUpperCase).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">List&lt;Character&gt; chars = Arrays.asList(&apos;a&apos;, &apos;b&apos;);System.out.println(chars.stream().map(String::valueOf).collect(Collectors.joining(&quot;,&quot;)));</span><br></pre></td></tr></table></figure><hr><h2 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h2><p>NullPointExceptionå¯ä»¥è¯´æ˜¯æ‰€æœ‰Javaç¨‹åºå‘˜éƒ½é‡åˆ°è¿‡çš„ä¸€ä¸ªå¼‚å¸¸ï¼Œè™½ç„¶Javaä»è®¾è®¡ä¹‹åˆå°±åŠ›å›¾è®©ç¨‹åºå‘˜è„±ç¦»æŒ‡é’ˆçš„è‹¦æµ·ï¼Œä½†æ˜¯æŒ‡é’ˆç¡®å®æ˜¯å®é™…å­˜åœ¨çš„ï¼Œè€Œjavaè®¾è®¡è€…ä¹Ÿåªèƒ½æ˜¯è®©æŒ‡é’ˆåœ¨Javaè¯­è¨€ä¸­å˜å¾—æ›´åŠ ç®€å•ã€æ˜“ç”¨ï¼Œè€Œä¸èƒ½å®Œå…¨çš„å°†å…¶å‰”é™¤ï¼Œæ‰€ä»¥æ‰æœ‰äº†æˆ‘ä»¬æ—¥å¸¸æ‰€è§åˆ°çš„å…³é”®å­—nullã€‚</p><p>ç©ºæŒ‡é’ˆå¼‚å¸¸æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯¹äºè¿™ä¸€ç±»å¼‚å¸¸ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„å¤„ç†ç­–ç•¥ï¼Œé‚£ä¹ˆæœ€ä½³å®è·µåœ¨äºè®©ç¨‹åºæ—©ç‚¹æŒ‚æ‰ï¼Œä½†æ˜¯å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œä¸æ˜¯å¼€å‘äººå‘˜æ²¡æœ‰å…·ä½“çš„å¤„ç†ç­–ç•¥ï¼Œè€Œæ˜¯æ ¹æœ¬æ²¡æœ‰æ„è¯†åˆ°ç©ºæŒ‡é’ˆå¼‚å¸¸çš„å­˜åœ¨ã€‚å½“å¼‚å¸¸çœŸçš„å‘ç”Ÿçš„æ—¶å€™ï¼Œå¤„ç†ç­–ç•¥ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨å­˜åœ¨å¼‚å¸¸çš„åœ°æ–¹æ·»åŠ ä¸€ä¸ªifè¯­å¥åˆ¤å®šå³å¯ï¼Œä½†æ˜¯è¿™æ ·çš„åº”å¯¹ç­–ç•¥ä¼šè®©æˆ‘ä»¬çš„ç¨‹åºå‡ºç°è¶Šæ¥è¶Šå¤šçš„nullåˆ¤å®šï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªè‰¯å¥½çš„ç¨‹åºè®¾è®¡ï¼Œåº”è¯¥è®©ä»£ç ä¸­å°½é‡å°‘å‡ºç°nullå…³é”®å­—ï¼Œè€ŒJava8æ‰€æä¾›çš„Optionalç±»åˆ™åœ¨å‡å°‘NullPointExceptionçš„åŒæ—¶ï¼Œä¹Ÿæå‡äº†ä»£ç çš„ç¾è§‚åº¦ã€‚ä½†é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œå®ƒå¹¶ ä¸æ˜¯å¯¹nullå…³é”®å­—çš„ä¸€ç§æ›¿ä»£ï¼Œè€Œæ˜¯å¯¹äºnullåˆ¤å®šæä¾›äº†ä¸€ç§æ›´åŠ ä¼˜é›…çš„å®ç°ï¼Œä»è€Œé¿å…NullPointExceptionã€‚</p><p>java.util.Optional<t> å¯¹å¯èƒ½ç¼ºå¤±çš„å€¼å»ºæ¨¡,å¼•å…¥çš„ç›®çš„å¹¶éæ˜¯è¦æ¶ˆé™¤æ¯ä¸€ä¸ª null å¼•ç”¨ï¼Œè€Œæ˜¯å¸®åŠ©ä½ æ›´å¥½åœ°è®¾è®¡å‡ºæ™®é€‚çš„ APIã€‚</t></p><p>åˆ›å»º Optional å¯¹è±¡,ä¸‰ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼š</p><ul><li>Optional.emptyï¼šåˆ›å»ºç©ºçš„ Optional å¯¹è±¡</li><li>Optional.ofï¼šä¾æ®éç©ºå€¼åˆ›å»º Optional å¯¹è±¡ï¼Œè‹¥ä¼ ç©ºå€¼ä¼šæŠ› NPE</li><li>Optianal.ofNullableï¼šåˆ›å»º Optional å¯¹è±¡ï¼Œå…è®¸ä¼ ç©ºå€¼</li></ul><p>Optional APIï¼š</p><ul><li>isPresent(): å˜é‡å­˜åœ¨è¿”å›true</li><li>get(): è¿”å›å°è£…çš„å˜é‡å€¼ï¼Œæˆ–è€…æŠ›å‡º NoSuchElementException</li><li>orElse(T other): æä¾›é»˜è®¤å€¼</li><li>orElseGet(Supplier&lt;? extends T&gt; other): orElse æ–¹æ³•çš„å»¶è¿Ÿè°ƒç”¨ç‰ˆ</li><li>orElseThrow(Supplier&lt;&gt; extends X&gt; exceptionSupplier): ç±»ä¼¼ getï¼Œä½†å¯ä»¥å®šåˆ¶å¸Œæœ›æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹</li><li>ifPresent(Consumer&lt;? super T&gt;): å˜é‡å­˜åœ¨æ—¶å¯ä»¥æ‰§è¡Œä¸€ä¸ªæ–¹æ³•</li><li>filter(Predicate&lt;? super T&gt; predicate): è¿‡æ»¤</li><li>map(Function&lt;? super T, ? extends U&gt; mapper): è½¬æ¢</li><li>flatMap(Function&lt;? super T, Optional&lt;U>>mapper): è½¬æ¢æˆOptional</li></ul><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šOptionalæ˜¯ä¸€ä¸ªfinalç±»ï¼Œæœªå®ç°ä»»ä½•æ¥å£ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨åˆ©ç”¨è¯¥ç±»åŒ…è£…å®šä¹‰ç±»çš„å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰çš„ç±»æœ‰åºåˆ—åŒ–çš„éœ€æ±‚ï¼Œé‚£ä¹ˆå› ä¸ºOptionalæ²¡æœ‰å®ç°Serializableæ¥å£ï¼Œè¿™ä¸ªæ—¶å€™æ‰§è¡Œåºåˆ—åŒ–æ“ä½œå°±ä¼šæœ‰é—®é¢˜</p><p>Optional ç±»è®¾è®¡çš„åˆè¡·ä»…ä»…æ˜¯è¦æ”¯æŒèƒ½è¿”å› Optional å¯¹è±¡çš„æ–¹æ³•ï¼Œæ²¡æœ‰è€ƒè™‘å°†å®ƒä½œä¸ºç±»çš„å­—æ®µä½¿ç”¨â€¦</p><p>å¦å¤–ï¼Œåœ¨Java9ä¸­å¯¹Optionalæ·»åŠ äº†ä¸‰ä¸ªæ–°çš„æ–¹æ³•ï¼š</p><ol><li><p>public Optional<t> or(Supplier&lt;? extends Optional&lt;? extends T&gt;&gt; supplier)<br>or æ–¹æ³•çš„ä½œç”¨æ˜¯ï¼Œå¦‚æœä¸€ä¸ª Optional åŒ…å«å€¼ï¼Œåˆ™è¿”å›è‡ªå·±ï¼›å¦åˆ™è¿”å›ç”±å‚æ•° supplier è·å¾—çš„ Optional</t></p></li><li><p>public void ifPresentOrElse(Consumer&lt;? super T&gt; action, Runnable emptyAction)<br>ifPresentOrElse æ–¹æ³•çš„ç”¨é€”æ˜¯ï¼Œå¦‚æœä¸€ä¸ª Optional åŒ…å«å€¼ï¼Œåˆ™å¯¹å…¶åŒ…å«çš„å€¼è°ƒç”¨å‡½æ•° actionï¼Œå³ action.accept(value)ï¼Œè¿™ä¸ ifPresent ä¸€è‡´ï¼›ä¸ ifPresent æ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼ŒifPresentOrElse è¿˜æœ‰ç¬¬äºŒä¸ªå‚æ•° emptyAction â€”â€” å¦‚æœ Optional ä¸åŒ…å«å€¼ï¼Œé‚£ä¹ˆ ifPresentOrElse ä¾¿ä¼šè°ƒç”¨ emptyActionï¼Œå³ emptyAction.run()</p></li><li>public Stream<t> stream()<br>stream æ–¹æ³•çš„ä½œç”¨å°±æ˜¯å°† Optional è½¬ä¸ºä¸€ä¸ª Streamï¼Œå¦‚æœè¯¥ Optional ä¸­åŒ…å«å€¼ï¼Œé‚£ä¹ˆå°±è¿”å›åŒ…å«è¿™ä¸ªå€¼çš„ Streamï¼›å¦åˆ™è¿”å›ä¸€ä¸ªç©ºçš„ Streamï¼ˆStream.empty()ï¼‰</t></li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ Java8ï¼Œæˆ‘ä»¬ä¼šå†™ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æ­¤å¤„ getUserById è¿”å›çš„æ˜¯ Optional&lt;User&gt;</span><br><span class="line">public List&lt;User&gt; getUsers(Collection&lt;Integer&gt; userIds) &#123;</span><br><span class="line">       return userIds.stream()</span><br><span class="line">            .map(this::getUserById)     // è·å¾— Stream&lt;Optional&lt;User&gt;&gt;</span><br><span class="line">            .filter(Optional::isPresent)// å»æ‰ä¸åŒ…å«å€¼çš„ Optional</span><br><span class="line">            .map(Optional::get)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œæœ‰äº† Optional.stream()ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶ç®€åŒ–ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; getUsers(Collection&lt;Integer&gt; userIds) &#123;</span><br><span class="line">    return userIds.stream()</span><br><span class="line">            .map(this::getUserById)    // è·å¾— Stream&lt;Optional&lt;User&gt;&gt;</span><br><span class="line">            .flatMap(Optional::stream) // Stream çš„ flatMap æ–¹æ³•å°†å¤šä¸ªæµåˆæˆä¸€ä¸ªæµ</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h2><p><img src="/images/Java_stream_Interfaces.png" alt=""></p><h3 id="æµæ˜¯ä»€ä¹ˆ"><a href="#æµæ˜¯ä»€ä¹ˆ" class="headerlink" title="æµæ˜¯ä»€ä¹ˆ"></a>æµæ˜¯ä»€ä¹ˆ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arrays.asList(&quot;a1&quot;, &quot;a2&quot;, &quot;b1&quot;, &quot;c2&quot;, &quot;c1&quot;).stream()</span><br><span class="line">                                           .filter(s -&gt; s.startsWith(&quot;c&quot;))</span><br><span class="line">                                           .map(String::toUpperCase)</span><br><span class="line">                                           .sorted()</span><br><span class="line">                                           .forEach(System.out::println);</span><br></pre></td></tr></table></figure><p>æµæ˜¯Java SE 8ç±»åº“ä¸­æ–°å¢çš„å…³é”®æŠ½è±¡ï¼Œå®ƒè¢«å®šä¹‰äºjava.util.streamï¼ˆè¿™ä¸ªåŒ…é‡Œæœ‰è‹¥å¹²æµç±»å‹ï¼šStream<t>ä»£è¡¨å¯¹è±¡å¼•ç”¨æµï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ç³»åˆ—ç‰¹åŒ–ï¼ˆspecializationï¼‰æµï¼Œæ¯”å¦‚IntStreamä»£è¡¨æ•´å½¢æ•°å­—æµï¼‰ã€‚æ¯ä¸ªæµä»£è¡¨ä¸€ä¸ªå€¼åºåˆ—ï¼Œæµæä¾›ä¸€ç³»åˆ—å¸¸ç”¨çš„èšé›†æ“ä½œï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä¾¿æ·çš„åœ¨å®ƒä¸Šé¢è¿›è¡Œå„ç§è¿ç®—ã€‚é›†åˆç±»åº“ä¹Ÿæä¾›äº†ä¾¿æ·çš„æ–¹å¼ä½¿æˆ‘ä»¬å¯ä»¥ä»¥æ“ä½œæµçš„æ–¹å¼ä½¿ç”¨é›†åˆã€æ•°ç»„ä»¥åŠå…¶å®ƒæ•°æ®ç»“æ„ã€‚æµçš„æ“ä½œå¯ä»¥è¢«ç»„åˆæˆæµæ°´çº¿ï¼ˆPipelineï¼‰ã€‚</t></p><p>å¼•å…¥çš„åŸå› ï¼š</p><ul><li>å£°æ˜æ€§æ–¹å¼å¤„ç†æ•°æ®é›†åˆ</li><li>é€æ˜åœ°å¹¶è¡Œå¤„ç†ï¼Œæé«˜æ€§èƒ½</li></ul><p>æµ çš„å®šä¹‰ï¼šä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„å…ƒç´ åºåˆ—</p><p>ä¸¤ä¸ªé‡è¦ç‰¹ç‚¹</p><ul><li>æµæ°´çº¿</li><li>å†…éƒ¨è¿­ä»£</li></ul><p>æµä¸é›†åˆï¼š</p><ul><li>é›†åˆä¸æµçš„å·®å¼‚å°±åœ¨äºä»€ä¹ˆæ—¶å€™è¿›è¡Œè®¡ç®— <ul><li>é›†åˆæ˜¯å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼ŒåŒ…å«æ•°æ®ç»“æ„ä¸­ç›®å‰æ‰€æœ‰çš„å€¼</li><li>æµçš„å…ƒç´ åˆ™æ˜¯æŒ‰éœ€è®¡ç®—/ç”Ÿæˆ</li></ul></li><li>å¦ä¸€ä¸ªå…³é”®åŒºåˆ«åœ¨äºéå†æ•°æ®çš„æ–¹å¼ <ul><li>é›†åˆä½¿ç”¨ Collection æ¥å£ï¼Œéœ€è¦ç”¨æˆ·å»åšè¿­ä»£ï¼Œç§°ä¸ºå¤–éƒ¨è¿­ä»£</li><li>æµçš„ Streams åº“ä½¿ç”¨å†…éƒ¨è¿­ä»£</li></ul></li></ul><p>æµçš„ä½¿ç”¨</p><ul><li>ä¸€ä¸ªæ•°æ®æºï¼ˆå¦‚é›†åˆï¼‰æ¥æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼›</li><li>ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼Œå½¢æˆä¸€æ¡æµçš„æµæ°´çº¿ï¼›</li><li>ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰§è¡Œæµæ°´çº¿ï¼Œå¹¶èƒ½ç”Ÿæˆç»“æœã€‚</li></ul><p>æµçš„æµæ°´çº¿èƒŒåçš„ç†å¿µç±»ä¼¼äºæ„å»ºå™¨æ¨¡å¼ã€‚å¸¸è§çš„ä¸­é—´æ“ä½œæœ‰filter,map,limit,sorted,distinctï¼›å¸¸è§çš„ç»ˆç«¯æ“ä½œæœ‰ forEach,count,collectã€‚</p><p><img src="/images/stream.png" alt=""></p><p>æµçš„æ“ä½œç±»å‹åˆ†ä¸ºä¸¤ç§ï¼š</p><ul><li>Intermediateï¼šä¸€ä¸ªæµå¯ä»¥åé¢è·Ÿéšé›¶ä¸ªæˆ–å¤šä¸ª intermediate æ“ä½œã€‚å…¶ç›®çš„ä¸»è¦æ˜¯æ‰“å¼€æµï¼Œåšå‡ºæŸç§ç¨‹åº¦çš„æ•°æ®æ˜ å°„/è¿‡æ»¤ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„æµï¼Œäº¤ç»™ä¸‹ä¸€ä¸ªæ“ä½œä½¿ç”¨ã€‚è¿™ç±»æ“ä½œéƒ½æ˜¯æƒ°æ€§åŒ–çš„ï¼ˆlazyï¼‰ï¼Œå°±æ˜¯è¯´ï¼Œä»…ä»…è°ƒç”¨åˆ°è¿™ç±»æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰çœŸæ­£å¼€å§‹æµçš„éå†ã€‚</li><li>Terminalï¼šä¸€ä¸ªæµåªèƒ½æœ‰ä¸€ä¸ª terminal æ“ä½œï¼Œå½“è¿™ä¸ªæ“ä½œæ‰§è¡Œåï¼Œæµå°±è¢«ä½¿ç”¨â€œå…‰â€äº†ï¼Œæ— æ³•å†è¢«æ“ä½œã€‚æ‰€ä»¥è¿™å¿…å®šæ˜¯æµçš„æœ€åä¸€ä¸ªæ“ä½œã€‚Terminal æ“ä½œçš„æ‰§è¡Œï¼Œæ‰ä¼šçœŸæ­£å¼€å§‹æµçš„éå†ï¼Œå¹¶ä¸”ä¼šç”Ÿæˆä¸€ä¸ªç»“æœï¼Œæˆ–è€…ä¸€ä¸ª side effectã€‚</li></ul><h3 id="æµçš„ä½¿ç”¨"><a href="#æµçš„ä½¿ç”¨" class="headerlink" title="æµçš„ä½¿ç”¨"></a>æµçš„ä½¿ç”¨</h3><h4 id="æ„å»ºæµ"><a href="#æ„å»ºæµ" class="headerlink" title="æ„å»ºæµ"></a>æ„å»ºæµ</h4><ul><li>ç”±å€¼åˆ›å»ºæµï¼šStream.ofã€Stream.emptyã€IntStream.range</li><li>ç”±é›†åˆåˆ›å»ºæµï¼šCollection.streamã€Collection.parallelStream</li><li>ç”±æ•°ç»„åˆ›å»ºæµï¼šArrays.stream(æ•°ç»„å˜é‡)</li><li>ç”±æ–‡ä»¶ç”Ÿæˆæµï¼šFiles.linesã€Files.walk</li><li>ç”±BufferedReaderåˆ›å»ºæµï¼šjava.io.BufferedReader.lines</li><li>ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµï¼Œ <ul><li>è¿­ä»£ï¼š Stream.iterateï¼ˆæ¥å—ä¸€ä¸ªç§å­å€¼ï¼Œå’Œä¸€ä¸ªUnaryOperatorï¼‰</li><li>ç”Ÿæˆï¼šStream.generateï¼ˆæ¥æ”¶ä¸€ä¸ªSupplieræ¥å£ï¼‰</li></ul></li></ul><h4 id="ä½¿ç”¨æµ"><a href="#ä½¿ç”¨æµ" class="headerlink" title="ä½¿ç”¨æµ"></a>ä½¿ç”¨æµ</h4><p>Intermediateï¼ˆä¸­é—´æ“ä½œï¼‰ï¼š</p><ul><li>ç­›é€‰<ul><li>è°“è¯ç­›é€‰ï¼šfilter</li><li>ç­›é€‰äº’å¼‚çš„å…ƒç´ ï¼šdistinct</li><li>å¿½ç•¥å¤´å‡ ä¸ªå…ƒç´ ï¼šskip</li><li>æˆªçŸ­è‡³æŒ‡å®šé•¿åº¦ï¼šlimit</li><li>æ’åºï¼šsorted</li><li>å·ç„ï¼ˆè¾“å‡ºï¼‰ï¼špeek</li><li>å¹³è¡ŒåŒ–ï¼šparallel</li><li>ä¸²è¡ŒåŒ–ï¼šsequential</li></ul></li><li>æ˜ å°„ <ul><li>å¯¹æµä¸­æ¯ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°ï¼šmap</li><li>æµçš„æ‰å¹³åŒ–ï¼šflatMap</li><li>è½¬ä¸ºåŸå§‹æµï¼šmapToIntã€mapToIntã€mapToInt</li><li>ä»åŸå§‹æµè½¬ä¸ºæ™®é€šæµï¼šboxed</li></ul></li><li>æ•°å€¼èŒƒå›´<ul><li>range:[èµ·å§‹å€¼ï¼Œç»“æŸå€¼)</li><li>rangeClosed:[èµ·å§‹å€¼ï¼Œç»“æŸå€¼]</li></ul></li></ul><p>Terminalï¼ˆç»ˆç»“æ“ä½œï¼‰</p><ul><li>æŸ¥æ‰¾å’ŒåŒ¹é…<ul><li>æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ ï¼šanyMatch</li><li>æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ ï¼šallMatch/noneMatch</li><li>æŸ¥æ‰¾å…ƒç´ ï¼šfindAny</li><li>æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼šfindFirst</li></ul></li><li>å½’çº¦ï¼ˆæŠ˜å ï¼‰ï¼šreduce(åˆå€¼ï¼Œç»“åˆæ“ä½œ)<ul><li>å…ƒç´ æ±‚å’Œï¼šcountã€sum</li><li>æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šminã€ max</li></ul></li><li>éå†<ul><li>forEachã€ forEachOrdered</li></ul></li></ul><p>anyMatch,allMatch,noneMatch éƒ½ç”¨åˆ°äº†çŸ­è·¯ï¼›distinct,sortedæ˜¯æœ‰çŠ¶æ€ä¸”æ— ç•Œçš„ï¼Œskip,limit,reduceæ˜¯æœ‰çŠ¶æ€ä¸”æœ‰ç•Œçš„ã€‚<br>åŸå§‹ç±»å‹æµç‰¹åŒ–ï¼šIntStream,DoubleStream,LongStreamï¼Œé¿å…æš—å«çš„è£…ç®±æˆæœ¬ã€‚</p><ul><li>æ˜ å°„åˆ°æ•°å€¼æµï¼šmapToInt,mapToDouble,mapToLong</li><li>è½¬æ¢å›æµå¯¹è±¡ï¼šboxed</li><li>é»˜è®¤å€¼ï¼šOptionalInt,OptionalDouble,OptionalLong</li></ul><h3 id="ç”¨æµæ”¶é›†æ•°æ®"><a href="#ç”¨æµæ”¶é›†æ•°æ®" class="headerlink" title="ç”¨æµæ”¶é›†æ•°æ®"></a>ç”¨æµæ”¶é›†æ•°æ®</h3><p>å¯¹æµè°ƒç”¨ collect æ–¹æ³•å°†å¯¹æµä¸­çš„å…ƒç´ è§¦å‘å½’çº¦æ“ä½œï¼ˆç”± Collector æ¥å‚æ•°åŒ–ï¼‰ã€‚</p><p>Collectors å®ç”¨ç±»æä¾›äº†è®¸å¤šé™æ€å·¥å‚æ–¹æ³•ï¼Œç”¨æ¥åˆ›å»ºå¸¸è§æ”¶é›†å™¨çš„å®ä¾‹ï¼Œä¸»è¦æä¾›ä¸‰å¤§åŠŸèƒ½ï¼š</p><ul><li>å°†æµå…ƒç´ å½’çº¦å’Œæ±‡æ€»ä¸ºä¸€ä¸ªå€¼</li><li>å…ƒç´ åˆ†ç»„</li><li>å…ƒç´ åˆ†åŒº</li></ul><p>å½’çº¦å’Œæ±‡æ€»(Collectors ç±»ä¸­çš„å·¥å‚æ–¹æ³•)ï¼š</p><ul><li>ç»Ÿè®¡ä¸ªæ•°ï¼šCollectors.counting</li><li>æŸ¥æ‰¾æµä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šCollectors.maxBy,Collectors.minBy</li><li>æ±‡æ€»ï¼šCollectors.summingInt,Collectors.averagingInt,summarizingInt/IntSummaryStatisticsã€‚è¿˜æœ‰å¯¹åº”çš„ long å’Œ double ç±»å‹çš„å‡½æ•°</li><li>è¿æ¥å­—ç¬¦ä¸²ï¼šjoining</li><li>å¹¿ä¹‰çš„å½’çº¦æ±‡æ€»ï¼šCollectors.reducing(èµ·å§‹å€¼ï¼Œæ˜ å°„æ–¹æ³•ï¼ŒäºŒå…ƒç»“åˆ)/Collectors.reducing(äºŒå…ƒç»“åˆ)ã€‚Collectors.reducing å·¥å‚æ–¹æ³•æ˜¯æ‰€æœ‰ä¸Šè¿°ç‰¹æ®Šæƒ…å†µçš„ä¸€èˆ¬åŒ–ã€‚</li></ul><p>collect vs. reduceï¼Œä¸¤è€…éƒ½æ˜¯ Stream æ¥å£çš„æ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äºï¼š</p><ul><li>è¯­æ„é—®é¢˜<ul><li>reduce æ–¹æ³•æ—¨åœ¨æŠŠä¸¤ä¸ªå€¼ç»“åˆèµ·æ¥ç”Ÿæˆä¸€ä¸ªæ–°å€¼ï¼Œæ˜¯ä¸å¯å˜çš„å½’çº¦ï¼›</li><li>collect æ–¹æ³•è®¾è®¡å°±æ˜¯è¦æ”¹å˜å®¹å™¨ï¼Œä»è€Œç´¯ç§¯è¦è¾“å‡ºçš„ç»“æœ</li></ul></li><li>å®é™…é—®é¢˜<ul><li>ä»¥é”™è¯¯çš„è¯­ä¹‰ä½¿ç”¨ reduce ä¼šå¯¼è‡´å½’çº¦è¿‡ç¨‹ä¸èƒ½å¹¶è¡Œå·¥ä½œ</li></ul></li></ul><p>åˆ†ç»„å’Œåˆ†åŒº</p><ul><li>åˆ†ç»„ï¼šCollectors.groupingBy<ul><li>å¤šçº§åˆ†ç»„</li><li>æŒ‰å­æ•°ç»„æ”¶é›†æ•°æ®: maxBy<ul><li>æŠŠæ”¶é›†å™¨çš„ç»“æœè½¬æ¢ä¸ºå¦ä¸€ç§ç»“æœ collectingAndThen</li><li>ä¸ groupingBy è”åˆä½¿ç”¨çš„å…¶ä»–æ”¶é›†å™¨ä¾‹å­ï¼šsummingInt,mapping</li></ul></li></ul></li><li>åˆ†åŒºï¼šCollectors.partitioningByæ˜¯åˆ†ç»„çš„ç‰¹æ®Šæƒ…å†µï¼Œç”±ä¸€ä¸ªè°“è¯ä½œä¸ºåˆ†ç±»å‡½æ•°(åˆ†åŒºå‡½æ•°)ï¼Œè¿”å›ä¸€ä¸ªMapï¼Œåªæœ‰ä¸¤ä¸ªBooleanç±»å‹çš„keyã€‚</li></ul><h3 id="Ex1-ä½¿ç”¨collect-ç”ŸæˆCollection"><a href="#Ex1-ä½¿ç”¨collect-ç”ŸæˆCollection" class="headerlink" title="Ex1:ä½¿ç”¨collect()ç”ŸæˆCollection"></a>Ex1:ä½¿ç”¨collect()ç”ŸæˆCollection</h3><p>å‰é¢å·²ç»æåˆ°é€šè¿‡collect()æ–¹æ³•å°†Streamè½¬æ¢æˆå®¹å™¨çš„æ–¹æ³•ï¼Œè¿™é‡Œå†æ±‡æ€»ä¸€ä¸‹ã€‚å°†Streamè½¬æ¢æˆListæˆ–Setæ˜¯æ¯”è¾ƒå¸¸è§çš„æ“ä½œï¼Œæ‰€ä»¥Collectorså·¥å…·å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹åº”çš„æ”¶é›†å™¨ï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç å³å¯å®Œæˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// å°†Streamè½¬æ¢æˆListæˆ–Set</span><br><span class="line">Stream&lt;String&gt; stream = Stream.of(&quot;I&quot;, &quot;love&quot;, &quot;you&quot;, &quot;too&quot;);</span><br><span class="line">List&lt;String&gt; list = stream.collect(Collectors.toList()); // (1)</span><br><span class="line">Set&lt;String&gt; set = stream.collect(Collectors.toSet()); // (2)</span><br><span class="line"></span><br><span class="line">ä¸Šè¿°ä»£ç èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œä½†ç”±äºè¿”å›ç»“æœæ˜¯æ¥å£ç±»å‹ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ç±»åº“å®é™…é€‰æ‹©çš„å®¹å™¨ç±»å‹æ˜¯ä»€ä¹ˆï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½ä¼šæƒ³è¦äººä¸ºæŒ‡å®šå®¹å™¨çš„å®é™…ç±»å‹ï¼Œè¿™ä¸ªéœ€æ±‚å¯é€šè¿‡Collectors.toCollection(Supplier&lt;C&gt; collectionFactory)æ–¹æ³•å®Œæˆã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨toCollection()æŒ‡å®šè§„çº¦å®¹å™¨çš„ç±»å‹</span><br><span class="line">ArrayList&lt;String&gt; arrayList = stream.collect(Collectors.toCollection(ArrayList::new));// (3)</span><br><span class="line">HashSet&lt;String&gt; hashSet = stream.collect(Collectors.toCollection(HashSet::new));// (4)</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç (3)å¤„æŒ‡å®šè§„çº¦ç»“æœæ˜¯ArrayListï¼Œè€Œ(4)å¤„æŒ‡å®šè§„çº¦ç»“æœä¸ºHashSetã€‚ä¸€åˆ‡å¦‚ä½ æ‰€æ„¿ã€‚</p><h3 id="Ex2-ä½¿ç”¨collect-ç”ŸæˆMap"><a href="#Ex2-ä½¿ç”¨collect-ç”ŸæˆMap" class="headerlink" title="Ex2:ä½¿ç”¨collect()ç”ŸæˆMap"></a>Ex2:ä½¿ç”¨collect()ç”ŸæˆMap</h3><p>å‰é¢å·²ç»è¯´è¿‡StreamèƒŒåä¾èµ–äºæŸç§æ•°æ®æºï¼Œæ•°æ®æºå¯ä»¥æ˜¯æ•°ç»„ã€å®¹å™¨ç­‰ï¼Œä½†ä¸èƒ½æ˜¯Mapã€‚åè¿‡æ¥ä»Streamç”ŸæˆMapæ˜¯å¯ä»¥çš„ï¼Œä½†æˆ‘ä»¬è¦æƒ³æ¸…æ¥šMapçš„keyå’Œvalueåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼Œæ ¹æœ¬åŸå› æ˜¯æˆ‘ä»¬è¦æƒ³æ¸…æ¥šè¦å¹²ä»€ä¹ˆã€‚é€šå¸¸åœ¨ä¸‰ç§æƒ…å†µä¸‹collect()çš„ç»“æœä¼šæ˜¯Mapï¼š</p><ol><li>ä½¿ç”¨Collectors.toMap()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šå¦‚ä½•ç”ŸæˆMapçš„keyå’Œvalueã€‚</li><li>ä½¿ç”¨Collectors.partitioningBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œå¯¹å…ƒç´ è¿›è¡ŒäºŒåˆ†åŒºæ“ä½œæ—¶ç”¨åˆ°ã€‚</li><li>ä½¿ç”¨Collectors.groupingBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œå¯¹å…ƒç´ åšgroupæ“ä½œæ—¶ç”¨åˆ°ã€‚</li></ol><p>æƒ…å†µ1ï¼šä½¿ç”¨toMap()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€ç›´æ¥çš„ï¼Œå‰é¢ä¾‹å­ä¸­å·²æåˆ°ï¼Œè¿™æ˜¯å’ŒCollectors.toCollection()å¹¶åˆ—çš„æ–¹æ³•ã€‚å¦‚ä¸‹ä»£ç å±•ç¤ºå°†å­¦ç”Ÿåˆ—è¡¨è½¬æ¢æˆç”±&lt;å­¦ç”Ÿï¼ŒGPA&gt;ç»„æˆçš„Mapã€‚éå¸¸ç›´è§‚ï¼Œæ— éœ€å¤šè¨€ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨toMap()ç»Ÿè®¡å­¦ç”ŸGPA</span><br><span class="line">Map&lt;Student, Double&gt; studentToGPA =</span><br><span class="line">     students.stream().collect(Collectors.toMap(Functions.identity(),// å¦‚ä½•ç”Ÿæˆkey</span><br><span class="line">                                     student -&gt; computeGPA(student)));// å¦‚ä½•ç”Ÿæˆvalue</span><br></pre></td></tr></table></figure><p>æƒ…å†µ2ï¼šä½¿ç”¨partitioningBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™ç§æƒ…å†µé€‚ç”¨äºå°†Streamä¸­çš„å…ƒç´ ä¾æ®æŸä¸ªäºŒå€¼é€»è¾‘ï¼ˆæ»¡è¶³æ¡ä»¶ï¼Œæˆ–ä¸æ»¡è¶³ï¼‰åˆ†æˆäº’è¡¥ç›¸äº¤çš„ä¸¤éƒ¨åˆ†ï¼Œæ¯”å¦‚ç”·å¥³æ€§åˆ«ã€æˆç»©åŠæ ¼ä¸å¦ç­‰ã€‚ä¸‹åˆ—ä»£ç å±•ç¤ºå°†å­¦ç”Ÿåˆ†æˆæˆç»©åŠæ ¼æˆ–ä¸åŠæ ¼çš„ä¸¤éƒ¨åˆ†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Partition students into passing and failing</span><br><span class="line">Map&lt;Boolean, List&lt;Student&gt;&gt; passingFailing = students.stream()</span><br><span class="line">         .collect(Collectors.partitioningBy(s -&gt; s.getGrade() &gt;= PASS_THRESHOLD));</span><br></pre></td></tr></table></figure><p>æƒ…å†µ3ï¼šä½¿ç”¨groupingBy()ç”Ÿæˆçš„æ”¶é›†å™¨ï¼Œè¿™æ˜¯æ¯”è¾ƒçµæ´»çš„ä¸€ç§æƒ…å†µã€‚è·ŸSQLä¸­çš„group byè¯­å¥ç±»ä¼¼ï¼Œè¿™é‡Œçš„groupingBy()ä¹Ÿæ˜¯æŒ‰ç…§æŸä¸ªå±æ€§å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå±æ€§ç›¸åŒçš„å…ƒç´ ä¼šè¢«å¯¹åº”åˆ°Mapçš„åŒä¸€ä¸ªkeyä¸Šã€‚ä¸‹åˆ—ä»£ç å±•ç¤ºå°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨è¿›è¡Œåˆ†ç»„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Group employees by department</span><br><span class="line">Map&lt;Department, List&lt;Employee&gt;&gt; byDept = employees.stream()</span><br><span class="line">            .collect(Collectors.groupingBy(Employee::getDepartment));</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šåªæ˜¯åˆ†ç»„çš„æœ€åŸºæœ¬ç”¨æ³•ï¼Œæœ‰äº›æ—¶å€™ä»…ä»…åˆ†ç»„æ˜¯ä¸å¤Ÿçš„ã€‚åœ¨SQLä¸­ä½¿ç”¨group byæ˜¯ä¸ºäº†ååŠ©å…¶ä»–æŸ¥è¯¢ï¼Œæ¯”å¦‚1. å…ˆå°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨åˆ†ç»„ï¼Œ2. ç„¶åç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨å‘˜å·¥çš„äººæ•°ã€‚Javaç±»åº“è®¾è®¡è€…ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ç§æƒ…å†µï¼Œå¢å¼ºç‰ˆçš„groupingBy()èƒ½å¤Ÿæ»¡è¶³è¿™ç§éœ€æ±‚ã€‚å¢å¼ºç‰ˆçš„groupingBy()å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ åˆ†ç»„ä¹‹åå†æ‰§è¡ŒæŸç§è¿ç®—ï¼Œæ¯”å¦‚æ±‚å’Œã€è®¡æ•°ã€å¹³å‡å€¼ã€ç±»å‹è½¬æ¢ç­‰ã€‚è¿™ç§å…ˆå°†å…ƒç´ åˆ†ç»„çš„æ”¶é›†å™¨å«åšä¸Šæ¸¸æ”¶é›†å™¨ï¼Œä¹‹åæ‰§è¡Œå…¶ä»–è¿ç®—çš„æ”¶é›†å™¨å«åšä¸‹æ¸¸æ”¶é›†å™¨(downstream Collector)ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨ä¸‹æ¸¸æ”¶é›†å™¨ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨çš„äººæ•°</span><br><span class="line">Map&lt;Department, Integer&gt; totalByDept = employees.stream()</span><br><span class="line">                    .collect(Collectors.groupingBy(Employee::getDepartment,</span><br><span class="line">                                                   Collectors.counting()));// ä¸‹æ¸¸æ”¶é›†å™¨</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„é€»è¾‘æ˜¯ä¸æ˜¯è¶Šçœ‹è¶ŠåƒSQLï¼Ÿé«˜åº¦éç»“æ„åŒ–ã€‚è¿˜æœ‰æ›´ç‹ çš„ï¼Œä¸‹æ¸¸æ”¶é›†å™¨è¿˜å¯ä»¥åŒ…å«æ›´ä¸‹æ¸¸çš„æ”¶é›†å™¨ï¼Œè¿™ç»ä¸æ˜¯ä¸ºäº†ç‚«æŠ€è€Œå¢åŠ çš„æŠŠæˆï¼Œè€Œæ˜¯å®é™…åœºæ™¯éœ€è¦ã€‚è€ƒè™‘å°†å‘˜å·¥æŒ‰ç…§éƒ¨é—¨åˆ†ç»„çš„åœºæ™¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¾—åˆ°æ¯ä¸ªå‘˜å·¥çš„åå­—ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸ªEmployeeå¯¹è±¡ï¼Œå¯é€šè¿‡å¦‚ä¸‹æ–¹å¼åšåˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// æŒ‰ç…§éƒ¨é—¨å¯¹å‘˜å·¥åˆ†å¸ƒç»„ï¼Œå¹¶åªä¿ç•™å‘˜å·¥çš„åå­—</span><br><span class="line">Map&lt;Department, List&lt;String&gt;&gt; byDept = employees.stream()</span><br><span class="line">                .collect(Collectors.groupingBy(Employee::getDepartment,</span><br><span class="line">                        Collectors.mapping(Employee::getName,// ä¸‹æ¸¸æ”¶é›†å™¨</span><br><span class="line">                                Collectors.toList())));// æ›´ä¸‹æ¸¸çš„æ”¶é›†å™¨</span><br></pre></td></tr></table></figure><hr><h2 id="Notice-And-Optimization"><a href="#Notice-And-Optimization" class="headerlink" title="Notice And Optimization"></a>Notice And Optimization</h2><ul><li>æµä¸å¯è¢«å¤ç”¨</li><li>ä¸€èˆ¬å…ˆfilterã€limitã€skipæ“ä½œåå†è¿›è¡Œsortedã€peekã€mapç­‰æ“ä½œä»¥è¾¾åˆ°short-circuiting ç›®çš„</li></ul><table><thead><tr><th>Streamæ“ä½œåˆ†ç±»</th><th></th><th>æ–¹æ³• </th></tr></thead><tbody><tr><td>ä¸­é—´æ“ä½œ(Intermediate operations)</td><td>æ— çŠ¶æ€(Stateless)</td><td>unordered() filter() map() mapToInt() mapToLong() mapToDouble() flatMap() flatMapToInt() flatMapToLong() flatMapToDouble() peek()</td></tr><tr><td>æœ‰çŠ¶æ€(Stateful)</td><td>distinct() sorted() sorted() limit() skip()</td><td></td></tr><tr><td>ç»“æŸæ“ä½œ(Terminal operations)</td><td>éçŸ­è·¯æ“ä½œ</td><td>forEach() forEachOrdered() toArray() reduce() collect() max() min() count()</td></tr><tr><td>çŸ­è·¯æ“ä½œ(short-circuiting)</td><td>anyMatch() allMatch() noneMatch() findFirst() findAny()</td><td></td></tr></tbody></table><p>Streamä¸Šçš„æ‰€æœ‰æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»“æŸæ“ä½œï¼Œä¸­é—´æ“ä½œåªæ˜¯ä¸€ç§æ ‡è®°ï¼Œåªæœ‰ç»“æŸæ“ä½œæ‰ä¼šè§¦å‘å®é™…è®¡ç®—ã€‚ä¸­é—´æ“ä½œåˆå¯ä»¥åˆ†ä¸ºæ— çŠ¶æ€çš„(Stateless)å’Œæœ‰çŠ¶æ€çš„(Stateful)ï¼Œæ— çŠ¶æ€ä¸­é—´æ“ä½œæ˜¯æŒ‡å…ƒç´ çš„å¤„ç†ä¸å—å‰é¢å…ƒç´ çš„å½±å“ï¼Œè€Œæœ‰çŠ¶æ€çš„ä¸­é—´æ“ä½œå¿…é¡»ç­‰åˆ°æ‰€æœ‰å…ƒç´ å¤„ç†ä¹‹åæ‰çŸ¥é“æœ€ç»ˆç»“æœï¼Œæ¯”å¦‚æ’åºæ˜¯æœ‰çŠ¶æ€æ“ä½œï¼Œåœ¨è¯»å–æ‰€æœ‰å…ƒç´ ä¹‹å‰å¹¶ä¸èƒ½ç¡®å®šæ’åºç»“æœï¼›ç»“æŸæ“ä½œåˆå¯ä»¥åˆ†ä¸ºçŸ­è·¯æ“ä½œå’ŒéçŸ­è·¯æ“ä½œï¼ŒçŸ­è·¯æ“ä½œæ˜¯æŒ‡ä¸ç”¨å¤„ç†å…¨éƒ¨å…ƒç´ å°±å¯ä»¥è¿”å›ç»“æœï¼Œæ¯”å¦‚æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚ä¹‹æ‰€ä»¥è¦è¿›è¡Œå¦‚æ­¤ç²¾ç»†çš„åˆ’åˆ†ï¼Œæ˜¯å› ä¸ºåº•å±‚å¯¹æ¯ä¸€ç§æƒ…å†µçš„å¤„ç†æ–¹å¼ä¸åŒã€‚</p><hr><h2 id="Java8-å¯¹å­—ç¬¦ä¸²è¿æ¥çš„æ”¹è¿›"><a href="#Java8-å¯¹å­—ç¬¦ä¸²è¿æ¥çš„æ”¹è¿›" class="headerlink" title="Java8 å¯¹å­—ç¬¦ä¸²è¿æ¥çš„æ”¹è¿›"></a>Java8 å¯¹å­—ç¬¦ä¸²è¿æ¥çš„æ”¹è¿›</h2><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸€ç§éœ€æ±‚å°±æ˜¯å°†è‹¥å¹²ä¸ªå­—ç¬¦ä¸²ç”¨æŸä¸ªé“¾æ¥ç¬¦è¡”æ¥èµ·æ¥ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ª Listï¼Œå°†å…¶æ ¼å¼åŒ–ä¸º å…ƒç´ 1, å…ƒç´ 2, å…ƒç´ 3, â€¦ å…ƒç´ N çš„å­—ç¬¦ä¸²å½¢å¼ã€‚</p><p>ä»¥å‰æˆ‘ä»¬çš„ä¸€èˆ¬åšæ³•å°±æ˜¯ä½¿ç”¨StringBuilderï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public static String formatList(List&lt;String&gt; list, String delimiter) &#123;</span><br><span class="line">    StringBuilder result = new StringBuilder();</span><br><span class="line">    for (String str : list) &#123;</span><br><span class="line">        result.append(str).append(delimiter);</span><br><span class="line">    &#125;</span><br><span class="line">    // åˆ é™¤æœ«å°¾å¤šä½™çš„ delimiter</span><br><span class="line">    result.delete(result.length() - delimiter.length(), result.length()); </span><br><span class="line">    </span><br><span class="line">    return result.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;ä½¿ç”¨ StringBuilderï¼š&quot;);</span><br><span class="line">    String format = formatList(list, &quot;,&quot;);</span><br><span class="line">    System.out.println(format);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//è¿è¡Œç»“æœ</span><br><span class="line">ä½¿ç”¨ StringBuilderï¼š</span><br><span class="line">a,b,c,d,e,f,g</span><br></pre></td></tr></table></figure><p>JDK1.8 æ—¶ï¼Œæ·»åŠ äº†ä¸€ä¸ªæ–°çš„ç”¨äºå­—ç¬¦ä¸²è¿æ¥çš„ç±»ï¼Œä¸“é—¨ç”¨äºè¿™ç§éœ€è¦ åˆ†éš”ç¬¦ çš„åœºåˆï¼Œå®ƒå°±æ˜¯ StringJoinerã€‚StringJoiner åœ¨æ„é€ æ—¶å¯ä»¥æŒ‡å®šä¸€ä¸ªåˆ†éš”ç¬¦ï¼ˆdelimiterï¼‰ï¼Œç„¶åæ¯è¿æ¥ä¸€ä¸ªå…ƒç´ å®ƒä¾¿ä¼šåŠ ä¸Šä¸€ä¸ª delimiterï¼Œä½¿ç”¨ StringJoiner æ”¹å†™ formatListï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static String formatList(List&lt;String&gt; list, String delimiter) &#123;</span><br><span class="line">    StringJoiner result = new StringJoiner(delimiter);</span><br><span class="line">    for (String str : list) &#123;</span><br><span class="line">        result.add(str);</span><br><span class="line">    &#125;</span><br><span class="line">    return result.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;ä½¿ç”¨ StringJoinerï¼š&quot;);</span><br><span class="line">    String format = formatList(list, &quot;,&quot;);</span><br><span class="line">    System.out.println(format);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨String.join:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public static String formatList(List&lt;String&gt; list, String delimiter) &#123;</span><br><span class="line">    return String.join(delimiter, list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>String.join æ–¹æ³•çš„ä¸è¶³ â€”â€” å®ƒä¸èƒ½æŒ‡å®šå‰ç¼€å’Œåç¼€ â€”â€” æ¯”å¦‚æˆ‘ä»¬å¦‚æœæƒ³è¦ç›´æ¥å°† List<string> æ ¼å¼åŒ–ä¸º { å…ƒç´ 1, å…ƒç´ 2, å…ƒç´ 3, â€¦ å…ƒç´ N } å‘¢ï¼Ÿï¼ˆæ­¤æ—¶å‰ç¼€ä¸º â€œ{ â€œï¼Œåç¼€ä¸º â€œ }â€ï¼‰</string></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public static String formatList(</span><br><span class="line">        List&lt;String&gt; list, String delimiter, String prefix, String suffix) &#123;</span><br><span class="line"></span><br><span class="line">    StringJoiner result = new StringJoiner(delimiter, prefix, suffix);</span><br><span class="line">    for (String str : list) &#123;</span><br><span class="line">        result.add(str);</span><br><span class="line">    &#125;</span><br><span class="line">    return result.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;ä½¿ç”¨ StringJoinerï¼Œå¸¦å‰ç¼€å’Œåç¼€ï¼š&quot;);</span><br><span class="line">    String format = formatList(list, &quot;, &quot;, &quot;&#123; &quot;, &quot; &#125;&quot;);</span><br><span class="line">    System.out.println(format);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼ŒJava8 å¯¹äºå­—ç¬¦ä¸²é›†åˆçš„è¿æ¥æ“ä½œæä¾›äº†ä¸€ä¸ªä¸“é—¨çš„æµå¼ APIï¼Œå³ Collectors.joining å‡½æ•°</p><ul><li>æ— å‚çš„ joining() æ–¹æ³•ï¼Œå³ä¸å­˜åœ¨è¿æ¥ç¬¦ï¼ˆåº•å±‚å®ç°ä¸º StringBuilderï¼‰ï¼›</li><li>joining(CharSequence delimiter) æ–¹æ³•ï¼Œå³åˆ†éš”ç¬¦ä¸º delimiterï¼ˆåº•å±‚å®ç°ä¸º StringJoinerï¼‰ï¼›</li><li>joining(CharSequence delimiter, CharSequence prefix, CharSequence suffix)æ–¹æ³•ï¼Œå³åˆ†éš”ç¬¦ä¸º delimiterï¼Œå‰ç¼€ä¸º prefixï¼Œåç¼€ä¸º suffixï¼ˆåº•å±‚å®ç°ä¸º StringJoinerï¼‰ã€‚</li></ul><p>é‚£æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸‰ä¸ªå‚æ•°çš„ Collectors.joining æ–¹æ³•æ”¹å†™ formatListï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public static String formatList(</span><br><span class="line">        List&lt;String&gt; list, String delimiter, String prefix, String suffix) &#123;</span><br><span class="line"></span><br><span class="line">    return list.stream().collect(Collectors.joining(delimiter, prefix, suffix));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;ä½¿ç”¨ Collectors.joiningï¼š&quot;);</span><br><span class="line">    String format = formatList(list, &quot;, &quot;, &quot;&#123; &quot;, &quot; &#125;&quot;);</span><br><span class="line">    System.out.println(format);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Java8-ä¸­-Map-æ¥å£çš„æ–°æ–¹æ³•"><a href="#Java8-ä¸­-Map-æ¥å£çš„æ–°æ–¹æ³•" class="headerlink" title="Java8 ä¸­ Map æ¥å£çš„æ–°æ–¹æ³•"></a>Java8 ä¸­ Map æ¥å£çš„æ–°æ–¹æ³•</h2><p>å‡å¦‚ç°åœ¨æˆ‘ä»¬å­˜åœ¨è¿™æ ·çš„éœ€æ±‚ï¼šç»™å®šä¸€ä¸ª List<string>ï¼Œç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ‰€æœ‰ä½ç½®ã€‚</string></p><p>æ¯”å¦‚ï¼Œç»™å®š listï¼š[â€œaâ€, â€œbâ€, â€œbâ€, â€œcâ€, â€œcâ€, â€œcâ€, â€œdâ€, â€œdâ€, â€œdâ€, â€œfâ€, â€œfâ€, â€œgâ€] ï¼Œé‚£ä¹ˆåº”è¯¥è¿”å›ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a : [0]</span><br><span class="line">b : [1, 2]</span><br><span class="line">c : [3, 4, 5]</span><br><span class="line">d : [6, 7, 8]</span><br><span class="line">f : [9, 10]</span><br><span class="line">g : [11]</span><br></pre></td></tr></table></figure></p><p>å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬å¾ˆé€‚åˆä½¿ç”¨ Map æ¥å®Œæˆè¿™ä»¶äº‹æƒ…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123;</span><br><span class="line">    Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; list.size(); i++) &#123;</span><br><span class="line">        String str = list.get(i);</span><br><span class="line">        List&lt;Integer&gt; positions = positionsMap.get(str);</span><br><span class="line"></span><br><span class="line">        if (positions == null) &#123; // å¦‚æœ positionsMap è¿˜ä¸å­˜åœ¨ str è¿™ä¸ªé”®åŠå…¶å¯¹åº”çš„ List&lt;Integer&gt;</span><br><span class="line">            positions = new ArrayList&lt;&gt;(1);</span><br><span class="line">            positionsMap.put(str, positions); // å°† str åŠå…¶å¯¹åº”çš„ positions æ”¾å…¥ positionsMap</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        positions.add(i); // å°†ç´¢å¼•åŠ å…¥ str ç›¸å…³è”çš„ List&lt;Integer&gt; ä¸­</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return positionsMap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;f&quot;, &quot;f&quot;, &quot;g&quot;);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;ä½¿ç”¨ Java8 ä¹‹å‰çš„ APIï¼š&quot;);</span><br><span class="line">    Map&lt;String, List&lt;Integer&gt;&gt; elementPositions = getElementPositions(list);</span><br><span class="line">    System.out.println(elementPositions);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ Java8 ä¹‹å‰çš„ APIï¼š</span><br><span class="line">&#123;a=[0], b=[1, 2], c=[3, 4, 5], d=[6, 7, 8], f=[9, 10], g=[11]&#125;</span><br></pre></td></tr></table></figure><p>computeIfAbsent<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123;</span><br><span class="line">    Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; list.size(); i++) &#123;</span><br><span class="line">        positionsMap.computeIfAbsent(list.get(i), k -&gt; new ArrayList&lt;&gt;(1)).add(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return positionsMap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    List&lt;String&gt; list = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;, &quot;d&quot;, &quot;f&quot;, &quot;f&quot;, &quot;g&quot;);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;ä½¿ç”¨ computeIfAbsentï¼š&quot;);</span><br><span class="line">    Map&lt;String, List&lt;Integer&gt;&gt; elementPositions = getElementPositions(list);</span><br><span class="line">    System.out.println(elementPositions);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å½“-forEach-éœ€è¦ç´¢å¼•"><a href="#å½“-forEach-éœ€è¦ç´¢å¼•" class="headerlink" title="å½“ forEach éœ€è¦ç´¢å¼•"></a>å½“ forEach éœ€è¦ç´¢å¼•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123;</span><br><span class="line">    Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;();</span><br><span class="line">    for (int i = 0; i &lt; list.size(); i++) &#123;</span><br><span class="line">        positionsMap.computeIfAbsent(list.get(i), k -&gt; new ArrayList&lt;&gt;(1)).add(i);</span><br><span class="line">    &#125;</span><br><span class="line">    return positionsMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ–¹æ³•é‡Œé¢çš„forå¾ªç¯ä¼¼ä¹è®©è¿™ä¸ªæ–¹æ³•ä¸å¤ªä¼˜é›…äº†ï¼ŒJava8ä¸­Iterableæä¾›çš„foreachå¹¶ä¸å¸¦ç´¢å¼•çš„ï¼š</p><p>æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public static &lt;E&gt; void forEach(</span><br><span class="line">            Iterable&lt;? extends E&gt; elements, BiConsumer&lt;Integer, ? super E&gt; action) &#123;</span><br><span class="line">        Objects.requireNonNull(elements);</span><br><span class="line">        Objects.requireNonNull(action);</span><br><span class="line"></span><br><span class="line">        int index = 0;</span><br><span class="line">        for (E element : elements) &#123;</span><br><span class="line">            action.accept(index++, element);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ”¹é€ getElementPositionsæ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public static Map&lt;String, List&lt;Integer&gt;&gt; getElementPositions(List&lt;String&gt; list) &#123;</span><br><span class="line">    Map&lt;String, List&lt;Integer&gt;&gt; positionsMap = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    Iterables.forEach(list, (index, str) -&gt; &#123;</span><br><span class="line">        positionsMap.computeIfAbsent(str, k -&gt; new ArrayList&lt;&gt;(1)).add(index);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return positionsMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>å‚è€ƒ</em></p><blockquote><p><a href="http://yangbingdong.com/2017/java-8-tutorial/" target="_blank" rel="noopener">Java8 Noob Tutorial</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Java 8å¸¦æ¥äº†å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬Lambda è¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ã€æµ(Stream API)ã€é»˜è®¤æ–¹æ³•ã€Optionalã€ç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹ã€æ–°çš„æ—¶é—´ APIï¼Œç­‰ç­‰å„ä¸ªæ–¹é¢ã€‚&lt;br&gt;&lt;img src=&quot;/images/java8.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨</title>
    <link href="https://hsb786.github.io/2018/04/12/%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%8E%92%E5%BA%8F%E7%9A%84%E9%93%BE%E8%A1%A8/"/>
    <id>https://hsb786.github.io/2018/04/12/åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨/</id>
    <published>2018-04-12T07:29:59.000Z</published>
    <updated>2018-04-12T07:53:55.820Z</updated>
    
    <content type="html"><![CDATA[<p>è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹äººæ˜¯æŒ‰ç…§é€’å¢æ’åºçš„ã€‚<br><a id="more"></a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">public static ListNode merge(ListNode list1, ListNode list2) &#123;</span><br><span class="line">if (list1 == null) &#123;</span><br><span class="line">return list2;</span><br><span class="line">&#125;</span><br><span class="line">if (list2 == null) &#123;</span><br><span class="line">return list1;</span><br><span class="line">&#125;</span><br><span class="line">if (list1.data &lt; list2.data) &#123;</span><br><span class="line">list1.next = merge(list1.next, list2);</span><br><span class="line">return list1;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">list2.next = merge(list1, list2.next);</span><br><span class="line">return list2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static ListNode mergeSortedList(ListNode list1, ListNode list2) &#123;</span><br><span class="line">if (list1 == null) &#123;</span><br><span class="line">return list2;</span><br><span class="line">&#125;</span><br><span class="line">if (list2 == null) &#123;</span><br><span class="line">return list1;</span><br><span class="line">&#125;</span><br><span class="line">ListNode mergeHead = null;</span><br><span class="line">ListNode current = null;</span><br><span class="line">if (list1.data &lt;= list2.data) &#123;</span><br><span class="line">mergeHead = current = list1;</span><br><span class="line">list1 = list1.next;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">mergeHead = current = list2;</span><br><span class="line">list2 = list2.next;</span><br><span class="line">&#125;</span><br><span class="line">while (list1 != null &amp;&amp; list2 != null) &#123;</span><br><span class="line">if (list1.data &lt;= list2.data) &#123;</span><br><span class="line">current.next = list1;</span><br><span class="line">current = current.next;</span><br><span class="line">list1 = list1.next;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">current.next = list2;</span><br><span class="line">current = current.next;</span><br><span class="line">list2 = list2.next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (list1 == null) &#123;</span><br><span class="line">current.next = list2;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">current.next = list1;</span><br><span class="line">&#125;</span><br><span class="line">return mergeHead;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹äººæ˜¯æŒ‰ç…§é€’å¢æ’åºçš„ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="å‰‘æŒ‡Offer" scheme="https://hsb786.github.io/tags/%E5%89%91%E6%8C%87Offer/"/>
    
      <category term="ç®—æ³•" scheme="https://hsb786.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis</title>
    <link href="https://hsb786.github.io/2018/04/12/MyBatis/"/>
    <id>https://hsb786.github.io/2018/04/12/MyBatis/</id>
    <published>2018-04-12T05:39:35.000Z</published>
    <updated>2018-04-12T08:45:29.292Z</updated>
    
    <content type="html"><![CDATA[<h2 id="MyBatisç®€ä»‹"><a href="#MyBatisç®€ä»‹" class="headerlink" title="MyBatisç®€ä»‹"></a>MyBatisç®€ä»‹</h2><p><img src="/images/mybatis-logo.png" alt=""></p><p>MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚</p><p>Mybatisä¸Hibernateéƒ½æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œè¿™ç±»æ¡†æ¶çš„ä½œç”¨å°±æ˜¯å°†æ•°æ®åº“ä¸­çš„è¡¨å’ŒPOJOæ˜ å°„èµ·æ¥ï¼Œå®ƒä»¬çš„æœ¬è´¨å°±æ˜¯Javaå¯¹æ•°æ®åº“çš„æ“ä½œçš„æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†è¿™ç§æ¡†æ¶ç§°ä¸ºå¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶(ORM,Object Relational Mapping)ã€‚å®ƒä»¬çš„åŒºåˆ«ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒHibernateåŸºæœ¬ä¸éœ€è¦ç¼–å†™SQLï¼Œå®ƒå¯ä»¥æ ¹æ®æ˜ å°„è§„åˆ™è‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼Œæ˜¯ä¸€ç§å…¨è¡¨æ˜ å°„ã€‚è€ŒMyBatisä¸å±è”½SQLï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šåˆ¶SQLï¼Œè¿™æ ·å°±æä¾›ç»™äº†æˆ‘ä»¬è¶³å¤Ÿçš„çµæ´»æ€§ä¸ä¼˜åŒ–çš„å¯èƒ½ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒMyBatisç›¸å¯¹äºHibernateæ¥è¯´å…·æœ‰æ€§èƒ½é«˜ï¼Œå“åº”å¿«ï¼Œå¼€å‘çµæ´»çš„ç‰¹ç‚¹ã€‚<br><a id="more"></a></p><h2 id="MyBatisç»„ä»¶"><a href="#MyBatisç»„ä»¶" class="headerlink" title="MyBatisç»„ä»¶"></a>MyBatisç»„ä»¶</h2><p>MyBatisçš„æ ¸å¿ƒç»„ä»¶åˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><p>SqlSessionFactoryBuilder(æ„é€ å™¨)ï¼šå®ƒä¼šæ ¹æ®mybatisçš„é…ç½®æ–‡ä»¶(Configurationé…ç½®ç±»)æ¥ç”ŸæˆSqlSessionFactoryï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯åˆ†æ­¥æ„å»ºçš„Builderæ¨¡å¼</p></li><li><p>SqlSessionFactory(å·¥å‚)ï¼šç”¨äºç”ŸæˆSqlSessionï¼Œå¯ä»¥è¢«è®¤ä¸ºæ˜¯æ•°æ®åº“è¿æ¥æ± </p></li><li><p>SqlSession(ä¼šè¯)ï¼šæ—¢å¯ä»¥ç›´æ¥å‘é€SQLæ‰§è¡Œå¹¶è¿”å›ç»“æœï¼Œä¹Ÿå¯ä»¥è·å–æ˜ å°„å™¨Mapperæ¥å£(åŠ¨æ€ä»£ç†çš„ç±»)æ‰§è¡ŒSQLå¾—åˆ°è¿”å›ç»“æœï¼Œç›¸å½“äºæ•°æ®åº“è¿æ¥(Connectionå¯¹è±¡)</p></li><li><p>Mapper(æ˜ å°„å™¨)ï¼šç”±ä¸€ä¸ªJavaæ¥å£å’ŒXMLæ–‡ä»¶æ„æˆï¼šæ¥å£ç”¨äºç»™å‡ºæ–¹æ³•çš„å…¥å‚ä»¥åŠè¿”å›å€¼ï¼ŒXMLç»™å‡ºSQLè¯­å¥å’Œæ˜ å°„è§„åˆ™ã€‚æ˜ å°„å™¨çš„ä¸»è¦ä½œç”¨å°±æ˜¯å°†SQLæŸ¥è¯¢åˆ°çš„ç»“æœæ˜ å°„ä¸ºä¸€ä¸ªPOJOï¼Œæˆ–è€…å°†POJOçš„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“ä¸­</p></li></ul><p>æ³¨æ„ï¼Œæ— è®ºæ˜¯æ˜ å°„å™¨è¿˜æ˜¯SqlSessionéƒ½å¯ä»¥å‘é€SQLåˆ°æ•°æ®åº“æ‰§è¡Œï¼Œä½†æ˜¯ä¸ºäº†ä¿è¯ä»£ç çš„å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ï¼Œæ¨èä½¿ç”¨Mapperæ¥å£ç¼–ç¨‹æ¥å®Œæˆè¯¥æ“ä½œã€‚</p><h2 id="ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ"><a href="#ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ"></a>ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ</h2><h3 id="SqlSessionFactoryBuilder"><a href="#SqlSessionFactoryBuilder" class="headerlink" title="SqlSessionFactoryBuilder"></a>SqlSessionFactoryBuilder</h3><p>è¿™ä¸ªç±»å¯ä»¥è¢«å®ä¾‹åŒ–ã€ä½¿ç”¨å’Œä¸¢å¼ƒï¼Œä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚å› æ­¤ SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯å±€éƒ¨æ–¹æ³•å˜é‡ï¼‰ã€‚ä½ å¯ä»¥é‡ç”¨ SqlSessionFactoryBuilder æ¥åˆ›å»ºå¤šä¸ª SqlSessionFactory å®ä¾‹ï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯ä¸è¦è®©å…¶ä¸€ç›´å­˜åœ¨ä»¥ä¿è¯æ‰€æœ‰çš„ XML è§£æèµ„æºå¼€æ”¾ç»™æ›´é‡è¦çš„äº‹æƒ…ã€‚</p><h3 id="SqlSessionFactory"><a href="#SqlSessionFactory" class="headerlink" title="SqlSessionFactory"></a>SqlSessionFactory</h3><p>SqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±å¯¹å®ƒè¿›è¡Œæ¸…é™¤æˆ–é‡å»ºã€‚ä½¿ç”¨ SqlSessionFactory çš„æœ€ä½³å®è·µæ˜¯åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸è¦é‡å¤åˆ›å»ºå¤šæ¬¡ï¼Œå¤šæ¬¡é‡å»º SqlSessionFactory è¢«è§†ä¸ºä¸€ç§ä»£ç â€œåå‘³é“ï¼ˆbad smellï¼‰â€ã€‚å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚</p><h3 id="SqlSession"><a href="#SqlSession" class="headerlink" title="SqlSession"></a>SqlSession</h3><p>æ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚ç»å¯¹ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä¸€ä¸ªç±»çš„é™æ€åŸŸï¼Œç”šè‡³ä¸€ä¸ªç±»çš„å®ä¾‹å˜é‡ä¹Ÿä¸è¡Œã€‚ä¹Ÿç»ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä»»ä½•ç±»å‹çš„ç®¡ç†ä½œç”¨åŸŸä¸­ï¼Œæ¯”å¦‚ Servlet æ¶æ„ä¸­çš„ HttpSessionã€‚å¦‚æœä½ ç°åœ¨æ­£åœ¨ä½¿ç”¨ä¸€ç§ Web æ¡†æ¶ï¼Œè¦è€ƒè™‘ SqlSession æ”¾åœ¨ä¸€ä¸ªå’Œ HTTP è¯·æ±‚å¯¹è±¡ç›¸ä¼¼çš„ä½œç”¨åŸŸä¸­ã€‚æ¢å¥è¯è¯´ï¼Œæ¯æ¬¡æ”¶åˆ°çš„ HTTP è¯·æ±‚ï¼Œå°±å¯ä»¥æ‰“å¼€ä¸€ä¸ª SqlSessionï¼Œè¿”å›ä¸€ä¸ªå“åº”ï¼Œå°±å…³é—­å®ƒã€‚è¿™ä¸ªå…³é—­æ“ä½œæ˜¯å¾ˆé‡è¦çš„ï¼Œä½ åº”è¯¥æŠŠè¿™ä¸ªå…³é—­æ“ä½œæ”¾åˆ° finally å—ä¸­ä»¥ç¡®ä¿æ¯æ¬¡éƒ½èƒ½æ‰§è¡Œå…³é—­ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°±æ˜¯ä¸€ä¸ªç¡®ä¿ SqlSession å…³é—­çš„æ ‡å‡†æ¨¡å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">try &#123;</span><br><span class="line">  // do work</span><br><span class="line">&#125; finally &#123;</span><br><span class="line">  session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ˜ å°„å™¨å®ä¾‹ï¼ˆMapper-Instancesï¼‰"><a href="#æ˜ å°„å™¨å®ä¾‹ï¼ˆMapper-Instancesï¼‰" class="headerlink" title="æ˜ å°„å™¨å®ä¾‹ï¼ˆMapper Instancesï¼‰"></a>æ˜ å°„å™¨å®ä¾‹ï¼ˆMapper Instancesï¼‰</h3><p>æ˜ å°„å™¨æ˜¯ä¸€ä¸ªä½ åˆ›å»ºæ¥ç»‘å®šä½ æ˜ å°„çš„è¯­å¥çš„æ¥å£ã€‚æ˜ å°„å™¨æ¥å£çš„å®ä¾‹æ˜¯ä» SqlSession ä¸­è·å¾—çš„ã€‚å› æ­¤ä»æŠ€æœ¯å±‚é¢è®²ï¼Œä»»ä½•æ˜ å°„å™¨å®ä¾‹çš„æœ€å¤§ä½œç”¨åŸŸæ˜¯å’Œè¯·æ±‚å®ƒä»¬çš„ SqlSession ç›¸åŒçš„ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæ˜ å°„å™¨å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜ å°„å™¨å®ä¾‹åº”è¯¥åœ¨è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•ä¸­è¢«è¯·æ±‚ï¼Œç”¨è¿‡ä¹‹åå³å¯åºŸå¼ƒã€‚å¹¶ä¸éœ€è¦æ˜¾å¼åœ°å…³é—­æ˜ å°„å™¨å®ä¾‹ï¼Œå°½ç®¡åœ¨æ•´ä¸ªè¯·æ±‚ä½œç”¨åŸŸï¼ˆrequest scopeï¼‰ä¿æŒæ˜ å°„å™¨å®ä¾‹ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¾ˆå¿«ä½ ä¼šå‘ç°ï¼Œåƒ SqlSession ä¸€æ ·ï¼Œåœ¨è¿™ä¸ªä½œç”¨åŸŸä¸Šç®¡ç†å¤ªå¤šçš„èµ„æºçš„è¯ä¼šéš¾äºæ§åˆ¶ã€‚æ‰€ä»¥è¦ä¿æŒç®€å•ï¼Œæœ€å¥½æŠŠæ˜ å°„å™¨æ”¾åœ¨æ–¹æ³•ä½œç”¨åŸŸï¼ˆmethod scopeï¼‰å†…ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°±å±•ç¤ºäº†è¿™ä¸ªå®è·µï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">try &#123;</span><br><span class="line">  BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">  // do work</span><br><span class="line">&#125; finally &#123;</span><br><span class="line">  session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h2 id="å¦‚ä½•ä½¿ç”¨MyBatis"><a href="#å¦‚ä½•ä½¿ç”¨MyBatis" class="headerlink" title="å¦‚ä½•ä½¿ç”¨MyBatis"></a>å¦‚ä½•ä½¿ç”¨MyBatis</h2><p>é¦–å…ˆï¼Œåœ¨MyBatisä¸­æœ‰ä¸¤ç§XMLé…ç½®æ–‡ä»¶ï¼Œä¸€ç§æ˜¯åŸºç¡€é…ç½®æ–‡ä»¶ï¼Œå®ƒåªæœ‰ä¸€ä¸ªï¼Œç”¨äºé…ç½®ä¸€äº›MyBatisçš„ä¸Šä¸‹æ–‡å‚æ•°å’Œè¿è¡Œç¯å¢ƒï¼›å¦ä¸€ç§æ˜¯æ˜ å°„å™¨çš„XMLæ˜ å°„æ–‡ä»¶ï¼Œå®ƒå¯ä»¥é…ç½®æ˜ å°„å…³ç³»ï¼ŒSQLç­‰ç­‰ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨ä½¿ç”¨MyBatisçš„æ—¶å€™ï¼Œå…ˆç»™å‡ºMyBatisçš„é…ç½®æ–‡ä»¶ç”¨äºç”ŸæˆSqlSessionï¼Œç„¶åå†ç»™å‡ºæ˜ å°„å™¨Mapperçš„æ¥å£ä¸ç›¸åº”çš„æ˜ å°„XMLæ–‡ä»¶ï¼Œæœ€åå°±å¯ä»¥ç”ŸæˆMapperæ¥å£çš„åŠ¨æ€ä»£ç†ç±»æ¥å‘é€SQLè·å–ç»“æœäº†ã€‚</p><p><img src="/images/MyBatis.png" alt=""></p><hr><h2 id="æ˜ å°„å™¨"><a href="#æ˜ å°„å™¨" class="headerlink" title="æ˜ å°„å™¨"></a>æ˜ å°„å™¨</h2><p>æ˜ å°„å™¨æ˜¯mybatisæœ€æ ¸å¿ƒçš„ç»„ä»¶ï¼Œå®ƒç”±ä¸€ä¸ªæ¥å£åŠ ä¸Šxmlæ–‡ä»¶ç»„æˆã€‚åœ¨æ˜ å°„å™¨ä¸­å¯ä»¥é…ç½®å‚æ•°ï¼Œå„ç±»çš„SQLè¯­å¥ï¼Œç¼“å­˜ï¼Œçº§è”ç­‰å†…å®¹ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡æ˜ å°„è§„åˆ™æ˜ å°„åˆ°æŒ‡å®šçš„POJOä¸Šã€‚æ˜ å°„å™¨çš„æ¥å£ä¸æ˜ å°„xmlæ–‡ä»¶é…ç½®ä½¿ç”¨ï¼Œå¯ä»¥æœ‰æ•ˆçš„æ¶ˆé™¤jdbcåº•å±‚ä»£ç ã€‚</p><p>æ˜ å°„å™¨çš„æ˜ å°„xmlæ–‡ä»¶æœ‰ä»¥ä¸‹å‡ ä¸ªå…ƒç´ ï¼š</p><ul><li>cache â€“ ç»™å®šå‘½åç©ºé—´çš„ç¼“å­˜é…ç½®</li><li>cache-ref â€“ å…¶ä»–å‘½åç©ºé—´ç¼“å­˜é…ç½®çš„å¼•ç”¨</li><li>resultMap â€“ æè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­æ¥åŠ è½½å¯¹è±¡ï¼Œå®ƒå°†æä¾›æ˜ å°„è§„åˆ™</li><li>sql â€“ å¯è¢«å…¶ä»–è¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯­å¥å—ï¼Œå¯ä»¥å®šä¹‰ä¸€éƒ¨åˆ†SQLï¼Œç„¶ååœ¨å…¶ä»–åœ°æ–¹å¼•ç”¨</li><li>insert â€“ æ˜ å°„æ’å…¥è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ’å…¥çš„æ¡æ•°</li><li>update â€“ æ˜ å°„æ›´æ–°è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ›´æ–°çš„æ¡æ•°</li><li>delete â€“ æ˜ å°„åˆ é™¤è¯­å¥ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨åˆ é™¤çš„æ¡æ•°</li><li>select â€“ æ˜ å°„æŸ¥è¯¢è¯­å¥ï¼Œè¿”å›æŸ¥è¯¢ç»“æœ</li></ul><h2 id="selectå…ƒç´ "><a href="#selectå…ƒç´ " class="headerlink" title="selectå…ƒç´ "></a>selectå…ƒç´ </h2><p>æ˜ å°„å™¨ä¸­çš„selectå…ƒç´ ä»£è¡¨SQLçš„selectè¯­å¥ï¼Œç”¨äºæŸ¥è¯¢ã€‚selectå…ƒç´ ä¸­æœ‰ä»¥ä¸‹å¸¸ç”¨çš„å±æ€§ï¼š</p><ul><li>id:åœ¨Mapperçš„å‘½åç©ºé—´ä¸­å”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚Mapperçš„å‘½åç©ºé—´ä¸selectå…ƒç´ çš„idå°†å”¯ä¸€å®šä½å¯¹åº”çš„æ˜ å°„å™¨æ¥å£çš„æŸä¸ªæ–¹æ³•ã€‚</li><li>parameterTypeï¼šå°†ä¼šä¼ å…¥è¿™æ¡è¯­å¥çš„å‚æ•°ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åï¼Œå¯ä»¥é€‰æ‹©Java Beanï¼ŒMapç­‰å‚æ•°ç±»å‹ä¼ é€’ç»™SQLã€‚è¿™ä¸ªå±æ€§æ˜¯å¯é€‰çš„ï¼Œmybatiså¯ä»¥é€šè¿‡TypeHandleræ¨æ–­å‡ºå…·ä½“ä¼ å…¥è¯­å¥çš„å‚æ•°ã€‚</li><li>resultTypeï¼šä»è¿™æ¡è¯­å¥ä¸­è¿”å›çš„æœŸæœ›ç±»å‹çš„ç±»çš„å®Œå…¨é™å®šåæˆ–åˆ«åã€‚æ³¨æ„å¦‚æœæ˜¯é›†åˆæƒ…å½¢ï¼Œé‚£åº”è¯¥æ˜¯é›†åˆå¯ä»¥åŒ…å«çš„ç±»å‹ï¼Œè€Œä¸èƒ½æ˜¯é›†åˆæœ¬èº«ã€‚</li><li>resultMapï¼šæ˜ å°„é›†çš„å¼•ç”¨ï¼Œç”¨äºç»“æœé›†çš„æ˜ å°„ï¼Œå®Œæˆç»“æœçš„æ˜ å°„åŠŸèƒ½ã€‚æ³¨æ„resultTypeå’ŒresultMapä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚</li><li>flushCacheï¼šå°†å…¶è®¾ç½®ä¸ºtrueï¼Œä»»ä½•æ—¶å€™åªè¦è¯­å¥è¢«è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´æœ¬åœ°ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºï¼Œé»˜è®¤å€¼ï¼šfalseã€‚</li><li>useCacheï¼šå°†å…¶è®¾ç½®ä¸ºtrueï¼Œå°†ä¼šå¯¼è‡´æœ¬æ¡è¯­å¥çš„ç»“æœè¢«äºŒçº§ç¼“å­˜ï¼Œé»˜è®¤å€¼ï¼šå¯¹selectå…ƒç´ ä¸ºtrueã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getPerson&quot; parameterType=&quot;int&quot; resultType=&quot;mybatis.spring.test.pojo.Person&quot;&gt;</span><br><span class="line">    SELECT name,age,tel,id from t_person WHERE id = #&#123;id&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public Person getPerson(@Param(&quot;id&quot;) int id);</span><br></pre></td></tr></table></figure><p>mybatisæä¾›çš„è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼Œåªè¦SQLçš„åˆ—åä¸POJOçš„å±æ€§åä¿æŒä¸€è‡´ï¼ŒåŒæ—¶åœ¨mybatisçš„é…ç½®æ–‡ä»¶ä¸­settingså…ƒç´ çš„autoMappingBehavioræ˜¯å¼€å¯çš„(é»˜è®¤æ˜¯å¼€å¯)å³å¯å®Œæˆè‡ªåŠ¨æ˜ å°„ã€‚å¦‚æœåˆ—åä¸å±æ€§åä¸ä¸€è‡´çš„è¯ï¼Œè¿˜å¯ä»¥é€šè¿‡SQLçš„åˆ«åæœºåˆ¶æ¥å¤„ç†ã€‚æ¯”å¦‚è¯´ï¼Œå‡å¦‚åŸæ¥åˆ—åä¸ºperson_nameï¼Œå±æ€§åä¸ºpersonNameï¼Œé‚£ä¹ˆåœ¨SQLä¸­å°±å¯ä»¥è¿™ä¹ˆå†™ï¼šselect person_name as personName â€¦ è¿™æ ·åŒæ ·å¯ä»¥å®Œæˆè‡ªåŠ¨æ˜ å°„ã€‚</p><p>è¿™é‡Œç‰¹åˆ«è¯´æ˜å…³äºselectå…ƒç´ è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–è€…å¯¹è±¡é›†åˆçš„é—®é¢˜ï¼š</p><ol><li>è¿”å›æ•°æ®ç±»å‹ç”±DAOä¸­çš„æ¥å£å’Œæ˜ å°„xmlæ–‡ä»¶å…±åŒå†³å®šã€‚å¦å¤–ï¼Œä¸è®ºæ˜¯è¿”å›å•ä¸€å¯¹è±¡è¿˜æ˜¯å¯¹è±¡åˆ—è¡¨ï¼Œæ˜ å°„xmlä¸­çš„é…ç½®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯resultType=â€œ . .â€ç±»å‹æˆ–resultMap=â€resultMap-refâ€*ã€‚</li><li>æ¯ä¸€æ¬¡mybatisä»æ•°æ®åº“ä¸­selectæ•°æ®ä¹‹åï¼Œéƒ½ä¼šæ£€æŸ¥æ•°æ®æ¡æ•°å’ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯å¦åŒ¹é…ã€‚</li><li>è‹¥è¿”å›ä¸€æ¡æ•°æ®ï¼ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å¯¹è±¡çš„Liståˆ—è¡¨ï¼Œåˆ™å¯ä»¥æ­£å¸¸åŒ¹é…ï¼Œå°†æŸ¥è¯¢çš„æ•°æ®æŒ‰ç…§DAOä¸­å®šä¹‰çš„è¿”å›å€¼å­˜æ”¾ã€‚</li><li>è‹¥è¿”å›å¤šæ¡æ•°æ®ï¼ŒDAOä¸­å®šä¹‰çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™æ— æ³•å°†å¤šæ¡æ•°æ®æ˜ å°„ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶mybatisæŠ¥é”™ã€‚</li></ol><h2 id="resultMapå…ƒç´ "><a href="#resultMapå…ƒç´ " class="headerlink" title="resultMapå…ƒç´ "></a>resultMapå…ƒç´ </h2><p>é€šè¿‡resultTypeåŠ ä¸Šmybatisçš„è‡ªåŠ¨æ˜ å°„å¯ä»¥åº”å¯¹å¤§å¤šæ•°çš„ç»“æœé›†çš„æ˜ å°„éœ€æ±‚ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æ— æ³•å®šä¹‰æ›´å¤šçš„å±æ€§ï¼Œæ¯”å¦‚typeHandlerï¼Œçº§è”ç­‰ã€‚ä¸ºäº†æ”¯æŒæ›´åŠ å¤æ‚çš„æ˜ å°„ï¼Œmybatisæä¾›äº†resultMapå±æ€§æ¥å®ŒæˆSQLåˆ°Java Beançš„æ˜ å°„å…³ç³»å®šä¹‰ã€‚æ¥ä¸‹æ¥ï¼Œç”¨resulyMapæ”¹å†™ä¹‹å‰ä½¿ç”¨è‡ªåŠ¨æ˜ å°„çš„selectå…ƒç´ ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap id = &quot;Map&quot; type = &quot;mybatis.spring.test.pojo.Person&quot;&gt;</span><br><span class="line">&lt;id property=&quot;id&quot; column=&quot;id&quot;&gt;</span><br><span class="line">&lt;result property=&quot;name&quot; column=&quot;name&quot;&gt;</span><br><span class="line">&lt;result property=&quot;age&quot; column=&quot;age&quot;&gt;</span><br><span class="line">&lt;result property=&quot;tel&quot; column=&quot;tel&quot;&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">   &lt;select id=&quot;getPerson&quot; parameterType=&quot;int&quot; resultMap=&quot;Map&quot;&gt;</span><br><span class="line">       SELECT name,age,tel,id from t_person WHERE id = #&#123;id&#125;</span><br><span class="line">   &lt;/select&gt;</span><br></pre></td></tr></table></figure><p>å­å…ƒç´ idä»£è¡¨ä¸»é”®ï¼Œresultä»£è¡¨å±æ€§ï¼Œidå’Œresultå…ƒç´ çš„propertyå±æ€§ä»£è¡¨POJOçš„å±æ€§åç§°ï¼Œcolumnä»£è¡¨SQLçš„åˆ—åï¼Œè¿™æ ·å°±å°†POJOçš„å±æ€§å’ŒSQLçš„åˆ—åè¿›è¡Œä¸€ä¸€å¯¹åº”äº†ã€‚</p><p>ä¸€ä¸ªå®Œæ•´çš„resultMapå…ƒç´ çš„æ„æˆæœ‰å“ªäº›ï¼Ÿ</p><ul><li>constructorï¼šç±»åœ¨å®ä¾‹åŒ–æ—¶,ç”¨æ¥æ³¨å…¥ç»“æœåˆ°æ„é€ æ–¹æ³•ä¸­</li><li>idï¼šè¡¨ç¤ºå“ªä¸ªåˆ—æ˜¯ä¸»é”®</li><li>resultï¼šæ³¨å…¥åˆ°JavaBeanå±æ€§çš„æ™®é€šç»“æœï¼Œé…ç½®POJOåˆ°SQLåˆ—åçš„æ˜ å°„å…³ç³»</li><li>associationï¼šä¸€ä¸ªå¤æ‚çš„ç±»å‹å…³è”;è®¸å¤šç»“æœå°†åŒ…æˆè¿™ç§ç±»å‹</li><li>collectionï¼šå¤æ‚ç±»å‹çš„é›†</li><li>discriminatorï¼šä½¿ç”¨ç»“æœå€¼æ¥å†³å®šä½¿ç”¨å“ªä¸ªç»“æœæ˜ å°„</li></ul><p>constructorå…ƒç´ ç”¨äºé…ç½®æ„é€ æ–¹æ³•ï¼Œä¸€ä¸ªPOJOå¯èƒ½ä¸å­˜åœ¨æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œå°±è¦ä½¿ç”¨construtorå…ƒç´ æ¥é…ç½®äº†ã€‚</p><p>idå…ƒç´ ï¼Œresultå…ƒç´ ä¸»è¦æ¥å®šä¹‰POJOä¸SQLåˆ—åçš„æ˜ å°„è§„åˆ™ï¼Œå®ƒä»¬æœ‰å¦‚ä¸‹å±æ€§ï¼š</p><ul><li>property:æ˜ å°„è§„åˆ™ä¸­çš„POJOçš„å±æ€§åï¼Œå¯ä»¥ç”¨å¯¼èˆªå¼å­—æ®µï¼Œä¾‹å¦‚éœ€è¦è®¿é—®Personç±»çš„Addresså±æ€§çš„idï¼Œå°±å¯ä»¥å†™æˆAddress . id</li><li>columnï¼šå¯¹åº”çš„SQLçš„åˆ—å</li><li>javaTypeï¼šJavaç±»å‹</li><li>jdbcTypeï¼šæ•°æ®åº“ç±»å‹</li><li>typeHandlerï¼šç±»å‹å¤„ç†å™¨ï¼Œå…è®¸ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨</li></ul><p>å…¶ä¸­associationï¼Œcollectionå’Œdiscriminatorè¿™äº›å…ƒç´ æ˜¯ä¸ç»“æœæ˜ å°„çš„çº§è”ç›¸å…³çš„ã€‚Mybatisæ”¯æŒçº§è”æ˜ å°„ï¼Œç®€å•æ¥è¯´ï¼Œå‡å¦‚æˆ‘ä»¬selectä¸€ä¸ªpersonç±»ï¼Œpersonç±»æœ‰ä¸€ä¸ªå±æ€§ä¸ºaddressï¼Œaddressä¹Ÿæ˜¯ä¸€ä¸ªPOJOï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦å†è¿›è¡Œä¸€æ¬¡selectæ‰èƒ½æŸ¥è¯¢åˆ°addressç±»çš„ä¿¡æ¯ã€‚è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œçº§è”ä¸æ˜¯å¿…é¡»çš„ï¼Œçº§è”å¯ä»¥ä¾¿æ·çš„è·å–å…³è”æ•°æ®ï¼Œä½†æ˜¯å¦‚æœçº§è”å¤ªå¤šçš„è¯ä¼šå½±å“æ‰§è¡Œæ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯è‘—åçš„N+1é—®é¢˜(å¦‚æœæœ‰Nä¸ªå…³è”å…³ç³»å®Œæˆäº†çº§è”ï¼Œé‚£ä¹ˆåªè¦å†åŠ å…¥ä¸€ä¸ªå…³è”å…³ç³»ï¼Œå°±å˜æˆäº†N+1ä¸ªï¼Œæ‰€æœ‰çš„çº§è”SQLéƒ½ä¼šè¢«æ‰§è¡Œï¼Œæ˜¾ç„¶ä¸æ˜¯æ‰€æœ‰æ•°æ®æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„ï¼Œé€ æˆäº†èµ„æºçš„æµªè´¹ä¸æ€§èƒ½çš„æµªè´¹)ã€‚ä¸ºäº†åº”å¯¹çº§è”ä¸­çš„N+1é—®é¢˜ï¼Œmybatisæ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œåœ¨selectçš„æ—¶å€™å¹¶ä¸æ˜¯ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰çš„SQLç»“æœæ¥æ˜ å°„ï¼Œå¯¹äºé‚£äº›ä¸å¸¸ç”¨çš„çº§è”æ•°æ®ç­‰åˆ°éœ€è¦çš„æ—¶å€™å†å–å‡ºã€‚åœ¨mybatisçš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¯ä»¥è®¾å®šå»¶è¿ŸåŠ è½½å±æ€§ï¼ŒåŒæ—¶åœ¨çº§è”å…ƒç´ associationå’Œcollectionä¸­çš„fetchTypeå±æ€§ä¹Ÿå¯ä»¥å®šä¹‰å»¶è¿ŸåŠ è½½ã€‚</p><h2 id="insert-update-delete"><a href="#insert-update-delete" class="headerlink" title="insert,update,delete"></a>insert,update,delete</h2><p>ç›¸æ¯”äºselectæ¥è¯´ï¼Œinsert,update,deleteå°±å¾ˆç®€å•äº†ï¼Œå®ƒä»¬æ‰§è¡Œçš„ç»“æœè¿”å›çš„æ˜¯æ•´æ•°ï¼Œç”¨ä»¥æ ‡è¯†è¯¥SQLè¯­å¥å½±å“äº†æ•°æ®åº“çš„è®°å½•è¡Œæ•°ï¼Œä¸éœ€è¦è¿›è¡Œç»“æœé›†çš„æ˜ å°„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œinsertå…ƒç´ æ˜¯æ”¯æŒä¸»é”®å›å¡«çš„ï¼Œåœ¨inserè¯­å¥ä¸­æœ‰ä¸€ä¸ªå±æ€§useGeneratedKeysï¼Œç”¨æ¥æ§åˆ¶æ˜¯å¦ä½¿ç”¨æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®æ¥å›å¡«åˆ°POJOï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚å½“æ‰“å¼€äº†ä¸»é”®å›å¡«ä¹‹åï¼Œè¿˜è¦é…ç½®keyPropertyæˆ–è€…keyColumnï¼Œå‘Šè¯‰mybatisæŠŠç”Ÿæˆçš„ä¸»é”®æ”¾å…¥å“ªä¸ªå±æ€§ä¸­ã€‚è‡³äºåœ¨å®é™…ä¸­ç”¨ä¸ç”¨å¾—åˆ°æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®ï¼Œæˆ‘ä¹Ÿä¸èƒ½å®Œå…¨è‚¯å®šï¼Œè¿™é‡Œåªè¦çŸ¥é“mybatisæ˜¯æ”¯æŒä¸»é”®å›å¡«çš„å³å¯ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆå®¹æ˜“ã€‚</p><h2 id="sqlå…ƒç´ "><a href="#sqlå…ƒç´ " class="headerlink" title="sqlå…ƒç´ "></a>sqlå…ƒç´ </h2><p>è¿™ä¸ªå…ƒç´ å¯ä»¥è¢«ç”¨æ¥å®šä¹‰å¯é‡ç”¨çš„SQLä»£ç æ®µï¼Œå¯ä»¥åŒ…å«åœ¨å…¶ä»–è¯­å¥ä¸­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;sql id=&quot;userColumns&quot;&gt; $&#123;alias&#125;.id,$&#123;alias&#125;.username,$&#123;alias&#125;.password &lt;/sql&gt;</span><br><span class="line">&lt;select id=&quot;selectUsers&quot; resultType=&quot;map&quot;&gt;</span><br><span class="line">  select</span><br><span class="line">    &lt;include refid=&quot;userColumns&quot;&gt;&lt;property name=&quot;alias&quot; value=&quot;t1&quot;/&gt;&lt;/include&gt;,</span><br><span class="line">    &lt;include refid=&quot;userColumns&quot;&gt;&lt;property name=&quot;alias&quot; value=&quot;t2&quot;/&gt;&lt;/include&gt;</span><br><span class="line">  from some_table t1</span><br><span class="line">    cross join some_table t2</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€SQL"><a href="#åŠ¨æ€SQL" class="headerlink" title="åŠ¨æ€SQL"></a>åŠ¨æ€SQL</h2><p>mybatisæä¾›äº†å¯¹SQLè¯­å¥åŠ¨æ€çš„ç»„è£…èƒ½åŠ›ï¼Œå¤§é‡çš„åˆ¤æ–­éƒ½å¯ä»¥åœ¨mybatisçš„æ˜ å°„xmlé‡Œé¢é…ç½®ï¼Œå¤§å¤§å‡å°‘äº†ä»£ç é‡ï¼Œæä¾›äº†çµæ´»æ€§ã€‚<br><img src="/images/MyBatis2.png" alt=""></p><h2 id="if"><a href="#if" class="headerlink" title="if"></a>if</h2><p>ifå…ƒç´ ä½¿ç”¨çš„åœºæ™¯é€‚ç”¨äºåœ¨SQLè¯­å¥çš„whereå­å¥ä¸­åŠ¨æ€åœ°é€‰æ‹©æŸå‡ ä¸ªåˆ¤æ–­æ¡ä»¶ä½œä¸ºSQLè¯­å¥çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‹¼æ¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findActiveBlogWithTitleLike&quot;</span><br><span class="line">     resultType=&quot;Blog&quot;&gt;</span><br><span class="line">  SELECT * FROM BLOG </span><br><span class="line">  WHERE state = â€˜ACTIVEâ€™ </span><br><span class="line">  &lt;if test=&quot;title != null&quot;&gt;</span><br><span class="line">    AND title like #&#123;title&#125;</span><br><span class="line">  &lt;/if&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¼ å…¥çš„å‚æ•°titleä¸æ˜¯nullï¼Œé‚£ä¹ˆå°±å°† AND title like #{title} è¿™å­å¥æ‹¼æ¥åœ¨whereä¹‹åï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ¡ä»¶åœ°åŒ…å«whereå­å¥çš„ä¸€éƒ¨åˆ†ã€‚</p><h2 id="choose-when-otherwise"><a href="#choose-when-otherwise" class="headerlink" title="choose(when,otherwise)"></a>choose(when,otherwise)</h2><p>ifå…ƒç´ æ˜¯å•æ¡ä»¶çš„ï¼Œchooseå…ƒç´ å°±æ˜¯å¤šæ¡ä»¶çš„é€‰æ‹©ç±»ä¼¼javaé‡Œçš„switchè¯­å¥ï¼ŒåŸç†ä¸€æ ·ï¼Œè¿˜æ˜¯æ¥ç€ä¸Šé¢çš„ä¾‹å­æ¥ä¸¾ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findActiveBlogLike&quot;</span><br><span class="line">     resultType=&quot;Blog&quot;&gt;</span><br><span class="line">  SELECT * FROM BLOG WHERE state = â€˜ACTIVEâ€™</span><br><span class="line">  &lt;choose&gt;</span><br><span class="line">    &lt;when test=&quot;title != null&quot;&gt;</span><br><span class="line">      AND title like #&#123;title&#125;</span><br><span class="line">    &lt;/when&gt;</span><br><span class="line">    &lt;when test=&quot;author != null and author.name != null&quot;&gt;</span><br><span class="line">      AND author_name like #&#123;author.name&#125;</span><br><span class="line">    &lt;/when&gt;</span><br><span class="line">    &lt;otherwise&gt;</span><br><span class="line">      AND featured = 1</span><br><span class="line">    &lt;/otherwise&gt;</span><br><span class="line">  &lt;/choose&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å‚è€ƒæ–‡æ¡£ä¸­çš„ä¾‹å­otherwiseå…ƒç´ å†™çš„æ˜¯ AND featured = 1 æ˜¯ä¸ºäº†è§£å†³å‰é¢çš„æ‰€æœ‰caseéƒ½ä¸æ»¡è¶³çš„æƒ…å†µï¼Œæˆ‘å»ºè®®å†™æˆ AND 1 = 1 æ›´å¥½ç†è§£ã€‚<br>è¯¥åŠ¨æ€SQLè¯­å¥çš„åŠŸèƒ½ï¼šå¦‚æœå‚æ•°æä¾›äº†â€œtitleâ€å°±æŒ‰â€œtitleâ€æŸ¥æ‰¾ï¼Œæä¾›äº†â€œauthorâ€å°±æŒ‰â€œauthorâ€æŸ¥æ‰¾ï¼Œè‹¥ä¸¤è€…éƒ½æ²¡æœ‰æä¾›ï¼Œå°±è¿”å›æ‰€æœ‰ç¬¦åˆé»˜è®¤æ¡ä»¶çš„æŸ¥è¯¢ç»“æœé›†ã€‚</p><h2 id="trim-where-set"><a href="#trim-where-set" class="headerlink" title="trim(where,set)"></a>trim(where,set)</h2><p>å‰é¢çš„ä¾‹å­ä¸­çš„whereå­å¥æ€»ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æŸ¥è¯¢æ¡ä»¶ä¹Ÿå°±æ˜¯ä¾‹å­ä¸­çš„ state = â€˜ACTIVEâ€™ ï¼Œå¦‚æœstateä¹Ÿè®¾ç½®æˆåŠ¨æ€çš„å‘¢ï¼Ÿå¯ä»¥é€šè¿‡where,setå…ƒç´ æ¥è¾¾åˆ°è¿™ä¸ªéœ€æ±‚ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findActiveBlogLike&quot;</span><br><span class="line">     resultType=&quot;Blog&quot;&gt;</span><br><span class="line">  SELECT * FROM BLOG </span><br><span class="line">  &lt;where&gt; </span><br><span class="line">    &lt;if test=&quot;state != null&quot;&gt;</span><br><span class="line">         state = #&#123;state&#125;</span><br><span class="line">    &lt;/if&gt; </span><br><span class="line">    &lt;if test=&quot;title != null&quot;&gt;</span><br><span class="line">        AND title like #&#123;title&#125;</span><br><span class="line">    &lt;/if&gt;</span><br><span class="line">    &lt;if test=&quot;author != null and author.name != null&quot;&gt;</span><br><span class="line">        AND author_name like #&#123;author.name&#125;</span><br><span class="line">    &lt;/if&gt;</span><br><span class="line">  &lt;/where&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><p>åŒæ ·å¦‚æœæ˜¯updateå­å¥ï¼Œé‚£ä¹ˆä¹Ÿå°±ç›¸åº”çš„setå…ƒç´ ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;update id=&quot;updateAuthorIfNecessary&quot;&gt;</span><br><span class="line">  update Author</span><br><span class="line">    &lt;set&gt;</span><br><span class="line">      &lt;if test=&quot;username != null&quot;&gt;username=#&#123;username&#125;,&lt;/if&gt;</span><br><span class="line">      &lt;if test=&quot;password != null&quot;&gt;password=#&#123;password&#125;,&lt;/if&gt;</span><br><span class="line">      &lt;if test=&quot;email != null&quot;&gt;email=#&#123;email&#125;,&lt;/if&gt;</span><br><span class="line">      &lt;if test=&quot;bio != null&quot;&gt;bio=#&#123;bio&#125;&lt;/if&gt;</span><br><span class="line">    &lt;/set&gt;</span><br><span class="line">  where id=#&#123;id&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœwhere,setéƒ½æ— æ³•æ»¡è¶³åŠ¨æ€æ‹¼æ¥SQLçš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨trimæ¥è‡ªå®šä¹‰å¦‚ä½•æ‹¼æ¥SQLå­å¥ï¼Œwhereå’Œsetåªæ˜¯mybatiså®šä¹‰å¥½çš„æ‹¼æ¥SQLçš„æ–¹æ³•è€Œå·²ï¼Œä½†è¿™ä¹Ÿå·²ç»å¯ä»¥æ»¡è¶³å¤§å¤šæ•°éœ€æ±‚äº†ã€‚</p><h2 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h2><p>åŠ¨æ€ SQL çš„å¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„å¿…è¦æ“ä½œæ˜¯éœ€è¦å¯¹ä¸€ä¸ªé›†åˆè¿›è¡Œéå†ï¼Œé€šå¸¸æ˜¯åœ¨æ„å»º IN æ¡ä»¶è¯­å¥çš„æ—¶å€™ã€‚è¿˜æ˜¯å‚è€ƒæ–‡æ¡£é‡Œä¹°çš„ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;selectPostIn&quot; resultType=&quot;domain.blog.Post&quot;&gt;</span><br><span class="line">  SELECT *</span><br><span class="line">  FROM POST P</span><br><span class="line">  WHERE ID in</span><br><span class="line">  &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;list&quot;</span><br><span class="line">      open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</span><br><span class="line">        #&#123;item&#125;</span><br><span class="line">  &lt;/foreach&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><p>foreachå…ƒç´ å…è®¸æŒ‡å®šä¸€ä¸ªé›†åˆï¼Œå£°æ˜å¯ä»¥ç”¨åœ¨å…ƒç´ ä½“å†…çš„é›†åˆé¡¹å’Œç´¢å¼•å˜é‡ï¼Œä¹Ÿå…è®¸ä½ æŒ‡å®šå¼€é—­åŒ¹é…çš„å­—ç¬¦ä¸²ä»¥åŠåœ¨è¿­ä»£ä¸­é—´æ”¾ç½®åˆ†éš”ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€é›†åˆç­‰ï¼‰å’Œä»»ä½•çš„å­—å…¸æˆ–è€…æ•°ç»„å¯¹è±¡ä¼ é€’ç»™foreachä½œä¸ºé›†åˆå‚æ•°ã€‚å½“ä½¿ç”¨å¯è¿­ä»£å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œindexæ˜¯å½“å‰è¿­ä»£çš„æ¬¡æ•°ï¼Œitemçš„å€¼æ˜¯æœ¬æ¬¡è¿­ä»£è·å–çš„å…ƒç´ ã€‚å½“ä½¿ç”¨å­—å…¸ï¼ˆæˆ–è€…Map.Entryå¯¹è±¡çš„é›†åˆï¼‰æ—¶ï¼Œindexæ˜¯é”®ï¼Œitemæ˜¯å€¼ã€‚</p><h3 id="å’Œ"><a href="#å’Œ" class="headerlink" title="#{}å’Œ${}"></a>#{}å’Œ${}</h3><p>#{}è¡¨ç¤ºä¸€ä¸ªå ä½ç¬¦å·ï¼Œç”¨æ¥ä¼ å…¥å‚æ•°ï¼Œsqlåœ¨è§£æçš„æ—¶å€™ä¼šåŠ ä¸Šâ€ â€œ,å½“æˆå­—ç¬¦ä¸²æ¥è§£æï¼Œå¯ä»¥é˜²æ­¢sqlæ³¨å…¥</p><p>${}è¡¨ç¤ºä¸€ä¸ªæ‹¼æ¥ç¬¦å·, ä¼ å…¥æ•°æ®ç›´æ¥æ˜¾ç¤ºåœ¨ç”Ÿæˆçš„sqlä¸­ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´sqlæ³¨å…¥</p><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="http://www.mybatis.org/mybatis-3/zh/index.html" target="_blank" rel="noopener">MyBatiså®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://lujunqiu.github.io/2018/01/23/MyBatiså…¥é—¨/" target="_blank" rel="noopener">MyBatiså…¥é—¨</a></p><p><a href="https://lujunqiu.github.io/2018/01/26/MyBatisè¿›é˜¶/" target="_blank" rel="noopener">MyBatisè¿›é˜¶</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;MyBatisç®€ä»‹&quot;&gt;&lt;a href=&quot;#MyBatisç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;MyBatisç®€ä»‹&quot;&gt;&lt;/a&gt;MyBatisç®€ä»‹&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/mybatis-logo.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†æ¥å£å’Œ Java çš„ POJOs(Plain Old Java Objects,æ™®é€šçš„ Javaå¯¹è±¡)æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;Mybatisä¸Hibernateéƒ½æ˜¯æŒä¹…å±‚æ¡†æ¶ï¼Œè¿™ç±»æ¡†æ¶çš„ä½œç”¨å°±æ˜¯å°†æ•°æ®åº“ä¸­çš„è¡¨å’ŒPOJOæ˜ å°„èµ·æ¥ï¼Œå®ƒä»¬çš„æœ¬è´¨å°±æ˜¯Javaå¯¹æ•°æ®åº“çš„æ“ä½œçš„æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†è¿™ç§æ¡†æ¶ç§°ä¸ºå¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶(ORM,Object Relational Mapping)ã€‚å®ƒä»¬çš„åŒºåˆ«ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒHibernateåŸºæœ¬ä¸éœ€è¦ç¼–å†™SQLï¼Œå®ƒå¯ä»¥æ ¹æ®æ˜ å°„è§„åˆ™è‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼Œæ˜¯ä¸€ç§å…¨è¡¨æ˜ å°„ã€‚è€ŒMyBatisä¸å±è”½SQLï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šåˆ¶SQLï¼Œè¿™æ ·å°±æä¾›ç»™äº†æˆ‘ä»¬è¶³å¤Ÿçš„çµæ´»æ€§ä¸ä¼˜åŒ–çš„å¯èƒ½ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒMyBatisç›¸å¯¹äºHibernateæ¥è¯´å…·æœ‰æ€§èƒ½é«˜ï¼Œå“åº”å¿«ï¼Œå¼€å‘çµæ´»çš„ç‰¹ç‚¹ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="MyBatis" scheme="https://hsb786.github.io/tags/MyBatis/"/>
    
  </entry>
  
  <entry>
    <title>åŠ¨æ€ä»£ç†ï¼ˆè½¬è½½ï¼‰</title>
    <link href="https://hsb786.github.io/2018/04/12/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%EF%BC%88%E8%BD%AC%E8%BD%BD%EF%BC%89/"/>
    <id>https://hsb786.github.io/2018/04/12/åŠ¨æ€ä»£ç†ï¼ˆè½¬è½½ï¼‰/</id>
    <published>2018-04-12T05:13:18.000Z</published>
    <updated>2018-04-12T05:19:05.499Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h2><p>ç›¸æ¯”äºé™æ€ä»£ç†ï¼ŒåŠ¨æ€ä»£ç†å¯ä»¥é¿å…ç¼–å†™å„ä¸ªç¹é”çš„é™æ€ä»£ç†ç±»ï¼Œåªéœ€ç®€å•åœ°æŒ‡å®šä¸€ç»„æ¥å£åŠç›®æ ‡ç±»å¯¹è±¡å°±èƒ½åŠ¨æ€çš„è·å¾—ä»£ç†å¯¹è±¡å®ä¾‹ã€‚</p><h2 id="JDKåŠ¨æ€ä»£ç†"><a href="#JDKåŠ¨æ€ä»£ç†" class="headerlink" title="JDKåŠ¨æ€ä»£ç†"></a>JDKåŠ¨æ€ä»£ç†</h2><p>JDKä»1.3ç‰ˆæœ¬å·²ç»å†…ç½®å¯¹åŠ¨æ€ä»£ç†å®ç°çš„æ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡java.lang.reflect.Proxyç±»ä»¥åŠjava.lang.reflectåŒ…ä¸­çš„InvocationHandleræ¥å£æ¥è‡ªå·±å®ç°åŠ¨æ€ä»£ç†ã€‚<br><a id="more"></a></p><h2 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * å®šä¹‰è¢«ä»£ç†çš„æ¥å£</span><br><span class="line"> */</span><br><span class="line">interface Hello&#123;</span><br><span class="line">    void  sayhello();</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line"> * æ¥å£çš„å®ç°ç±»</span><br><span class="line"> */</span><br><span class="line">class helloImpl implements Hello &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void sayhello() &#123;</span><br><span class="line">        System.out.println(&quot;hello world&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line"> * è°ƒç”¨å¤„ç†ç¨‹åº(InvocationHandler)</span><br><span class="line"> * åœ¨æœ€ç»ˆç”Ÿæˆçš„ä»£ç†ç±»ä¸­åŒ…å«ä¸€ä¸ªInvocationHandlerå®ç°ç±»çš„æˆå‘˜å˜é‡(è¯¥æˆå‘˜å˜é‡ç»§æ‰¿è‡ªProxyç±»)ã€‚</span><br><span class="line"> * åœ¨ä»£ç†ç±»å®ä¾‹è°ƒç”¨ä»£ç†çš„æ–¹æ³•æ—¶ï¼Œå°†å¯¹æ–¹æ³•è°ƒç”¨è¿›è¡Œç¼–ç (Methodå˜é‡)å¹¶å°†å…¶æŒ‡æ´¾åˆ°å®ƒçš„è°ƒç”¨å¤„ç†ç¨‹åºçš„invokeæ–¹æ³•ã€‚</span><br><span class="line"> * æ‰€ä»¥å¯¹è¢«ä»£ç†æ–¹æ³•çš„è°ƒç”¨éƒ½æ˜¯é€šè¿‡InvocationHadlerçš„invokeæ¥å®ç°çš„ã€‚</span><br><span class="line"> */</span><br><span class="line">class MyInvocationHandler implements InvocationHandler &#123;</span><br><span class="line">    //ç›®æ ‡å¯¹è±¡ï¼Œè¢«ä»£ç†æ¥å£çš„å®ç°ç±»</span><br><span class="line">    private Object target;</span><br><span class="line">    public MyInvocationHandler(Object target)&#123;</span><br><span class="line">        this.target = target;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * @param proxyã€€ä»£ç†ç±»å®ä¾‹</span><br><span class="line">     * @param methodã€€æ–¹æ³•</span><br><span class="line">     * @param argsã€€ã€€æ–¹æ³•å…¥å‚</span><br><span class="line">     * @return</span><br><span class="line">     * @throws Throwable</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">        System.out.println(&quot;------ç»‡å…¥å‰ç½®å¢å¼ºä»£ç -------------&quot;);</span><br><span class="line">        //æ‰§è¡Œç›¸åº”çš„ç›®æ ‡æ–¹æ³•</span><br><span class="line">        Object rs = method.invoke(target,args);</span><br><span class="line">        System.out.println(&quot;------ç»‡å…¥åç½®å¢å¼ºä»£ç -------------&quot;);</span><br><span class="line">        return rs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">public class test &#123;</span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        //è·å–åŠ¨æ€ä»£ç†ç±»ï¼Œç”Ÿæˆå…·ä½“çš„ä»£ç†ç±»å­—èŠ‚ç </span><br><span class="line">        Class proxyClazz = Proxy.getProxyClass(Hello.class.getClassLoader(),Hello.class);</span><br><span class="line">        //é€šè¿‡åå°„è·å¾—ä»£ç†ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¼ å…¥å‚æ•°ç±»å‹InvocationHandler.class</span><br><span class="line">        Constructor constructor = proxyClazz.getConstructor(InvocationHandler.class);</span><br><span class="line">        //é€šè¿‡æ„é€ å‡½æ•°æ¥åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œå°†è‡ªå®šä¹‰çš„InvocationHandlerå®ä¾‹ä¼ å…¥</span><br><span class="line">        Hello iHello = (Hello) constructor.newInstance(new MyInvocationHandler(new helloImpl()));</span><br><span class="line">        //é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•</span><br><span class="line">        iHello.sayhello();</span><br><span class="line">        //ä¸Šè¿°ç”Ÿæˆä»£ç†ç±»å®ä¾‹çš„ä»£ç ï¼ŒJDKæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•Proxy.newProxyInstance()å®Œæˆã€‚ä¼ å…¥å‚æ•°ï¼šç±»åŠ è½½å™¨ï¼Œç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£ï¼ŒInvocationHandlerçš„å®ç°ç±» </span><br><span class="line">        Hello myHello = (Hello) Proxy.newProxyInstance(Thread.currentThread().getContextClassLoader(), new helloImpl().getClass().getInterfaces(), new MyInvocationHandler(new helloImpl()));</span><br><span class="line">        //é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•</span><br><span class="line">        myHello.sayhello();</span><br><span class="line">        </span><br><span class="line">//toString()ï¼ŒhashCode()ï¼Œequals()ä¹Ÿè¢«ä»£ç†äº†ï¼Œéƒ½ç»‡å…¥äº†å¢å¼ºé€»è¾‘ã€‚é€šè¿‡åç¼–è¯‘ä»£ç†ç±»å¯ä»¥çœ‹åˆ°é™æ€å—ä¸­åˆå§‹åŒ–äº†è¿™äº›method</span><br><span class="line">//        iHello.toString();</span><br><span class="line">//        iHello.hashCode();</span><br><span class="line">//        iHello.equals(new Object());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç è§£æï¼š<br>ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡java.lang.reflect.Proxyå®ç°äº†åŠ¨æ€ä»£ç†ã€‚å¦‚æœæˆ‘ä»¬åç¼–è¯‘åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»å®ä¾‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œä»£ç†ç±»å®ä¾‹iHelloæˆ–è€…myHelloå®é™…ä¸Šç»§æ‰¿äº†ProxyåŒæ—¶å®ç°äº†Helloæ¥å£(ç”±äºJavaæ˜¯å•ç»§æ‰¿è¯­æ³•ï¼Œæ‰€ä»¥JDKæä¾›çš„åŠ¨æ€ä»£ç†åªèƒ½ä»£ç†æ¥å£æ–¹æ³•)ã€‚ä»£ç†ç±»å®ä¾‹iHelloæˆ–è€…myHelloåœ¨å†…éƒ¨è°ƒç”¨è¢«ä»£ç†çš„æ¥å£æ–¹æ³•sayhello()æ—¶ï¼Œæ˜¯é€šè¿‡è°ƒç”¨åœ¨ä»£ç†ç±»çš„æ„é€ æ–¹æ³•ä¸­ä¼ å…¥çš„new MyInvocationHandler(new helloImpl())çš„invoke()æ–¹æ³•å®ç°çš„ã€‚</p><p>å¦å¤–ï¼Œåœ¨ä¸Šè¿°ä¾‹å­ä¸­æˆ‘ä»¬åœ¨InvocationHandlerä¸­å†™çš„å¢å¼ºé€»è¾‘ä¸ä»…ä»…å¢å¼ºäº†è¢«ä»£ç†çš„æ¥å£æ–¹æ³•ï¼Œè¿˜å¢å¼ºäº†æ¥è‡ªObjectçš„ä¸‰ä¸ªæ–¹æ³•toString()ï¼ŒhashCode()ï¼Œequals()ã€‚åœ¨ä¸Šè¿°ä»£ç æœ«å°¾æ³¨é‡Šæ‰çš„ä¸‰è¡Œä»£ç çš„è¾“å‡ºå¯ä»¥è¯å®è¿™ä¸‰ä¸ªæ–¹æ³•ç¡®å®ä¹Ÿç»‡å…¥äº†å¢å¼ºé€»è¾‘ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘ä»¬å·²çŸ¥éœ€è¦è¢«ä»£ç†çš„æ¥å£æ–¹æ³•ï¼Œä»¥åŠå¯¹åº”çš„æ¥å£å’Œå®ç°äº†æ¥å£æ–¹æ³•çš„ç›®æ ‡å¯¹è±¡(è¢«ä»£ç†å¯¹è±¡)ï¼Œå¦‚ä½•é€šè¿‡JDKå®ç°åŠ¨æ€ä»£ç†ï¼Ÿ</p><ol><li><p>é€šè¿‡å®ç°InvocationHandleræ¥å£æ¥è‡ªå®šä¹‰è‡ªå·±çš„InvocationHandler;åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ä¼ å…¥ç›®æ ‡å¯¹è±¡(è¢«ä»£ç†çš„å¯¹è±¡)æ¥è¾…åŠ©å®Œæˆinvoke()æ–¹æ³•ï¼ŒåŒæ—¶å¯ä»¥åœ¨invokeæ–¹æ³•ä¸­ç»‡å…¥å¢å¼ºé€»è¾‘ã€‚</p></li><li><p>é€šè¿‡Proxy.getProxyClassè·å¾—åŠ¨æ€ä»£ç†ç±»ï¼Œè¯¥ç±»ç»§æ‰¿äº†java.lang.reflect.Proxyï¼ŒåŒæ—¶å®ç°äº†è¢«ä»£ç†æ–¹æ³•çš„æ¥å£(åŠ¨æ€ç”Ÿæˆä»£ç†ç±»çš„å­—èŠ‚ç )</p></li><li><p>é€šè¿‡åå°„æœºåˆ¶è·å¾—ä»£ç†ç±»çš„æ„é€ æ–¹æ³•ï¼Œæ–¹æ³•ç­¾åä¸ºgetConstructor(InvocationHandler.class)</p></li><li><p>é€šè¿‡æ„é€ å‡½æ•°è·å¾—ä»£ç†å¯¹è±¡å¹¶å°†è‡ªå®šä¹‰çš„InvocationHandlerå®ä¾‹å¯¹è±¡ä¼ ä¸ºå‚æ•°ä¼ å…¥ï¼Œä½œä¸ºä»£ç†å¯¹è±¡çš„æˆå‘˜å˜é‡æ¥ä½¿ç”¨</p></li></ol><p>5.é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼Œå®é™…æ˜¯é€šè¿‡ä¸Šè¿°InvocationHandlerå®ç°ç±»ä¸­çš„invoke()æ–¹æ³•è°ƒç”¨</p><hr><h2 id="CGLIBåŠ¨æ€ä»£ç†"><a href="#CGLIBåŠ¨æ€ä»£ç†" class="headerlink" title="CGLIBåŠ¨æ€ä»£ç†"></a>CGLIBåŠ¨æ€ä»£ç†</h2><p>åŠ¨æ€ä»£ç†è¦æ±‚çš„ç›®æ ‡å¯¹è±¡æ˜¯å®ç°ä¸€ä¸ªæ¥å£çš„ç›®æ ‡å¯¹è±¡,ä½†æ˜¯æœ‰æ—¶å€™ç›®æ ‡å¯¹è±¡åªæ˜¯ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡,å¹¶æ²¡æœ‰å®ç°ä»»ä½•çš„æ¥å£,è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ä»¥ç›®æ ‡å¯¹è±¡å­ç±»çš„æ–¹å¼ç±»å®ç°ä»£ç†,è¿™ç§æ–¹æ³•å°±å«åš:Cglibä»£ç†(CODE GENERLIZE LIBRARY)ï¼Œä¹Ÿå«ä½œå­ç±»ä»£ç†,å®ƒæ˜¯åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªå­ç±»å¯¹è±¡ä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½çš„æ‰©å±•ã€‚</p><p>CglibåŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå°è€Œå¿«çš„å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMæ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»ã€‚å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œæ‰€ä»¥è¯¥ç±»æˆ–æ–¹æ³•ä¸èƒ½å£°æ˜ç§°finalçš„ã€‚</p><hr><h2 id="JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†ç”Ÿæˆçš„åŒºåˆ«"><a href="#JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†ç”Ÿæˆçš„åŒºåˆ«" class="headerlink" title="JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†ç”Ÿæˆçš„åŒºåˆ«"></a>JDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†ç”Ÿæˆçš„åŒºåˆ«</h2><ol><li><p>JDKåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨åå°„æœºåˆ¶ç”Ÿæˆä¸€ä¸ªå®ç°ä»£ç†æ¥å£çš„åŒ¿åç±»ï¼Œåœ¨è°ƒç”¨å…·ä½“æ–¹æ³•å‰è°ƒç”¨InvokeHandleræ¥å¤„ç†ã€‚JDKåŠ¨æ€ä»£ç†åªèƒ½å¯¹å®ç°äº†æ¥å£çš„ç±»ç”Ÿæˆä»£ç†ï¼Œè€Œä¸èƒ½é’ˆå¯¹ç±»ã€‚</p></li><li><p>CGLIBåŠ¨æ€ä»£ç†æ˜¯åˆ©ç”¨ASMå¼€æºåŒ…ï¼Œå°†ç›®æ ‡å¯¹è±¡ç±»çš„classæ–‡ä»¶åŠ è½½è¿›æ¥ï¼Œé€šè¿‡ä¿®æ”¹å…¶å­—èŠ‚ç ç”Ÿæˆå­ç±»æ¥å¤„ç†ã€‚CGLIBæ˜¯é’ˆå¯¹ç±»å®ç°ä»£ç†ï¼Œä¸»è¦æ˜¯å¯¹æŒ‡å®šçš„ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œè¦†ç›–å…¶ä¸­çš„æ–¹æ³•ã€‚</p></li><li><p>JDKåŠ¨æ€ä»£ç†æ˜¯é¢å‘æ¥å£çš„ï¼Œåœ¨åˆ›å»ºä»£ç†å®ç°ç±»æ—¶æ¯”CGLIBè¦å¿«ï¼Œåˆ›å»ºä»£ç†é€Ÿåº¦å¿«ã€‚CGLIBåŠ¨æ€ä»£ç†æ˜¯é€šè¿‡å­—èŠ‚ç åº•å±‚ç»§æ‰¿è¦ä»£ç†ç±»çš„ç›®æ ‡ç±»æ¥å®ç°ï¼Œåˆ›å»ºé€Ÿåº¦æ²¡æœ‰JDKåŠ¨æ€ä»£ç†å¿«ï¼Œä½†æ˜¯è¿è¡Œé€Ÿåº¦æ¯”JDKåŠ¨æ€ä»£ç†å¿«ã€‚</p></li></ol><p>åœ¨Spring AOPä¸­ï¼Œä¸¤ç§ä»£ç†æŠ€æœ¯éƒ½æœ‰ä½¿ç”¨ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡æ˜¯æ¥å£å®ç°ç±»ï¼Œé‚£ä¹ˆSpringé‡‡ç”¨JDKåŠ¨æ€ä»£ç†æ¥å®Œæˆï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸æ˜¯æ¥å£å®ç°ç±»ï¼ŒSpringä¼šä½¿ç”¨CGLIBæ¥å®ç°åŠ¨æ€ä»£ç†ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å¼ºåˆ¶ä½¿ç”¨CGLIBåŠ¨æ€ä»£ç†ã€‚å› ä¸ºåœ¨Springå®¹å™¨ä¸­ï¼Œå¤§å¤šæ•°beanæ˜¯å•ä¾‹çš„ï¼Œæ‰€ä»¥åªåˆ›å»ºä¸€æ¬¡ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨CGLIBæ¥ä»£ç†ã€‚</p><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://lujunqiu.github.io/2017/12/07/åŠ¨æ€ä»£ç†/" target="_blank" rel="noopener">åŠ¨æ€ä»£ç†</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;åŠ¨æ€ä»£ç†&quot;&gt;&lt;a href=&quot;#åŠ¨æ€ä»£ç†&quot; class=&quot;headerlink&quot; title=&quot;åŠ¨æ€ä»£ç†&quot;&gt;&lt;/a&gt;åŠ¨æ€ä»£ç†&lt;/h2&gt;&lt;p&gt;ç›¸æ¯”äºé™æ€ä»£ç†ï¼ŒåŠ¨æ€ä»£ç†å¯ä»¥é¿å…ç¼–å†™å„ä¸ªç¹é”çš„é™æ€ä»£ç†ç±»ï¼Œåªéœ€ç®€å•åœ°æŒ‡å®šä¸€ç»„æ¥å£åŠç›®æ ‡ç±»å¯¹è±¡å°±èƒ½åŠ¨æ€çš„è·å¾—ä»£ç†å¯¹è±¡å®ä¾‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;JDKåŠ¨æ€ä»£ç†&quot;&gt;&lt;a href=&quot;#JDKåŠ¨æ€ä»£ç†&quot; class=&quot;headerlink&quot; title=&quot;JDKåŠ¨æ€ä»£ç†&quot;&gt;&lt;/a&gt;JDKåŠ¨æ€ä»£ç†&lt;/h2&gt;&lt;p&gt;JDKä»1.3ç‰ˆæœ¬å·²ç»å†…ç½®å¯¹åŠ¨æ€ä»£ç†å®ç°çš„æ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡java.lang.reflect.Proxyç±»ä»¥åŠjava.lang.reflectåŒ…ä¸­çš„InvocationHandleræ¥å£æ¥è‡ªå·±å®ç°åŠ¨æ€ä»£ç†ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>HashMap</title>
    <link href="https://hsb786.github.io/2018/04/12/HashMap/"/>
    <id>https://hsb786.github.io/2018/04/12/HashMap/</id>
    <published>2018-04-12T03:29:30.000Z</published>
    <updated>2018-04-12T11:39:25.961Z</updated>
    
    <content type="html"><![CDATA[<p><strong>HashMapå†…éƒ¨å­˜å‚¨ç»“æ„</strong></p><p>HashMapå†…éƒ¨å­˜å‚¨ä½¿ç”¨äº†ä¸€ä¸ªNodeæ•°ç»„ï¼ˆé»˜è®¤å¤§å°æ˜¯16ï¼‰ï¼Œè€ŒNodeç±»åŒ…å«ä¸€ä¸ªç±»å‹ä¸ºNodeçš„nextå˜é‡ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·çš„keyä¼šå­˜å‚¨åˆ°åŒä¸€ä¸ªé“¾è¡¨é‡Œï¼ˆå³äº§ç”Ÿäº†å†²çªï¼‰ã€‚<br><a id="more"></a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;</span><br><span class="line">    implements Map&lt;K,V&gt;, Cloneable, Serializable &#123;</span><br><span class="line"></span><br><span class="line">    transient Node&lt;K,V&gt;[] table;</span><br><span class="line"></span><br><span class="line">    transient int size;</span><br><span class="line"></span><br><span class="line">    transient int modCount;</span><br><span class="line"></span><br><span class="line">    static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16</span><br><span class="line"></span><br><span class="line">    static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;</span><br><span class="line"></span><br><span class="line">    static final float DEFAULT_LOAD_FACTOR = 0.75f;</span><br><span class="line"></span><br><span class="line">    static final int TREEIFY_THRESHOLD = 8;</span><br><span class="line"></span><br><span class="line">    static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123;</span><br><span class="line">        final int hash;</span><br><span class="line">        final K key;</span><br><span class="line">        V value;</span><br><span class="line">        Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">        .....</span><br><span class="line">    &#125;</span><br><span class="line">    .....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tableï¼Œä¸€ä¸ªå­˜æ”¾èŠ‚ç‚¹(Node[])çš„æ•°ç»„ï¼Œæ˜¯Hashmapçš„åŸºç¡€è®¾æ–½ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å­˜æ”¾äºæ­¤ã€‚</p><p>sizeï¼ŒHashmapå­˜æ”¾çš„é”®å€¼å¯¹çš„æ•°ç›®ï¼Œå¹¶ä¸ç­‰äºtableæ•°ç»„çš„é•¿åº¦ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨é“¾è¡¨å’Œçº¢é»‘æ ‘ç»“æ„ã€‚</p><p>modCountï¼ŒHashmapçš„ä¿®æ”¹æ¬¡æ•°ï¼Œæ˜¯å®ç°fail-fastæœºåˆ¶çš„å…³é”®ï¼ˆä¸æ¸…æ¥šfail-fastæœºåˆ¶çš„è¯·çœ‹<a href="https://hsb786.github.io/2018/04/09/éœ€è¦æ³¨æ„çš„ä¸€äº›ä¸œè¥¿/">éœ€è¦æ³¨æ„çš„ä¸€äº›ä¸œè¥¿</a>ï¼‰</p><p>DEFAULT_INITIAL_CAPACITYï¼Œè¡¨ç¤ºé»˜è®¤HashMapæ•°ç»„åˆå§‹å¤§å°ä¸º16ï¼Œå¹¶ä¸”ä¸ºäº†åç»­çš„rehashæ“ä½œçš„æ–¹ä¾¿ï¼ŒHashmapçš„æ•°ç»„å¤§å°å§‹ç»ˆä¸º2çš„æ•´æ•°æ¬¡å¹‚ï¼Œå³ä½¿ä½ è¾“å…¥ä¸€ä¸ªä¸æ˜¯2çš„æ•´æ•°æ¬¡å¹‚çš„å€¼ï¼Œä¹Ÿä¼šå˜æˆæœ€å°çš„å¤§äºè¯¥å€¼çš„2çš„æ•´æ•°æ¬¡å¹‚ã€‚</p><p>MAXIMUM_CAPACITYï¼Œè¡¨ç¤ºHashmapæ•°ç»„çš„æœ€å¤§å®¹é‡ï¼Œåˆå§‹å€¼ä¸º2^30ã€‚</p><p>DEFAULT_LOAD_FACTORï¼Œè¡¨ç¤ºè´Ÿè½½å› å­ï¼Œå½“Hashmapçš„å®é™…å®¹é‡è¶…è¿‡äº†(è®¾å®šå®¹é‡xè´Ÿè½½å› å­)ï¼Œå°±è§¦å‘rehashæ“ä½œï¼Œé»˜è®¤å€¼ä¸º0.75ã€‚</p><p>TREEIFY_THRESHOLDï¼Œjkd1.8æ–°å¢çš„ï¼Œå¦‚æœHashmapæ•°ç»„å…ƒç´ çš„é“¾è¡¨é•¿åº¦è¶…è¿‡è¿™ä¸ªå€¼ï¼Œå°±ä½¿ç”¨çº¢é»‘æ ‘ç»“æ„ä»£æ›¿é“¾è¡¨æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œé»˜è®¤å€¼ä¸º8ã€‚</p><p>æ•°ç»„å†…çš„å…ƒç´ çš„æ•°æ®ç»“æ„ç»§æ‰¿äº†Map.Entryï¼Œç”¨äºå­˜æ”¾é”®å€¼å¯¹ï¼Œå¦å¤–è¿˜åŒ…å«äº†hashå€¼å’ŒnextèŠ‚ç‚¹ï¼Œå…¶ä¸­hashå€¼å¯ç”¨äºå­˜å–èŠ‚ç‚¹æ—¶æ¥å¯»å€çš„ä½œç”¨ï¼ŒnextèŠ‚ç‚¹æ˜¯å®ç°Hashmapçš„æ•°ç»„+é“¾è¡¨(çº¢é»‘æ ‘)ç»“æ„çš„å…³é”®ã€‚</p><p>åœ¨ç»§ç»­çœ‹Hashmapçš„å†…éƒ¨æ–¹æ³•ä¹‹å‰ï¼Œåšä¸ªå¤§è‡´çš„æ€»ç»“ï¼š</p><p>Hashmapæ˜¯ç”¨äºå­˜æ”¾é”®å€¼å¯¹çš„å®¹å™¨ï¼Œå†…éƒ¨å®ç°æ˜¯åŸºäºæ•°ç»„çš„ï¼Œæ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯é”®å€¼å¯¹NodeèŠ‚ç‚¹ï¼Œä¸€ä¸ªNodeèŠ‚ç‚¹ä¿å­˜äº†ä¸€ä¸ªé”®å€¼å¯¹ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜ä¿å­˜äº†nextèŠ‚ç‚¹ï¼Œå¯ä»¥å½¢æˆé“¾è¡¨ç»“æ„(åœ¨å‘ç”Ÿhashå†²çªçš„æ—¶å€™)ã€‚å¦‚æœé“¾è¡¨é•¿åº¦å¤ªé•¿ï¼Œè¶…è¿‡äº†é˜€å€¼(é»˜è®¤ä¸º8)ï¼Œé‚£ä¹ˆå°±è‡ªåŠ¨å‡çº§ä¸ºçº¢é»‘æ ‘ç»“æ„(é«˜æ•ˆçš„å¹³è¡¡æŸ¥æ‰¾æ ‘)ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ•°ç»„å…ƒç´ çš„èŠ‚ç‚¹å°±æˆä¸ºäº†çº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹äº†ã€‚</p><p><img src="/images/HashMap3.png" alt=""></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨java8ä¸­å¦‚æœhashå€¼ç›¸åŒçš„keyæ•°é‡å¤§äºæŒ‡å®šå€¼ï¼ˆé»˜è®¤æ˜¯8ï¼‰æ—¶ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚</p><hr><p><strong>HashMapçš„è‡ªåŠ¨æ‰©å®¹æœºåˆ¶</strong></p><p>HashMapå†…éƒ¨çš„Nodeæ•°ç»„é»˜è®¤çš„å¤§å°æ˜¯16ï¼Œå‡è®¾æœ‰100ä¸‡ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆæœ€å¥½çš„æƒ…å†µä¸‹æ¯ä¸ªhashæ¡¶éƒ½æœ‰62500ä¸ªå…ƒç´ ï¼Œè¿™æ—¶get()ï¼Œput()ï¼Œremove()ç­‰æ–¹æ³•æ•ˆç‡éƒ½ä¼šé™ä½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHashMapæä¾›äº†è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Œå½“å…ƒç´ ä¸ªæ•°è¾¾åˆ°æ•°ç»„å¤§å°*loadFactor(åŠ è½½å› å­)åä¼šæ‰©å¤§æ•°ç»„çš„å¤§å°ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º16ï¼ŒloadFactorä¸º0.75ï¼Œä¹Ÿå°±æ˜¯è¯´å½“HashMapä¸­çš„å…ƒç´ è¶…è¿‡16*0.75=12æ—¶ï¼Œä¼šæŠŠæ•°ç»„å¤§å°æ‰©å±•ä¸º2*16=32ï¼Œå¹¶ä¸”é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ã€‚</p><p><img src="/images/HashMap2.png" alt=""></p><p>æ²¡æ‰©å®¹å‰ï¼Œè·å–EntryEéœ€è¦éå†5ä¸ªå…ƒç´ ï¼Œæ‰©å®¹ä¹‹ååªéœ€è¦2æ¬¡ã€‚</p><hr><p><strong>put()</strong></p><ol><li>å¯¹keyçš„hashCode()åšhashï¼Œç„¶åè®¡ç®—index;</li><li>å¦‚æœæ²¡ç¢°æ’ç›´æ¥æ”¾åˆ°bucketé‡Œï¼›</li><li>å¦‚æœç¢°æ’äº†ï¼Œä»¥é“¾è¡¨çš„å½¢å¼å­˜åœ¨bucketsåï¼›</li><li>å¦‚æœç¢°æ’å¯¼è‡´é“¾è¡¨è¿‡é•¿ï¼ˆå¤§äºç­‰äºTREEIFY_THRESHOLDï¼‰ï¼Œå°±æŠŠé“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ï¼›</li><li>å¦‚æœèŠ‚ç‚¹å·²ç»å­˜åœ¨å°±æ›¿æ¢old value(ä¿è¯keyçš„å”¯ä¸€æ€§)ï¼›</li><li>å¦‚æœbucketæ»¡äº†(è¶…è¿‡load factor*current capacity)ï¼Œå°±è¦resizeã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public V put(K key, V value) &#123;</span><br><span class="line">    return putVal(hash(key), key, value, false, true);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœput()æ–¹æ³•æ·»åŠ çš„é”®å€¼å¯¹çš„é”®å·²ç»å­˜åœ¨äºHashmapä¸­ï¼Œé‚£ä¹ˆå°±ç”¨æ–°çš„é”®å€¼çš„å€¼æ›¿ä»£æ—§å€¼ã€‚å†çœ‹æºç put()è°ƒç”¨äº†hash()æ–¹æ³•ä»¥åŠputVal()æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">static final int hash(Object key) &#123;</span><br><span class="line">    int h;</span><br><span class="line">    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“è¾“å…¥çš„keyä¸ºnullæ—¶ï¼Œhashå€¼ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´Hashmapçš„keyæ˜¯å¯ä»¥ä¸ºnullçš„ã€‚å¯¹æ¯”HashTableï¼ŒHashTableçš„keyç›´æ¥è¿›è¡Œäº†hashCodeï¼Œå¦‚æœkeyä¸ºnullæ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥HashTableçš„keyä¸å¯ä»¥æ˜¯nullã€‚<br>å…·ä½“å¦‚ä½•å¾—åˆ°keyçš„hashå€¼å‘¢ï¼Ÿé¦–å…ˆè°ƒç”¨keyè‡ªèº«çš„hashcode()å¾—åˆ°ä¸€ä¸ªhashå€¼h(32ä½intç±»å‹)ï¼Œç„¶åå°†hä¸hå³ç§»16ä½ä¹‹åçš„æ•°è¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°æœ€ç»ˆçš„hashå€¼ã€‚è‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œè¿™æ˜¯å‰äººæ€»ç»“å‡ºæ¥çš„ç®—æ³•å¯ä»¥ä½¿å¾—hashå€¼åˆ†å¸ƒæ›´åŠ å‡åŒ€,å°½é‡å‡å°‘å†²çª</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">final V putVal(int hash, K key, V value, boolean onlyIfAbsent,</span><br><span class="line">               boolean evict) &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;</span><br><span class="line">    if ((tab = table) == null || (n = tab.length) == 0)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    if ((p = tab[i = (n - 1) &amp; hash]) == null)</span><br><span class="line">        tab[i] = newNode(hash, key, value, null);</span><br><span class="line">    else &#123;</span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        if (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p;</span><br><span class="line">        else if (p instanceof TreeNode)</span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);</span><br><span class="line">        else &#123;</span><br><span class="line">            for (int binCount = 0; ; ++binCount) &#123;</span><br><span class="line">                if ((e = p.next) == null) &#123;</span><br><span class="line">                    p.next = newNode(hash, key, value, null);</span><br><span class="line">                    if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st</span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                if (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))</span><br><span class="line">                    break;</span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (e != null) &#123; // existing mapping for key</span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            if (!onlyIfAbsent || oldValue == null)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            return oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount;</span><br><span class="line">    if (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å…¥å‚éƒ½ä»£è¡¨äº†ä»€ä¹ˆï¼š</p><ul><li>hashï¼šè¡¨ç¤ºkeyçš„hashå€¼</li><li>keyï¼šå¾…å­˜å‚¨çš„keyå€¼</li><li>valueï¼šå¾…å­˜å‚¨çš„valueå€¼</li><li>onlyIfAbsentï¼šæ˜¯å¦éœ€è¦æ›¿æ¢ç›¸åŒçš„valueå€¼ã€‚å¦‚æœä¸ºtrueï¼Œè¡¨ç¤ºä¸æ›¿æ¢å·²ç»å­˜åœ¨çš„value</li><li>evictï¼šå¦‚æœä¸ºfalseï¼Œè¡¨ç¤ºæ•°ç»„æ˜¯æ–°å¢æ¨¡å¼(æš‚æ—¶ä¸çŸ¥é“å•¥æ„æ€,åªåœ¨æ–¹æ³•çš„æœ€åå‡ºç°,ä½†ä¸å½±å“å…¶ä»–é€»è¾‘)</li></ul><p>é¦–å…ˆåˆ¤æ–­å½“å‰HashMapçš„æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œå°±è°ƒç”¨resize()æ–¹æ³•åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º16çš„æ•°ç»„ï¼Œå¹¶ä¸”è·å–åˆ°æ•°ç»„çš„é•¿åº¦nï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ((tab = table) == null || (n = tab.length) == 0)</span><br><span class="line">    n = (tab = resize()).length;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œæ ¹æ®æ•°ç»„çš„é•¿åº¦n-1çš„å€¼ä¸å…¥å‚keyçš„hashå€¼æŒ‰ä½ä¸è¿ç®—ï¼Œç®—å‡ºhashå€¼å¯¹åº”äºæ•°ç»„ä¸­çš„ä½ç½®ï¼Œä»tabä¸­å°†è¿™ä¸ªä½ç½®ä¸Šé¢çš„å†…å®¹å–å‡ºï¼Œåˆ¤æ–­ä¸ºnullæ—¶ï¼Œåœ¨è¿™ä¸ªä½ç½®æ–°å¢ä¸€ä¸ªNodeã€‚ä½†æ˜¯ï¼Œå¦‚æœå–åˆ°äº†æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªhashå€¼å¯¹åº”æ•°ç»„çš„ä½ç½®ä¸Šé¢å·²ç»æœ‰äº†é”®å€¼å¯¹å­˜åœ¨ã€‚é‚£ä¹ˆï¼Œå°±åˆ¤æ–­è¿™ä¸ªNode,ä¹Ÿå°±æ˜¯pçš„hashå€¼æ˜¯å¦ä¸ä¼ å…¥çš„hashç›¸ç­‰ï¼Œç„¶åæ¥ç€åˆ¤æ–­keyæ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœåˆ¤æ–­é€šè¿‡ï¼Œè¡¨ç¤ºè¦ä¼ å…¥çš„key-valé”®å€¼å¯¹å°±æ˜¯tab[i]ä½ç½®ä¸Šé¢çš„é”®å€¼å¯¹ï¼Œç›´æ¥æ›¿æ¢å³å¯ï¼Œä¸ç”¨ç®¡åé¢æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ã€‚å¦‚æœä¸æ˜¯çš„è¯ï¼Œå°±å°†è¿™ä¸ªæ–°çš„é”®å€¼å¯¹æ’å…¥é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ç§å³å¯ã€‚æ’å…¥é”®å€¼å¯¹åˆ†ä¸¤ç§æƒ…å†µï¼šå¦‚æœæ•°ç»„å…ƒç´ æ˜¯é“¾è¡¨æ—¶ï¼Œå°±å°†èŠ‚ç‚¹æ–°å¢åˆ°åˆ—è¡¨å¤´éƒ¨ã€‚å¦‚æœé“¾è¡¨çš„é•¿åº¦å¤§äºç­‰äºçº¢é»‘æ ‘åŒ–çš„é˜€å€¼-1ï¼Œå°±å°†é“¾è¡¨è½¬æˆçº¢é»‘æ ‘ã€‚å¦‚æœæ•°ç»„å…ƒç´ æ˜¯çº¢é»‘æ ‘çš„è¯ï¼Œå°±ç›´æ¥æ’å…¥é”®å€¼å¯¹Nodeå³å¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">if ((p = tab[i = (n - 1) &amp; hash]) == null)</span><br><span class="line">    tab[i] = newNode(hash, key, value, null);</span><br><span class="line">else &#123;</span><br><span class="line">    Node&lt;K,V&gt; e; K k;</span><br><span class="line">    if (p.hash == hash &amp;&amp;</span><br><span class="line">        ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))</span><br><span class="line">        e = p;</span><br><span class="line">    else if (p instanceof TreeNode)</span><br><span class="line">        e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);</span><br><span class="line">    else &#123;</span><br><span class="line">        for (int binCount = 0; ; ++binCount) &#123;</span><br><span class="line">            if ((e = p.next) == null) &#123;</span><br><span class="line">                p.next = newNode(hash, key, value, null);</span><br><span class="line">                if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st</span><br><span class="line">                    treeifyBin(tab, hash);</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">            if (e.hash == hash &amp;&amp;</span><br><span class="line">                ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))</span><br><span class="line">                break;</span><br><span class="line">            p = e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (e != null) &#123; // existing mapping for key</span><br><span class="line">        V oldValue = e.value;</span><br><span class="line">        if (!onlyIfAbsent || oldValue == null)</span><br><span class="line">            e.value = value;</span><br><span class="line">        afterNodeAccess(e);</span><br><span class="line">        return oldValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€åï¼Œå°†ä¿®æ”¹æ¬¡æ•°åŠ ä¸€ï¼ŒåŒæ—¶åˆ¤æ–­å½“å‰çš„é”®å€¼å¯¹æ•°é‡æ˜¯å¦å³å°†è¶…è¿‡é˜€å€¼ï¼Œå¦‚æœå³å°†è¶…è¿‡ï¼Œéœ€è¦è¿›è¡Œresizeæ“ä½œã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">++modCount;</span><br><span class="line">     if (++size &gt; threshold)</span><br><span class="line">         resize();</span><br><span class="line">     afterNodeInsertion(evict);</span><br><span class="line">     return null;</span><br></pre></td></tr></table></figure></p><p><strong>get()</strong></p><ol><li>bucketé‡Œçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥å‘½ä¸­ï¼›</li><li>å¦‚æœæœ‰å†²çªï¼Œåˆ™é€šè¿‡key.equals(k)å»æŸ¥æ‰¾å¯¹åº”çš„entry;</li><li>è‹¥ä¸ºæ ‘ï¼Œåˆ™åœ¨æ•°ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(logn);</li><li>è‹¥ä¸ºé“¾è¡¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­é€šè¿‡key.equals(k)æŸ¥æ‰¾ï¼ŒO(n)ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public V get(Object key) &#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    return (e = getNode(hash(key), key)) == null ? null : e.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®å…¥å‚çš„keyå¯¹è±¡è®¡ç®—å‡ºkeyçš„hashå€¼ï¼Œè°ƒç”¨getNode()æ–¹æ³•ï¼Œå†æ¥çœ‹çœ‹getNode()æ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">final Node&lt;K,V&gt; getNode(int hash, Object key) &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k;</span><br><span class="line">    if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;</span><br><span class="line">        (first = tab[(n - 1) &amp; hash]) != null) &#123;</span><br><span class="line">        if (first.hash == hash &amp;&amp; // always check first node</span><br><span class="line">            ((k = first.key) == key || (key != null &amp;&amp; key.equals(k))))</span><br><span class="line">            return first;</span><br><span class="line">        if ((e = first.next) != null) &#123;</span><br><span class="line">            if (first instanceof TreeNode)</span><br><span class="line">                return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            do &#123;</span><br><span class="line">                if (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))</span><br><span class="line">                    return e;</span><br><span class="line">            &#125; while ((e = e.next) != null);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡keyçš„hashå€¼ä¸keyå¯¹è±¡ï¼Œæ¥æŸ¥æ‰¾keyå¯¹åº”çš„é”®å€¼å¯¹çš„å€¼ï¼Œå¦‚æœæŸ¥æ‰¾å¤±è´¥åˆ™è¿”å›nullã€‚å¦‚ä½•æŸ¥æ‰¾çš„å‘¢ï¼Ÿé¦–å…ˆï¼Œé€šè¿‡keyçš„hashå€¼è®¡ç®—å‡ºå¯¹åº”æ•°ç»„çš„ç´¢å¼•ï¼Œå¦‚æœç´¢å¼•åˆ°çš„ç¬¬ä¸€ä¸ªNodeèŠ‚ç‚¹çš„keyå’Œhashå€¼ä¸å…¥å‚ç›¸ç­‰ï¼Œç›´æ¥è¿”å›è¯¥Nodeã€‚å¦åˆ™ï¼Œå¾ªç¯éå†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(å¯èƒ½æ˜¯é“¾è¡¨ä¹Ÿæœ‰å¯èƒ½æ˜¯çº¢é»‘æ ‘)ã€‚</p><p><strong>resize()</strong></p><p>åœ¨resizeçš„æ—¶å€™ï¼Œæ•°ç»„å®¹é‡è¿˜æ˜¯è¦ä¿æŒä¸º2çš„æ•´æ•°æ¬¡å¹‚ï¼Œæ‰€ä»¥æ‰©å®¹çš„æ—¶å€™å®¹é‡ä¼šç¿»å€(åŸå®¹é‡ä¹˜ä»¥2)ï¼Œé‚£ä¹ˆåœ¨resizeçš„æ—¶å€™åŸæ¥çš„å…ƒç´ åœ¨æ–°æ•°ç»„ä¸­è¦ä¸å°±ç»´æŒåŸç´¢å¼•ï¼Œè¦ä¸å°±ä»åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚ï¼Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">final Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">    //è®°å½•åŸæ•°ç»„çš„å®¹é‡</span><br><span class="line">    int oldCap = (oldTab == null) ? 0 : oldTab.length;</span><br><span class="line">    int oldThr = threshold;</span><br><span class="line">    int newCap, newThr = 0;</span><br><span class="line">    if (oldCap &gt; 0) &#123;</span><br><span class="line">    //å¦‚æœè€çš„æ•°ç»„å®¹é‡å¤§äº0ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦å¤§äºç­‰äºHashMapçš„æœ€å¤§å®¹é‡ã€‚å¦‚æœtrueï¼Œå°†é˜ˆå€¼è®¾ç½®ä¸ºIntegerçš„æœ€å¤§å€¼ï¼ŒåŒæ—¶æ•°ç»„å®¹é‡ä¸å˜</span><br><span class="line">        if (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            return oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        //å¯¹æ•°ç»„è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åçš„æ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ä¸¤å€ï¼›åŒæ—¶é˜ˆå€¼ä¹Ÿæ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€</span><br><span class="line">        else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; 1; // double threshold</span><br><span class="line">    &#125;</span><br><span class="line">    else if (oldThr &gt; 0) // initial capacity was placed in threshold</span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    else &#123;               // zero initial threshold signifies using defaults</span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    if (newThr == 0) &#123;</span><br><span class="line">        float ft = (float)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (int)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;</span><br><span class="line">    @SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span><br><span class="line">    //å®šä¹‰ä¸€ä¸ªæ–°çš„å®¹é‡çš„æ•°ç»„ï¼ŒåŒæ—¶å®Œæˆå¯¹æ–°æ•°ç»„çš„èµ‹å€¼</span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line">    if (oldTab != null) &#123;</span><br><span class="line">        for (int j = 0; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            if ((e = oldTab[j]) != null) &#123;</span><br><span class="line">                oldTab[j] = null;</span><br><span class="line">                if (e.next == null)</span><br><span class="line">                    newTab[e.hash &amp; (newCap - 1)] = e;</span><br><span class="line">                else if (e instanceof TreeNode)</span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);</span><br><span class="line">                else &#123; // preserve order</span><br><span class="line">                    Node&lt;K,V&gt; loHead = null, loTail = null;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = null, hiTail = null;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    do &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        if ((e.hash &amp; oldCap) == 0) &#123;</span><br><span class="line">                            if (loTail == null)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            else</span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        else &#123;</span><br><span class="line">                            if (hiTail == null)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            else</span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; while ((e = next) != null);</span><br><span class="line">                    if (loTail != null) &#123;</span><br><span class="line">                        loTail.next = null;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    if (hiTail != null) &#123;</span><br><span class="line">                        hiTail.next = null;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨</strong></p><ol><li>å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨putæ–¹æ³•æ·»åŠ å…ƒç´ ï¼Œè€Œä¸”å‡è®¾æ­£å¥½å­˜åœ¨ä¸¤ä¸ªputçš„keyå‘ç”Ÿäº†ç¢°æ’(æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·)ï¼Œé‚£ä¹ˆæ ¹æ®HashMapçš„å®ç°ï¼Œè¿™ä¸¤ä¸ªkeyä¼šæ·»åŠ åˆ°æ•°ç»„çš„åŒä¸€ä¸ªä½ç½®ï¼Œè¿™æ ·æœ€ç»ˆå°±ä¼šå‘ç”Ÿå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹çš„putçš„æ•°æ®è¢«è¦†ç›–ã€‚</li><li>å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ£€æµ‹åˆ°å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å°*loadFactorï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹Nodeæ•°ç»„è¿›è¡Œæ‰©å®¹ï¼Œéƒ½åœ¨é‡æ–°è®¡ç®—å…ƒç´ ä½ç½®ä»¥åŠå¤åˆ¶æ•°æ®ï¼Œä½†æ˜¯æœ€ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰©å®¹åçš„æ•°ç»„ä¼šèµ‹ç»™tableï¼Œä¹Ÿå°±æ˜¯è¯´å…¶ä»–çº¿ç¨‹çš„éƒ½ä¼šä¸¢å¤±ï¼Œå¹¶ä¸”å„è‡ªçº¿ç¨‹putçš„æ•°æ®ä¹Ÿä¸¢å¤±ã€‚</li><li>æ‰©å®¹æ—¶éœ€è¦rehashï¼Œå¯èƒ½ä¼šé€ æˆæ­»å¾ªç¯(java8å·²ä¿®å¤)</li></ol><hr><p><strong>å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨HashMap</strong></p><ol><li>Hashtable<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public synchronized V get(Object key) &#123;</span><br><span class="line">    .....</span><br><span class="line">&#125;</span><br><span class="line">public synchronized V put(K key, V value) &#123;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>æ•ˆç‡ä½ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨putæ–¹æ³•æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸ä½†ä¸å¯ä»¥ä½¿ç”¨putæ–¹æ³•ï¼Œè¿getæ–¹æ³•éƒ½ä¸å¯ä»¥ã€‚</p><ol start="2"><li><p>ConcurrentHashMap  ï¼ˆæ•ˆç‡é«˜ï¼‰<br>JUCåŒ…ä¸­çš„ä¸€ä¸ªç±»ã€‚ConcurrentHashMap ä¸ä»…çº¿ç¨‹å®‰å…¨è€Œä¸”æ•ˆç‡é«˜ï¼Œå› ä¸ºå®ƒåŒ…å«ä¸€ä¸ª segment æ•°ç»„ï¼Œå°†æ•°æ®åˆ†æ®µå­˜å‚¨ï¼Œç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„é”åˆ†æ®µæŠ€æœ¯ã€‚</p></li><li><p>SynchronizedMap<br>è°ƒç”¨synchronizedMap()æ–¹æ³•åè¿”å›ä¸€ä¸ªSynchronizedMapç±»çš„å¯¹è±¡ï¼Œè€Œåœ¨SynchronizedMapç±»ä¸­ä½¿ç”¨äº†synchronizedåŒæ­¥å…³é”®å­—æ¥ä¿è¯å¯¹Mapçš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">// synchronizedMapæ–¹æ³•</span><br><span class="line">public static &lt;K,V&gt; Map&lt;K,V&gt; synchronizedMap(Map&lt;K,V&gt; m) &#123;</span><br><span class="line">       return new SynchronizedMap&lt;&gt;(m);</span><br><span class="line">   &#125;</span><br><span class="line">// SynchronizedMapç±»</span><br><span class="line">private static class SynchronizedMap&lt;K,V&gt;</span><br><span class="line">       implements Map&lt;K,V&gt;, Serializable &#123;</span><br><span class="line">       private static final long serialVersionUID = 1978198479659022715L;</span><br><span class="line">       private final Map&lt;K,V&gt; m;     // Backing Map</span><br><span class="line">       final Object      mutex;        // Object on which to synchronize</span><br><span class="line">       SynchronizedMap(Map&lt;K,V&gt; m) &#123;</span><br><span class="line">           this.m = Objects.requireNonNull(m);</span><br><span class="line">           mutex = this;</span><br><span class="line">       &#125;</span><br><span class="line">       SynchronizedMap(Map&lt;K,V&gt; m, Object mutex) &#123;</span><br><span class="line">           this.m = m;</span><br><span class="line">           this.mutex = mutex;</span><br><span class="line">       &#125;</span><br><span class="line">       public int size() &#123;</span><br><span class="line">           synchronized (mutex) &#123;return m.size();&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       public boolean isEmpty() &#123;</span><br><span class="line">           synchronized (mutex) &#123;return m.isEmpty();&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       public boolean containsKey(Object key) &#123;</span><br><span class="line">           synchronized (mutex) &#123;return m.containsKey(key);&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       public boolean containsValue(Object value) &#123;</span><br><span class="line">           synchronized (mutex) &#123;return m.containsValue(value);&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       public V get(Object key) &#123;</span><br><span class="line">           synchronized (mutex) &#123;return m.get(key);&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       public V put(K key, V value) &#123;</span><br><span class="line">           synchronized (mutex) &#123;return m.put(key, value);&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       public V remove(Object key) &#123;</span><br><span class="line">           synchronized (mutex) &#123;return m.remove(key);&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       // çœç•¥å…¶ä»–æ–¹æ³•</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li></ol><p>ä»æºç ä¸­å¯ä»¥çœ‹å‡ºè°ƒç”¨ synchronizedMap() æ–¹æ³•åä¼šè¿”å›ä¸€ä¸ª SynchronizedMap ç±»çš„å¯¹è±¡ï¼Œè€Œåœ¨ SynchronizedMap ç±»ä¸­ä½¿ç”¨äº† synchronized åŒæ­¥å…³é”®å­—æ¥ä¿è¯å¯¹ Map çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><hr><p><strong>æ€»ç»“</strong></p><ol><li>HashMapåœ¨å¤„ç†å†²çªæ—¶ä½¿ç”¨é“¾è¡¨å­˜å‚¨ç›¸åŒç´¢å¼•çš„å…ƒç´ ã€‚</li><li>ä»Java 8å¼€å§‹ï¼ŒHashMapï¼ŒConcurrentHashMapå’ŒLinkedHashMapåœ¨å¤„ç†é¢‘ç¹å†²çªæ—¶å°†ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œå½“åŒä¸€hashæ¡¶ä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡ç‰¹å®šçš„å€¼ä¾¿ä¼šç”±é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚</li><li>å½“ä»é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘æ—¶ï¼ŒHashMapè¿­ä»£çš„é¡ºåºå°†ä¼šæ”¹å˜ã€‚ä¸è¿‡è¿™å¹¶ä¸ä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºHashMapå¹¶æ²¡æœ‰å¯¹è¿­ä»£çš„é¡ºåºæä¾›ä»»ä½•ä¿è¯ã€‚</li><li>ä»Java 1ä¸­å°±å­˜åœ¨çš„Hashtableç±»ä¸ºäº†ä¿è¯è¿­ä»£é¡ºåºä¸å˜ï¼Œå³ä¾¿åœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä½¿ç”¨å¹³è¡¡æ ‘ã€‚è¿™ä¸€å†³å®šæ˜¯ä¸ºäº†ä¸ç ´åæŸäº›è¾ƒè€çš„éœ€è¦ä¾èµ–äºHashtableè¿­ä»£é¡ºåºçš„Javaåº”ç”¨ã€‚</li><li>é™¤äº†Hashtableä¹‹å¤–ï¼ŒWeakHashMapå’ŒIdentityHashMapä¹Ÿä¸ä¼šåœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä½¿ç”¨å¹³è¡¡æ ‘ã€‚</li><li>ä½¿ç”¨HashMapä¹‹æ‰€ä»¥ä¼šäº§ç”Ÿå†²çªæ˜¯å› ä¸ºä½¿ç”¨äº†é”®å¯¹è±¡çš„hashCode()æ–¹æ³•ï¼Œè€Œequals()å’ŒhashCode()æ–¹æ³•ä¸ä¿è¯ä¸åŒå¯¹è±¡çš„hashCodeæ˜¯ä¸åŒçš„ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œç›¸åŒå¯¹è±¡çš„hashCodeä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œä½†ç›¸åŒçš„hashCodeä¸ä¸€å®šæ˜¯ç›¸åŒçš„å¯¹è±¡ã€‚</li><li>åœ¨HashTableå’ŒHashMapä¸­ï¼Œå†²çªçš„äº§ç”Ÿæ˜¯ç”±äºä¸åŒå¯¹è±¡çš„hashCode()æ–¹æ³•è¿”å›äº†ä¸€æ ·çš„å€¼ã€‚</li></ol><hr><p><em>å‚è€ƒ</em></p><blockquote><p><a href="https://yemengying.com/2016/02/03/è¯‘-Javaä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª/" target="_blank" rel="noopener">Java 8ä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª </a></p><p><a href="https://yemengying.com/2016/05/07/threadsafe-hashmap/" target="_blank" rel="noopener">å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨ HashMap</a></p><p><a href="https://lujunqiu.github.io/2018/01/07/çœ‹çœ‹HashMapæºç /" target="_blank" rel="noopener">çœ‹çœ‹HashMapæºç </a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;HashMapå†…éƒ¨å­˜å‚¨ç»“æ„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;HashMapå†…éƒ¨å­˜å‚¨ä½¿ç”¨äº†ä¸€ä¸ªNodeæ•°ç»„ï¼ˆé»˜è®¤å¤§å°æ˜¯16ï¼‰ï¼Œè€ŒNodeç±»åŒ…å«ä¸€ä¸ªç±»å‹ä¸ºNodeçš„nextå˜é‡ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ ¹æ®hashå€¼è®¡ç®—çš„bucketä¸€æ ·çš„keyä¼šå­˜å‚¨åˆ°åŒä¸€ä¸ªé“¾è¡¨é‡Œï¼ˆå³äº§ç”Ÿäº†å†²çªï¼‰ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>Stringä¸StringBuffer</title>
    <link href="https://hsb786.github.io/2018/04/11/String%E4%B8%8EStringBuffer/"/>
    <id>https://hsb786.github.io/2018/04/11/Stringä¸StringBuffer/</id>
    <published>2018-04-11T06:17:41.000Z</published>
    <updated>2018-04-11T06:50:46.678Z</updated>
    
    <content type="html"><![CDATA[<p>Stringä¸å¯å˜ï¼ŒStringBufferå¯å˜ï¼Œwhy ?<br><a id="more"></a></p><hr><p>çœ‹æºç </p><p><strong>String</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public final class String</span><br><span class="line">    implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence &#123;</span><br><span class="line">    /** The value is used for character storage. */</span><br><span class="line">    private final char value[];</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹å‡ºStringåº•å±‚æ˜¯ç”¨charæ•°ç»„å®ç°çš„ï¼Œç”±äºè¢«finalä¿®é¥°æ‰€ä»¥å¼•ç”¨ä¸èƒ½æ”¹å˜ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡</strong></p><ol><li>åªæœ‰å½“å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œå­—ç¬¦ä¸²æ± æ‰æœ‰å¯èƒ½å®ç°ã€‚å­—ç¬¦ä¸²æ± çš„å®ç°å¯ä»¥åœ¨è¿è¡Œæ—¶èŠ‚çº¦å¾ˆå¤šheapç©ºé—´ï¼Œå› ä¸ºä¸åŒçš„å­—ç¬¦ä¸²å˜é‡éƒ½æŒ‡å‘æ± ä¸­çš„åŒä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä½†å¦‚æœå­—ç¬¦ä¸²æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆString interningå°†ä¸èƒ½å®ç°(String interningæ˜¯æŒ‡å¯¹ä¸åŒçš„å­—ç¬¦ä¸²ä»…ä»…åªä¿å­˜ä¸€ä¸ªï¼Œå³ä¸ä¼šä¿å­˜å¤šä¸ªç›¸åŒçš„å­—ç¬¦ä¸²)ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œå¦‚æœå˜é‡æ”¹å˜äº†å®ƒçš„å€¼ï¼Œé‚£ä¹ˆå…¶å®ƒæŒ‡å‘è¿™ä¸ªå€¼çš„å˜é‡çš„å€¼ä¹Ÿä¼šä¸€èµ·æ”¹å˜ã€‚</li><li>å¦‚æœå­—ç¬¦ä¸²æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆä¼šå¼•èµ·å¾ˆä¸¥é‡çš„å®‰å…¨é—®é¢˜ã€‚è­¬å¦‚ï¼Œæ•°æ®åº“çš„ç”¨æˆ·åã€å¯†ç éƒ½æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¼ å…¥æ¥è·å¾—æ•°æ®åº“çš„è¿æ¥ï¼Œæˆ–è€…åœ¨socketç¼–ç¨‹ä¸­ï¼Œä¸»æœºåå’Œç«¯å£éƒ½æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¼ å…¥ã€‚</li><li>å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥å®ƒçš„å€¼æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œå¦åˆ™é»‘å®¢ä»¬å¯ä»¥é’»åˆ°ç©ºå­ï¼Œæ”¹å˜å­—ç¬¦ä¸²æŒ‡å‘çš„å¯¹è±¡çš„å€¼ï¼Œé€ æˆå®‰å…¨æ¼æ´ã€‚å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥æ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„ï¼ŒåŒä¸€ä¸ªå­—ç¬¦ä¸²å®ä¾‹å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ã€‚è¿™æ ·ä¾¿ä¸ç”¨å› ä¸ºçº¿ç¨‹å®‰å…¨é—®é¢˜è€Œä½¿ç”¨åŒæ­¥ã€‚å­—ç¬¦ä¸²è‡ªå·±ä¾¿æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li><li>ç±»åŠ è½½å™¨è¦ç”¨åˆ°å­—ç¬¦ä¸²ï¼Œä¸å¯å˜æ€§æä¾›äº†å®‰å…¨æ€§ï¼Œä»¥ä¾¿æ­£ç¡®çš„ç±»è¢«åŠ è½½ã€‚è­¬å¦‚ä½ æƒ³åŠ è½½java.sql.Connectionç±»ï¼Œè€Œè¿™ä¸ªå€¼è¢«æ”¹æˆäº†myhacked.Connectionï¼Œé‚£ä¹ˆä¼šå¯¹ä½ çš„æ•°æ®åº“é€ æˆä¸å¯çŸ¥çš„ç ´åã€‚</li><li>å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥åœ¨å®ƒåˆ›å»ºçš„æ—¶å€™hashcodeå°±è¢«ç¼“å­˜äº†ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—ã€‚è¿™å°±ä½¿å¾—å­—ç¬¦ä¸²å¾ˆé€‚åˆä½œä¸ºMapä¸­çš„é”®ï¼Œå­—ç¬¦ä¸²çš„å¤„ç†é€Ÿåº¦è¦å¿«è¿‡å…¶å®ƒçš„é”®å¯¹è±¡ã€‚è¿™å°±æ˜¯HashMapä¸­çš„é”®å¾€å¾€éƒ½ä½¿ç”¨å­—ç¬¦ä¸²ã€‚</li></ol><hr><p><strong>StringBuffer</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> public final class StringBuffer</span><br><span class="line">    extends AbstractStringBuilder</span><br><span class="line">    implements java.io.Serializable, CharSequence</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * A cache of the last value returned by toString. Cleared</span><br><span class="line">     * whenever the StringBuffer is modified.</span><br><span class="line">     */</span><br><span class="line">    private transient char[] toStringCache;</span><br><span class="line"></span><br><span class="line">     @Override</span><br><span class="line">    public synchronized StringBuffer append(String str) &#123;</span><br><span class="line">        toStringCache = null;</span><br><span class="line">        super.append(str);</span><br><span class="line">        return this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //AbstractStringBuilderä¸­çš„æ–¹æ³•</span><br><span class="line">     public AbstractStringBuilder append(String str) &#123;</span><br><span class="line">        if (str == null)</span><br><span class="line">            return appendNull();</span><br><span class="line">        int len = str.length();</span><br><span class="line">        ensureCapacityInternal(count + len);</span><br><span class="line">        str.getChars(0, len, value, count);</span><br><span class="line">        count += len;</span><br><span class="line">        return this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //Stringä¸­çš„æ–¹æ³•</span><br><span class="line">     public void getChars(int srcBegin, int srcEnd, char dst[], int dstBegin) &#123;</span><br><span class="line">        if (srcBegin &lt; 0) &#123;</span><br><span class="line">            throw new StringIndexOutOfBoundsException(srcBegin);</span><br><span class="line">        &#125;</span><br><span class="line">        if (srcEnd &gt; value.length) &#123;</span><br><span class="line">            throw new StringIndexOutOfBoundsException(srcEnd);</span><br><span class="line">        &#125;</span><br><span class="line">        if (srcBegin &gt; srcEnd) &#123;</span><br><span class="line">            throw new StringIndexOutOfBoundsException(srcEnd - srcBegin);</span><br><span class="line">        &#125;</span><br><span class="line">        System.arraycopy(value, srcBegin, dst, dstBegin, srcEnd - srcBegin);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>StringBufferä¸­appendä¸­çš„å®ç°</p><ol><li>è°ƒç”¨super.append(str)ï¼Œ superç±»ä¸ºAbstractStringBuilder</li><li>AbstractStringBuilder.append(str)ä¸­é€šè¿‡è°ƒç”¨Stringç±»çš„getChars()æ–¹æ³•</li><li>String.getChars()ï¼Œè°ƒç”¨System.arraycopy()å®Œæˆæ•°ç»„çš„å¤åˆ¶</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* @param      src      the source array.</span><br><span class="line">   * @param      srcPos   starting position in the source array.</span><br><span class="line">   * @param      dest     the destination array.</span><br><span class="line">   * @param      destPos  starting position in the destination data.</span><br><span class="line">   * @param      length   the number of array elements to be copied.</span><br><span class="line"> public static native void arraycopy(Object src,  int  srcPos,</span><br><span class="line">                                      Object dest, int destPos,</span><br><span class="line">                                      int length);</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æ–¹æ³•çš„å®ç°ã€‚</p><p>srcåŸæ•°ç»„ï¼ŒsrcPocåŸæ•°ç»„èµ·å§‹ä½ï¼›destç›®æ ‡æ•°ç»„ï¼ŒdestPosç›®æ ‡æ•°ç»„èµ·å§‹ä½,lengthå¤åˆ¶ä¸ªæ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">      int[] int1= &#123;1,2,3,4&#125;;</span><br><span class="line">int[] int2= &#123;10,11,12,13,14,15,16,17&#125;;</span><br><span class="line">System.arraycopy(int1, 0, int2, 0, 3);</span><br><span class="line">      System.out.println(Arrays.toString(int2));  //out  [1, 2, 3, 13, 14, 15, 16, 17]</span><br></pre></td></tr></table></figure><hr><p><em>å‚è€ƒ</em></p><blockquote><p>[å¦‚ä½•ç†è§£ String ç±»å‹å€¼çš„ä¸å¯å˜ï¼Ÿ][<a href="https://www.zhihu.com/question/20618891/answer/147575525]" target="_blank" rel="noopener">https://www.zhihu.com/question/20618891/answer/147575525]</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Stringä¸å¯å˜ï¼ŒStringBufferå¯å˜ï¼Œwhy ?&lt;br&gt;
    
    </summary>
    
    
      <category term="çˆªå“‡" scheme="https://hsb786.github.io/tags/%E7%88%AA%E5%93%87/"/>
    
  </entry>
  
  <entry>
    <title>å·¥å…·ç½‘ç«™</title>
    <link href="https://hsb786.github.io/2018/04/11/%E5%B7%A5%E5%85%B7%E7%BD%91%E7%AB%99/"/>
    <id>https://hsb786.github.io/2018/04/11/å·¥å…·ç½‘ç«™/</id>
    <published>2018-04-11T04:22:11.000Z</published>
    <updated>2018-04-13T05:39:01.256Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://fontawesome.com/icons?d=gallery" target="_blank" rel="noopener">å›¾æ ‡</a></p><p><a href="https://www.processon.com/diagrams" target="_blank" rel="noopener">ç”»å›¾</a></p><p><a href="http://tool.oschina.net/encode?type=4" target="_blank" rel="noopener">åœ¨çº¿ç¼–ç è½¬æ¢</a></p><p><a href="http://tool.oschina.net/commons?type=5" target="_blank" rel="noopener">HTTPçŠ¶æ€ç </a></p><p><a href="http://www.autojcode.com/code/sql2class.jsp" target="_blank" rel="noopener">Sqlè½¬Class</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://fontawesome.com/icons?d=gallery&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å›¾æ ‡&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.processon.com/diagram
      
    
    </summary>
    
    
      <category term="å·¥å…·" scheme="https://hsb786.github.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>EasyUI</title>
    <link href="https://hsb786.github.io/2018/04/11/EasyUI/"/>
    <id>https://hsb786.github.io/2018/04/11/EasyUI/</id>
    <published>2018-04-11T03:28:06.000Z</published>
    <updated>2018-04-13T03:36:44.401Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å½“è¯·æ±‚è¿œç¨‹æ•°æ®æ—¶ï¼Œå‘é€çš„é¢å¤–å‚æ•°ã€‚</strong></p><p>åœ¨datagridæ„é€ ä¸­åŠ å…¥queryParamså‚æ•°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dataGrid = $(&apos;#dg&apos;).datagrid(&#123;</span><br><span class="line">url : &apos;$&#123;pageContext.request.contextPath&#125;/companys/datagrid&apos;,</span><br><span class="line">method : &apos;GET&apos;,</span><br><span class="line">.........................</span><br><span class="line">queryParams : &#123;</span><br><span class="line">//ä¼ å…¥å½“å‰æ—¥æœŸæŸ¥è¯¢</span><br><span class="line">startTime : getNowFormatDate()</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p><strong>é‡æ–°åŠ è½½è¡Œï¼Œä¿æŒåœ¨å½“å‰é¡µ</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&apos;#dg&apos;).datagrid(&apos;reload&apos;);</span><br></pre></td></tr></table></figure></p><p><strong>åŠ è½½å¹¶æ˜¾ç¤ºç¬¬ä¸€é¡µçš„è¡Œ,é€šè¿‡ä¼ é€’ä¸€äº›ä»å‚æ•°è¿›è¡ŒæŸ¥è¯¢ï¼Œè¯¥æ–¹æ³•è¢«è°ƒç”¨æ¥ä»æœåŠ¡å™¨åŠ è½½æ–°æ•°æ®ã€‚</strong> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;#dg&quot;).datagrid(&apos;load&apos;, &#123;</span><br><span class="line">&quot;job.name&quot; : $(&quot;#jobname&quot;).val(),</span><br><span class="line">&quot;user.realname&quot; : $(&quot;#realname&quot;).val()</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;å½“è¯·æ±‚è¿œç¨‹æ•°æ®æ—¶ï¼Œå‘é€çš„é¢å¤–å‚æ•°ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨datagridæ„é€ ä¸­åŠ å…¥queryParamså‚æ•°&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;p
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://hsb786.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>KingEditor</title>
    <link href="https://hsb786.github.io/2018/04/11/KingEditor/"/>
    <id>https://hsb786.github.io/2018/04/11/KingEditor/</id>
    <published>2018-04-11T03:22:23.000Z</published>
    <updated>2018-04-13T03:27:29.695Z</updated>
    
    <content type="html"><![CDATA[<p>å®˜æ–¹æ–‡æ¡£ç¤ºä¾‹ åˆå§‹åŒ–ï¼›å±äºå¼‚æ­¥åŠ è½½<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KindEditor.ready(function(K) &#123;</span><br><span class="line">               window.editor = K.create(&apos;#editor_id&apos;);</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure></p><p>åŒæ­¥åŠ è½½ï¼›ç›´æ¥è°ƒç”¨KindEditoråˆ›å»ºï¼Œè€Œä¸æ˜¯ç­‰KindEditor.readyåå†åˆ›å»º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">about = KindEditor.create(&apos;textarea[id=&quot;about&quot;]&apos;, &#123;</span><br><span class="line">items : [ &apos;cut&apos;, &apos;copy&apos;, &apos;paste&apos;, &apos;justifyleft&apos;, &apos;justifycenter&apos;,</span><br><span class="line">&apos;justifyright&apos;, &apos;justifyfull&apos;, &apos;insertorderedlist&apos;,</span><br><span class="line">&apos;insertunorderedlist&apos;, &apos;indent&apos;, &apos;outdent&apos;, &apos;subscript&apos;,</span><br><span class="line">&apos;superscript&apos;, &apos;clearhtml&apos;, &apos;quickformat&apos;, &apos;selectall&apos;,</span><br><span class="line">&apos;|&apos;, &apos;fullscreen&apos;, &apos;/&apos;, &apos;formatblock&apos;, &apos;fontname&apos;,</span><br><span class="line">&apos;fontsize&apos;, &apos;|&apos;, &apos;forecolor&apos;, &apos;hilitecolor&apos;, &apos;bold&apos;,</span><br><span class="line">&apos;italic&apos;, &apos;underline&apos;, &apos;strikethrough&apos;, &apos;lineheight&apos;,</span><br><span class="line">&apos;removeformat&apos;, &apos;|&apos;, &apos;table&apos;, &apos;hr&apos;, &apos;emoticons&apos;,</span><br><span class="line">&apos;pagebreak&apos; ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å®˜æ–¹æ–‡æ¡£ç¤ºä¾‹ åˆå§‹åŒ–ï¼›å±äºå¼‚æ­¥åŠ è½½&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://hsb786.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>HTTPçŠ¶æ€ç </title>
    <link href="https://hsb786.github.io/2018/04/10/HTTP%E7%8A%B6%E6%80%81%E7%A0%81/"/>
    <id>https://hsb786.github.io/2018/04/10/HTTPçŠ¶æ€ç /</id>
    <published>2018-04-10T12:27:44.000Z</published>
    <updated>2018-04-11T04:16:31.866Z</updated>
    
    <content type="html"><![CDATA[<p>HTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚å®ƒç”± RFC 2616 è§„èŒƒå®šä¹‰çš„ï¼Œå¹¶å¾—åˆ°RFC 2518ã€RFC 2817ã€RFC 2295ã€RFC 2774ã€RFC 4918ç­‰è§„èŒƒæ‰©å±•ã€‚<br><a id="more"></a></p><table><thead><tr><th>status</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>100</td><td>å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚ã€‚è¿™ä¸ªä¸´æ—¶å“åº”æ˜¯ç”¨æ¥é€šçŸ¥å®¢æˆ·ç«¯å®ƒçš„éƒ¨åˆ†è¯·æ±‚å·²ç»è¢«æœåŠ¡å™¨æ¥æ”¶ï¼Œä¸”ä»æœªè¢«æ‹’ç»ã€‚å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ–è€…å¦‚æœè¯·æ±‚å·²ç»å®Œæˆï¼Œå¿½ç•¥è¿™ä¸ªå“åº”ã€‚æœåŠ¡å™¨å¿…é¡»åœ¨è¯·æ±‚å®Œæˆåå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæœ€ç»ˆå“åº”ã€‚</td></tr><tr><td>101</td><td>æœåŠ¡å™¨å·²ç»ç†è§£äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†é€šè¿‡Upgrade æ¶ˆæ¯å¤´é€šçŸ¥å®¢æˆ·ç«¯é‡‡ç”¨ä¸åŒçš„åè®®æ¥å®Œæˆè¿™ä¸ªè¯·æ±‚ã€‚åœ¨å‘é€å®Œè¿™ä¸ªå“åº”æœ€åçš„ç©ºè¡Œåï¼ŒæœåŠ¡å™¨å°†ä¼šåˆ‡æ¢åˆ°åœ¨Upgrade æ¶ˆæ¯å¤´ä¸­å®šä¹‰çš„é‚£äº›åè®®ã€‚ ã€€ã€€åªæœ‰åœ¨åˆ‡æ¢æ–°çš„åè®®æ›´æœ‰å¥½å¤„çš„æ—¶å€™æ‰åº”è¯¥é‡‡å–ç±»ä¼¼æªæ–½ã€‚ä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°æ–°çš„HTTP ç‰ˆæœ¬æ¯”æ—§ç‰ˆæœ¬æ›´æœ‰ä¼˜åŠ¿ï¼Œæˆ–è€…åˆ‡æ¢åˆ°ä¸€ä¸ªå®æ—¶ä¸”åŒæ­¥çš„åè®®ä»¥ä¼ é€åˆ©ç”¨æ­¤ç±»ç‰¹æ€§çš„èµ„æºã€‚</td></tr><tr><td>102</td><td>ç”±WebDAVï¼ˆRFC 2518ï¼‰æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨å¤„ç†å°†è¢«ç»§ç»­æ‰§è¡Œã€‚</td></tr><tr><td>200</td><td>è¯·æ±‚å·²æˆåŠŸï¼Œè¯·æ±‚æ‰€å¸Œæœ›çš„å“åº”å¤´æˆ–æ•°æ®ä½“å°†éšæ­¤å“åº”è¿”å›ã€‚</td></tr><tr><td>201</td><td>è¯·æ±‚å·²ç»è¢«å®ç°ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªæ–°çš„èµ„æºå·²ç»ä¾æ®è¯·æ±‚çš„éœ€è¦è€Œå»ºç«‹ï¼Œä¸”å…¶ URI å·²ç»éšLocation å¤´ä¿¡æ¯è¿”å›ã€‚å‡å¦‚éœ€è¦çš„èµ„æºæ— æ³•åŠæ—¶å»ºç«‹çš„è¯ï¼Œåº”å½“è¿”å› â€˜202 Acceptedâ€™ã€‚</td></tr><tr><td>202</td><td>æœåŠ¡å™¨å·²æ¥å—è¯·æ±‚ï¼Œä½†å°šæœªå¤„ç†ã€‚æ­£å¦‚å®ƒå¯èƒ½è¢«æ‹’ç»ä¸€æ ·ï¼Œæœ€ç»ˆè¯¥è¯·æ±‚å¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚åœ¨å¼‚æ­¥æ“ä½œçš„åœºåˆä¸‹ï¼Œæ²¡æœ‰æ¯”å‘é€è¿™ä¸ªçŠ¶æ€ç æ›´æ–¹ä¾¿çš„åšæ³•äº†ã€‚ ã€€ã€€è¿”å›202çŠ¶æ€ç çš„å“åº”çš„ç›®çš„æ˜¯å…è®¸æœåŠ¡å™¨æ¥å—å…¶ä»–è¿‡ç¨‹çš„è¯·æ±‚ï¼ˆä¾‹å¦‚æŸä¸ªæ¯å¤©åªæ‰§è¡Œä¸€æ¬¡çš„åŸºäºæ‰¹å¤„ç†çš„æ“ä½œï¼‰ï¼Œè€Œä¸å¿…è®©å®¢æˆ·ç«¯ä¸€ç›´ä¿æŒä¸æœåŠ¡å™¨çš„è¿æ¥ç›´åˆ°æ‰¹å¤„ç†æ“ä½œå…¨éƒ¨å®Œæˆã€‚åœ¨æ¥å—è¯·æ±‚å¤„ç†å¹¶è¿”å›202çŠ¶æ€ç çš„å“åº”åº”å½“åœ¨è¿”å›çš„å®ä½“ä¸­åŒ…å«ä¸€äº›æŒ‡ç¤ºå¤„ç†å½“å‰çŠ¶æ€çš„ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘å¤„ç†çŠ¶æ€ç›‘è§†å™¨æˆ–çŠ¶æ€é¢„æµ‹çš„æŒ‡é’ˆï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿä¼°è®¡æ“ä½œæ˜¯å¦å·²ç»å®Œæˆã€‚</td></tr><tr><td>203</td><td>æœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†è¿”å›çš„å®ä½“å¤´éƒ¨å…ƒä¿¡æ¯ä¸æ˜¯åœ¨åŸå§‹æœåŠ¡å™¨ä¸Šæœ‰æ•ˆçš„ç¡®å®šé›†åˆï¼Œè€Œæ˜¯æ¥è‡ªæœ¬åœ°æˆ–è€…ç¬¬ä¸‰æ–¹çš„æ‹·è´ã€‚å½“å‰çš„ä¿¡æ¯å¯èƒ½æ˜¯åŸå§‹ç‰ˆæœ¬çš„å­é›†æˆ–è€…è¶…é›†ã€‚ä¾‹å¦‚ï¼ŒåŒ…å«èµ„æºçš„å…ƒæ•°æ®å¯èƒ½å¯¼è‡´åŸå§‹æœåŠ¡å™¨çŸ¥é“å…ƒä¿¡æ¯çš„è¶…çº§ã€‚ä½¿ç”¨æ­¤çŠ¶æ€ç ä¸æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”åªæœ‰åœ¨å“åº”ä¸ä½¿ç”¨æ­¤çŠ¶æ€ç ä¾¿ä¼šè¿”å›200 OKçš„æƒ…å†µä¸‹æ‰æ˜¯åˆé€‚çš„ã€‚</td></tr><tr><td>204</td><td>æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†ä¸éœ€è¦è¿”å›ä»»ä½•å®ä½“å†…å®¹ï¼Œå¹¶ä¸”å¸Œæœ›è¿”å›æ›´æ–°äº†çš„å…ƒä¿¡æ¯ã€‚å“åº”å¯èƒ½é€šè¿‡å®ä½“å¤´éƒ¨çš„å½¢å¼ï¼Œè¿”å›æ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯ã€‚å¦‚æœå­˜åœ¨è¿™äº›å¤´éƒ¨ä¿¡æ¯ï¼Œåˆ™åº”å½“ä¸æ‰€è¯·æ±‚çš„å˜é‡ç›¸å‘¼åº”ã€‚ ã€€ã€€å¦‚æœå®¢æˆ·ç«¯æ˜¯æµè§ˆå™¨çš„è¯ï¼Œé‚£ä¹ˆç”¨æˆ·æµè§ˆå™¨åº”ä¿ç•™å‘é€äº†è¯¥è¯·æ±‚çš„é¡µé¢ï¼Œè€Œä¸äº§ç”Ÿä»»ä½•æ–‡æ¡£è§†å›¾ä¸Šçš„å˜åŒ–ï¼Œå³ä½¿æŒ‰ç…§è§„èŒƒæ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯åº”å½“è¢«åº”ç”¨åˆ°ç”¨æˆ·æµè§ˆå™¨æ´»åŠ¨è§†å›¾ä¸­çš„æ–‡æ¡£ã€‚ ã€€ã€€ç”±äº204å“åº”è¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œå› æ­¤å®ƒå§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚</td></tr><tr><td>205</td><td>æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä¸”æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ä½†æ˜¯ä¸204å“åº”ä¸åŒï¼Œè¿”å›æ­¤çŠ¶æ€ç çš„å“åº”è¦æ±‚è¯·æ±‚è€…é‡ç½®æ–‡æ¡£è§†å›¾ã€‚è¯¥å“åº”ä¸»è¦æ˜¯è¢«ç”¨äºæ¥å—ç”¨æˆ·è¾“å…¥åï¼Œç«‹å³é‡ç½®è¡¨å•ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°å¼€å§‹å¦ä¸€æ¬¡è¾“å…¥ã€‚ ã€€ã€€ä¸204å“åº”ä¸€æ ·ï¼Œè¯¥å“åº”ä¹Ÿè¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œä¸”ä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“æŸã€‚</td></tr><tr><td>206</td><td>æœåŠ¡å™¨å·²ç»æˆåŠŸå¤„ç†äº†éƒ¨åˆ† GET è¯·æ±‚ã€‚ç±»ä¼¼äº FlashGet æˆ–è€…è¿…é›·è¿™ç±»çš„ HTTP ä¸‹è½½å·¥å…·éƒ½æ˜¯ä½¿ç”¨æ­¤ç±»å“åº”å®ç°æ–­ç‚¹ç»­ä¼ æˆ–è€…å°†ä¸€ä¸ªå¤§æ–‡æ¡£åˆ†è§£ä¸ºå¤šä¸ªä¸‹è½½æ®µåŒæ—¶ä¸‹è½½ã€‚ ã€€ã€€è¯¥è¯·æ±‚å¿…é¡»åŒ…å« Range å¤´ä¿¡æ¯æ¥æŒ‡ç¤ºå®¢æˆ·ç«¯å¸Œæœ›å¾—åˆ°çš„å†…å®¹èŒƒå›´ï¼Œå¹¶ä¸”å¯èƒ½åŒ…å« If-Range æ¥ä½œä¸ºè¯·æ±‚æ¡ä»¶ã€‚ ã€€ã€€å“åº”å¿…é¡»åŒ…å«å¦‚ä¸‹çš„å¤´éƒ¨åŸŸï¼š ã€€ã€€Content-Range ç”¨ä»¥æŒ‡ç¤ºæœ¬æ¬¡å“åº”ä¸­è¿”å›çš„å†…å®¹çš„èŒƒå›´ï¼›å¦‚æœæ˜¯ Content-Type ä¸º multipart/byteranges çš„å¤šæ®µä¸‹è½½ï¼Œåˆ™æ¯ä¸€ multipart æ®µä¸­éƒ½åº”åŒ…å« Content-Range åŸŸç”¨ä»¥æŒ‡ç¤ºæœ¬æ®µçš„å†…å®¹èŒƒå›´ã€‚å‡å¦‚å“åº”ä¸­åŒ…å« Content-Lengthï¼Œé‚£ä¹ˆå®ƒçš„æ•°å€¼å¿…é¡»åŒ¹é…å®ƒè¿”å›çš„å†…å®¹èŒƒå›´çš„çœŸå®å­—èŠ‚æ•°ã€‚ ã€€ã€€Date ã€€ã€€ETag å’Œ/æˆ– Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¯¥è¿”å›200å“åº”ã€‚ ã€€ã€€Expires, Cache-Controlï¼Œå’Œ/æˆ– Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚ ã€€ã€€å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº† If-Range å¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å‡å¦‚æœ¬å“åº”çš„è¯·æ±‚ä½¿ç”¨äº† If-Range å¼±ç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚å¦åˆ™ï¼Œæœ¬å“åº”å°±åº”å½“åŒ…å«æ‰€æœ‰æœ¬åº”è¯¥è¿”å›200å“åº”ä¸­åº”å½“è¿”å›çš„æ‰€æœ‰å®ä½“å¤´éƒ¨åŸŸã€‚ ã€€ã€€å‡å¦‚ ETag æˆ– Last-Modified å¤´éƒ¨ä¸èƒ½ç²¾ç¡®åŒ¹é…çš„è¯ï¼Œåˆ™å®¢æˆ·ç«¯ç¼“å­˜åº”ç¦æ­¢å°†206å“åº”è¿”å›çš„å†…å®¹ä¸ä¹‹å‰ä»»ä½•ç¼“å­˜è¿‡çš„å†…å®¹ç»„åˆåœ¨ä¸€èµ·ã€‚ ã€€ã€€ä»»ä½•ä¸æ”¯æŒ Range ä»¥åŠ Content-Range å¤´çš„ç¼“å­˜éƒ½ç¦æ­¢ç¼“å­˜206å“åº”è¿”å›çš„å†…å®¹ã€‚</td></tr><tr><td>207</td><td>ç”±WebDAV(RFC 2518)æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨ä¹‹åçš„æ¶ˆæ¯ä½“å°†æ˜¯ä¸€ä¸ªXMLæ¶ˆæ¯ï¼Œå¹¶ä¸”å¯èƒ½ä¾ç…§ä¹‹å‰å­è¯·æ±‚æ•°é‡çš„ä¸åŒï¼ŒåŒ…å«ä¸€ç³»åˆ—ç‹¬ç«‹çš„å“åº”ä»£ç ã€‚</td></tr><tr><td>300</td><td>è¢«è¯·æ±‚çš„èµ„æºæœ‰ä¸€ç³»åˆ—å¯ä¾›é€‰æ‹©çš„å›é¦ˆä¿¡æ¯ï¼Œæ¯ä¸ªéƒ½æœ‰è‡ªå·±ç‰¹å®šçš„åœ°å€å’Œæµè§ˆå™¨é©±åŠ¨çš„å•†è®®ä¿¡æ¯ã€‚ç”¨æˆ·æˆ–æµè§ˆå™¨èƒ½å¤Ÿè‡ªè¡Œé€‰æ‹©ä¸€ä¸ªé¦–é€‰çš„åœ°å€è¿›è¡Œé‡å®šå‘ã€‚ ã€€ã€€é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”åº”å½“åŒ…æ‹¬ä¸€ä¸ªèµ„æºç‰¹æ€§åŠåœ°å€çš„åˆ—è¡¨çš„å®ä½“ï¼Œä»¥ä¾¿ç”¨æˆ·æˆ–æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„é‡å®šå‘åœ°å€ã€‚è¿™ä¸ªå®ä½“çš„æ ¼å¼ç”± Content-Type å®šä¹‰çš„æ ¼å¼æ‰€å†³å®šã€‚æµè§ˆå™¨å¯èƒ½æ ¹æ®å“åº”çš„æ ¼å¼ä»¥åŠæµè§ˆå™¨è‡ªèº«èƒ½åŠ›ï¼Œè‡ªåŠ¨ä½œå‡ºæœ€åˆé€‚çš„é€‰æ‹©ã€‚å½“ç„¶ï¼ŒRFC 2616è§„èŒƒå¹¶æ²¡æœ‰è§„å®šè¿™æ ·çš„è‡ªåŠ¨é€‰æ‹©è¯¥å¦‚ä½•è¿›è¡Œã€‚ ã€€ã€€å¦‚æœæœåŠ¡å™¨æœ¬èº«å·²ç»æœ‰äº†é¦–é€‰çš„å›é¦ˆé€‰æ‹©ï¼Œé‚£ä¹ˆåœ¨ Location ä¸­åº”å½“æŒ‡æ˜è¿™ä¸ªå›é¦ˆçš„ URIï¼›æµè§ˆå™¨å¯èƒ½ä¼šå°†è¿™ä¸ª Location å€¼ä½œä¸ºè‡ªåŠ¨é‡å®šå‘çš„åœ°å€ã€‚æ­¤å¤–ï¼Œé™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚</td></tr><tr><td>301</td><td>è¢«è¯·æ±‚çš„èµ„æºå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼Œå¹¶ä¸”å°†æ¥ä»»ä½•å¯¹æ­¤èµ„æºçš„å¼•ç”¨éƒ½åº”è¯¥ä½¿ç”¨æœ¬å“åº”è¿”å›çš„è‹¥å¹²ä¸ª URI ä¹‹ä¸€ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“è‡ªåŠ¨æŠŠè¯·æ±‚çš„åœ°å€ä¿®æ”¹ä¸ºä»æœåŠ¡å™¨åé¦ˆå›æ¥çš„åœ°å€ã€‚é™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚ ã€€ã€€æ–°çš„æ°¸ä¹…æ€§çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ ã€€ã€€å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª GET æˆ–è€… HEAD è¯·æ±‚ï¼Œå› æ­¤æµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ ã€€ã€€æ³¨æ„ï¼šå¯¹äºæŸäº›ä½¿ç”¨ HTTP/1.0 åè®®çš„æµè§ˆå™¨ï¼Œå½“å®ƒä»¬å‘é€çš„ POST è¯·æ±‚å¾—åˆ°äº†ä¸€ä¸ª301å“åº”çš„è¯ï¼Œæ¥ä¸‹æ¥çš„é‡å®šå‘è¯·æ±‚å°†ä¼šå˜æˆ GET æ–¹å¼ã€‚</td></tr><tr><td>302</td><td>è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„ URI å“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚ ã€€ã€€æ–°çš„ä¸´æ—¶æ€§çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ ã€€ã€€å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª GET æˆ–è€… HEAD è¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚ ã€€ã€€æ³¨æ„ï¼šè™½ç„¶RFC 1945å’ŒRFC 2068è§„èŒƒä¸å…è®¸å®¢æˆ·ç«¯åœ¨é‡å®šå‘æ—¶æ”¹å˜è¯·æ±‚çš„æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå¤šç°å­˜çš„æµè§ˆå™¨å°†302å“åº”è§†ä½œä¸º303å“åº”ï¼Œå¹¶ä¸”ä½¿ç”¨ GET æ–¹å¼è®¿é—®åœ¨ Location ä¸­è§„å®šçš„ URIï¼Œè€Œæ— è§†åŸå…ˆè¯·æ±‚çš„æ–¹æ³•ã€‚çŠ¶æ€ç 303å’Œ307è¢«æ·»åŠ äº†è¿›æ¥ï¼Œç”¨ä»¥æ˜ç¡®æœåŠ¡å™¨æœŸå¾…å®¢æˆ·ç«¯è¿›è¡Œä½•ç§ååº”ã€‚</td></tr><tr><td>303</td><td>å¯¹åº”å½“å‰è¯·æ±‚çš„å“åº”å¯ä»¥åœ¨å¦ä¸€ä¸ª URI ä¸Šè¢«æ‰¾åˆ°ï¼Œè€Œä¸”å®¢æˆ·ç«¯åº”å½“é‡‡ç”¨ GET çš„æ–¹å¼è®¿é—®é‚£ä¸ªèµ„æºã€‚è¿™ä¸ªæ–¹æ³•çš„å­˜åœ¨ä¸»è¦æ˜¯ä¸ºäº†å…è®¸ç”±è„šæœ¬æ¿€æ´»çš„POSTè¯·æ±‚è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–°çš„èµ„æºã€‚è¿™ä¸ªæ–°çš„ URI ä¸æ˜¯åŸå§‹èµ„æºçš„æ›¿ä»£å¼•ç”¨ã€‚åŒæ—¶ï¼Œ303å“åº”ç¦æ­¢è¢«ç¼“å­˜ã€‚å½“ç„¶ï¼Œç¬¬äºŒä¸ªè¯·æ±‚ï¼ˆé‡å®šå‘ï¼‰å¯èƒ½è¢«ç¼“å­˜ã€‚ ã€€ã€€æ–°çš„ URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„ URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚ ã€€ã€€æ³¨æ„ï¼šè®¸å¤š HTTP/1.1 ç‰ˆä»¥å‰çš„ æµè§ˆå™¨ä¸èƒ½æ­£ç¡®ç†è§£303çŠ¶æ€ã€‚å¦‚æœéœ€è¦è€ƒè™‘ä¸è¿™äº›æµè§ˆå™¨ä¹‹é—´çš„äº’åŠ¨ï¼Œ302çŠ¶æ€ç åº”è¯¥å¯ä»¥èƒœä»»ï¼Œå› ä¸ºå¤§å¤šæ•°çš„æµè§ˆå™¨å¤„ç†302å“åº”æ—¶çš„æ–¹å¼æ°æ°å°±æ˜¯ä¸Šè¿°è§„èŒƒè¦æ±‚å®¢æˆ·ç«¯å¤„ç†303å“åº”æ—¶åº”å½“åšçš„ã€‚</td></tr><tr><td>304</td><td>å¦‚æœå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªå¸¦æ¡ä»¶çš„ GET è¯·æ±‚ä¸”è¯¥è¯·æ±‚å·²è¢«å…è®¸ï¼Œè€Œæ–‡æ¡£çš„å†…å®¹ï¼ˆè‡ªä¸Šæ¬¡è®¿é—®ä»¥æ¥æˆ–è€…æ ¹æ®è¯·æ±‚çš„æ¡ä»¶ï¼‰å¹¶æ²¡æœ‰æ”¹å˜ï¼Œåˆ™æœåŠ¡å™¨åº”å½“è¿”å›è¿™ä¸ªçŠ¶æ€ç ã€‚304å“åº”ç¦æ­¢åŒ…å«æ¶ˆæ¯ä½“ï¼Œå› æ­¤å§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚ ã€€ã€€è¯¥å“åº”å¿…é¡»åŒ…å«ä»¥ä¸‹çš„å¤´ä¿¡æ¯ï¼š ã€€ã€€Dateï¼Œé™¤éè¿™ä¸ªæœåŠ¡å™¨æ²¡æœ‰æ—¶é’Ÿã€‚å‡å¦‚æ²¡æœ‰æ—¶é’Ÿçš„æœåŠ¡å™¨ä¹Ÿéµå®ˆè¿™äº›è§„åˆ™ï¼Œé‚£ä¹ˆä»£ç†æœåŠ¡å™¨ä»¥åŠå®¢æˆ·ç«¯å¯ä»¥è‡ªè¡Œå°† Date å­—æ®µæ·»åŠ åˆ°æ¥æ”¶åˆ°çš„å“åº”å¤´ä¸­å»ï¼ˆæ­£å¦‚RFC 2068ä¸­è§„å®šçš„ä¸€æ ·ï¼‰ï¼Œç¼“å­˜æœºåˆ¶å°†ä¼šæ­£å¸¸å·¥ä½œã€‚ ã€€ã€€ETag å’Œ/æˆ– Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¿”å›200å“åº”ã€‚ ã€€ã€€Expires, Cache-Controlï¼Œå’Œ/æˆ–Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚ ã€€ã€€å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº†å¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å¦åˆ™ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ªå¸¦æ¡ä»¶çš„ GET è¯·æ±‚ä½¿ç”¨äº†å¼±ç¼“å­˜éªŒè¯ï¼‰ï¼Œæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜äº†çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚ ã€€ã€€å‡å¦‚æŸä¸ª304å“åº”æŒ‡æ˜äº†å½“å‰æŸä¸ªå®ä½“æ²¡æœ‰ç¼“å­˜ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»å¿½è§†è¿™ä¸ªå“åº”ï¼Œå¹¶ä¸”é‡å¤å‘é€ä¸åŒ…å«é™åˆ¶æ¡ä»¶çš„è¯·æ±‚ã€‚ ã€€ã€€å‡å¦‚æ¥æ”¶åˆ°ä¸€ä¸ªè¦æ±‚æ›´æ–°æŸä¸ªç¼“å­˜æ¡ç›®çš„304å“åº”ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»æ›´æ–°æ•´ä¸ªæ¡ç›®ä»¥åæ˜ æ‰€æœ‰åœ¨å“åº”ä¸­è¢«æ›´æ–°çš„å­—æ®µçš„å€¼ã€‚</td></tr><tr><td>305</td><td>è¢«è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡æŒ‡å®šçš„ä»£ç†æ‰èƒ½è¢«è®¿é—®ã€‚Location åŸŸä¸­å°†ç»™å‡ºæŒ‡å®šçš„ä»£ç†æ‰€åœ¨çš„ URI ä¿¡æ¯ï¼Œæ¥æ”¶è€…éœ€è¦é‡å¤å‘é€ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œé€šè¿‡è¿™ä¸ªä»£ç†æ‰èƒ½è®¿é—®ç›¸åº”èµ„æºã€‚åªæœ‰åŸå§‹æœåŠ¡å™¨æ‰èƒ½å»ºç«‹305å“åº”ã€‚ ã€€ã€€æ³¨æ„ï¼šRFC 2068ä¸­æ²¡æœ‰æ˜ç¡®305å“åº”æ˜¯ä¸ºäº†é‡å®šå‘ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œè€Œä¸”åªèƒ½è¢«åŸå§‹æœåŠ¡å™¨å»ºç«‹ã€‚å¿½è§†è¿™äº›é™åˆ¶å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å®‰å…¨åæœã€‚</td></tr><tr><td>306</td><td>åœ¨æœ€æ–°ç‰ˆçš„è§„èŒƒä¸­ï¼Œ306çŠ¶æ€ç å·²ç»ä¸å†è¢«ä½¿ç”¨ã€‚</td></tr><tr><td>307</td><td>è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„URI å“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚ ã€€ã€€æ–°çš„ä¸´æ—¶æ€§çš„URI åº”å½“åœ¨å“åº”çš„ Location åŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEAD è¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„URI çš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚å› ä¸ºéƒ¨åˆ†æµè§ˆå™¨ä¸èƒ½è¯†åˆ«307å“åº”ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä¸Šè¿°å¿…è¦ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿç†è§£å¹¶å‘æ–°çš„ URI å‘å‡ºè®¿é—®è¯·æ±‚ã€‚ ã€€ã€€å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ªGET æˆ–è€… HEAD è¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚</td></tr><tr><td>400</td><td>1ã€è¯­ä¹‰æœ‰è¯¯ï¼Œå½“å‰è¯·æ±‚æ— æ³•è¢«æœåŠ¡å™¨ç†è§£ã€‚é™¤éè¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¸åº”è¯¥é‡å¤æäº¤è¿™ä¸ªè¯·æ±‚ã€‚ ã€€ã€€2ã€è¯·æ±‚å‚æ•°æœ‰è¯¯ã€‚</td></tr><tr><td>401</td><td>å½“å‰è¯·æ±‚éœ€è¦ç”¨æˆ·éªŒè¯ã€‚è¯¥å“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªé€‚ç”¨äºè¢«è¯·æ±‚èµ„æºçš„ WWW-Authenticate ä¿¡æ¯å¤´ç”¨ä»¥è¯¢é—®ç”¨æˆ·ä¿¡æ¯ã€‚å®¢æˆ·ç«¯å¯ä»¥é‡å¤æäº¤ä¸€ä¸ªåŒ…å«æ°å½“çš„ Authorization å¤´ä¿¡æ¯çš„è¯·æ±‚ã€‚å¦‚æœå½“å‰è¯·æ±‚å·²ç»åŒ…å«äº† Authorization è¯ä¹¦ï¼Œé‚£ä¹ˆ401å“åº”ä»£è¡¨ç€æœåŠ¡å™¨éªŒè¯å·²ç»æ‹’ç»äº†é‚£äº›è¯ä¹¦ã€‚å¦‚æœ401å“åº”åŒ…å«äº†ä¸å‰ä¸€ä¸ªå“åº”ç›¸åŒçš„èº«ä»½éªŒè¯è¯¢é—®ï¼Œä¸”æµè§ˆå™¨å·²ç»è‡³å°‘å°è¯•äº†ä¸€æ¬¡éªŒè¯ï¼Œé‚£ä¹ˆæµè§ˆå™¨åº”å½“å‘ç”¨æˆ·å±•ç¤ºå“åº”ä¸­åŒ…å«çš„å®ä½“ä¿¡æ¯ï¼Œå› ä¸ºè¿™ä¸ªå®ä½“ä¿¡æ¯ä¸­å¯èƒ½åŒ…å«äº†ç›¸å…³è¯Šæ–­ä¿¡æ¯ã€‚å‚è§RFC 2617ã€‚</td></tr><tr><td>402</td><td>è¯¥çŠ¶æ€ç æ˜¯ä¸ºäº†å°†æ¥å¯èƒ½çš„éœ€æ±‚è€Œé¢„ç•™çš„ã€‚</td></tr><tr><td>403</td><td>æœåŠ¡å™¨å·²ç»ç†è§£è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œå®ƒã€‚ä¸401å“åº”ä¸åŒçš„æ˜¯ï¼Œèº«ä»½éªŒè¯å¹¶ä¸èƒ½æä¾›ä»»ä½•å¸®åŠ©ï¼Œè€Œä¸”è¿™ä¸ªè¯·æ±‚ä¹Ÿä¸åº”è¯¥è¢«é‡å¤æäº¤ã€‚å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œè€Œä¸”æœåŠ¡å™¨å¸Œæœ›èƒ½å¤Ÿè®²æ¸…æ¥šä¸ºä½•è¯·æ±‚ä¸èƒ½è¢«æ‰§è¡Œï¼Œé‚£ä¹ˆå°±åº”è¯¥åœ¨å®ä½“å†…æè¿°æ‹’ç»çš„åŸå› ã€‚å½“ç„¶æœåŠ¡å™¨ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª404å“åº”ï¼Œå‡å¦‚å®ƒä¸å¸Œæœ›è®©å®¢æˆ·ç«¯è·å¾—ä»»ä½•ä¿¡æ¯ã€‚</td></tr><tr><td>404</td><td>è¯·æ±‚å¤±è´¥ï¼Œè¯·æ±‚æ‰€å¸Œæœ›å¾—åˆ°çš„èµ„æºæœªè¢«åœ¨æœåŠ¡å™¨ä¸Šå‘ç°ã€‚æ²¡æœ‰ä¿¡æ¯èƒ½å¤Ÿå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªçŠ¶å†µåˆ°åº•æ˜¯æš‚æ—¶çš„è¿˜æ˜¯æ°¸ä¹…çš„ã€‚å‡å¦‚æœåŠ¡å™¨çŸ¥é“æƒ…å†µçš„è¯ï¼Œåº”å½“ä½¿ç”¨410çŠ¶æ€ç æ¥å‘ŠçŸ¥æ—§èµ„æºå› ä¸ºæŸäº›å†…éƒ¨çš„é…ç½®æœºåˆ¶é—®é¢˜ï¼Œå·²ç»æ°¸ä¹…çš„ä¸å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å¯ä»¥è·³è½¬çš„åœ°å€ã€‚404è¿™ä¸ªçŠ¶æ€ç è¢«å¹¿æ³›åº”ç”¨äºå½“æœåŠ¡å™¨ä¸æƒ³æ­ç¤ºåˆ°åº•ä¸ºä½•è¯·æ±‚è¢«æ‹’ç»æˆ–è€…æ²¡æœ‰å…¶ä»–é€‚åˆçš„å“åº”å¯ç”¨çš„æƒ…å†µä¸‹ã€‚</td></tr><tr><td>405</td><td>è¯·æ±‚è¡Œä¸­æŒ‡å®šçš„è¯·æ±‚æ–¹æ³•ä¸èƒ½è¢«ç”¨äºè¯·æ±‚ç›¸åº”çš„èµ„æºã€‚è¯¥å“åº”å¿…é¡»è¿”å›ä¸€ä¸ªAllow å¤´ä¿¡æ¯ç”¨ä»¥è¡¨ç¤ºå‡ºå½“å‰èµ„æºèƒ½å¤Ÿæ¥å—çš„è¯·æ±‚æ–¹æ³•çš„åˆ—è¡¨ã€‚ ã€€ã€€é‰´äº PUTï¼ŒDELETE æ–¹æ³•ä¼šå¯¹æœåŠ¡å™¨ä¸Šçš„èµ„æºè¿›è¡Œå†™æ“ä½œï¼Œå› è€Œç»å¤§éƒ¨åˆ†çš„ç½‘é¡µæœåŠ¡å™¨éƒ½ä¸æ”¯æŒæˆ–è€…åœ¨é»˜è®¤é…ç½®ä¸‹ä¸å…è®¸ä¸Šè¿°è¯·æ±‚æ–¹æ³•ï¼Œå¯¹äºæ­¤ç±»è¯·æ±‚å‡ä¼šè¿”å›405é”™è¯¯ã€‚</td></tr><tr><td>406</td><td>è¯·æ±‚çš„èµ„æºçš„å†…å®¹ç‰¹æ€§æ— æ³•æ»¡è¶³è¯·æ±‚å¤´ä¸­çš„æ¡ä»¶ï¼Œå› è€Œæ— æ³•ç”Ÿæˆå“åº”å®ä½“ã€‚ ã€€ã€€é™¤éè¿™æ˜¯ä¸€ä¸ª HEAD è¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”å°±åº”å½“è¿”å›ä¸€ä¸ªåŒ…å«å¯ä»¥è®©ç”¨æˆ·æˆ–è€…æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„å®ä½“ç‰¹æ€§ä»¥åŠåœ°å€åˆ—è¡¨çš„å®ä½“ã€‚å®ä½“çš„æ ¼å¼ç”± Content-Type å¤´ä¸­å®šä¹‰çš„åª’ä½“ç±»å‹å†³å®šã€‚æµè§ˆå™¨å¯ä»¥æ ¹æ®æ ¼å¼åŠè‡ªèº«èƒ½åŠ›è‡ªè¡Œä½œå‡ºæœ€ä½³é€‰æ‹©ã€‚ä½†æ˜¯ï¼Œè§„èŒƒä¸­å¹¶æ²¡æœ‰å®šä¹‰ä»»ä½•ä½œå‡ºæ­¤ç±»è‡ªåŠ¨é€‰æ‹©çš„æ ‡å‡†ã€‚</td></tr><tr><td>407</td><td>ã€€ä¸401å“åº”ç±»ä¼¼ï¼Œåªä¸è¿‡å®¢æˆ·ç«¯å¿…é¡»åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè¿›è¡Œèº«ä»½éªŒè¯ã€‚ä»£ç†æœåŠ¡å™¨å¿…é¡»è¿”å›ä¸€ä¸ª Proxy-Authenticate ç”¨ä»¥è¿›è¡Œèº«ä»½è¯¢é—®ã€‚å®¢æˆ·ç«¯å¯ä»¥è¿”å›ä¸€ä¸ª Proxy-Authorization ä¿¡æ¯å¤´ç”¨ä»¥éªŒè¯ã€‚å‚è§RFC 2617ã€‚</td></tr><tr><td>408</td><td>è¯·æ±‚è¶…æ—¶ã€‚å®¢æˆ·ç«¯æ²¡æœ‰åœ¨æœåŠ¡å™¨é¢„å¤‡ç­‰å¾…çš„æ—¶é—´å†…å®Œæˆä¸€ä¸ªè¯·æ±‚çš„å‘é€ã€‚å®¢æˆ·ç«¯å¯ä»¥éšæ—¶å†æ¬¡æäº¤è¿™ä¸€è¯·æ±‚è€Œæ— éœ€è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚</td></tr><tr><td>409</td><td>ç”±äºå’Œè¢«è¯·æ±‚çš„èµ„æºçš„å½“å‰çŠ¶æ€ä¹‹é—´å­˜åœ¨å†²çªï¼Œè¯·æ±‚æ— æ³•å®Œæˆã€‚è¿™ä¸ªä»£ç åªå…è®¸ç”¨åœ¨è¿™æ ·çš„æƒ…å†µä¸‹æ‰èƒ½è¢«ä½¿ç”¨ï¼šç”¨æˆ·è¢«è®¤ä¸ºèƒ½å¤Ÿè§£å†³å†²çªï¼Œå¹¶ä¸”ä¼šé‡æ–°æäº¤æ–°çš„è¯·æ±‚ã€‚è¯¥å“åº”åº”å½“åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·å‘ç°å†²çªçš„æºå¤´ã€‚ ã€€ã€€å†²çªé€šå¸¸å‘ç”Ÿäºå¯¹ PUT è¯·æ±‚çš„å¤„ç†ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨é‡‡ç”¨ç‰ˆæœ¬æ£€æŸ¥çš„ç¯å¢ƒä¸‹ï¼ŒæŸæ¬¡ PUT æäº¤çš„å¯¹ç‰¹å®šèµ„æºçš„ä¿®æ”¹è¯·æ±‚æ‰€é™„å¸¦çš„ç‰ˆæœ¬ä¿¡æ¯ä¸ä¹‹å‰çš„æŸä¸ªï¼ˆç¬¬ä¸‰æ–¹ï¼‰è¯·æ±‚å‘å†²çªï¼Œé‚£ä¹ˆæ­¤æ—¶æœåŠ¡å™¨å°±åº”è¯¥è¿”å›ä¸€ä¸ª409é”™è¯¯ï¼Œå‘ŠçŸ¥ç”¨æˆ·è¯·æ±‚æ— æ³•å®Œæˆã€‚æ­¤æ—¶ï¼Œå“åº”å®ä½“ä¸­å¾ˆå¯èƒ½ä¼šåŒ…å«ä¸¤ä¸ªå†²çªç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚æ¯”è¾ƒï¼Œä»¥ä¾¿ç”¨æˆ·é‡æ–°æäº¤å½’å¹¶ä»¥åçš„æ–°ç‰ˆæœ¬ã€‚</td></tr><tr><td>410</td><td>è¢«è¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šå·²ç»ä¸å†å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å·²çŸ¥çš„è½¬å‘åœ°å€ã€‚è¿™æ ·çš„çŠ¶å†µåº”å½“è¢«è®¤ä¸ºæ˜¯æ°¸ä¹…æ€§çš„ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“åœ¨è·å¾—ç”¨æˆ·è®¸å¯ååˆ é™¤æ‰€æœ‰æŒ‡å‘è¿™ä¸ªåœ°å€çš„å¼•ç”¨ã€‚å¦‚æœæœåŠ¡å™¨ä¸çŸ¥é“æˆ–è€…æ— æ³•ç¡®å®šè¿™ä¸ªçŠ¶å†µæ˜¯å¦æ˜¯æ°¸ä¹…çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨404çŠ¶æ€ç ã€‚é™¤éé¢å¤–è¯´æ˜ï¼Œå¦åˆ™è¿™ä¸ªå“åº”æ˜¯å¯ç¼“å­˜çš„ã€‚ ã€€ã€€410å“åº”çš„ç›®çš„ä¸»è¦æ˜¯å¸®åŠ©ç½‘ç«™ç®¡ç†å‘˜ç»´æŠ¤ç½‘ç«™ï¼Œé€šçŸ¥ç”¨æˆ·è¯¥èµ„æºå·²ç»ä¸å†å¯ç”¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ‹¥æœ‰è€…å¸Œæœ›æ‰€æœ‰æŒ‡å‘è¿™ä¸ªèµ„æºçš„è¿œç«¯è¿æ¥ä¹Ÿè¢«åˆ é™¤ã€‚è¿™ç±»äº‹ä»¶åœ¨é™æ—¶ã€å¢å€¼æœåŠ¡ä¸­å¾ˆæ™®éã€‚åŒæ ·ï¼Œ410å“åº”ä¹Ÿè¢«ç”¨äºé€šçŸ¥å®¢æˆ·ç«¯åœ¨å½“å‰æœåŠ¡å™¨ç«™ç‚¹ä¸Šï¼ŒåŸæœ¬å±äºæŸä¸ªä¸ªäººçš„èµ„æºå·²ç»ä¸å†å¯ç”¨ã€‚å½“ç„¶ï¼Œæ˜¯å¦éœ€è¦æŠŠæ‰€æœ‰æ°¸ä¹…ä¸å¯ç”¨çš„èµ„æºæ ‡è®°ä¸ºâ€™410 Goneâ€™ï¼Œä»¥åŠæ˜¯å¦éœ€è¦ä¿æŒæ­¤æ ‡è®°å¤šé•¿æ—¶é—´ï¼Œå®Œå…¨å–å†³äºæœåŠ¡å™¨æ‹¥æœ‰è€…ã€‚</td></tr><tr><td>411</td><td>æœåŠ¡å™¨æ‹’ç»åœ¨æ²¡æœ‰å®šä¹‰ Content-Length å¤´çš„æƒ…å†µä¸‹æ¥å—è¯·æ±‚ã€‚åœ¨æ·»åŠ äº†è¡¨æ˜è¯·æ±‚æ¶ˆæ¯ä½“é•¿åº¦çš„æœ‰æ•ˆ Content-Length å¤´ä¹‹åï¼Œå®¢æˆ·ç«¯å¯ä»¥å†æ¬¡æäº¤è¯¥è¯·æ±‚ã€‚</td></tr><tr><td>412</td><td>æœåŠ¡å™¨åœ¨éªŒè¯åœ¨è¯·æ±‚çš„å¤´å­—æ®µä¸­ç»™å‡ºå…ˆå†³æ¡ä»¶æ—¶ï¼Œæ²¡èƒ½æ»¡è¶³å…¶ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªã€‚è¿™ä¸ªçŠ¶æ€ç å…è®¸å®¢æˆ·ç«¯åœ¨è·å–èµ„æºæ—¶åœ¨è¯·æ±‚çš„å…ƒä¿¡æ¯ï¼ˆè¯·æ±‚å¤´å­—æ®µæ•°æ®ï¼‰ä¸­è®¾ç½®å…ˆå†³æ¡ä»¶ï¼Œä»¥æ­¤é¿å…è¯¥è¯·æ±‚æ–¹æ³•è¢«åº”ç”¨åˆ°å…¶å¸Œæœ›çš„å†…å®¹ä»¥å¤–çš„èµ„æºä¸Šã€‚</td></tr><tr><td>413</td><td>æœåŠ¡å™¨æ‹’ç»å¤„ç†å½“å‰è¯·æ±‚ï¼Œå› ä¸ºè¯¥è¯·æ±‚æäº¤çš„å®ä½“æ•°æ®å¤§å°è¶…è¿‡äº†æœåŠ¡å™¨æ„¿æ„æˆ–è€…èƒ½å¤Ÿå¤„ç†çš„èŒƒå›´ã€‚æ­¤ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯ä»¥å…³é—­è¿æ¥ä»¥å…å®¢æˆ·ç«¯ç»§ç»­å‘é€æ­¤è¯·æ±‚ã€‚ ã€€ã€€å¦‚æœè¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼ŒæœåŠ¡å™¨åº”å½“è¿”å›ä¸€ä¸ª Retry-After çš„å“åº”å¤´ï¼Œä»¥å‘ŠçŸ¥å®¢æˆ·ç«¯å¯ä»¥åœ¨å¤šå°‘æ—¶é—´ä»¥åé‡æ–°å°è¯•ã€‚</td></tr><tr><td>414</td><td>è¯·æ±‚çš„URI é•¿åº¦è¶…è¿‡äº†æœåŠ¡å™¨èƒ½å¤Ÿè§£é‡Šçš„é•¿åº¦ï¼Œå› æ­¤æœåŠ¡å™¨æ‹’ç»å¯¹è¯¥è¯·æ±‚æä¾›æœåŠ¡ã€‚è¿™æ¯”è¾ƒå°‘è§ï¼Œé€šå¸¸çš„æƒ…å†µåŒ…æ‹¬ï¼š ã€€ã€€æœ¬åº”ä½¿ç”¨POSTæ–¹æ³•çš„è¡¨å•æäº¤å˜æˆäº†GETæ–¹æ³•ï¼Œå¯¼è‡´æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆQuery Stringï¼‰è¿‡é•¿ã€‚ ã€€ã€€é‡å®šå‘URI â€œé»‘æ´â€ï¼Œä¾‹å¦‚æ¯æ¬¡é‡å®šå‘æŠŠæ—§çš„ URI ä½œä¸ºæ–°çš„ URI çš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´åœ¨è‹¥å¹²æ¬¡é‡å®šå‘å URI è¶…é•¿ã€‚ ã€€ã€€å®¢æˆ·ç«¯æ­£åœ¨å°è¯•åˆ©ç”¨æŸäº›æœåŠ¡å™¨ä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´æ”»å‡»æœåŠ¡å™¨ã€‚è¿™ç±»æœåŠ¡å™¨ä½¿ç”¨å›ºå®šé•¿åº¦çš„ç¼“å†²è¯»å–æˆ–æ“ä½œè¯·æ±‚çš„ URIï¼Œå½“ GET åçš„å‚æ•°è¶…è¿‡æŸä¸ªæ•°å€¼åï¼Œå¯èƒ½ä¼šäº§ç”Ÿç¼“å†²åŒºæº¢å‡ºï¼Œå¯¼è‡´ä»»æ„ä»£ç è¢«æ‰§è¡Œ[1]ã€‚æ²¡æœ‰æ­¤ç±»æ¼æ´çš„æœåŠ¡å™¨ï¼Œåº”å½“è¿”å›414çŠ¶æ€ç ã€‚</td></tr><tr><td>415</td><td>å¯¹äºå½“å‰è¯·æ±‚çš„æ–¹æ³•å’Œæ‰€è¯·æ±‚çš„èµ„æºï¼Œè¯·æ±‚ä¸­æäº¤çš„å®ä½“å¹¶ä¸æ˜¯æœåŠ¡å™¨ä¸­æ‰€æ”¯æŒçš„æ ¼å¼ï¼Œå› æ­¤è¯·æ±‚è¢«æ‹’ç»ã€‚</td></tr><tr><td>416</td><td>å¦‚æœè¯·æ±‚ä¸­åŒ…å«äº† Range è¯·æ±‚å¤´ï¼Œå¹¶ä¸” Range ä¸­æŒ‡å®šçš„ä»»ä½•æ•°æ®èŒƒå›´éƒ½ä¸å½“å‰èµ„æºçš„å¯ç”¨èŒƒå›´ä¸é‡åˆï¼ŒåŒæ—¶è¯·æ±‚ä¸­åˆæ²¡æœ‰å®šä¹‰ If-Range è¯·æ±‚å¤´ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±åº”å½“è¿”å›416çŠ¶æ€ç ã€‚ ã€€ã€€å‡å¦‚ Range ä½¿ç”¨çš„æ˜¯å­—èŠ‚èŒƒå›´ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µå°±æ˜¯æŒ‡è¯·æ±‚æŒ‡å®šçš„æ‰€æœ‰æ•°æ®èŒƒå›´çš„é¦–å­—èŠ‚ä½ç½®éƒ½è¶…è¿‡äº†å½“å‰èµ„æºçš„é•¿åº¦ã€‚æœåŠ¡å™¨ä¹Ÿåº”å½“åœ¨è¿”å›416çŠ¶æ€ç çš„åŒæ—¶ï¼ŒåŒ…å«ä¸€ä¸ª Content-Range å®ä½“å¤´ï¼Œç”¨ä»¥æŒ‡æ˜å½“å‰èµ„æºçš„é•¿åº¦ã€‚è¿™ä¸ªå“åº”ä¹Ÿè¢«ç¦æ­¢ä½¿ç”¨ multipart/byteranges ä½œä¸ºå…¶ Content-Typeã€‚</td></tr><tr><td>417</td><td>åœ¨è¯·æ±‚å¤´ Expect ä¸­æŒ‡å®šçš„é¢„æœŸå†…å®¹æ— æ³•è¢«æœåŠ¡å™¨æ»¡è¶³ï¼Œæˆ–è€…è¿™ä¸ªæœåŠ¡å™¨æ˜¯ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå®ƒæœ‰æ˜æ˜¾çš„è¯æ®è¯æ˜åœ¨å½“å‰è·¯ç”±çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒExpect çš„å†…å®¹æ— æ³•è¢«æ»¡è¶³ã€‚</td></tr><tr><td>421</td><td>ä»å½“å‰å®¢æˆ·ç«¯æ‰€åœ¨çš„IPåœ°å€åˆ°æœåŠ¡å™¨çš„è¿æ¥æ•°è¶…è¿‡äº†æœåŠ¡å™¨è®¸å¯çš„æœ€å¤§èŒƒå›´ã€‚é€šå¸¸ï¼Œè¿™é‡Œçš„IPåœ°å€æŒ‡çš„æ˜¯ä»æœåŠ¡å™¨ä¸Šçœ‹åˆ°çš„å®¢æˆ·ç«¯åœ°å€ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ç½‘å…³æˆ–è€…ä»£ç†æœåŠ¡å™¨åœ°å€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥æ•°çš„è®¡ç®—å¯èƒ½æ¶‰åŠåˆ°ä¸æ­¢ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·ã€‚</td></tr><tr><td>422</td><td>ä»å½“å‰å®¢æˆ·ç«¯æ‰€åœ¨çš„IPåœ°å€åˆ°æœåŠ¡å™¨çš„è¿æ¥æ•°è¶…è¿‡äº†æœåŠ¡å™¨è®¸å¯çš„æœ€å¤§èŒƒå›´ã€‚é€šå¸¸ï¼Œè¿™é‡Œçš„IPåœ°å€æŒ‡çš„æ˜¯ä»æœåŠ¡å™¨ä¸Šçœ‹åˆ°çš„å®¢æˆ·ç«¯åœ°å€ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ç½‘å…³æˆ–è€…ä»£ç†æœåŠ¡å™¨åœ°å€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥æ•°çš„è®¡ç®—å¯èƒ½æ¶‰åŠåˆ°ä¸æ­¢ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·ã€‚</td></tr><tr><td>422</td><td>è¯·æ±‚æ ¼å¼æ­£ç¡®ï¼Œä½†æ˜¯ç”±äºå«æœ‰è¯­ä¹‰é”™è¯¯ï¼Œæ— æ³•å“åº”ã€‚ï¼ˆRFC 4918 WebDAVï¼‰423 Locked ã€€ã€€å½“å‰èµ„æºè¢«é”å®šã€‚ï¼ˆRFC 4918 WebDAVï¼‰</td></tr><tr><td>424</td><td>ç”±äºä¹‹å‰çš„æŸä¸ªè¯·æ±‚å‘ç”Ÿçš„é”™è¯¯ï¼Œå¯¼è‡´å½“å‰è¯·æ±‚å¤±è´¥ï¼Œä¾‹å¦‚ PROPPATCHã€‚ï¼ˆRFC 4918 WebDAVï¼‰</td></tr><tr><td>425</td><td>åœ¨WebDav Advanced Collections è‰æ¡ˆä¸­å®šä¹‰ï¼Œä½†æ˜¯æœªå‡ºç°åœ¨ã€ŠWebDAV é¡ºåºé›†åè®®ã€‹ï¼ˆRFC 3658ï¼‰ä¸­ã€‚</td></tr><tr><td>426</td><td>å®¢æˆ·ç«¯åº”å½“åˆ‡æ¢åˆ°TLS/1.0ã€‚ï¼ˆRFC 2817ï¼‰</td></tr><tr><td>449</td><td>ç”±å¾®è½¯æ‰©å±•ï¼Œä»£è¡¨è¯·æ±‚åº”å½“åœ¨æ‰§è¡Œå®Œé€‚å½“çš„æ“ä½œåè¿›è¡Œé‡è¯•ã€‚</td></tr><tr><td>500</td><td>æœåŠ¡å™¨é‡åˆ°äº†ä¸€ä¸ªæœªæ›¾é¢„æ–™çš„çŠ¶å†µï¼Œå¯¼è‡´äº†å®ƒæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜éƒ½ä¼šåœ¨æœåŠ¡å™¨çš„ç¨‹åºç å‡ºé”™æ—¶å‡ºç°ã€‚</td></tr><tr><td>501</td><td>æœåŠ¡å™¨ä¸æ”¯æŒå½“å‰è¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½ã€‚å½“æœåŠ¡å™¨æ— æ³•è¯†åˆ«è¯·æ±‚çš„æ–¹æ³•ï¼Œå¹¶ä¸”æ— æ³•æ”¯æŒå…¶å¯¹ä»»ä½•èµ„æºçš„è¯·æ±‚ã€‚</td></tr><tr><td>502</td><td>ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°æ— æ•ˆçš„å“åº”ã€‚</td></tr><tr><td>503</td><td>ç”±äºä¸´æ—¶çš„æœåŠ¡å™¨ç»´æŠ¤æˆ–è€…è¿‡è½½ï¼ŒæœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†è¯·æ±‚ã€‚è¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ä¸”å°†åœ¨ä¸€æ®µæ—¶é—´ä»¥åæ¢å¤ã€‚å¦‚æœèƒ½å¤Ÿé¢„è®¡å»¶è¿Ÿæ—¶é—´ï¼Œé‚£ä¹ˆå“åº”ä¸­å¯ä»¥åŒ…å«ä¸€ä¸ª Retry-After å¤´ç”¨ä»¥æ ‡æ˜è¿™ä¸ªå»¶è¿Ÿæ—¶é—´ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºè¿™ä¸ª Retry-After ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åº”å½“ä»¥å¤„ç†500å“åº”çš„æ–¹å¼å¤„ç†å®ƒã€‚ ã€€ã€€æ³¨æ„ï¼š503çŠ¶æ€ç çš„å­˜åœ¨å¹¶ä¸æ„å‘³ç€æœåŠ¡å™¨åœ¨è¿‡è½½çš„æ—¶å€™å¿…é¡»ä½¿ç”¨å®ƒã€‚æŸäº›æœåŠ¡å™¨åªä¸è¿‡æ˜¯å¸Œæœ›æ‹’ç»å®¢æˆ·ç«¯çš„è¿æ¥ã€‚</td></tr><tr><td>504</td><td>ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨ï¼ˆURIæ ‡è¯†å‡ºçš„æœåŠ¡å™¨ï¼Œä¾‹å¦‚HTTPã€FTPã€LDAPï¼‰æˆ–è€…è¾…åŠ©æœåŠ¡å™¨ï¼ˆä¾‹å¦‚DNSï¼‰æ”¶åˆ°å“åº”ã€‚ ã€€ã€€æ³¨æ„ï¼šæŸäº›ä»£ç†æœåŠ¡å™¨åœ¨DNSæŸ¥è¯¢è¶…æ—¶æ—¶ä¼šè¿”å›400æˆ–è€…500é”™è¯¯</td></tr><tr><td>505</td><td>æœåŠ¡å™¨ä¸æ”¯æŒï¼Œæˆ–è€…æ‹’ç»æ”¯æŒåœ¨è¯·æ±‚ä¸­ä½¿ç”¨çš„ HTTP ç‰ˆæœ¬ã€‚è¿™æš—ç¤ºç€æœåŠ¡å™¨ä¸èƒ½æˆ–ä¸æ„¿ä½¿ç”¨ä¸å®¢æˆ·ç«¯ç›¸åŒçš„ç‰ˆæœ¬ã€‚å“åº”ä¸­åº”å½“åŒ…å«ä¸€ä¸ªæè¿°äº†ä¸ºä½•ç‰ˆæœ¬ä¸è¢«æ”¯æŒä»¥åŠæœåŠ¡å™¨æ”¯æŒå“ªäº›åè®®çš„å®ä½“ã€‚</td></tr><tr><td>506</td><td>ç”±ã€Šé€æ˜å†…å®¹åå•†åè®®ã€‹ï¼ˆRFC 2295ï¼‰æ‰©å±•ï¼Œä»£è¡¨æœåŠ¡å™¨å­˜åœ¨å†…éƒ¨é…ç½®é”™è¯¯ï¼šè¢«è¯·æ±‚çš„åå•†å˜å…ƒèµ„æºè¢«é…ç½®ä¸ºåœ¨é€æ˜å†…å®¹åå•†ä¸­ä½¿ç”¨è‡ªå·±ï¼Œå› æ­¤åœ¨ä¸€ä¸ªåå•†å¤„ç†ä¸­ä¸æ˜¯ä¸€ä¸ªåˆé€‚çš„é‡ç‚¹ã€‚</td></tr><tr><td>507</td><td>æœåŠ¡å™¨æ— æ³•å­˜å‚¨å®Œæˆè¯·æ±‚æ‰€å¿…é¡»çš„å†…å®¹ã€‚è¿™ä¸ªçŠ¶å†µè¢«è®¤ä¸ºæ˜¯ä¸´æ—¶çš„ã€‚WebDAV (RFC 4918)</td></tr><tr><td>509</td><td>æœåŠ¡å™¨è¾¾åˆ°å¸¦å®½é™åˆ¶ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªå®˜æ–¹çš„çŠ¶æ€ç ï¼Œä½†æ˜¯ä»è¢«å¹¿æ³›ä½¿ç”¨ã€‚</td></tr><tr><td>510</td><td>è·å–èµ„æºæ‰€éœ€è¦çš„ç­–ç•¥å¹¶æ²¡æœ‰æ²¡æ»¡è¶³ã€‚ï¼ˆRFC 2774ï¼‰</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚å®ƒç”± RFC 2616 è§„èŒƒå®šä¹‰çš„ï¼Œå¹¶å¾—åˆ°RFC 2518ã€RFC 2817ã€RFC 2295ã€RFC 2774ã€RFC 4918ç­‰è§„èŒƒæ‰©å±•ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="HTTP" scheme="https://hsb786.github.io/tags/HTTP/"/>
    
  </entry>
  
</feed>
